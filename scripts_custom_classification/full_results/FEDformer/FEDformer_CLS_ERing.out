Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2660975456237793
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.782 Vali Acc: 0.241 Test Loss: 1.782 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 1.0155315399169922
Epoch: 2, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.714 Vali Acc: 0.293 Test Loss: 1.714 Test Acc: 0.293
Validation loss decreased (-0.240723 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.9873874187469482
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.583 Vali Acc: 0.441 Test Loss: 1.583 Test Acc: 0.441
Validation loss decreased (-0.292575 --> -0.440725).  Saving model ...
Epoch: 4 cost time: 0.9902212619781494
Epoch: 4, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.354 Vali Acc: 0.659 Test Loss: 1.354 Test Acc: 0.659
Validation loss decreased (-0.440725 --> -0.659246).  Saving model ...
Epoch: 5 cost time: 0.8923614025115967
Epoch: 5, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.119 Vali Acc: 0.704 Test Loss: 1.119 Test Acc: 0.704
Validation loss decreased (-0.659246 --> -0.703693).  Saving model ...
Epoch: 6 cost time: 0.9584033489227295
Epoch: 6, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.916 Vali Acc: 0.767 Test Loss: 0.916 Test Acc: 0.767
Validation loss decreased (-0.703693 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 0.8729918003082275
Epoch: 7, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.762 Vali Acc: 0.778 Test Loss: 0.762 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 1.004248857498169
Epoch: 8, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
Validation loss decreased (-0.777770 --> -0.796290).  Saving model ...
Epoch: 9 cost time: 0.899266242980957
Epoch: 9, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803698).  Saving model ...
Epoch: 10 cost time: 0.9576277732849121
Epoch: 10, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.562 Vali Acc: 0.807 Test Loss: 0.562 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 11 cost time: 1.0262103080749512
Epoch: 11, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.559 Vali Acc: 0.815 Test Loss: 0.559 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814809).  Saving model ...
Epoch: 12 cost time: 1.025045394897461
Epoch: 12, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.566 Vali Acc: 0.815 Test Loss: 0.566 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0562639236450195
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1648125648498535
Epoch: 14, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.830 Test Loss: 0.583 Test Acc: 0.830
Validation loss decreased (-0.814809 --> -0.829624).  Saving model ...
Epoch: 15 cost time: 1.0070240497589111
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.829624 --> -0.840735).  Saving model ...
Epoch: 16 cost time: 0.8347477912902832
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9217548370361328
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 0.9822664260864258
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9689044952392578
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.837 Test Loss: 0.616 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0600481033325195
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.837 Test Loss: 0.620 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0302891731262207
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.909151554107666
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.837 Test Loss: 0.627 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9523777961730957
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0395455360412598
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.037428855895996
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9582431316375732
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1672821044921875
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8444444444444444
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.65731143951416
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.764 Vali Acc: 0.252 Test Loss: 1.764 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 1.0968327522277832
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.710 Vali Acc: 0.315 Test Loss: 1.710 Test Acc: 0.315
Validation loss decreased (-0.251834 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 1.2279314994812012
Epoch: 3, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.610 Vali Acc: 0.426 Test Loss: 1.610 Test Acc: 0.426
Validation loss decreased (-0.314798 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 0.9971790313720703
Epoch: 4, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.436 Vali Acc: 0.567 Test Loss: 1.436 Test Acc: 0.567
Validation loss decreased (-0.425910 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 1.0211420059204102
Epoch: 5, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.258 Vali Acc: 0.644 Test Loss: 1.258 Test Acc: 0.644
Validation loss decreased (-0.566652 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 1.121117353439331
Epoch: 6, Steps: 2 | Train Loss: 0.864 Vali Loss: 1.096 Vali Acc: 0.704 Test Loss: 1.096 Test Acc: 0.704
Validation loss decreased (-0.644432 --> -0.703693).  Saving model ...
Epoch: 7 cost time: 1.0757226943969727
Epoch: 7, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.960 Vali Acc: 0.704 Test Loss: 0.960 Test Acc: 0.704
Validation loss decreased (-0.703693 --> -0.703694).  Saving model ...
Epoch: 8 cost time: 1.1000263690948486
Epoch: 8, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.855 Vali Acc: 0.711 Test Loss: 0.855 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 1.0950441360473633
Epoch: 9, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 10 cost time: 1.1124157905578613
Epoch: 10, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
Validation loss decreased (-0.722214 --> -0.737030).  Saving model ...
Epoch: 11 cost time: 1.0951662063598633
Epoch: 11, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
Validation loss decreased (-0.737030 --> -0.762956).  Saving model ...
Epoch: 12 cost time: 1.025193691253662
Epoch: 12, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.704 Vali Acc: 0.767 Test Loss: 0.704 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 0.9479880332946777
Epoch: 13, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770363).  Saving model ...
Epoch: 14 cost time: 1.1267852783203125
Epoch: 14, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 15 cost time: 1.0591366291046143
Epoch: 15, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.770363 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 1.1537680625915527
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 1.2267935276031494
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 1.0136327743530273
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.793 Test Loss: 0.698 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 19 cost time: 1.2012016773223877
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 20 cost time: 1.095442771911621
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.1513445377349854
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.1469495296478271
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.0447373390197754
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.804 Test Loss: 0.696 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 24 cost time: 1.058316707611084
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.815 Test Loss: 0.695 Test Acc: 0.815
Validation loss decreased (-0.803697 --> -0.814808).  Saving model ...
Epoch: 25 cost time: 1.0575871467590332
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.819 Test Loss: 0.695 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 26 cost time: 1.0194964408874512
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 27 cost time: 1.0385823249816895
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.819 Test Loss: 0.693 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 28 cost time: 1.0897493362426758
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822215).  Saving model ...
Epoch: 29 cost time: 0.9979791641235352
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 30 cost time: 1.0344958305358887
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 31 cost time: 1.1143443584442139
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 32 cost time: 1.066645860671997
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 33 cost time: 1.0718615055084229
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 34 cost time: 1.0901243686676025
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.826 Test Loss: 0.686 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 35 cost time: 1.0351285934448242
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.826 Test Loss: 0.685 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 36 cost time: 0.9527649879455566
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.826 Test Loss: 0.684 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 37 cost time: 1.003471851348877
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.826 Test Loss: 0.683 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 38 cost time: 1.196378231048584
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.826 Test Loss: 0.682 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 39 cost time: 1.060272216796875
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.826 Test Loss: 0.682 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 40 cost time: 1.2228078842163086
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.826 Test Loss: 0.681 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 41 cost time: 1.1384754180908203
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 42 cost time: 1.222036600112915
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.826 Test Loss: 0.679 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 43 cost time: 1.2226414680480957
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.826 Test Loss: 0.678 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 44 cost time: 1.2024924755096436
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.830 Test Loss: 0.678 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 45 cost time: 1.2395069599151611
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.830 Test Loss: 0.677 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 46 cost time: 1.2117407321929932
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.830 Test Loss: 0.676 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 47 cost time: 1.1937546730041504
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.830 Test Loss: 0.675 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 48 cost time: 1.119495153427124
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.830 Test Loss: 0.674 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 49 cost time: 1.2818946838378906
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.830 Test Loss: 0.674 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 50 cost time: 1.2792012691497803
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.830 Test Loss: 0.673 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 51 cost time: 1.2174434661865234
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.830 Test Loss: 0.672 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 52 cost time: 1.1882545948028564
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.830 Test Loss: 0.672 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 53 cost time: 1.187049388885498
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.830 Test Loss: 0.671 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 54 cost time: 1.1960680484771729
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.830 Test Loss: 0.670 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 55 cost time: 1.3008131980895996
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.830 Test Loss: 0.670 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 56 cost time: 1.3038051128387451
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.826 Test Loss: 0.669 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0445277690887451
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.826 Test Loss: 0.668 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0397069454193115
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.826 Test Loss: 0.667 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1942846775054932
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.826 Test Loss: 0.667 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.2674999237060547
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.826 Test Loss: 0.666 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1445131301879883
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.826 Test Loss: 0.665 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2113699913024902
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.826 Test Loss: 0.665 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1980805397033691
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.826 Test Loss: 0.664 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.1509525775909424
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.826 Test Loss: 0.664 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.3719077110290527
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.369575262069702
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.784 Vali Acc: 0.263 Test Loss: 1.784 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 1.0817105770111084
Epoch: 2, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.741 Vali Acc: 0.304 Test Loss: 1.741 Test Acc: 0.304
Validation loss decreased (-0.262945 --> -0.303686).  Saving model ...
Epoch: 3 cost time: 1.235100507736206
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.662 Vali Acc: 0.381 Test Loss: 1.662 Test Acc: 0.381
Validation loss decreased (-0.303686 --> -0.381465).  Saving model ...
Epoch: 4 cost time: 1.189239740371704
Epoch: 4, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.519 Vali Acc: 0.530 Test Loss: 1.519 Test Acc: 0.530
Validation loss decreased (-0.381465 --> -0.529614).  Saving model ...
Epoch: 5 cost time: 1.2799146175384521
Epoch: 5, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.367 Vali Acc: 0.611 Test Loss: 1.367 Test Acc: 0.611
Validation loss decreased (-0.529614 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 1.2346537113189697
Epoch: 6, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.221 Vali Acc: 0.667 Test Loss: 1.221 Test Acc: 0.667
Validation loss decreased (-0.611097 --> -0.666654).  Saving model ...
Epoch: 7 cost time: 1.171569585800171
Epoch: 7, Steps: 2 | Train Loss: 0.688 Vali Loss: 1.092 Vali Acc: 0.696 Test Loss: 1.092 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696285).  Saving model ...
Epoch: 8 cost time: 1.1759846210479736
Epoch: 8, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.985 Vali Acc: 0.711 Test Loss: 0.985 Test Acc: 0.711
Validation loss decreased (-0.696285 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 1.0787198543548584
Epoch: 9, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.906 Vali Acc: 0.726 Test Loss: 0.906 Test Acc: 0.726
Validation loss decreased (-0.711101 --> -0.725917).  Saving model ...
Epoch: 10 cost time: 1.0368993282318115
Epoch: 10, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.852 Vali Acc: 0.730 Test Loss: 0.852 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 11 cost time: 1.0115880966186523
Epoch: 11, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
Validation loss decreased (-0.729621 --> -0.740733).  Saving model ...
Epoch: 12 cost time: 1.330979824066162
Epoch: 12, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 1.0882632732391357
Epoch: 13, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.793 Vali Acc: 0.767 Test Loss: 0.793 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 1.0933706760406494
Epoch: 14, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 1.3202142715454102
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.787 Vali Acc: 0.770 Test Loss: 0.787 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 16 cost time: 1.1712911128997803
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.781 Test Loss: 0.786 Test Acc: 0.781
Validation loss decreased (-0.770363 --> -0.781474).  Saving model ...
Epoch: 17 cost time: 1.2643821239471436
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1105296611785889
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1880064010620117
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.785 Test Loss: 0.790 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785177).  Saving model ...
Epoch: 20 cost time: 1.1518375873565674
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.785 Test Loss: 0.792 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.140244483947754
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.785 Test Loss: 0.793 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2390363216400146
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
Validation loss decreased (-0.785177 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 1.1733851432800293
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.048508882522583
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2907955646514893
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.793 Test Loss: 0.796 Test Acc: 0.793
Validation loss decreased (-0.788881 --> -0.792585).  Saving model ...
Epoch: 26 cost time: 1.3151304721832275
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.793 Test Loss: 0.797 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2697887420654297
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.793 Test Loss: 0.797 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1300735473632812
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.793 Test Loss: 0.797 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2034845352172852
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.796 Test Loss: 0.797 Test Acc: 0.796
Validation loss decreased (-0.792585 --> -0.796288).  Saving model ...
Epoch: 30 cost time: 1.2256133556365967
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.796 Test Loss: 0.797 Test Acc: 0.796
Validation loss decreased (-0.796288 --> -0.796288).  Saving model ...
Epoch: 31 cost time: 1.3983182907104492
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.796288 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 1.1183180809020996
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 1.1626043319702148
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 34 cost time: 1.2335939407348633
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 1.2638270854949951
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 1.2427380084991455
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 1.3401200771331787
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 38 cost time: 1.1895155906677246
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 1.3070130348205566
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 1.0587105751037598
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 41 cost time: 1.2285001277923584
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 1.0678014755249023
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 1.1657183170318604
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 44 cost time: 1.2781672477722168
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 45 cost time: 1.315645456314087
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 1.0055105686187744
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 1.2347385883331299
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 48 cost time: 1.1499443054199219
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 49 cost time: 1.0883855819702148
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 50 cost time: 1.0215981006622314
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 51 cost time: 1.2665605545043945
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 52 cost time: 1.1947686672210693
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 53 cost time: 1.2522039413452148
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 54 cost time: 1.2967824935913086
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.796 Test Loss: 0.787 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.374086618423462
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.796 Test Loss: 0.786 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2192955017089844
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.796 Test Loss: 0.786 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.230757236480713
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2237839698791504
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1542038917541504
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.1006529331207275
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.796 Test Loss: 0.784 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.2583279609680176
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.796 Test Loss: 0.784 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.2279891967773438
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.796 Test Loss: 0.783 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2590582370758057
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.796 Test Loss: 0.783 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9665558338165283
Epoch: 1, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.815 Vali Acc: 0.207 Test Loss: 1.815 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 1.2120628356933594
Epoch: 2, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.783 Vali Acc: 0.267 Test Loss: 1.783 Test Acc: 0.267
Validation loss decreased (-0.207389 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 1.1649420261383057
Epoch: 3, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.722 Vali Acc: 0.307 Test Loss: 1.722 Test Acc: 0.307
Validation loss decreased (-0.266649 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 1.094689130783081
Epoch: 4, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.608 Vali Acc: 0.493 Test Loss: 1.608 Test Acc: 0.493
Validation loss decreased (-0.307390 --> -0.492577).  Saving model ...
Epoch: 5 cost time: 1.1710522174835205
Epoch: 5, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.481 Vali Acc: 0.552 Test Loss: 1.481 Test Acc: 0.552
Validation loss decreased (-0.492577 --> -0.551837).  Saving model ...
Epoch: 6 cost time: 1.224506139755249
Epoch: 6, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.356 Vali Acc: 0.600 Test Loss: 1.356 Test Acc: 0.600
Validation loss decreased (-0.551837 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 1.2757608890533447
Epoch: 7, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.244 Vali Acc: 0.596 Test Loss: 1.244 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1923422813415527
Epoch: 8, Steps: 2 | Train Loss: 0.711 Vali Loss: 1.145 Vali Acc: 0.593 Test Loss: 1.145 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2732808589935303
Epoch: 9, Steps: 2 | Train Loss: 0.508 Vali Loss: 1.068 Vali Acc: 0.615 Test Loss: 1.068 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614804).  Saving model ...
Epoch: 10 cost time: 1.1703965663909912
Epoch: 10, Steps: 2 | Train Loss: 0.322 Vali Loss: 1.010 Vali Acc: 0.626 Test Loss: 1.010 Test Acc: 0.626
Validation loss decreased (-0.614804 --> -0.625916).  Saving model ...
Epoch: 11 cost time: 1.1699531078338623
Epoch: 11, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.964 Vali Acc: 0.641 Test Loss: 0.964 Test Acc: 0.641
Validation loss decreased (-0.625916 --> -0.640731).  Saving model ...
Epoch: 12 cost time: 1.1480872631072998
Epoch: 12, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.926 Vali Acc: 0.670 Test Loss: 0.926 Test Acc: 0.670
Validation loss decreased (-0.640731 --> -0.670361).  Saving model ...
Epoch: 13 cost time: 1.0451929569244385
Epoch: 13, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.892 Vali Acc: 0.681 Test Loss: 0.892 Test Acc: 0.681
Validation loss decreased (-0.670361 --> -0.681473).  Saving model ...
Epoch: 14 cost time: 1.1370470523834229
Epoch: 14, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.862 Vali Acc: 0.700 Test Loss: 0.862 Test Acc: 0.700
Validation loss decreased (-0.681473 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.1338257789611816
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.837 Vali Acc: 0.707 Test Loss: 0.837 Test Acc: 0.707
Validation loss decreased (-0.699991 --> -0.707399).  Saving model ...
Epoch: 16 cost time: 1.0647664070129395
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.817 Vali Acc: 0.711 Test Loss: 0.817 Test Acc: 0.711
Validation loss decreased (-0.707399 --> -0.711103).  Saving model ...
Epoch: 17 cost time: 1.2263946533203125
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 1.263408899307251
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.752 Test Loss: 0.785 Test Acc: 0.752
Validation loss decreased (-0.733325 --> -0.751844).  Saving model ...
Epoch: 19 cost time: 1.2333486080169678
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.116318941116333
Epoch: 20, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 21 cost time: 1.2665796279907227
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.759 Test Loss: 0.756 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 22 cost time: 0.9956166744232178
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.759 Test Loss: 0.750 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 23 cost time: 1.0421674251556396
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 24 cost time: 1.2617580890655518
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.774 Test Loss: 0.743 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774067).  Saving model ...
Epoch: 25 cost time: 1.1459345817565918
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 1.2468695640563965
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 27 cost time: 1.2582292556762695
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 28 cost time: 1.1790475845336914
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 29 cost time: 1.103201150894165
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.778 Test Loss: 0.736 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 30 cost time: 1.2959368228912354
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.781 Test Loss: 0.736 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 31 cost time: 1.2236671447753906
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.785 Test Loss: 0.736 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 32 cost time: 1.0788562297821045
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.793 Test Loss: 0.736 Test Acc: 0.793
Validation loss decreased (-0.785178 --> -0.792585).  Saving model ...
Epoch: 33 cost time: 1.1716787815093994
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.793 Test Loss: 0.736 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2822105884552002
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.793 Test Loss: 0.736 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0684971809387207
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
Validation loss decreased (-0.792585 --> -0.796289).  Saving model ...
Epoch: 36 cost time: 1.1298482418060303
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 37 cost time: 1.1733222007751465
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.23740553855896
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0589971542358398
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3127617835998535
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2896015644073486
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0851409435272217
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.186147689819336
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803696).  Saving model ...
Epoch: 44 cost time: 1.2614879608154297
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3099892139434814
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0799672603607178
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.807 Test Loss: 0.738 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807400).  Saving model ...
Epoch: 47 cost time: 1.1232872009277344
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.807 Test Loss: 0.738 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3010313510894775
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.807 Test Loss: 0.738 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 49 cost time: 1.2062528133392334
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.807 Test Loss: 0.738 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 50 cost time: 1.3034214973449707
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.807 Test Loss: 0.737 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 51 cost time: 1.223386526107788
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.807 Test Loss: 0.737 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 52 cost time: 1.0861430168151855
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.807 Test Loss: 0.737 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 53 cost time: 1.0788111686706543
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 54 cost time: 1.1353108882904053
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 55 cost time: 1.0802981853485107
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.234668493270874
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.807 Test Loss: 0.737 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2760844230651855
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.807 Test Loss: 0.737 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1618070602416992
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.807 Test Loss: 0.736 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2416763305664062
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.804 Test Loss: 0.736 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1760659217834473
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.804 Test Loss: 0.736 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1359567642211914
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.804 Test Loss: 0.736 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.3361577987670898
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.31243896484375
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.2479572296142578
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1840765476226807
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.830 Vali Acc: 0.174 Test Loss: 1.830 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 1.344233512878418
Epoch: 2, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.809 Vali Acc: 0.219 Test Loss: 1.809 Test Acc: 0.219
Validation loss decreased (-0.174056 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 1.2656314373016357
Epoch: 3, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.760 Vali Acc: 0.256 Test Loss: 1.760 Test Acc: 0.256
Validation loss decreased (-0.218500 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 1.0731921195983887
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.654 Vali Acc: 0.341 Test Loss: 1.654 Test Acc: 0.341
Validation loss decreased (-0.255538 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 1.1520988941192627
Epoch: 5, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.526 Vali Acc: 0.496 Test Loss: 1.526 Test Acc: 0.496
Validation loss decreased (-0.340724 --> -0.496281).  Saving model ...
Epoch: 6 cost time: 1.2593979835510254
Epoch: 6, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.385 Vali Acc: 0.607 Test Loss: 1.385 Test Acc: 0.607
Validation loss decreased (-0.496281 --> -0.607394).  Saving model ...
Epoch: 7 cost time: 1.0412731170654297
Epoch: 7, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.239 Vali Acc: 0.663 Test Loss: 1.239 Test Acc: 0.663
Validation loss decreased (-0.607394 --> -0.662951).  Saving model ...
Epoch: 8 cost time: 1.148845911026001
Epoch: 8, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.095 Vali Acc: 0.704 Test Loss: 1.095 Test Acc: 0.704
Validation loss decreased (-0.662951 --> -0.703693).  Saving model ...
Epoch: 9 cost time: 1.2787981033325195
Epoch: 9, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.966 Vali Acc: 0.719 Test Loss: 0.966 Test Acc: 0.719
Validation loss decreased (-0.703693 --> -0.718509).  Saving model ...
Epoch: 10 cost time: 1.2690913677215576
Epoch: 10, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 1.330141305923462
Epoch: 11, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.772 Vali Acc: 0.744 Test Loss: 0.772 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.2611644268035889
Epoch: 12, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 1.1936554908752441
Epoch: 13, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.744437 --> -0.762956).  Saving model ...
Epoch: 14 cost time: 1.1592698097229004
Epoch: 14, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.638 Vali Acc: 0.759 Test Loss: 0.638 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1258461475372314
Epoch: 15, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.614 Vali Acc: 0.759 Test Loss: 0.614 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2222659587860107
Epoch: 16, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.581 Vali Acc: 0.778 Test Loss: 0.581 Test Acc: 0.778
Validation loss decreased (-0.762956 --> -0.777772).  Saving model ...
Epoch: 17 cost time: 1.197418212890625
Epoch: 17, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.793 Test Loss: 0.551 Test Acc: 0.793
Validation loss decreased (-0.777772 --> -0.792587).  Saving model ...
Epoch: 18 cost time: 1.1729257106781006
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
Validation loss decreased (-0.792587 --> -0.803698).  Saving model ...
Epoch: 19 cost time: 1.2267193794250488
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.503 Vali Acc: 0.811 Test Loss: 0.503 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811106).  Saving model ...
Epoch: 20 cost time: 1.155653953552246
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 21 cost time: 1.1818718910217285
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 22 cost time: 1.2714860439300537
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.837 Test Loss: 0.461 Test Acc: 0.837
Validation loss decreased (-0.825921 --> -0.837032).  Saving model ...
Epoch: 23 cost time: 1.2561097145080566
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
Validation loss decreased (-0.837032 --> -0.848144).  Saving model ...
Epoch: 24 cost time: 1.3124444484710693
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.852 Test Loss: 0.451 Test Acc: 0.852
Validation loss decreased (-0.848144 --> -0.851847).  Saving model ...
Epoch: 25 cost time: 1.2423105239868164
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859255).  Saving model ...
Epoch: 26 cost time: 1.2871816158294678
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.863 Test Loss: 0.453 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862958).  Saving model ...
Epoch: 27 cost time: 1.153604507446289
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.297741174697876
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.220191478729248
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 30 cost time: 1.2100021839141846
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2739975452423096
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2359519004821777
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2381937503814697
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.125929832458496
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.852 Test Loss: 0.486 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2268731594085693
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.852 Test Loss: 0.490 Test Acc: 0.852
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0089912414550781
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0557582378387451
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1870818138122559
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1806344985961914
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.307983636856079
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.895 Vali Acc: 0.137 Test Loss: 1.895 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 1.1572797298431396
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.879 Vali Acc: 0.141 Test Loss: 1.879 Test Acc: 0.141
Validation loss decreased (-0.137018 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.1707696914672852
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.794 Vali Acc: 0.170 Test Loss: 1.794 Test Acc: 0.170
Validation loss decreased (-0.140722 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 1.0843923091888428
Epoch: 4, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.576 Vali Acc: 0.378 Test Loss: 1.576 Test Acc: 0.378
Validation loss decreased (-0.170352 --> -0.377762).  Saving model ...
Epoch: 5 cost time: 1.3144547939300537
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.339 Vali Acc: 0.593 Test Loss: 1.339 Test Acc: 0.593
Validation loss decreased (-0.377762 --> -0.592579).  Saving model ...
Epoch: 6 cost time: 1.2564847469329834
Epoch: 6, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.101 Vali Acc: 0.730 Test Loss: 1.101 Test Acc: 0.730
Validation loss decreased (-0.592579 --> -0.729619).  Saving model ...
Epoch: 7 cost time: 1.1480381488800049
Epoch: 7, Steps: 2 | Train Loss: 1.458 Vali Loss: 0.891 Vali Acc: 0.811 Test Loss: 0.891 Test Acc: 0.811
Validation loss decreased (-0.729619 --> -0.811102).  Saving model ...
Epoch: 8 cost time: 1.1991503238677979
Epoch: 8, Steps: 2 | Train Loss: 1.206 Vali Loss: 0.721 Vali Acc: 0.852 Test Loss: 0.721 Test Acc: 0.852
Validation loss decreased (-0.811102 --> -0.851845).  Saving model ...
Epoch: 9 cost time: 1.154346227645874
Epoch: 9, Steps: 2 | Train Loss: 1.034 Vali Loss: 0.583 Vali Acc: 0.881 Test Loss: 0.583 Test Acc: 0.881
Validation loss decreased (-0.851845 --> -0.881476).  Saving model ...
Epoch: 10 cost time: 1.224973201751709
Epoch: 10, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.480 Vali Acc: 0.896 Test Loss: 0.480 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896291).  Saving model ...
Epoch: 11 cost time: 1.1528396606445312
Epoch: 11, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 1.0295624732971191
Epoch: 12, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.354 Vali Acc: 0.904 Test Loss: 0.354 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2024106979370117
Epoch: 13, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.323 Vali Acc: 0.893 Test Loss: 0.323 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2399566173553467
Epoch: 14, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.310 Vali Acc: 0.896 Test Loss: 0.310 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2013649940490723
Epoch: 15, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2289402484893799
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.288 Vali Acc: 0.885 Test Loss: 0.288 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1973257064819336
Epoch: 17, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.904 Test Loss: 0.261 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.166229009628296
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.2817418575286865
Epoch: 19, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 20 cost time: 1.2656972408294678
Epoch: 20, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 1.216080904006958
Epoch: 21, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.04337477684021
Epoch: 22, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1340241432189941
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1106290817260742
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3260581493377686
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.911 Test Loss: 0.330 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1469130516052246
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0882928371429443
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1277916431427002
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.176424264907837
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.915 Test Loss: 0.349 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.154794692993164
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.192516565322876
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.831 Vali Acc: 0.189 Test Loss: 1.831 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.1956534385681152
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.817 Vali Acc: 0.196 Test Loss: 1.817 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 1.2186875343322754
Epoch: 3, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.704 Vali Acc: 0.326 Test Loss: 1.704 Test Acc: 0.326
Validation loss decreased (-0.196278 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 1.052616834640503
Epoch: 4, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.428 Vali Acc: 0.548 Test Loss: 1.428 Test Acc: 0.548
Validation loss decreased (-0.325909 --> -0.548134).  Saving model ...
Epoch: 5 cost time: 1.2288615703582764
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.148 Vali Acc: 0.748 Test Loss: 1.148 Test Acc: 0.748
Validation loss decreased (-0.548134 --> -0.748137).  Saving model ...
Epoch: 6 cost time: 1.1972270011901855
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 0.902 Vali Acc: 0.844 Test Loss: 0.902 Test Acc: 0.844
Validation loss decreased (-0.748137 --> -0.844435).  Saving model ...
Epoch: 7 cost time: 0.9266059398651123
Epoch: 7, Steps: 2 | Train Loss: 1.492 Vali Loss: 0.711 Vali Acc: 0.870 Test Loss: 0.711 Test Acc: 0.870
Validation loss decreased (-0.844435 --> -0.870363).  Saving model ...
Epoch: 8 cost time: 1.0682027339935303
Epoch: 8, Steps: 2 | Train Loss: 1.237 Vali Loss: 0.570 Vali Acc: 0.904 Test Loss: 0.570 Test Acc: 0.904
Validation loss decreased (-0.870363 --> -0.903698).  Saving model ...
Epoch: 9 cost time: 1.2102887630462646
Epoch: 9, Steps: 2 | Train Loss: 1.110 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 10 cost time: 1.2384252548217773
Epoch: 10, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.381 Vali Acc: 0.933 Test Loss: 0.381 Test Acc: 0.933
Validation loss decreased (-0.914810 --> -0.933330).  Saving model ...
Epoch: 11 cost time: 1.2555735111236572
Epoch: 11, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3413712978363037
Epoch: 12, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0271713733673096
Epoch: 13, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1101164817810059
Epoch: 14, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.302 Vali Acc: 0.881 Test Loss: 0.302 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.257599115371704
Epoch: 15, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1329243183135986
Epoch: 16, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.260 Vali Acc: 0.907 Test Loss: 0.260 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0384411811828613
Epoch: 17, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 1.0334367752075195
Epoch: 18, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 1.179589033126831
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9754805564880371
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 1.1423068046569824
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2306406497955322
Epoch: 22, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2479543685913086
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1953248977661133
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1502113342285156
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.294332504272461
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1656370162963867
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0435869693756104
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1287281513214111
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0929651260375977
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.140737771987915
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1806824207305908
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0457308292388916
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.173210859298706
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2506787776947021
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0082621574401855
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1057260036468506
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.1348671913146973
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0019662380218506
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1926462650299072
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2656328678131104
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2387921810150146
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0269334316253662
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1140570640563965
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.084895372390747
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.18267822265625
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3057725429534912
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 14910982
model size : 76.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.018915891647339
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.760 Vali Acc: 0.207 Test Loss: 1.760 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 1.1201813220977783
Epoch: 2, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.688 Vali Acc: 0.307 Test Loss: 1.688 Test Acc: 0.307
Validation loss decreased (-0.207390 --> -0.307391).  Saving model ...
Epoch: 3 cost time: 1.2370390892028809
Epoch: 3, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.569 Vali Acc: 0.426 Test Loss: 1.569 Test Acc: 0.426
Validation loss decreased (-0.307391 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 1.2050414085388184
Epoch: 4, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.358 Vali Acc: 0.578 Test Loss: 1.358 Test Acc: 0.578
Validation loss decreased (-0.425910 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 1.1597778797149658
Epoch: 5, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.137 Vali Acc: 0.726 Test Loss: 1.137 Test Acc: 0.726
Validation loss decreased (-0.577764 --> -0.725915).  Saving model ...
Epoch: 6 cost time: 1.0870306491851807
Epoch: 6, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.939 Vali Acc: 0.770 Test Loss: 0.939 Test Acc: 0.770
Validation loss decreased (-0.725915 --> -0.770361).  Saving model ...
Epoch: 7 cost time: 1.1313066482543945
Epoch: 7, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
Validation loss decreased (-0.770361 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 1.1454081535339355
Epoch: 8, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.669 Vali Acc: 0.815 Test Loss: 0.669 Test Acc: 0.815
Validation loss decreased (-0.788881 --> -0.814808).  Saving model ...
Epoch: 9 cost time: 1.2982029914855957
Epoch: 9, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 10 cost time: 1.2463030815124512
Epoch: 10, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0890815258026123
Epoch: 11, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.20387864112854
Epoch: 12, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.830 Test Loss: 0.533 Test Acc: 0.830
Validation loss decreased (-0.822217 --> -0.829624).  Saving model ...
Epoch: 13 cost time: 1.3200581073760986
Epoch: 13, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.0950231552124023
Epoch: 14, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.837 Test Loss: 0.539 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 15 cost time: 1.2126119136810303
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.837032 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.2935268878936768
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 17 cost time: 1.2294702529907227
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1519925594329834
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.852 Test Loss: 0.568 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 19 cost time: 1.1740987300872803
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.852 Test Loss: 0.574 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1907753944396973
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.2970058917999268
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3679015636444092
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0203807353973389
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3504819869995117
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2385449409484863
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2001621723175049
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0991761684417725
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.071408748626709
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0984904766082764
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859253).  Saving model ...
Epoch: 30 cost time: 1.2282254695892334
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.863 Test Loss: 0.606 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 31 cost time: 1.1562726497650146
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.863 Test Loss: 0.607 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.22141695022583
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.863 Test Loss: 0.607 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1612842082977295
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.086026668548584
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 0.9951663017272949
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 0.9533803462982178
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 1.2572929859161377
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 1.037630319595337
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 1.037285327911377
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 1.2934775352478027
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 1.2459542751312256
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 1.133164644241333
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 1.1345176696777344
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 44 cost time: 1.2752187252044678
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 45 cost time: 1.091325044631958
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 46 cost time: 1.1069386005401611
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 1.081824779510498
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 48 cost time: 0.9950766563415527
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 49 cost time: 1.1639058589935303
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 50 cost time: 1.1397523880004883
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 51 cost time: 0.999516487121582
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 52 cost time: 1.0419094562530518
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 53 cost time: 1.0999717712402344
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 54 cost time: 0.9892747402191162
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 55 cost time: 1.0486161708831787
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 56 cost time: 1.1467983722686768
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 57 cost time: 1.0723161697387695
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 58 cost time: 1.0242908000946045
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.863 Test Loss: 0.600 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1645848751068115
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.863 Test Loss: 0.600 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2364552021026611
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.863 Test Loss: 0.599 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1438910961151123
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.863 Test Loss: 0.599 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3312010765075684
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.863 Test Loss: 0.599 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2603144645690918
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.1330866813659668
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0512943267822266
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1429896354675293
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.863 Test Loss: 0.597 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2228310108184814
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.863 Test Loss: 0.597 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0926883220672607
Epoch: 1, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.770 Vali Acc: 0.248 Test Loss: 1.770 Test Acc: 0.248
Validation loss decreased (inf --> -0.248130).  Saving model ...
Epoch: 2 cost time: 1.1160383224487305
Epoch: 2, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.714 Vali Acc: 0.289 Test Loss: 1.714 Test Acc: 0.289
Validation loss decreased (-0.248130 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 1.0394244194030762
Epoch: 3, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.621 Vali Acc: 0.404 Test Loss: 1.621 Test Acc: 0.404
Validation loss decreased (-0.288872 --> -0.403687).  Saving model ...
Epoch: 4 cost time: 1.2968010902404785
Epoch: 4, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.455 Vali Acc: 0.530 Test Loss: 1.455 Test Acc: 0.530
Validation loss decreased (-0.403687 --> -0.529615).  Saving model ...
Epoch: 5 cost time: 1.2073051929473877
Epoch: 5, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.275 Vali Acc: 0.637 Test Loss: 1.275 Test Acc: 0.637
Validation loss decreased (-0.529615 --> -0.637024).  Saving model ...
Epoch: 6 cost time: 1.1424248218536377
Epoch: 6, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.105 Vali Acc: 0.685 Test Loss: 1.105 Test Acc: 0.685
Validation loss decreased (-0.637024 --> -0.685174).  Saving model ...
Epoch: 7 cost time: 1.1842105388641357
Epoch: 7, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.962 Vali Acc: 0.737 Test Loss: 0.962 Test Acc: 0.737
Validation loss decreased (-0.685174 --> -0.737027).  Saving model ...
Epoch: 8 cost time: 1.2737274169921875
Epoch: 8, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
Validation loss decreased (-0.737027 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 1.180560827255249
Epoch: 9, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.783 Vali Acc: 0.759 Test Loss: 0.783 Test Acc: 0.759
Validation loss decreased (-0.744436 --> -0.759251).  Saving model ...
Epoch: 10 cost time: 1.1949574947357178
Epoch: 10, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.737 Vali Acc: 0.752 Test Loss: 0.737 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0679771900177002
Epoch: 11, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.698 Vali Acc: 0.763 Test Loss: 0.698 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762956).  Saving model ...
Epoch: 12 cost time: 1.2616488933563232
Epoch: 12, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.672 Vali Acc: 0.770 Test Loss: 0.672 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 13 cost time: 1.2435338497161865
Epoch: 13, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 1.0484278202056885
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.781 Test Loss: 0.640 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 15 cost time: 1.1468939781188965
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.781 Test Loss: 0.630 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 16 cost time: 1.1110458374023438
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
Validation loss decreased (-0.781475 --> -0.796290).  Saving model ...
Epoch: 17 cost time: 1.1323049068450928
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.807 Test Loss: 0.618 Test Acc: 0.807
Validation loss decreased (-0.796290 --> -0.807401).  Saving model ...
Epoch: 18 cost time: 0.9629812240600586
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.804 Test Loss: 0.614 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0234324932098389
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.807401 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.1897001266479492
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 21 cost time: 1.1677970886230469
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 22 cost time: 1.0992882251739502
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 23 cost time: 1.1719253063201904
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 1.0923912525177002
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.837 Test Loss: 0.608 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 25 cost time: 1.2464995384216309
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.837 Test Loss: 0.608 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 26 cost time: 1.1349773406982422
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 27 cost time: 1.105738639831543
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 1.17854642868042
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 1.2287890911102295
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.9756228923797607
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 1.1032295227050781
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 1.045762538909912
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 33 cost time: 1.1047084331512451
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 34 cost time: 1.1646041870117188
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 35 cost time: 1.1435680389404297
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 36 cost time: 1.0525953769683838
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.848 Test Loss: 0.601 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 37 cost time: 1.1138815879821777
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 38 cost time: 1.311344861984253
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 39 cost time: 1.1468751430511475
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 40 cost time: 1.0824165344238281
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.848 Test Loss: 0.598 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 41 cost time: 1.137803316116333
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.848 Test Loss: 0.597 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 42 cost time: 0.966620683670044
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 43 cost time: 1.1487915515899658
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 44 cost time: 1.170865774154663
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.848 Test Loss: 0.595 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 45 cost time: 1.1969497203826904
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 46 cost time: 1.2170093059539795
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 47 cost time: 1.125213384628296
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.848 Test Loss: 0.593 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 48 cost time: 1.0929601192474365
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 49 cost time: 1.1828832626342773
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 50 cost time: 1.0671491622924805
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 51 cost time: 1.0310883522033691
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 52 cost time: 0.9866869449615479
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 53 cost time: 1.1041216850280762
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 54 cost time: 1.2092406749725342
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.848 Test Loss: 0.589 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 55 cost time: 1.1142678260803223
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.852 Test Loss: 0.589 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 56 cost time: 1.0375282764434814
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.852 Test Loss: 0.588 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 57 cost time: 1.112616777420044
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.852 Test Loss: 0.588 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 58 cost time: 1.2087595462799072
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.852 Test Loss: 0.587 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 59 cost time: 1.2325410842895508
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.852 Test Loss: 0.587 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 60 cost time: 1.1632423400878906
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.852 Test Loss: 0.587 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 61 cost time: 1.0159270763397217
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.852 Test Loss: 0.586 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 62 cost time: 0.9922711849212646
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 63 cost time: 1.2556350231170654
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 64 cost time: 1.1876657009124756
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859253).  Saving model ...
Epoch: 65 cost time: 1.0963099002838135
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3577072620391846
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1132831573486328
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.1425580978393555
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.0291285514831543
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.071986436843872
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.200894832611084
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.1804203987121582
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.1975781917572021
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.182114839553833
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.308624505996704
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.794 Vali Acc: 0.167 Test Loss: 1.794 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2237474918365479
Epoch: 2, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.750 Vali Acc: 0.204 Test Loss: 1.750 Test Acc: 0.204
Validation loss decreased (-0.166649 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 1.0059044361114502
Epoch: 3, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.676 Vali Acc: 0.315 Test Loss: 1.676 Test Acc: 0.315
Validation loss decreased (-0.203686 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 1.0576927661895752
Epoch: 4, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.542 Vali Acc: 0.496 Test Loss: 1.542 Test Acc: 0.496
Validation loss decreased (-0.314798 --> -0.496281).  Saving model ...
Epoch: 5 cost time: 1.1703126430511475
Epoch: 5, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.392 Vali Acc: 0.578 Test Loss: 1.392 Test Acc: 0.578
Validation loss decreased (-0.496281 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.1001307964324951
Epoch: 6, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.243 Vali Acc: 0.633 Test Loss: 1.243 Test Acc: 0.633
Validation loss decreased (-0.577764 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.1304137706756592
Epoch: 7, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.110 Vali Acc: 0.667 Test Loss: 1.110 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 1.227933406829834
Epoch: 8, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.000 Vali Acc: 0.707 Test Loss: 1.000 Test Acc: 0.707
Validation loss decreased (-0.666656 --> -0.707397).  Saving model ...
Epoch: 9 cost time: 1.039320468902588
Epoch: 9, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.920 Vali Acc: 0.719 Test Loss: 0.920 Test Acc: 0.719
Validation loss decreased (-0.707397 --> -0.718509).  Saving model ...
Epoch: 10 cost time: 1.269714593887329
Epoch: 10, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.873 Vali Acc: 0.730 Test Loss: 0.873 Test Acc: 0.730
Validation loss decreased (-0.718509 --> -0.729621).  Saving model ...
Epoch: 11 cost time: 1.1836769580841064
Epoch: 11, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.832 Vali Acc: 0.737 Test Loss: 0.832 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737029).  Saving model ...
Epoch: 12 cost time: 1.2232518196105957
Epoch: 12, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
Validation loss decreased (-0.737029 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 1.0667479038238525
Epoch: 13, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.779 Vali Acc: 0.763 Test Loss: 0.779 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762955).  Saving model ...
Epoch: 14 cost time: 1.036803960800171
Epoch: 14, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
Validation loss decreased (-0.762955 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.1006815433502197
Epoch: 15, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.781 Test Loss: 0.755 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 16 cost time: 1.1924078464508057
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.789 Test Loss: 0.746 Test Acc: 0.789
Validation loss decreased (-0.781474 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 1.2381033897399902
Epoch: 17, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 1.2078678607940674
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.793 Test Loss: 0.735 Test Acc: 0.793
Validation loss decreased (-0.788881 --> -0.792585).  Saving model ...
Epoch: 19 cost time: 1.093282699584961
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.804 Test Loss: 0.732 Test Acc: 0.804
Validation loss decreased (-0.792585 --> -0.803696).  Saving model ...
Epoch: 20 cost time: 1.2167060375213623
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.807 Test Loss: 0.729 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807400).  Saving model ...
Epoch: 21 cost time: 1.1125247478485107
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.0873675346374512
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.811 Test Loss: 0.726 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 1.0576024055480957
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.815 Test Loss: 0.725 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 24 cost time: 1.1302623748779297
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.819 Test Loss: 0.724 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818511).  Saving model ...
Epoch: 25 cost time: 1.2471487522125244
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
Validation loss decreased (-0.818511 --> -0.818511).  Saving model ...
Epoch: 26 cost time: 1.2691943645477295
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
Validation loss decreased (-0.818511 --> -0.822215).  Saving model ...
Epoch: 27 cost time: 1.055189609527588
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 28 cost time: 1.1421422958374023
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 29 cost time: 1.3038933277130127
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 30 cost time: 1.1602654457092285
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 31 cost time: 1.1221134662628174
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.822 Test Loss: 0.715 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 32 cost time: 1.1012043952941895
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 33 cost time: 1.3348989486694336
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 34 cost time: 1.1497364044189453
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.826 Test Loss: 0.711 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 35 cost time: 1.1382157802581787
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 36 cost time: 1.3394567966461182
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.826 Test Loss: 0.709 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 37 cost time: 1.155580997467041
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 38 cost time: 1.101738452911377
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.826 Test Loss: 0.707 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 39 cost time: 1.0985076427459717
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.826 Test Loss: 0.707 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 40 cost time: 1.2753865718841553
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.830 Test Loss: 0.706 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 41 cost time: 1.1615257263183594
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.830 Test Loss: 0.705 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 42 cost time: 1.0985498428344727
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.830 Test Loss: 0.704 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 43 cost time: 1.1750504970550537
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.830 Test Loss: 0.703 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 44 cost time: 1.204054832458496
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.830 Test Loss: 0.703 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 45 cost time: 1.0762333869934082
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.830 Test Loss: 0.702 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 46 cost time: 1.2042267322540283
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.830 Test Loss: 0.701 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 47 cost time: 1.0866913795471191
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.830 Test Loss: 0.701 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 48 cost time: 1.2401926517486572
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 49 cost time: 1.1764490604400635
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 50 cost time: 1.261284351348877
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 51 cost time: 1.1340534687042236
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 52 cost time: 1.0788776874542236
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 53 cost time: 1.167541742324829
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1354854106903076
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.830 Test Loss: 0.700 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 55 cost time: 1.1496171951293945
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.830 Test Loss: 0.699 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 56 cost time: 1.1496925354003906
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.830 Test Loss: 0.699 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 57 cost time: 1.2908656597137451
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.830 Test Loss: 0.699 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 58 cost time: 1.2030003070831299
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.830 Test Loss: 0.699 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 59 cost time: 1.196584701538086
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.830 Test Loss: 0.698 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 60 cost time: 1.0016179084777832
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.830 Test Loss: 0.698 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 61 cost time: 1.1624805927276611
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.830 Test Loss: 0.698 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 62 cost time: 1.134861946105957
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 63 cost time: 1.061765432357788
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 64 cost time: 0.9637353420257568
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 65 cost time: 1.2620689868927002
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 66 cost time: 1.2735319137573242
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 67 cost time: 1.2630102634429932
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 68 cost time: 1.203547716140747
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 69 cost time: 1.2940020561218262
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 70 cost time: 1.2058305740356445
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 71 cost time: 1.2069296836853027
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 72 cost time: 1.0463347434997559
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 73 cost time: 1.129021167755127
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.830 Test Loss: 0.696 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.10605788230896
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 75 cost time: 1.1788783073425293
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 76 cost time: 1.1367697715759277
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 77 cost time: 1.1139471530914307
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 78 cost time: 1.3710036277770996
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 79 cost time: 1.1717982292175293
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 80 cost time: 1.1086630821228027
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 81 cost time: 1.1495938301086426
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 82 cost time: 1.124354600906372
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 83 cost time: 1.1808483600616455
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.2323095798492432
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.1706886291503906
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.1353137493133545
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.2418911457061768
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.0721969604492188
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.0510013103485107
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.113647699356079
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 1.0227329730987549
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 1.1184866428375244
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.830 Test Loss: 0.694 Test Acc: 0.830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.091522216796875
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.861 Vali Acc: 0.133 Test Loss: 1.861 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.2754054069519043
Epoch: 2, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.827 Vali Acc: 0.148 Test Loss: 1.827 Test Acc: 0.148
Validation loss decreased (-0.133315 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.2765591144561768
Epoch: 3, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.772 Vali Acc: 0.196 Test Loss: 1.772 Test Acc: 0.196
Validation loss decreased (-0.148130 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 1.052140712738037
Epoch: 4, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.667 Vali Acc: 0.356 Test Loss: 1.667 Test Acc: 0.356
Validation loss decreased (-0.196279 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 1.1709189414978027
Epoch: 5, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.547 Vali Acc: 0.467 Test Loss: 1.547 Test Acc: 0.467
Validation loss decreased (-0.355539 --> -0.466651).  Saving model ...
Epoch: 6 cost time: 1.1044158935546875
Epoch: 6, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.421 Vali Acc: 0.574 Test Loss: 1.421 Test Acc: 0.574
Validation loss decreased (-0.466651 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 1.1398444175720215
Epoch: 7, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 8 cost time: 1.1447410583496094
Epoch: 8, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.581468 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 1.1114318370819092
Epoch: 9, Steps: 2 | Train Loss: 0.522 Vali Loss: 1.115 Vali Acc: 0.593 Test Loss: 1.115 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1449072360992432
Epoch: 10, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.054 Vali Acc: 0.611 Test Loss: 1.054 Test Acc: 0.611
Validation loss decreased (-0.599988 --> -0.611101).  Saving model ...
Epoch: 11 cost time: 1.1722655296325684
Epoch: 11, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.996 Vali Acc: 0.633 Test Loss: 0.996 Test Acc: 0.633
Validation loss decreased (-0.611101 --> -0.633323).  Saving model ...
Epoch: 12 cost time: 1.1848881244659424
Epoch: 12, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.941 Vali Acc: 0.648 Test Loss: 0.941 Test Acc: 0.648
Validation loss decreased (-0.633323 --> -0.648139).  Saving model ...
Epoch: 13 cost time: 1.0320894718170166
Epoch: 13, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.895 Vali Acc: 0.674 Test Loss: 0.895 Test Acc: 0.674
Validation loss decreased (-0.648139 --> -0.674065).  Saving model ...
Epoch: 14 cost time: 1.084519863128662
Epoch: 14, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
Validation loss decreased (-0.674065 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.9955732822418213
Epoch: 15, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.827 Vali Acc: 0.707 Test Loss: 0.827 Test Acc: 0.707
Validation loss decreased (-0.699991 --> -0.707399).  Saving model ...
Epoch: 16 cost time: 1.11124849319458
Epoch: 16, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.801 Vali Acc: 0.719 Test Loss: 0.801 Test Acc: 0.719
Validation loss decreased (-0.707399 --> -0.718511).  Saving model ...
Epoch: 17 cost time: 1.094480037689209
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722214).  Saving model ...
Epoch: 18 cost time: 0.986506462097168
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
Validation loss decreased (-0.722214 --> -0.740733).  Saving model ...
Epoch: 19 cost time: 0.9938838481903076
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
Validation loss decreased (-0.740733 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.1666572093963623
Epoch: 20, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.763 Test Loss: 0.743 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762956).  Saving model ...
Epoch: 21 cost time: 1.048982858657837
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.778 Test Loss: 0.736 Test Acc: 0.778
Validation loss decreased (-0.762956 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 1.0296683311462402
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 1.1335983276367188
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.781 Test Loss: 0.727 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 24 cost time: 1.3537883758544922
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.785 Test Loss: 0.724 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 25 cost time: 1.1415228843688965
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.785 Test Loss: 0.722 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 26 cost time: 1.0548264980316162
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.785 Test Loss: 0.720 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 27 cost time: 1.179783582687378
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 28 cost time: 1.194211483001709
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 0.9983224868774414
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 1.0662562847137451
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.789 Test Loss: 0.713 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 31 cost time: 1.0047180652618408
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.789 Test Loss: 0.711 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 32 cost time: 1.1338894367218018
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 33 cost time: 1.1579229831695557
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 34 cost time: 1.0626802444458008
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
Validation loss decreased (-0.788882 --> -0.796289).  Saving model ...
Epoch: 35 cost time: 1.1736605167388916
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.796 Test Loss: 0.706 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 36 cost time: 1.0354559421539307
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.796 Test Loss: 0.706 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 37 cost time: 1.1356441974639893
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 38 cost time: 1.0932469367980957
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.796 Test Loss: 0.704 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 39 cost time: 1.059772253036499
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.796 Test Loss: 0.704 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 40 cost time: 1.1288633346557617
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 41 cost time: 1.1060879230499268
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.804 Test Loss: 0.703 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 42 cost time: 1.1468405723571777
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.807 Test Loss: 0.702 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807400).  Saving model ...
Epoch: 43 cost time: 1.3461899757385254
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.807 Test Loss: 0.701 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 44 cost time: 1.1971426010131836
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.807 Test Loss: 0.701 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 45 cost time: 1.2250781059265137
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.807 Test Loss: 0.700 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 46 cost time: 1.2531671524047852
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.807 Test Loss: 0.699 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 47 cost time: 1.226351022720337
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.807 Test Loss: 0.699 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 48 cost time: 1.0783772468566895
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.807 Test Loss: 0.699 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 49 cost time: 1.1671223640441895
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.807 Test Loss: 0.698 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 50 cost time: 1.0540273189544678
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 51 cost time: 1.1748075485229492
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 52 cost time: 1.134232759475708
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 53 cost time: 1.210442304611206
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 54 cost time: 1.1272163391113281
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 55 cost time: 1.163970947265625
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.807 Test Loss: 0.697 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 56 cost time: 1.2401032447814941
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.807 Test Loss: 0.696 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 57 cost time: 1.227278470993042
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.807 Test Loss: 0.696 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 58 cost time: 1.1130545139312744
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.811 Test Loss: 0.696 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 59 cost time: 1.2165184020996094
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.811 Test Loss: 0.695 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 60 cost time: 1.2551133632659912
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 61 cost time: 1.1461617946624756
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 62 cost time: 1.1433968544006348
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 63 cost time: 1.1743381023406982
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 64 cost time: 1.2568612098693848
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 65 cost time: 1.207432746887207
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 66 cost time: 1.2644529342651367
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 67 cost time: 1.2833404541015625
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 68 cost time: 1.0813426971435547
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 69 cost time: 1.2182016372680664
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 70 cost time: 1.2175559997558594
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 71 cost time: 1.1298294067382812
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 72 cost time: 1.1972923278808594
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 73 cost time: 1.2506797313690186
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 74 cost time: 1.2229092121124268
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 75 cost time: 1.2801721096038818
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 76 cost time: 1.1492319107055664
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 77 cost time: 1.1806426048278809
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 78 cost time: 1.0724263191223145
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 79 cost time: 1.195220708847046
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 80 cost time: 1.2092645168304443
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 81 cost time: 0.9986312389373779
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.811 Test Loss: 0.688 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 82 cost time: 1.2405002117156982
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.811 Test Loss: 0.688 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 83 cost time: 1.1269645690917969
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 84 cost time: 1.2113537788391113
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 85 cost time: 1.2919485569000244
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 86 cost time: 1.11981201171875
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 87 cost time: 1.15456223487854
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 88 cost time: 0.9962015151977539
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 89 cost time: 1.2317631244659424
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 90 cost time: 1.2085459232330322
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 91 cost time: 1.111027717590332
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 92 cost time: 1.2745850086212158
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 93 cost time: 1.077930212020874
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 94 cost time: 1.182074785232544
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 95 cost time: 1.0269887447357178
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 96 cost time: 1.1567890644073486
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.815 Test Loss: 0.682 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 97 cost time: 1.2187795639038086
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 98 cost time: 1.2447443008422852
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 99 cost time: 1.216376543045044
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 100 cost time: 1.1525499820709229
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822215).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.826859951019287
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.814 Vali Acc: 0.133 Test Loss: 1.814 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.1203429698944092
Epoch: 2, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.794 Vali Acc: 0.159 Test Loss: 1.794 Test Acc: 0.159
Validation loss decreased (-0.133315 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 1.0840692520141602
Epoch: 3, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.747 Vali Acc: 0.226 Test Loss: 1.747 Test Acc: 0.226
Validation loss decreased (-0.159241 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 1.1119701862335205
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.648 Vali Acc: 0.400 Test Loss: 1.648 Test Acc: 0.400
Validation loss decreased (-0.225908 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.0099945068359375
Epoch: 5, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.527 Vali Acc: 0.485 Test Loss: 1.527 Test Acc: 0.485
Validation loss decreased (-0.399984 --> -0.485170).  Saving model ...
Epoch: 6 cost time: 1.075535535812378
Epoch: 6, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.391 Vali Acc: 0.574 Test Loss: 1.391 Test Acc: 0.574
Validation loss decreased (-0.485170 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 1.2371516227722168
Epoch: 7, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.252 Vali Acc: 0.626 Test Loss: 1.252 Test Acc: 0.626
Validation loss decreased (-0.574060 --> -0.625913).  Saving model ...
Epoch: 8 cost time: 1.165099859237671
Epoch: 8, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.112 Vali Acc: 0.707 Test Loss: 1.112 Test Acc: 0.707
Validation loss decreased (-0.625913 --> -0.707396).  Saving model ...
Epoch: 9 cost time: 1.1784019470214844
Epoch: 9, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.979 Vali Acc: 0.737 Test Loss: 0.979 Test Acc: 0.737
Validation loss decreased (-0.707396 --> -0.737027).  Saving model ...
Epoch: 10 cost time: 1.2097375392913818
Epoch: 10, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.868 Vali Acc: 0.726 Test Loss: 0.868 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.220677375793457
Epoch: 11, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.766 Vali Acc: 0.748 Test Loss: 0.766 Test Acc: 0.748
Validation loss decreased (-0.737027 --> -0.748140).  Saving model ...
Epoch: 12 cost time: 1.3675618171691895
Epoch: 12, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
Validation loss decreased (-0.748140 --> -0.770364).  Saving model ...
Epoch: 13 cost time: 1.2353129386901855
Epoch: 13, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
Validation loss decreased (-0.770364 --> -0.788883).  Saving model ...
Epoch: 14 cost time: 1.1451053619384766
Epoch: 14, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.591 Vali Acc: 0.781 Test Loss: 0.591 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0352306365966797
Epoch: 15, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 16 cost time: 1.0689482688903809
Epoch: 16, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.1844286918640137
Epoch: 17, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 18 cost time: 1.2547426223754883
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2287726402282715
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.480 Vali Acc: 0.807 Test Loss: 0.480 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807403).  Saving model ...
Epoch: 20 cost time: 1.3051292896270752
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.833 Test Loss: 0.461 Test Acc: 0.833
Validation loss decreased (-0.807403 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 1.178056240081787
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840736).  Saving model ...
Epoch: 22 cost time: 1.1510930061340332
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.856 Test Loss: 0.438 Test Acc: 0.856
Validation loss decreased (-0.840736 --> -0.855551).  Saving model ...
Epoch: 23 cost time: 1.2057924270629883
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
Validation loss decreased (-0.855551 --> -0.870366).  Saving model ...
Epoch: 24 cost time: 1.1801302433013916
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.208946943283081
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.874 Test Loss: 0.439 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 26 cost time: 1.0372743606567383
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877773).  Saving model ...
Epoch: 27 cost time: 1.2849841117858887
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.15559983253479
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.874 Test Loss: 0.449 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.231940507888794
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.874 Test Loss: 0.453 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2064204216003418
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.874 Test Loss: 0.458 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1670691967010498
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.874 Test Loss: 0.461 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1789281368255615
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.874 Test Loss: 0.463 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1997745037078857
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.874 Test Loss: 0.464 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1528093814849854
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.874 Test Loss: 0.465 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1277894973754883
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1758639812469482
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2415430545806885
Epoch: 1, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.816 Vali Acc: 0.170 Test Loss: 1.816 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.0519564151763916
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.800 Vali Acc: 0.174 Test Loss: 1.800 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 1.0847947597503662
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.710 Vali Acc: 0.263 Test Loss: 1.710 Test Acc: 0.263
Validation loss decreased (-0.174056 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 1.0782215595245361
Epoch: 4, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.494 Vali Acc: 0.511 Test Loss: 1.494 Test Acc: 0.511
Validation loss decreased (-0.262946 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 1.0715861320495605
Epoch: 5, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.264 Vali Acc: 0.704 Test Loss: 1.264 Test Acc: 0.704
Validation loss decreased (-0.511096 --> -0.703691).  Saving model ...
Epoch: 6 cost time: 1.2127716541290283
Epoch: 6, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.047 Vali Acc: 0.781 Test Loss: 1.047 Test Acc: 0.781
Validation loss decreased (-0.703691 --> -0.781471).  Saving model ...
Epoch: 7 cost time: 1.1394751071929932
Epoch: 7, Steps: 2 | Train Loss: 1.304 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
Validation loss decreased (-0.781471 --> -0.833325).  Saving model ...
Epoch: 8 cost time: 1.0518178939819336
Epoch: 8, Steps: 2 | Train Loss: 1.224 Vali Loss: 0.699 Vali Acc: 0.870 Test Loss: 0.699 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.870363).  Saving model ...
Epoch: 9 cost time: 1.084815502166748
Epoch: 9, Steps: 2 | Train Loss: 1.050 Vali Loss: 0.571 Vali Acc: 0.881 Test Loss: 0.571 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881476).  Saving model ...
Epoch: 10 cost time: 1.1601665019989014
Epoch: 10, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.477 Vali Acc: 0.896 Test Loss: 0.477 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896292).  Saving model ...
Epoch: 11 cost time: 1.2956910133361816
Epoch: 11, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.1393191814422607
Epoch: 12, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 1.1430072784423828
Epoch: 13, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.300 Vali Acc: 0.907 Test Loss: 0.300 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 1.0265467166900635
Epoch: 14, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0476036071777344
Epoch: 15, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.296 Vali Acc: 0.885 Test Loss: 0.296 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.000398874282837
Epoch: 16, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.158151388168335
Epoch: 17, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.245 Vali Acc: 0.907 Test Loss: 0.245 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 18 cost time: 1.0778450965881348
Epoch: 18, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.907405 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 1.0951588153839111
Epoch: 19, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.915 Test Loss: 0.244 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2505052089691162
Epoch: 20, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.268 Vali Acc: 0.915 Test Loss: 0.268 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1742033958435059
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.295 Vali Acc: 0.915 Test Loss: 0.295 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1144866943359375
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.316 Vali Acc: 0.915 Test Loss: 0.316 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1640064716339111
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3248875141143799
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2175407409667969
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0759458541870117
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1609368324279785
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2495522499084473
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 1.1999754905700684
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 1.1326110363006592
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 1.1836998462677002
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 1.2847042083740234
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 1.2083392143249512
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 1.1574082374572754
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 1.1909513473510742
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 1.0804531574249268
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 1.0887305736541748
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 1.0357732772827148
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 1.2897067070007324
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 1.26568603515625
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 1.0837562084197998
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 1.0280303955078125
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 1.0637967586517334
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 1.0641262531280518
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 1.0859119892120361
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 1.097496747970581
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 1.060624361038208
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 1.0137760639190674
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0598680973052979
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1340703964233398
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2194852828979492
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2907462120056152
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0765118598937988
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0392892360687256
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2556157112121582
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1465144157409668
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1276981830596924
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1077840328216553
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.833 Vali Acc: 0.178 Test Loss: 1.833 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.0049660205841064
Epoch: 2, Steps: 2 | Train Loss: 1.997 Vali Loss: 1.820 Vali Acc: 0.178 Test Loss: 1.820 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.9797446727752686
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.702 Vali Acc: 0.326 Test Loss: 1.702 Test Acc: 0.326
Validation loss decreased (-0.177760 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 1.1934573650360107
Epoch: 4, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.418 Vali Acc: 0.537 Test Loss: 1.418 Test Acc: 0.537
Validation loss decreased (-0.325909 --> -0.537023).  Saving model ...
Epoch: 5 cost time: 1.1018297672271729
Epoch: 5, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.142 Vali Acc: 0.726 Test Loss: 1.142 Test Acc: 0.726
Validation loss decreased (-0.537023 --> -0.725915).  Saving model ...
Epoch: 6 cost time: 1.1117396354675293
Epoch: 6, Steps: 2 | Train Loss: 1.638 Vali Loss: 0.908 Vali Acc: 0.826 Test Loss: 0.908 Test Acc: 0.826
Validation loss decreased (-0.725915 --> -0.825917).  Saving model ...
Epoch: 7 cost time: 1.0962600708007812
Epoch: 7, Steps: 2 | Train Loss: 1.562 Vali Loss: 0.721 Vali Acc: 0.870 Test Loss: 0.721 Test Acc: 0.870
Validation loss decreased (-0.825917 --> -0.870363).  Saving model ...
Epoch: 8 cost time: 1.046980381011963
Epoch: 8, Steps: 2 | Train Loss: 1.224 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 1.144918441772461
Epoch: 9, Steps: 2 | Train Loss: 1.168 Vali Loss: 0.471 Vali Acc: 0.896 Test Loss: 0.471 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896292).  Saving model ...
Epoch: 10 cost time: 1.0984585285186768
Epoch: 10, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 11 cost time: 1.1657464504241943
Epoch: 11, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.337 Vali Acc: 0.907 Test Loss: 0.337 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 12 cost time: 1.1833910942077637
Epoch: 12, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 1.118502140045166
Epoch: 13, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.076183795928955
Epoch: 14, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.272 Vali Acc: 0.907 Test Loss: 0.272 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.095557451248169
Epoch: 15, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.269 Vali Acc: 0.904 Test Loss: 0.269 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1599581241607666
Epoch: 16, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 1.2132272720336914
Epoch: 17, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 18 cost time: 1.0862030982971191
Epoch: 18, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1726608276367188
Epoch: 19, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0749850273132324
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2309026718139648
Epoch: 21, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0213477611541748
Epoch: 22, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.046360731124878
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.904 Test Loss: 0.319 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1342763900756836
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.907 Test Loss: 0.314 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.245941400527954
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1641318798065186
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1494464874267578
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8028972148895264
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1601893901824951
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.1046350002288818
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.1025903224945068
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.0723896026611328
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.068636178970337
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1293010711669922
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.073913812637329
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.0719218254089355
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.0664427280426025
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.2621707916259766
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1051430702209473
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2468547821044922
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0123238563537598
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.144080400466919
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.2142415046691895
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.1924316883087158
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.307760238647461
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.1425249576568604
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.1197960376739502
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 1.0933940410614014
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.018402338027954
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0781562328338623
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2291278839111328
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.0571236610412598
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1561777591705322
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2396221160888672
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.160559892654419
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.0816237926483154
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0001137256622314
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1351127624511719
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.1754786968231201
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3188700675964355
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.24245023727417
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.2314307689666748
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1761467456817627
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.033947229385376
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0492613315582275
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.1006200313568115
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0627801418304443
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1660819053649902
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.1876814365386963
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1681971549987793
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1614058017730713
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1076328754425049
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0416395664215088
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1186144351959229
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0771634578704834
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.042860746383667
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.0222113132476807
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1649672985076904
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0934643745422363
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0764193534851074
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0436062812805176
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.1745572090148926
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2843797206878662
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0464236736297607
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.0830135345458984
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.949164867401123
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.055612564086914
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9644417762756348
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.169713020324707
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.225520133972168
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.1456339359283447
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2420380115509033
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.19736909866333
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.1308503150939941
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.0826547145843506
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.2842752933502197
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0623698234558105
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.1548810005187988
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.2303481101989746
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.2011194229125977
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.0992748737335205
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.1069085597991943
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.1902410984039307
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.2023181915283203
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.091094970703125
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.103816032409668
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.0247581005096436
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.1797704696655273
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1829829216003418
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.1356422901153564
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.07340407371521
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.0842106342315674
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.9934632778167725
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.2187206745147705
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.0760447978973389
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.3535053730010986
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.2094979286193848
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.205822229385376
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.213001012802124
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.178492784500122
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.116281270980835
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.1425554752349854
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.107578992843628
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.1543052196502686
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 1.0732333660125732
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 1.1352145671844482
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 1.2009825706481934
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 11765254
model size : 64.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7479958534240723
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.669 Vali Acc: 0.326 Test Loss: 1.669 Test Acc: 0.326
Validation loss decreased (inf --> -0.325909).  Saving model ...
Epoch: 2 cost time: 1.1061227321624756
Epoch: 2, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.610 Vali Acc: 0.411 Test Loss: 1.610 Test Acc: 0.411
Validation loss decreased (-0.325909 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 1.0397541522979736
Epoch: 3, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.504 Vali Acc: 0.526 Test Loss: 1.504 Test Acc: 0.526
Validation loss decreased (-0.411095 --> -0.525911).  Saving model ...
Epoch: 4 cost time: 0.9697930812835693
Epoch: 4, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.310 Vali Acc: 0.719 Test Loss: 1.310 Test Acc: 0.719
Validation loss decreased (-0.525911 --> -0.718505).  Saving model ...
Epoch: 5 cost time: 1.0126750469207764
Epoch: 5, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.105 Vali Acc: 0.770 Test Loss: 1.105 Test Acc: 0.770
Validation loss decreased (-0.718505 --> -0.770359).  Saving model ...
Epoch: 6 cost time: 1.0755932331085205
Epoch: 6, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.921 Vali Acc: 0.785 Test Loss: 0.921 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785176).  Saving model ...
Epoch: 7 cost time: 1.2025477886199951
Epoch: 7, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.773 Vali Acc: 0.796 Test Loss: 0.773 Test Acc: 0.796
Validation loss decreased (-0.785176 --> -0.796289).  Saving model ...
Epoch: 8 cost time: 1.0445530414581299
Epoch: 8, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
Validation loss decreased (-0.796289 --> -0.818512).  Saving model ...
Epoch: 9 cost time: 1.060389518737793
Epoch: 9, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818513).  Saving model ...
Epoch: 10 cost time: 1.0730857849121094
Epoch: 10, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 11 cost time: 1.2109830379486084
Epoch: 11, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 12 cost time: 1.0933160781860352
Epoch: 12, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.830 Test Loss: 0.545 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 13 cost time: 1.1263282299041748
Epoch: 13, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.2723960876464844
Epoch: 14, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.830 Test Loss: 0.562 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.230085849761963
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0483078956604004
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.837 Test Loss: 0.578 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 17 cost time: 0.9870717525482178
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 18 cost time: 1.0865156650543213
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.153745174407959
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.131786584854126
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0519871711730957
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1219029426574707
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.976771354675293
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.156395435333252
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1555819511413574
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1559007167816162
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
Validation loss decreased (-0.840735 --> -0.848142).  Saving model ...
Epoch: 27 cost time: 1.2628960609436035
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.852 Test Loss: 0.612 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 28 cost time: 1.14292573928833
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.852 Test Loss: 0.613 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0576562881469727
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.852 Test Loss: 0.613 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1043956279754639
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855549).  Saving model ...
Epoch: 31 cost time: 1.004758596420288
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 0.9911141395568848
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 33 cost time: 1.142045497894287
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 1.1453349590301514
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 35 cost time: 1.2012298107147217
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 1.0851635932922363
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 37 cost time: 1.0728697776794434
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 38 cost time: 1.0646581649780273
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 39 cost time: 1.0885365009307861
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 40 cost time: 1.1064550876617432
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 41 cost time: 1.0461320877075195
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 42 cost time: 1.0099077224731445
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 43 cost time: 1.0358519554138184
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 44 cost time: 1.0444786548614502
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 45 cost time: 1.213573694229126
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 46 cost time: 1.040231704711914
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 47 cost time: 1.1053431034088135
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 48 cost time: 1.0702438354492188
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 49 cost time: 1.1826603412628174
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.859 Test Loss: 0.607 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 50 cost time: 1.225405216217041
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.859 Test Loss: 0.607 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 51 cost time: 1.1839776039123535
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.859 Test Loss: 0.606 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 52 cost time: 1.1507115364074707
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.859 Test Loss: 0.606 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 53 cost time: 1.0733671188354492
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 54 cost time: 1.1349830627441406
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 55 cost time: 1.0922863483428955
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 56 cost time: 1.1298322677612305
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.859 Test Loss: 0.604 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 57 cost time: 1.1094436645507812
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.859 Test Loss: 0.604 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 58 cost time: 1.214629888534546
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.859 Test Loss: 0.603 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 59 cost time: 1.0259602069854736
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.859 Test Loss: 0.603 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 60 cost time: 1.0550892353057861
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 61 cost time: 1.0522129535675049
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 62 cost time: 0.9912924766540527
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 63 cost time: 0.9706807136535645
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 64 cost time: 1.036207675933838
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 65 cost time: 1.1834595203399658
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.859 Test Loss: 0.600 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 66 cost time: 0.9793720245361328
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.859 Test Loss: 0.600 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 67 cost time: 1.1963255405426025
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 68 cost time: 1.1327793598175049
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 69 cost time: 1.2660527229309082
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 70 cost time: 1.0898430347442627
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 71 cost time: 1.2779788970947266
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 72 cost time: 1.1920642852783203
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.859 Test Loss: 0.597 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 73 cost time: 1.1399061679840088
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.859 Test Loss: 0.597 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 74 cost time: 1.2404143810272217
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.859 Test Loss: 0.596 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 75 cost time: 1.2263340950012207
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.859 Test Loss: 0.596 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 76 cost time: 1.3195693492889404
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 77 cost time: 1.2919282913208008
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.863 Test Loss: 0.595 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 78 cost time: 1.118821620941162
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 79 cost time: 1.1790704727172852
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.870 Test Loss: 0.594 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870364).  Saving model ...
Epoch: 80 cost time: 1.1581735610961914
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.870 Test Loss: 0.594 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 81 cost time: 1.0287806987762451
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.870 Test Loss: 0.593 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 82 cost time: 1.2303109169006348
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.870 Test Loss: 0.593 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 83 cost time: 1.2366726398468018
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.870 Test Loss: 0.593 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 84 cost time: 1.3394699096679688
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.870 Test Loss: 0.592 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 85 cost time: 1.1446897983551025
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.870 Test Loss: 0.592 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 86 cost time: 1.1387574672698975
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.870 Test Loss: 0.591 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 87 cost time: 1.140336275100708
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.870 Test Loss: 0.591 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 88 cost time: 1.1675310134887695
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.870 Test Loss: 0.590 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 89 cost time: 1.0656466484069824
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.870 Test Loss: 0.590 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 90 cost time: 1.111407995223999
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 91 cost time: 1.1340410709381104
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.870 Test Loss: 0.588 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 92 cost time: 1.0921008586883545
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.870 Test Loss: 0.588 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 93 cost time: 1.1529173851013184
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.870 Test Loss: 0.587 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 94 cost time: 1.185777187347412
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.870 Test Loss: 0.587 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870365).  Saving model ...
Epoch: 95 cost time: 1.286940574645996
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.870 Test Loss: 0.586 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 96 cost time: 1.2577564716339111
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.870 Test Loss: 0.585 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 97 cost time: 1.2623155117034912
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.870 Test Loss: 0.585 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 98 cost time: 1.1941232681274414
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.870 Test Loss: 0.584 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 99 cost time: 1.2359325885772705
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.870 Test Loss: 0.584 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 100 cost time: 1.2255897521972656
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.870 Test Loss: 0.584 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.697357177734375
Epoch: 1, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.689 Vali Acc: 0.330 Test Loss: 1.689 Test Acc: 0.330
Validation loss decreased (inf --> -0.329613).  Saving model ...
Epoch: 2 cost time: 1.1320011615753174
Epoch: 2, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.643 Vali Acc: 0.367 Test Loss: 1.643 Test Acc: 0.367
Validation loss decreased (-0.329613 --> -0.366650).  Saving model ...
Epoch: 3 cost time: 1.1885807514190674
Epoch: 3, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.561 Vali Acc: 0.470 Test Loss: 1.561 Test Acc: 0.470
Validation loss decreased (-0.366650 --> -0.470355).  Saving model ...
Epoch: 4 cost time: 1.016589879989624
Epoch: 4, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.409 Vali Acc: 0.630 Test Loss: 1.409 Test Acc: 0.630
Validation loss decreased (-0.470355 --> -0.629616).  Saving model ...
Epoch: 5 cost time: 1.0350327491760254
Epoch: 5, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.248 Vali Acc: 0.674 Test Loss: 1.248 Test Acc: 0.674
Validation loss decreased (-0.629616 --> -0.674062).  Saving model ...
Epoch: 6 cost time: 1.0095210075378418
Epoch: 6, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.100 Vali Acc: 0.678 Test Loss: 1.100 Test Acc: 0.678
Validation loss decreased (-0.674062 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 1.0697822570800781
Epoch: 7, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 1.0933403968811035
Epoch: 8, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
Validation loss decreased (-0.722213 --> -0.729621).  Saving model ...
Epoch: 9 cost time: 1.1338510513305664
Epoch: 9, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.776 Vali Acc: 0.763 Test Loss: 0.776 Test Acc: 0.763
Validation loss decreased (-0.729621 --> -0.762955).  Saving model ...
Epoch: 10 cost time: 1.0952174663543701
Epoch: 10, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.728 Vali Acc: 0.770 Test Loss: 0.728 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 11 cost time: 1.0340144634246826
Epoch: 11, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.691 Vali Acc: 0.759 Test Loss: 0.691 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0792734622955322
Epoch: 12, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.673 Vali Acc: 0.767 Test Loss: 0.673 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1209182739257812
Epoch: 13, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.664 Vali Acc: 0.770 Test Loss: 0.664 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770364).  Saving model ...
Epoch: 14 cost time: 1.178612470626831
Epoch: 14, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.657 Vali Acc: 0.778 Test Loss: 0.657 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 1.1457018852233887
Epoch: 15, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.652 Vali Acc: 0.785 Test Loss: 0.652 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 16 cost time: 1.1455254554748535
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 1.0827007293701172
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
Validation loss decreased (-0.788882 --> -0.803697).  Saving model ...
Epoch: 18 cost time: 1.174102783203125
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 1.0842876434326172
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 20 cost time: 1.1328704357147217
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.815 Test Loss: 0.646 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 21 cost time: 0.9959671497344971
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.9645438194274902
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 1.151357650756836
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.826 Test Loss: 0.644 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825919).  Saving model ...
Epoch: 24 cost time: 1.2011396884918213
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.826 Test Loss: 0.643 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 25 cost time: 1.0965180397033691
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.830 Test Loss: 0.642 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 26 cost time: 1.1680643558502197
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.132953405380249
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 28 cost time: 1.0889391899108887
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 1.2058143615722656
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.0512032508850098
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 1.1706175804138184
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 1.1522600650787354
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.837 Test Loss: 0.632 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 33 cost time: 1.081845760345459
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.841 Test Loss: 0.631 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840734).  Saving model ...
Epoch: 34 cost time: 1.0651040077209473
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 35 cost time: 1.1353776454925537
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 36 cost time: 1.1252079010009766
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 37 cost time: 1.0793144702911377
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 38 cost time: 1.1496036052703857
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 39 cost time: 1.2590479850769043
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840735).  Saving model ...
Epoch: 40 cost time: 1.2009530067443848
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 41 cost time: 1.1533148288726807
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 42 cost time: 1.2926578521728516
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 43 cost time: 1.291332483291626
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.837 Test Loss: 0.618 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.078784704208374
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.837 Test Loss: 0.617 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1022882461547852
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.837 Test Loss: 0.616 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0506105422973633
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.837 Test Loss: 0.615 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.213029146194458
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.837 Test Loss: 0.614 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0789706707000732
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.837 Test Loss: 0.613 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1597795486450195
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1952040195465088
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.194490671157837
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.837 Test Loss: 0.611 Test Acc: 0.837
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1134157180786133
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.837 Test Loss: 0.610 Test Acc: 0.837
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8559913635253906
Epoch: 1, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.685 Vali Acc: 0.281 Test Loss: 1.685 Test Acc: 0.281
Validation loss decreased (inf --> -0.281465).  Saving model ...
Epoch: 2 cost time: 1.095510721206665
Epoch: 2, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.651 Vali Acc: 0.304 Test Loss: 1.651 Test Acc: 0.304
Validation loss decreased (-0.281465 --> -0.303687).  Saving model ...
Epoch: 3 cost time: 1.2198095321655273
Epoch: 3, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.587 Vali Acc: 0.407 Test Loss: 1.587 Test Acc: 0.407
Validation loss decreased (-0.303687 --> -0.407392).  Saving model ...
Epoch: 4 cost time: 1.0881779193878174
Epoch: 4, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.467 Vali Acc: 0.593 Test Loss: 1.467 Test Acc: 0.593
Validation loss decreased (-0.407392 --> -0.592578).  Saving model ...
Epoch: 5 cost time: 1.0964560508728027
Epoch: 5, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.336 Vali Acc: 0.626 Test Loss: 1.336 Test Acc: 0.626
Validation loss decreased (-0.592578 --> -0.625913).  Saving model ...
Epoch: 6 cost time: 1.181469440460205
Epoch: 6, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.212 Vali Acc: 0.648 Test Loss: 1.212 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648136).  Saving model ...
Epoch: 7 cost time: 1.1689093112945557
Epoch: 7, Steps: 2 | Train Loss: 0.713 Vali Loss: 1.092 Vali Acc: 0.674 Test Loss: 1.092 Test Acc: 0.674
Validation loss decreased (-0.648136 --> -0.674063).  Saving model ...
Epoch: 8 cost time: 1.1723382472991943
Epoch: 8, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.981 Vali Acc: 0.685 Test Loss: 0.981 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685175).  Saving model ...
Epoch: 9 cost time: 1.0812411308288574
Epoch: 9, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.891 Vali Acc: 0.722 Test Loss: 0.891 Test Acc: 0.722
Validation loss decreased (-0.685175 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 1.0962810516357422
Epoch: 10, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.835 Vali Acc: 0.730 Test Loss: 0.835 Test Acc: 0.730
Validation loss decreased (-0.722213 --> -0.729621).  Saving model ...
Epoch: 11 cost time: 1.040372610092163
Epoch: 11, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.794 Vali Acc: 0.741 Test Loss: 0.794 Test Acc: 0.741
Validation loss decreased (-0.729621 --> -0.740733).  Saving model ...
Epoch: 12 cost time: 1.1199066638946533
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.767 Vali Acc: 0.744 Test Loss: 0.767 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 1.2166674137115479
Epoch: 13, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.749 Vali Acc: 0.756 Test Loss: 0.749 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 1.2066452503204346
Epoch: 14, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.735 Vali Acc: 0.774 Test Loss: 0.735 Test Acc: 0.774
Validation loss decreased (-0.755548 --> -0.774067).  Saving model ...
Epoch: 15 cost time: 1.2138242721557617
Epoch: 15, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.727 Vali Acc: 0.781 Test Loss: 0.727 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781474).  Saving model ...
Epoch: 16 cost time: 1.2388005256652832
Epoch: 16, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.724 Vali Acc: 0.781 Test Loss: 0.724 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 17 cost time: 1.2952558994293213
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.781474 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 1.0704243183135986
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.793 Test Loss: 0.723 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792585).  Saving model ...
Epoch: 19 cost time: 1.2060160636901855
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.095416784286499
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.807 Test Loss: 0.724 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807400).  Saving model ...
Epoch: 21 cost time: 1.1532692909240723
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.811 Test Loss: 0.724 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.1611411571502686
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.819 Test Loss: 0.724 Test Acc: 0.819
Validation loss decreased (-0.811104 --> -0.818511).  Saving model ...
Epoch: 23 cost time: 1.1531662940979004
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.818511 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 1.1646957397460938
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 1.1759591102600098
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.822 Test Loss: 0.721 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 26 cost time: 1.4607291221618652
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 27 cost time: 1.0969288349151611
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 28 cost time: 1.0829250812530518
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 29 cost time: 1.1263253688812256
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.826 Test Loss: 0.714 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 30 cost time: 1.1424760818481445
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.826 Test Loss: 0.712 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 31 cost time: 1.1659824848175049
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 32 cost time: 1.0321874618530273
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.826 Test Loss: 0.707 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 33 cost time: 1.111198902130127
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.826 Test Loss: 0.705 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 34 cost time: 1.018423080444336
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.826 Test Loss: 0.703 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 35 cost time: 1.0572094917297363
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.830 Test Loss: 0.701 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 36 cost time: 1.0568568706512451
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.830 Test Loss: 0.699 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 37 cost time: 1.1573610305786133
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 1.2008640766143799
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.830 Test Loss: 0.695 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 39 cost time: 1.1050751209259033
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.830 Test Loss: 0.693 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 40 cost time: 1.1257853507995605
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.830 Test Loss: 0.691 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 41 cost time: 1.0673506259918213
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.830 Test Loss: 0.689 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 42 cost time: 1.189272165298462
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.830 Test Loss: 0.687 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 43 cost time: 1.186082124710083
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.830 Test Loss: 0.686 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 44 cost time: 0.9910881519317627
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.830 Test Loss: 0.684 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 45 cost time: 1.1506502628326416
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.830 Test Loss: 0.683 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 46 cost time: 1.1093368530273438
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.830 Test Loss: 0.682 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 47 cost time: 1.1142055988311768
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.830 Test Loss: 0.681 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 48 cost time: 1.060396432876587
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.830 Test Loss: 0.679 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 49 cost time: 0.9325065612792969
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 50 cost time: 1.046870231628418
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 51 cost time: 1.1344785690307617
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 52 cost time: 1.0833778381347656
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 53 cost time: 1.1788630485534668
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 54 cost time: 1.3200511932373047
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 55 cost time: 1.1626439094543457
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 56 cost time: 1.1755540370941162
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 57 cost time: 1.0998845100402832
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 58 cost time: 1.108144760131836
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 59 cost time: 1.1813416481018066
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 60 cost time: 1.1895511150360107
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 61 cost time: 1.1215972900390625
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 62 cost time: 1.195059061050415
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 63 cost time: 1.056614875793457
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 64 cost time: 1.0998225212097168
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 65 cost time: 1.2134077548980713
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 66 cost time: 1.0275757312774658
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 67 cost time: 1.0475707054138184
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 68 cost time: 1.0113599300384521
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 69 cost time: 1.1413354873657227
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 70 cost time: 1.1072020530700684
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 71 cost time: 1.1781296730041504
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 72 cost time: 1.243715763092041
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 73 cost time: 1.1468210220336914
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 74 cost time: 1.0890393257141113
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 75 cost time: 1.0958647727966309
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 76 cost time: 1.0922763347625732
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 77 cost time: 1.0998797416687012
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 78 cost time: 1.1961472034454346
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 79 cost time: 1.2025196552276611
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 80 cost time: 1.1926801204681396
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 81 cost time: 1.1647825241088867
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 82 cost time: 1.2565486431121826
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 83 cost time: 1.0604453086853027
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 84 cost time: 1.0762789249420166
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 85 cost time: 1.0595860481262207
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 86 cost time: 1.1047453880310059
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 87 cost time: 1.0823919773101807
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 88 cost time: 1.2020745277404785
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 89 cost time: 1.270575761795044
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 90 cost time: 1.1976292133331299
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 91 cost time: 1.1672589778900146
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 92 cost time: 0.9804368019104004
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 93 cost time: 1.1941723823547363
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 94 cost time: 1.1264476776123047
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 95 cost time: 1.1804578304290771
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 96 cost time: 1.0473048686981201
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 97 cost time: 1.101743459701538
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 98 cost time: 1.1265602111816406
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 99 cost time: 1.1682054996490479
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 100 cost time: 1.2005736827850342
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.837 Test Loss: 0.651 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9541046619415283
Epoch: 1, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.737 Vali Acc: 0.222 Test Loss: 1.737 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.0328490734100342
Epoch: 2, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.715 Vali Acc: 0.230 Test Loss: 1.715 Test Acc: 0.230
Validation loss decreased (-0.222205 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 1.0058977603912354
Epoch: 3, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.670 Vali Acc: 0.274 Test Loss: 1.670 Test Acc: 0.274
Validation loss decreased (-0.229612 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 1.0458040237426758
Epoch: 4, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.581 Vali Acc: 0.411 Test Loss: 1.581 Test Acc: 0.411
Validation loss decreased (-0.274057 --> -0.411095).  Saving model ...
Epoch: 5 cost time: 1.1493172645568848
Epoch: 5, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.480 Vali Acc: 0.515 Test Loss: 1.480 Test Acc: 0.515
Validation loss decreased (-0.411095 --> -0.514800).  Saving model ...
Epoch: 6 cost time: 1.2420709133148193
Epoch: 6, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.376 Vali Acc: 0.541 Test Loss: 1.376 Test Acc: 0.541
Validation loss decreased (-0.514800 --> -0.540727).  Saving model ...
Epoch: 7 cost time: 1.1044261455535889
Epoch: 7, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.272 Vali Acc: 0.578 Test Loss: 1.272 Test Acc: 0.578
Validation loss decreased (-0.540727 --> -0.577765).  Saving model ...
Epoch: 8 cost time: 0.9859058856964111
Epoch: 8, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.172 Vali Acc: 0.593 Test Loss: 1.172 Test Acc: 0.593
Validation loss decreased (-0.577765 --> -0.592581).  Saving model ...
Epoch: 9 cost time: 1.0914127826690674
Epoch: 9, Steps: 2 | Train Loss: 0.535 Vali Loss: 1.083 Vali Acc: 0.619 Test Loss: 1.083 Test Acc: 0.619
Validation loss decreased (-0.592581 --> -0.618508).  Saving model ...
Epoch: 10 cost time: 1.1717114448547363
Epoch: 10, Steps: 2 | Train Loss: 0.391 Vali Loss: 1.007 Vali Acc: 0.644 Test Loss: 1.007 Test Acc: 0.644
Validation loss decreased (-0.618508 --> -0.644434).  Saving model ...
Epoch: 11 cost time: 1.0515737533569336
Epoch: 11, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.940 Vali Acc: 0.670 Test Loss: 0.940 Test Acc: 0.670
Validation loss decreased (-0.644434 --> -0.670361).  Saving model ...
Epoch: 12 cost time: 1.1833877563476562
Epoch: 12, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.894 Vali Acc: 0.681 Test Loss: 0.894 Test Acc: 0.681
Validation loss decreased (-0.670361 --> -0.681473).  Saving model ...
Epoch: 13 cost time: 1.1740198135375977
Epoch: 13, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.858 Vali Acc: 0.696 Test Loss: 0.858 Test Acc: 0.696
Validation loss decreased (-0.681473 --> -0.696288).  Saving model ...
Epoch: 14 cost time: 1.087630271911621
Epoch: 14, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.822 Vali Acc: 0.707 Test Loss: 0.822 Test Acc: 0.707
Validation loss decreased (-0.696288 --> -0.707399).  Saving model ...
Epoch: 15 cost time: 1.292534589767456
Epoch: 15, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.790 Vali Acc: 0.722 Test Loss: 0.790 Test Acc: 0.722
Validation loss decreased (-0.707399 --> -0.722214).  Saving model ...
Epoch: 16 cost time: 1.075664758682251
Epoch: 16, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.757 Vali Acc: 0.730 Test Loss: 0.757 Test Acc: 0.730
Validation loss decreased (-0.722214 --> -0.729622).  Saving model ...
Epoch: 17 cost time: 1.2033488750457764
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.737 Test Loss: 0.726 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737030).  Saving model ...
Epoch: 18 cost time: 1.1905415058135986
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
Validation loss decreased (-0.737030 --> -0.755549).  Saving model ...
Epoch: 19 cost time: 0.9791293144226074
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
Validation loss decreased (-0.755549 --> -0.762956).  Saving model ...
Epoch: 20 cost time: 0.9943382740020752
Epoch: 20, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.781 Test Loss: 0.670 Test Acc: 0.781
Validation loss decreased (-0.762956 --> -0.781475).  Saving model ...
Epoch: 21 cost time: 1.1617536544799805
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.781 Test Loss: 0.659 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 22 cost time: 1.1844193935394287
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.785 Test Loss: 0.650 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 23 cost time: 1.2091524600982666
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.785 Test Loss: 0.643 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 24 cost time: 1.215439796447754
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
Validation loss decreased (-0.785179 --> -0.796290).  Saving model ...
Epoch: 25 cost time: 1.041490077972412
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.807 Test Loss: 0.634 Test Acc: 0.807
Validation loss decreased (-0.796290 --> -0.807401).  Saving model ...
Epoch: 26 cost time: 1.2500755786895752
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.815 Test Loss: 0.631 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814809).  Saving model ...
Epoch: 27 cost time: 1.1298065185546875
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 28 cost time: 1.1485936641693115
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 29 cost time: 1.0851991176605225
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 30 cost time: 1.2212176322937012
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 31 cost time: 1.161653995513916
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 32 cost time: 1.0966994762420654
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1083221435546875
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.13261079788208
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 35 cost time: 1.016951322555542
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.830 Test Loss: 0.625 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 36 cost time: 1.049830436706543
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 37 cost time: 1.1423516273498535
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1171770095825195
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0327727794647217
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1209940910339355
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1737329959869385
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1738595962524414
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.13914155960083
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.115473747253418
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1428155899047852
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1740684509277344
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9268758296966553
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.808 Vali Acc: 0.252 Test Loss: 1.808 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 1.0285305976867676
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.789 Vali Acc: 0.259 Test Loss: 1.789 Test Acc: 0.259
Validation loss decreased (-0.251834 --> -0.259241).  Saving model ...
Epoch: 3 cost time: 0.9994411468505859
Epoch: 3, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.742 Vali Acc: 0.296 Test Loss: 1.742 Test Acc: 0.296
Validation loss decreased (-0.259241 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 1.164369821548462
Epoch: 4, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.644 Vali Acc: 0.381 Test Loss: 1.644 Test Acc: 0.381
Validation loss decreased (-0.296279 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 1.1700282096862793
Epoch: 5, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.526 Vali Acc: 0.489 Test Loss: 1.526 Test Acc: 0.489
Validation loss decreased (-0.381465 --> -0.488874).  Saving model ...
Epoch: 6 cost time: 1.103943109512329
Epoch: 6, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.398 Vali Acc: 0.556 Test Loss: 1.398 Test Acc: 0.556
Validation loss decreased (-0.488874 --> -0.555542).  Saving model ...
Epoch: 7 cost time: 1.0252139568328857
Epoch: 7, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.266 Vali Acc: 0.619 Test Loss: 1.266 Test Acc: 0.619
Validation loss decreased (-0.555542 --> -0.618506).  Saving model ...
Epoch: 8 cost time: 1.0593254566192627
Epoch: 8, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.134 Vali Acc: 0.674 Test Loss: 1.134 Test Acc: 0.674
Validation loss decreased (-0.618506 --> -0.674063).  Saving model ...
Epoch: 9 cost time: 0.9575190544128418
Epoch: 9, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.010 Vali Acc: 0.704 Test Loss: 1.010 Test Acc: 0.704
Validation loss decreased (-0.674063 --> -0.703694).  Saving model ...
Epoch: 10 cost time: 0.9232990741729736
Epoch: 10, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.892 Vali Acc: 0.741 Test Loss: 0.892 Test Acc: 0.741
Validation loss decreased (-0.703694 --> -0.740732).  Saving model ...
Epoch: 11 cost time: 1.000213384628296
Epoch: 11, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
Validation loss decreased (-0.740732 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 1.1483519077301025
Epoch: 12, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.686 Vali Acc: 0.781 Test Loss: 0.686 Test Acc: 0.781
Validation loss decreased (-0.755548 --> -0.781475).  Saving model ...
Epoch: 13 cost time: 0.9981422424316406
Epoch: 13, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
Validation loss decreased (-0.781475 --> -0.796290).  Saving model ...
Epoch: 14 cost time: 1.0004746913909912
Epoch: 14, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.039858102798462
Epoch: 15, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.563 Vali Acc: 0.793 Test Loss: 0.563 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9329845905303955
Epoch: 16, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 17 cost time: 0.9865355491638184
Epoch: 17, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.491 Vali Acc: 0.807 Test Loss: 0.491 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 18 cost time: 1.0482738018035889
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.811 Test Loss: 0.469 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811106).  Saving model ...
Epoch: 19 cost time: 1.1079356670379639
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.830 Test Loss: 0.445 Test Acc: 0.830
Validation loss decreased (-0.811106 --> -0.829625).  Saving model ...
Epoch: 20 cost time: 1.0725579261779785
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
Validation loss decreased (-0.829625 --> -0.840736).  Saving model ...
Epoch: 21 cost time: 1.0847265720367432
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.863 Test Loss: 0.418 Test Acc: 0.863
Validation loss decreased (-0.840736 --> -0.862959).  Saving model ...
Epoch: 22 cost time: 1.0059447288513184
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.862959 --> -0.870366).  Saving model ...
Epoch: 23 cost time: 1.2213561534881592
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.874 Test Loss: 0.408 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 24 cost time: 1.155992031097412
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.874 Test Loss: 0.411 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0621426105499268
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1433894634246826
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1273479461669922
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0310180187225342
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0222907066345215
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1164650917053223
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.206702470779419
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0809366703033447
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.125640869140625
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5199506282806396
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.818 Vali Acc: 0.211 Test Loss: 1.818 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.0089325904846191
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.804 Vali Acc: 0.215 Test Loss: 1.804 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.9212357997894287
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.725 Vali Acc: 0.296 Test Loss: 1.725 Test Acc: 0.296
Validation loss decreased (-0.214797 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 1.1208021640777588
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.538 Vali Acc: 0.407 Test Loss: 1.538 Test Acc: 0.407
Validation loss decreased (-0.296279 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 1.1235697269439697
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.326 Vali Acc: 0.567 Test Loss: 1.326 Test Acc: 0.567
Validation loss decreased (-0.407392 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 1.091273546218872
Epoch: 6, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.121 Vali Acc: 0.733 Test Loss: 1.121 Test Acc: 0.733
Validation loss decreased (-0.566653 --> -0.733322).  Saving model ...
Epoch: 7 cost time: 1.1416401863098145
Epoch: 7, Steps: 2 | Train Loss: 1.314 Vali Loss: 0.938 Vali Acc: 0.804 Test Loss: 0.938 Test Acc: 0.804
Validation loss decreased (-0.733322 --> -0.803694).  Saving model ...
Epoch: 8 cost time: 1.0477919578552246
Epoch: 8, Steps: 2 | Train Loss: 1.201 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
Validation loss decreased (-0.803694 --> -0.844437).  Saving model ...
Epoch: 9 cost time: 1.0721445083618164
Epoch: 9, Steps: 2 | Train Loss: 0.984 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
Validation loss decreased (-0.844437 --> -0.877771).  Saving model ...
Epoch: 10 cost time: 1.111788034439087
Epoch: 10, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.524 Vali Acc: 0.881 Test Loss: 0.524 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881476).  Saving model ...
Epoch: 11 cost time: 1.12477445602417
Epoch: 11, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.1538429260253906
Epoch: 12, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 13 cost time: 1.0484168529510498
Epoch: 13, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 1.033785343170166
Epoch: 14, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.280 Vali Acc: 0.907 Test Loss: 0.280 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0966646671295166
Epoch: 15, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.256 Vali Acc: 0.907 Test Loss: 0.256 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2792627811431885
Epoch: 16, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 1.2242021560668945
Epoch: 17, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 1.1317148208618164
Epoch: 18, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2925405502319336
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2442402839660645
Epoch: 20, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2156438827514648
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1153271198272705
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9767732620239258
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9831898212432861
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1206669807434082
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.204254388809204
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 1.1257798671722412
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 1.2655527591705322
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.162642002105713
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.0553879737854004
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9896543025970459
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 1.0922935009002686
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0765511989593506
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1451506614685059
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.089423418045044
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1192433834075928
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0071468353271484
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3433339595794678
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.948 Test Loss: 0.274 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.09751558303833
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0959241390228271
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0802855491638184
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.96279239654541
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.827 Vali Acc: 0.133 Test Loss: 1.827 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.136899709701538
Epoch: 2, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.814 Vali Acc: 0.159 Test Loss: 1.814 Test Acc: 0.159
Validation loss decreased (-0.133315 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 1.1007795333862305
Epoch: 3, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.700 Vali Acc: 0.304 Test Loss: 1.700 Test Acc: 0.304
Validation loss decreased (-0.159241 --> -0.303687).  Saving model ...
Epoch: 4 cost time: 1.2256360054016113
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.434 Vali Acc: 0.526 Test Loss: 1.434 Test Acc: 0.526
Validation loss decreased (-0.303687 --> -0.525912).  Saving model ...
Epoch: 5 cost time: 1.1163737773895264
Epoch: 5, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.168 Vali Acc: 0.704 Test Loss: 1.168 Test Acc: 0.704
Validation loss decreased (-0.525912 --> -0.703692).  Saving model ...
Epoch: 6 cost time: 1.18196439743042
Epoch: 6, Steps: 2 | Train Loss: 1.575 Vali Loss: 0.943 Vali Acc: 0.770 Test Loss: 0.943 Test Acc: 0.770
Validation loss decreased (-0.703692 --> -0.770361).  Saving model ...
Epoch: 7 cost time: 1.202685832977295
Epoch: 7, Steps: 2 | Train Loss: 1.464 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
Validation loss decreased (-0.770361 --> -0.822215).  Saving model ...
Epoch: 8 cost time: 1.1608574390411377
Epoch: 8, Steps: 2 | Train Loss: 1.287 Vali Loss: 0.627 Vali Acc: 0.852 Test Loss: 0.627 Test Acc: 0.852
Validation loss decreased (-0.822215 --> -0.851846).  Saving model ...
Epoch: 9 cost time: 1.253551959991455
Epoch: 9, Steps: 2 | Train Loss: 1.044 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 10 cost time: 1.0876398086547852
Epoch: 10, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
Validation loss decreased (-0.855550 --> -0.877773).  Saving model ...
Epoch: 11 cost time: 1.0549602508544922
Epoch: 11, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.391 Vali Acc: 0.878 Test Loss: 0.391 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.057006597518921
Epoch: 12, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 0.9820380210876465
Epoch: 13, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 1.0147573947906494
Epoch: 14, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 15 cost time: 1.0809991359710693
Epoch: 15, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1472039222717285
Epoch: 16, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.245 Vali Acc: 0.919 Test Loss: 0.245 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 1.0843603610992432
Epoch: 17, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 1.2516155242919922
Epoch: 18, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0615363121032715
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.066438913345337
Epoch: 20, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1511530876159668
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.9161596298217773
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0618183612823486
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0523264408111572
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 1.2108407020568848
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.0780930519104004
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0558772087097168
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2676708698272705
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1614274978637695
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0580260753631592
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1736290454864502
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0711987018585205
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1169734001159668
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0901331901550293
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2334191799163818
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.672776460647583
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.9662473201751709
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.9624693393707275
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.9673671722412109
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.953413724899292
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.026324987411499
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.0976948738098145
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0042753219604492
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0906603336334229
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0471036434173584
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.0793390274047852
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9380981922149658
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9792830944061279
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.021712303161621
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.0805516242980957
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 0.9929566383361816
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0505220890045166
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.04703688621521
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.158123254776001
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.1920781135559082
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 1.092402458190918
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.987276554107666
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0880796909332275
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.0721702575683594
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1613659858703613
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9647765159606934
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.0651378631591797
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.148125410079956
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.2515945434570312
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.0713839530944824
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1849555969238281
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1093049049377441
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2456245422363281
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0304851531982422
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9797506332397461
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.035611867904663
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.162548303604126
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2329308986663818
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1482081413269043
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 10192390
model size : 58.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6720173358917236
Epoch: 1, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.807 Vali Acc: 0.152 Test Loss: 1.807 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 1.1846106052398682
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.733 Vali Acc: 0.237 Test Loss: 1.733 Test Acc: 0.237
Validation loss decreased (-0.151834 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 1.03867506980896
Epoch: 3, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.618 Vali Acc: 0.411 Test Loss: 1.618 Test Acc: 0.411
Validation loss decreased (-0.237020 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 1.0331711769104004
Epoch: 4, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.417 Vali Acc: 0.630 Test Loss: 1.417 Test Acc: 0.630
Validation loss decreased (-0.411095 --> -0.629615).  Saving model ...
Epoch: 5 cost time: 1.0572483539581299
Epoch: 5, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.198 Vali Acc: 0.744 Test Loss: 1.198 Test Acc: 0.744
Validation loss decreased (-0.629615 --> -0.744432).  Saving model ...
Epoch: 6 cost time: 1.108665943145752
Epoch: 6, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.995 Vali Acc: 0.778 Test Loss: 0.995 Test Acc: 0.778
Validation loss decreased (-0.744432 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 1.217198133468628
Epoch: 7, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.832 Vali Acc: 0.811 Test Loss: 0.832 Test Acc: 0.811
Validation loss decreased (-0.777768 --> -0.811103).  Saving model ...
Epoch: 8 cost time: 1.0419325828552246
Epoch: 8, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 9 cost time: 1.154348373413086
Epoch: 9, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.1480801105499268
Epoch: 10, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.584 Vali Acc: 0.837 Test Loss: 0.584 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 11 cost time: 0.9549858570098877
Epoch: 11, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9967875480651855
Epoch: 12, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0342843532562256
Epoch: 13, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0269732475280762
Epoch: 14, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.545 Vali Acc: 0.837 Test Loss: 0.545 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837032).  Saving model ...
Epoch: 15 cost time: 1.032501459121704
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9831998348236084
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.837 Test Loss: 0.556 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0806353092193604
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 18 cost time: 1.188248634338379
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 19 cost time: 1.2118957042694092
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.852 Test Loss: 0.572 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851846).  Saving model ...
Epoch: 20 cost time: 0.9447972774505615
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.0276532173156738
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0229604244232178
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0500223636627197
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859253).  Saving model ...
Epoch: 24 cost time: 1.0364491939544678
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.859 Test Loss: 0.587 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0949509143829346
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.859 Test Loss: 0.588 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0890989303588867
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.859 Test Loss: 0.590 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1272354125976562
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1579337120056152
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.859 Test Loss: 0.592 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.086580514907837
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.859 Test Loss: 0.592 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9626133441925049
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9539570808410645
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1318974494934082
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0902290344238281
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0879464149475098
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.811 Vali Acc: 0.126 Test Loss: 1.811 Test Acc: 0.126
Validation loss decreased (inf --> -0.125908).  Saving model ...
Epoch: 2 cost time: 1.1374952793121338
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.751 Vali Acc: 0.174 Test Loss: 1.751 Test Acc: 0.174
Validation loss decreased (-0.125908 --> -0.174057).  Saving model ...
Epoch: 3 cost time: 1.2091608047485352
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.659 Vali Acc: 0.304 Test Loss: 1.659 Test Acc: 0.304
Validation loss decreased (-0.174057 --> -0.303687).  Saving model ...
Epoch: 4 cost time: 1.0419104099273682
Epoch: 4, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.496 Vali Acc: 0.556 Test Loss: 1.496 Test Acc: 0.556
Validation loss decreased (-0.303687 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 0.9558420181274414
Epoch: 5, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.318 Vali Acc: 0.659 Test Loss: 1.318 Test Acc: 0.659
Validation loss decreased (-0.555541 --> -0.659246).  Saving model ...
Epoch: 6 cost time: 1.1421117782592773
Epoch: 6, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.149 Vali Acc: 0.689 Test Loss: 1.149 Test Acc: 0.689
Validation loss decreased (-0.659246 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 0.9456315040588379
Epoch: 7, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.010 Vali Acc: 0.707 Test Loss: 1.010 Test Acc: 0.707
Validation loss decreased (-0.688877 --> -0.707397).  Saving model ...
Epoch: 8 cost time: 1.0104432106018066
Epoch: 8, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.900 Vali Acc: 0.719 Test Loss: 0.900 Test Acc: 0.719
Validation loss decreased (-0.707397 --> -0.718510).  Saving model ...
Epoch: 9 cost time: 1.0782198905944824
Epoch: 9, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.817 Vali Acc: 0.741 Test Loss: 0.817 Test Acc: 0.741
Validation loss decreased (-0.718510 --> -0.740733).  Saving model ...
Epoch: 10 cost time: 1.0156545639038086
Epoch: 10, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
Validation loss decreased (-0.740733 --> -0.762955).  Saving model ...
Epoch: 11 cost time: 1.0850090980529785
Epoch: 11, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 12 cost time: 1.1406848430633545
Epoch: 12, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.676 Vali Acc: 0.781 Test Loss: 0.676 Test Acc: 0.781
Validation loss decreased (-0.770363 --> -0.781475).  Saving model ...
Epoch: 13 cost time: 0.9932870864868164
Epoch: 13, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.656 Vali Acc: 0.781 Test Loss: 0.656 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 14 cost time: 1.088108777999878
Epoch: 14, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 0.98748779296875
Epoch: 15, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 1.0825285911560059
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
Validation loss decreased (-0.788882 --> -0.796290).  Saving model ...
Epoch: 17 cost time: 1.0422790050506592
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803697).  Saving model ...
Epoch: 18 cost time: 1.1002488136291504
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1681268215179443
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1373820304870605
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.807 Test Loss: 0.640 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 21 cost time: 1.0856404304504395
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.815 Test Loss: 0.641 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814808).  Saving model ...
Epoch: 22 cost time: 1.0898489952087402
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 23 cost time: 1.0235800743103027
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1189212799072266
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 1.0535626411437988
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.826 Test Loss: 0.645 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825919).  Saving model ...
Epoch: 26 cost time: 1.0160770416259766
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.826 Test Loss: 0.645 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.074415683746338
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.830 Test Loss: 0.644 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 28 cost time: 1.1364295482635498
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.830 Test Loss: 0.644 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 29 cost time: 1.1389055252075195
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.0357952117919922
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 1.1278529167175293
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 0.9582383632659912
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 0.9425041675567627
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 34 cost time: 0.9466195106506348
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 35 cost time: 1.075054407119751
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 36 cost time: 0.9998791217803955
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 37 cost time: 1.1167972087860107
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 38 cost time: 0.9926178455352783
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 0.988785982131958
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.0990853309631348
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.837 Test Loss: 0.635 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 41 cost time: 1.139650821685791
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.837 Test Loss: 0.634 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 42 cost time: 1.1739716529846191
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.837 Test Loss: 0.633 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 43 cost time: 1.0266008377075195
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.837 Test Loss: 0.632 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 44 cost time: 0.9800336360931396
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.837 Test Loss: 0.631 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 45 cost time: 1.0437726974487305
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.837 Test Loss: 0.631 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 46 cost time: 1.0086815357208252
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.837 Test Loss: 0.630 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 47 cost time: 0.9925329685211182
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.837 Test Loss: 0.629 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 48 cost time: 1.0537567138671875
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.837 Test Loss: 0.628 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 49 cost time: 1.3037495613098145
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.837 Test Loss: 0.627 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 50 cost time: 1.0918066501617432
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.837 Test Loss: 0.627 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 51 cost time: 1.1502902507781982
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.837 Test Loss: 0.626 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 52 cost time: 1.1100525856018066
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.837 Test Loss: 0.625 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 53 cost time: 1.015026330947876
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 54 cost time: 1.1078925132751465
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 55 cost time: 1.0948517322540283
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 56 cost time: 1.1313927173614502
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 57 cost time: 1.1274714469909668
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.837 Test Loss: 0.621 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 58 cost time: 1.0473155975341797
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.837 Test Loss: 0.620 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 59 cost time: 1.0089902877807617
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.837 Test Loss: 0.619 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 60 cost time: 0.9909279346466064
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0197737216949463
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 62 cost time: 1.1595311164855957
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 63 cost time: 1.0462563037872314
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844438).  Saving model ...
Epoch: 64 cost time: 1.0783171653747559
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.848 Test Loss: 0.616 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 65 cost time: 0.9927682876586914
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 66 cost time: 1.0601732730865479
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 67 cost time: 1.1269681453704834
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 68 cost time: 1.0508394241333008
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 69 cost time: 1.0033197402954102
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.848 Test Loss: 0.613 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 70 cost time: 1.0792245864868164
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 71 cost time: 1.080237865447998
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.852 Test Loss: 0.612 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 72 cost time: 1.0648164749145508
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.852 Test Loss: 0.611 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 73 cost time: 1.1796298027038574
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.852 Test Loss: 0.610 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 74 cost time: 1.0386009216308594
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.852 Test Loss: 0.610 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 75 cost time: 1.0659213066101074
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.852 Test Loss: 0.610 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 76 cost time: 1.1094932556152344
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.852 Test Loss: 0.609 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 77 cost time: 1.063314437866211
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.852 Test Loss: 0.609 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 78 cost time: 1.054992437362671
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.852 Test Loss: 0.608 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 79 cost time: 1.0930016040802002
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.852 Test Loss: 0.608 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 80 cost time: 1.089146375656128
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855549).  Saving model ...
Epoch: 81 cost time: 0.9632432460784912
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 82 cost time: 1.120818853378296
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 83 cost time: 1.0341143608093262
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 84 cost time: 1.0153253078460693
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 85 cost time: 1.0109097957611084
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 86 cost time: 1.1119768619537354
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 87 cost time: 0.9766507148742676
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 88 cost time: 1.084575891494751
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 89 cost time: 1.0850489139556885
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 90 cost time: 1.192559003829956
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 91 cost time: 1.1026740074157715
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 92 cost time: 1.060305118560791
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 93 cost time: 1.1289587020874023
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 94 cost time: 1.169646978378296
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 95 cost time: 1.1431493759155273
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 96 cost time: 1.0641674995422363
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 97 cost time: 1.0920205116271973
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 98 cost time: 1.0741121768951416
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 99 cost time: 1.0723416805267334
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.859 Test Loss: 0.600 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859253).  Saving model ...
Epoch: 100 cost time: 1.2073140144348145
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.835299491882324
Epoch: 1, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.794 Vali Acc: 0.148 Test Loss: 1.794 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.056361436843872
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.749 Vali Acc: 0.200 Test Loss: 1.749 Test Acc: 0.200
Validation loss decreased (-0.148130 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.0009551048278809
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.678 Vali Acc: 0.319 Test Loss: 1.678 Test Acc: 0.319
Validation loss decreased (-0.199983 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 1.1108579635620117
Epoch: 4, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.553 Vali Acc: 0.511 Test Loss: 1.553 Test Acc: 0.511
Validation loss decreased (-0.318502 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 1.031951904296875
Epoch: 5, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.411 Vali Acc: 0.600 Test Loss: 1.411 Test Acc: 0.600
Validation loss decreased (-0.511096 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.0103037357330322
Epoch: 6, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.269 Vali Acc: 0.667 Test Loss: 1.269 Test Acc: 0.667
Validation loss decreased (-0.599986 --> -0.666654).  Saving model ...
Epoch: 7 cost time: 1.0975196361541748
Epoch: 7, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.147 Vali Acc: 0.711 Test Loss: 1.147 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.9925343990325928
Epoch: 8, Steps: 2 | Train Loss: 0.608 Vali Loss: 1.040 Vali Acc: 0.726 Test Loss: 1.040 Test Acc: 0.726
Validation loss decreased (-0.711100 --> -0.725916).  Saving model ...
Epoch: 9 cost time: 1.0402441024780273
Epoch: 9, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 0.9903678894042969
Epoch: 10, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.884 Vali Acc: 0.730 Test Loss: 0.884 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.008582592010498
Epoch: 11, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 12 cost time: 1.1806299686431885
Epoch: 12, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 1.1334850788116455
Epoch: 13, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 14 cost time: 1.2513957023620605
Epoch: 14, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.731 Vali Acc: 0.774 Test Loss: 0.731 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774067).  Saving model ...
Epoch: 15 cost time: 1.0131721496582031
Epoch: 15, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.717 Vali Acc: 0.778 Test Loss: 0.717 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 1.0451767444610596
Epoch: 16, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 1.1407172679901123
Epoch: 17, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.796 Test Loss: 0.703 Test Acc: 0.796
Validation loss decreased (-0.777771 --> -0.796289).  Saving model ...
Epoch: 18 cost time: 1.096879005432129
Epoch: 18, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.796 Test Loss: 0.700 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 19 cost time: 1.093346118927002
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.807 Test Loss: 0.698 Test Acc: 0.807
Validation loss decreased (-0.796289 --> -0.807400).  Saving model ...
Epoch: 20 cost time: 1.111341953277588
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
Validation loss decreased (-0.807400 --> -0.818512).  Saving model ...
Epoch: 21 cost time: 1.1464710235595703
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.2131385803222656
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 1.2280728816986084
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 1.2457516193389893
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 25 cost time: 1.1914522647857666
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.830 Test Loss: 0.697 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 26 cost time: 1.174926519393921
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833326).  Saving model ...
Epoch: 27 cost time: 1.124431848526001
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.837 Test Loss: 0.695 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 28 cost time: 1.014829397201538
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.837 Test Loss: 0.694 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 29 cost time: 1.049849271774292
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.837 Test Loss: 0.692 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 30 cost time: 1.1633460521697998
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.837 Test Loss: 0.691 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 31 cost time: 1.201056957244873
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.837 Test Loss: 0.690 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 32 cost time: 1.202124834060669
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.837 Test Loss: 0.688 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 33 cost time: 1.2055635452270508
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.837 Test Loss: 0.687 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 34 cost time: 1.1754109859466553
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.837 Test Loss: 0.685 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 35 cost time: 1.0607531070709229
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.837 Test Loss: 0.684 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 36 cost time: 1.0343639850616455
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.837 Test Loss: 0.683 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 37 cost time: 1.20585036277771
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.837 Test Loss: 0.681 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 38 cost time: 1.0638213157653809
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.837 Test Loss: 0.680 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 39 cost time: 1.1235055923461914
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.837 Test Loss: 0.679 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 40 cost time: 1.2068865299224854
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.837 Test Loss: 0.678 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 41 cost time: 1.1704022884368896
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.837 Test Loss: 0.677 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 42 cost time: 1.113133192062378
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.837 Test Loss: 0.676 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 43 cost time: 1.1907415390014648
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.837 Test Loss: 0.675 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 44 cost time: 1.1634538173675537
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.837 Test Loss: 0.675 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 45 cost time: 1.126230239868164
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.837 Test Loss: 0.674 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 46 cost time: 1.199049472808838
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.837 Test Loss: 0.673 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 47 cost time: 1.128891944885254
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.837 Test Loss: 0.673 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 48 cost time: 1.046717882156372
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.837 Test Loss: 0.672 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 49 cost time: 1.1770763397216797
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.841 Test Loss: 0.671 Test Acc: 0.841
Validation loss decreased (-0.837030 --> -0.840734).  Saving model ...
Epoch: 50 cost time: 1.1904830932617188
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 51 cost time: 1.1448190212249756
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 52 cost time: 1.0700788497924805
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.841 Test Loss: 0.668 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 53 cost time: 1.2009589672088623
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 54 cost time: 1.065887451171875
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.841 Test Loss: 0.666 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 55 cost time: 1.1220805644989014
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 56 cost time: 1.053481101989746
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 57 cost time: 1.1442935466766357
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.841 Test Loss: 0.664 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 58 cost time: 1.14699387550354
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.841 Test Loss: 0.664 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 59 cost time: 1.213487148284912
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 60 cost time: 1.1673502922058105
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.841 Test Loss: 0.662 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 61 cost time: 1.1673870086669922
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.841 Test Loss: 0.662 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 62 cost time: 1.1431095600128174
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 63 cost time: 1.0307183265686035
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 64 cost time: 1.0403814315795898
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.841 Test Loss: 0.660 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 65 cost time: 1.081475019454956
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 66 cost time: 1.0744974613189697
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 67 cost time: 1.169151782989502
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 68 cost time: 1.2537052631378174
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 69 cost time: 1.2779521942138672
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840734).  Saving model ...
Epoch: 70 cost time: 1.225019931793213
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 71 cost time: 1.1223161220550537
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 72 cost time: 1.0490667819976807
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 73 cost time: 1.1105098724365234
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 74 cost time: 1.0305509567260742
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 75 cost time: 1.0429530143737793
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 76 cost time: 1.0180745124816895
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 77 cost time: 1.1019294261932373
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 78 cost time: 1.039330244064331
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 79 cost time: 1.1544220447540283
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 80 cost time: 0.9798901081085205
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 81 cost time: 1.0054280757904053
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 82 cost time: 1.151099681854248
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 83 cost time: 1.026230812072754
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 84 cost time: 1.1497900485992432
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 85 cost time: 1.1932032108306885
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 86 cost time: 1.0914299488067627
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 87 cost time: 1.0519342422485352
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 88 cost time: 1.0832579135894775
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 89 cost time: 1.084902286529541
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 90 cost time: 1.0500164031982422
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 91 cost time: 1.0693433284759521
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.848 Test Loss: 0.652 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 92 cost time: 1.1370396614074707
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.848 Test Loss: 0.651 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 93 cost time: 1.0481481552124023
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.848 Test Loss: 0.650 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 94 cost time: 1.1248352527618408
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.848 Test Loss: 0.650 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 95 cost time: 1.2335777282714844
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.848 Test Loss: 0.649 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 96 cost time: 1.1147470474243164
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.848 Test Loss: 0.649 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 97 cost time: 1.1132011413574219
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.848 Test Loss: 0.648 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 98 cost time: 1.219383955001831
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.848 Test Loss: 0.648 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 99 cost time: 1.091559886932373
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.848 Test Loss: 0.647 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 100 cost time: 1.0071845054626465
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.848 Test Loss: 0.647 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.752821445465088
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.841 Vali Acc: 0.130 Test Loss: 1.841 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 1.0398716926574707
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.808 Vali Acc: 0.174 Test Loss: 1.808 Test Acc: 0.174
Validation loss decreased (-0.129611 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 1.0408604145050049
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.174056 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 1.1904473304748535
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.665 Vali Acc: 0.356 Test Loss: 1.665 Test Acc: 0.356
Validation loss decreased (-0.225908 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 1.1272308826446533
Epoch: 5, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.557 Vali Acc: 0.444 Test Loss: 1.557 Test Acc: 0.444
Validation loss decreased (-0.355539 --> -0.444429).  Saving model ...
Epoch: 6 cost time: 1.0974338054656982
Epoch: 6, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.443 Vali Acc: 0.489 Test Loss: 1.443 Test Acc: 0.489
Validation loss decreased (-0.444429 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 0.91988205909729
Epoch: 7, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.338 Vali Acc: 0.530 Test Loss: 1.338 Test Acc: 0.530
Validation loss decreased (-0.488874 --> -0.529616).  Saving model ...
Epoch: 8 cost time: 1.0516228675842285
Epoch: 8, Steps: 2 | Train Loss: 0.802 Vali Loss: 1.241 Vali Acc: 0.574 Test Loss: 1.241 Test Acc: 0.574
Validation loss decreased (-0.529616 --> -0.574062).  Saving model ...
Epoch: 9 cost time: 1.0343255996704102
Epoch: 9, Steps: 2 | Train Loss: 0.619 Vali Loss: 1.154 Vali Acc: 0.585 Test Loss: 1.154 Test Acc: 0.585
Validation loss decreased (-0.574062 --> -0.585174).  Saving model ...
Epoch: 10 cost time: 0.9600834846496582
Epoch: 10, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.078 Vali Acc: 0.607 Test Loss: 1.078 Test Acc: 0.607
Validation loss decreased (-0.585174 --> -0.607397).  Saving model ...
Epoch: 11 cost time: 1.088083028793335
Epoch: 11, Steps: 2 | Train Loss: 0.304 Vali Loss: 1.009 Vali Acc: 0.626 Test Loss: 1.009 Test Acc: 0.626
Validation loss decreased (-0.607397 --> -0.625916).  Saving model ...
Epoch: 12 cost time: 1.101658821105957
Epoch: 12, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.943 Vali Acc: 0.656 Test Loss: 0.943 Test Acc: 0.656
Validation loss decreased (-0.625916 --> -0.655546).  Saving model ...
Epoch: 13 cost time: 1.114464282989502
Epoch: 13, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.881 Vali Acc: 0.681 Test Loss: 0.881 Test Acc: 0.681
Validation loss decreased (-0.655546 --> -0.681473).  Saving model ...
Epoch: 14 cost time: 1.034773826599121
Epoch: 14, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.831 Vali Acc: 0.696 Test Loss: 0.831 Test Acc: 0.696
Validation loss decreased (-0.681473 --> -0.696288).  Saving model ...
Epoch: 15 cost time: 1.048360824584961
Epoch: 15, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.792 Vali Acc: 0.722 Test Loss: 0.792 Test Acc: 0.722
Validation loss decreased (-0.696288 --> -0.722214).  Saving model ...
Epoch: 16 cost time: 1.0160527229309082
Epoch: 16, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 17 cost time: 1.0619711875915527
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.749 Vali Acc: 0.748 Test Loss: 0.749 Test Acc: 0.748
Validation loss decreased (-0.733326 --> -0.748141).  Saving model ...
Epoch: 18 cost time: 1.0812788009643555
Epoch: 18, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.759 Test Loss: 0.737 Test Acc: 0.759
Validation loss decreased (-0.748141 --> -0.759252).  Saving model ...
Epoch: 19 cost time: 0.9902584552764893
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9221296310424805
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.774 Test Loss: 0.718 Test Acc: 0.774
Validation loss decreased (-0.759252 --> -0.774067).  Saving model ...
Epoch: 21 cost time: 1.1014354228973389
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.785 Test Loss: 0.708 Test Acc: 0.785
Validation loss decreased (-0.774067 --> -0.785178).  Saving model ...
Epoch: 22 cost time: 1.0136706829071045
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.793 Test Loss: 0.698 Test Acc: 0.793
Validation loss decreased (-0.785178 --> -0.792586).  Saving model ...
Epoch: 23 cost time: 1.0876026153564453
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.796 Test Loss: 0.688 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 24 cost time: 1.1014528274536133
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
Validation loss decreased (-0.796289 --> -0.803697).  Saving model ...
Epoch: 25 cost time: 1.048008918762207
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.807 Test Loss: 0.671 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 26 cost time: 1.0679349899291992
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.807 Test Loss: 0.664 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 27 cost time: 1.0447943210601807
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.807 Test Loss: 0.657 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 28 cost time: 1.0506188869476318
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.807 Test Loss: 0.651 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 29 cost time: 1.0300507545471191
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.145071268081665
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.807 Test Loss: 0.642 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 31 cost time: 1.1949748992919922
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814808).  Saving model ...
Epoch: 32 cost time: 1.2296273708343506
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.815 Test Loss: 0.637 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 33 cost time: 1.238433599472046
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 34 cost time: 1.1757144927978516
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 35 cost time: 1.10329008102417
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 36 cost time: 1.2461662292480469
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.826 Test Loss: 0.631 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 37 cost time: 1.157146692276001
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.830 Test Loss: 0.631 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 1.0381734371185303
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.830 Test Loss: 0.630 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 39 cost time: 1.1566131114959717
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.830 Test Loss: 0.630 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 40 cost time: 1.251413106918335
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.830 Test Loss: 0.630 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.148531198501587
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.830 Test Loss: 0.630 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1856117248535156
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.830 Test Loss: 0.631 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2162799835205078
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.830 Test Loss: 0.631 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1492621898651123
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.830 Test Loss: 0.632 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0565571784973145
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.830 Test Loss: 0.633 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0478768348693848
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.830 Test Loss: 0.634 Test Acc: 0.830
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0871315002441406
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.830 Test Loss: 0.635 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.105546474456787
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.830 Test Loss: 0.636 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9623262882232666
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.830 Test Loss: 0.636 Test Acc: 0.830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.638221263885498
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.879 Vali Acc: 0.133 Test Loss: 1.879 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.0294487476348877
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.856 Vali Acc: 0.133 Test Loss: 1.856 Test Acc: 0.133
Validation loss decreased (-0.133315 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 1.208857536315918
Epoch: 3, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.808 Vali Acc: 0.156 Test Loss: 1.808 Test Acc: 0.156
Validation loss decreased (-0.133315 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 1.0157828330993652
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.709 Vali Acc: 0.241 Test Loss: 1.709 Test Acc: 0.241
Validation loss decreased (-0.155537 --> -0.240724).  Saving model ...
Epoch: 5 cost time: 1.036524772644043
Epoch: 5, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.590 Vali Acc: 0.422 Test Loss: 1.590 Test Acc: 0.422
Validation loss decreased (-0.240724 --> -0.422206).  Saving model ...
Epoch: 6 cost time: 1.150857925415039
Epoch: 6, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.456 Vali Acc: 0.559 Test Loss: 1.456 Test Acc: 0.559
Validation loss decreased (-0.422206 --> -0.559245).  Saving model ...
Epoch: 7 cost time: 0.9889853000640869
Epoch: 7, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.321 Vali Acc: 0.648 Test Loss: 1.321 Test Acc: 0.648
Validation loss decreased (-0.559245 --> -0.648135).  Saving model ...
Epoch: 8 cost time: 1.0343201160430908
Epoch: 8, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.181 Vali Acc: 0.704 Test Loss: 1.181 Test Acc: 0.704
Validation loss decreased (-0.648135 --> -0.703692).  Saving model ...
Epoch: 9 cost time: 1.008193016052246
Epoch: 9, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.043 Vali Acc: 0.719 Test Loss: 1.043 Test Acc: 0.719
Validation loss decreased (-0.703692 --> -0.718508).  Saving model ...
Epoch: 10 cost time: 0.9973702430725098
Epoch: 10, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.914 Vali Acc: 0.748 Test Loss: 0.914 Test Acc: 0.748
Validation loss decreased (-0.718508 --> -0.748139).  Saving model ...
Epoch: 11 cost time: 1.1261022090911865
Epoch: 11, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.799 Vali Acc: 0.763 Test Loss: 0.799 Test Acc: 0.763
Validation loss decreased (-0.748139 --> -0.762955).  Saving model ...
Epoch: 12 cost time: 1.0898706912994385
Epoch: 12, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.710 Vali Acc: 0.774 Test Loss: 0.710 Test Acc: 0.774
Validation loss decreased (-0.762955 --> -0.774067).  Saving model ...
Epoch: 13 cost time: 1.0165410041809082
Epoch: 13, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.628 Vali Acc: 0.785 Test Loss: 0.628 Test Acc: 0.785
Validation loss decreased (-0.774067 --> -0.785179).  Saving model ...
Epoch: 14 cost time: 1.1533474922180176
Epoch: 14, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.570 Vali Acc: 0.793 Test Loss: 0.570 Test Acc: 0.793
Validation loss decreased (-0.785179 --> -0.792587).  Saving model ...
Epoch: 15 cost time: 0.9895102977752686
Epoch: 15, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
Validation loss decreased (-0.792587 --> -0.803698).  Saving model ...
Epoch: 16 cost time: 0.9997916221618652
Epoch: 16, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.515 Vali Acc: 0.815 Test Loss: 0.515 Test Acc: 0.815
Validation loss decreased (-0.803698 --> -0.814810).  Saving model ...
Epoch: 17 cost time: 0.9753034114837646
Epoch: 17, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.815 Test Loss: 0.509 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 18 cost time: 1.0181798934936523
Epoch: 18, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.811 Test Loss: 0.500 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9801340103149414
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
Validation loss decreased (-0.814810 --> -0.825921).  Saving model ...
Epoch: 20 cost time: 1.0647742748260498
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.830 Test Loss: 0.470 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 21 cost time: 1.1194045543670654
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.830 Test Loss: 0.449 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 22 cost time: 0.9931445121765137
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
Validation loss decreased (-0.829625 --> -0.855551).  Saving model ...
Epoch: 23 cost time: 1.0926225185394287
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
Validation loss decreased (-0.855551 --> -0.870366).  Saving model ...
Epoch: 24 cost time: 1.119215726852417
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.397 Vali Acc: 0.874 Test Loss: 0.397 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 25 cost time: 1.0107417106628418
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.885 Test Loss: 0.388 Test Acc: 0.885
Validation loss decreased (-0.874070 --> -0.885181).  Saving model ...
Epoch: 26 cost time: 0.9930276870727539
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 27 cost time: 1.088686466217041
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.893 Test Loss: 0.378 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 28 cost time: 1.0566027164459229
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.896 Test Loss: 0.375 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 29 cost time: 1.0853297710418701
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.896 Test Loss: 0.373 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 30 cost time: 1.2453596591949463
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.2311272621154785
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.904 Test Loss: 0.373 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 32 cost time: 1.0922226905822754
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.904 Test Loss: 0.373 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0918171405792236
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.904 Test Loss: 0.374 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.115952730178833
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.904 Test Loss: 0.374 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.998455286026001
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.904 Test Loss: 0.376 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9978775978088379
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9592082500457764
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.904 Test Loss: 0.379 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0251293182373047
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0289478302001953
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0846598148345947
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.170806884765625
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6994872093200684
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.917 Vali Acc: 0.126 Test Loss: 1.917 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 1.0566349029541016
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.902 Vali Acc: 0.137 Test Loss: 1.902 Test Acc: 0.137
Validation loss decreased (-0.125907 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 1.0184080600738525
Epoch: 3, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.816 Vali Acc: 0.215 Test Loss: 1.816 Test Acc: 0.215
Validation loss decreased (-0.137018 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.945652961730957
Epoch: 4, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.614 Vali Acc: 0.370 Test Loss: 1.614 Test Acc: 0.370
Validation loss decreased (-0.214797 --> -0.370354).  Saving model ...
Epoch: 5 cost time: 1.0234160423278809
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.395 Vali Acc: 0.489 Test Loss: 1.395 Test Acc: 0.489
Validation loss decreased (-0.370354 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 0.9981305599212646
Epoch: 6, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
Validation loss decreased (-0.488875 --> -0.644433).  Saving model ...
Epoch: 7 cost time: 1.185086965560913
Epoch: 7, Steps: 2 | Train Loss: 1.302 Vali Loss: 0.989 Vali Acc: 0.767 Test Loss: 0.989 Test Acc: 0.767
Validation loss decreased (-0.644433 --> -0.766657).  Saving model ...
Epoch: 8 cost time: 1.1894166469573975
Epoch: 8, Steps: 2 | Train Loss: 1.248 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
Validation loss decreased (-0.766657 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 1.161290168762207
Epoch: 9, Steps: 2 | Train Loss: 1.126 Vali Loss: 0.668 Vali Acc: 0.852 Test Loss: 0.668 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851845).  Saving model ...
Epoch: 10 cost time: 1.0345726013183594
Epoch: 10, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
Validation loss decreased (-0.851845 --> -0.877772).  Saving model ...
Epoch: 11 cost time: 1.0283973217010498
Epoch: 11, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.9863626956939697
Epoch: 12, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.392 Vali Acc: 0.896 Test Loss: 0.392 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 13 cost time: 1.0450396537780762
Epoch: 13, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.332 Vali Acc: 0.896 Test Loss: 0.332 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 14 cost time: 1.0349195003509521
Epoch: 14, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.298 Vali Acc: 0.904 Test Loss: 0.298 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903701).  Saving model ...
Epoch: 15 cost time: 1.0846138000488281
Epoch: 15, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.275 Vali Acc: 0.907 Test Loss: 0.275 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 16 cost time: 1.0564534664154053
Epoch: 16, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
Validation loss decreased (-0.907405 --> -0.914812).  Saving model ...
Epoch: 17 cost time: 1.161165714263916
Epoch: 17, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.907 Test Loss: 0.265 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2132301330566406
Epoch: 18, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 19 cost time: 1.1269776821136475
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 1.0650358200073242
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 1.2633776664733887
Epoch: 21, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2746195793151855
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9927511215209961
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1013524532318115
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.079986333847046
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0659539699554443
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.137822151184082
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2346014976501465
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0386378765106201
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0934345722198486
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.504831075668335
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.788 Vali Acc: 0.178 Test Loss: 1.788 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.9866459369659424
Epoch: 2, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.775 Vali Acc: 0.185 Test Loss: 1.775 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.1332385540008545
Epoch: 3, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.661 Vali Acc: 0.296 Test Loss: 1.661 Test Acc: 0.296
Validation loss decreased (-0.185167 --> -0.296280).  Saving model ...
Epoch: 4 cost time: 1.1255443096160889
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.396 Vali Acc: 0.596 Test Loss: 1.396 Test Acc: 0.596
Validation loss decreased (-0.296280 --> -0.596282).  Saving model ...
Epoch: 5 cost time: 1.089615821838379
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.133 Vali Acc: 0.737 Test Loss: 1.133 Test Acc: 0.737
Validation loss decreased (-0.596282 --> -0.737026).  Saving model ...
Epoch: 6 cost time: 1.025953769683838
Epoch: 6, Steps: 2 | Train Loss: 1.542 Vali Loss: 0.916 Vali Acc: 0.837 Test Loss: 0.916 Test Acc: 0.837
Validation loss decreased (-0.737026 --> -0.837028).  Saving model ...
Epoch: 7 cost time: 1.0846047401428223
Epoch: 7, Steps: 2 | Train Loss: 1.444 Vali Loss: 0.735 Vali Acc: 0.893 Test Loss: 0.735 Test Acc: 0.893
Validation loss decreased (-0.837028 --> -0.892585).  Saving model ...
Epoch: 8 cost time: 1.0455434322357178
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 0.596 Vali Acc: 0.919 Test Loss: 0.596 Test Acc: 0.919
Validation loss decreased (-0.892585 --> -0.918513).  Saving model ...
Epoch: 9 cost time: 1.0005378723144531
Epoch: 9, Steps: 2 | Train Loss: 1.130 Vali Loss: 0.487 Vali Acc: 0.926 Test Loss: 0.487 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 10 cost time: 1.1728315353393555
Epoch: 10, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 1.0497212409973145
Epoch: 11, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 12 cost time: 1.0023853778839111
Epoch: 12, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.315 Vali Acc: 0.904 Test Loss: 0.315 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1169445514678955
Epoch: 13, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.283 Vali Acc: 0.896 Test Loss: 0.283 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1794588565826416
Epoch: 14, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.269 Vali Acc: 0.893 Test Loss: 0.269 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2103071212768555
Epoch: 15, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.259 Vali Acc: 0.896 Test Loss: 0.259 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.134178876876831
Epoch: 16, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0158953666687012
Epoch: 17, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.046807050704956
Epoch: 18, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 1.08650803565979
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 20 cost time: 1.073007345199585
Epoch: 20, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0241515636444092
Epoch: 21, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0865726470947266
Epoch: 22, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.072279453277588
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1231708526611328
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2477397918701172
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1158170700073242
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1025373935699463
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0391333103179932
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0315275192260742
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.782736301422119
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0500447750091553
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0521643161773682
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.1292943954467773
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.1536545753479004
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.9995143413543701
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.0260138511657715
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 0.9015717506408691
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.0005295276641846
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0608887672424316
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1177659034729004
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.0918726921081543
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2614490985870361
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.0375230312347412
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.0842247009277344
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.030397891998291
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 0.9973282814025879
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9572455883026123
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1294615268707275
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.2179510593414307
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1565525531768799
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.0767667293548584
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2000200748443604
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.0463950634002686
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0196669101715088
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0918679237365723
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0782408714294434
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0329968929290771
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0563364028930664
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.066584825515747
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0967626571655273
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.080787181854248
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9288935661315918
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 9405958
model size : 55.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6862785816192627
Epoch: 1, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.766 Vali Acc: 0.170 Test Loss: 1.766 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.966505765914917
Epoch: 2, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.698 Vali Acc: 0.259 Test Loss: 1.698 Test Acc: 0.259
Validation loss decreased (-0.170353 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 1.052861213684082
Epoch: 3, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.585 Vali Acc: 0.393 Test Loss: 1.585 Test Acc: 0.393
Validation loss decreased (-0.259242 --> -0.392577).  Saving model ...
Epoch: 4 cost time: 1.0667853355407715
Epoch: 4, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.387 Vali Acc: 0.593 Test Loss: 1.387 Test Acc: 0.593
Validation loss decreased (-0.392577 --> -0.592579).  Saving model ...
Epoch: 5 cost time: 1.0201010704040527
Epoch: 5, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.173 Vali Acc: 0.726 Test Loss: 1.173 Test Acc: 0.726
Validation loss decreased (-0.592579 --> -0.725914).  Saving model ...
Epoch: 6 cost time: 1.0997240543365479
Epoch: 6, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.975 Vali Acc: 0.744 Test Loss: 0.975 Test Acc: 0.744
Validation loss decreased (-0.725914 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 1.1266069412231445
Epoch: 7, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.815 Vali Acc: 0.793 Test Loss: 0.815 Test Acc: 0.793
Validation loss decreased (-0.744435 --> -0.792584).  Saving model ...
Epoch: 8 cost time: 1.2098562717437744
Epoch: 8, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.703 Vali Acc: 0.804 Test Loss: 0.703 Test Acc: 0.804
Validation loss decreased (-0.792584 --> -0.803697).  Saving model ...
Epoch: 9 cost time: 1.0822904109954834
Epoch: 9, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1321682929992676
Epoch: 10, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.165511131286621
Epoch: 11, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 1.0178415775299072
Epoch: 12, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
Validation loss decreased (-0.811105 --> -0.825920).  Saving model ...
Epoch: 13 cost time: 1.2072343826293945
Epoch: 13, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.1686744689941406
Epoch: 14, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.532 Vali Acc: 0.837 Test Loss: 0.532 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 15 cost time: 1.2968320846557617
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.837 Test Loss: 0.530 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 16 cost time: 1.2155141830444336
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 17 cost time: 1.1926765441894531
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 1.1938743591308594
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.852 Test Loss: 0.535 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851847).  Saving model ...
Epoch: 19 cost time: 1.082566261291504
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.848 Test Loss: 0.538 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0768859386444092
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.848 Test Loss: 0.541 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.183197021484375
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1534686088562012
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.852 Test Loss: 0.546 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1745426654815674
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.852 Test Loss: 0.548 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1279523372650146
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.859 Test Loss: 0.550 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859254).  Saving model ...
Epoch: 25 cost time: 1.1673638820648193
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.222102165222168
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0455150604248047
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0552234649658203
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.04791259765625
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.859 Test Loss: 0.557 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1318144798278809
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.125359058380127
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.079824686050415
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.859 Test Loss: 0.559 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.13063645362854
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.859 Test Loss: 0.559 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2216947078704834
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.935678005218506
Epoch: 1, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 1.1682765483856201
Epoch: 2, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.677 Vali Acc: 0.307 Test Loss: 1.677 Test Acc: 0.307
Validation loss decreased (-0.259242 --> -0.307391).  Saving model ...
Epoch: 3 cost time: 1.0997319221496582
Epoch: 3, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.590 Vali Acc: 0.389 Test Loss: 1.590 Test Acc: 0.389
Validation loss decreased (-0.307391 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 1.0632977485656738
Epoch: 4, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
Validation loss decreased (-0.388873 --> -0.540726).  Saving model ...
Epoch: 5 cost time: 1.1150941848754883
Epoch: 5, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.272 Vali Acc: 0.637 Test Loss: 1.272 Test Acc: 0.637
Validation loss decreased (-0.540726 --> -0.637024).  Saving model ...
Epoch: 6 cost time: 0.9502513408660889
Epoch: 6, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.118 Vali Acc: 0.693 Test Loss: 1.118 Test Acc: 0.693
Validation loss decreased (-0.637024 --> -0.692581).  Saving model ...
Epoch: 7 cost time: 1.184342622756958
Epoch: 7, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (-0.692581 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 1.1983842849731445
Epoch: 8, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.880 Vali Acc: 0.733 Test Loss: 0.880 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 1.023345947265625
Epoch: 9, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.805 Vali Acc: 0.730 Test Loss: 0.805 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.063591718673706
Epoch: 10, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.748 Vali Acc: 0.741 Test Loss: 0.748 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740733).  Saving model ...
Epoch: 11 cost time: 1.001274585723877
Epoch: 11, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740734).  Saving model ...
Epoch: 12 cost time: 1.077176570892334
Epoch: 12, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
Validation loss decreased (-0.740734 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.1202795505523682
Epoch: 13, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 0.9774978160858154
Epoch: 14, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.785 Test Loss: 0.642 Test Acc: 0.785
Validation loss decreased (-0.766660 --> -0.785179).  Saving model ...
Epoch: 15 cost time: 0.9503283500671387
Epoch: 15, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 16 cost time: 1.1660959720611572
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
Validation loss decreased (-0.788883 --> -0.796290).  Saving model ...
Epoch: 17 cost time: 1.0061147212982178
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 1.1214768886566162
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.807 Test Loss: 0.627 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807401).  Saving model ...
Epoch: 19 cost time: 1.1173412799835205
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814809).  Saving model ...
Epoch: 20 cost time: 1.2561874389648438
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 1.1390666961669922
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 22 cost time: 1.1028943061828613
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 23 cost time: 1.1627917289733887
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.830 Test Loss: 0.621 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 24 cost time: 1.1228339672088623
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.1312859058380127
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.095351219177246
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.837 Test Loss: 0.617 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 27 cost time: 1.0563006401062012
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.837 Test Loss: 0.616 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 28 cost time: 1.2495505809783936
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
Validation loss decreased (-0.837031 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 0.9436943531036377
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 30 cost time: 0.9917559623718262
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 1.069432258605957
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 1.1277580261230469
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 1.1648483276367188
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 34 cost time: 1.1140940189361572
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 35 cost time: 1.0538978576660156
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 36 cost time: 1.0938315391540527
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 37 cost time: 1.0495834350585938
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 38 cost time: 1.2089688777923584
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 39 cost time: 1.191162109375
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0678722858428955
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1291182041168213
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0381205081939697
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0962603092193604
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.111192226409912
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0829482078552246
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9091308116912842
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0528943538665771
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9239790439605713
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.836026906967163
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.751 Vali Acc: 0.244 Test Loss: 1.751 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.1886379718780518
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.707 Vali Acc: 0.281 Test Loss: 1.707 Test Acc: 0.281
Validation loss decreased (-0.244427 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 1.119748592376709
Epoch: 3, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.640 Vali Acc: 0.356 Test Loss: 1.640 Test Acc: 0.356
Validation loss decreased (-0.281464 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 1.0746402740478516
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.520 Vali Acc: 0.478 Test Loss: 1.520 Test Acc: 0.478
Validation loss decreased (-0.355539 --> -0.477763).  Saving model ...
Epoch: 5 cost time: 1.0751149654388428
Epoch: 5, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.386 Vali Acc: 0.563 Test Loss: 1.386 Test Acc: 0.563
Validation loss decreased (-0.477763 --> -0.562949).  Saving model ...
Epoch: 6 cost time: 1.0143251419067383
Epoch: 6, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.254 Vali Acc: 0.652 Test Loss: 1.254 Test Acc: 0.652
Validation loss decreased (-0.562949 --> -0.651839).  Saving model ...
Epoch: 7 cost time: 0.9702622890472412
Epoch: 7, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.132 Vali Acc: 0.674 Test Loss: 1.132 Test Acc: 0.674
Validation loss decreased (-0.651839 --> -0.674063).  Saving model ...
Epoch: 8 cost time: 0.9607243537902832
Epoch: 8, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.026 Vali Acc: 0.685 Test Loss: 1.026 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685175).  Saving model ...
Epoch: 9 cost time: 1.0908515453338623
Epoch: 9, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.940 Vali Acc: 0.711 Test Loss: 0.940 Test Acc: 0.711
Validation loss decreased (-0.685175 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 0.9946825504302979
Epoch: 10, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.872 Vali Acc: 0.752 Test Loss: 0.872 Test Acc: 0.752
Validation loss decreased (-0.711102 --> -0.751843).  Saving model ...
Epoch: 11 cost time: 1.0444071292877197
Epoch: 11, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
Validation loss decreased (-0.751843 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 1.1061503887176514
Epoch: 12, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.775 Vali Acc: 0.770 Test Loss: 0.775 Test Acc: 0.770
Validation loss decreased (-0.755547 --> -0.770363).  Saving model ...
Epoch: 13 cost time: 1.1058433055877686
Epoch: 13, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.750 Vali Acc: 0.781 Test Loss: 0.750 Test Acc: 0.781
Validation loss decreased (-0.770363 --> -0.781474).  Saving model ...
Epoch: 14 cost time: 1.011284589767456
Epoch: 14, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.737 Vali Acc: 0.781 Test Loss: 0.737 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 15 cost time: 1.046910047531128
Epoch: 15, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.724 Vali Acc: 0.781 Test Loss: 0.724 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 16 cost time: 1.1093032360076904
Epoch: 16, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.716 Vali Acc: 0.781 Test Loss: 0.716 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 17 cost time: 0.958796501159668
Epoch: 17, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.781474 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.0138330459594727
Epoch: 18, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.1121444702148438
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.1218602657318115
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.815 Test Loss: 0.698 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 21 cost time: 1.081193208694458
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.815 Test Loss: 0.695 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 22 cost time: 1.0962717533111572
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.819 Test Loss: 0.692 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 23 cost time: 1.0839555263519287
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 24 cost time: 0.948530912399292
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.819 Test Loss: 0.686 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 25 cost time: 0.9350368976593018
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.830 Test Loss: 0.684 Test Acc: 0.830
Validation loss decreased (-0.818512 --> -0.829623).  Saving model ...
Epoch: 26 cost time: 0.9600329399108887
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.1215856075286865
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.833 Test Loss: 0.680 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 28 cost time: 1.1996715068817139
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 1.1464836597442627
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.1528420448303223
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 1.0690653324127197
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 1.0778882503509521
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 1.0620503425598145
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 34 cost time: 1.040358304977417
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 35 cost time: 1.0855967998504639
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 36 cost time: 1.06196928024292
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 37 cost time: 1.1128206253051758
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 38 cost time: 1.1966140270233154
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 1.146153450012207
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.159724235534668
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 1.074505090713501
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 1.1081130504608154
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 43 cost time: 0.9899373054504395
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 1.1307024955749512
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.837 Test Loss: 0.658 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837030).  Saving model ...
Epoch: 45 cost time: 1.0753982067108154
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.837 Test Loss: 0.657 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 46 cost time: 1.111975908279419
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.837 Test Loss: 0.657 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 47 cost time: 1.2359108924865723
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.837 Test Loss: 0.657 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 48 cost time: 1.1568803787231445
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.837 Test Loss: 0.656 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 49 cost time: 1.1691615581512451
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.837 Test Loss: 0.656 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 50 cost time: 1.0958006381988525
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.837 Test Loss: 0.656 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 51 cost time: 1.0075559616088867
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.837 Test Loss: 0.655 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 52 cost time: 1.091646671295166
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.837 Test Loss: 0.655 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 53 cost time: 0.9528131484985352
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.837 Test Loss: 0.654 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837030).  Saving model ...
Epoch: 54 cost time: 1.0318799018859863
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.837 Test Loss: 0.654 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837031).  Saving model ...
Epoch: 55 cost time: 1.0588204860687256
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.837 Test Loss: 0.653 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 56 cost time: 1.0354092121124268
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 57 cost time: 1.161233901977539
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 58 cost time: 1.1593873500823975
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 59 cost time: 1.074315071105957
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.837 Test Loss: 0.651 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 60 cost time: 0.9419071674346924
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.837 Test Loss: 0.651 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 61 cost time: 1.0344479084014893
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.837 Test Loss: 0.650 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 62 cost time: 1.0312085151672363
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.837 Test Loss: 0.650 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 63 cost time: 1.0339043140411377
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.837 Test Loss: 0.650 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 64 cost time: 1.0933291912078857
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.837 Test Loss: 0.650 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 65 cost time: 1.038330316543579
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.837 Test Loss: 0.649 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 66 cost time: 1.0518667697906494
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.837 Test Loss: 0.649 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 67 cost time: 1.105802297592163
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.837 Test Loss: 0.649 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 68 cost time: 1.357360601425171
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.837 Test Loss: 0.648 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 69 cost time: 1.0578503608703613
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.837 Test Loss: 0.648 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 70 cost time: 1.1774277687072754
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.837 Test Loss: 0.648 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 71 cost time: 1.095163345336914
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.837 Test Loss: 0.647 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 72 cost time: 1.0417113304138184
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.837 Test Loss: 0.647 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 73 cost time: 1.0393602848052979
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.837 Test Loss: 0.646 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 74 cost time: 1.0932128429412842
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.837 Test Loss: 0.645 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 75 cost time: 1.1553914546966553
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.837 Test Loss: 0.644 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 76 cost time: 1.1773436069488525
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.837 Test Loss: 0.644 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 77 cost time: 1.0958738327026367
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.837 Test Loss: 0.643 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 78 cost time: 1.1539862155914307
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.837 Test Loss: 0.643 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 79 cost time: 1.101499319076538
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.837 Test Loss: 0.642 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 80 cost time: 1.0836973190307617
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.837 Test Loss: 0.642 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 81 cost time: 0.9080748558044434
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.837 Test Loss: 0.642 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 82 cost time: 1.0304057598114014
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.837 Test Loss: 0.642 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 83 cost time: 1.0052127838134766
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.837 Test Loss: 0.641 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 84 cost time: 1.0184693336486816
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.837 Test Loss: 0.641 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 85 cost time: 1.0615270137786865
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.837 Test Loss: 0.640 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 86 cost time: 1.0635511875152588
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.837 Test Loss: 0.640 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 87 cost time: 1.1193983554840088
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.837 Test Loss: 0.639 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 88 cost time: 1.0883495807647705
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.837 Test Loss: 0.639 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 89 cost time: 1.0134665966033936
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.837 Test Loss: 0.639 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 90 cost time: 0.9823508262634277
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.837 Test Loss: 0.638 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 91 cost time: 1.0875256061553955
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.837 Test Loss: 0.638 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 92 cost time: 1.1320092678070068
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.837 Test Loss: 0.637 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 93 cost time: 1.127955675125122
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.837 Test Loss: 0.637 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 94 cost time: 1.186830759048462
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.837 Test Loss: 0.637 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 95 cost time: 1.1704790592193604
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.837 Test Loss: 0.636 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 96 cost time: 1.1679201126098633
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.837 Test Loss: 0.636 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 97 cost time: 1.0281922817230225
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.837 Test Loss: 0.635 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 98 cost time: 0.962700366973877
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.837 Test Loss: 0.635 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 99 cost time: 1.104569673538208
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.837 Test Loss: 0.635 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 100 cost time: 1.035707712173462
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.837 Test Loss: 0.634 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8052303791046143
Epoch: 1, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.750 Vali Acc: 0.248 Test Loss: 1.750 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 1.1368968486785889
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.723 Vali Acc: 0.296 Test Loss: 1.723 Test Acc: 0.296
Validation loss decreased (-0.248131 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 1.1325044631958008
Epoch: 3, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.676 Vali Acc: 0.389 Test Loss: 1.676 Test Acc: 0.389
Validation loss decreased (-0.296279 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 1.1127517223358154
Epoch: 4, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.588 Vali Acc: 0.452 Test Loss: 1.588 Test Acc: 0.452
Validation loss decreased (-0.388872 --> -0.451836).  Saving model ...
Epoch: 5 cost time: 0.9806709289550781
Epoch: 5, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
Validation loss decreased (-0.451836 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 1.033459186553955
Epoch: 6, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.374 Vali Acc: 0.548 Test Loss: 1.374 Test Acc: 0.548
Validation loss decreased (-0.499985 --> -0.548134).  Saving model ...
Epoch: 7 cost time: 1.053879737854004
Epoch: 7, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.272 Vali Acc: 0.559 Test Loss: 1.272 Test Acc: 0.559
Validation loss decreased (-0.548134 --> -0.559247).  Saving model ...
Epoch: 8 cost time: 1.043137550354004
Epoch: 8, Steps: 2 | Train Loss: 0.758 Vali Loss: 1.179 Vali Acc: 0.593 Test Loss: 1.179 Test Acc: 0.593
Validation loss decreased (-0.559247 --> -0.592581).  Saving model ...
Epoch: 9 cost time: 1.1461141109466553
Epoch: 9, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.096 Vali Acc: 0.607 Test Loss: 1.096 Test Acc: 0.607
Validation loss decreased (-0.592581 --> -0.607396).  Saving model ...
Epoch: 10 cost time: 1.2212426662445068
Epoch: 10, Steps: 2 | Train Loss: 0.412 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
Validation loss decreased (-0.607396 --> -0.622212).  Saving model ...
Epoch: 11 cost time: 1.2081804275512695
Epoch: 11, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.957 Vali Acc: 0.659 Test Loss: 0.957 Test Acc: 0.659
Validation loss decreased (-0.622212 --> -0.659250).  Saving model ...
Epoch: 12 cost time: 1.1755893230438232
Epoch: 12, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.896 Vali Acc: 0.670 Test Loss: 0.896 Test Acc: 0.670
Validation loss decreased (-0.659250 --> -0.670361).  Saving model ...
Epoch: 13 cost time: 1.121436357498169
Epoch: 13, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.848 Vali Acc: 0.696 Test Loss: 0.848 Test Acc: 0.696
Validation loss decreased (-0.670361 --> -0.696288).  Saving model ...
Epoch: 14 cost time: 0.9900293350219727
Epoch: 14, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.807 Vali Acc: 0.719 Test Loss: 0.807 Test Acc: 0.719
Validation loss decreased (-0.696288 --> -0.718510).  Saving model ...
Epoch: 15 cost time: 1.1849989891052246
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.759 Vali Acc: 0.715 Test Loss: 0.759 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0830771923065186
Epoch: 16, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.721 Vali Acc: 0.726 Test Loss: 0.721 Test Acc: 0.726
Validation loss decreased (-0.718510 --> -0.725919).  Saving model ...
Epoch: 17 cost time: 1.107145071029663
Epoch: 17, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
Validation loss decreased (-0.725919 --> -0.737030).  Saving model ...
Epoch: 18 cost time: 1.0864005088806152
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.759 Test Loss: 0.679 Test Acc: 0.759
Validation loss decreased (-0.737030 --> -0.759252).  Saving model ...
Epoch: 19 cost time: 1.1159679889678955
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.774 Test Loss: 0.666 Test Acc: 0.774
Validation loss decreased (-0.759252 --> -0.774067).  Saving model ...
Epoch: 20 cost time: 1.2881922721862793
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.774 Test Loss: 0.658 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 21 cost time: 1.1256048679351807
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.785 Test Loss: 0.653 Test Acc: 0.785
Validation loss decreased (-0.774067 --> -0.785179).  Saving model ...
Epoch: 22 cost time: 1.1759071350097656
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
Validation loss decreased (-0.785179 --> -0.796290).  Saving model ...
Epoch: 23 cost time: 1.0587594509124756
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.235595464706421
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.804 Test Loss: 0.647 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 25 cost time: 1.0980291366577148
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811105).  Saving model ...
Epoch: 26 cost time: 1.2174146175384521
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 1.0690958499908447
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.807 Test Loss: 0.645 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9148645401000977
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 29 cost time: 1.1019260883331299
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 30 cost time: 1.1237025260925293
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.811 Test Loss: 0.642 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 31 cost time: 1.1132323741912842
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 1.0733003616333008
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.811 Test Loss: 0.637 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 33 cost time: 1.0690534114837646
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 34 cost time: 1.007810115814209
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 35 cost time: 1.1048672199249268
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 36 cost time: 1.043520450592041
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.826 Test Loss: 0.631 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 37 cost time: 1.1507856845855713
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.826 Test Loss: 0.629 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 38 cost time: 1.0846304893493652
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.826 Test Loss: 0.628 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 39 cost time: 1.0802667140960693
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 40 cost time: 1.2032334804534912
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 41 cost time: 1.1105067729949951
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 42 cost time: 1.0786349773406982
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 43 cost time: 1.200516700744629
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 1.1325092315673828
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.837 Test Loss: 0.625 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 45 cost time: 1.18609619140625
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 46 cost time: 1.2289304733276367
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 47 cost time: 1.0777084827423096
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 48 cost time: 1.0767035484313965
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.035999059677124
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0572419166564941
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.837 Test Loss: 0.625 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.059338092803955
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.837 Test Loss: 0.625 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0548827648162842
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2138218879699707
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1846544742584229
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1182756423950195
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1119208335876465
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 57 cost time: 1.094465970993042
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 58 cost time: 1.0842747688293457
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 59 cost time: 0.9544906616210938
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 60 cost time: 1.0888333320617676
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 61 cost time: 1.032611608505249
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 62 cost time: 1.0657761096954346
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 63 cost time: 1.1083674430847168
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.837 Test Loss: 0.622 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1535940170288086
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2172141075134277
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1646132469177246
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0762662887573242
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.0165746212005615
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.006399393081665
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.0316998958587646
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.837 Test Loss: 0.624 Test Acc: 0.837
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.0175707340240479
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.9943633079528809
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.837 Test Loss: 0.623 Test Acc: 0.837
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.849299907684326
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.777 Vali Acc: 0.200 Test Loss: 1.777 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.142805814743042
Epoch: 2, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.758 Vali Acc: 0.215 Test Loss: 1.758 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 1.0191469192504883
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.715 Vali Acc: 0.281 Test Loss: 1.715 Test Acc: 0.281
Validation loss decreased (-0.214797 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.9818813800811768
Epoch: 4, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.623 Vali Acc: 0.407 Test Loss: 1.623 Test Acc: 0.407
Validation loss decreased (-0.281464 --> -0.407391).  Saving model ...
Epoch: 5 cost time: 1.064253807067871
Epoch: 5, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
Validation loss decreased (-0.407391 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 1.0681791305541992
Epoch: 6, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.385 Vali Acc: 0.593 Test Loss: 1.385 Test Acc: 0.593
Validation loss decreased (-0.499985 --> -0.592579).  Saving model ...
Epoch: 7 cost time: 1.0644822120666504
Epoch: 7, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.254 Vali Acc: 0.652 Test Loss: 1.254 Test Acc: 0.652
Validation loss decreased (-0.592579 --> -0.651839).  Saving model ...
Epoch: 8 cost time: 1.0975723266601562
Epoch: 8, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.123 Vali Acc: 0.685 Test Loss: 1.123 Test Acc: 0.685
Validation loss decreased (-0.651839 --> -0.685174).  Saving model ...
Epoch: 9 cost time: 1.1067442893981934
Epoch: 9, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.998 Vali Acc: 0.722 Test Loss: 0.998 Test Acc: 0.722
Validation loss decreased (-0.685174 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 1.1168262958526611
Epoch: 10, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.881 Vali Acc: 0.752 Test Loss: 0.881 Test Acc: 0.752
Validation loss decreased (-0.722212 --> -0.751843).  Saving model ...
Epoch: 11 cost time: 1.1288859844207764
Epoch: 11, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.783 Vali Acc: 0.770 Test Loss: 0.783 Test Acc: 0.770
Validation loss decreased (-0.751843 --> -0.770363).  Saving model ...
Epoch: 12 cost time: 1.171746015548706
Epoch: 12, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.700 Vali Acc: 0.774 Test Loss: 0.700 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 13 cost time: 1.0036251544952393
Epoch: 13, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.651 Vali Acc: 0.778 Test Loss: 0.651 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 1.005744218826294
Epoch: 14, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 15 cost time: 1.0368144512176514
Epoch: 15, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.547 Vali Acc: 0.793 Test Loss: 0.547 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 16 cost time: 1.0043015480041504
Epoch: 16, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.493 Vali Acc: 0.811 Test Loss: 0.493 Test Acc: 0.811
Validation loss decreased (-0.792587 --> -0.811106).  Saving model ...
Epoch: 17 cost time: 0.939093828201294
Epoch: 17, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.811106 --> -0.825921).  Saving model ...
Epoch: 18 cost time: 0.9945552349090576
Epoch: 18, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
Validation loss decreased (-0.825921 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 1.0521631240844727
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.863 Test Loss: 0.408 Test Acc: 0.863
Validation loss decreased (-0.844440 --> -0.862959).  Saving model ...
Epoch: 20 cost time: 1.0017387866973877
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.396 Vali Acc: 0.874 Test Loss: 0.396 Test Acc: 0.874
Validation loss decreased (-0.862959 --> -0.874070).  Saving model ...
Epoch: 21 cost time: 1.0895025730133057
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.874 Test Loss: 0.389 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 22 cost time: 1.0729503631591797
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9679651260375977
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.874 Test Loss: 0.392 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9288403987884521
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9926953315734863
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.878 Test Loss: 0.398 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 1.0170819759368896
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.878 Test Loss: 0.402 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.090139627456665
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.105686902999878
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.878 Test Loss: 0.410 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0755364894866943
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0237841606140137
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.881 Test Loss: 0.415 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881477).  Saving model ...
Epoch: 31 cost time: 1.1533961296081543
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.881 Test Loss: 0.415 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 32 cost time: 1.0886564254760742
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.881 Test Loss: 0.414 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 33 cost time: 1.0449950695037842
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.881 Test Loss: 0.413 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 34 cost time: 1.016390323638916
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.881 Test Loss: 0.411 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 35 cost time: 1.0434424877166748
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.881 Test Loss: 0.408 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 36 cost time: 1.0184128284454346
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.881 Test Loss: 0.406 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 37 cost time: 1.0844395160675049
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.881 Test Loss: 0.404 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 38 cost time: 1.0701136589050293
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 39 cost time: 1.2046353816986084
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.881 Test Loss: 0.400 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 40 cost time: 1.0301787853240967
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.881 Test Loss: 0.398 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 41 cost time: 1.0708062648773193
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.885 Test Loss: 0.396 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 42 cost time: 1.064124584197998
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.885 Test Loss: 0.394 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 43 cost time: 0.9810855388641357
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.885 Test Loss: 0.392 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 44 cost time: 1.0367670059204102
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.885 Test Loss: 0.389 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 45 cost time: 0.9987773895263672
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.885 Test Loss: 0.388 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 46 cost time: 1.0413713455200195
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.885 Test Loss: 0.386 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 47 cost time: 0.9729223251342773
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.885 Test Loss: 0.385 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 48 cost time: 1.0115127563476562
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.885 Test Loss: 0.385 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 49 cost time: 1.0329029560089111
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0151045322418213
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1275320053100586
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0292558670043945
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0783154964447021
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.103708028793335
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.881 Test Loss: 0.386 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.104452133178711
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.881 Test Loss: 0.386 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0757741928100586
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.881 Test Loss: 0.387 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.988314151763916
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.881 Test Loss: 0.387 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.0530169010162354
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.881 Test Loss: 0.387 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9234936237335205
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.863 Vali Acc: 0.148 Test Loss: 1.863 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.9598872661590576
Epoch: 2, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.849 Vali Acc: 0.156 Test Loss: 1.849 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 1.0872313976287842
Epoch: 3, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.768 Vali Acc: 0.215 Test Loss: 1.768 Test Acc: 0.215
Validation loss decreased (-0.155537 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 1.0420072078704834
Epoch: 4, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.574 Vali Acc: 0.385 Test Loss: 1.574 Test Acc: 0.385
Validation loss decreased (-0.214797 --> -0.385169).  Saving model ...
Epoch: 5 cost time: 1.043813705444336
Epoch: 5, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.355 Vali Acc: 0.563 Test Loss: 1.355 Test Acc: 0.563
Validation loss decreased (-0.385169 --> -0.562949).  Saving model ...
Epoch: 6 cost time: 1.0244061946868896
Epoch: 6, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.152 Vali Acc: 0.663 Test Loss: 1.152 Test Acc: 0.663
Validation loss decreased (-0.562949 --> -0.662951).  Saving model ...
Epoch: 7 cost time: 1.0905699729919434
Epoch: 7, Steps: 2 | Train Loss: 1.380 Vali Loss: 0.964 Vali Acc: 0.748 Test Loss: 0.964 Test Acc: 0.748
Validation loss decreased (-0.662951 --> -0.748139).  Saving model ...
Epoch: 8 cost time: 1.0737543106079102
Epoch: 8, Steps: 2 | Train Loss: 1.198 Vali Loss: 0.800 Vali Acc: 0.807 Test Loss: 0.800 Test Acc: 0.807
Validation loss decreased (-0.748139 --> -0.807399).  Saving model ...
Epoch: 9 cost time: 1.089151382446289
Epoch: 9, Steps: 2 | Train Loss: 1.069 Vali Loss: 0.657 Vali Acc: 0.826 Test Loss: 0.657 Test Acc: 0.826
Validation loss decreased (-0.807399 --> -0.825919).  Saving model ...
Epoch: 10 cost time: 1.164496898651123
Epoch: 10, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.825919 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 1.103473424911499
Epoch: 11, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
Validation loss decreased (-0.866661 --> -0.903699).  Saving model ...
Epoch: 12 cost time: 1.000826358795166
Epoch: 12, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 13 cost time: 1.0282366275787354
Epoch: 13, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0796151161193848
Epoch: 14, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.283 Vali Acc: 0.896 Test Loss: 0.283 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9603271484375
Epoch: 15, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 1.1039361953735352
Epoch: 16, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 1.2406864166259766
Epoch: 17, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.018822193145752
Epoch: 18, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2207653522491455
Epoch: 19, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.048633098602295
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0115180015563965
Epoch: 21, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.915 Test Loss: 0.249 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1154215335845947
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1020116806030273
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9994468688964844
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.016298532485962
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0197772979736328
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.765084743499756
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.779 Vali Acc: 0.170 Test Loss: 1.779 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.9375810623168945
Epoch: 2, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.767 Vali Acc: 0.193 Test Loss: 1.767 Test Acc: 0.193
Validation loss decreased (-0.170353 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.9777591228485107
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.656 Vali Acc: 0.378 Test Loss: 1.656 Test Acc: 0.378
Validation loss decreased (-0.192575 --> -0.377761).  Saving model ...
Epoch: 4 cost time: 0.9733922481536865
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.394 Vali Acc: 0.604 Test Loss: 1.394 Test Acc: 0.604
Validation loss decreased (-0.377761 --> -0.603690).  Saving model ...
Epoch: 5 cost time: 0.9945080280303955
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.132 Vali Acc: 0.770 Test Loss: 1.132 Test Acc: 0.770
Validation loss decreased (-0.603690 --> -0.770359).  Saving model ...
Epoch: 6 cost time: 1.1302289962768555
Epoch: 6, Steps: 2 | Train Loss: 1.491 Vali Loss: 0.913 Vali Acc: 0.852 Test Loss: 0.913 Test Acc: 0.852
Validation loss decreased (-0.770359 --> -0.851843).  Saving model ...
Epoch: 7 cost time: 1.1811914443969727
Epoch: 7, Steps: 2 | Train Loss: 1.380 Vali Loss: 0.732 Vali Acc: 0.885 Test Loss: 0.732 Test Acc: 0.885
Validation loss decreased (-0.851843 --> -0.885178).  Saving model ...
Epoch: 8 cost time: 1.0394001007080078
Epoch: 8, Steps: 2 | Train Loss: 1.214 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.885178 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.1356167793273926
Epoch: 9, Steps: 2 | Train Loss: 1.111 Vali Loss: 0.486 Vali Acc: 0.919 Test Loss: 0.486 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918514).  Saving model ...
Epoch: 10 cost time: 1.1148278713226318
Epoch: 10, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 11 cost time: 0.9229142665863037
Epoch: 11, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 1.0040624141693115
Epoch: 12, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.072300672531128
Epoch: 13, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.300 Vali Acc: 0.896 Test Loss: 0.300 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9736499786376953
Epoch: 14, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.302 Vali Acc: 0.885 Test Loss: 0.302 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9361743927001953
Epoch: 15, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1328577995300293
Epoch: 16, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0731019973754883
Epoch: 17, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0923821926116943
Epoch: 18, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1932563781738281
Epoch: 19, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 1.1029610633850098
Epoch: 20, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1287357807159424
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0735130310058594
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0328197479248047
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1403143405914307
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0915031433105469
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0881211757659912
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0629806518554688
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.915 Test Loss: 0.318 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0029375553131104
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.915 Test Loss: 0.322 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1169769763946533
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.573941946029663
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.9604694843292236
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0862960815429688
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.134230613708496
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1755645275115967
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1607580184936523
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1349093914031982
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.081521987915039
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0409607887268066
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9737491607666016
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9525721073150635
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9992685317993164
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 0.9695043563842773
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9713068008422852
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1052062511444092
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.242208480834961
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.030604600906372
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0454771518707275
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9390158653259277
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0148403644561768
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9656059741973877
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0526230335235596
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 9012742
model size : 53.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6645045280456543
Epoch: 1, Steps: 2 | Train Loss: 1.980 Vali Loss: 1.849 Vali Acc: 0.193 Test Loss: 1.849 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.9008145332336426
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.786 Vali Acc: 0.211 Test Loss: 1.786 Test Acc: 0.211
Validation loss decreased (-0.192574 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 1.0298831462860107
Epoch: 3, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.696 Vali Acc: 0.267 Test Loss: 1.696 Test Acc: 0.267
Validation loss decreased (-0.211093 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 1.0498871803283691
Epoch: 4, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.546 Vali Acc: 0.404 Test Loss: 1.546 Test Acc: 0.404
Validation loss decreased (-0.266650 --> -0.403688).  Saving model ...
Epoch: 5 cost time: 1.0842576026916504
Epoch: 5, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.378 Vali Acc: 0.641 Test Loss: 1.378 Test Acc: 0.641
Validation loss decreased (-0.403688 --> -0.640727).  Saving model ...
Epoch: 6 cost time: 0.9897909164428711
Epoch: 6, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.208 Vali Acc: 0.748 Test Loss: 1.208 Test Acc: 0.748
Validation loss decreased (-0.640727 --> -0.748136).  Saving model ...
Epoch: 7 cost time: 1.142810344696045
Epoch: 7, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.054 Vali Acc: 0.767 Test Loss: 1.054 Test Acc: 0.767
Validation loss decreased (-0.748136 --> -0.766656).  Saving model ...
Epoch: 8 cost time: 1.063971757888794
Epoch: 8, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.921 Vali Acc: 0.778 Test Loss: 0.921 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777769).  Saving model ...
Epoch: 9 cost time: 1.1054275035858154
Epoch: 9, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.811 Vali Acc: 0.781 Test Loss: 0.811 Test Acc: 0.781
Validation loss decreased (-0.777769 --> -0.781473).  Saving model ...
Epoch: 10 cost time: 1.108607530593872
Epoch: 10, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.725 Vali Acc: 0.793 Test Loss: 0.725 Test Acc: 0.793
Validation loss decreased (-0.781473 --> -0.792585).  Saving model ...
Epoch: 11 cost time: 0.9601566791534424
Epoch: 11, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.124985933303833
Epoch: 12, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.617 Vali Acc: 0.811 Test Loss: 0.617 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 1.1170892715454102
Epoch: 13, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.598 Vali Acc: 0.811 Test Loss: 0.598 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.0308942794799805
Epoch: 14, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 1.0293827056884766
Epoch: 15, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.577 Vali Acc: 0.811 Test Loss: 0.577 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 1.0452251434326172
Epoch: 16, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822217).  Saving model ...
Epoch: 17 cost time: 1.3195030689239502
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 18 cost time: 1.0992114543914795
Epoch: 18, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 1.1086132526397705
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 20 cost time: 1.0542736053466797
Epoch: 20, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 21 cost time: 0.9831840991973877
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 22 cost time: 0.9499704837799072
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 23 cost time: 0.9422657489776611
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.837 Test Loss: 0.552 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837032).  Saving model ...
Epoch: 24 cost time: 1.0628669261932373
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 25 cost time: 0.9836201667785645
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 26 cost time: 1.0679152011871338
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2812700271606445
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.837 Test Loss: 0.552 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1833794116973877
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.837 Test Loss: 0.552 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.142158031463623
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.837 Test Loss: 0.553 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3782587051391602
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 31 cost time: 1.116150140762329
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9170351028442383
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.948185920715332
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0177042484283447
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0469300746917725
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0197713375091553
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0525145530700684
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.071826696395874
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1631877422332764
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.063246726989746
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 41 cost time: 1.0924856662750244
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 0.941356897354126
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 43 cost time: 0.9149143695831299
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 44 cost time: 0.9066519737243652
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.852 Test Loss: 0.551 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 45 cost time: 0.9611003398895264
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.852 Test Loss: 0.551 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 46 cost time: 1.0845181941986084
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.852 Test Loss: 0.550 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 47 cost time: 1.104623556137085
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 48 cost time: 0.9926669597625732
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 49 cost time: 1.0057883262634277
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.859 Test Loss: 0.548 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 50 cost time: 1.0429670810699463
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.859 Test Loss: 0.548 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 51 cost time: 0.9702630043029785
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.859 Test Loss: 0.547 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 52 cost time: 0.973536491394043
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.859 Test Loss: 0.547 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 53 cost time: 1.011824607849121
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.859 Test Loss: 0.546 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 54 cost time: 1.152355670928955
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.859 Test Loss: 0.545 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 55 cost time: 1.120316982269287
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.859 Test Loss: 0.544 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 56 cost time: 1.0049011707305908
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 57 cost time: 1.0368154048919678
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 58 cost time: 1.086876392364502
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 59 cost time: 1.0859637260437012
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 60 cost time: 1.1919746398925781
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 61 cost time: 0.9375793933868408
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.863 Test Loss: 0.539 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 62 cost time: 1.0252056121826172
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 63 cost time: 0.9490797519683838
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 64 cost time: 1.0181095600128174
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 65 cost time: 1.050067663192749
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 66 cost time: 1.0379762649536133
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 67 cost time: 1.1095209121704102
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 68 cost time: 1.0270907878875732
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 69 cost time: 1.0509788990020752
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.863 Test Loss: 0.531 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 70 cost time: 1.0467004776000977
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 71 cost time: 1.0743718147277832
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.863 Test Loss: 0.529 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 72 cost time: 1.0304973125457764
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.863 Test Loss: 0.528 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 73 cost time: 0.8975729942321777
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 74 cost time: 0.9255359172821045
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 75 cost time: 0.9408633708953857
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.863 Test Loss: 0.525 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 76 cost time: 0.9799237251281738
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.863 Test Loss: 0.525 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 77 cost time: 1.1215741634368896
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.863 Test Loss: 0.524 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 78 cost time: 0.9212267398834229
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866661).  Saving model ...
Epoch: 79 cost time: 0.9779541492462158
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 80 cost time: 1.0660614967346191
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 81 cost time: 0.9527180194854736
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 82 cost time: 1.002286672592163
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 83 cost time: 1.0050749778747559
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 84 cost time: 1.1280755996704102
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 85 cost time: 1.0875000953674316
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 86 cost time: 1.3042001724243164
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 87 cost time: 1.1549615859985352
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 88 cost time: 1.1617703437805176
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 89 cost time: 1.1584649085998535
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.874 Test Loss: 0.515 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 90 cost time: 1.0311803817749023
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.874 Test Loss: 0.514 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 91 cost time: 1.1890285015106201
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.874 Test Loss: 0.513 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 92 cost time: 1.0984807014465332
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.874 Test Loss: 0.513 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 93 cost time: 1.143822431564331
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 94 cost time: 1.0896596908569336
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 95 cost time: 1.099363088607788
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 96 cost time: 1.1424691677093506
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 97 cost time: 1.1166493892669678
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 98 cost time: 1.1708033084869385
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 99 cost time: 1.303421974182129
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 100 cost time: 1.0107438564300537
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.434079885482788
Epoch: 1, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.881 Vali Acc: 0.159 Test Loss: 1.881 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.9055538177490234
Epoch: 2, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.829 Vali Acc: 0.159 Test Loss: 1.829 Test Acc: 0.159
Validation loss decreased (-0.159240 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 1.1002976894378662
Epoch: 3, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.755 Vali Acc: 0.193 Test Loss: 1.755 Test Acc: 0.193
Validation loss decreased (-0.159241 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 1.111567735671997
Epoch: 4, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.634 Vali Acc: 0.281 Test Loss: 1.634 Test Acc: 0.281
Validation loss decreased (-0.192575 --> -0.281465).  Saving model ...
Epoch: 5 cost time: 0.9735434055328369
Epoch: 5, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
Validation loss decreased (-0.281465 --> -0.511096).  Saving model ...
Epoch: 6 cost time: 1.1101298332214355
Epoch: 6, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.359 Vali Acc: 0.633 Test Loss: 1.359 Test Acc: 0.633
Validation loss decreased (-0.511096 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 0.9825584888458252
Epoch: 7, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.229 Vali Acc: 0.659 Test Loss: 1.229 Test Acc: 0.659
Validation loss decreased (-0.633320 --> -0.659247).  Saving model ...
Epoch: 8 cost time: 0.9532935619354248
Epoch: 8, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.113 Vali Acc: 0.693 Test Loss: 1.113 Test Acc: 0.693
Validation loss decreased (-0.659247 --> -0.692581).  Saving model ...
Epoch: 9 cost time: 0.9761199951171875
Epoch: 9, Steps: 2 | Train Loss: 0.685 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.692581 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.0355849266052246
Epoch: 10, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.929 Vali Acc: 0.704 Test Loss: 0.929 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 11 cost time: 0.940809965133667
Epoch: 11, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.9166426658630371
Epoch: 12, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.808 Vali Acc: 0.722 Test Loss: 0.808 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 13 cost time: 1.0500688552856445
Epoch: 13, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.773 Vali Acc: 0.744 Test Loss: 0.773 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 1.217888593673706
Epoch: 14, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.742 Vali Acc: 0.748 Test Loss: 0.742 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 15 cost time: 1.0199251174926758
Epoch: 15, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.723 Vali Acc: 0.748 Test Loss: 0.723 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 16 cost time: 1.1032860279083252
Epoch: 16, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.704 Vali Acc: 0.756 Test Loss: 0.704 Test Acc: 0.756
Validation loss decreased (-0.748141 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 1.0723152160644531
Epoch: 17, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.689 Vali Acc: 0.763 Test Loss: 0.689 Test Acc: 0.763
Validation loss decreased (-0.755549 --> -0.762956).  Saving model ...
Epoch: 18 cost time: 0.9728703498840332
Epoch: 18, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.676 Vali Acc: 0.778 Test Loss: 0.676 Test Acc: 0.778
Validation loss decreased (-0.762956 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 0.9320659637451172
Epoch: 19, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.665 Vali Acc: 0.785 Test Loss: 0.665 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 20 cost time: 1.0191214084625244
Epoch: 20, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 1.0252149105072021
Epoch: 21, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.649 Vali Acc: 0.793 Test Loss: 0.649 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 22 cost time: 1.0952856540679932
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.793 Test Loss: 0.642 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 23 cost time: 1.0095160007476807
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.793 Test Loss: 0.636 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 24 cost time: 1.0919485092163086
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.793 Test Loss: 0.630 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 25 cost time: 1.154353141784668
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 26 cost time: 1.1715445518493652
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 27 cost time: 1.1248464584350586
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 28 cost time: 1.0173707008361816
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 1.0929224491119385
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 30 cost time: 1.2595961093902588
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 31 cost time: 1.1705944538116455
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 32 cost time: 1.134031057357788
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811105).  Saving model ...
Epoch: 33 cost time: 0.9640333652496338
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.815 Test Loss: 0.601 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 34 cost time: 1.0311381816864014
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.815 Test Loss: 0.599 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 35 cost time: 0.9791264533996582
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 36 cost time: 1.1172857284545898
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 37 cost time: 1.0358712673187256
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 38 cost time: 0.9357075691223145
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 39 cost time: 1.0705516338348389
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 40 cost time: 1.0000112056732178
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 41 cost time: 1.010565996170044
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 1.0650856494903564
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 43 cost time: 1.0625159740447998
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 44 cost time: 1.0452260971069336
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 45 cost time: 0.9240851402282715
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 46 cost time: 0.9236922264099121
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 47 cost time: 0.9061565399169922
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 48 cost time: 0.8571131229400635
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.826 Test Loss: 0.578 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 49 cost time: 0.9641745090484619
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.830 Test Loss: 0.577 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 50 cost time: 1.0202925205230713
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.837 Test Loss: 0.576 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837031).  Saving model ...
Epoch: 51 cost time: 0.9384512901306152
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.837 Test Loss: 0.575 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 52 cost time: 1.0287408828735352
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9986510276794434
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.891653299331665
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9017467498779297
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8781013488769531
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8693032264709473
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.837 Test Loss: 0.568 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 58 cost time: 0.8738698959350586
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.837 Test Loss: 0.566 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 59 cost time: 1.2287752628326416
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.837 Test Loss: 0.565 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 60 cost time: 1.0584716796875
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.837 Test Loss: 0.564 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 61 cost time: 0.9520657062530518
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 62 cost time: 1.116269826889038
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 63 cost time: 0.9605498313903809
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.0191028118133545
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 65 cost time: 1.0469348430633545
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 66 cost time: 1.0196738243103027
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 67 cost time: 1.033609390258789
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 68 cost time: 0.955430269241333
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 69 cost time: 1.0966498851776123
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 70 cost time: 1.1066372394561768
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 71 cost time: 1.092982530593872
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.848 Test Loss: 0.550 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 72 cost time: 1.078282117843628
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 73 cost time: 1.0490789413452148
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 74 cost time: 1.0743179321289062
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.848 Test Loss: 0.546 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 75 cost time: 0.9461939334869385
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.852 Test Loss: 0.545 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 76 cost time: 1.0950160026550293
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.852 Test Loss: 0.544 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 77 cost time: 0.9747519493103027
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 78 cost time: 0.9444382190704346
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 79 cost time: 1.036203145980835
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 80 cost time: 1.1174919605255127
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 81 cost time: 1.0822739601135254
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 82 cost time: 0.9357223510742188
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 83 cost time: 0.9432756900787354
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 84 cost time: 0.9074246883392334
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 85 cost time: 0.9592609405517578
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 86 cost time: 0.9685063362121582
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.859 Test Loss: 0.535 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 87 cost time: 1.115706443786621
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 88 cost time: 1.248392105102539
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 89 cost time: 1.0892624855041504
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.859 Test Loss: 0.532 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 90 cost time: 1.055652141571045
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 91 cost time: 0.9820342063903809
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 92 cost time: 0.900954008102417
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 93 cost time: 1.0716352462768555
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 0.925757646560669
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.0061023235321045
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.091245412826538
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 97 cost time: 1.1063518524169922
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 98 cost time: 1.1250314712524414
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.859 Test Loss: 0.524 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 99 cost time: 1.2596485614776611
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.859 Test Loss: 0.524 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 100 cost time: 1.0983455181121826
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3908538818359375
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.834 Vali Acc: 0.141 Test Loss: 1.834 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 0.9043998718261719
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.797 Vali Acc: 0.167 Test Loss: 1.797 Test Acc: 0.167
Validation loss decreased (-0.140722 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.8442206382751465
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.743 Vali Acc: 0.200 Test Loss: 1.743 Test Acc: 0.200
Validation loss decreased (-0.166649 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 0.8786060810089111
Epoch: 4, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.654 Vali Acc: 0.363 Test Loss: 1.654 Test Acc: 0.363
Validation loss decreased (-0.199983 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.9491591453552246
Epoch: 5, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.552 Vali Acc: 0.459 Test Loss: 1.552 Test Acc: 0.459
Validation loss decreased (-0.362946 --> -0.459244).  Saving model ...
Epoch: 6 cost time: 1.008613109588623
Epoch: 6, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.445 Vali Acc: 0.559 Test Loss: 1.445 Test Acc: 0.559
Validation loss decreased (-0.459244 --> -0.559245).  Saving model ...
Epoch: 7 cost time: 0.9637298583984375
Epoch: 7, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.340 Vali Acc: 0.589 Test Loss: 1.340 Test Acc: 0.589
Validation loss decreased (-0.559245 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 1.0418331623077393
Epoch: 8, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.242 Vali Acc: 0.619 Test Loss: 1.242 Test Acc: 0.619
Validation loss decreased (-0.588875 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 0.8437116146087646
Epoch: 9, Steps: 2 | Train Loss: 0.778 Vali Loss: 1.153 Vali Acc: 0.648 Test Loss: 1.153 Test Acc: 0.648
Validation loss decreased (-0.618506 --> -0.648137).  Saving model ...
Epoch: 10 cost time: 0.9200739860534668
Epoch: 10, Steps: 2 | Train Loss: 0.607 Vali Loss: 1.075 Vali Acc: 0.670 Test Loss: 1.075 Test Acc: 0.670
Validation loss decreased (-0.648137 --> -0.670360).  Saving model ...
Epoch: 11 cost time: 0.9798786640167236
Epoch: 11, Steps: 2 | Train Loss: 0.453 Vali Loss: 1.006 Vali Acc: 0.685 Test Loss: 1.006 Test Acc: 0.685
Validation loss decreased (-0.670360 --> -0.685175).  Saving model ...
Epoch: 12 cost time: 0.9526054859161377
Epoch: 12, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.951 Vali Acc: 0.693 Test Loss: 0.951 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692583).  Saving model ...
Epoch: 13 cost time: 0.9049680233001709
Epoch: 13, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.909 Vali Acc: 0.730 Test Loss: 0.909 Test Acc: 0.730
Validation loss decreased (-0.692583 --> -0.729621).  Saving model ...
Epoch: 14 cost time: 1.0677788257598877
Epoch: 14, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.875 Vali Acc: 0.726 Test Loss: 0.875 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9871418476104736
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.853 Vali Acc: 0.737 Test Loss: 0.853 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737029).  Saving model ...
Epoch: 16 cost time: 1.1603829860687256
Epoch: 16, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.828 Vali Acc: 0.741 Test Loss: 0.828 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740732).  Saving model ...
Epoch: 17 cost time: 1.0650486946105957
Epoch: 17, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.806 Vali Acc: 0.748 Test Loss: 0.806 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 18 cost time: 0.969996452331543
Epoch: 18, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.786 Vali Acc: 0.759 Test Loss: 0.786 Test Acc: 0.759
Validation loss decreased (-0.748140 --> -0.759251).  Saving model ...
Epoch: 19 cost time: 0.9458723068237305
Epoch: 19, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.771 Vali Acc: 0.763 Test Loss: 0.771 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762955).  Saving model ...
Epoch: 20 cost time: 0.9520041942596436
Epoch: 20, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.759 Vali Acc: 0.759 Test Loss: 0.759 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.024123191833496
Epoch: 21, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.749 Vali Acc: 0.763 Test Loss: 0.749 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 22 cost time: 0.957078218460083
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.774 Test Loss: 0.741 Test Acc: 0.774
Validation loss decreased (-0.762955 --> -0.774067).  Saving model ...
Epoch: 23 cost time: 0.9181609153747559
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 24 cost time: 1.027967929840088
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.778 Test Loss: 0.728 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 25 cost time: 0.947944164276123
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.781 Test Loss: 0.722 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 26 cost time: 1.074962854385376
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.781 Test Loss: 0.717 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 27 cost time: 1.0218870639801025
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.785 Test Loss: 0.713 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 28 cost time: 1.0082051753997803
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 0.8711440563201904
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 0.9472446441650391
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 31 cost time: 0.8942446708679199
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.793 Test Loss: 0.699 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 32 cost time: 0.876878023147583
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.793 Test Loss: 0.696 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 33 cost time: 0.864422082901001
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.793 Test Loss: 0.694 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 34 cost time: 0.9297099113464355
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 35 cost time: 0.9821028709411621
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 36 cost time: 1.1090173721313477
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 37 cost time: 0.9972996711730957
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 38 cost time: 1.03727388381958
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 39 cost time: 0.9760336875915527
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 40 cost time: 0.9945375919342041
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 41 cost time: 1.0342953205108643
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796290).  Saving model ...
Epoch: 42 cost time: 0.893378496170044
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 43 cost time: 1.0054969787597656
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 44 cost time: 1.0612332820892334
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 45 cost time: 1.0435895919799805
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 46 cost time: 1.0126867294311523
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.796 Test Loss: 0.671 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 47 cost time: 1.0700924396514893
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 48 cost time: 1.074066162109375
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 49 cost time: 1.037449836730957
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 50 cost time: 1.016108751296997
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799993).  Saving model ...
Epoch: 51 cost time: 0.9789323806762695
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 52 cost time: 0.9601962566375732
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.800 Test Loss: 0.663 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 53 cost time: 0.9287137985229492
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 54 cost time: 0.8615233898162842
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 55 cost time: 0.9725322723388672
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.804 Test Loss: 0.660 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 56 cost time: 1.0064857006072998
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.804 Test Loss: 0.658 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 57 cost time: 1.024979829788208
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 58 cost time: 0.9662222862243652
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.804 Test Loss: 0.656 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 59 cost time: 0.9889042377471924
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 60 cost time: 0.9917547702789307
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.807 Test Loss: 0.653 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 61 cost time: 1.1667466163635254
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.807 Test Loss: 0.651 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 62 cost time: 0.9928243160247803
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.807 Test Loss: 0.650 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 63 cost time: 1.0215375423431396
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 1.0191528797149658
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 65 cost time: 1.077436923980713
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 66 cost time: 1.0464179515838623
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 67 cost time: 1.1654484272003174
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 68 cost time: 1.2527873516082764
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 69 cost time: 1.1334538459777832
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.815 Test Loss: 0.640 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 70 cost time: 0.9626832008361816
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 71 cost time: 1.067840576171875
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.815 Test Loss: 0.637 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 72 cost time: 0.9294545650482178
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 73 cost time: 0.9418957233428955
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.815 Test Loss: 0.634 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 74 cost time: 0.9344096183776855
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.815 Test Loss: 0.633 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 75 cost time: 1.1429312229156494
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 76 cost time: 1.0295753479003906
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 77 cost time: 0.9922337532043457
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 78 cost time: 1.0407872200012207
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 79 cost time: 1.1777749061584473
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 80 cost time: 1.0795257091522217
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 81 cost time: 0.9997518062591553
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 82 cost time: 0.919980525970459
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 83 cost time: 0.9298865795135498
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 84 cost time: 0.9373393058776855
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 85 cost time: 1.250861406326294
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 86 cost time: 1.0652015209197998
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.819 Test Loss: 0.622 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 87 cost time: 1.1917214393615723
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 88 cost time: 1.043996810913086
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 89 cost time: 1.0557541847229004
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 90 cost time: 0.9362659454345703
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 91 cost time: 0.9088613986968994
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 92 cost time: 0.9519977569580078
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 93 cost time: 0.9869363307952881
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 94 cost time: 1.1220407485961914
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 95 cost time: 1.2298626899719238
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 96 cost time: 1.1396660804748535
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 97 cost time: 0.963090181350708
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 98 cost time: 1.200148582458496
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 99 cost time: 0.9509336948394775
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.830 Test Loss: 0.609 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 100 cost time: 0.8863513469696045
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.830 Test Loss: 0.608 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4953603744506836
Epoch: 1, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.777 Vali Acc: 0.167 Test Loss: 1.777 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.9046387672424316
Epoch: 2, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.750 Vali Acc: 0.181 Test Loss: 1.750 Test Acc: 0.181
Validation loss decreased (-0.166649 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.9986441135406494
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.713 Vali Acc: 0.207 Test Loss: 1.713 Test Acc: 0.207
Validation loss decreased (-0.181464 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.9417154788970947
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.652 Vali Acc: 0.341 Test Loss: 1.652 Test Acc: 0.341
Validation loss decreased (-0.207390 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.964153528213501
Epoch: 5, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.582 Vali Acc: 0.393 Test Loss: 1.582 Test Acc: 0.393
Validation loss decreased (-0.340724 --> -0.392577).  Saving model ...
Epoch: 6 cost time: 1.0093235969543457
Epoch: 6, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.507 Vali Acc: 0.463 Test Loss: 1.507 Test Acc: 0.463
Validation loss decreased (-0.392577 --> -0.462948).  Saving model ...
Epoch: 7 cost time: 0.9236655235290527
Epoch: 7, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.432 Vali Acc: 0.489 Test Loss: 1.432 Test Acc: 0.489
Validation loss decreased (-0.462948 --> -0.488875).  Saving model ...
Epoch: 8 cost time: 0.9405064582824707
Epoch: 8, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.359 Vali Acc: 0.507 Test Loss: 1.359 Test Acc: 0.507
Validation loss decreased (-0.488875 --> -0.507394).  Saving model ...
Epoch: 9 cost time: 0.9667177200317383
Epoch: 9, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.291 Vali Acc: 0.519 Test Loss: 1.291 Test Acc: 0.519
Validation loss decreased (-0.507394 --> -0.518506).  Saving model ...
Epoch: 10 cost time: 1.1039230823516846
Epoch: 10, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.228 Vali Acc: 0.559 Test Loss: 1.228 Test Acc: 0.559
Validation loss decreased (-0.518506 --> -0.559247).  Saving model ...
Epoch: 11 cost time: 1.1681978702545166
Epoch: 11, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.559247 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 1.3003342151641846
Epoch: 12, Steps: 2 | Train Loss: 0.521 Vali Loss: 1.122 Vali Acc: 0.593 Test Loss: 1.122 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0247864723205566
Epoch: 13, Steps: 2 | Train Loss: 0.378 Vali Loss: 1.082 Vali Acc: 0.604 Test Loss: 1.082 Test Acc: 0.604
Validation loss decreased (-0.599988 --> -0.603693).  Saving model ...
Epoch: 14 cost time: 0.9932048320770264
Epoch: 14, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.047 Vali Acc: 0.607 Test Loss: 1.047 Test Acc: 0.607
Validation loss decreased (-0.603693 --> -0.607397).  Saving model ...
Epoch: 15 cost time: 1.1077032089233398
Epoch: 15, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.019 Vali Acc: 0.619 Test Loss: 1.019 Test Acc: 0.619
Validation loss decreased (-0.607397 --> -0.618508).  Saving model ...
Epoch: 16 cost time: 0.9691081047058105
Epoch: 16, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.983 Vali Acc: 0.633 Test Loss: 0.983 Test Acc: 0.633
Validation loss decreased (-0.618508 --> -0.633324).  Saving model ...
Epoch: 17 cost time: 0.9780669212341309
Epoch: 17, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.947 Vali Acc: 0.637 Test Loss: 0.947 Test Acc: 0.637
Validation loss decreased (-0.633324 --> -0.637028).  Saving model ...
Epoch: 18 cost time: 0.973883867263794
Epoch: 18, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.914 Vali Acc: 0.667 Test Loss: 0.914 Test Acc: 0.667
Validation loss decreased (-0.637028 --> -0.666658).  Saving model ...
Epoch: 19 cost time: 1.0168137550354004
Epoch: 19, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.888 Vali Acc: 0.670 Test Loss: 0.888 Test Acc: 0.670
Validation loss decreased (-0.666658 --> -0.670361).  Saving model ...
Epoch: 20 cost time: 1.0315675735473633
Epoch: 20, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.869 Vali Acc: 0.681 Test Loss: 0.869 Test Acc: 0.681
Validation loss decreased (-0.670361 --> -0.681473).  Saving model ...
Epoch: 21 cost time: 1.1690609455108643
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.854 Vali Acc: 0.685 Test Loss: 0.854 Test Acc: 0.685
Validation loss decreased (-0.681473 --> -0.685177).  Saving model ...
Epoch: 22 cost time: 1.0677154064178467
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.843 Vali Acc: 0.693 Test Loss: 0.843 Test Acc: 0.693
Validation loss decreased (-0.685177 --> -0.692584).  Saving model ...
Epoch: 23 cost time: 1.1059277057647705
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.834 Vali Acc: 0.696 Test Loss: 0.834 Test Acc: 0.696
Validation loss decreased (-0.692584 --> -0.696288).  Saving model ...
Epoch: 24 cost time: 0.9960687160491943
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.826 Vali Acc: 0.711 Test Loss: 0.826 Test Acc: 0.711
Validation loss decreased (-0.696288 --> -0.711103).  Saving model ...
Epoch: 25 cost time: 0.8534560203552246
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.819 Vali Acc: 0.715 Test Loss: 0.819 Test Acc: 0.715
Validation loss decreased (-0.711103 --> -0.714807).  Saving model ...
Epoch: 26 cost time: 1.0376813411712646
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.814 Vali Acc: 0.719 Test Loss: 0.814 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718510).  Saving model ...
Epoch: 27 cost time: 0.9480149745941162
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.808 Vali Acc: 0.722 Test Loss: 0.808 Test Acc: 0.722
Validation loss decreased (-0.718510 --> -0.722214).  Saving model ...
Epoch: 28 cost time: 0.9782159328460693
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.726 Test Loss: 0.804 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 29 cost time: 1.0096185207366943
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
Validation loss decreased (-0.725918 --> -0.733325).  Saving model ...
Epoch: 30 cost time: 1.1820311546325684
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.737 Test Loss: 0.796 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 31 cost time: 1.0459883213043213
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 32 cost time: 1.0772581100463867
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.789 Vali Acc: 0.741 Test Loss: 0.789 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 33 cost time: 1.2104179859161377
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.744 Test Loss: 0.785 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 34 cost time: 1.081101894378662
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.748 Test Loss: 0.781 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 35 cost time: 1.0686888694763184
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.748 Test Loss: 0.777 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 36 cost time: 1.0330815315246582
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.774 Vali Acc: 0.752 Test Loss: 0.774 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 37 cost time: 1.0262634754180908
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 38 cost time: 0.9452733993530273
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.756 Test Loss: 0.768 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 39 cost time: 1.101344347000122
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 40 cost time: 1.0099670886993408
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 41 cost time: 1.1289141178131104
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 42 cost time: 1.0369923114776611
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 1.0501525402069092
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 44 cost time: 0.9579176902770996
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.756 Test Loss: 0.753 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 45 cost time: 0.9762284755706787
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.763 Test Loss: 0.750 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762955).  Saving model ...
Epoch: 46 cost time: 1.0083892345428467
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 47 cost time: 0.8467521667480469
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762956).  Saving model ...
Epoch: 48 cost time: 0.9416701793670654
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.763 Test Loss: 0.743 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 49 cost time: 1.1716670989990234
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.763 Test Loss: 0.740 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 50 cost time: 1.0890083312988281
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 51 cost time: 0.9039936065673828
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 52 cost time: 1.0538151264190674
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 53 cost time: 0.9591782093048096
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 54 cost time: 1.0635523796081543
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.763 Test Loss: 0.729 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 55 cost time: 1.0471258163452148
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.767 Test Loss: 0.727 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766659).  Saving model ...
Epoch: 56 cost time: 0.9266402721405029
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.770 Test Loss: 0.724 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 57 cost time: 0.9767284393310547
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.770 Test Loss: 0.722 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 58 cost time: 0.9631295204162598
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.770 Test Loss: 0.720 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 59 cost time: 1.0904898643493652
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.770 Test Loss: 0.718 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 60 cost time: 1.0542759895324707
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.770 Test Loss: 0.716 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 61 cost time: 1.0927684307098389
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 62 cost time: 1.0054285526275635
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.770 Test Loss: 0.713 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 63 cost time: 1.026306390762329
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 64 cost time: 1.0370287895202637
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.770 Test Loss: 0.710 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 65 cost time: 0.9907803535461426
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.774 Test Loss: 0.708 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 66 cost time: 1.058563232421875
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.774 Test Loss: 0.707 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 67 cost time: 0.9387848377227783
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.774 Test Loss: 0.705 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 68 cost time: 1.005676507949829
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 69 cost time: 1.0747098922729492
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.778 Test Loss: 0.702 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 70 cost time: 1.2729339599609375
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 71 cost time: 1.2231652736663818
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.778 Test Loss: 0.699 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 72 cost time: 1.1074585914611816
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 73 cost time: 1.147496223449707
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 74 cost time: 1.0133421421051025
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.778 Test Loss: 0.696 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 75 cost time: 1.0425732135772705
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.778 Test Loss: 0.695 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 76 cost time: 0.8848996162414551
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 77 cost time: 1.1364824771881104
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 78 cost time: 0.9535543918609619
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.778 Test Loss: 0.692 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 79 cost time: 0.9792516231536865
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.778 Test Loss: 0.691 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 80 cost time: 1.1025209426879883
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 81 cost time: 1.076967477798462
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.778 Test Loss: 0.689 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 82 cost time: 1.041081190109253
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.781 Test Loss: 0.688 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 83 cost time: 1.1694576740264893
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.781 Test Loss: 0.687 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 84 cost time: 1.0330569744110107
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.781 Test Loss: 0.685 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 85 cost time: 1.105788230895996
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.781 Test Loss: 0.684 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 86 cost time: 1.0294890403747559
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.781 Test Loss: 0.682 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 87 cost time: 1.0421686172485352
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.785 Test Loss: 0.681 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 88 cost time: 1.0749683380126953
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.785 Test Loss: 0.680 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 89 cost time: 1.0393640995025635
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.785 Test Loss: 0.679 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 90 cost time: 1.0957906246185303
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.785 Test Loss: 0.678 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 91 cost time: 1.1259517669677734
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.785 Test Loss: 0.678 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 92 cost time: 1.1043474674224854
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.785 Test Loss: 0.677 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 93 cost time: 1.1482701301574707
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.785 Test Loss: 0.676 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 94 cost time: 1.2031049728393555
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.785 Test Loss: 0.675 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 95 cost time: 0.9543557167053223
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.785 Test Loss: 0.675 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 96 cost time: 0.947681188583374
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.785 Test Loss: 0.674 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 97 cost time: 0.9906604290008545
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.785 Test Loss: 0.673 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 98 cost time: 1.0011579990386963
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.785 Test Loss: 0.672 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 99 cost time: 1.024367094039917
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.785 Test Loss: 0.672 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 100 cost time: 1.0750112533569336
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.785 Test Loss: 0.671 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7851851851851852
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5352396965026855
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.786 Vali Acc: 0.185 Test Loss: 1.786 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 1.0674057006835938
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.771 Vali Acc: 0.193 Test Loss: 1.771 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 1.0654113292694092
Epoch: 3, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.743 Vali Acc: 0.211 Test Loss: 1.743 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 0.9831209182739258
Epoch: 4, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.690 Vali Acc: 0.267 Test Loss: 1.690 Test Acc: 0.267
Validation loss decreased (-0.211094 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 1.1324939727783203
Epoch: 5, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.627 Vali Acc: 0.352 Test Loss: 1.627 Test Acc: 0.352
Validation loss decreased (-0.266650 --> -0.351836).  Saving model ...
Epoch: 6 cost time: 0.8889138698577881
Epoch: 6, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.553 Vali Acc: 0.474 Test Loss: 1.553 Test Acc: 0.474
Validation loss decreased (-0.351836 --> -0.474059).  Saving model ...
Epoch: 7 cost time: 0.9502530097961426
Epoch: 7, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.474 Vali Acc: 0.556 Test Loss: 1.474 Test Acc: 0.556
Validation loss decreased (-0.474059 --> -0.555541).  Saving model ...
Epoch: 8 cost time: 1.0510776042938232
Epoch: 8, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.392 Vali Acc: 0.593 Test Loss: 1.392 Test Acc: 0.593
Validation loss decreased (-0.555541 --> -0.592579).  Saving model ...
Epoch: 9 cost time: 1.1282176971435547
Epoch: 9, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.310 Vali Acc: 0.619 Test Loss: 1.310 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618505).  Saving model ...
Epoch: 10 cost time: 1.0292048454284668
Epoch: 10, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.229 Vali Acc: 0.659 Test Loss: 1.229 Test Acc: 0.659
Validation loss decreased (-0.618505 --> -0.659247).  Saving model ...
Epoch: 11 cost time: 1.0374975204467773
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.148 Vali Acc: 0.670 Test Loss: 1.148 Test Acc: 0.670
Validation loss decreased (-0.659247 --> -0.670359).  Saving model ...
Epoch: 12 cost time: 1.0723333358764648
Epoch: 12, Steps: 2 | Train Loss: 0.783 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
Validation loss decreased (-0.670359 --> -0.707397).  Saving model ...
Epoch: 13 cost time: 1.0355353355407715
Epoch: 13, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
Validation loss decreased (-0.707397 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.0327489376068115
Epoch: 14, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 1.134397029876709
Epoch: 15, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.867 Vali Acc: 0.741 Test Loss: 0.867 Test Acc: 0.741
Validation loss decreased (-0.733324 --> -0.740732).  Saving model ...
Epoch: 16 cost time: 0.971055269241333
Epoch: 16, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.811 Vali Acc: 0.748 Test Loss: 0.811 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 17 cost time: 1.0446383953094482
Epoch: 17, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.748140 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 0.9407885074615479
Epoch: 18, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.704 Vali Acc: 0.759 Test Loss: 0.704 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 19 cost time: 1.1062021255493164
Epoch: 19, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.657 Vali Acc: 0.774 Test Loss: 0.657 Test Acc: 0.774
Validation loss decreased (-0.759252 --> -0.774068).  Saving model ...
Epoch: 20 cost time: 1.0554254055023193
Epoch: 20, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.626 Vali Acc: 0.778 Test Loss: 0.626 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777772).  Saving model ...
Epoch: 21 cost time: 0.959705114364624
Epoch: 21, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.605 Vali Acc: 0.778 Test Loss: 0.605 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 22 cost time: 1.013854742050171
Epoch: 22, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.595 Vali Acc: 0.785 Test Loss: 0.595 Test Acc: 0.785
Validation loss decreased (-0.777772 --> -0.785179).  Saving model ...
Epoch: 23 cost time: 0.9689016342163086
Epoch: 23, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.785 Test Loss: 0.590 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 24 cost time: 0.9367327690124512
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.583 Vali Acc: 0.781 Test Loss: 0.583 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0055599212646484
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.778 Test Loss: 0.576 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0358750820159912
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 27 cost time: 1.12221360206604
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.800 Test Loss: 0.555 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 28 cost time: 0.9717566967010498
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.545 Vali Acc: 0.804 Test Loss: 0.545 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 29 cost time: 1.0358312129974365
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.804 Test Loss: 0.539 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 30 cost time: 1.1145868301391602
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.807 Test Loss: 0.532 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 31 cost time: 1.0767018795013428
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.527 Vali Acc: 0.811 Test Loss: 0.527 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811106).  Saving model ...
Epoch: 32 cost time: 1.1285982131958008
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.815 Test Loss: 0.524 Test Acc: 0.815
Validation loss decreased (-0.811106 --> -0.814810).  Saving model ...
Epoch: 33 cost time: 1.0096547603607178
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.815 Test Loss: 0.520 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 34 cost time: 1.0239498615264893
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.811 Test Loss: 0.517 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9705967903137207
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.811 Test Loss: 0.514 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.959949254989624
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.811 Test Loss: 0.512 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1088056564331055
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.815 Test Loss: 0.510 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 38 cost time: 1.1790289878845215
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.815 Test Loss: 0.509 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 39 cost time: 1.1515231132507324
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.815 Test Loss: 0.510 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1037750244140625
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
Validation loss decreased (-0.814810 --> -0.818513).  Saving model ...
Epoch: 41 cost time: 1.1128554344177246
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.815 Test Loss: 0.513 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2141509056091309
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.815 Test Loss: 0.511 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1376092433929443
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.169661283493042
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9923572540283203
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818514).  Saving model ...
Epoch: 46 cost time: 1.009016752243042
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 47 cost time: 1.0702431201934814
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 48 cost time: 1.2095129489898682
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.013185977935791
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0111041069030762
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1388802528381348
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 52 cost time: 1.0152361392974854
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 53 cost time: 0.897913932800293
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 54 cost time: 1.021623134613037
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9799933433532715
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 56 cost time: 0.8904366493225098
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.818514 --> -0.822217).  Saving model ...
Epoch: 57 cost time: 0.9203701019287109
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 58 cost time: 1.0225205421447754
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 59 cost time: 1.1890013217926025
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 60 cost time: 1.0572032928466797
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 61 cost time: 1.0591099262237549
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 62 cost time: 1.114927053451538
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 63 cost time: 0.9963805675506592
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
Validation loss decreased (-0.825921 --> -0.833329).  Saving model ...
Epoch: 64 cost time: 1.1590056419372559
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 65 cost time: 1.171424150466919
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 66 cost time: 1.1330432891845703
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 67 cost time: 0.9906394481658936
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 68 cost time: 1.1877074241638184
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 69 cost time: 1.0757365226745605
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.837 Test Loss: 0.472 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837032).  Saving model ...
Epoch: 70 cost time: 1.154642105102539
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9887056350708008
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9343850612640381
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.830 Test Loss: 0.470 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9934377670288086
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.0513551235198975
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.0620765686035156
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 76 cost time: 1.1105730533599854
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 77 cost time: 1.1953909397125244
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0400323867797852
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9780752658843994
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 80 cost time: 1.0714976787567139
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9857738018035889
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 82 cost time: 0.9686522483825684
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.837 Test Loss: 0.466 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 83 cost time: 0.946047306060791
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.837 Test Loss: 0.466 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 84 cost time: 1.2164406776428223
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.837 Test Loss: 0.465 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 85 cost time: 1.1461660861968994
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 86 cost time: 1.1327152252197266
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 87 cost time: 1.2805821895599365
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 88 cost time: 1.1714322566986084
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 89 cost time: 1.155151128768921
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 90 cost time: 1.187321424484253
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 91 cost time: 1.1893041133880615
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 92 cost time: 1.0310842990875244
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 93 cost time: 1.1425890922546387
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 94 cost time: 1.3365223407745361
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 95 cost time: 1.2448854446411133
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 96 cost time: 1.2521004676818848
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
Validation loss decreased (-0.844440 --> -0.848144).  Saving model ...
Epoch: 97 cost time: 1.1447784900665283
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 98 cost time: 1.014808177947998
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.852 Test Loss: 0.447 Test Acc: 0.852
Validation loss decreased (-0.848144 --> -0.851847).  Saving model ...
Epoch: 99 cost time: 1.1434085369110107
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.852 Test Loss: 0.446 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 100 cost time: 1.0096900463104248
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.852 Test Loss: 0.445 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5769968032836914
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.843 Vali Acc: 0.193 Test Loss: 1.843 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.961259126663208
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.832 Vali Acc: 0.196 Test Loss: 1.832 Test Acc: 0.196
Validation loss decreased (-0.192574 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.9788501262664795
Epoch: 3, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.796 Vali Acc: 0.219 Test Loss: 1.796 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.9973061084747314
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.711 Vali Acc: 0.233 Test Loss: 1.711 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 1.0288846492767334
Epoch: 5, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.608 Vali Acc: 0.378 Test Loss: 1.608 Test Acc: 0.378
Validation loss decreased (-0.233316 --> -0.377762).  Saving model ...
Epoch: 6 cost time: 0.9864916801452637
Epoch: 6, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.489 Vali Acc: 0.474 Test Loss: 1.489 Test Acc: 0.474
Validation loss decreased (-0.377762 --> -0.474059).  Saving model ...
Epoch: 7 cost time: 1.2097558975219727
Epoch: 7, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.363 Vali Acc: 0.574 Test Loss: 1.363 Test Acc: 0.574
Validation loss decreased (-0.474059 --> -0.574060).  Saving model ...
Epoch: 8 cost time: 1.0908973217010498
Epoch: 8, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.237 Vali Acc: 0.644 Test Loss: 1.237 Test Acc: 0.644
Validation loss decreased (-0.574060 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.0146563053131104
Epoch: 9, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.122 Vali Acc: 0.700 Test Loss: 1.122 Test Acc: 0.700
Validation loss decreased (-0.644432 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 1.085693597793579
Epoch: 10, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.013 Vali Acc: 0.759 Test Loss: 1.013 Test Acc: 0.759
Validation loss decreased (-0.699989 --> -0.759249).  Saving model ...
Epoch: 11 cost time: 1.0954623222351074
Epoch: 11, Steps: 2 | Train Loss: 1.199 Vali Loss: 0.908 Vali Acc: 0.778 Test Loss: 0.908 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777769).  Saving model ...
Epoch: 12 cost time: 1.1335949897766113
Epoch: 12, Steps: 2 | Train Loss: 1.037 Vali Loss: 0.811 Vali Acc: 0.811 Test Loss: 0.811 Test Acc: 0.811
Validation loss decreased (-0.777769 --> -0.811103).  Saving model ...
Epoch: 13 cost time: 1.08331298828125
Epoch: 13, Steps: 2 | Train Loss: 1.025 Vali Loss: 0.722 Vali Acc: 0.837 Test Loss: 0.722 Test Acc: 0.837
Validation loss decreased (-0.811103 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 1.081075668334961
Epoch: 14, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
Validation loss decreased (-0.837030 --> -0.859253).  Saving model ...
Epoch: 15 cost time: 1.0389337539672852
Epoch: 15, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
Validation loss decreased (-0.859253 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 1.049072504043579
Epoch: 16, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.492 Vali Acc: 0.904 Test Loss: 0.492 Test Acc: 0.904
Validation loss decreased (-0.877772 --> -0.903699).  Saving model ...
Epoch: 17 cost time: 1.0492174625396729
Epoch: 17, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.434 Vali Acc: 0.907 Test Loss: 0.434 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 1.0136866569519043
Epoch: 18, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.390 Vali Acc: 0.915 Test Loss: 0.390 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.9745240211486816
Epoch: 19, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 1.0679576396942139
Epoch: 20, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 1.0029234886169434
Epoch: 21, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0951001644134521
Epoch: 22, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1126794815063477
Epoch: 23, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9040703773498535
Epoch: 24, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.263 Vali Acc: 0.907 Test Loss: 0.263 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0337328910827637
Epoch: 25, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9533777236938477
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9942965507507324
Epoch: 27, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.9295077323913574
Epoch: 28, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9493045806884766
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 1.0867362022399902
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 1.0239245891571045
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 1.1814818382263184
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 1.0844752788543701
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 1.0940954685211182
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9706075191497803
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0705204010009766
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.078706979751587
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9889001846313477
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0678479671478271
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.113149881362915
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.242344856262207
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1214261054992676
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1681797504425049
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2732491493225098
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.805 Vali Acc: 0.174 Test Loss: 1.805 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 1.004990577697754
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.796 Vali Acc: 0.178 Test Loss: 1.796 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.8435142040252686
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.753 Vali Acc: 0.204 Test Loss: 1.753 Test Acc: 0.204
Validation loss decreased (-0.177760 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 1.0172953605651855
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.648 Vali Acc: 0.322 Test Loss: 1.648 Test Acc: 0.322
Validation loss decreased (-0.203686 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 1.1827185153961182
Epoch: 5, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.525 Vali Acc: 0.448 Test Loss: 1.525 Test Acc: 0.448
Validation loss decreased (-0.322206 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 1.0641963481903076
Epoch: 6, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.386 Vali Acc: 0.570 Test Loss: 1.386 Test Acc: 0.570
Validation loss decreased (-0.448133 --> -0.570357).  Saving model ...
Epoch: 7 cost time: 1.057201862335205
Epoch: 7, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.248 Vali Acc: 0.678 Test Loss: 1.248 Test Acc: 0.678
Validation loss decreased (-0.570357 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 0.928593635559082
Epoch: 8, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.117 Vali Acc: 0.752 Test Loss: 1.117 Test Acc: 0.752
Validation loss decreased (-0.677765 --> -0.751841).  Saving model ...
Epoch: 9 cost time: 0.9082975387573242
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 0.997 Vali Acc: 0.804 Test Loss: 0.997 Test Acc: 0.804
Validation loss decreased (-0.751841 --> -0.803694).  Saving model ...
Epoch: 10 cost time: 0.9341075420379639
Epoch: 10, Steps: 2 | Train Loss: 1.293 Vali Loss: 0.888 Vali Acc: 0.819 Test Loss: 0.888 Test Acc: 0.819
Validation loss decreased (-0.803694 --> -0.818510).  Saving model ...
Epoch: 11 cost time: 0.9176084995269775
Epoch: 11, Steps: 2 | Train Loss: 1.252 Vali Loss: 0.785 Vali Acc: 0.856 Test Loss: 0.785 Test Acc: 0.856
Validation loss decreased (-0.818510 --> -0.855548).  Saving model ...
Epoch: 12 cost time: 0.9487061500549316
Epoch: 12, Steps: 2 | Train Loss: 1.182 Vali Loss: 0.692 Vali Acc: 0.874 Test Loss: 0.692 Test Acc: 0.874
Validation loss decreased (-0.855548 --> -0.874067).  Saving model ...
Epoch: 13 cost time: 0.9102978706359863
Epoch: 13, Steps: 2 | Train Loss: 1.098 Vali Loss: 0.614 Vali Acc: 0.881 Test Loss: 0.614 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 14 cost time: 1.1238842010498047
Epoch: 14, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.543 Vali Acc: 0.885 Test Loss: 0.543 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885180).  Saving model ...
Epoch: 15 cost time: 1.2427582740783691
Epoch: 15, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.482 Vali Acc: 0.907 Test Loss: 0.482 Test Acc: 0.907
Validation loss decreased (-0.885180 --> -0.907403).  Saving model ...
Epoch: 16 cost time: 1.0198025703430176
Epoch: 16, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
Validation loss decreased (-0.907403 --> -0.922218).  Saving model ...
Epoch: 17 cost time: 1.0889670848846436
Epoch: 17, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.386 Vali Acc: 0.926 Test Loss: 0.386 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 1.0608160495758057
Epoch: 18, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 1.028291940689087
Epoch: 19, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0902252197265625
Epoch: 20, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9874064922332764
Epoch: 21, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9396345615386963
Epoch: 22, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9534354209899902
Epoch: 23, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0276634693145752
Epoch: 24, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0756866931915283
Epoch: 25, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.05686616897583
Epoch: 26, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 1.1389365196228027
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 1.1107823848724365
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.998021125793457
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0319290161132812
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.064565658569336
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0676608085632324
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0566425323486328
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9833242893218994
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1458616256713867
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1076650619506836
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0293958187103271
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1326851844787598
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4805800914764404
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0305774211883545
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.9353351593017578
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0207056999206543
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.094820499420166
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0909349918365479
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.0868949890136719
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0480148792266846
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1317970752716064
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9910593032836914
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9754889011383057
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.007615566253662
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0443041324615479
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9866733551025391
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.1449778079986572
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.0933918952941895
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.908545732498169
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.039703607559204
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9878177642822266
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8987560272216797
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9313685894012451
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 0.9797627925872803
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9248359203338623
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9616107940673828
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 0.9339547157287598
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 0.9786722660064697
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 0.9693083763122559
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.058358907699585
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 0.9755403995513916
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9734814167022705
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9517285823822021
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0634822845458984
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8899092674255371
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9155209064483643
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0796170234680176
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0146501064300537
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 0.947629451751709
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.054319143295288
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0250895023345947
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1519839763641357
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1211907863616943
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 0.9144234657287598
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 0.9862499237060547
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 0.8714957237243652
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 0.8530359268188477
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.950387716293335
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9739515781402588
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9390072822570801
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.0005695819854736
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.023918628692627
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.0029327869415283
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 0.9289278984069824
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 0.9851236343383789
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.0871801376342773
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 0.9218363761901855
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.0240588188171387
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.039177417755127
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9656567573547363
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9316480159759521
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.1096763610839844
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9265749454498291
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.0504131317138672
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.0803160667419434
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.1808998584747314
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.0559213161468506
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.0525391101837158
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.0391414165496826
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.116903305053711
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9969015121459961
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.001295804977417
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 0.9955871105194092
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.037769079208374
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9674561023712158
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.1412737369537354
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.109670639038086
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.1024484634399414
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.0481717586517334
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.0834763050079346
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 0.9779996871948242
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 0.9692666530609131
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.046320915222168
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9825732707977295
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.1169393062591553
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9981648921966553
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.100935459136963
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.0759987831115723
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.0659687519073486
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.165252685546875
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.078582763671875
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.9914534091949463
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 5358342
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.421799421310425
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.769 Vali Acc: 0.196 Test Loss: 1.769 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.9499704837799072
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.719 Vali Acc: 0.252 Test Loss: 1.719 Test Acc: 0.252
Validation loss decreased (-0.196279 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 1.0678141117095947
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.648 Vali Acc: 0.370 Test Loss: 1.648 Test Acc: 0.370
Validation loss decreased (-0.251835 --> -0.370354).  Saving model ...
Epoch: 4 cost time: 1.0186216831207275
Epoch: 4, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.525 Vali Acc: 0.563 Test Loss: 1.525 Test Acc: 0.563
Validation loss decreased (-0.370354 --> -0.562948).  Saving model ...
Epoch: 5 cost time: 0.9914507865905762
Epoch: 5, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.380 Vali Acc: 0.693 Test Loss: 1.380 Test Acc: 0.693
Validation loss decreased (-0.562948 --> -0.692579).  Saving model ...
Epoch: 6 cost time: 0.9129228591918945
Epoch: 6, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.231 Vali Acc: 0.737 Test Loss: 1.231 Test Acc: 0.737
Validation loss decreased (-0.692579 --> -0.737025).  Saving model ...
Epoch: 7 cost time: 0.9925503730773926
Epoch: 7, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.087 Vali Acc: 0.774 Test Loss: 1.087 Test Acc: 0.774
Validation loss decreased (-0.737025 --> -0.774063).  Saving model ...
Epoch: 8 cost time: 0.9008910655975342
Epoch: 8, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.956 Vali Acc: 0.789 Test Loss: 0.956 Test Acc: 0.789
Validation loss decreased (-0.774063 --> -0.788879).  Saving model ...
Epoch: 9 cost time: 0.8458249568939209
Epoch: 9, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.842 Vali Acc: 0.807 Test Loss: 0.842 Test Acc: 0.807
Validation loss decreased (-0.788879 --> -0.807399).  Saving model ...
Epoch: 10 cost time: 0.9361326694488525
Epoch: 10, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.750 Vali Acc: 0.807 Test Loss: 0.750 Test Acc: 0.807
Validation loss decreased (-0.807399 --> -0.807400).  Saving model ...
Epoch: 11 cost time: 0.8793408870697021
Epoch: 11, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.682 Vali Acc: 0.807 Test Loss: 0.682 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807401).  Saving model ...
Epoch: 12 cost time: 0.9429690837860107
Epoch: 12, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.629 Vali Acc: 0.807 Test Loss: 0.629 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 13 cost time: 0.9438490867614746
Epoch: 13, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.596 Vali Acc: 0.811 Test Loss: 0.596 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.009397029876709
Epoch: 14, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.576 Vali Acc: 0.811 Test Loss: 0.576 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 0.9322681427001953
Epoch: 15, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.566 Vali Acc: 0.815 Test Loss: 0.566 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 16 cost time: 0.9831712245941162
Epoch: 16, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.815 Test Loss: 0.560 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 17 cost time: 1.1233031749725342
Epoch: 17, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 18 cost time: 1.0767250061035156
Epoch: 18, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9198870658874512
Epoch: 19, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.96173095703125
Epoch: 20, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8865985870361328
Epoch: 21, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9476151466369629
Epoch: 22, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825920).  Saving model ...
Epoch: 23 cost time: 0.9530384540557861
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.830 Test Loss: 0.568 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 24 cost time: 1.1251740455627441
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.830 Test Loss: 0.569 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0394301414489746
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.830 Test Loss: 0.570 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0982544422149658
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.830 Test Loss: 0.571 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.08062744140625
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.830 Test Loss: 0.572 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1332097053527832
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 0.9975526332855225
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.057267427444458
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0193650722503662
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 32 cost time: 0.9982430934906006
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 0.9739894866943359
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.837 Test Loss: 0.571 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 34 cost time: 1.0443227291107178
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 35 cost time: 1.1838793754577637
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 36 cost time: 1.062645435333252
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 37 cost time: 1.0460765361785889
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 38 cost time: 1.0641534328460693
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 39 cost time: 0.942105770111084
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 40 cost time: 0.922199010848999
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 41 cost time: 0.9047775268554688
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 42 cost time: 0.969301700592041
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 43 cost time: 1.0335381031036377
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 44 cost time: 1.1089439392089844
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 45 cost time: 1.1852648258209229
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 46 cost time: 1.0483219623565674
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 47 cost time: 1.063668966293335
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 48 cost time: 1.075883150100708
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 49 cost time: 1.0680530071258545
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 50 cost time: 0.9457287788391113
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 51 cost time: 1.1791484355926514
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 52 cost time: 1.21588134765625
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 53 cost time: 0.9717240333557129
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 54 cost time: 1.1116256713867188
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 55 cost time: 1.0209498405456543
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 56 cost time: 0.988692045211792
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.852 Test Loss: 0.557 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 57 cost time: 1.0703480243682861
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.852 Test Loss: 0.557 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 58 cost time: 1.0237905979156494
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.852 Test Loss: 0.556 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 59 cost time: 1.2270808219909668
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.852 Test Loss: 0.555 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 60 cost time: 0.9563133716583252
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.852 Test Loss: 0.555 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 61 cost time: 1.027245044708252
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.852 Test Loss: 0.554 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 62 cost time: 0.9963979721069336
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.852 Test Loss: 0.553 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 63 cost time: 1.0726196765899658
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.852 Test Loss: 0.552 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 64 cost time: 1.1477108001708984
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.852 Test Loss: 0.551 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 65 cost time: 1.105384111404419
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.852 Test Loss: 0.551 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 66 cost time: 0.9089629650115967
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.852 Test Loss: 0.550 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 67 cost time: 1.0080265998840332
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.852 Test Loss: 0.550 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 68 cost time: 1.0122761726379395
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.852 Test Loss: 0.549 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 69 cost time: 0.9473841190338135
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.852 Test Loss: 0.548 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 70 cost time: 1.0889763832092285
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.852 Test Loss: 0.548 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 71 cost time: 1.0070445537567139
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 72 cost time: 1.0007882118225098
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 73 cost time: 1.0826280117034912
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 74 cost time: 1.1061294078826904
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 75 cost time: 1.0673625469207764
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 76 cost time: 1.1351375579833984
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 77 cost time: 1.167327642440796
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 78 cost time: 1.0645477771759033
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 79 cost time: 1.0041542053222656
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 80 cost time: 0.9690876007080078
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 81 cost time: 1.0582821369171143
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 82 cost time: 1.066321611404419
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 83 cost time: 1.0868911743164062
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 84 cost time: 1.0607576370239258
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 85 cost time: 0.9829540252685547
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.859 Test Loss: 0.535 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 86 cost time: 1.0270311832427979
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 87 cost time: 1.1799275875091553
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 88 cost time: 1.040048599243164
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 89 cost time: 1.1342315673828125
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.859 Test Loss: 0.532 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 90 cost time: 0.9374611377716064
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.859 Test Loss: 0.532 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 91 cost time: 1.0662705898284912
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 92 cost time: 0.9892430305480957
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 93 cost time: 1.1254777908325195
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 1.0446486473083496
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 0.9531946182250977
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.2932560443878174
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 97 cost time: 1.1343419551849365
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 98 cost time: 1.1293351650238037
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 99 cost time: 1.084456205368042
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 100 cost time: 1.185075283050537
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.650015354156494
Epoch: 1, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.745 Vali Acc: 0.274 Test Loss: 1.745 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.9450953006744385
Epoch: 2, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.708 Vali Acc: 0.326 Test Loss: 1.708 Test Acc: 0.326
Validation loss decreased (-0.274057 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 0.9136044979095459
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.654 Vali Acc: 0.367 Test Loss: 1.654 Test Acc: 0.367
Validation loss decreased (-0.325909 --> -0.366650).  Saving model ...
Epoch: 4 cost time: 1.0369584560394287
Epoch: 4, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.559 Vali Acc: 0.474 Test Loss: 1.559 Test Acc: 0.474
Validation loss decreased (-0.366650 --> -0.474058).  Saving model ...
Epoch: 5 cost time: 1.1127018928527832
Epoch: 5, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.448 Vali Acc: 0.563 Test Loss: 1.448 Test Acc: 0.563
Validation loss decreased (-0.474058 --> -0.562948).  Saving model ...
Epoch: 6 cost time: 1.0714075565338135
Epoch: 6, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.332 Vali Acc: 0.652 Test Loss: 1.332 Test Acc: 0.652
Validation loss decreased (-0.562948 --> -0.651839).  Saving model ...
Epoch: 7 cost time: 0.9623935222625732
Epoch: 7, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.218 Vali Acc: 0.674 Test Loss: 1.218 Test Acc: 0.674
Validation loss decreased (-0.651839 --> -0.674062).  Saving model ...
Epoch: 8 cost time: 1.0551540851593018
Epoch: 8, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.112 Vali Acc: 0.689 Test Loss: 1.112 Test Acc: 0.689
Validation loss decreased (-0.674062 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 0.9576606750488281
Epoch: 9, Steps: 2 | Train Loss: 0.682 Vali Loss: 1.015 Vali Acc: 0.715 Test Loss: 1.015 Test Acc: 0.715
Validation loss decreased (-0.688878 --> -0.714805).  Saving model ...
Epoch: 10 cost time: 1.0716462135314941
Epoch: 10, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.935 Vali Acc: 0.726 Test Loss: 0.935 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725917).  Saving model ...
Epoch: 11 cost time: 1.0549302101135254
Epoch: 11, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.870 Vali Acc: 0.730 Test Loss: 0.870 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 12 cost time: 0.9860126972198486
Epoch: 12, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.816 Vali Acc: 0.726 Test Loss: 0.816 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.126706600189209
Epoch: 13, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.773 Vali Acc: 0.748 Test Loss: 0.773 Test Acc: 0.748
Validation loss decreased (-0.729621 --> -0.748140).  Saving model ...
Epoch: 14 cost time: 0.981736421585083
Epoch: 14, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.741 Vali Acc: 0.748 Test Loss: 0.741 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748141).  Saving model ...
Epoch: 15 cost time: 1.0934107303619385
Epoch: 15, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
Validation loss decreased (-0.748141 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 0.9938814640045166
Epoch: 16, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.695 Vali Acc: 0.759 Test Loss: 0.695 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 17 cost time: 1.02586030960083
Epoch: 17, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 18 cost time: 1.0558054447174072
Epoch: 18, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.668 Vali Acc: 0.767 Test Loss: 0.668 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 19 cost time: 1.0963613986968994
Epoch: 19, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.774 Test Loss: 0.657 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774068).  Saving model ...
Epoch: 20 cost time: 1.0690748691558838
Epoch: 20, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.774068 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 1.0067596435546875
Epoch: 21, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 1.2431442737579346
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
Validation loss decreased (-0.788882 --> -0.796290).  Saving model ...
Epoch: 23 cost time: 1.119694471359253
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 24 cost time: 1.1502573490142822
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 25 cost time: 1.096935749053955
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803697).  Saving model ...
Epoch: 26 cost time: 1.0746140480041504
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 27 cost time: 1.2123503684997559
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 28 cost time: 1.0165326595306396
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.807 Test Loss: 0.619 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 29 cost time: 1.0854721069335938
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 30 cost time: 1.0752284526824951
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.811 Test Loss: 0.614 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 31 cost time: 1.1021394729614258
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 0.9904255867004395
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.815 Test Loss: 0.608 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 33 cost time: 1.1753144264221191
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.811 Test Loss: 0.606 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0281174182891846
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0118210315704346
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8439958095550537
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.815 Test Loss: 0.598 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 37 cost time: 1.1313507556915283
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 38 cost time: 0.9506533145904541
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 39 cost time: 1.1341588497161865
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.815 Test Loss: 0.592 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0490806102752686
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9954330921173096
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 0.8697781562805176
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 43 cost time: 0.9700660705566406
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 44 cost time: 1.1167287826538086
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.826 Test Loss: 0.583 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 45 cost time: 1.1636242866516113
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 46 cost time: 1.0335397720336914
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 47 cost time: 1.0109748840332031
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.826 Test Loss: 0.578 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 48 cost time: 1.1004612445831299
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 49 cost time: 1.1939713954925537
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 50 cost time: 1.2229206562042236
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 51 cost time: 1.018674373626709
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 52 cost time: 1.1315820217132568
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 53 cost time: 1.0041909217834473
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 54 cost time: 1.0015642642974854
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 55 cost time: 0.9710345268249512
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 56 cost time: 1.1565678119659424
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 57 cost time: 1.0829834938049316
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.830 Test Loss: 0.566 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 58 cost time: 1.1693332195281982
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.830 Test Loss: 0.565 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 59 cost time: 1.051969051361084
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 60 cost time: 1.1630001068115234
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 61 cost time: 1.2287821769714355
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 62 cost time: 1.089099645614624
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 63 cost time: 1.0330159664154053
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 64 cost time: 1.0840749740600586
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 65 cost time: 1.1060113906860352
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 66 cost time: 1.2007246017456055
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 67 cost time: 1.1085467338562012
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 68 cost time: 1.1085612773895264
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 1.1326038837432861
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 1.056443691253662
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 71 cost time: 1.1457855701446533
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 1.1175854206085205
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 73 cost time: 0.9817216396331787
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 74 cost time: 1.0031774044036865
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 75 cost time: 0.9661250114440918
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 76 cost time: 1.0559706687927246
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 77 cost time: 1.1896216869354248
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 78 cost time: 1.0946598052978516
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 79 cost time: 1.0014441013336182
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 80 cost time: 1.070460557937622
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 81 cost time: 1.0045666694641113
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.837 Test Loss: 0.538 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 82 cost time: 1.0779712200164795
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.837 Test Loss: 0.537 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 83 cost time: 1.0400290489196777
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.837 Test Loss: 0.536 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 84 cost time: 1.0355620384216309
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.837 Test Loss: 0.535 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 85 cost time: 1.11966872215271
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.837 Test Loss: 0.534 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 86 cost time: 1.119194746017456
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.837 Test Loss: 0.533 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 87 cost time: 1.0292081832885742
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.837 Test Loss: 0.533 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 88 cost time: 1.1350164413452148
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.837 Test Loss: 0.532 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 89 cost time: 1.056976556777954
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.837 Test Loss: 0.531 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 90 cost time: 0.9737646579742432
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.837 Test Loss: 0.530 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 91 cost time: 1.2237300872802734
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.837 Test Loss: 0.529 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 92 cost time: 1.1164581775665283
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.837 Test Loss: 0.529 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 93 cost time: 1.1428325176239014
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.837 Test Loss: 0.528 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 94 cost time: 1.003248929977417
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.837 Test Loss: 0.527 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 95 cost time: 1.1014976501464844
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.837 Test Loss: 0.527 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 96 cost time: 1.0419933795928955
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.837 Test Loss: 0.526 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 97 cost time: 1.0691168308258057
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.837032 --> -0.844439).  Saving model ...
Epoch: 98 cost time: 1.1194159984588623
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 99 cost time: 1.1242194175720215
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 100 cost time: 0.9475135803222656
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8444444444444444
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7467899322509766
Epoch: 1, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.781 Vali Acc: 0.237 Test Loss: 1.781 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 1.0795764923095703
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.751 Vali Acc: 0.241 Test Loss: 1.751 Test Acc: 0.241
Validation loss decreased (-0.237019 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 1.0243399143218994
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.707 Vali Acc: 0.281 Test Loss: 1.707 Test Acc: 0.281
Validation loss decreased (-0.240723 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 1.0177133083343506
Epoch: 4, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.632 Vali Acc: 0.337 Test Loss: 1.632 Test Acc: 0.337
Validation loss decreased (-0.281464 --> -0.337021).  Saving model ...
Epoch: 5 cost time: 1.1080682277679443
Epoch: 5, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.543 Vali Acc: 0.426 Test Loss: 1.543 Test Acc: 0.426
Validation loss decreased (-0.337021 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.9850163459777832
Epoch: 6, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.448 Vali Acc: 0.522 Test Loss: 1.448 Test Acc: 0.522
Validation loss decreased (-0.425910 --> -0.522208).  Saving model ...
Epoch: 7 cost time: 1.0281932353973389
Epoch: 7, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.353 Vali Acc: 0.600 Test Loss: 1.353 Test Acc: 0.600
Validation loss decreased (-0.522208 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 1.0075678825378418
Epoch: 8, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.260 Vali Acc: 0.648 Test Loss: 1.260 Test Acc: 0.648
Validation loss decreased (-0.599986 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 1.0647623538970947
Epoch: 9, Steps: 2 | Train Loss: 0.787 Vali Loss: 1.173 Vali Acc: 0.659 Test Loss: 1.173 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659248).  Saving model ...
Epoch: 10 cost time: 0.984116792678833
Epoch: 10, Steps: 2 | Train Loss: 0.627 Vali Loss: 1.097 Vali Acc: 0.678 Test Loss: 1.097 Test Acc: 0.678
Validation loss decreased (-0.659248 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 1.0323131084442139
Epoch: 11, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.030 Vali Acc: 0.681 Test Loss: 1.030 Test Acc: 0.681
Validation loss decreased (-0.677767 --> -0.681471).  Saving model ...
Epoch: 12 cost time: 0.9470620155334473
Epoch: 12, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.973 Vali Acc: 0.707 Test Loss: 0.973 Test Acc: 0.707
Validation loss decreased (-0.681471 --> -0.707398).  Saving model ...
Epoch: 13 cost time: 0.9435138702392578
Epoch: 13, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.921 Vali Acc: 0.719 Test Loss: 0.921 Test Acc: 0.719
Validation loss decreased (-0.707398 --> -0.718509).  Saving model ...
Epoch: 14 cost time: 0.9892919063568115
Epoch: 14, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 1.115790605545044
Epoch: 15, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.848 Vali Acc: 0.726 Test Loss: 0.848 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 16 cost time: 0.9563488960266113
Epoch: 16, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
Validation loss decreased (-0.725917 --> -0.733325).  Saving model ...
Epoch: 17 cost time: 0.9938192367553711
Epoch: 17, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.802 Vali Acc: 0.726 Test Loss: 0.802 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1531167030334473
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.787 Vali Acc: 0.741 Test Loss: 0.787 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740733).  Saving model ...
Epoch: 19 cost time: 1.1384222507476807
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
Validation loss decreased (-0.740733 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.019740104675293
Epoch: 20, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.764 Vali Acc: 0.759 Test Loss: 0.764 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 21 cost time: 0.9168524742126465
Epoch: 21, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.757 Vali Acc: 0.759 Test Loss: 0.757 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 22 cost time: 1.2126743793487549
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.749 Vali Acc: 0.767 Test Loss: 0.749 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 23 cost time: 0.9530429840087891
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.770 Test Loss: 0.743 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 24 cost time: 0.9138565063476562
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.774 Test Loss: 0.737 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 25 cost time: 1.0080273151397705
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 1.0190904140472412
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 0.9922053813934326
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 28 cost time: 1.0956342220306396
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 1.087050437927246
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 1.0822455883026123
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.793 Test Loss: 0.711 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792585).  Saving model ...
Epoch: 31 cost time: 1.1184279918670654
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.793 Test Loss: 0.707 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792586).  Saving model ...
Epoch: 32 cost time: 1.1274638175964355
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.793 Test Loss: 0.703 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 33 cost time: 1.0372285842895508
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.793 Test Loss: 0.699 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 34 cost time: 1.039841651916504
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.792586 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 1.1511969566345215
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 1.3063700199127197
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 37 cost time: 1.1405985355377197
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 1.1317250728607178
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 39 cost time: 1.0490503311157227
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.804 Test Loss: 0.682 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 40 cost time: 1.1614420413970947
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 41 cost time: 1.1465387344360352
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.804 Test Loss: 0.677 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 42 cost time: 1.2343707084655762
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.804 Test Loss: 0.675 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 43 cost time: 1.0054140090942383
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.804 Test Loss: 0.673 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 44 cost time: 1.1756584644317627
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.804 Test Loss: 0.672 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 45 cost time: 1.0358037948608398
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.804 Test Loss: 0.671 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 46 cost time: 0.9807994365692139
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 47 cost time: 1.2221548557281494
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.804 Test Loss: 0.668 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 48 cost time: 1.020569086074829
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.804 Test Loss: 0.667 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 49 cost time: 1.1909220218658447
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.804 Test Loss: 0.666 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 50 cost time: 1.0464012622833252
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.807 Test Loss: 0.665 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 51 cost time: 1.1151056289672852
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.807 Test Loss: 0.664 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 52 cost time: 0.9698576927185059
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.807 Test Loss: 0.663 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 53 cost time: 0.9619226455688477
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.807 Test Loss: 0.662 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 54 cost time: 1.1360490322113037
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.811 Test Loss: 0.661 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 55 cost time: 1.0258827209472656
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 56 cost time: 0.9932811260223389
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 57 cost time: 0.9804613590240479
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 58 cost time: 1.0432918071746826
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 59 cost time: 1.2543489933013916
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.656 Vali Acc: 0.811 Test Loss: 0.656 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 60 cost time: 1.0530400276184082
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 61 cost time: 1.187018632888794
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 62 cost time: 1.2009797096252441
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 63 cost time: 1.074380874633789
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 0.9160358905792236
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.811 Test Loss: 0.651 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 65 cost time: 0.9815723896026611
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 66 cost time: 0.9829473495483398
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 67 cost time: 1.0375382900238037
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 68 cost time: 1.2114088535308838
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 69 cost time: 1.1153228282928467
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.1010682582855225
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 71 cost time: 1.2973313331604004
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 72 cost time: 1.2546672821044922
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 73 cost time: 1.0489342212677002
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 74 cost time: 1.118129014968872
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 75 cost time: 1.0424294471740723
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.819 Test Loss: 0.640 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 76 cost time: 1.1689128875732422
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 77 cost time: 1.332637071609497
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 78 cost time: 1.2664859294891357
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 79 cost time: 1.1006813049316406
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 80 cost time: 1.216686487197876
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 81 cost time: 1.2711091041564941
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 82 cost time: 1.1246089935302734
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 83 cost time: 1.277831792831421
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 84 cost time: 1.121387004852295
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 85 cost time: 1.076089859008789
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 86 cost time: 1.182004690170288
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 87 cost time: 1.1539416313171387
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 88 cost time: 1.1997392177581787
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 89 cost time: 1.047166109085083
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.830 Test Loss: 0.626 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 90 cost time: 1.0224463939666748
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.830 Test Loss: 0.625 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 91 cost time: 1.1019892692565918
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.830 Test Loss: 0.624 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 92 cost time: 1.0744719505310059
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.830 Test Loss: 0.624 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 93 cost time: 1.1553637981414795
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.830 Test Loss: 0.623 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 94 cost time: 1.1922783851623535
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.830 Test Loss: 0.623 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 95 cost time: 0.9859249591827393
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.830 Test Loss: 0.622 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 96 cost time: 1.1428194046020508
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.830 Test Loss: 0.622 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 97 cost time: 1.0495429039001465
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.830 Test Loss: 0.621 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 98 cost time: 1.0199124813079834
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.830 Test Loss: 0.620 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 99 cost time: 1.0684313774108887
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.830 Test Loss: 0.619 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 100 cost time: 1.1315438747406006
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.830 Test Loss: 0.618 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5459868907928467
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.872 Vali Acc: 0.141 Test Loss: 1.872 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 1.1899967193603516
Epoch: 2, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.849 Vali Acc: 0.159 Test Loss: 1.849 Test Acc: 0.159
Validation loss decreased (-0.140722 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.9949092864990234
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.815 Vali Acc: 0.185 Test Loss: 1.815 Test Acc: 0.185
Validation loss decreased (-0.159241 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 1.1400783061981201
Epoch: 4, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.757 Vali Acc: 0.244 Test Loss: 1.757 Test Acc: 0.244
Validation loss decreased (-0.185167 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 1.0899991989135742
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.687 Vali Acc: 0.304 Test Loss: 1.687 Test Acc: 0.304
Validation loss decreased (-0.244427 --> -0.303687).  Saving model ...
Epoch: 6 cost time: 1.108189582824707
Epoch: 6, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.610 Vali Acc: 0.385 Test Loss: 1.610 Test Acc: 0.385
Validation loss decreased (-0.303687 --> -0.385169).  Saving model ...
Epoch: 7 cost time: 1.1347644329071045
Epoch: 7, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.529 Vali Acc: 0.444 Test Loss: 1.529 Test Acc: 0.444
Validation loss decreased (-0.385169 --> -0.444429).  Saving model ...
Epoch: 8 cost time: 1.1397855281829834
Epoch: 8, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.449 Vali Acc: 0.515 Test Loss: 1.449 Test Acc: 0.515
Validation loss decreased (-0.444429 --> -0.514800).  Saving model ...
Epoch: 9 cost time: 1.04412841796875
Epoch: 9, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.370 Vali Acc: 0.552 Test Loss: 1.370 Test Acc: 0.552
Validation loss decreased (-0.514800 --> -0.551838).  Saving model ...
Epoch: 10 cost time: 1.2292921543121338
Epoch: 10, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.298 Vali Acc: 0.585 Test Loss: 1.298 Test Acc: 0.585
Validation loss decreased (-0.551838 --> -0.585172).  Saving model ...
Epoch: 11 cost time: 1.1825826168060303
Epoch: 11, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.232 Vali Acc: 0.585 Test Loss: 1.232 Test Acc: 0.585
Validation loss decreased (-0.585172 --> -0.585173).  Saving model ...
Epoch: 12 cost time: 1.0762605667114258
Epoch: 12, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.172 Vali Acc: 0.596 Test Loss: 1.172 Test Acc: 0.596
Validation loss decreased (-0.585173 --> -0.596285).  Saving model ...
Epoch: 13 cost time: 1.1026742458343506
Epoch: 13, Steps: 2 | Train Loss: 0.486 Vali Loss: 1.118 Vali Acc: 0.596 Test Loss: 1.118 Test Acc: 0.596
Validation loss decreased (-0.596285 --> -0.596285).  Saving model ...
Epoch: 14 cost time: 1.121917963027954
Epoch: 14, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.070 Vali Acc: 0.615 Test Loss: 1.070 Test Acc: 0.615
Validation loss decreased (-0.596285 --> -0.614804).  Saving model ...
Epoch: 15 cost time: 1.2671406269073486
Epoch: 15, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.025 Vali Acc: 0.641 Test Loss: 1.025 Test Acc: 0.641
Validation loss decreased (-0.614804 --> -0.640730).  Saving model ...
Epoch: 16 cost time: 1.1819708347320557
Epoch: 16, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.984 Vali Acc: 0.648 Test Loss: 0.984 Test Acc: 0.648
Validation loss decreased (-0.640730 --> -0.648138).  Saving model ...
Epoch: 17 cost time: 1.2232661247253418
Epoch: 17, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.949 Vali Acc: 0.659 Test Loss: 0.949 Test Acc: 0.659
Validation loss decreased (-0.648138 --> -0.659250).  Saving model ...
Epoch: 18 cost time: 1.0933406352996826
Epoch: 18, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.916 Vali Acc: 0.674 Test Loss: 0.916 Test Acc: 0.674
Validation loss decreased (-0.659250 --> -0.674065).  Saving model ...
Epoch: 19 cost time: 0.9951884746551514
Epoch: 19, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.883 Vali Acc: 0.681 Test Loss: 0.883 Test Acc: 0.681
Validation loss decreased (-0.674065 --> -0.681473).  Saving model ...
Epoch: 20 cost time: 1.0929996967315674
Epoch: 20, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.853 Vali Acc: 0.689 Test Loss: 0.853 Test Acc: 0.689
Validation loss decreased (-0.681473 --> -0.688880).  Saving model ...
Epoch: 21 cost time: 1.08982515335083
Epoch: 21, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.827 Vali Acc: 0.707 Test Loss: 0.827 Test Acc: 0.707
Validation loss decreased (-0.688880 --> -0.707399).  Saving model ...
Epoch: 22 cost time: 1.0751562118530273
Epoch: 22, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.803 Vali Acc: 0.726 Test Loss: 0.803 Test Acc: 0.726
Validation loss decreased (-0.707399 --> -0.725918).  Saving model ...
Epoch: 23 cost time: 0.9695801734924316
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.781 Vali Acc: 0.730 Test Loss: 0.781 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 24 cost time: 1.0591864585876465
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737029).  Saving model ...
Epoch: 25 cost time: 1.06258225440979
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.749 Vali Acc: 0.752 Test Loss: 0.749 Test Acc: 0.752
Validation loss decreased (-0.737029 --> -0.751844).  Saving model ...
Epoch: 26 cost time: 1.1604552268981934
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.759 Test Loss: 0.736 Test Acc: 0.759
Validation loss decreased (-0.751844 --> -0.759252).  Saving model ...
Epoch: 27 cost time: 1.1194710731506348
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 28 cost time: 1.130500316619873
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.715 Vali Acc: 0.763 Test Loss: 0.715 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 29 cost time: 1.2264833450317383
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 30 cost time: 1.1280598640441895
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 31 cost time: 1.109330177307129
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 32 cost time: 1.0249197483062744
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.685 Vali Acc: 0.770 Test Loss: 0.685 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 33 cost time: 1.1786766052246094
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 34 cost time: 1.172337532043457
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.774 Test Loss: 0.675 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 35 cost time: 1.0925304889678955
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.778 Test Loss: 0.670 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 36 cost time: 1.0882964134216309
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.778 Test Loss: 0.666 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 37 cost time: 1.0821847915649414
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.781 Test Loss: 0.662 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 38 cost time: 1.0134332180023193
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.781 Test Loss: 0.659 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 39 cost time: 1.0400171279907227
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.785 Test Loss: 0.657 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 40 cost time: 1.0114729404449463
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.785 Test Loss: 0.654 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 41 cost time: 1.2097971439361572
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.785 Test Loss: 0.652 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 42 cost time: 1.109971284866333
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.785 Test Loss: 0.650 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 43 cost time: 1.175457239151001
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788882).  Saving model ...
Epoch: 44 cost time: 1.086244821548462
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 45 cost time: 1.2172353267669678
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 46 cost time: 1.109142780303955
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 47 cost time: 1.1170780658721924
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 48 cost time: 1.1064260005950928
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 49 cost time: 1.0666539669036865
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 50 cost time: 1.2247874736785889
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 51 cost time: 1.0911478996276855
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 52 cost time: 1.2747299671173096
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 53 cost time: 1.2677745819091797
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.793 Test Loss: 0.641 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 54 cost time: 1.1877622604370117
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3583250045776367
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.793 Test Loss: 0.638 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 56 cost time: 1.072187900543213
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 57 cost time: 1.3010976314544678
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 58 cost time: 1.174769639968872
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 59 cost time: 1.1886708736419678
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.804 Test Loss: 0.632 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 60 cost time: 1.1541783809661865
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.804 Test Loss: 0.630 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 61 cost time: 1.1891183853149414
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1285250186920166
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.016472578048706
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 64 cost time: 1.162632703781128
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.807 Test Loss: 0.623 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 65 cost time: 1.0351839065551758
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.807 Test Loss: 0.622 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 66 cost time: 1.2190566062927246
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.807 Test Loss: 0.620 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 67 cost time: 1.1861088275909424
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.807 Test Loss: 0.618 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 68 cost time: 1.1954588890075684
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.807 Test Loss: 0.617 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 69 cost time: 1.1646995544433594
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.2995257377624512
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.815 Test Loss: 0.613 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 71 cost time: 1.2417404651641846
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 72 cost time: 1.1109840869903564
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 73 cost time: 1.1690354347229004
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 74 cost time: 0.9837853908538818
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.826 Test Loss: 0.608 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 75 cost time: 1.1697821617126465
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.826 Test Loss: 0.607 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 76 cost time: 1.2119271755218506
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 77 cost time: 1.1685724258422852
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 78 cost time: 1.0174610614776611
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 79 cost time: 1.0848987102508545
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 80 cost time: 1.0788705348968506
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 81 cost time: 1.1833081245422363
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.826 Test Loss: 0.600 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.2536094188690186
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 1.1080782413482666
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 84 cost time: 1.1123168468475342
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 85 cost time: 1.125131607055664
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.830 Test Loss: 0.599 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 86 cost time: 1.063183069229126
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.830 Test Loss: 0.598 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 87 cost time: 0.9711010456085205
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.830 Test Loss: 0.598 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 88 cost time: 1.074298620223999
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.830 Test Loss: 0.597 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 89 cost time: 1.088716983795166
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.830 Test Loss: 0.597 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 90 cost time: 1.1382663249969482
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.830 Test Loss: 0.596 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 91 cost time: 1.0686655044555664
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.830 Test Loss: 0.595 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 92 cost time: 0.9585208892822266
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.830 Test Loss: 0.595 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 93 cost time: 0.990382194519043
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833327).  Saving model ...
Epoch: 94 cost time: 0.9873638153076172
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 95 cost time: 0.9680051803588867
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 96 cost time: 1.0701978206634521
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 97 cost time: 1.0038330554962158
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 98 cost time: 1.1256914138793945
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 99 cost time: 1.1273589134216309
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 100 cost time: 0.9578187465667725
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4444589614868164
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.877 Vali Acc: 0.074 Test Loss: 1.877 Test Acc: 0.074
Validation loss decreased (inf --> -0.074055).  Saving model ...
Epoch: 2 cost time: 0.9843220710754395
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.862 Vali Acc: 0.074 Test Loss: 1.862 Test Acc: 0.074
Validation loss decreased (-0.074055 --> -0.074055).  Saving model ...
Epoch: 3 cost time: 1.041475772857666
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.837 Vali Acc: 0.081 Test Loss: 1.837 Test Acc: 0.081
Validation loss decreased (-0.074055 --> -0.081463).  Saving model ...
Epoch: 4 cost time: 0.9146058559417725
Epoch: 4, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.787 Vali Acc: 0.130 Test Loss: 1.787 Test Acc: 0.130
Validation loss decreased (-0.081463 --> -0.129612).  Saving model ...
Epoch: 5 cost time: 0.9629194736480713
Epoch: 5, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.727 Vali Acc: 0.200 Test Loss: 1.727 Test Acc: 0.200
Validation loss decreased (-0.129612 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 1.024127721786499
Epoch: 6, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.657 Vali Acc: 0.304 Test Loss: 1.657 Test Acc: 0.304
Validation loss decreased (-0.199983 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 1.1096806526184082
Epoch: 7, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.580 Vali Acc: 0.411 Test Loss: 1.580 Test Acc: 0.411
Validation loss decreased (-0.303687 --> -0.411095).  Saving model ...
Epoch: 8 cost time: 1.194875955581665
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.497 Vali Acc: 0.496 Test Loss: 1.497 Test Acc: 0.496
Validation loss decreased (-0.411095 --> -0.496281).  Saving model ...
Epoch: 9 cost time: 1.0099244117736816
Epoch: 9, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.411 Vali Acc: 0.563 Test Loss: 1.411 Test Acc: 0.563
Validation loss decreased (-0.496281 --> -0.562949).  Saving model ...
Epoch: 10 cost time: 1.0411725044250488
Epoch: 10, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.324 Vali Acc: 0.611 Test Loss: 1.324 Test Acc: 0.611
Validation loss decreased (-0.562949 --> -0.611098).  Saving model ...
Epoch: 11 cost time: 1.052501916885376
Epoch: 11, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.235 Vali Acc: 0.667 Test Loss: 1.235 Test Acc: 0.667
Validation loss decreased (-0.611098 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 1.0951085090637207
Epoch: 12, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.148 Vali Acc: 0.681 Test Loss: 1.148 Test Acc: 0.681
Validation loss decreased (-0.666654 --> -0.681470).  Saving model ...
Epoch: 13 cost time: 1.0312387943267822
Epoch: 13, Steps: 2 | Train Loss: 0.697 Vali Loss: 1.065 Vali Acc: 0.696 Test Loss: 1.065 Test Acc: 0.696
Validation loss decreased (-0.681470 --> -0.696286).  Saving model ...
Epoch: 14 cost time: 1.1541368961334229
Epoch: 14, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (-0.696286 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 1.056410789489746
Epoch: 15, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.909 Vali Acc: 0.726 Test Loss: 0.909 Test Acc: 0.726
Validation loss decreased (-0.722212 --> -0.725917).  Saving model ...
Epoch: 16 cost time: 1.2635416984558105
Epoch: 16, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.843 Vali Acc: 0.737 Test Loss: 0.843 Test Acc: 0.737
Validation loss decreased (-0.725917 --> -0.737029).  Saving model ...
Epoch: 17 cost time: 1.2095799446105957
Epoch: 17, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 18 cost time: 0.9987220764160156
Epoch: 18, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.744 Vali Acc: 0.748 Test Loss: 0.744 Test Acc: 0.748
Validation loss decreased (-0.737029 --> -0.748141).  Saving model ...
Epoch: 19 cost time: 1.1160016059875488
Epoch: 19, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.703 Vali Acc: 0.752 Test Loss: 0.703 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 20 cost time: 1.1139936447143555
Epoch: 20, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
Validation loss decreased (-0.751845 --> -0.762956).  Saving model ...
Epoch: 21 cost time: 1.1485812664031982
Epoch: 21, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.154771327972412
Epoch: 22, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.640 Vali Acc: 0.759 Test Loss: 0.640 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0391690731048584
Epoch: 23, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 0.9955728054046631
Epoch: 24, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 25 cost time: 1.055713176727295
Epoch: 25, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.781 Test Loss: 0.573 Test Acc: 0.781
Validation loss decreased (-0.770364 --> -0.781476).  Saving model ...
Epoch: 26 cost time: 1.044142246246338
Epoch: 26, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.781476 --> -0.788883).  Saving model ...
Epoch: 27 cost time: 1.132946252822876
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788884).  Saving model ...
Epoch: 28 cost time: 1.0486793518066406
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.788884 --> -0.796291).  Saving model ...
Epoch: 29 cost time: 1.060561180114746
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.487 Vali Acc: 0.804 Test Loss: 0.487 Test Acc: 0.804
Validation loss decreased (-0.796291 --> -0.803699).  Saving model ...
Epoch: 30 cost time: 1.0977952480316162
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
Validation loss decreased (-0.803699 --> -0.814810).  Saving model ...
Epoch: 31 cost time: 1.0274035930633545
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.470 Vali Acc: 0.830 Test Loss: 0.470 Test Acc: 0.830
Validation loss decreased (-0.814810 --> -0.829625).  Saving model ...
Epoch: 32 cost time: 1.3312702178955078
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 33 cost time: 1.1642215251922607
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 1.2034459114074707
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 35 cost time: 1.3185451030731201
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 36 cost time: 1.3131983280181885
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.833 Test Loss: 0.461 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 37 cost time: 1.0334465503692627
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840736).  Saving model ...
Epoch: 38 cost time: 1.1155447959899902
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.837 Test Loss: 0.461 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0978083610534668
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.837 Test Loss: 0.463 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0552892684936523
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.03926420211792
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0318901538848877
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0181350708007812
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.830 Test Loss: 0.475 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0441064834594727
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1827173233032227
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0659763813018799
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0989689826965332
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7747130393981934
Epoch: 1, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.862 Vali Acc: 0.152 Test Loss: 1.862 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.9375417232513428
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.853 Vali Acc: 0.167 Test Loss: 1.853 Test Acc: 0.167
Validation loss decreased (-0.151833 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 1.1134288311004639
Epoch: 3, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.820 Vali Acc: 0.185 Test Loss: 1.820 Test Acc: 0.185
Validation loss decreased (-0.166648 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 1.1147243976593018
Epoch: 4, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.742 Vali Acc: 0.252 Test Loss: 1.742 Test Acc: 0.252
Validation loss decreased (-0.185167 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 1.1096975803375244
Epoch: 5, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.644 Vali Acc: 0.370 Test Loss: 1.644 Test Acc: 0.370
Validation loss decreased (-0.251834 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 1.0051050186157227
Epoch: 6, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.528 Vali Acc: 0.493 Test Loss: 1.528 Test Acc: 0.493
Validation loss decreased (-0.370354 --> -0.492577).  Saving model ...
Epoch: 7 cost time: 0.8601720333099365
Epoch: 7, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.407 Vali Acc: 0.563 Test Loss: 1.407 Test Acc: 0.563
Validation loss decreased (-0.492577 --> -0.562949).  Saving model ...
Epoch: 8 cost time: 0.9925551414489746
Epoch: 8, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.281 Vali Acc: 0.644 Test Loss: 1.281 Test Acc: 0.644
Validation loss decreased (-0.562949 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.1871545314788818
Epoch: 9, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.159 Vali Acc: 0.719 Test Loss: 1.159 Test Acc: 0.719
Validation loss decreased (-0.644432 --> -0.718507).  Saving model ...
Epoch: 10 cost time: 1.0599448680877686
Epoch: 10, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.042 Vali Acc: 0.756 Test Loss: 1.042 Test Acc: 0.756
Validation loss decreased (-0.718507 --> -0.755545).  Saving model ...
Epoch: 11 cost time: 0.999809980392456
Epoch: 11, Steps: 2 | Train Loss: 1.160 Vali Loss: 0.935 Vali Acc: 0.785 Test Loss: 0.935 Test Acc: 0.785
Validation loss decreased (-0.755545 --> -0.785176).  Saving model ...
Epoch: 12 cost time: 0.9701995849609375
Epoch: 12, Steps: 2 | Train Loss: 1.154 Vali Loss: 0.835 Vali Acc: 0.815 Test Loss: 0.835 Test Acc: 0.815
Validation loss decreased (-0.785176 --> -0.814806).  Saving model ...
Epoch: 13 cost time: 1.049492359161377
Epoch: 13, Steps: 2 | Train Loss: 1.027 Vali Loss: 0.743 Vali Acc: 0.841 Test Loss: 0.743 Test Acc: 0.841
Validation loss decreased (-0.814806 --> -0.840733).  Saving model ...
Epoch: 14 cost time: 1.1795110702514648
Epoch: 14, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.660 Vali Acc: 0.856 Test Loss: 0.660 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 1.0427672863006592
Epoch: 15, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.583 Vali Acc: 0.863 Test Loss: 0.583 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 1.1318719387054443
Epoch: 16, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 1.2203843593597412
Epoch: 17, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.458 Vali Acc: 0.874 Test Loss: 0.458 Test Acc: 0.874
Validation loss decreased (-0.866662 --> -0.874069).  Saving model ...
Epoch: 18 cost time: 0.9975650310516357
Epoch: 18, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.410 Vali Acc: 0.885 Test Loss: 0.410 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885181).  Saving model ...
Epoch: 19 cost time: 1.154803991317749
Epoch: 19, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.885181 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.1032936573028564
Epoch: 20, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.331 Vali Acc: 0.907 Test Loss: 0.331 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 1.1625032424926758
Epoch: 21, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.310 Vali Acc: 0.896 Test Loss: 0.310 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.052778720855713
Epoch: 22, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 23 cost time: 1.1046192646026611
Epoch: 23, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
Validation loss decreased (-0.907405 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.9945759773254395
Epoch: 24, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.253 Vali Acc: 0.907 Test Loss: 0.253 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.118607759475708
Epoch: 25, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.957709789276123
Epoch: 26, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.915 Test Loss: 0.232 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.9749271869659424
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 28 cost time: 0.9858288764953613
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918516).  Saving model ...
Epoch: 29 cost time: 1.1309003829956055
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.9530317783355713
Epoch: 30, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 31 cost time: 1.0562193393707275
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 32 cost time: 1.0315942764282227
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.9522309303283691
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 1.0822410583496094
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.027745008468628
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0864543914794922
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.167076587677002
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0748655796051025
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0428926944732666
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0329177379608154
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9643709659576416
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0568819046020508
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1491031646728516
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.818716049194336
Epoch: 1, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.815 Vali Acc: 0.215 Test Loss: 1.815 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 1.0318095684051514
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.807 Vali Acc: 0.226 Test Loss: 1.807 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 1.0734002590179443
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.768 Vali Acc: 0.267 Test Loss: 1.768 Test Acc: 0.267
Validation loss decreased (-0.225908 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.9678125381469727
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.673 Vali Acc: 0.381 Test Loss: 1.673 Test Acc: 0.381
Validation loss decreased (-0.266649 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 0.9229865074157715
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.555 Vali Acc: 0.489 Test Loss: 1.555 Test Acc: 0.489
Validation loss decreased (-0.381465 --> -0.488873).  Saving model ...
Epoch: 6 cost time: 1.1073505878448486
Epoch: 6, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.421 Vali Acc: 0.585 Test Loss: 1.421 Test Acc: 0.585
Validation loss decreased (-0.488873 --> -0.585171).  Saving model ...
Epoch: 7 cost time: 1.1393227577209473
Epoch: 7, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.285 Vali Acc: 0.678 Test Loss: 1.285 Test Acc: 0.678
Validation loss decreased (-0.585171 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 1.222442626953125
Epoch: 8, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.153 Vali Acc: 0.733 Test Loss: 1.153 Test Acc: 0.733
Validation loss decreased (-0.677765 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 0.9948289394378662
Epoch: 9, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.029 Vali Acc: 0.770 Test Loss: 1.029 Test Acc: 0.770
Validation loss decreased (-0.733322 --> -0.770360).  Saving model ...
Epoch: 10 cost time: 1.2027251720428467
Epoch: 10, Steps: 2 | Train Loss: 1.380 Vali Loss: 0.913 Vali Acc: 0.804 Test Loss: 0.913 Test Acc: 0.804
Validation loss decreased (-0.770360 --> -0.803695).  Saving model ...
Epoch: 11 cost time: 1.1982903480529785
Epoch: 11, Steps: 2 | Train Loss: 1.352 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
Validation loss decreased (-0.803695 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 1.1210312843322754
Epoch: 12, Steps: 2 | Train Loss: 1.124 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
Validation loss decreased (-0.833325 --> -0.862956).  Saving model ...
Epoch: 13 cost time: 1.156385898590088
Epoch: 13, Steps: 2 | Train Loss: 1.070 Vali Loss: 0.637 Vali Acc: 0.870 Test Loss: 0.637 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 14 cost time: 1.1420855522155762
Epoch: 14, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.562 Vali Acc: 0.893 Test Loss: 0.562 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 15 cost time: 1.040292501449585
Epoch: 15, Steps: 2 | Train Loss: 0.935 Vali Loss: 0.501 Vali Acc: 0.893 Test Loss: 0.501 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 16 cost time: 1.046670913696289
Epoch: 16, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.449 Vali Acc: 0.896 Test Loss: 0.449 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 17 cost time: 1.112224817276001
Epoch: 17, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.404 Vali Acc: 0.896 Test Loss: 0.404 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 18 cost time: 1.0439262390136719
Epoch: 18, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.9776918888092041
Epoch: 19, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.328 Vali Acc: 0.915 Test Loss: 0.328 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 1.1130645275115967
Epoch: 20, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 1.0104789733886719
Epoch: 21, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9386453628540039
Epoch: 22, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0622191429138184
Epoch: 23, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0831959247589111
Epoch: 24, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.159247636795044
Epoch: 25, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0091452598571777
Epoch: 26, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 1.090803623199463
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 1.0211710929870605
Epoch: 28, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 29 cost time: 1.0260062217712402
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 1.047245740890503
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0282235145568848
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.9248909950256348
Epoch: 32, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0464026927947998
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8825497627258301
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9955956935882568
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0437242984771729
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9347660541534424
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9866089820861816
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9992787837982178
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 1.1507763862609863
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0779731273651123
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9194600582122803
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9236478805541992
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0491740703582764
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1901872158050537
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.272989273071289
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.126462697982788
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0934791564941406
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1408896446228027
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.479799509048462
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.025146484375
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.023277997970581
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0598039627075195
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.039147138595581
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.9848337173461914
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1159658432006836
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.1087825298309326
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.278855562210083
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.0497140884399414
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 0.9590227603912354
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9596631526947021
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0880687236785889
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.135181188583374
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9661757946014404
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9358658790588379
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.1500794887542725
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.0161628723144531
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.1584186553955078
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.1449389457702637
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9880194664001465
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2228424549102783
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1184978485107422
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9673900604248047
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0676960945129395
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1206693649291992
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.1358439922332764
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1406075954437256
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.1128079891204834
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.213909387588501
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9600329399108887
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.050264835357666
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.158733606338501
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.1147270202636719
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0619049072265625
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.0598328113555908
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9970266819000244
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9856264591217041
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0359530448913574
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0863282680511475
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0668540000915527
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.1614320278167725
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.1409533023834229
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.1731469631195068
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.0977544784545898
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0781655311584473
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 0.9164137840270996
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1445679664611816
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.935330867767334
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.005091905593872
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9956321716308594
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.0814671516418457
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0829193592071533
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.043867826461792
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0132403373718262
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0100958347320557
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.0272495746612549
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.876366138458252
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 0.9892106056213379
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.066298007965088
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1394984722137451
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9746739864349365
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.0686514377593994
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 0.9855468273162842
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 0.9737703800201416
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0857820510864258
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2160029411315918
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.2344343662261963
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.0711815357208252
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.942333459854126
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 0.91587233543396
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1717658042907715
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1575136184692383
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0557756423950195
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1848292350769043
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.0575637817382812
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.0957114696502686
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.1193227767944336
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.105177879333496
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.0245327949523926
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 3785478
model size : 24.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.609943151473999
Epoch: 1, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.786 Vali Acc: 0.215 Test Loss: 1.786 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.9344003200531006
Epoch: 2, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.734 Vali Acc: 0.278 Test Loss: 1.734 Test Acc: 0.278
Validation loss decreased (-0.214797 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 1.0409371852874756
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.662 Vali Acc: 0.363 Test Loss: 1.662 Test Acc: 0.363
Validation loss decreased (-0.277760 --> -0.362946).  Saving model ...
Epoch: 4 cost time: 0.9975385665893555
Epoch: 4, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
Validation loss decreased (-0.362946 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 0.9630527496337891
Epoch: 5, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.405 Vali Acc: 0.641 Test Loss: 1.405 Test Acc: 0.641
Validation loss decreased (-0.499985 --> -0.640727).  Saving model ...
Epoch: 6 cost time: 1.0907337665557861
Epoch: 6, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.260 Vali Acc: 0.737 Test Loss: 1.260 Test Acc: 0.737
Validation loss decreased (-0.640727 --> -0.737024).  Saving model ...
Epoch: 7 cost time: 1.0927488803863525
Epoch: 7, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.120 Vali Acc: 0.774 Test Loss: 1.120 Test Acc: 0.774
Validation loss decreased (-0.737024 --> -0.774063).  Saving model ...
Epoch: 8 cost time: 1.1515958309173584
Epoch: 8, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.987 Vali Acc: 0.804 Test Loss: 0.987 Test Acc: 0.804
Validation loss decreased (-0.774063 --> -0.803694).  Saving model ...
Epoch: 9 cost time: 1.129042625427246
Epoch: 9, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.225541353225708
Epoch: 10, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.779 Vali Acc: 0.815 Test Loss: 0.779 Test Acc: 0.815
Validation loss decreased (-0.803694 --> -0.814807).  Saving model ...
Epoch: 11 cost time: 1.096693515777588
Epoch: 11, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.705 Vali Acc: 0.815 Test Loss: 0.705 Test Acc: 0.815
Validation loss decreased (-0.814807 --> -0.814808).  Saving model ...
Epoch: 12 cost time: 1.116856336593628
Epoch: 12, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2241690158843994
Epoch: 13, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.618 Vali Acc: 0.811 Test Loss: 0.618 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.206394910812378
Epoch: 14, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.595 Vali Acc: 0.807 Test Loss: 0.595 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1328399181365967
Epoch: 15, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.582 Vali Acc: 0.811 Test Loss: 0.582 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0344276428222656
Epoch: 16, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.815 Test Loss: 0.573 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814809).  Saving model ...
Epoch: 17 cost time: 1.0096755027770996
Epoch: 17, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 18 cost time: 1.246685266494751
Epoch: 18, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3507108688354492
Epoch: 19, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 20 cost time: 1.0460231304168701
Epoch: 20, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 21 cost time: 1.233079195022583
Epoch: 21, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825920).  Saving model ...
Epoch: 22 cost time: 1.116990089416504
Epoch: 22, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.830 Test Loss: 0.556 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 23 cost time: 1.0478503704071045
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 1.046365737915039
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840735).  Saving model ...
Epoch: 25 cost time: 1.0762407779693604
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9855751991271973
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 27 cost time: 1.0643234252929688
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1071758270263672
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9791772365570068
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0315053462982178
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 1.1035640239715576
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9035012722015381
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 33 cost time: 1.0011951923370361
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 1.1418614387512207
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 35 cost time: 1.0791888236999512
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 36 cost time: 1.1034772396087646
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 0.9301071166992188
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.852 Test Loss: 0.555 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851846).  Saving model ...
Epoch: 38 cost time: 1.082179069519043
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 1.0808990001678467
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 40 cost time: 1.184325933456421
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 41 cost time: 1.0689945220947266
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 42 cost time: 0.9200332164764404
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 0.8558676242828369
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 1.106851577758789
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 45 cost time: 0.9739875793457031
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 46 cost time: 1.0980172157287598
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 47 cost time: 1.010594367980957
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 48 cost time: 1.0161142349243164
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 49 cost time: 1.0751919746398926
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 0.9894633293151855
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 51 cost time: 1.0887489318847656
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 52 cost time: 1.0518324375152588
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 53 cost time: 1.1046342849731445
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 54 cost time: 0.9853363037109375
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 55 cost time: 1.0399234294891357
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 56 cost time: 1.1049399375915527
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 57 cost time: 0.9244401454925537
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 58 cost time: 1.1293201446533203
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 59 cost time: 1.0325515270233154
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 60 cost time: 1.033064842224121
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 61 cost time: 1.1740880012512207
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 62 cost time: 1.0779733657836914
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 63 cost time: 0.9588615894317627
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 64 cost time: 1.0149986743927002
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 65 cost time: 1.1468391418457031
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 66 cost time: 1.1489770412445068
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 67 cost time: 1.0321049690246582
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 68 cost time: 1.1602787971496582
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 69 cost time: 1.115727186203003
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 70 cost time: 1.1328403949737549
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 71 cost time: 1.0840950012207031
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 72 cost time: 1.0754420757293701
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 73 cost time: 1.0988059043884277
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 74 cost time: 1.1211307048797607
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 75 cost time: 1.2107975482940674
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 76 cost time: 1.1034901142120361
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 77 cost time: 1.0048747062683105
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 78 cost time: 0.9918973445892334
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 79 cost time: 1.020141363143921
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 80 cost time: 1.0671772956848145
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.863 Test Loss: 0.524 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 81 cost time: 1.0055689811706543
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.863 Test Loss: 0.524 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 82 cost time: 1.0381674766540527
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 83 cost time: 1.1509284973144531
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 84 cost time: 1.1686897277832031
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 85 cost time: 1.0572586059570312
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 86 cost time: 1.0596096515655518
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 87 cost time: 1.0594761371612549
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 88 cost time: 1.3369410037994385
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 89 cost time: 1.070312261581421
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 90 cost time: 1.0563371181488037
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 91 cost time: 1.0631985664367676
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 92 cost time: 1.0292069911956787
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 93 cost time: 1.0291855335235596
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 94 cost time: 0.9561307430267334
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 95 cost time: 1.024796485900879
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 96 cost time: 1.0067875385284424
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 97 cost time: 1.0657269954681396
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 98 cost time: 1.1179618835449219
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 99 cost time: 1.0039331912994385
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 100 cost time: 1.0602874755859375
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.799187660217285
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.765 Vali Acc: 0.244 Test Loss: 1.765 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.870368480682373
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.726 Vali Acc: 0.267 Test Loss: 1.726 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.8793210983276367
Epoch: 3, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.673 Vali Acc: 0.307 Test Loss: 1.673 Test Acc: 0.307
Validation loss decreased (-0.266649 --> -0.307391).  Saving model ...
Epoch: 4 cost time: 0.9733037948608398
Epoch: 4, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.583 Vali Acc: 0.393 Test Loss: 1.583 Test Acc: 0.393
Validation loss decreased (-0.307391 --> -0.392577).  Saving model ...
Epoch: 5 cost time: 1.0492057800292969
Epoch: 5, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.476 Vali Acc: 0.485 Test Loss: 1.476 Test Acc: 0.485
Validation loss decreased (-0.392577 --> -0.485170).  Saving model ...
Epoch: 6 cost time: 0.902639627456665
Epoch: 6, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.363 Vali Acc: 0.600 Test Loss: 1.363 Test Acc: 0.600
Validation loss decreased (-0.485170 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 0.9783134460449219
Epoch: 7, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.252 Vali Acc: 0.656 Test Loss: 1.252 Test Acc: 0.656
Validation loss decreased (-0.599986 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 0.9353952407836914
Epoch: 8, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.143 Vali Acc: 0.700 Test Loss: 1.143 Test Acc: 0.700
Validation loss decreased (-0.655543 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 1.111914873123169
Epoch: 9, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.045 Vali Acc: 0.704 Test Loss: 1.045 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703693).  Saving model ...
Epoch: 10 cost time: 0.9592089653015137
Epoch: 10, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.961 Vali Acc: 0.730 Test Loss: 0.961 Test Acc: 0.730
Validation loss decreased (-0.703693 --> -0.729620).  Saving model ...
Epoch: 11 cost time: 1.0440387725830078
Epoch: 11, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.889 Vali Acc: 0.726 Test Loss: 0.889 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8963558673858643
Epoch: 12, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.830 Vali Acc: 0.726 Test Loss: 0.830 Test Acc: 0.726
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9892020225524902
Epoch: 13, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.788 Vali Acc: 0.726 Test Loss: 0.788 Test Acc: 0.726
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0273993015289307
Epoch: 14, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.759 Vali Acc: 0.733 Test Loss: 0.759 Test Acc: 0.733
Validation loss decreased (-0.729620 --> -0.733326).  Saving model ...
Epoch: 15 cost time: 1.0061254501342773
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
Validation loss decreased (-0.733326 --> -0.740733).  Saving model ...
Epoch: 16 cost time: 0.9804842472076416
Epoch: 16, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.715 Vali Acc: 0.752 Test Loss: 0.715 Test Acc: 0.752
Validation loss decreased (-0.740733 --> -0.751845).  Saving model ...
Epoch: 17 cost time: 1.1126856803894043
Epoch: 17, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 1.0498018264770508
Epoch: 18, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.678 Vali Acc: 0.759 Test Loss: 0.678 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759252).  Saving model ...
Epoch: 19 cost time: 1.1273863315582275
Epoch: 19, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 20 cost time: 1.0017364025115967
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 21 cost time: 1.0164775848388672
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.774 Test Loss: 0.641 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 22 cost time: 0.9854896068572998
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.632 Vali Acc: 0.781 Test Loss: 0.632 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781475).  Saving model ...
Epoch: 23 cost time: 0.9946489334106445
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.625 Vali Acc: 0.785 Test Loss: 0.625 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 24 cost time: 1.046689510345459
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.785 Test Loss: 0.618 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 25 cost time: 1.0713026523590088
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.793 Test Loss: 0.613 Test Acc: 0.793
Validation loss decreased (-0.785179 --> -0.792586).  Saving model ...
Epoch: 26 cost time: 1.0276293754577637
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 27 cost time: 1.0152080059051514
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 28 cost time: 1.0373289585113525
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 0.9639956951141357
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 30 cost time: 0.964118242263794
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.804 Test Loss: 0.596 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 31 cost time: 1.0609729290008545
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 32 cost time: 0.9264321327209473
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 33 cost time: 1.036588191986084
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.811 Test Loss: 0.589 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811105).  Saving model ...
Epoch: 34 cost time: 0.9765551090240479
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 35 cost time: 1.0220906734466553
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 36 cost time: 0.9515349864959717
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.815 Test Loss: 0.584 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 37 cost time: 1.0969688892364502
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.815 Test Loss: 0.583 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 38 cost time: 0.9962067604064941
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 39 cost time: 0.9688405990600586
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 40 cost time: 1.0471775531768799
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 41 cost time: 0.9372448921203613
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 42 cost time: 1.0029678344726562
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 43 cost time: 1.1007788181304932
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 44 cost time: 0.9554896354675293
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 45 cost time: 1.0059804916381836
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 46 cost time: 1.0378587245941162
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 47 cost time: 1.084329605102539
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 48 cost time: 1.0638747215270996
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 49 cost time: 1.0322391986846924
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.826 Test Loss: 0.564 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 50 cost time: 0.9620182514190674
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.830 Test Loss: 0.562 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 51 cost time: 0.8604230880737305
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.830 Test Loss: 0.561 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 52 cost time: 1.1455154418945312
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.830 Test Loss: 0.560 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 53 cost time: 0.9678711891174316
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.830 Test Loss: 0.559 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 54 cost time: 1.0133001804351807
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.830 Test Loss: 0.557 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 55 cost time: 0.9448032379150391
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.830 Test Loss: 0.556 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 56 cost time: 1.071079969406128
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 57 cost time: 0.9564661979675293
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 58 cost time: 1.0157670974731445
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 59 cost time: 1.0520827770233154
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 60 cost time: 0.9037585258483887
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 61 cost time: 0.9839754104614258
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 62 cost time: 1.056699514389038
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 63 cost time: 0.9821891784667969
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.0863368511199951
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 65 cost time: 0.9282705783843994
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 0.9880685806274414
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.848 Test Loss: 0.541 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 67 cost time: 0.9266746044158936
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 68 cost time: 0.9013819694519043
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.852 Test Loss: 0.539 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 69 cost time: 0.9744110107421875
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 70 cost time: 0.9976365566253662
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 71 cost time: 0.9304170608520508
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 72 cost time: 1.0673754215240479
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 73 cost time: 0.9334704875946045
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 74 cost time: 1.3053534030914307
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 75 cost time: 1.0349559783935547
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 76 cost time: 0.9916861057281494
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 77 cost time: 1.0767149925231934
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 78 cost time: 1.1381893157958984
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 79 cost time: 1.1278328895568848
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 80 cost time: 1.167081356048584
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 81 cost time: 1.2033016681671143
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 82 cost time: 1.0288662910461426
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 83 cost time: 1.1273961067199707
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 84 cost time: 1.2449357509613037
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.859 Test Loss: 0.521 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 85 cost time: 1.1863946914672852
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 86 cost time: 1.0969228744506836
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.859 Test Loss: 0.518 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 87 cost time: 1.0959906578063965
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 88 cost time: 1.1153407096862793
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.859 Test Loss: 0.516 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 89 cost time: 1.2053265571594238
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 90 cost time: 1.132162094116211
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.859 Test Loss: 0.514 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 91 cost time: 1.1091904640197754
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 92 cost time: 1.1087069511413574
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 93 cost time: 1.2710258960723877
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 1.0664293766021729
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.859 Test Loss: 0.510 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.169520378112793
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.039384126663208
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 97 cost time: 1.131554365158081
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 98 cost time: 1.08803129196167
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 99 cost time: 1.033768892288208
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 100 cost time: 1.1581487655639648
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6774611473083496
Epoch: 1, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.765 Vali Acc: 0.233 Test Loss: 1.765 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.9494526386260986
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.736 Vali Acc: 0.263 Test Loss: 1.736 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 1.154395580291748
Epoch: 3, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.697 Vali Acc: 0.307 Test Loss: 1.697 Test Acc: 0.307
Validation loss decreased (-0.262946 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 1.0520732402801514
Epoch: 4, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.631 Vali Acc: 0.389 Test Loss: 1.631 Test Acc: 0.389
Validation loss decreased (-0.307390 --> -0.388873).  Saving model ...
Epoch: 5 cost time: 0.9897675514221191
Epoch: 5, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.552 Vali Acc: 0.437 Test Loss: 1.552 Test Acc: 0.437
Validation loss decreased (-0.388873 --> -0.437022).  Saving model ...
Epoch: 6 cost time: 1.1776363849639893
Epoch: 6, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.465 Vali Acc: 0.507 Test Loss: 1.465 Test Acc: 0.507
Validation loss decreased (-0.437022 --> -0.507393).  Saving model ...
Epoch: 7 cost time: 0.9915311336517334
Epoch: 7, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
Validation loss decreased (-0.507393 --> -0.570357).  Saving model ...
Epoch: 8 cost time: 1.145186424255371
Epoch: 8, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.287 Vali Acc: 0.622 Test Loss: 1.287 Test Acc: 0.622
Validation loss decreased (-0.570357 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 0.9835312366485596
Epoch: 9, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.202 Vali Acc: 0.659 Test Loss: 1.202 Test Acc: 0.659
Validation loss decreased (-0.622209 --> -0.659247).  Saving model ...
Epoch: 10 cost time: 0.9523074626922607
Epoch: 10, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.123 Vali Acc: 0.704 Test Loss: 1.123 Test Acc: 0.704
Validation loss decreased (-0.659247 --> -0.703692).  Saving model ...
Epoch: 11 cost time: 1.0288045406341553
Epoch: 11, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.703692 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 0.9211158752441406
Epoch: 12, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.984 Vali Acc: 0.737 Test Loss: 0.984 Test Acc: 0.737
Validation loss decreased (-0.711101 --> -0.737027).  Saving model ...
Epoch: 13 cost time: 0.9802637100219727
Epoch: 13, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.932 Vali Acc: 0.752 Test Loss: 0.932 Test Acc: 0.752
Validation loss decreased (-0.737027 --> -0.751843).  Saving model ...
Epoch: 14 cost time: 0.9889266490936279
Epoch: 14, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.894 Vali Acc: 0.756 Test Loss: 0.894 Test Acc: 0.756
Validation loss decreased (-0.751843 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.018202543258667
Epoch: 15, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.868 Vali Acc: 0.756 Test Loss: 0.868 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.000373363494873
Epoch: 16, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.843 Vali Acc: 0.759 Test Loss: 0.843 Test Acc: 0.759
Validation loss decreased (-0.755547 --> -0.759251).  Saving model ...
Epoch: 17 cost time: 0.9834179878234863
Epoch: 17, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.819 Vali Acc: 0.759 Test Loss: 0.819 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759251).  Saving model ...
Epoch: 18 cost time: 0.8907527923583984
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.799 Vali Acc: 0.763 Test Loss: 0.799 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762955).  Saving model ...
Epoch: 19 cost time: 1.0564961433410645
Epoch: 19, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 1.0978620052337646
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 21 cost time: 1.0099101066589355
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 1.022078037261963
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.746 Vali Acc: 0.770 Test Loss: 0.746 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 23 cost time: 1.0304844379425049
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.735 Vali Acc: 0.781 Test Loss: 0.735 Test Acc: 0.781
Validation loss decreased (-0.770363 --> -0.781474).  Saving model ...
Epoch: 24 cost time: 0.9018373489379883
Epoch: 24, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
Validation loss decreased (-0.781474 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 1.1437749862670898
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.716 Vali Acc: 0.793 Test Loss: 0.716 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792585).  Saving model ...
Epoch: 26 cost time: 0.967522382736206
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
Validation loss decreased (-0.792585 --> -0.796289).  Saving model ...
Epoch: 27 cost time: 1.0569303035736084
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 28 cost time: 0.9599010944366455
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 29 cost time: 0.9745750427246094
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 1.0504710674285889
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.804 Test Loss: 0.684 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 31 cost time: 1.0669329166412354
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 32 cost time: 0.8977580070495605
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.811 Test Loss: 0.675 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811104).  Saving model ...
Epoch: 33 cost time: 1.131037712097168
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.811 Test Loss: 0.671 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 34 cost time: 1.0604383945465088
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.815 Test Loss: 0.668 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 35 cost time: 1.127699851989746
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.815 Test Loss: 0.665 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 36 cost time: 1.1305515766143799
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.815 Test Loss: 0.662 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 37 cost time: 0.8954813480377197
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.815 Test Loss: 0.660 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 38 cost time: 0.91048264503479
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.815 Test Loss: 0.657 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 39 cost time: 1.01057767868042
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 40 cost time: 1.1290438175201416
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 41 cost time: 0.9967303276062012
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 1.063443899154663
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 43 cost time: 0.9758732318878174
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 44 cost time: 0.9475007057189941
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 45 cost time: 0.9598903656005859
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 46 cost time: 0.9784679412841797
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 47 cost time: 0.9663305282592773
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 48 cost time: 0.9836108684539795
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.826 Test Loss: 0.640 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 49 cost time: 1.001394271850586
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 50 cost time: 1.0080082416534424
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.826 Test Loss: 0.637 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 51 cost time: 1.0212643146514893
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.826 Test Loss: 0.635 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 52 cost time: 0.9372842311859131
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.826 Test Loss: 0.634 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 53 cost time: 1.1561753749847412
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 54 cost time: 1.085573673248291
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 55 cost time: 1.2371666431427002
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.826 Test Loss: 0.631 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 56 cost time: 1.0501906871795654
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.826 Test Loss: 0.630 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 57 cost time: 1.1356701850891113
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.826 Test Loss: 0.628 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 58 cost time: 1.1197552680969238
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 59 cost time: 1.0966706275939941
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 60 cost time: 1.1961336135864258
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.830 Test Loss: 0.625 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 61 cost time: 1.2585594654083252
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.830 Test Loss: 0.623 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 62 cost time: 1.1244182586669922
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.830 Test Loss: 0.622 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 63 cost time: 1.2020313739776611
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.830 Test Loss: 0.621 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 64 cost time: 1.275629997253418
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.830 Test Loss: 0.619 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 65 cost time: 1.123077630996704
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.830 Test Loss: 0.618 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 66 cost time: 1.347240924835205
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.830 Test Loss: 0.616 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 67 cost time: 1.131394624710083
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.830 Test Loss: 0.615 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 68 cost time: 1.1880638599395752
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.830 Test Loss: 0.614 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 69 cost time: 1.181699514389038
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.830 Test Loss: 0.613 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829624).  Saving model ...
Epoch: 70 cost time: 1.389864206314087
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.830 Test Loss: 0.611 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 71 cost time: 1.1361470222473145
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.830 Test Loss: 0.610 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 72 cost time: 1.1689317226409912
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.830 Test Loss: 0.608 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 73 cost time: 1.0229198932647705
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.830 Test Loss: 0.607 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 74 cost time: 1.1028642654418945
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.830 Test Loss: 0.606 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 75 cost time: 1.254246711730957
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.830 Test Loss: 0.605 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 76 cost time: 1.1295430660247803
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833327).  Saving model ...
Epoch: 77 cost time: 1.099320888519287
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 78 cost time: 1.1421585083007812
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 79 cost time: 1.1807749271392822
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 80 cost time: 0.9762952327728271
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840735).  Saving model ...
Epoch: 81 cost time: 1.0792653560638428
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 82 cost time: 1.0956835746765137
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 83 cost time: 1.1377594470977783
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 84 cost time: 0.9728095531463623
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.848 Test Loss: 0.593 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848142).  Saving model ...
Epoch: 85 cost time: 1.161303997039795
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.852 Test Loss: 0.592 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 86 cost time: 1.09092378616333
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.852 Test Loss: 0.591 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 87 cost time: 1.1692416667938232
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.852 Test Loss: 0.589 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 88 cost time: 1.1442723274230957
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.852 Test Loss: 0.589 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 89 cost time: 1.3519809246063232
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.852 Test Loss: 0.588 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 90 cost time: 1.1818208694458008
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 91 cost time: 1.2805533409118652
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 92 cost time: 1.2511920928955078
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 93 cost time: 1.2137320041656494
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 94 cost time: 1.317491054534912
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 95 cost time: 1.1833062171936035
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 96 cost time: 1.2260794639587402
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 97 cost time: 1.1853783130645752
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 98 cost time: 1.2714340686798096
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 99 cost time: 1.2424089908599854
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 100 cost time: 1.1567246913909912
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8555555555555555
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4689650535583496
Epoch: 1, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.761 Vali Acc: 0.204 Test Loss: 1.761 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.9472486972808838
Epoch: 2, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.738 Vali Acc: 0.222 Test Loss: 1.738 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 1.1596758365631104
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.710 Vali Acc: 0.281 Test Loss: 1.710 Test Acc: 0.281
Validation loss decreased (-0.222205 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 1.1123485565185547
Epoch: 4, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.662 Vali Acc: 0.381 Test Loss: 1.662 Test Acc: 0.381
Validation loss decreased (-0.281464 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 1.1037766933441162
Epoch: 5, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.604 Vali Acc: 0.467 Test Loss: 1.604 Test Acc: 0.467
Validation loss decreased (-0.381465 --> -0.466651).  Saving model ...
Epoch: 6 cost time: 0.9097592830657959
Epoch: 6, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.540 Vali Acc: 0.544 Test Loss: 1.540 Test Acc: 0.544
Validation loss decreased (-0.466651 --> -0.544429).  Saving model ...
Epoch: 7 cost time: 0.9489638805389404
Epoch: 7, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.473 Vali Acc: 0.585 Test Loss: 1.473 Test Acc: 0.585
Validation loss decreased (-0.544429 --> -0.585170).  Saving model ...
Epoch: 8 cost time: 1.0463576316833496
Epoch: 8, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.404 Vali Acc: 0.593 Test Loss: 1.404 Test Acc: 0.593
Validation loss decreased (-0.585170 --> -0.592579).  Saving model ...
Epoch: 9 cost time: 1.0869429111480713
Epoch: 9, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.337 Vali Acc: 0.589 Test Loss: 1.337 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0296823978424072
Epoch: 10, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.272 Vali Acc: 0.589 Test Loss: 1.272 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0014519691467285
Epoch: 11, Steps: 2 | Train Loss: 0.770 Vali Loss: 1.208 Vali Acc: 0.604 Test Loss: 1.208 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603692).  Saving model ...
Epoch: 12 cost time: 1.2828869819641113
Epoch: 12, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.149 Vali Acc: 0.622 Test Loss: 1.149 Test Acc: 0.622
Validation loss decreased (-0.603692 --> -0.622211).  Saving model ...
Epoch: 13 cost time: 1.002537488937378
Epoch: 13, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.096 Vali Acc: 0.641 Test Loss: 1.096 Test Acc: 0.641
Validation loss decreased (-0.622211 --> -0.640730).  Saving model ...
Epoch: 14 cost time: 1.083284854888916
Epoch: 14, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.052 Vali Acc: 0.652 Test Loss: 1.052 Test Acc: 0.652
Validation loss decreased (-0.640730 --> -0.651841).  Saving model ...
Epoch: 15 cost time: 1.2271225452423096
Epoch: 15, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.013 Vali Acc: 0.663 Test Loss: 1.013 Test Acc: 0.663
Validation loss decreased (-0.651841 --> -0.662953).  Saving model ...
Epoch: 16 cost time: 1.0105125904083252
Epoch: 16, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.979 Vali Acc: 0.670 Test Loss: 0.979 Test Acc: 0.670
Validation loss decreased (-0.662953 --> -0.670361).  Saving model ...
Epoch: 17 cost time: 1.0394811630249023
Epoch: 17, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.944 Vali Acc: 0.685 Test Loss: 0.944 Test Acc: 0.685
Validation loss decreased (-0.670361 --> -0.685176).  Saving model ...
Epoch: 18 cost time: 1.1310245990753174
Epoch: 18, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.912 Vali Acc: 0.707 Test Loss: 0.912 Test Acc: 0.707
Validation loss decreased (-0.685176 --> -0.707398).  Saving model ...
Epoch: 19 cost time: 1.0919344425201416
Epoch: 19, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 1.250753402709961
Epoch: 20, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 21 cost time: 1.108137607574463
Epoch: 21, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.833 Vali Acc: 0.726 Test Loss: 0.833 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 22 cost time: 1.0775561332702637
Epoch: 22, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.808 Vali Acc: 0.726 Test Loss: 0.808 Test Acc: 0.726
Validation loss decreased (-0.725918 --> -0.725918).  Saving model ...
Epoch: 23 cost time: 1.0836918354034424
Epoch: 23, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
Validation loss decreased (-0.725918 --> -0.733325).  Saving model ...
Epoch: 24 cost time: 1.0705223083496094
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 25 cost time: 1.0848355293273926
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.1275649070739746
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.723 Vali Acc: 0.756 Test Loss: 0.723 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 1.1007144451141357
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.708 Vali Acc: 0.759 Test Loss: 0.708 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 28 cost time: 0.9587035179138184
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.695 Vali Acc: 0.759 Test Loss: 0.695 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 29 cost time: 1.0071473121643066
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 30 cost time: 1.0725171566009521
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.767 Test Loss: 0.677 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 31 cost time: 1.1818389892578125
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.767 Test Loss: 0.670 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 32 cost time: 1.0887563228607178
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.767 Test Loss: 0.665 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 33 cost time: 0.9503977298736572
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.774 Test Loss: 0.661 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774067).  Saving model ...
Epoch: 34 cost time: 1.079158067703247
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.778 Test Loss: 0.657 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 35 cost time: 0.9572725296020508
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 36 cost time: 1.0226094722747803
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 37 cost time: 1.0008785724639893
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.778 Test Loss: 0.647 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 38 cost time: 0.9957606792449951
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.778 Test Loss: 0.643 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 39 cost time: 1.1296744346618652
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 40 cost time: 1.0147252082824707
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.785 Test Loss: 0.635 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 41 cost time: 0.9986929893493652
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 42 cost time: 0.9961090087890625
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.793 Test Loss: 0.628 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 43 cost time: 1.022871971130371
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.793 Test Loss: 0.626 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 44 cost time: 1.2235755920410156
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.793 Test Loss: 0.623 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 45 cost time: 1.0604898929595947
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.793 Test Loss: 0.622 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 46 cost time: 1.1187779903411865
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 47 cost time: 1.047417402267456
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 48 cost time: 1.0753777027130127
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 49 cost time: 0.913949728012085
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 50 cost time: 1.0081236362457275
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 51 cost time: 0.9869825839996338
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 52 cost time: 1.1343936920166016
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 53 cost time: 1.1012279987335205
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 54 cost time: 1.1795437335968018
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803698).  Saving model ...
Epoch: 55 cost time: 1.0151493549346924
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 56 cost time: 1.0134069919586182
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 57 cost time: 1.1597836017608643
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 58 cost time: 1.222301721572876
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 59 cost time: 1.2025392055511475
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 60 cost time: 1.109525203704834
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.804 Test Loss: 0.606 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 61 cost time: 0.9902424812316895
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.807 Test Loss: 0.604 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 62 cost time: 1.3705909252166748
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.807 Test Loss: 0.603 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 63 cost time: 1.0539147853851318
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 1.1307384967803955
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.811 Test Loss: 0.600 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 65 cost time: 1.0157909393310547
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.811 Test Loss: 0.598 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 66 cost time: 0.9696156978607178
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.811 Test Loss: 0.596 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 67 cost time: 1.0012016296386719
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.811 Test Loss: 0.594 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 68 cost time: 1.1961238384246826
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 69 cost time: 1.0160930156707764
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.811 Test Loss: 0.591 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.090514898300171
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.811 Test Loss: 0.589 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 71 cost time: 1.0175163745880127
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.811 Test Loss: 0.587 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 72 cost time: 0.9569058418273926
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.811105 --> -0.818513).  Saving model ...
Epoch: 73 cost time: 1.1257600784301758
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 74 cost time: 0.9341998100280762
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 75 cost time: 1.1158955097198486
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 76 cost time: 1.11564302444458
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 77 cost time: 1.0938594341278076
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 78 cost time: 1.0735797882080078
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 79 cost time: 1.1648218631744385
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 80 cost time: 1.1221888065338135
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 81 cost time: 1.1746997833251953
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.0395116806030273
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 1.0329620838165283
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.826 Test Loss: 0.578 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 84 cost time: 1.0987977981567383
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 85 cost time: 1.0742511749267578
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 86 cost time: 1.048701286315918
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 87 cost time: 1.2172460556030273
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.1259312629699707
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833328).  Saving model ...
Epoch: 89 cost time: 0.9226200580596924
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 90 cost time: 0.9365963935852051
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 91 cost time: 1.1370878219604492
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 92 cost time: 1.1649835109710693
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 93 cost time: 1.1483495235443115
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 94 cost time: 1.2658448219299316
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 95 cost time: 1.404106616973877
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 96 cost time: 1.1605932712554932
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 97 cost time: 1.0913314819335938
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 98 cost time: 1.0236458778381348
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.077970027923584
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.837 Test Loss: 0.564 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 100 cost time: 1.0302903652191162
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.837 Test Loss: 0.564 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4145123958587646
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.804 Vali Acc: 0.159 Test Loss: 1.804 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 1.0599629878997803
Epoch: 2, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.790 Vali Acc: 0.170 Test Loss: 1.790 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 1.05446457862854
Epoch: 3, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.766 Vali Acc: 0.193 Test Loss: 1.766 Test Acc: 0.193
Validation loss decreased (-0.170352 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 1.0570499897003174
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.720 Vali Acc: 0.230 Test Loss: 1.720 Test Acc: 0.230
Validation loss decreased (-0.192575 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 1.0141146183013916
Epoch: 5, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.663 Vali Acc: 0.289 Test Loss: 1.663 Test Acc: 0.289
Validation loss decreased (-0.229612 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 1.053222894668579
Epoch: 6, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.595 Vali Acc: 0.415 Test Loss: 1.595 Test Acc: 0.415
Validation loss decreased (-0.288872 --> -0.414799).  Saving model ...
Epoch: 7 cost time: 1.0530056953430176
Epoch: 7, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.524 Vali Acc: 0.533 Test Loss: 1.524 Test Acc: 0.533
Validation loss decreased (-0.414799 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 1.0692589282989502
Epoch: 8, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.447 Vali Acc: 0.589 Test Loss: 1.447 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.975985050201416
Epoch: 9, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.367 Vali Acc: 0.644 Test Loss: 1.367 Test Acc: 0.644
Validation loss decreased (-0.588874 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 1.0880687236785889
Epoch: 10, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.286 Vali Acc: 0.663 Test Loss: 1.286 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 11 cost time: 1.0311343669891357
Epoch: 11, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.204 Vali Acc: 0.685 Test Loss: 1.204 Test Acc: 0.685
Validation loss decreased (-0.662950 --> -0.685173).  Saving model ...
Epoch: 12 cost time: 1.1219217777252197
Epoch: 12, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.121 Vali Acc: 0.700 Test Loss: 1.121 Test Acc: 0.700
Validation loss decreased (-0.685173 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.9883987903594971
Epoch: 13, Steps: 2 | Train Loss: 0.742 Vali Loss: 1.043 Vali Acc: 0.711 Test Loss: 1.043 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 1.0450763702392578
Epoch: 14, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.970 Vali Acc: 0.715 Test Loss: 0.970 Test Acc: 0.715
Validation loss decreased (-0.711101 --> -0.714805).  Saving model ...
Epoch: 15 cost time: 1.1081280708312988
Epoch: 15, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.908 Vali Acc: 0.726 Test Loss: 0.908 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725917).  Saving model ...
Epoch: 16 cost time: 1.0899958610534668
Epoch: 16, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.850 Vali Acc: 0.726 Test Loss: 0.850 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 17 cost time: 1.102874755859375
Epoch: 17, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.793 Vali Acc: 0.741 Test Loss: 0.793 Test Acc: 0.741
Validation loss decreased (-0.725917 --> -0.740733).  Saving model ...
Epoch: 18 cost time: 0.9575405120849609
Epoch: 18, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.743 Vali Acc: 0.752 Test Loss: 0.743 Test Acc: 0.752
Validation loss decreased (-0.740733 --> -0.751844).  Saving model ...
Epoch: 19 cost time: 0.9744338989257812
Epoch: 19, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.697 Vali Acc: 0.759 Test Loss: 0.697 Test Acc: 0.759
Validation loss decreased (-0.751844 --> -0.759252).  Saving model ...
Epoch: 20 cost time: 1.0786051750183105
Epoch: 20, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.647 Vali Acc: 0.778 Test Loss: 0.647 Test Acc: 0.778
Validation loss decreased (-0.759252 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 0.9873912334442139
Epoch: 21, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.598 Vali Acc: 0.785 Test Loss: 0.598 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 22 cost time: 0.9641067981719971
Epoch: 22, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 23 cost time: 1.1510910987854004
Epoch: 23, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799995).  Saving model ...
Epoch: 24 cost time: 0.9939861297607422
Epoch: 24, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
Validation loss decreased (-0.799995 --> -0.814810).  Saving model ...
Epoch: 25 cost time: 1.139129400253296
Epoch: 25, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.495 Vali Acc: 0.811 Test Loss: 0.495 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0810120105743408
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.815 Test Loss: 0.483 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 27 cost time: 1.0588750839233398
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
Validation loss decreased (-0.814810 --> -0.814810).  Saving model ...
Epoch: 28 cost time: 1.0996730327606201
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.814810 --> -0.818514).  Saving model ...
Epoch: 29 cost time: 1.1449451446533203
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 30 cost time: 1.0010859966278076
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
Validation loss decreased (-0.818514 --> -0.822218).  Saving model ...
Epoch: 31 cost time: 1.0571069717407227
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
Validation loss decreased (-0.822218 --> -0.825921).  Saving model ...
Epoch: 32 cost time: 1.1405329704284668
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.458 Vali Acc: 0.815 Test Loss: 0.458 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1056079864501953
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.815 Test Loss: 0.451 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1664817333221436
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0134649276733398
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0925514698028564
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.819 Test Loss: 0.431 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1491334438323975
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.830 Test Loss: 0.424 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 38 cost time: 1.2215096950531006
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 39 cost time: 1.1438860893249512
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.837 Test Loss: 0.412 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837033).  Saving model ...
Epoch: 40 cost time: 1.141753911972046
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
Validation loss decreased (-0.837033 --> -0.855551).  Saving model ...
Epoch: 41 cost time: 1.0508887767791748
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.863 Test Loss: 0.404 Test Acc: 0.863
Validation loss decreased (-0.855551 --> -0.862959).  Saving model ...
Epoch: 42 cost time: 1.2960925102233887
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.862959 --> -0.866663).  Saving model ...
Epoch: 43 cost time: 1.164320707321167
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 44 cost time: 1.0734589099884033
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 45 cost time: 1.1308209896087646
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1143724918365479
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.867 Test Loss: 0.402 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0713109970092773
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.867 Test Loss: 0.402 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0417962074279785
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2017464637756348
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0787608623504639
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.866663 --> -0.870366).  Saving model ...
Epoch: 51 cost time: 1.0159525871276855
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 52 cost time: 1.125680923461914
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 53 cost time: 1.0381662845611572
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 54 cost time: 1.0939304828643799
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.874 Test Loss: 0.399 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 55 cost time: 0.9946613311767578
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.874 Test Loss: 0.396 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 56 cost time: 1.0520274639129639
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.874 Test Loss: 0.394 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 57 cost time: 1.141530990600586
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.874 Test Loss: 0.392 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 58 cost time: 1.0021388530731201
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.874 Test Loss: 0.391 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 59 cost time: 0.9844138622283936
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.874 Test Loss: 0.390 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 60 cost time: 0.9607641696929932
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0032756328582764
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1614799499511719
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1966001987457275
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0650339126586914
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.0721659660339355
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.206075668334961
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1705703735351562
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.4549753665924072
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.3347446918487549
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7146217823028564
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.746 Vali Acc: 0.215 Test Loss: 1.746 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.9671800136566162
Epoch: 2, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.736 Vali Acc: 0.226 Test Loss: 1.736 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 1.113910436630249
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.705 Vali Acc: 0.270 Test Loss: 1.705 Test Acc: 0.270
Validation loss decreased (-0.225909 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 1.01411771774292
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.632 Vali Acc: 0.378 Test Loss: 1.632 Test Acc: 0.378
Validation loss decreased (-0.270353 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 1.174663782119751
Epoch: 5, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.542 Vali Acc: 0.470 Test Loss: 1.542 Test Acc: 0.470
Validation loss decreased (-0.377761 --> -0.470355).  Saving model ...
Epoch: 6 cost time: 1.0265283584594727
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.438 Vali Acc: 0.556 Test Loss: 1.438 Test Acc: 0.556
Validation loss decreased (-0.470355 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 1.0419623851776123
Epoch: 7, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.326 Vali Acc: 0.637 Test Loss: 1.326 Test Acc: 0.637
Validation loss decreased (-0.555541 --> -0.637024).  Saving model ...
Epoch: 8 cost time: 1.0484275817871094
Epoch: 8, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.209 Vali Acc: 0.700 Test Loss: 1.209 Test Acc: 0.700
Validation loss decreased (-0.637024 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.9900531768798828
Epoch: 9, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.094 Vali Acc: 0.752 Test Loss: 1.094 Test Acc: 0.752
Validation loss decreased (-0.699988 --> -0.751841).  Saving model ...
Epoch: 10 cost time: 1.0609006881713867
Epoch: 10, Steps: 2 | Train Loss: 1.256 Vali Loss: 0.985 Vali Acc: 0.770 Test Loss: 0.985 Test Acc: 0.770
Validation loss decreased (-0.751841 --> -0.770361).  Saving model ...
Epoch: 11 cost time: 0.8894672393798828
Epoch: 11, Steps: 2 | Train Loss: 1.256 Vali Loss: 0.884 Vali Acc: 0.815 Test Loss: 0.884 Test Acc: 0.815
Validation loss decreased (-0.770361 --> -0.814806).  Saving model ...
Epoch: 12 cost time: 1.043151617050171
Epoch: 12, Steps: 2 | Train Loss: 1.154 Vali Loss: 0.792 Vali Acc: 0.852 Test Loss: 0.792 Test Acc: 0.852
Validation loss decreased (-0.814806 --> -0.851844).  Saving model ...
Epoch: 13 cost time: 0.9568371772766113
Epoch: 13, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
Validation loss decreased (-0.851844 --> -0.877771).  Saving model ...
Epoch: 14 cost time: 1.0100045204162598
Epoch: 14, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.634 Vali Acc: 0.885 Test Loss: 0.634 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 1.0610558986663818
Epoch: 15, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.568 Vali Acc: 0.881 Test Loss: 0.568 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.063323736190796
Epoch: 16, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.510 Vali Acc: 0.893 Test Loss: 0.510 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 1.0005648136138916
Epoch: 17, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2200744152069092
Epoch: 18, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.415 Vali Acc: 0.896 Test Loss: 0.415 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 1.0229849815368652
Epoch: 19, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.376 Vali Acc: 0.904 Test Loss: 0.376 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 1.1074330806732178
Epoch: 20, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.338 Vali Acc: 0.922 Test Loss: 0.338 Test Acc: 0.922
Validation loss decreased (-0.903700 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.9364094734191895
Epoch: 21, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.9438836574554443
Epoch: 22, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 1.15311861038208
Epoch: 23, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 1.0239856243133545
Epoch: 24, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 1.0401577949523926
Epoch: 25, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0708110332489014
Epoch: 26, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.075810194015503
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0539593696594238
Epoch: 28, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9745652675628662
Epoch: 29, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.921741247177124
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.9485936164855957
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.9768850803375244
Epoch: 32, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0240051746368408
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9464688301086426
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1078321933746338
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 1.0830638408660889
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.053818702697754
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0300934314727783
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0943474769592285
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0817368030548096
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9325408935546875
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0019588470458984
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0509729385375977
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1185548305511475
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0413875579833984
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0207645893096924
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.956061840057373
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0091540813446045
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9556851387023926
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.056030035018921
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9481678009033203
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1103096008300781
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9962418079376221
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9386677742004395
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.020442247390747
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9950528144836426
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.944732666015625
Epoch: 1, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.833 Vali Acc: 0.148 Test Loss: 1.833 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.1083619594573975
Epoch: 2, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.824 Vali Acc: 0.152 Test Loss: 1.824 Test Acc: 0.152
Validation loss decreased (-0.148130 --> -0.151834).  Saving model ...
Epoch: 3 cost time: 1.066718578338623
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.786 Vali Acc: 0.193 Test Loss: 1.786 Test Acc: 0.193
Validation loss decreased (-0.151834 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 1.0816326141357422
Epoch: 4, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.695 Vali Acc: 0.293 Test Loss: 1.695 Test Acc: 0.293
Validation loss decreased (-0.192575 --> -0.292576).  Saving model ...
Epoch: 5 cost time: 1.1668579578399658
Epoch: 5, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.583 Vali Acc: 0.433 Test Loss: 1.583 Test Acc: 0.433
Validation loss decreased (-0.292576 --> -0.433318).  Saving model ...
Epoch: 6 cost time: 0.9568996429443359
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.452 Vali Acc: 0.548 Test Loss: 1.452 Test Acc: 0.548
Validation loss decreased (-0.433318 --> -0.548134).  Saving model ...
Epoch: 7 cost time: 1.0846614837646484
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.317 Vali Acc: 0.663 Test Loss: 1.317 Test Acc: 0.663
Validation loss decreased (-0.548134 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 1.0970056056976318
Epoch: 8, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.181 Vali Acc: 0.726 Test Loss: 1.181 Test Acc: 0.726
Validation loss decreased (-0.662950 --> -0.725914).  Saving model ...
Epoch: 9 cost time: 1.0797202587127686
Epoch: 9, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.048 Vali Acc: 0.752 Test Loss: 1.048 Test Acc: 0.752
Validation loss decreased (-0.725914 --> -0.751841).  Saving model ...
Epoch: 10 cost time: 1.0462422370910645
Epoch: 10, Steps: 2 | Train Loss: 1.443 Vali Loss: 0.929 Vali Acc: 0.793 Test Loss: 0.929 Test Acc: 0.793
Validation loss decreased (-0.751841 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 1.1622135639190674
Epoch: 11, Steps: 2 | Train Loss: 1.322 Vali Loss: 0.823 Vali Acc: 0.822 Test Loss: 0.823 Test Acc: 0.822
Validation loss decreased (-0.792583 --> -0.822214).  Saving model ...
Epoch: 12 cost time: 0.95064377784729
Epoch: 12, Steps: 2 | Train Loss: 1.170 Vali Loss: 0.730 Vali Acc: 0.844 Test Loss: 0.730 Test Acc: 0.844
Validation loss decreased (-0.822214 --> -0.844437).  Saving model ...
Epoch: 13 cost time: 1.121239423751831
Epoch: 13, Steps: 2 | Train Loss: 1.068 Vali Loss: 0.649 Vali Acc: 0.874 Test Loss: 0.649 Test Acc: 0.874
Validation loss decreased (-0.844437 --> -0.874068).  Saving model ...
Epoch: 14 cost time: 1.1100873947143555
Epoch: 14, Steps: 2 | Train Loss: 1.009 Vali Loss: 0.577 Vali Acc: 0.896 Test Loss: 0.577 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896291).  Saving model ...
Epoch: 15 cost time: 1.1593451499938965
Epoch: 15, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.515 Vali Acc: 0.904 Test Loss: 0.515 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 16 cost time: 1.1619136333465576
Epoch: 16, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3014378547668457
Epoch: 17, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.420 Vali Acc: 0.904 Test Loss: 0.420 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 1.0653102397918701
Epoch: 18, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2791469097137451
Epoch: 19, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0215213298797607
Epoch: 20, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.033717393875122
Epoch: 21, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.303 Vali Acc: 0.896 Test Loss: 0.303 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9930312633514404
Epoch: 22, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.283 Vali Acc: 0.893 Test Loss: 0.283 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1528816223144531
Epoch: 23, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.215345859527588
Epoch: 24, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.259 Vali Acc: 0.904 Test Loss: 0.259 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903701).  Saving model ...
Epoch: 25 cost time: 1.1896030902862549
Epoch: 25, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.256 Vali Acc: 0.904 Test Loss: 0.256 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 26 cost time: 0.9470860958099365
Epoch: 26, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
Validation loss decreased (-0.903701 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.9047622680664062
Epoch: 27, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.922220 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 1.0352966785430908
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 1.1043622493743896
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9962284564971924
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.987701416015625
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.9974422454833984
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 1.0847868919372559
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0104496479034424
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1160719394683838
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.108691930770874
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9251325130462646
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0776104927062988
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9770584106445312
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9450743198394775
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1842083930969238
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1509249210357666
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.980149507522583
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.05861234664917
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.121178388595581
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.1940152645111084
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.048579216003418
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1088643074035645
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.142117977142334
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0603504180908203
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.112231969833374
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9833946228027344
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1747932434082031
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0888543128967285
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 0.9983794689178467
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.0600011348724365
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.2315280437469482
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1892104148864746
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2402377128601074
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0933284759521484
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1430747509002686
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0420095920562744
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0296142101287842
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0486788749694824
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.976679801940918
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.1412713527679443
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2998530864715576
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0406999588012695
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2324507236480713
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4542453289031982
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.2788989543914795
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0812029838562012
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.0598232746124268
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.2624609470367432
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2371466159820557
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1427478790283203
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1461825370788574
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.130948543548584
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2136576175689697
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2378265857696533
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.199610710144043
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1313881874084473
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.0819289684295654
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0970263481140137
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.0963399410247803
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.125709056854248
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.1571309566497803
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.0450942516326904
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.2213120460510254
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.1563501358032227
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.055983304977417
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9879856109619141
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8582684993743896
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0059776306152344
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0390048027038574
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0097875595092773
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0278358459472656
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.1078152656555176
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.1668450832366943
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.1541969776153564
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.2305212020874023
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.117600440979004
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.2072200775146484
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2738335132598877
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.2186176776885986
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.186290979385376
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.118088722229004
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.1895592212677002
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2855541706085205
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.14357328414917
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2978160381317139
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.2963523864746094
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.2117857933044434
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.1772632598876953
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1360952854156494
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.1838560104370117
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2041983604431152
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1938233375549316
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.088280439376831
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.150486707687378
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.294520378112793
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.334822654724121
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.4164814949035645
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.3637721538543701
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.276144027709961
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 2999046
model size : 21.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0951297283172607
Epoch: 1, Steps: 2 | Train Loss: 1.995 Vali Loss: 1.782 Vali Acc: 0.211 Test Loss: 1.782 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.6610944271087646
Epoch: 2, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.735 Vali Acc: 0.300 Test Loss: 1.735 Test Acc: 0.300
Validation loss decreased (-0.211093 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.4684760570526123
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.669 Vali Acc: 0.363 Test Loss: 1.669 Test Acc: 0.363
Validation loss decreased (-0.299983 --> -0.362946).  Saving model ...
Epoch: 4 cost time: 1.584765911102295
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.559 Vali Acc: 0.411 Test Loss: 1.559 Test Acc: 0.411
Validation loss decreased (-0.362946 --> -0.411096).  Saving model ...
Epoch: 5 cost time: 1.2704463005065918
Epoch: 5, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.428 Vali Acc: 0.563 Test Loss: 1.428 Test Acc: 0.563
Validation loss decreased (-0.411096 --> -0.562949).  Saving model ...
Epoch: 6 cost time: 1.6136205196380615
Epoch: 6, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.290 Vali Acc: 0.648 Test Loss: 1.290 Test Acc: 0.648
Validation loss decreased (-0.562949 --> -0.648135).  Saving model ...
Epoch: 7 cost time: 1.6424560546875
Epoch: 7, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.151 Vali Acc: 0.715 Test Loss: 1.151 Test Acc: 0.715
Validation loss decreased (-0.648135 --> -0.714803).  Saving model ...
Epoch: 8 cost time: 1.3816184997558594
Epoch: 8, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.024 Vali Acc: 0.756 Test Loss: 1.024 Test Acc: 0.756
Validation loss decreased (-0.714803 --> -0.755545).  Saving model ...
Epoch: 9 cost time: 1.484121322631836
Epoch: 9, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.910 Vali Acc: 0.767 Test Loss: 0.910 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 1.593355655670166
Epoch: 10, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.812 Vali Acc: 0.793 Test Loss: 0.812 Test Acc: 0.793
Validation loss decreased (-0.766658 --> -0.792584).  Saving model ...
Epoch: 11 cost time: 1.2883918285369873
Epoch: 11, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.732 Vali Acc: 0.815 Test Loss: 0.732 Test Acc: 0.815
Validation loss decreased (-0.792584 --> -0.814807).  Saving model ...
Epoch: 12 cost time: 1.0580551624298096
Epoch: 12, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.672 Vali Acc: 0.807 Test Loss: 0.672 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.983283519744873
Epoch: 13, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
Validation loss decreased (-0.814807 --> -0.814809).  Saving model ...
Epoch: 14 cost time: 0.999091625213623
Epoch: 14, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.601 Vali Acc: 0.815 Test Loss: 0.601 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 15 cost time: 0.9937047958374023
Epoch: 15, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.088169813156128
Epoch: 16, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 17 cost time: 1.1266071796417236
Epoch: 17, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.569 Vali Acc: 0.815 Test Loss: 0.569 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0612187385559082
Epoch: 18, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.815 Test Loss: 0.566 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1271705627441406
Epoch: 19, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.562 Vali Acc: 0.815 Test Loss: 0.562 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.125427007675171
Epoch: 20, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 21 cost time: 1.0974621772766113
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.830 Test Loss: 0.559 Test Acc: 0.830
Validation loss decreased (-0.818513 --> -0.829624).  Saving model ...
Epoch: 22 cost time: 1.1582801342010498
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.557 Vali Acc: 0.830 Test Loss: 0.557 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 23 cost time: 1.1709659099578857
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.837 Test Loss: 0.555 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837031).  Saving model ...
Epoch: 24 cost time: 1.1424872875213623
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 25 cost time: 1.2183547019958496
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 1.162853479385376
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 27 cost time: 1.012298822402954
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.848 Test Loss: 0.545 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 28 cost time: 1.1512207984924316
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 29 cost time: 1.2134740352630615
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 30 cost time: 1.096599817276001
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.852 Test Loss: 0.538 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851846).  Saving model ...
Epoch: 31 cost time: 0.9774467945098877
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.852 Test Loss: 0.536 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 32 cost time: 1.0572729110717773
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.852 Test Loss: 0.534 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851847).  Saving model ...
Epoch: 33 cost time: 0.9870946407318115
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.852 Test Loss: 0.533 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 34 cost time: 0.9943270683288574
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.852 Test Loss: 0.531 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 35 cost time: 1.0234885215759277
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.852 Test Loss: 0.530 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 36 cost time: 1.1146409511566162
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.852 Test Loss: 0.529 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 37 cost time: 1.178286075592041
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.852 Test Loss: 0.528 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 38 cost time: 0.9566762447357178
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.852 Test Loss: 0.527 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 39 cost time: 1.0205187797546387
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.852 Test Loss: 0.526 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 40 cost time: 1.067934274673462
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.852 Test Loss: 0.525 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 41 cost time: 1.11012864112854
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.852 Test Loss: 0.525 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 42 cost time: 1.1555235385894775
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.852 Test Loss: 0.524 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 43 cost time: 1.0363376140594482
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.852 Test Loss: 0.524 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 44 cost time: 0.9995782375335693
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.852 Test Loss: 0.523 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 45 cost time: 1.014096736907959
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.852 Test Loss: 0.522 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 46 cost time: 0.964996337890625
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.852 Test Loss: 0.522 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 47 cost time: 1.268812894821167
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.852 Test Loss: 0.521 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 48 cost time: 1.114358901977539
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.852 Test Loss: 0.520 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 49 cost time: 1.154536485671997
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.852 Test Loss: 0.519 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 50 cost time: 1.466482400894165
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.852 Test Loss: 0.519 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 51 cost time: 1.2180538177490234
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.852 Test Loss: 0.518 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 52 cost time: 1.28529691696167
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.852 Test Loss: 0.517 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 53 cost time: 1.346120834350586
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.852 Test Loss: 0.516 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 54 cost time: 1.1326868534088135
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.851847 --> -0.862958).  Saving model ...
Epoch: 55 cost time: 1.174163818359375
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 56 cost time: 1.2501311302185059
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 57 cost time: 1.1348793506622314
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 58 cost time: 1.1056921482086182
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 59 cost time: 1.1086299419403076
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 60 cost time: 1.4319400787353516
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 61 cost time: 1.7159504890441895
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 62 cost time: 1.335972547531128
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 63 cost time: 1.4198644161224365
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 64 cost time: 1.2668511867523193
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 65 cost time: 1.337113857269287
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 66 cost time: 1.1374340057373047
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 67 cost time: 1.3080530166625977
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 68 cost time: 1.2881250381469727
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 69 cost time: 1.2942471504211426
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 70 cost time: 1.3321046829223633
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 71 cost time: 1.3263418674468994
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 72 cost time: 1.2734334468841553
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 73 cost time: 1.5543274879455566
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 74 cost time: 1.3433241844177246
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 75 cost time: 1.2545483112335205
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 76 cost time: 1.2535927295684814
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 77 cost time: 1.5083835124969482
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 78 cost time: 1.3920013904571533
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 79 cost time: 1.6165807247161865
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.874 Test Loss: 0.495 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 80 cost time: 1.3143999576568604
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.874 Test Loss: 0.494 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 81 cost time: 1.4679970741271973
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.874 Test Loss: 0.493 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 82 cost time: 1.311333179473877
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.874 Test Loss: 0.493 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 83 cost time: 1.5322551727294922
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.874 Test Loss: 0.492 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 84 cost time: 1.3781256675720215
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.874 Test Loss: 0.491 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 85 cost time: 1.393181324005127
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.874 Test Loss: 0.490 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 86 cost time: 1.2051022052764893
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 87 cost time: 1.2956271171569824
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 88 cost time: 1.209183931350708
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 89 cost time: 1.1807081699371338
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 90 cost time: 1.5188708305358887
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 91 cost time: 1.4274404048919678
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 92 cost time: 1.2901976108551025
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 93 cost time: 1.3952791690826416
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 94 cost time: 1.3876457214355469
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 95 cost time: 1.3788747787475586
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 96 cost time: 1.3384804725646973
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.881 Test Loss: 0.483 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 97 cost time: 1.478196620941162
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.881 Test Loss: 0.483 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 98 cost time: 1.2188925743103027
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.881 Test Loss: 0.482 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 99 cost time: 1.3935086727142334
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.885 Test Loss: 0.482 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885180).  Saving model ...
Epoch: 100 cost time: 1.4692943096160889
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.885 Test Loss: 0.482 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2384190559387207
Epoch: 1, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.836 Vali Acc: 0.156 Test Loss: 1.836 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.3217613697052002
Epoch: 2, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.798 Vali Acc: 0.219 Test Loss: 1.798 Test Acc: 0.219
Validation loss decreased (-0.155537 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 1.379667043685913
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.745 Vali Acc: 0.274 Test Loss: 1.745 Test Acc: 0.274
Validation loss decreased (-0.218501 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 1.3897182941436768
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.658 Vali Acc: 0.407 Test Loss: 1.658 Test Acc: 0.407
Validation loss decreased (-0.274057 --> -0.407391).  Saving model ...
Epoch: 5 cost time: 1.3773484230041504
Epoch: 5, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
Validation loss decreased (-0.407391 --> -0.499984).  Saving model ...
Epoch: 6 cost time: 1.380042314529419
Epoch: 6, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.441 Vali Acc: 0.552 Test Loss: 1.441 Test Acc: 0.552
Validation loss decreased (-0.499984 --> -0.551837).  Saving model ...
Epoch: 7 cost time: 1.5032830238342285
Epoch: 7, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.329 Vali Acc: 0.593 Test Loss: 1.329 Test Acc: 0.593
Validation loss decreased (-0.551837 --> -0.592579).  Saving model ...
Epoch: 8 cost time: 1.5327870845794678
Epoch: 8, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.223 Vali Acc: 0.619 Test Loss: 1.223 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 1.4067199230194092
Epoch: 9, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.122 Vali Acc: 0.648 Test Loss: 1.122 Test Acc: 0.648
Validation loss decreased (-0.618506 --> -0.648137).  Saving model ...
Epoch: 10 cost time: 1.4174106121063232
Epoch: 10, Steps: 2 | Train Loss: 0.675 Vali Loss: 1.031 Vali Acc: 0.681 Test Loss: 1.031 Test Acc: 0.681
Validation loss decreased (-0.648137 --> -0.681471).  Saving model ...
Epoch: 11 cost time: 1.5626051425933838
Epoch: 11, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.950 Vali Acc: 0.704 Test Loss: 0.950 Test Acc: 0.704
Validation loss decreased (-0.681471 --> -0.703694).  Saving model ...
Epoch: 12 cost time: 1.4000129699707031
Epoch: 12, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.883 Vali Acc: 0.726 Test Loss: 0.883 Test Acc: 0.726
Validation loss decreased (-0.703694 --> -0.725917).  Saving model ...
Epoch: 13 cost time: 1.5047461986541748
Epoch: 13, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.825 Vali Acc: 0.737 Test Loss: 0.825 Test Acc: 0.737
Validation loss decreased (-0.725917 --> -0.737029).  Saving model ...
Epoch: 14 cost time: 1.6694672107696533
Epoch: 14, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.786 Vali Acc: 0.748 Test Loss: 0.786 Test Acc: 0.748
Validation loss decreased (-0.737029 --> -0.748140).  Saving model ...
Epoch: 15 cost time: 1.4443135261535645
Epoch: 15, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5625782012939453
Epoch: 16, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
Validation loss decreased (-0.748140 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 1.3863651752471924
Epoch: 17, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.701 Vali Acc: 0.759 Test Loss: 0.701 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 18 cost time: 1.5743684768676758
Epoch: 18, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.679 Vali Acc: 0.759 Test Loss: 0.679 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 19 cost time: 1.3125426769256592
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 1.5952231884002686
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.648 Vali Acc: 0.778 Test Loss: 0.648 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 1.4710233211517334
Epoch: 21, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.793 Test Loss: 0.637 Test Acc: 0.793
Validation loss decreased (-0.777771 --> -0.792586).  Saving model ...
Epoch: 22 cost time: 1.4240994453430176
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 23 cost time: 1.4062294960021973
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 24 cost time: 1.3770222663879395
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 25 cost time: 1.4890007972717285
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 1.6108558177947998
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 1.4205870628356934
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.807 Test Loss: 0.590 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807402).  Saving model ...
Epoch: 28 cost time: 1.518676519393921
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 29 cost time: 1.3018229007720947
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 30 cost time: 1.5352025032043457
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 1.3910982608795166
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 32 cost time: 1.5476999282836914
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 33 cost time: 1.3492043018341064
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 34 cost time: 1.4461100101470947
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 35 cost time: 1.2833342552185059
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.830 Test Loss: 0.556 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 36 cost time: 1.571620225906372
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.830 Test Loss: 0.553 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 37 cost time: 1.3591465950012207
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 1.3904552459716797
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 1.585151195526123
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.837 Test Loss: 0.547 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 40 cost time: 1.454270362854004
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.837 Test Loss: 0.545 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 41 cost time: 1.3685259819030762
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.837 Test Loss: 0.543 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 42 cost time: 1.2921717166900635
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.837 Test Loss: 0.541 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 43 cost time: 1.280348539352417
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.837 Test Loss: 0.540 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 44 cost time: 1.3389616012573242
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.837 Test Loss: 0.538 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 45 cost time: 1.3333663940429688
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.837 Test Loss: 0.537 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 46 cost time: 1.5330545902252197
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 47 cost time: 1.488633632659912
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 48 cost time: 1.6890451908111572
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 49 cost time: 1.387380599975586
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 50 cost time: 1.330273151397705
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 51 cost time: 1.316324234008789
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 52 cost time: 1.37164306640625
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 53 cost time: 1.4056038856506348
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 54 cost time: 1.30409836769104
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 55 cost time: 1.26322340965271
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 56 cost time: 1.2603538036346436
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 57 cost time: 1.3173980712890625
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 58 cost time: 1.3091070652008057
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 59 cost time: 1.396564245223999
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 60 cost time: 1.266861915588379
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 61 cost time: 1.2446393966674805
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 62 cost time: 1.3769612312316895
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 63 cost time: 1.3274588584899902
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 64 cost time: 1.4767720699310303
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 65 cost time: 1.7205603122711182
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.848 Test Loss: 0.514 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 1.3745830059051514
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.848 Test Loss: 0.514 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 67 cost time: 1.2443735599517822
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 68 cost time: 1.4640202522277832
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.852 Test Loss: 0.512 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 69 cost time: 1.6406426429748535
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.852 Test Loss: 0.511 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 70 cost time: 1.4708631038665771
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.852 Test Loss: 0.510 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 71 cost time: 1.5214250087738037
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.852 Test Loss: 0.509 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 72 cost time: 1.5973711013793945
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.852 Test Loss: 0.508 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 73 cost time: 1.5517668724060059
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855550).  Saving model ...
Epoch: 74 cost time: 1.5859932899475098
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 75 cost time: 1.2694687843322754
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 76 cost time: 1.2597320079803467
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 77 cost time: 1.3952288627624512
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 78 cost time: 1.4956843852996826
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 79 cost time: 1.4177541732788086
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 80 cost time: 1.4441368579864502
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 81 cost time: 1.421647071838379
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 82 cost time: 1.178391456604004
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 83 cost time: 1.3880622386932373
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 84 cost time: 1.4560573101043701
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 85 cost time: 1.5140869617462158
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 86 cost time: 1.4687318801879883
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 87 cost time: 1.6722915172576904
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 88 cost time: 1.6215243339538574
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 89 cost time: 1.37593674659729
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 90 cost time: 1.5946853160858154
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 91 cost time: 1.3698132038116455
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 92 cost time: 1.5236427783966064
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 93 cost time: 1.6217494010925293
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 94 cost time: 1.4678394794464111
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 95 cost time: 1.3444204330444336
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 96 cost time: 1.3688278198242188
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.874 Test Loss: 0.489 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 97 cost time: 1.3574516773223877
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.874 Test Loss: 0.489 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 98 cost time: 1.261894941329956
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.874 Test Loss: 0.488 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 99 cost time: 1.500520944595337
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.874 Test Loss: 0.488 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 100 cost time: 1.4214091300964355
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.874 Test Loss: 0.487 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.388967275619507
Epoch: 1, Steps: 2 | Train Loss: 2.032 Vali Loss: 1.854 Vali Acc: 0.170 Test Loss: 1.854 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.3422210216522217
Epoch: 2, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.822 Vali Acc: 0.204 Test Loss: 1.822 Test Acc: 0.204
Validation loss decreased (-0.170352 --> -0.203685).  Saving model ...
Epoch: 3 cost time: 1.2266781330108643
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.780 Vali Acc: 0.237 Test Loss: 1.780 Test Acc: 0.237
Validation loss decreased (-0.203685 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 1.0776402950286865
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.712 Vali Acc: 0.322 Test Loss: 1.712 Test Acc: 0.322
Validation loss decreased (-0.237019 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 1.1884181499481201
Epoch: 5, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.629 Vali Acc: 0.433 Test Loss: 1.629 Test Acc: 0.433
Validation loss decreased (-0.322205 --> -0.433317).  Saving model ...
Epoch: 6 cost time: 1.171499490737915
Epoch: 6, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.542 Vali Acc: 0.504 Test Loss: 1.542 Test Acc: 0.504
Validation loss decreased (-0.433317 --> -0.503688).  Saving model ...
Epoch: 7 cost time: 1.2846555709838867
Epoch: 7, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.451 Vali Acc: 0.567 Test Loss: 1.451 Test Acc: 0.567
Validation loss decreased (-0.503688 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 1.20363187789917
Epoch: 8, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.363 Vali Acc: 0.589 Test Loss: 1.363 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 1.3130948543548584
Epoch: 9, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.276 Vali Acc: 0.607 Test Loss: 1.276 Test Acc: 0.607
Validation loss decreased (-0.588875 --> -0.607395).  Saving model ...
Epoch: 10 cost time: 1.5094211101531982
Epoch: 10, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.194 Vali Acc: 0.619 Test Loss: 1.194 Test Acc: 0.619
Validation loss decreased (-0.607395 --> -0.618507).  Saving model ...
Epoch: 11 cost time: 1.497427225112915
Epoch: 11, Steps: 2 | Train Loss: 0.617 Vali Loss: 1.115 Vali Acc: 0.637 Test Loss: 1.115 Test Acc: 0.637
Validation loss decreased (-0.618507 --> -0.637026).  Saving model ...
Epoch: 12 cost time: 1.30574369430542
Epoch: 12, Steps: 2 | Train Loss: 0.496 Vali Loss: 1.045 Vali Acc: 0.659 Test Loss: 1.045 Test Acc: 0.659
Validation loss decreased (-0.637026 --> -0.659249).  Saving model ...
Epoch: 13 cost time: 1.3639309406280518
Epoch: 13, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.659249 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.3029780387878418
Epoch: 14, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.937 Vali Acc: 0.704 Test Loss: 0.937 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 15 cost time: 1.3475265502929688
Epoch: 15, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.902 Vali Acc: 0.726 Test Loss: 0.902 Test Acc: 0.726
Validation loss decreased (-0.703694 --> -0.725917).  Saving model ...
Epoch: 16 cost time: 1.3615341186523438
Epoch: 16, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
Validation loss decreased (-0.725917 --> -0.733325).  Saving model ...
Epoch: 17 cost time: 1.2969889640808105
Epoch: 17, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.841 Vali Acc: 0.737 Test Loss: 0.841 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 18 cost time: 1.1671898365020752
Epoch: 18, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.815 Vali Acc: 0.741 Test Loss: 0.815 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 19 cost time: 1.4503777027130127
Epoch: 19, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.787 Vali Acc: 0.756 Test Loss: 0.787 Test Acc: 0.756
Validation loss decreased (-0.740733 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.2799856662750244
Epoch: 20, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.767 Vali Acc: 0.763 Test Loss: 0.767 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762955).  Saving model ...
Epoch: 21 cost time: 1.2422029972076416
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.751 Vali Acc: 0.763 Test Loss: 0.751 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 22 cost time: 1.1988911628723145
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.736 Vali Acc: 0.770 Test Loss: 0.736 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 23 cost time: 1.3100109100341797
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.770363 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 1.4771528244018555
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.708 Vali Acc: 0.785 Test Loss: 0.708 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785178).  Saving model ...
Epoch: 25 cost time: 1.266841173171997
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.696 Vali Acc: 0.796 Test Loss: 0.696 Test Acc: 0.796
Validation loss decreased (-0.785178 --> -0.796289).  Saving model ...
Epoch: 26 cost time: 1.4047596454620361
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 1.2623891830444336
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 1.3285908699035645
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 1.3916075229644775
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.807 Test Loss: 0.662 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807401).  Saving model ...
Epoch: 30 cost time: 1.4915261268615723
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814808).  Saving model ...
Epoch: 31 cost time: 1.5759718418121338
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 32 cost time: 1.3543157577514648
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 33 cost time: 1.5000836849212646
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 34 cost time: 1.2748408317565918
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.830 Test Loss: 0.639 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829623).  Saving model ...
Epoch: 35 cost time: 1.6518616676330566
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.830 Test Loss: 0.636 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 36 cost time: 1.4810571670532227
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.830 Test Loss: 0.634 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 37 cost time: 1.4775922298431396
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.830 Test Loss: 0.631 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 1.3730320930480957
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 1.4231626987457275
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.4075188636779785
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 1.160597801208496
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 1.1533710956573486
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.830 Test Loss: 0.622 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2706997394561768
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.830 Test Loss: 0.621 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3245699405670166
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 45 cost time: 1.151521921157837
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 46 cost time: 1.2252428531646729
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 47 cost time: 1.2210102081298828
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.837 Test Loss: 0.615 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 48 cost time: 1.337630271911621
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.837 Test Loss: 0.613 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 49 cost time: 1.2578585147857666
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.837 Test Loss: 0.612 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 50 cost time: 1.213200330734253
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 51 cost time: 1.3634083271026611
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 52 cost time: 1.43607759475708
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 53 cost time: 1.4344415664672852
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 54 cost time: 1.5298619270324707
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 55 cost time: 1.3021812438964844
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 56 cost time: 1.28505539894104
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 57 cost time: 1.3421049118041992
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 58 cost time: 1.2396950721740723
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844438).  Saving model ...
Epoch: 59 cost time: 1.405074119567871
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 60 cost time: 1.407738208770752
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 61 cost time: 1.493929147720337
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 62 cost time: 1.3280706405639648
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 63 cost time: 1.3653311729431152
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.3610353469848633
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 65 cost time: 1.2875750064849854
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 66 cost time: 1.469587802886963
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 67 cost time: 1.3359715938568115
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 68 cost time: 1.34999680519104
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 69 cost time: 1.3588371276855469
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 70 cost time: 1.0892889499664307
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 71 cost time: 1.2064542770385742
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 72 cost time: 1.3906121253967285
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 73 cost time: 1.4120543003082275
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 74 cost time: 1.377798318862915
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 75 cost time: 1.3020973205566406
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 76 cost time: 1.1944546699523926
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 77 cost time: 1.4408106803894043
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 78 cost time: 1.2979488372802734
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 79 cost time: 1.4575324058532715
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848142).  Saving model ...
Epoch: 80 cost time: 1.2741429805755615
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 81 cost time: 1.2823505401611328
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 82 cost time: 1.2640354633331299
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 83 cost time: 1.1802546977996826
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.848 Test Loss: 0.574 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 84 cost time: 1.2090659141540527
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 85 cost time: 1.2407493591308594
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 86 cost time: 1.2106354236602783
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 87 cost time: 1.30159330368042
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 88 cost time: 1.4629039764404297
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 89 cost time: 1.4166324138641357
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 90 cost time: 1.4011833667755127
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 91 cost time: 1.2747337818145752
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 92 cost time: 1.2403862476348877
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 93 cost time: 1.4525253772735596
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 94 cost time: 1.4157373905181885
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 95 cost time: 1.442216396331787
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 96 cost time: 1.4026494026184082
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 97 cost time: 1.3237457275390625
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 98 cost time: 1.4516868591308594
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 99 cost time: 1.7386200428009033
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
Validation loss decreased (-0.848142 --> -0.855550).  Saving model ...
Epoch: 100 cost time: 1.2833170890808105
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.852 Test Loss: 0.564 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8555555555555555
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.906198501586914
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.847 Vali Acc: 0.130 Test Loss: 1.847 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 1.1665713787078857
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.819 Vali Acc: 0.148 Test Loss: 1.819 Test Acc: 0.148
Validation loss decreased (-0.129611 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.4969854354858398
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.784 Vali Acc: 0.178 Test Loss: 1.784 Test Acc: 0.178
Validation loss decreased (-0.148130 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.3816301822662354
Epoch: 4, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.730 Vali Acc: 0.226 Test Loss: 1.730 Test Acc: 0.226
Validation loss decreased (-0.177760 --> -0.225909).  Saving model ...
Epoch: 5 cost time: 1.2721588611602783
Epoch: 5, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.667 Vali Acc: 0.344 Test Loss: 1.667 Test Acc: 0.344
Validation loss decreased (-0.225909 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 1.1392385959625244
Epoch: 6, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.601 Vali Acc: 0.441 Test Loss: 1.601 Test Acc: 0.441
Validation loss decreased (-0.344428 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 1.229717493057251
Epoch: 7, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.534 Vali Acc: 0.478 Test Loss: 1.534 Test Acc: 0.478
Validation loss decreased (-0.440725 --> -0.477762).  Saving model ...
Epoch: 8 cost time: 1.0397286415100098
Epoch: 8, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.467 Vali Acc: 0.481 Test Loss: 1.467 Test Acc: 0.481
Validation loss decreased (-0.477762 --> -0.481467).  Saving model ...
Epoch: 9 cost time: 1.31223464012146
Epoch: 9, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
Validation loss decreased (-0.481467 --> -0.503690).  Saving model ...
Epoch: 10 cost time: 1.2176344394683838
Epoch: 10, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.332 Vali Acc: 0.526 Test Loss: 1.332 Test Acc: 0.526
Validation loss decreased (-0.503690 --> -0.525913).  Saving model ...
Epoch: 11 cost time: 1.252976894378662
Epoch: 11, Steps: 2 | Train Loss: 0.764 Vali Loss: 1.267 Vali Acc: 0.552 Test Loss: 1.267 Test Acc: 0.552
Validation loss decreased (-0.525913 --> -0.551839).  Saving model ...
Epoch: 12 cost time: 1.5930113792419434
Epoch: 12, Steps: 2 | Train Loss: 0.648 Vali Loss: 1.204 Vali Acc: 0.556 Test Loss: 1.204 Test Acc: 0.556
Validation loss decreased (-0.551839 --> -0.555544).  Saving model ...
Epoch: 13 cost time: 1.2953882217407227
Epoch: 13, Steps: 2 | Train Loss: 0.589 Vali Loss: 1.144 Vali Acc: 0.570 Test Loss: 1.144 Test Acc: 0.570
Validation loss decreased (-0.555544 --> -0.570359).  Saving model ...
Epoch: 14 cost time: 1.293210744857788
Epoch: 14, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.570359 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.337489128112793
Epoch: 15, Steps: 2 | Train Loss: 0.357 Vali Loss: 1.051 Vali Acc: 0.619 Test Loss: 1.051 Test Acc: 0.619
Validation loss decreased (-0.599989 --> -0.618508).  Saving model ...
Epoch: 16 cost time: 1.3314952850341797
Epoch: 16, Steps: 2 | Train Loss: 0.292 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
Validation loss decreased (-0.618508 --> -0.622212).  Saving model ...
Epoch: 17 cost time: 1.1401276588439941
Epoch: 17, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.972 Vali Acc: 0.644 Test Loss: 0.972 Test Acc: 0.644
Validation loss decreased (-0.622212 --> -0.644435).  Saving model ...
Epoch: 18 cost time: 1.2405214309692383
Epoch: 18, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.938 Vali Acc: 0.663 Test Loss: 0.938 Test Acc: 0.663
Validation loss decreased (-0.644435 --> -0.662954).  Saving model ...
Epoch: 19 cost time: 1.5068721771240234
Epoch: 19, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.893 Vali Acc: 0.674 Test Loss: 0.893 Test Acc: 0.674
Validation loss decreased (-0.662954 --> -0.674065).  Saving model ...
Epoch: 20 cost time: 1.2661247253417969
Epoch: 20, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.855 Vali Acc: 0.670 Test Loss: 0.855 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3344128131866455
Epoch: 21, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.819 Vali Acc: 0.689 Test Loss: 0.819 Test Acc: 0.689
Validation loss decreased (-0.674065 --> -0.688881).  Saving model ...
Epoch: 22 cost time: 1.426943063735962
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.788 Vali Acc: 0.707 Test Loss: 0.788 Test Acc: 0.707
Validation loss decreased (-0.688881 --> -0.707400).  Saving model ...
Epoch: 23 cost time: 1.2289552688598633
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.763 Vali Acc: 0.715 Test Loss: 0.763 Test Acc: 0.715
Validation loss decreased (-0.707400 --> -0.714807).  Saving model ...
Epoch: 24 cost time: 1.3323280811309814
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.742 Vali Acc: 0.719 Test Loss: 0.742 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718511).  Saving model ...
Epoch: 25 cost time: 1.1149492263793945
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.725 Vali Acc: 0.726 Test Loss: 0.725 Test Acc: 0.726
Validation loss decreased (-0.718511 --> -0.725919).  Saving model ...
Epoch: 26 cost time: 1.2390773296356201
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.711 Vali Acc: 0.741 Test Loss: 0.711 Test Acc: 0.741
Validation loss decreased (-0.725919 --> -0.740734).  Saving model ...
Epoch: 27 cost time: 1.3051865100860596
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.700 Vali Acc: 0.752 Test Loss: 0.700 Test Acc: 0.752
Validation loss decreased (-0.740734 --> -0.751845).  Saving model ...
Epoch: 28 cost time: 1.2005932331085205
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 29 cost time: 1.2102487087249756
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.752 Test Loss: 0.683 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.678307294845581
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.677 Vali Acc: 0.748 Test Loss: 0.677 Test Acc: 0.748
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3026037216186523
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.752 Test Loss: 0.672 Test Acc: 0.752
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1971790790557861
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.759 Test Loss: 0.668 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759253).  Saving model ...
Epoch: 33 cost time: 1.1645212173461914
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
Validation loss decreased (-0.759253 --> -0.762956).  Saving model ...
Epoch: 34 cost time: 1.2504589557647705
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 35 cost time: 1.2577557563781738
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2627830505371094
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.767 Test Loss: 0.655 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 37 cost time: 1.2763371467590332
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.774 Test Loss: 0.653 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774068).  Saving model ...
Epoch: 38 cost time: 1.37990140914917
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.774 Test Loss: 0.650 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 39 cost time: 1.2441964149475098
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.774 Test Loss: 0.648 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 40 cost time: 1.2553846836090088
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.781 Test Loss: 0.646 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781475).  Saving model ...
Epoch: 41 cost time: 1.4159882068634033
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.781 Test Loss: 0.643 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 42 cost time: 1.3372840881347656
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.785 Test Loss: 0.641 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 43 cost time: 1.3328042030334473
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788882).  Saving model ...
Epoch: 44 cost time: 1.1809072494506836
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 45 cost time: 1.1434931755065918
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 46 cost time: 1.1605618000030518
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 47 cost time: 1.258835792541504
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 48 cost time: 1.3458025455474854
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 49 cost time: 1.243168830871582
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
Validation loss decreased (-0.788883 --> -0.796290).  Saving model ...
Epoch: 50 cost time: 1.4054956436157227
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 51 cost time: 1.2614407539367676
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 52 cost time: 1.61501145362854
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 53 cost time: 1.3646550178527832
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 1.4848761558532715
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 55 cost time: 1.2766199111938477
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 56 cost time: 1.254138708114624
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.807 Test Loss: 0.616 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 57 cost time: 1.38751220703125
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.807 Test Loss: 0.614 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 58 cost time: 1.2956981658935547
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.807 Test Loss: 0.613 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 59 cost time: 1.2630469799041748
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.807 Test Loss: 0.612 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 60 cost time: 1.2674274444580078
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.807 Test Loss: 0.610 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 61 cost time: 1.2371079921722412
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.807 Test Loss: 0.608 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 62 cost time: 1.250295639038086
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.811 Test Loss: 0.606 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 63 cost time: 1.1486659049987793
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 1.2866060733795166
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 65 cost time: 1.393347978591919
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.811 Test Loss: 0.602 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 66 cost time: 1.3197999000549316
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.815 Test Loss: 0.601 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 67 cost time: 1.2190678119659424
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 68 cost time: 1.1791298389434814
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.815 Test Loss: 0.598 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 69 cost time: 1.342235803604126
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 70 cost time: 1.2398464679718018
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 71 cost time: 1.2283921241760254
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.815 Test Loss: 0.595 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 72 cost time: 1.2013282775878906
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.815 Test Loss: 0.594 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 73 cost time: 1.4801554679870605
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.815 Test Loss: 0.592 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 74 cost time: 1.4036767482757568
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.815 Test Loss: 0.591 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 75 cost time: 1.3350296020507812
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 76 cost time: 1.2818505764007568
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 77 cost time: 1.2672574520111084
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.815 Test Loss: 0.587 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 78 cost time: 1.3893322944641113
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.815 Test Loss: 0.586 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 79 cost time: 1.6157231330871582
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 80 cost time: 1.1736657619476318
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 81 cost time: 1.4389371871948242
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 82 cost time: 1.0973856449127197
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 83 cost time: 1.2405152320861816
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 84 cost time: 1.1889419555664062
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 85 cost time: 1.1644415855407715
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 86 cost time: 1.1388752460479736
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 87 cost time: 1.2869820594787598
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.141512393951416
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 89 cost time: 1.3639740943908691
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 90 cost time: 1.1365439891815186
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 91 cost time: 1.2042748928070068
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 92 cost time: 1.2791993618011475
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 93 cost time: 1.2045865058898926
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 94 cost time: 1.2242863178253174
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 95 cost time: 1.2341060638427734
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.830 Test Loss: 0.569 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 96 cost time: 1.2075140476226807
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.830 Test Loss: 0.568 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 97 cost time: 1.2481553554534912
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.830 Test Loss: 0.567 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 98 cost time: 1.3743960857391357
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.830 Test Loss: 0.565 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 99 cost time: 1.2043426036834717
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.830 Test Loss: 0.564 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 100 cost time: 1.2581408023834229
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.830 Test Loss: 0.563 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.939603805541992
Epoch: 1, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.903 Vali Acc: 0.148 Test Loss: 1.903 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 1.1943025588989258
Epoch: 2, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.885 Vali Acc: 0.152 Test Loss: 1.885 Test Acc: 0.152
Validation loss decreased (-0.148129 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 1.4625349044799805
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.856 Vali Acc: 0.156 Test Loss: 1.856 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 1.296177864074707
Epoch: 4, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.806 Vali Acc: 0.189 Test Loss: 1.806 Test Acc: 0.189
Validation loss decreased (-0.155537 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 1.4243478775024414
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.743 Vali Acc: 0.215 Test Loss: 1.743 Test Acc: 0.215
Validation loss decreased (-0.188871 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 1.3422393798828125
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.672 Vali Acc: 0.322 Test Loss: 1.672 Test Acc: 0.322
Validation loss decreased (-0.214797 --> -0.322205).  Saving model ...
Epoch: 7 cost time: 1.2554481029510498
Epoch: 7, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.596 Vali Acc: 0.437 Test Loss: 1.596 Test Acc: 0.437
Validation loss decreased (-0.322205 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 1.2676270008087158
Epoch: 8, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.516 Vali Acc: 0.537 Test Loss: 1.516 Test Acc: 0.537
Validation loss decreased (-0.437021 --> -0.537022).  Saving model ...
Epoch: 9 cost time: 1.4733800888061523
Epoch: 9, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
Validation loss decreased (-0.537022 --> -0.581467).  Saving model ...
Epoch: 10 cost time: 1.1753699779510498
Epoch: 10, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.345 Vali Acc: 0.615 Test Loss: 1.345 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 1.2446908950805664
Epoch: 11, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.259 Vali Acc: 0.648 Test Loss: 1.259 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648136).  Saving model ...
Epoch: 12 cost time: 1.2507095336914062
Epoch: 12, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.171 Vali Acc: 0.663 Test Loss: 1.171 Test Acc: 0.663
Validation loss decreased (-0.648136 --> -0.662951).  Saving model ...
Epoch: 13 cost time: 1.3057420253753662
Epoch: 13, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
Validation loss decreased (-0.662951 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 1.313385248184204
Epoch: 14, Steps: 2 | Train Loss: 0.671 Vali Loss: 1.002 Vali Acc: 0.726 Test Loss: 1.002 Test Acc: 0.726
Validation loss decreased (-0.699989 --> -0.725916).  Saving model ...
Epoch: 15 cost time: 1.3441166877746582
Epoch: 15, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.14847731590271
Epoch: 16, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.862 Vali Acc: 0.756 Test Loss: 0.862 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 17 cost time: 1.2706356048583984
Epoch: 17, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.802 Vali Acc: 0.748 Test Loss: 0.802 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2583563327789307
Epoch: 18, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 1.7448368072509766
Epoch: 19, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.701 Vali Acc: 0.781 Test Loss: 0.701 Test Acc: 0.781
Validation loss decreased (-0.755548 --> -0.781474).  Saving model ...
Epoch: 20 cost time: 1.1688976287841797
Epoch: 20, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.668 Vali Acc: 0.767 Test Loss: 0.668 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2760357856750488
Epoch: 21, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.641 Vali Acc: 0.759 Test Loss: 0.641 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2175753116607666
Epoch: 22, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.607 Vali Acc: 0.767 Test Loss: 0.607 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.254582166671753
Epoch: 23, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.572 Vali Acc: 0.774 Test Loss: 0.572 Test Acc: 0.774
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1919143199920654
Epoch: 24, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
Validation loss decreased (-0.781474 --> -0.799995).  Saving model ...
Epoch: 25 cost time: 1.3183484077453613
Epoch: 25, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.807 Test Loss: 0.503 Test Acc: 0.807
Validation loss decreased (-0.799995 --> -0.807402).  Saving model ...
Epoch: 26 cost time: 1.4808928966522217
Epoch: 26, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814810).  Saving model ...
Epoch: 27 cost time: 1.2751777172088623
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
Validation loss decreased (-0.814810 --> -0.822218).  Saving model ...
Epoch: 28 cost time: 1.4213428497314453
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
Validation loss decreased (-0.822218 --> -0.825921).  Saving model ...
Epoch: 29 cost time: 1.3734872341156006
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
Validation loss decreased (-0.825921 --> -0.833329).  Saving model ...
Epoch: 30 cost time: 1.1576340198516846
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840736).  Saving model ...
Epoch: 31 cost time: 1.2398195266723633
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.840736 --> -0.848144).  Saving model ...
Epoch: 32 cost time: 1.363826036453247
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2521793842315674
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3134708404541016
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 35 cost time: 1.3576834201812744
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.236682415008545
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.852 Test Loss: 0.431 Test Acc: 0.852
Validation loss decreased (-0.848144 --> -0.851848).  Saving model ...
Epoch: 37 cost time: 1.3983006477355957
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.852 Test Loss: 0.431 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2737691402435303
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.852 Test Loss: 0.431 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3165245056152344
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.852 Test Loss: 0.430 Test Acc: 0.852
Validation loss decreased (-0.851848 --> -0.851848).  Saving model ...
Epoch: 40 cost time: 1.0696804523468018
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.852 Test Loss: 0.427 Test Acc: 0.852
Validation loss decreased (-0.851848 --> -0.851848).  Saving model ...
Epoch: 41 cost time: 1.3135266304016113
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2593271732330322
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.852 Test Loss: 0.424 Test Acc: 0.852
Validation loss decreased (-0.851848 --> -0.851848).  Saving model ...
Epoch: 43 cost time: 1.3070826530456543
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
Validation loss decreased (-0.851848 --> -0.855551).  Saving model ...
Epoch: 44 cost time: 1.2164373397827148
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.852 Test Loss: 0.419 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2332663536071777
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.852 Test Loss: 0.418 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2590389251708984
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.856 Test Loss: 0.415 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 47 cost time: 1.213001012802124
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.856 Test Loss: 0.412 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 48 cost time: 1.3720955848693848
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.859 Test Loss: 0.409 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 49 cost time: 1.3196852207183838
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.859 Test Loss: 0.407 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 50 cost time: 1.2771165370941162
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.859 Test Loss: 0.405 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 51 cost time: 1.3420019149780273
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866663).  Saving model ...
Epoch: 52 cost time: 1.2849929332733154
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 53 cost time: 1.3518688678741455
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.874 Test Loss: 0.399 Test Acc: 0.874
Validation loss decreased (-0.866663 --> -0.874070).  Saving model ...
Epoch: 54 cost time: 1.3832776546478271
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.397 Vali Acc: 0.874 Test Loss: 0.397 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 55 cost time: 1.4278371334075928
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 56 cost time: 1.2508931159973145
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3926773071289062
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2708637714385986
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2119359970092773
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.299065113067627
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1977653503417969
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2931585311889648
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.2615962028503418
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.289454460144043
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.3688781261444092
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.874 Test Loss: 0.385 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 66 cost time: 1.1862642765045166
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 67 cost time: 1.4575817584991455
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 68 cost time: 1.3396620750427246
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.878 Test Loss: 0.380 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 69 cost time: 1.4106647968292236
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 70 cost time: 1.6002883911132812
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.881 Test Loss: 0.379 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 71 cost time: 1.4039981365203857
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.881 Test Loss: 0.379 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4268786907196045
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.881 Test Loss: 0.378 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 73 cost time: 1.4083428382873535
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.881 Test Loss: 0.377 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 74 cost time: 1.5229778289794922
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 75 cost time: 1.2945506572723389
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 76 cost time: 1.44091796875
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 77 cost time: 1.2324368953704834
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 78 cost time: 1.3408246040344238
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 79 cost time: 1.4423589706420898
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.3356378078460693
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.365879774093628
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.345294713973999
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.3110804557800293
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.2904002666473389
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.2185556888580322
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.2864646911621094
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.308175802230835
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.355203628540039
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7543156147003174
Epoch: 1, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.893 Vali Acc: 0.156 Test Loss: 1.893 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.1674144268035889
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.882 Vali Acc: 0.163 Test Loss: 1.882 Test Acc: 0.163
Validation loss decreased (-0.155537 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 1.2901685237884521
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.847 Vali Acc: 0.174 Test Loss: 1.847 Test Acc: 0.174
Validation loss decreased (-0.162944 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 1.5070445537567139
Epoch: 4, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.768 Vali Acc: 0.263 Test Loss: 1.768 Test Acc: 0.263
Validation loss decreased (-0.174056 --> -0.262945).  Saving model ...
Epoch: 5 cost time: 1.3426260948181152
Epoch: 5, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.669 Vali Acc: 0.363 Test Loss: 1.669 Test Acc: 0.363
Validation loss decreased (-0.262945 --> -0.362946).  Saving model ...
Epoch: 6 cost time: 1.3082308769226074
Epoch: 6, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.556 Vali Acc: 0.478 Test Loss: 1.556 Test Acc: 0.478
Validation loss decreased (-0.362946 --> -0.477762).  Saving model ...
Epoch: 7 cost time: 1.1208336353302002
Epoch: 7, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.434 Vali Acc: 0.541 Test Loss: 1.434 Test Acc: 0.541
Validation loss decreased (-0.477762 --> -0.540726).  Saving model ...
Epoch: 8 cost time: 1.3246979713439941
Epoch: 8, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.310 Vali Acc: 0.589 Test Loss: 1.310 Test Acc: 0.589
Validation loss decreased (-0.540726 --> -0.588876).  Saving model ...
Epoch: 9 cost time: 1.3451225757598877
Epoch: 9, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.191 Vali Acc: 0.637 Test Loss: 1.191 Test Acc: 0.637
Validation loss decreased (-0.588876 --> -0.637025).  Saving model ...
Epoch: 10 cost time: 1.2952823638916016
Epoch: 10, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.083 Vali Acc: 0.678 Test Loss: 1.083 Test Acc: 0.678
Validation loss decreased (-0.637025 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 1.4856524467468262
Epoch: 11, Steps: 2 | Train Loss: 1.207 Vali Loss: 0.977 Vali Acc: 0.715 Test Loss: 0.977 Test Acc: 0.715
Validation loss decreased (-0.677767 --> -0.714805).  Saving model ...
Epoch: 12 cost time: 1.2035109996795654
Epoch: 12, Steps: 2 | Train Loss: 1.132 Vali Loss: 0.878 Vali Acc: 0.733 Test Loss: 0.878 Test Acc: 0.733
Validation loss decreased (-0.714805 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 1.4456744194030762
Epoch: 13, Steps: 2 | Train Loss: 1.080 Vali Loss: 0.784 Vali Acc: 0.793 Test Loss: 0.784 Test Acc: 0.793
Validation loss decreased (-0.733325 --> -0.792585).  Saving model ...
Epoch: 14 cost time: 1.123239278793335
Epoch: 14, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.695 Vali Acc: 0.841 Test Loss: 0.695 Test Acc: 0.841
Validation loss decreased (-0.792585 --> -0.840734).  Saving model ...
Epoch: 15 cost time: 1.3485472202301025
Epoch: 15, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.616 Vali Acc: 0.859 Test Loss: 0.616 Test Acc: 0.859
Validation loss decreased (-0.840734 --> -0.859253).  Saving model ...
Epoch: 16 cost time: 1.492520809173584
Epoch: 16, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.548 Vali Acc: 0.870 Test Loss: 0.548 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 17 cost time: 1.3860094547271729
Epoch: 17, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.487 Vali Acc: 0.881 Test Loss: 0.487 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881477).  Saving model ...
Epoch: 18 cost time: 1.1718206405639648
Epoch: 18, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.444 Vali Acc: 0.867 Test Loss: 0.444 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.340789556503296
Epoch: 19, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.397 Vali Acc: 0.881 Test Loss: 0.397 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881478).  Saving model ...
Epoch: 20 cost time: 1.6224861145019531
Epoch: 20, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.367 Vali Acc: 0.881 Test Loss: 0.367 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 21 cost time: 1.2952892780303955
Epoch: 21, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.343 Vali Acc: 0.881 Test Loss: 0.343 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 22 cost time: 1.5216577053070068
Epoch: 22, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.321 Vali Acc: 0.904 Test Loss: 0.321 Test Acc: 0.904
Validation loss decreased (-0.881478 --> -0.903700).  Saving model ...
Epoch: 23 cost time: 1.5064194202423096
Epoch: 23, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.302 Vali Acc: 0.904 Test Loss: 0.302 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 24 cost time: 1.6051363945007324
Epoch: 24, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 25 cost time: 1.5139179229736328
Epoch: 25, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.248 Vali Acc: 0.915 Test Loss: 0.248 Test Acc: 0.915
Validation loss decreased (-0.907405 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 1.410097360610962
Epoch: 26, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 1.4721457958221436
Epoch: 27, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 1.3807494640350342
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.464475393295288
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 1.3513274192810059
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.340216875076294
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2899587154388428
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3066542148590088
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3967783451080322
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5267143249511719
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4482645988464355
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2979283332824707
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.284024953842163
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 1.412433385848999
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 1.4144439697265625
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 1.380303144454956
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 1.5214016437530518
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 1.5022640228271484
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 1.3104419708251953
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 1.4224672317504883
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5284149646759033
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4451842308044434
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3045358657836914
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.373154640197754
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.267637014389038
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2534363269805908
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2788832187652588
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3381059169769287
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2859339714050293
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1849865913391113
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.822 Vali Acc: 0.237 Test Loss: 1.822 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 1.2780427932739258
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.814 Vali Acc: 0.241 Test Loss: 1.814 Test Acc: 0.241
Validation loss decreased (-0.237019 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 1.4359121322631836
Epoch: 3, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.774 Vali Acc: 0.296 Test Loss: 1.774 Test Acc: 0.296
Validation loss decreased (-0.240723 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 1.2425050735473633
Epoch: 4, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.677 Vali Acc: 0.400 Test Loss: 1.677 Test Acc: 0.400
Validation loss decreased (-0.296279 --> -0.399983).  Saving model ...
Epoch: 5 cost time: 1.3006691932678223
Epoch: 5, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499984).  Saving model ...
Epoch: 6 cost time: 1.3786587715148926
Epoch: 6, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.423 Vali Acc: 0.589 Test Loss: 1.423 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.2978227138519287
Epoch: 7, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.283 Vali Acc: 0.648 Test Loss: 1.283 Test Acc: 0.648
Validation loss decreased (-0.588875 --> -0.648135).  Saving model ...
Epoch: 8 cost time: 1.486806869506836
Epoch: 8, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.150 Vali Acc: 0.711 Test Loss: 1.150 Test Acc: 0.711
Validation loss decreased (-0.648135 --> -0.711100).  Saving model ...
Epoch: 9 cost time: 1.5332369804382324
Epoch: 9, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.029 Vali Acc: 0.737 Test Loss: 1.029 Test Acc: 0.737
Validation loss decreased (-0.711100 --> -0.737027).  Saving model ...
Epoch: 10 cost time: 1.2181472778320312
Epoch: 10, Steps: 2 | Train Loss: 1.455 Vali Loss: 0.922 Vali Acc: 0.759 Test Loss: 0.922 Test Acc: 0.759
Validation loss decreased (-0.737027 --> -0.759250).  Saving model ...
Epoch: 11 cost time: 1.258897304534912
Epoch: 11, Steps: 2 | Train Loss: 1.300 Vali Loss: 0.826 Vali Acc: 0.789 Test Loss: 0.826 Test Acc: 0.789
Validation loss decreased (-0.759250 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.4054605960845947
Epoch: 12, Steps: 2 | Train Loss: 1.212 Vali Loss: 0.741 Vali Acc: 0.826 Test Loss: 0.741 Test Acc: 0.826
Validation loss decreased (-0.788881 --> -0.825919).  Saving model ...
Epoch: 13 cost time: 1.2732224464416504
Epoch: 13, Steps: 2 | Train Loss: 1.131 Vali Loss: 0.663 Vali Acc: 0.859 Test Loss: 0.663 Test Acc: 0.859
Validation loss decreased (-0.825919 --> -0.859253).  Saving model ...
Epoch: 14 cost time: 1.1429963111877441
Epoch: 14, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.593 Vali Acc: 0.874 Test Loss: 0.593 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 1.3452558517456055
Epoch: 15, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.537 Vali Acc: 0.874 Test Loss: 0.537 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874069).  Saving model ...
Epoch: 16 cost time: 1.3763062953948975
Epoch: 16, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1503021717071533
Epoch: 17, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2830545902252197
Epoch: 18, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.436 Vali Acc: 0.837 Test Loss: 0.436 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4474897384643555
Epoch: 19, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3845329284667969
Epoch: 20, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3046677112579346
Epoch: 21, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.374 Vali Acc: 0.852 Test Loss: 0.374 Test Acc: 0.852
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2707302570343018
Epoch: 22, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877774).  Saving model ...
Epoch: 23 cost time: 1.28663969039917
Epoch: 23, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
Validation loss decreased (-0.877774 --> -0.896293).  Saving model ...
Epoch: 24 cost time: 1.6711363792419434
Epoch: 24, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.263 Vali Acc: 0.904 Test Loss: 0.263 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903701).  Saving model ...
Epoch: 25 cost time: 1.4736967086791992
Epoch: 25, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.903701 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.4200148582458496
Epoch: 26, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 1.406299114227295
Epoch: 27, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2845029830932617
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2591698169708252
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2356679439544678
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.915 Test Loss: 0.249 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2626004219055176
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2629194259643555
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2192418575286865
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3037121295928955
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.306767463684082
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.926 Test Loss: 0.268 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2387356758117676
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0420408248901367
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2530641555786133
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.2343862056732178
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.191225290298462
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.2618391513824463
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.1932387351989746
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1040663719177246
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.1225130558013916
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.1574268341064453
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.1972107887268066
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1874122619628906
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.139150619506836
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.1523771286010742
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.154245376586914
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.3252971172332764
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.1419081687927246
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0000698566436768
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.2661371231079102
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4503579139709473
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2361340522766113
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1985507011413574
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4266948699951172
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2298202514648438
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.432166337966919
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4044721126556396
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.4605388641357422
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.3219408988952637
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.738494873046875
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.2452189922332764
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.321465015411377
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2964129447937012
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2901487350463867
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.3912625312805176
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.344031572341919
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.253669261932373
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3209962844848633
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3523609638214111
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3752400875091553
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.3536043167114258
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3614778518676758
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.417238473892212
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2872798442840576
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4271419048309326
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.271167278289795
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1979005336761475
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2733204364776611
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2809603214263916
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.291151523590088
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2424051761627197
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.2569160461425781
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.1646804809570312
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1644995212554932
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.2316758632659912
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.2298583984375
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.2501976490020752
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2594330310821533
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.2993838787078857
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.4123022556304932
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.5532586574554443
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.515871286392212
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3737990856170654
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.465088129043579
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.531057596206665
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2338542938232422
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.4868192672729492
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.4328439235687256
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.4391109943389893
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3687849044799805
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.2723073959350586
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.4314937591552734
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.3776602745056152
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.2430939674377441
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.431929111480713
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.599353313446045
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4372477531433105
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.5758821964263916
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.4610345363616943
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.661891222000122
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 1.5074491500854492
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.6858105659484863
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.4093527793884277
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.6835243701934814
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.6597166061401367
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.3882579803466797
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.6267900466918945
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.3683052062988281
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.4760828018188477
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.3580224514007568
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.4392273426055908
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.5855426788330078
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.614013433456421
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.4045319557189941
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.5923187732696533
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.5180566310882568
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.5836799144744873
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.3465707302093506
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.345921277999878
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.3870058059692383
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.7573051452636719
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.4048631191253662
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 2605830
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0046498775482178
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.862 Vali Acc: 0.204 Test Loss: 1.862 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 1.1638922691345215
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.808 Vali Acc: 0.274 Test Loss: 1.808 Test Acc: 0.274
Validation loss decreased (-0.203685 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 1.2900161743164062
Epoch: 3, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.739 Vali Acc: 0.319 Test Loss: 1.739 Test Acc: 0.319
Validation loss decreased (-0.274056 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 1.3605899810791016
Epoch: 4, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.628 Vali Acc: 0.437 Test Loss: 1.628 Test Acc: 0.437
Validation loss decreased (-0.318501 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 1.5610511302947998
Epoch: 5, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.494 Vali Acc: 0.548 Test Loss: 1.494 Test Acc: 0.548
Validation loss decreased (-0.437021 --> -0.548133).  Saving model ...
Epoch: 6 cost time: 1.401510238647461
Epoch: 6, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.352 Vali Acc: 0.637 Test Loss: 1.352 Test Acc: 0.637
Validation loss decreased (-0.548133 --> -0.637024).  Saving model ...
Epoch: 7 cost time: 1.2703206539154053
Epoch: 7, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.208 Vali Acc: 0.733 Test Loss: 1.208 Test Acc: 0.733
Validation loss decreased (-0.637024 --> -0.733321).  Saving model ...
Epoch: 8 cost time: 1.2954487800598145
Epoch: 8, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
Validation loss decreased (-0.733321 --> -0.755545).  Saving model ...
Epoch: 9 cost time: 1.3355271816253662
Epoch: 9, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.954 Vali Acc: 0.781 Test Loss: 0.954 Test Acc: 0.781
Validation loss decreased (-0.755545 --> -0.781472).  Saving model ...
Epoch: 10 cost time: 1.4048876762390137
Epoch: 10, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.853 Vali Acc: 0.785 Test Loss: 0.853 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785177).  Saving model ...
Epoch: 11 cost time: 1.3751494884490967
Epoch: 11, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.772 Vali Acc: 0.789 Test Loss: 0.772 Test Acc: 0.789
Validation loss decreased (-0.785177 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 1.4341692924499512
Epoch: 12, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.711 Vali Acc: 0.793 Test Loss: 0.711 Test Acc: 0.793
Validation loss decreased (-0.788881 --> -0.792585).  Saving model ...
Epoch: 13 cost time: 1.3447020053863525
Epoch: 13, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2627370357513428
Epoch: 14, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.226637363433838
Epoch: 15, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 16 cost time: 1.1804940700531006
Epoch: 16, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.587 Vali Acc: 0.807 Test Loss: 0.587 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 17 cost time: 1.2027478218078613
Epoch: 17, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.807402 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.1555125713348389
Epoch: 18, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1744663715362549
Epoch: 19, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1804122924804688
Epoch: 20, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3282732963562012
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.830 Test Loss: 0.548 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829624).  Saving model ...
Epoch: 22 cost time: 1.2666957378387451
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.545 Vali Acc: 0.837 Test Loss: 0.545 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837032).  Saving model ...
Epoch: 23 cost time: 1.2563674449920654
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 24 cost time: 1.1975274085998535
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 25 cost time: 1.2107224464416504
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 26 cost time: 1.271545648574829
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 1.274754285812378
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 1.2398262023925781
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 29 cost time: 1.1249513626098633
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 30 cost time: 1.3702595233917236
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 31 cost time: 1.2480146884918213
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 32 cost time: 1.17848539352417
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 33 cost time: 1.0770955085754395
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 34 cost time: 1.2997016906738281
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 35 cost time: 1.216055154800415
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 36 cost time: 1.354541540145874
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 37 cost time: 1.4026155471801758
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 38 cost time: 1.3616397380828857
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 39 cost time: 1.4440717697143555
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 40 cost time: 1.3682358264923096
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 41 cost time: 1.3606643676757812
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 42 cost time: 1.4783272743225098
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 43 cost time: 1.251777172088623
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 44 cost time: 1.6689367294311523
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.852 Test Loss: 0.517 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 45 cost time: 1.3915190696716309
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.852 Test Loss: 0.515 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 46 cost time: 1.4504847526550293
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.852 Test Loss: 0.513 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 47 cost time: 1.458993911743164
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.852 Test Loss: 0.512 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 48 cost time: 1.838352918624878
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.852 Test Loss: 0.511 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 49 cost time: 1.357304334640503
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.852 Test Loss: 0.509 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 50 cost time: 1.3468163013458252
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.852 Test Loss: 0.508 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 51 cost time: 1.4566893577575684
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.852 Test Loss: 0.507 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 52 cost time: 1.2118942737579346
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.852 Test Loss: 0.506 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 53 cost time: 1.2115988731384277
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.852 Test Loss: 0.505 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 54 cost time: 1.3540806770324707
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.852 Test Loss: 0.504 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 55 cost time: 1.4294593334197998
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.852 Test Loss: 0.503 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 56 cost time: 1.4741613864898682
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855551).  Saving model ...
Epoch: 57 cost time: 1.4187495708465576
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 58 cost time: 1.4947905540466309
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 59 cost time: 1.589346170425415
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 60 cost time: 1.5001602172851562
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 61 cost time: 1.4282011985778809
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 62 cost time: 1.4422862529754639
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 63 cost time: 1.3820414543151855
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 64 cost time: 1.334522008895874
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 65 cost time: 1.502028226852417
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 66 cost time: 1.4417240619659424
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 67 cost time: 1.3613879680633545
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 68 cost time: 1.2531459331512451
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 69 cost time: 1.4682998657226562
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 70 cost time: 1.176375389099121
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 71 cost time: 1.2438561916351318
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 72 cost time: 1.2231402397155762
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 73 cost time: 1.2557082176208496
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 74 cost time: 1.3539140224456787
Epoch: 74, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 75 cost time: 1.2989485263824463
Epoch: 75, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 76 cost time: 1.4871387481689453
Epoch: 76, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.874 Test Loss: 0.484 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874069).  Saving model ...
Epoch: 77 cost time: 1.416929006576538
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.874 Test Loss: 0.483 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 78 cost time: 1.3247087001800537
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.874 Test Loss: 0.482 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 79 cost time: 1.3230271339416504
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.874 Test Loss: 0.481 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 80 cost time: 1.2082905769348145
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.874 Test Loss: 0.481 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 81 cost time: 1.3003807067871094
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.874 Test Loss: 0.480 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 82 cost time: 1.1831471920013428
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.874 Test Loss: 0.479 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 83 cost time: 1.1951966285705566
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.874 Test Loss: 0.478 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 84 cost time: 1.2519445419311523
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.874 Test Loss: 0.478 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 85 cost time: 1.3161957263946533
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.874 Test Loss: 0.477 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 86 cost time: 1.398162841796875
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.874 Test Loss: 0.476 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 87 cost time: 1.238049030303955
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.874 Test Loss: 0.475 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 88 cost time: 1.1999878883361816
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.874 Test Loss: 0.475 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 89 cost time: 1.177675724029541
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 90 cost time: 1.1901524066925049
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 91 cost time: 1.2657148838043213
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 92 cost time: 1.3161885738372803
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 93 cost time: 1.2980797290802002
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 94 cost time: 1.37577223777771
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 95 cost time: 1.2918732166290283
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 96 cost time: 1.3567276000976562
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 97 cost time: 1.2078673839569092
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 98 cost time: 1.449340581893921
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.878 Test Loss: 0.468 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 99 cost time: 1.320307970046997
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 100 cost time: 1.321411371231079
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8653981685638428
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.862 Vali Acc: 0.211 Test Loss: 1.862 Test Acc: 0.211
Validation loss decreased (inf --> -0.211092).  Saving model ...
Epoch: 2 cost time: 1.2780036926269531
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.820 Vali Acc: 0.244 Test Loss: 1.820 Test Acc: 0.244
Validation loss decreased (-0.211092 --> -0.244426).  Saving model ...
Epoch: 3 cost time: 1.270233392715454
Epoch: 3, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.767 Vali Acc: 0.274 Test Loss: 1.767 Test Acc: 0.274
Validation loss decreased (-0.244426 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 1.1611034870147705
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.682 Vali Acc: 0.337 Test Loss: 1.682 Test Acc: 0.337
Validation loss decreased (-0.274056 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 1.133450984954834
Epoch: 5, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.578 Vali Acc: 0.441 Test Loss: 1.578 Test Acc: 0.441
Validation loss decreased (-0.337020 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 1.2241709232330322
Epoch: 6, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.468 Vali Acc: 0.526 Test Loss: 1.468 Test Acc: 0.526
Validation loss decreased (-0.440725 --> -0.525911).  Saving model ...
Epoch: 7 cost time: 1.0250585079193115
Epoch: 7, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.355 Vali Acc: 0.570 Test Loss: 1.355 Test Acc: 0.570
Validation loss decreased (-0.525911 --> -0.570357).  Saving model ...
Epoch: 8 cost time: 1.2555902004241943
Epoch: 8, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.245 Vali Acc: 0.619 Test Loss: 1.245 Test Acc: 0.619
Validation loss decreased (-0.570357 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 1.1791832447052002
Epoch: 9, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.142 Vali Acc: 0.678 Test Loss: 1.142 Test Acc: 0.678
Validation loss decreased (-0.618506 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 1.3584039211273193
Epoch: 10, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.050 Vali Acc: 0.696 Test Loss: 1.050 Test Acc: 0.696
Validation loss decreased (-0.677766 --> -0.696286).  Saving model ...
Epoch: 11 cost time: 1.2751166820526123
Epoch: 11, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.973 Vali Acc: 0.704 Test Loss: 0.973 Test Acc: 0.704
Validation loss decreased (-0.696286 --> -0.703694).  Saving model ...
Epoch: 12 cost time: 1.3350999355316162
Epoch: 12, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.912 Vali Acc: 0.707 Test Loss: 0.912 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 13 cost time: 1.1408991813659668
Epoch: 13, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.868 Vali Acc: 0.715 Test Loss: 0.868 Test Acc: 0.715
Validation loss decreased (-0.707398 --> -0.714806).  Saving model ...
Epoch: 14 cost time: 1.137298822402954
Epoch: 14, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
Validation loss decreased (-0.714806 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 1.1944057941436768
Epoch: 15, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 16 cost time: 1.2920475006103516
Epoch: 16, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 17 cost time: 1.3021690845489502
Epoch: 17, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.718 Vali Acc: 0.748 Test Loss: 0.718 Test Acc: 0.748
Validation loss decreased (-0.733326 --> -0.748141).  Saving model ...
Epoch: 18 cost time: 1.309516429901123
Epoch: 18, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
Validation loss decreased (-0.748141 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.0752103328704834
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.673 Vali Acc: 0.785 Test Loss: 0.673 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785178).  Saving model ...
Epoch: 20 cost time: 1.3093714714050293
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 1.28891921043396
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 1.2273938655853271
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.630 Vali Acc: 0.793 Test Loss: 0.630 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 23 cost time: 1.2304043769836426
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.793 Test Loss: 0.619 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 24 cost time: 1.3009846210479736
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 25 cost time: 1.1790955066680908
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 1.3444623947143555
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 1.4445321559906006
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 28 cost time: 1.2726240158081055
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.807 Test Loss: 0.582 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807402).  Saving model ...
Epoch: 29 cost time: 1.3793225288391113
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814809).  Saving model ...
Epoch: 30 cost time: 1.224205732345581
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 31 cost time: 1.208683729171753
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 32 cost time: 1.2411167621612549
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 33 cost time: 1.2320847511291504
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 34 cost time: 1.2767083644866943
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.830 Test Loss: 0.558 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 35 cost time: 1.3053996562957764
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.830 Test Loss: 0.555 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 36 cost time: 1.315507173538208
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 37 cost time: 1.1874992847442627
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.830 Test Loss: 0.550 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 38 cost time: 1.2134013175964355
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 1.1697134971618652
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 40 cost time: 1.305997371673584
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.2237911224365234
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.2791516780853271
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 43 cost time: 1.208275318145752
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 44 cost time: 1.2163550853729248
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 45 cost time: 1.1472318172454834
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.1867878437042236
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 47 cost time: 1.1024401187896729
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 48 cost time: 1.4267535209655762
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.837 Test Loss: 0.528 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 49 cost time: 1.2608864307403564
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.837 Test Loss: 0.527 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 50 cost time: 1.1591434478759766
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.837 Test Loss: 0.525 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 51 cost time: 1.3693618774414062
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.837 Test Loss: 0.524 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 52 cost time: 1.2455813884735107
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.837 Test Loss: 0.523 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 53 cost time: 1.2626209259033203
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.837 Test Loss: 0.522 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 54 cost time: 1.230595350265503
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 55 cost time: 1.1357793807983398
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 56 cost time: 1.2566394805908203
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 57 cost time: 1.3328094482421875
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 58 cost time: 1.1168336868286133
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 59 cost time: 1.1625862121582031
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 60 cost time: 1.3039228916168213
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 61 cost time: 1.387861967086792
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 62 cost time: 1.229745864868164
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 63 cost time: 1.4023182392120361
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.3231537342071533
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 65 cost time: 1.2343649864196777
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 66 cost time: 1.2502374649047852
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 67 cost time: 1.118509292602539
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.852 Test Loss: 0.503 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 68 cost time: 1.2037208080291748
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.852 Test Loss: 0.502 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 69 cost time: 1.327505111694336
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.852 Test Loss: 0.501 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 70 cost time: 1.1220200061798096
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.852 Test Loss: 0.500 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 71 cost time: 1.334026575088501
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859254).  Saving model ...
Epoch: 72 cost time: 1.3568146228790283
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 73 cost time: 1.352841854095459
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 74 cost time: 1.3263967037200928
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 75 cost time: 1.3235554695129395
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 76 cost time: 1.2644824981689453
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 77 cost time: 1.274947166442871
Epoch: 77, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 78 cost time: 1.2707819938659668
Epoch: 78, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 79 cost time: 1.3667466640472412
Epoch: 79, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 80 cost time: 1.4372146129608154
Epoch: 80, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 81 cost time: 1.3770225048065186
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 82 cost time: 1.3519718647003174
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 83 cost time: 1.3138947486877441
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 84 cost time: 1.3680243492126465
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 85 cost time: 1.3608770370483398
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 86 cost time: 1.2817602157592773
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 87 cost time: 1.5407915115356445
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 88 cost time: 1.2507238388061523
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 89 cost time: 1.2250607013702393
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 90 cost time: 1.193554401397705
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 91 cost time: 1.117363452911377
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 92 cost time: 1.1089582443237305
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 93 cost time: 1.3184270858764648
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 1.238325595855713
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.1756703853607178
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.462693691253662
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 97 cost time: 1.1702933311462402
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 98 cost time: 1.2452092170715332
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 99 cost time: 1.2409603595733643
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 100 cost time: 1.1261906623840332
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1729254722595215
Epoch: 1, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.885 Vali Acc: 0.204 Test Loss: 1.885 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 1.274263858795166
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.849 Vali Acc: 0.207 Test Loss: 1.849 Test Acc: 0.207
Validation loss decreased (-0.203685 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 1.3536629676818848
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.804 Vali Acc: 0.230 Test Loss: 1.804 Test Acc: 0.230
Validation loss decreased (-0.207389 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 1.1554949283599854
Epoch: 4, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.735 Vali Acc: 0.289 Test Loss: 1.735 Test Acc: 0.289
Validation loss decreased (-0.229612 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 1.1569125652313232
Epoch: 5, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.652 Vali Acc: 0.370 Test Loss: 1.652 Test Acc: 0.370
Validation loss decreased (-0.288872 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 1.0673372745513916
Epoch: 6, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.565 Vali Acc: 0.470 Test Loss: 1.565 Test Acc: 0.470
Validation loss decreased (-0.370354 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 1.189572811126709
Epoch: 7, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.476 Vali Acc: 0.530 Test Loss: 1.476 Test Acc: 0.530
Validation loss decreased (-0.470355 --> -0.529615).  Saving model ...
Epoch: 8 cost time: 1.2145800590515137
Epoch: 8, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.387 Vali Acc: 0.544 Test Loss: 1.387 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544431).  Saving model ...
Epoch: 9 cost time: 1.1242170333862305
Epoch: 9, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.299 Vali Acc: 0.581 Test Loss: 1.299 Test Acc: 0.581
Validation loss decreased (-0.544431 --> -0.581468).  Saving model ...
Epoch: 10 cost time: 1.2158074378967285
Epoch: 10, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.216 Vali Acc: 0.607 Test Loss: 1.216 Test Acc: 0.607
Validation loss decreased (-0.581468 --> -0.607395).  Saving model ...
Epoch: 11 cost time: 1.370177984237671
Epoch: 11, Steps: 2 | Train Loss: 0.688 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
Validation loss decreased (-0.607395 --> -0.622211).  Saving model ...
Epoch: 12 cost time: 1.162637710571289
Epoch: 12, Steps: 2 | Train Loss: 0.496 Vali Loss: 1.074 Vali Acc: 0.652 Test Loss: 1.074 Test Acc: 0.652
Validation loss decreased (-0.622211 --> -0.651841).  Saving model ...
Epoch: 13 cost time: 1.2163035869598389
Epoch: 13, Steps: 2 | Train Loss: 0.432 Vali Loss: 1.025 Vali Acc: 0.663 Test Loss: 1.025 Test Acc: 0.663
Validation loss decreased (-0.651841 --> -0.662953).  Saving model ...
Epoch: 14 cost time: 1.2367749214172363
Epoch: 14, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.976 Vali Acc: 0.685 Test Loss: 0.976 Test Acc: 0.685
Validation loss decreased (-0.662953 --> -0.685175).  Saving model ...
Epoch: 15 cost time: 1.2966837882995605
Epoch: 15, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.931 Vali Acc: 0.711 Test Loss: 0.931 Test Acc: 0.711
Validation loss decreased (-0.685175 --> -0.711102).  Saving model ...
Epoch: 16 cost time: 1.2750942707061768
Epoch: 16, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 1.1795423030853271
Epoch: 17, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.852 Vali Acc: 0.719 Test Loss: 0.852 Test Acc: 0.719
Validation loss decreased (-0.711102 --> -0.718510).  Saving model ...
Epoch: 18 cost time: 1.3074746131896973
Epoch: 18, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.822 Vali Acc: 0.737 Test Loss: 0.822 Test Acc: 0.737
Validation loss decreased (-0.718510 --> -0.737029).  Saving model ...
Epoch: 19 cost time: 1.336291790008545
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
Validation loss decreased (-0.737029 --> -0.759251).  Saving model ...
Epoch: 20 cost time: 1.352182149887085
Epoch: 20, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4914779663085938
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.751 Vali Acc: 0.759 Test Loss: 0.751 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759252).  Saving model ...
Epoch: 22 cost time: 1.4245193004608154
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 23 cost time: 1.1544857025146484
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 1.1750333309173584
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.778 Test Loss: 0.710 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 25 cost time: 1.2138316631317139
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.781 Test Loss: 0.699 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 26 cost time: 1.1863515377044678
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.785 Test Loss: 0.688 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 27 cost time: 1.2594883441925049
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.796 Test Loss: 0.680 Test Acc: 0.796
Validation loss decreased (-0.785178 --> -0.796289).  Saving model ...
Epoch: 28 cost time: 1.2340238094329834
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 1.1940648555755615
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.807 Test Loss: 0.666 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807401).  Saving model ...
Epoch: 30 cost time: 1.2415416240692139
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 31 cost time: 1.325089454650879
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 1.4711177349090576
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 33 cost time: 1.1680693626403809
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.815 Test Loss: 0.644 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 34 cost time: 1.3122670650482178
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.815 Test Loss: 0.640 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 35 cost time: 1.3764009475708008
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 36 cost time: 1.2437148094177246
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 37 cost time: 1.390181303024292
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 38 cost time: 1.4304745197296143
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
Validation loss decreased (-0.818512 --> -0.825920).  Saving model ...
Epoch: 39 cost time: 1.3383111953735352
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 40 cost time: 1.3213262557983398
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.826 Test Loss: 0.622 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 41 cost time: 1.2293734550476074
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.826 Test Loss: 0.620 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 42 cost time: 1.3501300811767578
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 43 cost time: 1.3271172046661377
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.826 Test Loss: 0.615 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 44 cost time: 1.2370140552520752
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 45 cost time: 1.300199031829834
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833327).  Saving model ...
Epoch: 46 cost time: 1.3093476295471191
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 47 cost time: 1.4168667793273926
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.837 Test Loss: 0.607 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 48 cost time: 1.1570217609405518
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.837 Test Loss: 0.605 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 49 cost time: 1.393444299697876
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 50 cost time: 1.1859211921691895
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 51 cost time: 1.3176548480987549
Epoch: 51, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 52 cost time: 1.237560749053955
Epoch: 52, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 53 cost time: 1.2156143188476562
Epoch: 53, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 54 cost time: 1.3213083744049072
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 55 cost time: 1.3859162330627441
Epoch: 55, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 56 cost time: 1.351259708404541
Epoch: 56, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 57 cost time: 1.2585158348083496
Epoch: 57, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 58 cost time: 1.3196263313293457
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 59 cost time: 1.316500186920166
Epoch: 59, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 60 cost time: 1.1570277214050293
Epoch: 60, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 61 cost time: 1.192979335784912
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 62 cost time: 1.2279984951019287
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 63 cost time: 1.1691679954528809
Epoch: 63, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 64 cost time: 1.1792266368865967
Epoch: 64, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 65 cost time: 1.2210540771484375
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 66 cost time: 1.1787948608398438
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.841 Test Loss: 0.579 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 67 cost time: 1.3221278190612793
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 68 cost time: 1.3765149116516113
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 69 cost time: 1.3684322834014893
Epoch: 69, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 70 cost time: 1.3139619827270508
Epoch: 70, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 71 cost time: 1.31974458694458
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 72 cost time: 1.5012292861938477
Epoch: 72, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 73 cost time: 1.3786835670471191
Epoch: 73, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 74 cost time: 1.3902912139892578
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 75 cost time: 1.4408879280090332
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 76 cost time: 1.4871935844421387
Epoch: 76, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 77 cost time: 1.3417086601257324
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 78 cost time: 1.2134413719177246
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 79 cost time: 1.0996124744415283
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 80 cost time: 1.2758169174194336
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 81 cost time: 1.3941683769226074
Epoch: 81, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 82 cost time: 1.359398603439331
Epoch: 82, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 83 cost time: 1.3995256423950195
Epoch: 83, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 84 cost time: 1.2915456295013428
Epoch: 84, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 85 cost time: 1.527717113494873
Epoch: 85, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 86 cost time: 1.3450424671173096
Epoch: 86, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 87 cost time: 1.424957275390625
Epoch: 87, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 88 cost time: 1.4438705444335938
Epoch: 88, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 89 cost time: 1.4469671249389648
Epoch: 89, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.852 Test Loss: 0.559 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851846).  Saving model ...
Epoch: 90 cost time: 1.456061601638794
Epoch: 90, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
Validation loss decreased (-0.851846 --> -0.859254).  Saving model ...
Epoch: 91 cost time: 1.2894666194915771
Epoch: 91, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.859 Test Loss: 0.557 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 92 cost time: 1.4289495944976807
Epoch: 92, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 93 cost time: 1.4181580543518066
Epoch: 93, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 1.3784387111663818
Epoch: 94, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.4112730026245117
Epoch: 95, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.3196752071380615
Epoch: 96, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.859 Test Loss: 0.552 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 97 cost time: 1.4254114627838135
Epoch: 97, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 98 cost time: 1.3082983493804932
Epoch: 98, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.859 Test Loss: 0.550 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 99 cost time: 1.3601288795471191
Epoch: 99, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 100 cost time: 1.4197781085968018
Epoch: 100, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2056376934051514
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.853 Vali Acc: 0.189 Test Loss: 1.853 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 1.3044745922088623
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.827 Vali Acc: 0.219 Test Loss: 1.827 Test Acc: 0.219
Validation loss decreased (-0.188870 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 1.1915791034698486
Epoch: 3, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.796 Vali Acc: 0.244 Test Loss: 1.796 Test Acc: 0.244
Validation loss decreased (-0.218500 --> -0.244426).  Saving model ...
Epoch: 4 cost time: 1.2325079441070557
Epoch: 4, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.748 Vali Acc: 0.296 Test Loss: 1.748 Test Acc: 0.296
Validation loss decreased (-0.244426 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 1.205524206161499
Epoch: 5, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.688 Vali Acc: 0.378 Test Loss: 1.688 Test Acc: 0.378
Validation loss decreased (-0.296279 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 1.2581195831298828
Epoch: 6, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.627 Vali Acc: 0.407 Test Loss: 1.627 Test Acc: 0.407
Validation loss decreased (-0.377761 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 1.222212791442871
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.563 Vali Acc: 0.430 Test Loss: 1.563 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429614).  Saving model ...
Epoch: 8 cost time: 1.4648046493530273
Epoch: 8, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.499 Vali Acc: 0.481 Test Loss: 1.499 Test Acc: 0.481
Validation loss decreased (-0.429614 --> -0.481466).  Saving model ...
Epoch: 9 cost time: 1.3181407451629639
Epoch: 9, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.432 Vali Acc: 0.504 Test Loss: 1.432 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503689).  Saving model ...
Epoch: 10 cost time: 1.3866686820983887
Epoch: 10, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.367 Vali Acc: 0.526 Test Loss: 1.367 Test Acc: 0.526
Validation loss decreased (-0.503689 --> -0.525912).  Saving model ...
Epoch: 11 cost time: 1.3973383903503418
Epoch: 11, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.304 Vali Acc: 0.548 Test Loss: 1.304 Test Acc: 0.548
Validation loss decreased (-0.525912 --> -0.548135).  Saving model ...
Epoch: 12 cost time: 1.4834983348846436
Epoch: 12, Steps: 2 | Train Loss: 0.703 Vali Loss: 1.243 Vali Acc: 0.563 Test Loss: 1.243 Test Acc: 0.563
Validation loss decreased (-0.548135 --> -0.562951).  Saving model ...
Epoch: 13 cost time: 1.351653814315796
Epoch: 13, Steps: 2 | Train Loss: 0.631 Vali Loss: 1.191 Vali Acc: 0.570 Test Loss: 1.191 Test Acc: 0.570
Validation loss decreased (-0.562951 --> -0.570358).  Saving model ...
Epoch: 14 cost time: 1.1806199550628662
Epoch: 14, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.138 Vali Acc: 0.578 Test Loss: 1.138 Test Acc: 0.578
Validation loss decreased (-0.570358 --> -0.577766).  Saving model ...
Epoch: 15 cost time: 1.169548749923706
Epoch: 15, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.089 Vali Acc: 0.593 Test Loss: 1.089 Test Acc: 0.593
Validation loss decreased (-0.577766 --> -0.592582).  Saving model ...
Epoch: 16 cost time: 1.3041648864746094
Epoch: 16, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.040 Vali Acc: 0.611 Test Loss: 1.040 Test Acc: 0.611
Validation loss decreased (-0.592582 --> -0.611101).  Saving model ...
Epoch: 17 cost time: 1.19246244430542
Epoch: 17, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.999 Vali Acc: 0.611 Test Loss: 0.999 Test Acc: 0.611
Validation loss decreased (-0.611101 --> -0.611101).  Saving model ...
Epoch: 18 cost time: 1.330507516860962
Epoch: 18, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.958 Vali Acc: 0.648 Test Loss: 0.958 Test Acc: 0.648
Validation loss decreased (-0.611101 --> -0.648139).  Saving model ...
Epoch: 19 cost time: 1.2864067554473877
Epoch: 19, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.909 Vali Acc: 0.678 Test Loss: 0.909 Test Acc: 0.678
Validation loss decreased (-0.648139 --> -0.677769).  Saving model ...
Epoch: 20 cost time: 1.454164981842041
Epoch: 20, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.868 Vali Acc: 0.693 Test Loss: 0.868 Test Acc: 0.693
Validation loss decreased (-0.677769 --> -0.692584).  Saving model ...
Epoch: 21 cost time: 1.4518203735351562
Epoch: 21, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.833 Vali Acc: 0.715 Test Loss: 0.833 Test Acc: 0.715
Validation loss decreased (-0.692584 --> -0.714806).  Saving model ...
Epoch: 22 cost time: 1.3193638324737549
Epoch: 22, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.801 Vali Acc: 0.737 Test Loss: 0.801 Test Acc: 0.737
Validation loss decreased (-0.714806 --> -0.737029).  Saving model ...
Epoch: 23 cost time: 1.4390792846679688
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.771 Vali Acc: 0.730 Test Loss: 0.771 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2647705078125
Epoch: 24, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 25 cost time: 1.4451696872711182
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
Validation loss decreased (-0.740733 --> -0.755548).  Saving model ...
Epoch: 26 cost time: 1.399841547012329
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.699 Vali Acc: 0.759 Test Loss: 0.699 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 27 cost time: 1.2643132209777832
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 28 cost time: 1.2781727313995361
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.774 Test Loss: 0.668 Test Acc: 0.774
Validation loss decreased (-0.762956 --> -0.774067).  Saving model ...
Epoch: 29 cost time: 1.3711092472076416
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2993230819702148
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.778 Test Loss: 0.643 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 31 cost time: 1.1784820556640625
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.781 Test Loss: 0.632 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 32 cost time: 1.314171552658081
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788883).  Saving model ...
Epoch: 33 cost time: 1.4549009799957275
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.793 Test Loss: 0.614 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 34 cost time: 1.1740906238555908
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.785 Test Loss: 0.607 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.234515905380249
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1961288452148438
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.793 Test Loss: 0.596 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792587).  Saving model ...
Epoch: 37 cost time: 1.3319108486175537
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.793 Test Loss: 0.592 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 38 cost time: 1.3896467685699463
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799994).  Saving model ...
Epoch: 39 cost time: 1.4297816753387451
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.807 Test Loss: 0.585 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807402).  Saving model ...
Epoch: 40 cost time: 1.4511346817016602
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 41 cost time: 1.354123592376709
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.807 Test Loss: 0.581 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6202235221862793
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.807 Test Loss: 0.579 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4305179119110107
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.807 Test Loss: 0.577 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5097949504852295
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.807 Test Loss: 0.575 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3606483936309814
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.807 Test Loss: 0.573 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6674706935882568
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.807 Test Loss: 0.572 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4147329330444336
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.807 Test Loss: 0.571 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5604498386383057
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.807 Test Loss: 0.570 Test Acc: 0.807
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3099584579467773
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.807 Test Loss: 0.568 Test Acc: 0.807
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3777506351470947
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.807 Test Loss: 0.567 Test Acc: 0.807
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7316102981567383
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.854 Vali Acc: 0.119 Test Loss: 1.854 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 1.327665090560913
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.836 Vali Acc: 0.133 Test Loss: 1.836 Test Acc: 0.133
Validation loss decreased (-0.118500 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 1.19466233253479
Epoch: 3, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.813 Vali Acc: 0.170 Test Loss: 1.813 Test Acc: 0.170
Validation loss decreased (-0.133315 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 1.5227749347686768
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.770 Vali Acc: 0.211 Test Loss: 1.770 Test Acc: 0.211
Validation loss decreased (-0.170352 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 1.1722042560577393
Epoch: 5, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.716 Vali Acc: 0.285 Test Loss: 1.716 Test Acc: 0.285
Validation loss decreased (-0.211093 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 1.426375389099121
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.655 Vali Acc: 0.400 Test Loss: 1.655 Test Acc: 0.400
Validation loss decreased (-0.285168 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 1.2869365215301514
Epoch: 7, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.590 Vali Acc: 0.448 Test Loss: 1.590 Test Acc: 0.448
Validation loss decreased (-0.399983 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 1.4076590538024902
Epoch: 8, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.520 Vali Acc: 0.478 Test Loss: 1.520 Test Acc: 0.478
Validation loss decreased (-0.448132 --> -0.477763).  Saving model ...
Epoch: 9 cost time: 1.2958180904388428
Epoch: 9, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.442 Vali Acc: 0.515 Test Loss: 1.442 Test Acc: 0.515
Validation loss decreased (-0.477763 --> -0.514800).  Saving model ...
Epoch: 10 cost time: 1.4790372848510742
Epoch: 10, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.361 Vali Acc: 0.548 Test Loss: 1.361 Test Acc: 0.548
Validation loss decreased (-0.514800 --> -0.548135).  Saving model ...
Epoch: 11 cost time: 1.268277645111084
Epoch: 11, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.276 Vali Acc: 0.585 Test Loss: 1.276 Test Acc: 0.585
Validation loss decreased (-0.548135 --> -0.585172).  Saving model ...
Epoch: 12 cost time: 1.2678101062774658
Epoch: 12, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.189 Vali Acc: 0.611 Test Loss: 1.189 Test Acc: 0.611
Validation loss decreased (-0.585172 --> -0.611099).  Saving model ...
Epoch: 13 cost time: 1.2094390392303467
Epoch: 13, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.108 Vali Acc: 0.659 Test Loss: 1.108 Test Acc: 0.659
Validation loss decreased (-0.611099 --> -0.659248).  Saving model ...
Epoch: 14 cost time: 1.300358533859253
Epoch: 14, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.029 Vali Acc: 0.685 Test Loss: 1.029 Test Acc: 0.685
Validation loss decreased (-0.659248 --> -0.685175).  Saving model ...
Epoch: 15 cost time: 1.1890411376953125
Epoch: 15, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.956 Vali Acc: 0.707 Test Loss: 0.956 Test Acc: 0.707
Validation loss decreased (-0.685175 --> -0.707398).  Saving model ...
Epoch: 16 cost time: 1.2563562393188477
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.880 Vali Acc: 0.719 Test Loss: 0.880 Test Acc: 0.719
Validation loss decreased (-0.707398 --> -0.718510).  Saving model ...
Epoch: 17 cost time: 1.0967373847961426
Epoch: 17, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.811 Vali Acc: 0.759 Test Loss: 0.811 Test Acc: 0.759
Validation loss decreased (-0.718510 --> -0.759251).  Saving model ...
Epoch: 18 cost time: 1.1362690925598145
Epoch: 18, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.741 Vali Acc: 0.763 Test Loss: 0.741 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762956).  Saving model ...
Epoch: 19 cost time: 1.1473031044006348
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
Validation loss decreased (-0.762956 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 1.246849775314331
Epoch: 20, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 21 cost time: 1.4754652976989746
Epoch: 21, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 22 cost time: 1.2965528964996338
Epoch: 22, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 23 cost time: 1.258629322052002
Epoch: 23, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 24 cost time: 1.299302339553833
Epoch: 24, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818514).  Saving model ...
Epoch: 25 cost time: 1.367828130722046
Epoch: 25, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.470 Vali Acc: 0.830 Test Loss: 0.470 Test Acc: 0.830
Validation loss decreased (-0.818514 --> -0.829625).  Saving model ...
Epoch: 26 cost time: 1.2775352001190186
Epoch: 26, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
Validation loss decreased (-0.829625 --> -0.840736).  Saving model ...
Epoch: 27 cost time: 1.1967206001281738
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.425 Vali Acc: 0.852 Test Loss: 0.425 Test Acc: 0.852
Validation loss decreased (-0.840736 --> -0.851848).  Saving model ...
Epoch: 28 cost time: 1.249819040298462
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.407 Vali Acc: 0.863 Test Loss: 0.407 Test Acc: 0.863
Validation loss decreased (-0.851848 --> -0.862959).  Saving model ...
Epoch: 29 cost time: 1.4458270072937012
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.392 Vali Acc: 0.874 Test Loss: 0.392 Test Acc: 0.874
Validation loss decreased (-0.862959 --> -0.874070).  Saving model ...
Epoch: 30 cost time: 1.259444236755371
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.377 Vali Acc: 0.874 Test Loss: 0.377 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 31 cost time: 1.2212436199188232
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881478).  Saving model ...
Epoch: 32 cost time: 1.2257263660430908
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.885 Test Loss: 0.363 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 33 cost time: 1.2742767333984375
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.361 Vali Acc: 0.885 Test Loss: 0.361 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 34 cost time: 1.1561107635498047
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.881 Test Loss: 0.361 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1385035514831543
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1411223411560059
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.363 Vali Acc: 0.874 Test Loss: 0.363 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3803365230560303
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.874 Test Loss: 0.365 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3067069053649902
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.874 Test Loss: 0.365 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6485908031463623
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.874 Test Loss: 0.363 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3676373958587646
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4518210887908936
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.440309762954712
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.874 Test Loss: 0.358 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3148832321166992
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.874 Test Loss: 0.356 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.994952917098999
Epoch: 1, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.830 Vali Acc: 0.152 Test Loss: 1.830 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 1.1451771259307861
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.819 Vali Acc: 0.156 Test Loss: 1.819 Test Acc: 0.156
Validation loss decreased (-0.151834 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 1.3348360061645508
Epoch: 3, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.787 Vali Acc: 0.222 Test Loss: 1.787 Test Acc: 0.222
Validation loss decreased (-0.155537 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 1.2153704166412354
Epoch: 4, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.713 Vali Acc: 0.293 Test Loss: 1.713 Test Acc: 0.293
Validation loss decreased (-0.222204 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 1.3026697635650635
Epoch: 5, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.619 Vali Acc: 0.415 Test Loss: 1.619 Test Acc: 0.415
Validation loss decreased (-0.292575 --> -0.414799).  Saving model ...
Epoch: 6 cost time: 1.2797112464904785
Epoch: 6, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
Validation loss decreased (-0.414799 --> -0.496281).  Saving model ...
Epoch: 7 cost time: 1.279977560043335
Epoch: 7, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.401 Vali Acc: 0.574 Test Loss: 1.401 Test Acc: 0.574
Validation loss decreased (-0.496281 --> -0.574060).  Saving model ...
Epoch: 8 cost time: 1.3935422897338867
Epoch: 8, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.283 Vali Acc: 0.619 Test Loss: 1.283 Test Acc: 0.619
Validation loss decreased (-0.574060 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 1.3608193397521973
Epoch: 9, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.164 Vali Acc: 0.644 Test Loss: 1.164 Test Acc: 0.644
Validation loss decreased (-0.618506 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 1.4229648113250732
Epoch: 10, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.051 Vali Acc: 0.707 Test Loss: 1.051 Test Acc: 0.707
Validation loss decreased (-0.644433 --> -0.707397).  Saving model ...
Epoch: 11 cost time: 1.5189719200134277
Epoch: 11, Steps: 2 | Train Loss: 1.306 Vali Loss: 0.944 Vali Acc: 0.763 Test Loss: 0.944 Test Acc: 0.763
Validation loss decreased (-0.707397 --> -0.762954).  Saving model ...
Epoch: 12 cost time: 1.6077041625976562
Epoch: 12, Steps: 2 | Train Loss: 1.119 Vali Loss: 0.840 Vali Acc: 0.815 Test Loss: 0.840 Test Acc: 0.815
Validation loss decreased (-0.762954 --> -0.814806).  Saving model ...
Epoch: 13 cost time: 1.4605343341827393
Epoch: 13, Steps: 2 | Train Loss: 1.166 Vali Loss: 0.749 Vali Acc: 0.830 Test Loss: 0.749 Test Acc: 0.830
Validation loss decreased (-0.814806 --> -0.829622).  Saving model ...
Epoch: 14 cost time: 1.3823916912078857
Epoch: 14, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.665 Vali Acc: 0.852 Test Loss: 0.665 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851845).  Saving model ...
Epoch: 15 cost time: 1.3638191223144531
Epoch: 15, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 1.3695781230926514
Epoch: 16, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 1.4981553554534912
Epoch: 17, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870366).  Saving model ...
Epoch: 18 cost time: 1.4714405536651611
Epoch: 18, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.420 Vali Acc: 0.874 Test Loss: 0.420 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 19 cost time: 1.3899104595184326
Epoch: 19, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.368 Vali Acc: 0.904 Test Loss: 0.368 Test Acc: 0.904
Validation loss decreased (-0.874070 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 1.297234058380127
Epoch: 20, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914812).  Saving model ...
Epoch: 21 cost time: 1.2488880157470703
Epoch: 21, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 1.2471091747283936
Epoch: 22, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.206322193145752
Epoch: 23, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4417731761932373
Epoch: 24, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 1.3033051490783691
Epoch: 25, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.4320640563964844
Epoch: 26, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 1.5850727558135986
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.619509220123291
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 1.3323678970336914
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.535811424255371
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.925924 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 1.3157551288604736
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 1.4236369132995605
Epoch: 32, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3795044422149658
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3667354583740234
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.3000316619873047
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3224074840545654
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4309840202331543
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2621238231658936
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 1.405078649520874
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.350900411605835
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1593685150146484
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.245880126953125
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3057587146759033
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2306063175201416
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4028356075286865
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3532447814941406
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.6063697338104248
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3294126987457275
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7881383895874023
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.829 Vali Acc: 0.159 Test Loss: 1.829 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 1.3234052658081055
Epoch: 2, Steps: 2 | Train Loss: 2.016 Vali Loss: 1.820 Vali Acc: 0.163 Test Loss: 1.820 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 1.20090651512146
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.779 Vali Acc: 0.222 Test Loss: 1.779 Test Acc: 0.222
Validation loss decreased (-0.162945 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 1.2486557960510254
Epoch: 4, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.684 Vali Acc: 0.352 Test Loss: 1.684 Test Acc: 0.352
Validation loss decreased (-0.222204 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 1.2816827297210693
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.560 Vali Acc: 0.481 Test Loss: 1.560 Test Acc: 0.481
Validation loss decreased (-0.351835 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 1.3624238967895508
Epoch: 6, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.421 Vali Acc: 0.578 Test Loss: 1.421 Test Acc: 0.578
Validation loss decreased (-0.481466 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 1.3289849758148193
Epoch: 7, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.279 Vali Acc: 0.667 Test Loss: 1.279 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666654).  Saving model ...
Epoch: 8 cost time: 1.3359155654907227
Epoch: 8, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.140 Vali Acc: 0.756 Test Loss: 1.140 Test Acc: 0.756
Validation loss decreased (-0.666654 --> -0.755544).  Saving model ...
Epoch: 9 cost time: 1.1841068267822266
Epoch: 9, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.009 Vali Acc: 0.822 Test Loss: 1.009 Test Acc: 0.822
Validation loss decreased (-0.755544 --> -0.822212).  Saving model ...
Epoch: 10 cost time: 1.396946668624878
Epoch: 10, Steps: 2 | Train Loss: 1.460 Vali Loss: 0.892 Vali Acc: 0.856 Test Loss: 0.892 Test Acc: 0.856
Validation loss decreased (-0.822212 --> -0.855547).  Saving model ...
Epoch: 11 cost time: 1.3042025566101074
Epoch: 11, Steps: 2 | Train Loss: 1.336 Vali Loss: 0.787 Vali Acc: 0.881 Test Loss: 0.787 Test Acc: 0.881
Validation loss decreased (-0.855547 --> -0.881474).  Saving model ...
Epoch: 12 cost time: 1.4705913066864014
Epoch: 12, Steps: 2 | Train Loss: 1.331 Vali Loss: 0.694 Vali Acc: 0.896 Test Loss: 0.694 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896289).  Saving model ...
Epoch: 13 cost time: 1.5036656856536865
Epoch: 13, Steps: 2 | Train Loss: 1.112 Vali Loss: 0.613 Vali Acc: 0.893 Test Loss: 0.613 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.478046178817749
Epoch: 14, Steps: 2 | Train Loss: 1.052 Vali Loss: 0.542 Vali Acc: 0.911 Test Loss: 0.542 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911106).  Saving model ...
Epoch: 15 cost time: 1.2903027534484863
Epoch: 15, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.481 Vali Acc: 0.911 Test Loss: 0.481 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 16 cost time: 1.4354846477508545
Epoch: 16, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 1.4543476104736328
Epoch: 17, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
Validation loss decreased (-0.918514 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 1.495997667312622
Epoch: 18, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.446918249130249
Epoch: 19, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.428342342376709
Epoch: 20, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4932010173797607
Epoch: 21, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3984410762786865
Epoch: 22, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.388880968093872
Epoch: 23, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4296603202819824
Epoch: 24, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.350555419921875
Epoch: 25, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 1.4456250667572021
Epoch: 26, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3287827968597412
Epoch: 27, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3488867282867432
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3542604446411133
Epoch: 29, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 1.4834418296813965
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.516430377960205
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3590087890625
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5654053688049316
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3433337211608887
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.41721510887146
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5641229152679443
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3219940662384033
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3456356525421143
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4264161586761475
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.311051368713379
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.096691846847534
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.250473976135254
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3050847053527832
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2630774974822998
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2886300086975098
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.4543750286102295
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2372205257415771
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1238369941711426
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.205782175064087
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.2564446926116943
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1618375778198242
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1216561794281006
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0995409488677979
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2292060852050781
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.282135248184204
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.310685634613037
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3179666996002197
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4087669849395752
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3534626960754395
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5011203289031982
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 2409222
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.056831121444702
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.910 Vali Acc: 0.115 Test Loss: 1.910 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.371016263961792
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.871 Vali Acc: 0.141 Test Loss: 1.871 Test Acc: 0.141
Validation loss decreased (-0.114796 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.3593332767486572
Epoch: 3, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.820 Vali Acc: 0.181 Test Loss: 1.820 Test Acc: 0.181
Validation loss decreased (-0.140722 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 1.277186632156372
Epoch: 4, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.737 Vali Acc: 0.244 Test Loss: 1.737 Test Acc: 0.244
Validation loss decreased (-0.181463 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 1.4042961597442627
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.634 Vali Acc: 0.389 Test Loss: 1.634 Test Acc: 0.389
Validation loss decreased (-0.244427 --> -0.388873).  Saving model ...
Epoch: 6 cost time: 1.2773654460906982
Epoch: 6, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.523 Vali Acc: 0.493 Test Loss: 1.523 Test Acc: 0.493
Validation loss decreased (-0.388873 --> -0.492577).  Saving model ...
Epoch: 7 cost time: 1.2038748264312744
Epoch: 7, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.402 Vali Acc: 0.611 Test Loss: 1.402 Test Acc: 0.611
Validation loss decreased (-0.492577 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 1.1541368961334229
Epoch: 8, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.285 Vali Acc: 0.685 Test Loss: 1.285 Test Acc: 0.685
Validation loss decreased (-0.611097 --> -0.685172).  Saving model ...
Epoch: 9 cost time: 1.36849045753479
Epoch: 9, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.172 Vali Acc: 0.733 Test Loss: 1.172 Test Acc: 0.733
Validation loss decreased (-0.685172 --> -0.733322).  Saving model ...
Epoch: 10 cost time: 1.2245264053344727
Epoch: 10, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.065 Vali Acc: 0.763 Test Loss: 1.065 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762952).  Saving model ...
Epoch: 11 cost time: 1.195167064666748
Epoch: 11, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.968 Vali Acc: 0.789 Test Loss: 0.968 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788879).  Saving model ...
Epoch: 12 cost time: 1.2443695068359375
Epoch: 12, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.882 Vali Acc: 0.789 Test Loss: 0.882 Test Acc: 0.789
Validation loss decreased (-0.788879 --> -0.788880).  Saving model ...
Epoch: 13 cost time: 1.312713623046875
Epoch: 13, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.808 Vali Acc: 0.800 Test Loss: 0.808 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.4729392528533936
Epoch: 14, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.744 Vali Acc: 0.807 Test Loss: 0.744 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.807400).  Saving model ...
Epoch: 15 cost time: 1.422739028930664
Epoch: 15, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.695 Vali Acc: 0.807 Test Loss: 0.695 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 16 cost time: 1.2662479877471924
Epoch: 16, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 1.3750014305114746
Epoch: 17, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 18 cost time: 1.2770068645477295
Epoch: 18, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 19 cost time: 1.311640977859497
Epoch: 19, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.590 Vali Acc: 0.830 Test Loss: 0.590 Test Acc: 0.830
Validation loss decreased (-0.818512 --> -0.829624).  Saving model ...
Epoch: 20 cost time: 1.4035305976867676
Epoch: 20, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.53279709815979
Epoch: 21, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.530949592590332
Epoch: 22, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.272287368774414
Epoch: 23, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.555 Vali Acc: 0.826 Test Loss: 0.555 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3512530326843262
Epoch: 24, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1393465995788574
Epoch: 25, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2021498680114746
Epoch: 26, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2702703475952148
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.830 Test Loss: 0.546 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 28 cost time: 1.2204806804656982
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.546 Vali Acc: 0.830 Test Loss: 0.546 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.239837646484375
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.830 Test Loss: 0.547 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1636834144592285
Epoch: 30, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 31 cost time: 1.3182101249694824
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3912558555603027
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4377779960632324
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 34 cost time: 1.2230587005615234
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 35 cost time: 1.2480783462524414
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 1.3048598766326904
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 37 cost time: 1.4970579147338867
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.837 Test Loss: 0.545 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 38 cost time: 1.4410483837127686
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.837 Test Loss: 0.544 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 39 cost time: 1.4943242073059082
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.837 Test Loss: 0.543 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 40 cost time: 1.3623151779174805
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.542 Vali Acc: 0.837 Test Loss: 0.542 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 41 cost time: 1.2514739036560059
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.837 Test Loss: 0.541 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 42 cost time: 1.250171422958374
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.837 Test Loss: 0.540 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 43 cost time: 1.2609710693359375
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.837 Test Loss: 0.539 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 44 cost time: 1.3627705574035645
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 45 cost time: 1.5677742958068848
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 46 cost time: 1.2532777786254883
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 47 cost time: 1.318326473236084
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 48 cost time: 1.457477331161499
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 49 cost time: 1.2176940441131592
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 50 cost time: 1.49568510055542
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 51 cost time: 1.3168494701385498
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 52 cost time: 1.3292999267578125
Epoch: 52, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 53 cost time: 1.4974064826965332
Epoch: 53, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 54 cost time: 1.3573517799377441
Epoch: 54, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 55 cost time: 1.4620287418365479
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 56 cost time: 1.2680609226226807
Epoch: 56, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 57 cost time: 1.306488275527954
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 58 cost time: 1.3007183074951172
Epoch: 58, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 59 cost time: 1.4339323043823242
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 60 cost time: 1.1946420669555664
Epoch: 60, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 61 cost time: 1.2467029094696045
Epoch: 61, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 62 cost time: 1.2868969440460205
Epoch: 62, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 63 cost time: 1.4647784233093262
Epoch: 63, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.1118230819702148
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 65 cost time: 1.2788479328155518
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 1.519118070602417
Epoch: 66, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 67 cost time: 1.416381597518921
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 68 cost time: 1.3797032833099365
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 69 cost time: 1.2948789596557617
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 70 cost time: 1.3760673999786377
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 71 cost time: 1.5015387535095215
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 72 cost time: 1.4450151920318604
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 73 cost time: 1.3183410167694092
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 74 cost time: 1.2458164691925049
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 75 cost time: 1.4367141723632812
Epoch: 75, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 76 cost time: 1.349374532699585
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 77 cost time: 1.4500126838684082
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 78 cost time: 1.3979909420013428
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 79 cost time: 1.2406742572784424
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 80 cost time: 1.2609856128692627
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 81 cost time: 1.2441487312316895
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.852 Test Loss: 0.515 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 82 cost time: 1.443530559539795
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.852 Test Loss: 0.514 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 83 cost time: 1.3434607982635498
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.852 Test Loss: 0.514 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 84 cost time: 1.5590267181396484
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.852 Test Loss: 0.513 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 85 cost time: 1.4686191082000732
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.852 Test Loss: 0.513 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 86 cost time: 1.374755859375
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.852 Test Loss: 0.512 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 87 cost time: 1.5511267185211182
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855550).  Saving model ...
Epoch: 88 cost time: 1.6025025844573975
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 89 cost time: 1.3135337829589844
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 90 cost time: 1.4886126518249512
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 91 cost time: 1.276371955871582
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 92 cost time: 1.4867146015167236
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 93 cost time: 1.339111328125
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 94 cost time: 1.4591546058654785
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.3087425231933594
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 96 cost time: 1.3378911018371582
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 97 cost time: 1.227184772491455
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 98 cost time: 1.5116066932678223
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 99 cost time: 1.4158167839050293
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 100 cost time: 1.361025094985962
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.194674491882324
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.900 Vali Acc: 0.104 Test Loss: 1.900 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 1.4461004734039307
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.868 Vali Acc: 0.130 Test Loss: 1.868 Test Acc: 0.130
Validation loss decreased (-0.103685 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.3987960815429688
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.826 Vali Acc: 0.178 Test Loss: 1.826 Test Acc: 0.178
Validation loss decreased (-0.129611 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.3059861660003662
Epoch: 4, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.758 Vali Acc: 0.248 Test Loss: 1.758 Test Acc: 0.248
Validation loss decreased (-0.177760 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 1.2335350513458252
Epoch: 5, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.674 Vali Acc: 0.322 Test Loss: 1.674 Test Acc: 0.322
Validation loss decreased (-0.248131 --> -0.322205).  Saving model ...
Epoch: 6 cost time: 1.178063154220581
Epoch: 6, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.582 Vali Acc: 0.393 Test Loss: 1.582 Test Acc: 0.393
Validation loss decreased (-0.322205 --> -0.392577).  Saving model ...
Epoch: 7 cost time: 1.3215594291687012
Epoch: 7, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
Validation loss decreased (-0.392577 --> -0.518504).  Saving model ...
Epoch: 8 cost time: 1.2157607078552246
Epoch: 8, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.383 Vali Acc: 0.596 Test Loss: 1.383 Test Acc: 0.596
Validation loss decreased (-0.518504 --> -0.596282).  Saving model ...
Epoch: 9 cost time: 1.286170482635498
Epoch: 9, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.287 Vali Acc: 0.652 Test Loss: 1.287 Test Acc: 0.652
Validation loss decreased (-0.596282 --> -0.651839).  Saving model ...
Epoch: 10 cost time: 1.2900123596191406
Epoch: 10, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.193 Vali Acc: 0.681 Test Loss: 1.193 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681470).  Saving model ...
Epoch: 11 cost time: 1.2312769889831543
Epoch: 11, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.109 Vali Acc: 0.696 Test Loss: 1.109 Test Acc: 0.696
Validation loss decreased (-0.681470 --> -0.696285).  Saving model ...
Epoch: 12 cost time: 1.1939785480499268
Epoch: 12, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.032 Vali Acc: 0.704 Test Loss: 1.032 Test Acc: 0.704
Validation loss decreased (-0.696285 --> -0.703693).  Saving model ...
Epoch: 13 cost time: 1.3220479488372803
Epoch: 13, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 1.3009803295135498
Epoch: 14, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.900 Vali Acc: 0.733 Test Loss: 0.900 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 1.2506840229034424
Epoch: 15, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.849 Vali Acc: 0.741 Test Loss: 0.849 Test Acc: 0.741
Validation loss decreased (-0.733324 --> -0.740732).  Saving model ...
Epoch: 16 cost time: 1.2573268413543701
Epoch: 16, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.807 Vali Acc: 0.748 Test Loss: 0.807 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 17 cost time: 1.300910472869873
Epoch: 17, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.773 Vali Acc: 0.748 Test Loss: 0.773 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 18 cost time: 1.2388875484466553
Epoch: 18, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.745 Vali Acc: 0.752 Test Loss: 0.745 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 19 cost time: 1.438363790512085
Epoch: 19, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.721 Vali Acc: 0.759 Test Loss: 0.721 Test Acc: 0.759
Validation loss decreased (-0.751844 --> -0.759252).  Saving model ...
Epoch: 20 cost time: 1.1513302326202393
Epoch: 20, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.706 Vali Acc: 0.763 Test Loss: 0.706 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 21 cost time: 1.3777241706848145
Epoch: 21, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 22 cost time: 1.2901945114135742
Epoch: 22, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 23 cost time: 1.2506842613220215
Epoch: 23, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.668 Vali Acc: 0.774 Test Loss: 0.668 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 24 cost time: 1.244483470916748
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.662 Vali Acc: 0.774 Test Loss: 0.662 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 25 cost time: 1.2957611083984375
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.774067 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 1.343548059463501
Epoch: 26, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 1.122178316116333
Epoch: 27, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 28 cost time: 1.150479793548584
Epoch: 28, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.651 Vali Acc: 0.793 Test Loss: 0.651 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 29 cost time: 1.134809970855713
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.650 Vali Acc: 0.793 Test Loss: 0.650 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 30 cost time: 1.2638683319091797
Epoch: 30, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.793 Test Loss: 0.648 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 31 cost time: 1.2532660961151123
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.647 Vali Acc: 0.793 Test Loss: 0.647 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 32 cost time: 1.39585280418396
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 33 cost time: 1.2180941104888916
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 1.2895762920379639
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 35 cost time: 1.3685760498046875
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.641 Vali Acc: 0.804 Test Loss: 0.641 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 36 cost time: 1.3258798122406006
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 37 cost time: 1.266357660293579
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 38 cost time: 1.2235677242279053
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.807 Test Loss: 0.636 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 39 cost time: 1.2765913009643555
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.634 Vali Acc: 0.807 Test Loss: 0.634 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 40 cost time: 1.312732458114624
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.807 Test Loss: 0.632 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 41 cost time: 1.2736616134643555
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.807 Test Loss: 0.629 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 42 cost time: 1.4585795402526855
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2085886001586914
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3124094009399414
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1802599430084229
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2390072345733643
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2538044452667236
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2698442935943604
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2875299453735352
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.380368709564209
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4095642566680908
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0539908409118652
Epoch: 1, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.889 Vali Acc: 0.115 Test Loss: 1.889 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.3298602104187012
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.864 Vali Acc: 0.133 Test Loss: 1.864 Test Acc: 0.133
Validation loss decreased (-0.114796 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 1.146554708480835
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.832 Vali Acc: 0.163 Test Loss: 1.832 Test Acc: 0.163
Validation loss decreased (-0.133315 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.1771602630615234
Epoch: 4, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.780 Vali Acc: 0.189 Test Loss: 1.780 Test Acc: 0.189
Validation loss decreased (-0.162945 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 1.2047889232635498
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.715 Vali Acc: 0.237 Test Loss: 1.715 Test Acc: 0.237
Validation loss decreased (-0.188871 --> -0.237020).  Saving model ...
Epoch: 6 cost time: 1.2430672645568848
Epoch: 6, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.643 Vali Acc: 0.307 Test Loss: 1.643 Test Acc: 0.307
Validation loss decreased (-0.237020 --> -0.307391).  Saving model ...
Epoch: 7 cost time: 1.1213703155517578
Epoch: 7, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.564 Vali Acc: 0.419 Test Loss: 1.564 Test Acc: 0.419
Validation loss decreased (-0.307391 --> -0.418503).  Saving model ...
Epoch: 8 cost time: 1.200793981552124
Epoch: 8, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.486 Vali Acc: 0.533 Test Loss: 1.486 Test Acc: 0.533
Validation loss decreased (-0.418503 --> -0.533318).  Saving model ...
Epoch: 9 cost time: 1.2846169471740723
Epoch: 9, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.408 Vali Acc: 0.593 Test Loss: 1.408 Test Acc: 0.593
Validation loss decreased (-0.533318 --> -0.592579).  Saving model ...
Epoch: 10 cost time: 1.1713147163391113
Epoch: 10, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.330 Vali Acc: 0.644 Test Loss: 1.330 Test Acc: 0.644
Validation loss decreased (-0.592579 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 1.4020085334777832
Epoch: 11, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.259 Vali Acc: 0.663 Test Loss: 1.259 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 12 cost time: 1.329390525817871
Epoch: 12, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.190 Vali Acc: 0.685 Test Loss: 1.190 Test Acc: 0.685
Validation loss decreased (-0.662950 --> -0.685173).  Saving model ...
Epoch: 13 cost time: 1.4096455574035645
Epoch: 13, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.127 Vali Acc: 0.700 Test Loss: 1.127 Test Acc: 0.700
Validation loss decreased (-0.685173 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 1.3361799716949463
Epoch: 14, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.070 Vali Acc: 0.715 Test Loss: 1.070 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714804).  Saving model ...
Epoch: 15 cost time: 1.5335865020751953
Epoch: 15, Steps: 2 | Train Loss: 0.506 Vali Loss: 1.020 Vali Acc: 0.715 Test Loss: 1.020 Test Acc: 0.715
Validation loss decreased (-0.714804 --> -0.714805).  Saving model ...
Epoch: 16 cost time: 1.4421751499176025
Epoch: 16, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.977 Vali Acc: 0.719 Test Loss: 0.977 Test Acc: 0.719
Validation loss decreased (-0.714805 --> -0.718509).  Saving model ...
Epoch: 17 cost time: 1.3030226230621338
Epoch: 17, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
Validation loss decreased (-0.718509 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 1.4201159477233887
Epoch: 18, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.908 Vali Acc: 0.741 Test Loss: 0.908 Test Acc: 0.741
Validation loss decreased (-0.733324 --> -0.740732).  Saving model ...
Epoch: 19 cost time: 1.459200382232666
Epoch: 19, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 1.3542747497558594
Epoch: 20, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4201562404632568
Epoch: 21, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.841 Vali Acc: 0.737 Test Loss: 0.841 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4198925495147705
Epoch: 22, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 23 cost time: 1.1945216655731201
Epoch: 23, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.814 Vali Acc: 0.741 Test Loss: 0.814 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2891509532928467
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.804 Vali Acc: 0.730 Test Loss: 0.804 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2337582111358643
Epoch: 25, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 26 cost time: 1.5150361061096191
Epoch: 26, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2727618217468262
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.788 Vali Acc: 0.737 Test Loss: 0.788 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4079673290252686
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.785 Vali Acc: 0.741 Test Loss: 0.785 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4873528480529785
Epoch: 29, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.781 Vali Acc: 0.744 Test Loss: 0.781 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 30 cost time: 1.547288179397583
Epoch: 30, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.777 Vali Acc: 0.744 Test Loss: 0.777 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 31 cost time: 1.476078748703003
Epoch: 31, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.773 Vali Acc: 0.748 Test Loss: 0.773 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 32 cost time: 1.3880054950714111
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.768 Vali Acc: 0.748 Test Loss: 0.768 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 33 cost time: 1.5472235679626465
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.764 Vali Acc: 0.752 Test Loss: 0.764 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 34 cost time: 1.390876293182373
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.760 Vali Acc: 0.752 Test Loss: 0.760 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 35 cost time: 1.4935026168823242
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.757 Vali Acc: 0.752 Test Loss: 0.757 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 36 cost time: 1.6558337211608887
Epoch: 36, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.752 Test Loss: 0.753 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 37 cost time: 1.555401086807251
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.750 Vali Acc: 0.752 Test Loss: 0.750 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 38 cost time: 1.4232428073883057
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.752 Test Loss: 0.746 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 39 cost time: 1.4125335216522217
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 40 cost time: 1.4177711009979248
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.739 Vali Acc: 0.756 Test Loss: 0.739 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 41 cost time: 1.3341631889343262
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 42 cost time: 1.3911452293395996
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 1.3659729957580566
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 44 cost time: 1.4230871200561523
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.759 Test Loss: 0.725 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 45 cost time: 1.487363576889038
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.721 Vali Acc: 0.759 Test Loss: 0.721 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 46 cost time: 1.5185859203338623
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.759 Test Loss: 0.718 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 47 cost time: 1.420443058013916
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.759 Test Loss: 0.715 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 48 cost time: 1.379488229751587
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.767 Test Loss: 0.712 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766660).  Saving model ...
Epoch: 49 cost time: 1.4984586238861084
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.767 Test Loss: 0.708 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 50 cost time: 1.3029038906097412
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.767 Test Loss: 0.705 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 51 cost time: 1.4292869567871094
Epoch: 51, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.767 Test Loss: 0.702 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 52 cost time: 1.190969467163086
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.767 Test Loss: 0.699 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 53 cost time: 1.340024709701538
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.774 Test Loss: 0.696 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774067).  Saving model ...
Epoch: 54 cost time: 1.270920753479004
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 55 cost time: 1.3901581764221191
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.778 Test Loss: 0.691 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 56 cost time: 1.2027103900909424
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.781 Test Loss: 0.690 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 57 cost time: 1.2981648445129395
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.785 Test Loss: 0.688 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 58 cost time: 1.242643117904663
Epoch: 58, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.785 Test Loss: 0.686 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 59 cost time: 1.3094511032104492
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.785 Test Loss: 0.684 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 60 cost time: 1.126605749130249
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 61 cost time: 1.2421159744262695
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 62 cost time: 1.1893365383148193
Epoch: 62, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.793 Test Loss: 0.678 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 63 cost time: 1.2351884841918945
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.793 Test Loss: 0.676 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 64 cost time: 1.4081132411956787
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.793 Test Loss: 0.674 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 65 cost time: 1.3193860054016113
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.793 Test Loss: 0.672 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 66 cost time: 1.2062842845916748
Epoch: 66, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.793 Test Loss: 0.670 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 67 cost time: 1.1832201480865479
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 68 cost time: 1.1953680515289307
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 69 cost time: 1.2446091175079346
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.796 Test Loss: 0.665 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 70 cost time: 1.2630257606506348
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 71 cost time: 1.1605873107910156
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.796 Test Loss: 0.663 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 72 cost time: 1.2021427154541016
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799993).  Saving model ...
Epoch: 73 cost time: 1.2396907806396484
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 74 cost time: 1.1733324527740479
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 75 cost time: 1.1166958808898926
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 76 cost time: 1.1790752410888672
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 77 cost time: 1.1014280319213867
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 78 cost time: 1.1069567203521729
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 79 cost time: 1.0083956718444824
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 80 cost time: 1.152177333831787
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 81 cost time: 1.1668853759765625
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 82 cost time: 1.26540207862854
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 83 cost time: 1.219130039215088
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.804 Test Loss: 0.647 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 84 cost time: 1.1649909019470215
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 85 cost time: 1.3083317279815674
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 86 cost time: 1.2234041690826416
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 87 cost time: 1.32297945022583
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 88 cost time: 1.551870584487915
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.807 Test Loss: 0.643 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 89 cost time: 1.2642903327941895
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.807 Test Loss: 0.642 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 90 cost time: 1.0649347305297852
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.807 Test Loss: 0.641 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 91 cost time: 1.2502751350402832
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.807 Test Loss: 0.640 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 92 cost time: 1.150667667388916
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.807 Test Loss: 0.639 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 93 cost time: 1.2473130226135254
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.807 Test Loss: 0.638 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 94 cost time: 1.2091305255889893
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.807 Test Loss: 0.636 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 95 cost time: 1.2811698913574219
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.807 Test Loss: 0.635 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 96 cost time: 1.1923129558563232
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.807 Test Loss: 0.634 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 97 cost time: 1.1846730709075928
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.807 Test Loss: 0.632 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 98 cost time: 1.2269995212554932
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.807 Test Loss: 0.631 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 99 cost time: 1.4226622581481934
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.807 Test Loss: 0.629 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 100 cost time: 1.1671311855316162
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.807 Test Loss: 0.628 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9958364963531494
Epoch: 1, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.885 Vali Acc: 0.115 Test Loss: 1.885 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.3291394710540771
Epoch: 2, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.868 Vali Acc: 0.133 Test Loss: 1.868 Test Acc: 0.133
Validation loss decreased (-0.114796 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 1.3946952819824219
Epoch: 3, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.846 Vali Acc: 0.152 Test Loss: 1.846 Test Acc: 0.152
Validation loss decreased (-0.133315 --> -0.151833).  Saving model ...
Epoch: 4 cost time: 1.3242006301879883
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.811 Vali Acc: 0.178 Test Loss: 1.811 Test Acc: 0.178
Validation loss decreased (-0.151833 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 1.1861062049865723
Epoch: 5, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.766 Vali Acc: 0.219 Test Loss: 1.766 Test Acc: 0.219
Validation loss decreased (-0.177760 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 1.1327624320983887
Epoch: 6, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.716 Vali Acc: 0.252 Test Loss: 1.716 Test Acc: 0.252
Validation loss decreased (-0.218501 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 1.286118984222412
Epoch: 7, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.660 Vali Acc: 0.333 Test Loss: 1.660 Test Acc: 0.333
Validation loss decreased (-0.251835 --> -0.333317).  Saving model ...
Epoch: 8 cost time: 1.3607585430145264
Epoch: 8, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.605 Vali Acc: 0.415 Test Loss: 1.605 Test Acc: 0.415
Validation loss decreased (-0.333317 --> -0.414799).  Saving model ...
Epoch: 9 cost time: 1.216855525970459
Epoch: 9, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.549 Vali Acc: 0.478 Test Loss: 1.549 Test Acc: 0.478
Validation loss decreased (-0.414799 --> -0.477762).  Saving model ...
Epoch: 10 cost time: 1.18581223487854
Epoch: 10, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
Validation loss decreased (-0.477762 --> -0.518504).  Saving model ...
Epoch: 11 cost time: 1.0734987258911133
Epoch: 11, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.437 Vali Acc: 0.533 Test Loss: 1.437 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 12 cost time: 1.2789039611816406
Epoch: 12, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.385 Vali Acc: 0.552 Test Loss: 1.385 Test Acc: 0.552
Validation loss decreased (-0.533319 --> -0.551838).  Saving model ...
Epoch: 13 cost time: 1.288799524307251
Epoch: 13, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.335 Vali Acc: 0.556 Test Loss: 1.335 Test Acc: 0.556
Validation loss decreased (-0.551838 --> -0.555542).  Saving model ...
Epoch: 14 cost time: 1.203341007232666
Epoch: 14, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.289 Vali Acc: 0.570 Test Loss: 1.289 Test Acc: 0.570
Validation loss decreased (-0.555542 --> -0.570357).  Saving model ...
Epoch: 15 cost time: 1.5465214252471924
Epoch: 15, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.247 Vali Acc: 0.585 Test Loss: 1.247 Test Acc: 0.585
Validation loss decreased (-0.570357 --> -0.585173).  Saving model ...
Epoch: 16 cost time: 1.4626030921936035
Epoch: 16, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.209 Vali Acc: 0.593 Test Loss: 1.209 Test Acc: 0.593
Validation loss decreased (-0.585173 --> -0.592580).  Saving model ...
Epoch: 17 cost time: 1.479245662689209
Epoch: 17, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.592580 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 1.490999460220337
Epoch: 18, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.142 Vali Acc: 0.607 Test Loss: 1.142 Test Acc: 0.607
Validation loss decreased (-0.599988 --> -0.607396).  Saving model ...
Epoch: 19 cost time: 1.7063655853271484
Epoch: 19, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.111 Vali Acc: 0.607 Test Loss: 1.111 Test Acc: 0.607
Validation loss decreased (-0.607396 --> -0.607396).  Saving model ...
Epoch: 20 cost time: 1.5891129970550537
Epoch: 20, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.083 Vali Acc: 0.615 Test Loss: 1.083 Test Acc: 0.615
Validation loss decreased (-0.607396 --> -0.614804).  Saving model ...
Epoch: 21 cost time: 1.5428996086120605
Epoch: 21, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.056 Vali Acc: 0.619 Test Loss: 1.056 Test Acc: 0.619
Validation loss decreased (-0.614804 --> -0.618508).  Saving model ...
Epoch: 22 cost time: 1.370760440826416
Epoch: 22, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.030 Vali Acc: 0.648 Test Loss: 1.030 Test Acc: 0.648
Validation loss decreased (-0.618508 --> -0.648138).  Saving model ...
Epoch: 23 cost time: 1.5622403621673584
Epoch: 23, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.006 Vali Acc: 0.656 Test Loss: 1.006 Test Acc: 0.656
Validation loss decreased (-0.648138 --> -0.655545).  Saving model ...
Epoch: 24 cost time: 1.428231954574585
Epoch: 24, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.984 Vali Acc: 0.663 Test Loss: 0.984 Test Acc: 0.663
Validation loss decreased (-0.655545 --> -0.662953).  Saving model ...
Epoch: 25 cost time: 1.4094347953796387
Epoch: 25, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.966 Vali Acc: 0.663 Test Loss: 0.966 Test Acc: 0.663
Validation loss decreased (-0.662953 --> -0.662953).  Saving model ...
Epoch: 26 cost time: 1.384009838104248
Epoch: 26, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.949 Vali Acc: 0.670 Test Loss: 0.949 Test Acc: 0.670
Validation loss decreased (-0.662953 --> -0.670361).  Saving model ...
Epoch: 27 cost time: 1.3638074398040771
Epoch: 27, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.932 Vali Acc: 0.670 Test Loss: 0.932 Test Acc: 0.670
Validation loss decreased (-0.670361 --> -0.670361).  Saving model ...
Epoch: 28 cost time: 1.4293138980865479
Epoch: 28, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.916 Vali Acc: 0.674 Test Loss: 0.916 Test Acc: 0.674
Validation loss decreased (-0.670361 --> -0.674065).  Saving model ...
Epoch: 29 cost time: 1.51698637008667
Epoch: 29, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.900 Vali Acc: 0.685 Test Loss: 0.900 Test Acc: 0.685
Validation loss decreased (-0.674065 --> -0.685176).  Saving model ...
Epoch: 30 cost time: 1.3742752075195312
Epoch: 30, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.885 Vali Acc: 0.693 Test Loss: 0.885 Test Acc: 0.693
Validation loss decreased (-0.685176 --> -0.692584).  Saving model ...
Epoch: 31 cost time: 1.4860539436340332
Epoch: 31, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.871 Vali Acc: 0.700 Test Loss: 0.871 Test Acc: 0.700
Validation loss decreased (-0.692584 --> -0.699991).  Saving model ...
Epoch: 32 cost time: 1.3220593929290771
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.860 Vali Acc: 0.700 Test Loss: 0.860 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 1.472452163696289
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 1.4860482215881348
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.842 Vali Acc: 0.704 Test Loss: 0.842 Test Acc: 0.704
Validation loss decreased (-0.699991 --> -0.703695).  Saving model ...
Epoch: 35 cost time: 1.3150854110717773
Epoch: 35, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.834 Vali Acc: 0.707 Test Loss: 0.834 Test Acc: 0.707
Validation loss decreased (-0.703695 --> -0.707399).  Saving model ...
Epoch: 36 cost time: 1.2024431228637695
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.828 Vali Acc: 0.704 Test Loss: 0.828 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3916599750518799
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.822 Vali Acc: 0.704 Test Loss: 0.822 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2918124198913574
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.704 Test Loss: 0.817 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3595714569091797
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.812 Vali Acc: 0.700 Test Loss: 0.812 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3518388271331787
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.807 Vali Acc: 0.704 Test Loss: 0.807 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.329864501953125
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.803 Vali Acc: 0.707 Test Loss: 0.803 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 42 cost time: 1.4451320171356201
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.800 Vali Acc: 0.715 Test Loss: 0.800 Test Acc: 0.715
Validation loss decreased (-0.707399 --> -0.714807).  Saving model ...
Epoch: 43 cost time: 1.3272950649261475
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.796 Vali Acc: 0.715 Test Loss: 0.796 Test Acc: 0.715
Validation loss decreased (-0.714807 --> -0.714807).  Saving model ...
Epoch: 44 cost time: 1.2128877639770508
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.793 Vali Acc: 0.719 Test Loss: 0.793 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718511).  Saving model ...
Epoch: 45 cost time: 1.2318551540374756
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.719 Test Loss: 0.789 Test Acc: 0.719
Validation loss decreased (-0.718511 --> -0.718511).  Saving model ...
Epoch: 46 cost time: 1.3120286464691162
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.787 Vali Acc: 0.719 Test Loss: 0.787 Test Acc: 0.719
Validation loss decreased (-0.718511 --> -0.718511).  Saving model ...
Epoch: 47 cost time: 1.4059529304504395
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722214).  Saving model ...
Epoch: 48 cost time: 1.416126012802124
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.782 Vali Acc: 0.722 Test Loss: 0.782 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 49 cost time: 1.3694064617156982
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.779 Vali Acc: 0.722 Test Loss: 0.779 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 50 cost time: 1.3822264671325684
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 51 cost time: 1.2873342037200928
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.775 Vali Acc: 0.726 Test Loss: 0.775 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 52 cost time: 1.123002529144287
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.733 Test Loss: 0.773 Test Acc: 0.733
Validation loss decreased (-0.725918 --> -0.733326).  Saving model ...
Epoch: 53 cost time: 1.2091076374053955
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.733 Test Loss: 0.771 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 54 cost time: 1.223710298538208
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.768 Vali Acc: 0.733 Test Loss: 0.768 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 55 cost time: 1.2451484203338623
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 56 cost time: 1.2671997547149658
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
Validation loss decreased (-0.733326 --> -0.740733).  Saving model ...
Epoch: 57 cost time: 1.2163069248199463
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.741 Test Loss: 0.762 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 58 cost time: 1.4587972164154053
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.741 Test Loss: 0.760 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 59 cost time: 1.435960292816162
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.758 Vali Acc: 0.741 Test Loss: 0.758 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 60 cost time: 1.3105120658874512
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.741 Test Loss: 0.756 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 61 cost time: 1.3254673480987549
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.741 Test Loss: 0.754 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 62 cost time: 1.4141592979431152
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 63 cost time: 1.4089443683624268
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.744 Test Loss: 0.751 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 64 cost time: 1.3348548412322998
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 65 cost time: 1.5004172325134277
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 66 cost time: 1.449052333831787
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.747 Vali Acc: 0.744 Test Loss: 0.747 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 67 cost time: 1.2541851997375488
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 68 cost time: 1.24204421043396
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 69 cost time: 1.2888264656066895
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 70 cost time: 1.442406177520752
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.748 Test Loss: 0.743 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 71 cost time: 1.314920425415039
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.752 Test Loss: 0.742 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751844).  Saving model ...
Epoch: 72 cost time: 1.2502987384796143
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.752 Test Loss: 0.741 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 73 cost time: 1.3888115882873535
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.740 Vali Acc: 0.756 Test Loss: 0.740 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 74 cost time: 1.3383100032806396
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.756 Test Loss: 0.739 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 75 cost time: 1.2463929653167725
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 76 cost time: 1.5144028663635254
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 77 cost time: 1.4709930419921875
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 78 cost time: 1.7104098796844482
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 79 cost time: 1.4497230052947998
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 80 cost time: 1.5899503231048584
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 81 cost time: 1.542320966720581
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 82 cost time: 1.4710993766784668
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 83 cost time: 1.4849975109100342
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.756 Test Loss: 0.725 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 84 cost time: 1.3449840545654297
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 85 cost time: 1.441798448562622
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.756 Test Loss: 0.723 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 86 cost time: 1.4970741271972656
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.759 Test Loss: 0.722 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 87 cost time: 1.4728069305419922
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 88 cost time: 1.2470426559448242
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 89 cost time: 1.3715875148773193
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.763 Test Loss: 0.720 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 90 cost time: 1.5933542251586914
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.763 Test Loss: 0.719 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 91 cost time: 1.593705654144287
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.763 Test Loss: 0.718 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 92 cost time: 1.5186724662780762
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 93 cost time: 1.4343245029449463
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 94 cost time: 1.3920314311981201
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.763 Test Loss: 0.715 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 95 cost time: 1.3761584758758545
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 96 cost time: 1.5005145072937012
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 97 cost time: 1.3276543617248535
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.763 Test Loss: 0.710 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 98 cost time: 1.3821287155151367
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.767 Test Loss: 0.709 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 99 cost time: 1.385990858078003
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 100 cost time: 1.4502158164978027
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.767 Test Loss: 0.706 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7666666666666667
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.964285135269165
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.848 Vali Acc: 0.170 Test Loss: 1.848 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.2913916110992432
Epoch: 2, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.840 Vali Acc: 0.193 Test Loss: 1.840 Test Acc: 0.193
Validation loss decreased (-0.170352 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 1.2725281715393066
Epoch: 3, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.825 Vali Acc: 0.207 Test Loss: 1.825 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 1.3282265663146973
Epoch: 4, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.801 Vali Acc: 0.226 Test Loss: 1.801 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 1.5415544509887695
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.767 Vali Acc: 0.222 Test Loss: 1.767 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.386042594909668
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.730 Vali Acc: 0.244 Test Loss: 1.730 Test Acc: 0.244
Validation loss decreased (-0.225908 --> -0.244427).  Saving model ...
Epoch: 7 cost time: 1.2711286544799805
Epoch: 7, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.688 Vali Acc: 0.278 Test Loss: 1.688 Test Acc: 0.278
Validation loss decreased (-0.244427 --> -0.277761).  Saving model ...
Epoch: 8 cost time: 1.5697376728057861
Epoch: 8, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.644 Vali Acc: 0.322 Test Loss: 1.644 Test Acc: 0.322
Validation loss decreased (-0.277761 --> -0.322206).  Saving model ...
Epoch: 9 cost time: 1.3690664768218994
Epoch: 9, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.597 Vali Acc: 0.400 Test Loss: 1.597 Test Acc: 0.400
Validation loss decreased (-0.322206 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 1.3634998798370361
Epoch: 10, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.545 Vali Acc: 0.489 Test Loss: 1.545 Test Acc: 0.489
Validation loss decreased (-0.399984 --> -0.488873).  Saving model ...
Epoch: 11 cost time: 1.2465252876281738
Epoch: 11, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.488873 --> -0.544430).  Saving model ...
Epoch: 12 cost time: 1.3590199947357178
Epoch: 12, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.440 Vali Acc: 0.622 Test Loss: 1.440 Test Acc: 0.622
Validation loss decreased (-0.544430 --> -0.622208).  Saving model ...
Epoch: 13 cost time: 1.529778003692627
Epoch: 13, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.385 Vali Acc: 0.630 Test Loss: 1.385 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629616).  Saving model ...
Epoch: 14 cost time: 1.4411702156066895
Epoch: 14, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.331 Vali Acc: 0.644 Test Loss: 1.331 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 15 cost time: 1.2948477268218994
Epoch: 15, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.277 Vali Acc: 0.663 Test Loss: 1.277 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 16 cost time: 1.294590950012207
Epoch: 16, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.225 Vali Acc: 0.667 Test Loss: 1.225 Test Acc: 0.667
Validation loss decreased (-0.662950 --> -0.666654).  Saving model ...
Epoch: 17 cost time: 1.2174596786499023
Epoch: 17, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.173 Vali Acc: 0.678 Test Loss: 1.173 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 18 cost time: 1.3342278003692627
Epoch: 18, Steps: 2 | Train Loss: 0.772 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 19 cost time: 1.1147475242614746
Epoch: 19, Steps: 2 | Train Loss: 0.684 Vali Loss: 1.076 Vali Acc: 0.689 Test Loss: 1.076 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 20 cost time: 1.3948657512664795
Epoch: 20, Steps: 2 | Train Loss: 0.622 Vali Loss: 1.030 Vali Acc: 0.693 Test Loss: 1.030 Test Acc: 0.693
Validation loss decreased (-0.688878 --> -0.692582).  Saving model ...
Epoch: 21 cost time: 1.2945921421051025
Epoch: 21, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
Validation loss decreased (-0.692582 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 1.5587148666381836
Epoch: 22, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.942 Vali Acc: 0.722 Test Loss: 0.942 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 23 cost time: 1.2761151790618896
Epoch: 23, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.900 Vali Acc: 0.737 Test Loss: 0.900 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737028).  Saving model ...
Epoch: 24 cost time: 1.4334492683410645
Epoch: 24, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.864 Vali Acc: 0.744 Test Loss: 0.864 Test Acc: 0.744
Validation loss decreased (-0.737028 --> -0.744436).  Saving model ...
Epoch: 25 cost time: 1.3708956241607666
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.837 Vali Acc: 0.752 Test Loss: 0.837 Test Acc: 0.752
Validation loss decreased (-0.744436 --> -0.751843).  Saving model ...
Epoch: 26 cost time: 1.3809642791748047
Epoch: 26, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
Validation loss decreased (-0.751843 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 1.3666119575500488
Epoch: 27, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.780 Vali Acc: 0.752 Test Loss: 0.780 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3758018016815186
Epoch: 28, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.756 Vali Acc: 0.744 Test Loss: 0.756 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4053075313568115
Epoch: 29, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.731 Vali Acc: 0.759 Test Loss: 0.731 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 30 cost time: 1.5475568771362305
Epoch: 30, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 31 cost time: 1.4763591289520264
Epoch: 31, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 32 cost time: 1.425827980041504
Epoch: 32, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.675 Vali Acc: 0.770 Test Loss: 0.675 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 33 cost time: 1.6251976490020752
Epoch: 33, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.659 Vali Acc: 0.774 Test Loss: 0.659 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 34 cost time: 1.291167974472046
Epoch: 34, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.646 Vali Acc: 0.774 Test Loss: 0.646 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774068).  Saving model ...
Epoch: 35 cost time: 1.4630329608917236
Epoch: 35, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4809770584106445
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.633 Vali Acc: 0.774 Test Loss: 0.633 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 37 cost time: 1.3677468299865723
Epoch: 37, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.502129077911377
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.355675458908081
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.556492567062378
Epoch: 40, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2680768966674805
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3844552040100098
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.774 Test Loss: 0.600 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 43 cost time: 1.5129802227020264
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.774 Test Loss: 0.596 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 44 cost time: 1.5847852230072021
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.774 Test Loss: 0.591 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 45 cost time: 1.4351234436035156
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.774 Test Loss: 0.585 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 46 cost time: 1.4339783191680908
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.774 Test Loss: 0.582 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 47 cost time: 1.3156352043151855
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.781 Test Loss: 0.579 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781476).  Saving model ...
Epoch: 48 cost time: 1.524186134338379
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.577 Vali Acc: 0.781 Test Loss: 0.577 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 49 cost time: 1.2045679092407227
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.781 Test Loss: 0.576 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 50 cost time: 1.2045304775238037
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.781 Test Loss: 0.576 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2773654460906982
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.785 Test Loss: 0.576 Test Acc: 0.785
Validation loss decreased (-0.781476 --> -0.785179).  Saving model ...
Epoch: 52 cost time: 1.1957321166992188
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 53 cost time: 1.3059868812561035
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 54 cost time: 1.2207603454589844
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 55 cost time: 1.47481107711792
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 56 cost time: 1.380741834640503
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 57 cost time: 1.4911158084869385
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.793 Test Loss: 0.563 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 58 cost time: 1.3216893672943115
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.793 Test Loss: 0.560 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 59 cost time: 1.3533639907836914
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796291).  Saving model ...
Epoch: 60 cost time: 1.2885229587554932
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
Validation loss decreased (-0.796291 --> -0.803698).  Saving model ...
Epoch: 61 cost time: 1.287536382675171
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.548 Vali Acc: 0.807 Test Loss: 0.548 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 62 cost time: 1.4647228717803955
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814809).  Saving model ...
Epoch: 63 cost time: 1.4668471813201904
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822217).  Saving model ...
Epoch: 64 cost time: 1.3165745735168457
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 65 cost time: 1.3425230979919434
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 66 cost time: 1.3402080535888672
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 67 cost time: 1.3250360488891602
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.830 Test Loss: 0.524 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 68 cost time: 1.3585445880889893
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.830 Test Loss: 0.522 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 69 cost time: 1.16385817527771
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 1.213944435119629
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 71 cost time: 1.3213112354278564
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 1.2260136604309082
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.837 Test Loss: 0.514 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 73 cost time: 1.2850465774536133
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.837 Test Loss: 0.513 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 74 cost time: 1.3938097953796387
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.837 Test Loss: 0.512 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 75 cost time: 1.282996416091919
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.837 Test Loss: 0.512 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 76 cost time: 1.5579323768615723
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.837 Test Loss: 0.512 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 77 cost time: 1.181150197982788
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.837 Test Loss: 0.511 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 78 cost time: 1.4003779888153076
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.837 Test Loss: 0.511 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 79 cost time: 1.305135726928711
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.837 Test Loss: 0.510 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 80 cost time: 1.4361650943756104
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.837 Test Loss: 0.509 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 81 cost time: 1.4443011283874512
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.837 Test Loss: 0.507 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 82 cost time: 1.323575735092163
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 83 cost time: 1.1932454109191895
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 84 cost time: 1.2398502826690674
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 85 cost time: 1.2084836959838867
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 86 cost time: 1.182128667831421
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 87 cost time: 1.2930302619934082
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 88 cost time: 1.4110422134399414
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 89 cost time: 1.4282875061035156
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 90 cost time: 1.5602757930755615
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 91 cost time: 1.4629595279693604
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 92 cost time: 1.5241010189056396
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 93 cost time: 1.2941064834594727
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 94 cost time: 1.2994472980499268
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 95 cost time: 1.244940996170044
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 96 cost time: 1.4118919372558594
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 97 cost time: 1.2830886840820312
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 98 cost time: 1.371100664138794
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 99 cost time: 1.3820970058441162
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 100 cost time: 1.3231923580169678
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8444444444444444
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0722687244415283
Epoch: 1, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.945 Vali Acc: 0.100 Test Loss: 1.945 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 1.3883910179138184
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.938 Vali Acc: 0.100 Test Loss: 1.938 Test Acc: 0.100
Validation loss decreased (-0.099981 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 1.4787986278533936
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.920 Vali Acc: 0.107 Test Loss: 1.920 Test Acc: 0.107
Validation loss decreased (-0.099981 --> -0.107388).  Saving model ...
Epoch: 4 cost time: 1.5224628448486328
Epoch: 4, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.883 Vali Acc: 0.122 Test Loss: 1.883 Test Acc: 0.122
Validation loss decreased (-0.107388 --> -0.122203).  Saving model ...
Epoch: 5 cost time: 1.2912678718566895
Epoch: 5, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.834 Vali Acc: 0.156 Test Loss: 1.834 Test Acc: 0.156
Validation loss decreased (-0.122203 --> -0.155537).  Saving model ...
Epoch: 6 cost time: 1.2938435077667236
Epoch: 6, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.778 Vali Acc: 0.193 Test Loss: 1.778 Test Acc: 0.193
Validation loss decreased (-0.155537 --> -0.192575).  Saving model ...
Epoch: 7 cost time: 1.4983069896697998
Epoch: 7, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.712 Vali Acc: 0.226 Test Loss: 1.712 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 1.386409044265747
Epoch: 8, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.642 Vali Acc: 0.300 Test Loss: 1.642 Test Acc: 0.300
Validation loss decreased (-0.225909 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 1.1940374374389648
Epoch: 9, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.567 Vali Acc: 0.378 Test Loss: 1.567 Test Acc: 0.378
Validation loss decreased (-0.299984 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 1.5516972541809082
Epoch: 10, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.487 Vali Acc: 0.467 Test Loss: 1.487 Test Acc: 0.467
Validation loss decreased (-0.377762 --> -0.466652).  Saving model ...
Epoch: 11 cost time: 1.3210606575012207
Epoch: 11, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.403 Vali Acc: 0.530 Test Loss: 1.403 Test Acc: 0.530
Validation loss decreased (-0.466652 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 1.2459588050842285
Epoch: 12, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.322 Vali Acc: 0.570 Test Loss: 1.322 Test Acc: 0.570
Validation loss decreased (-0.529616 --> -0.570357).  Saving model ...
Epoch: 13 cost time: 1.3140137195587158
Epoch: 13, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.239 Vali Acc: 0.630 Test Loss: 1.239 Test Acc: 0.630
Validation loss decreased (-0.570357 --> -0.629617).  Saving model ...
Epoch: 14 cost time: 1.2460038661956787
Epoch: 14, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.160 Vali Acc: 0.681 Test Loss: 1.160 Test Acc: 0.681
Validation loss decreased (-0.629617 --> -0.681470).  Saving model ...
Epoch: 15 cost time: 1.7232201099395752
Epoch: 15, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.083 Vali Acc: 0.711 Test Loss: 1.083 Test Acc: 0.711
Validation loss decreased (-0.681470 --> -0.711100).  Saving model ...
Epoch: 16 cost time: 1.5496771335601807
Epoch: 16, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 1.5763640403747559
Epoch: 17, Steps: 2 | Train Loss: 1.207 Vali Loss: 0.941 Vali Acc: 0.741 Test Loss: 0.941 Test Acc: 0.741
Validation loss decreased (-0.722212 --> -0.740731).  Saving model ...
Epoch: 18 cost time: 1.5073301792144775
Epoch: 18, Steps: 2 | Train Loss: 1.019 Vali Loss: 0.877 Vali Acc: 0.774 Test Loss: 0.877 Test Acc: 0.774
Validation loss decreased (-0.740731 --> -0.774065).  Saving model ...
Epoch: 19 cost time: 1.3985521793365479
Epoch: 19, Steps: 2 | Train Loss: 1.013 Vali Loss: 0.816 Vali Acc: 0.778 Test Loss: 0.816 Test Acc: 0.778
Validation loss decreased (-0.774065 --> -0.777770).  Saving model ...
Epoch: 20 cost time: 1.6097164154052734
Epoch: 20, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 1.4769766330718994
Epoch: 21, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 1.5880606174468994
Epoch: 22, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
Validation loss decreased (-0.822215 --> -0.840734).  Saving model ...
Epoch: 23 cost time: 1.5453264713287354
Epoch: 23, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 1.3345694541931152
Epoch: 24, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 25 cost time: 1.461200475692749
Epoch: 25, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.539 Vali Acc: 0.837 Test Loss: 0.539 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4382891654968262
Epoch: 26, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848143).  Saving model ...
Epoch: 27 cost time: 1.357236623764038
Epoch: 27, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.848143 --> -0.855551).  Saving model ...
Epoch: 28 cost time: 1.4410974979400635
Epoch: 28, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 29 cost time: 1.4162027835845947
Epoch: 29, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 30 cost time: 1.35544753074646
Epoch: 30, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4107742309570312
Epoch: 31, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4674746990203857
Epoch: 32, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.415 Vali Acc: 0.844 Test Loss: 0.415 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2533583641052246
Epoch: 33, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.389 Vali Acc: 0.844 Test Loss: 0.389 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4412095546722412
Epoch: 34, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.357 Vali Acc: 0.874 Test Loss: 0.357 Test Acc: 0.874
Validation loss decreased (-0.855551 --> -0.874071).  Saving model ...
Epoch: 35 cost time: 1.4634687900543213
Epoch: 35, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.893 Test Loss: 0.325 Test Acc: 0.893
Validation loss decreased (-0.874071 --> -0.892589).  Saving model ...
Epoch: 36 cost time: 1.3825809955596924
Epoch: 36, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
Validation loss decreased (-0.892589 --> -0.907404).  Saving model ...
Epoch: 37 cost time: 1.5318193435668945
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 38 cost time: 1.6211817264556885
Epoch: 38, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 1.602245807647705
Epoch: 39, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.401047945022583
Epoch: 40, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 1.6873645782470703
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.445727825164795
Epoch: 42, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4072096347808838
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3939330577850342
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5312891006469727
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3171687126159668
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3328526020050049
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.295619249343872
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5180559158325195
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4789304733276367
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.014808177947998
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.821 Vali Acc: 0.144 Test Loss: 1.821 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.1988232135772705
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.816 Vali Acc: 0.148 Test Loss: 1.816 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.5283122062683105
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.798 Vali Acc: 0.163 Test Loss: 1.798 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.3962349891662598
Epoch: 4, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.755 Vali Acc: 0.219 Test Loss: 1.755 Test Acc: 0.219
Validation loss decreased (-0.162945 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 1.326767921447754
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.701 Vali Acc: 0.281 Test Loss: 1.701 Test Acc: 0.281
Validation loss decreased (-0.218501 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 1.2720842361450195
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.636 Vali Acc: 0.374 Test Loss: 1.636 Test Acc: 0.374
Validation loss decreased (-0.281464 --> -0.374058).  Saving model ...
Epoch: 7 cost time: 1.1778857707977295
Epoch: 7, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.564 Vali Acc: 0.441 Test Loss: 1.564 Test Acc: 0.441
Validation loss decreased (-0.374058 --> -0.440725).  Saving model ...
Epoch: 8 cost time: 1.0346381664276123
Epoch: 8, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.488 Vali Acc: 0.515 Test Loss: 1.488 Test Acc: 0.515
Validation loss decreased (-0.440725 --> -0.514800).  Saving model ...
Epoch: 9 cost time: 1.3625268936157227
Epoch: 9, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.407 Vali Acc: 0.559 Test Loss: 1.407 Test Acc: 0.559
Validation loss decreased (-0.514800 --> -0.559245).  Saving model ...
Epoch: 10 cost time: 1.1312587261199951
Epoch: 10, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.326 Vali Acc: 0.604 Test Loss: 1.326 Test Acc: 0.604
Validation loss decreased (-0.559245 --> -0.603690).  Saving model ...
Epoch: 11 cost time: 1.0401737689971924
Epoch: 11, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.245 Vali Acc: 0.715 Test Loss: 1.245 Test Acc: 0.715
Validation loss decreased (-0.603690 --> -0.714802).  Saving model ...
Epoch: 12 cost time: 1.2529711723327637
Epoch: 12, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.165 Vali Acc: 0.752 Test Loss: 1.165 Test Acc: 0.752
Validation loss decreased (-0.714802 --> -0.751840).  Saving model ...
Epoch: 13 cost time: 1.1666529178619385
Epoch: 13, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.089 Vali Acc: 0.781 Test Loss: 1.089 Test Acc: 0.781
Validation loss decreased (-0.751840 --> -0.781471).  Saving model ...
Epoch: 14 cost time: 1.2235615253448486
Epoch: 14, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.016 Vali Acc: 0.800 Test Loss: 1.016 Test Acc: 0.800
Validation loss decreased (-0.781471 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 1.318126916885376
Epoch: 15, Steps: 2 | Train Loss: 1.363 Vali Loss: 0.948 Vali Acc: 0.815 Test Loss: 0.948 Test Acc: 0.815
Validation loss decreased (-0.799990 --> -0.814805).  Saving model ...
Epoch: 16 cost time: 1.3331787586212158
Epoch: 16, Steps: 2 | Train Loss: 1.238 Vali Loss: 0.885 Vali Acc: 0.822 Test Loss: 0.885 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 17 cost time: 1.516413688659668
Epoch: 17, Steps: 2 | Train Loss: 1.221 Vali Loss: 0.825 Vali Acc: 0.844 Test Loss: 0.825 Test Acc: 0.844
Validation loss decreased (-0.822213 --> -0.844436).  Saving model ...
Epoch: 18 cost time: 1.3819735050201416
Epoch: 18, Steps: 2 | Train Loss: 1.192 Vali Loss: 0.770 Vali Acc: 0.863 Test Loss: 0.770 Test Acc: 0.863
Validation loss decreased (-0.844436 --> -0.862955).  Saving model ...
Epoch: 19 cost time: 1.4524693489074707
Epoch: 19, Steps: 2 | Train Loss: 1.017 Vali Loss: 0.721 Vali Acc: 0.867 Test Loss: 0.721 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 20 cost time: 1.4996695518493652
Epoch: 20, Steps: 2 | Train Loss: 1.052 Vali Loss: 0.676 Vali Acc: 0.870 Test Loss: 0.676 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870364).  Saving model ...
Epoch: 21 cost time: 1.2707042694091797
Epoch: 21, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.634 Vali Acc: 0.874 Test Loss: 0.634 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 1.453016996383667
Epoch: 22, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.598 Vali Acc: 0.881 Test Loss: 0.598 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 23 cost time: 1.1208629608154297
Epoch: 23, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 1.361224889755249
Epoch: 24, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.536 Vali Acc: 0.881 Test Loss: 0.536 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 25 cost time: 1.3103241920471191
Epoch: 25, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.246506929397583
Epoch: 26, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1956639289855957
Epoch: 27, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.477 Vali Acc: 0.881 Test Loss: 0.477 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 28 cost time: 1.3117704391479492
Epoch: 28, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4227409362792969
Epoch: 29, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.446 Vali Acc: 0.867 Test Loss: 0.446 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1549980640411377
Epoch: 30, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.426 Vali Acc: 0.859 Test Loss: 0.426 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.189960241317749
Epoch: 31, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4201693534851074
Epoch: 32, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.393 Vali Acc: 0.863 Test Loss: 0.393 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4902822971343994
Epoch: 33, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.616438627243042
Epoch: 34, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.331 Vali Acc: 0.893 Test Loss: 0.331 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892589).  Saving model ...
Epoch: 35 cost time: 1.2608163356781006
Epoch: 35, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.373544692993164
Epoch: 36, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 1.071181297302246
Epoch: 37, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.284 Vali Acc: 0.896 Test Loss: 0.284 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1223342418670654
Epoch: 38, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907405).  Saving model ...
Epoch: 39 cost time: 1.3045167922973633
Epoch: 39, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 40 cost time: 1.3468914031982422
Epoch: 40, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.262 Vali Acc: 0.907 Test Loss: 0.262 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 41 cost time: 1.1942315101623535
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 42 cost time: 1.0723111629486084
Epoch: 42, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.911109 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 1.1926076412200928
Epoch: 43, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.206974744796753
Epoch: 44, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 45 cost time: 1.1492164134979248
Epoch: 45, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 46 cost time: 1.1538310050964355
Epoch: 46, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1261537075042725
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3952972888946533
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 1.1936962604522705
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 1.4289813041687012
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2343106269836426
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.5089547634124756
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 1.1317634582519531
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3576531410217285
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.360992431640625
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2053570747375488
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.4947562217712402
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.1135873794555664
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.4734885692596436
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2556138038635254
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.4179942607879639
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.343230962753296
Epoch: 62, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0330710411071777
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2918188571929932
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.266296148300171
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3718311786651611
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1660277843475342
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3704943656921387
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3434381484985352
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.436014175415039
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.4400060176849365
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.384486198425293
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.3191864490509033
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4558141231536865
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4734673500061035
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3149878978729248
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.368582010269165
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2619435787200928
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2388970851898193
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.404066801071167
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.335770606994629
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.225477695465088
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3745112419128418
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.2591564655303955
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.4477732181549072
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2256762981414795
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.393256425857544
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.280569076538086
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.4041931629180908
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.42747163772583
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2184696197509766
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2707195281982422
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.234278678894043
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1548891067504883
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.243572473526001
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1596705913543701
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2476880550384521
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.498852014541626
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1492862701416016
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3442983627319336
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.3928930759429932
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2119944095611572
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3809378147125244
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5945727825164795
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.350931167602539
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2754018306732178
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4160995483398438
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2590277194976807
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3089916706085205
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2651581764221191
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 2154886
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9335439205169678
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.857 Vali Acc: 0.133 Test Loss: 1.857 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.2001454830169678
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.821 Vali Acc: 0.178 Test Loss: 1.821 Test Acc: 0.178
Validation loss decreased (-0.133315 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.175544023513794
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.778 Vali Acc: 0.222 Test Loss: 1.778 Test Acc: 0.222
Validation loss decreased (-0.177760 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 1.2223846912384033
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.711 Vali Acc: 0.296 Test Loss: 1.711 Test Acc: 0.296
Validation loss decreased (-0.222204 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 1.1829869747161865
Epoch: 5, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.627 Vali Acc: 0.396 Test Loss: 1.627 Test Acc: 0.396
Validation loss decreased (-0.296279 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 1.3437564373016357
Epoch: 6, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.531 Vali Acc: 0.511 Test Loss: 1.531 Test Acc: 0.511
Validation loss decreased (-0.396280 --> -0.511096).  Saving model ...
Epoch: 7 cost time: 1.2835421562194824
Epoch: 7, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.429 Vali Acc: 0.589 Test Loss: 1.429 Test Acc: 0.589
Validation loss decreased (-0.511096 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 1.2808055877685547
Epoch: 8, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.325 Vali Acc: 0.659 Test Loss: 1.325 Test Acc: 0.659
Validation loss decreased (-0.588875 --> -0.659246).  Saving model ...
Epoch: 9 cost time: 1.3227198123931885
Epoch: 9, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.221 Vali Acc: 0.711 Test Loss: 1.221 Test Acc: 0.711
Validation loss decreased (-0.659246 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.3375132083892822
Epoch: 10, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.120 Vali Acc: 0.744 Test Loss: 1.120 Test Acc: 0.744
Validation loss decreased (-0.711099 --> -0.744433).  Saving model ...
Epoch: 11 cost time: 1.4656479358673096
Epoch: 11, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.026 Vali Acc: 0.767 Test Loss: 1.026 Test Acc: 0.767
Validation loss decreased (-0.744433 --> -0.766656).  Saving model ...
Epoch: 12 cost time: 1.4342188835144043
Epoch: 12, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.941 Vali Acc: 0.789 Test Loss: 0.941 Test Acc: 0.789
Validation loss decreased (-0.766656 --> -0.788879).  Saving model ...
Epoch: 13 cost time: 1.6700007915496826
Epoch: 13, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 1.335683822631836
Epoch: 14, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.801 Vali Acc: 0.815 Test Loss: 0.801 Test Acc: 0.815
Validation loss decreased (-0.799991 --> -0.814807).  Saving model ...
Epoch: 15 cost time: 1.3328068256378174
Epoch: 15, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
Validation loss decreased (-0.814807 --> -0.818511).  Saving model ...
Epoch: 16 cost time: 1.4562273025512695
Epoch: 16, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.695 Vali Acc: 0.807 Test Loss: 0.695 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5483365058898926
Epoch: 17, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
Validation loss decreased (-0.818511 --> -0.818512).  Saving model ...
Epoch: 18 cost time: 1.3606677055358887
Epoch: 18, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 19 cost time: 1.3412485122680664
Epoch: 19, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.29024076461792
Epoch: 20, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 1.2608094215393066
Epoch: 21, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 22 cost time: 1.3130652904510498
Epoch: 22, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 23 cost time: 1.4482879638671875
Epoch: 23, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 24 cost time: 1.561220645904541
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.547 Vali Acc: 0.830 Test Loss: 0.547 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 25 cost time: 1.3433804512023926
Epoch: 25, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 1.3951404094696045
Epoch: 26, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 1.5423948764801025
Epoch: 27, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.539 Vali Acc: 0.830 Test Loss: 0.539 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2633872032165527
Epoch: 28, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.830 Test Loss: 0.538 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4702296257019043
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3431310653686523
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 31 cost time: 1.2967207431793213
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6259269714355469
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4509589672088623
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 34 cost time: 1.3947598934173584
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 35 cost time: 1.598421335220337
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 1.3179965019226074
Epoch: 36, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 37 cost time: 1.5323257446289062
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 1.421961784362793
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 1.4973158836364746
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 40 cost time: 1.3961491584777832
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.5063602924346924
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.6876204013824463
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.531 Vali Acc: 0.830 Test Loss: 0.531 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4495761394500732
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.830 Test Loss: 0.530 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.485381841659546
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.528 Vali Acc: 0.830 Test Loss: 0.528 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4367036819458008
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.3451945781707764
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.526 Vali Acc: 0.837 Test Loss: 0.526 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 47 cost time: 1.5295336246490479
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.837 Test Loss: 0.525 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 48 cost time: 1.3815243244171143
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.837 Test Loss: 0.523 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 49 cost time: 1.3976752758026123
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.837 Test Loss: 0.522 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 50 cost time: 1.4097177982330322
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.837 Test Loss: 0.521 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 51 cost time: 1.2341759204864502
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 52 cost time: 1.41937255859375
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 53 cost time: 1.3624367713928223
Epoch: 53, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 54 cost time: 1.4089837074279785
Epoch: 54, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 55 cost time: 1.3537969589233398
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 56 cost time: 1.460036039352417
Epoch: 56, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 57 cost time: 1.3793470859527588
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 58 cost time: 1.4700257778167725
Epoch: 58, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 59 cost time: 1.4851298332214355
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 60 cost time: 1.449408769607544
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 61 cost time: 1.3741414546966553
Epoch: 61, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 62 cost time: 1.4454360008239746
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 63 cost time: 1.7539114952087402
Epoch: 63, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 64 cost time: 1.34627366065979
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 65 cost time: 1.1973822116851807
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 1.3760943412780762
Epoch: 66, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 67 cost time: 1.2294971942901611
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 68 cost time: 1.3086574077606201
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 69 cost time: 1.4699957370758057
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 70 cost time: 1.400766134262085
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 71 cost time: 1.3450727462768555
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 72 cost time: 1.3802103996276855
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.852 Test Loss: 0.492 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 73 cost time: 1.4495046138763428
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855551).  Saving model ...
Epoch: 74 cost time: 1.4490811824798584
Epoch: 74, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 75 cost time: 1.4657409191131592
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 76 cost time: 1.421809196472168
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 77 cost time: 1.556351900100708
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 78 cost time: 1.4833526611328125
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 79 cost time: 1.3178925514221191
Epoch: 79, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 80 cost time: 1.4765558242797852
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 81 cost time: 1.3962764739990234
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 82 cost time: 1.4026026725769043
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 83 cost time: 1.2560575008392334
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 84 cost time: 1.239612102508545
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 85 cost time: 1.4228978157043457
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 86 cost time: 1.2743020057678223
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 87 cost time: 1.4264118671417236
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 88 cost time: 1.5837883949279785
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 89 cost time: 1.4692983627319336
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 90 cost time: 1.5892760753631592
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 91 cost time: 1.691256046295166
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 92 cost time: 1.4742753505706787
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 93 cost time: 1.8151776790618896
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 94 cost time: 1.4933195114135742
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 95 cost time: 1.5286064147949219
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 96 cost time: 1.283493995666504
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 97 cost time: 1.3862452507019043
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 98 cost time: 1.239551305770874
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 99 cost time: 1.2971527576446533
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 100 cost time: 1.3111777305603027
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.063368558883667
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.887 Vali Acc: 0.126 Test Loss: 1.887 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 1.2759194374084473
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.859 Vali Acc: 0.137 Test Loss: 1.859 Test Acc: 0.137
Validation loss decreased (-0.125907 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 1.296684741973877
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.824 Vali Acc: 0.174 Test Loss: 1.824 Test Acc: 0.174
Validation loss decreased (-0.137018 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 1.3435883522033691
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.771 Vali Acc: 0.233 Test Loss: 1.771 Test Acc: 0.233
Validation loss decreased (-0.174056 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 1.376857042312622
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.705 Vali Acc: 0.322 Test Loss: 1.705 Test Acc: 0.322
Validation loss decreased (-0.233316 --> -0.322205).  Saving model ...
Epoch: 6 cost time: 1.3380794525146484
Epoch: 6, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.629 Vali Acc: 0.400 Test Loss: 1.629 Test Acc: 0.400
Validation loss decreased (-0.322205 --> -0.399984).  Saving model ...
Epoch: 7 cost time: 1.3865962028503418
Epoch: 7, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.547 Vali Acc: 0.474 Test Loss: 1.547 Test Acc: 0.474
Validation loss decreased (-0.399984 --> -0.474059).  Saving model ...
Epoch: 8 cost time: 1.2651641368865967
Epoch: 8, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.463 Vali Acc: 0.552 Test Loss: 1.463 Test Acc: 0.552
Validation loss decreased (-0.474059 --> -0.551837).  Saving model ...
Epoch: 9 cost time: 1.223609209060669
Epoch: 9, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.379 Vali Acc: 0.604 Test Loss: 1.379 Test Acc: 0.604
Validation loss decreased (-0.551837 --> -0.603690).  Saving model ...
Epoch: 10 cost time: 1.288766622543335
Epoch: 10, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.297 Vali Acc: 0.641 Test Loss: 1.297 Test Acc: 0.641
Validation loss decreased (-0.603690 --> -0.640728).  Saving model ...
Epoch: 11 cost time: 1.2748985290527344
Epoch: 11, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.219 Vali Acc: 0.652 Test Loss: 1.219 Test Acc: 0.652
Validation loss decreased (-0.640728 --> -0.651840).  Saving model ...
Epoch: 12 cost time: 1.395298719406128
Epoch: 12, Steps: 2 | Train Loss: 0.811 Vali Loss: 1.147 Vali Acc: 0.663 Test Loss: 1.147 Test Acc: 0.663
Validation loss decreased (-0.651840 --> -0.662951).  Saving model ...
Epoch: 13 cost time: 1.438485860824585
Epoch: 13, Steps: 2 | Train Loss: 0.675 Vali Loss: 1.082 Vali Acc: 0.681 Test Loss: 1.082 Test Acc: 0.681
Validation loss decreased (-0.662951 --> -0.681471).  Saving model ...
Epoch: 14 cost time: 1.303119421005249
Epoch: 14, Steps: 2 | Train Loss: 0.611 Vali Loss: 1.022 Vali Acc: 0.689 Test Loss: 1.022 Test Acc: 0.689
Validation loss decreased (-0.681471 --> -0.688879).  Saving model ...
Epoch: 15 cost time: 1.2053585052490234
Epoch: 15, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.969 Vali Acc: 0.696 Test Loss: 0.969 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696287).  Saving model ...
Epoch: 16 cost time: 1.252079963684082
Epoch: 16, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.918 Vali Acc: 0.704 Test Loss: 0.918 Test Acc: 0.704
Validation loss decreased (-0.696287 --> -0.703695).  Saving model ...
Epoch: 17 cost time: 1.328493356704712
Epoch: 17, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.703695 --> -0.722213).  Saving model ...
Epoch: 18 cost time: 1.4460432529449463
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.832 Vali Acc: 0.719 Test Loss: 0.832 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.264146089553833
Epoch: 19, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737029).  Saving model ...
Epoch: 20 cost time: 1.2762572765350342
Epoch: 20, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.769 Vali Acc: 0.741 Test Loss: 0.769 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 21 cost time: 1.147571325302124
Epoch: 21, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.744 Vali Acc: 0.748 Test Loss: 0.744 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748141).  Saving model ...
Epoch: 22 cost time: 1.3001432418823242
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.724 Vali Acc: 0.752 Test Loss: 0.724 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 23 cost time: 1.448477029800415
Epoch: 23, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 1.3721590042114258
Epoch: 24, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.694 Vali Acc: 0.752 Test Loss: 0.694 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2753267288208008
Epoch: 25, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.682 Vali Acc: 0.759 Test Loss: 0.682 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 26 cost time: 1.2155871391296387
Epoch: 26, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 27 cost time: 1.4556033611297607
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.665 Vali Acc: 0.770 Test Loss: 0.665 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 28 cost time: 1.4589002132415771
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.658 Vali Acc: 0.774 Test Loss: 0.658 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 29 cost time: 1.3783636093139648
Epoch: 29, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.652 Vali Acc: 0.781 Test Loss: 0.652 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781475).  Saving model ...
Epoch: 30 cost time: 1.4328663349151611
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.648 Vali Acc: 0.785 Test Loss: 0.648 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 31 cost time: 1.31374192237854
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788882).  Saving model ...
Epoch: 32 cost time: 1.3863818645477295
Epoch: 32, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.641 Vali Acc: 0.793 Test Loss: 0.641 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 33 cost time: 1.3133001327514648
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.637 Vali Acc: 0.793 Test Loss: 0.637 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 34 cost time: 1.5469410419464111
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 35 cost time: 1.2894446849822998
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.793 Test Loss: 0.631 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.235039472579956
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 37 cost time: 1.2232730388641357
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 38 cost time: 1.2186694145202637
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.623 Vali Acc: 0.804 Test Loss: 0.623 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 39 cost time: 1.4654779434204102
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 40 cost time: 1.2837903499603271
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 41 cost time: 1.326108694076538
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 42 cost time: 1.3232131004333496
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 43 cost time: 1.377526044845581
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 44 cost time: 1.1259243488311768
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.807 Test Loss: 0.605 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 45 cost time: 1.427785873413086
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.807 Test Loss: 0.602 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 46 cost time: 1.3019042015075684
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.807 Test Loss: 0.599 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 47 cost time: 1.5067799091339111
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.807 Test Loss: 0.597 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 48 cost time: 1.291764497756958
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.807 Test Loss: 0.595 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 49 cost time: 1.2420547008514404
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.807 Test Loss: 0.592 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 50 cost time: 1.1839134693145752
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.807 Test Loss: 0.590 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807402).  Saving model ...
Epoch: 51 cost time: 1.3200554847717285
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.336777687072754
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.804 Test Loss: 0.585 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1628830432891846
Epoch: 53, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1786813735961914
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.807 Test Loss: 0.581 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 55 cost time: 1.281022071838379
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.807 Test Loss: 0.579 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 56 cost time: 1.265932559967041
Epoch: 56, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.807 Test Loss: 0.577 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 57 cost time: 1.4181537628173828
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.811 Test Loss: 0.575 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 58 cost time: 1.244663953781128
Epoch: 58, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.815 Test Loss: 0.573 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 59 cost time: 1.311058521270752
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 60 cost time: 1.2825164794921875
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 61 cost time: 1.2423686981201172
Epoch: 61, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 62 cost time: 1.2065811157226562
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 63 cost time: 1.2917606830596924
Epoch: 63, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 64 cost time: 1.3269946575164795
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 65 cost time: 1.2285699844360352
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 66 cost time: 1.3427350521087646
Epoch: 66, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 67 cost time: 1.315342664718628
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 68 cost time: 1.3820462226867676
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 69 cost time: 1.1885254383087158
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 70 cost time: 1.1676666736602783
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 71 cost time: 1.3488030433654785
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 72 cost time: 1.1981143951416016
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 73 cost time: 1.3845324516296387
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 74 cost time: 1.1650118827819824
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 75 cost time: 1.2429006099700928
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 76 cost time: 1.4040260314941406
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825921).  Saving model ...
Epoch: 77 cost time: 1.484102725982666
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 78 cost time: 1.5064692497253418
Epoch: 78, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 79 cost time: 1.4742774963378906
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 80 cost time: 1.3762202262878418
Epoch: 80, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 81 cost time: 1.3739359378814697
Epoch: 81, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.830 Test Loss: 0.537 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 82 cost time: 1.1924142837524414
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.830 Test Loss: 0.536 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 83 cost time: 1.5082480907440186
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.830 Test Loss: 0.534 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 84 cost time: 1.1845102310180664
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.830 Test Loss: 0.533 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 85 cost time: 1.2927098274230957
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.830 Test Loss: 0.532 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 86 cost time: 1.3127212524414062
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 87 cost time: 1.2789583206176758
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 88 cost time: 1.1606712341308594
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 89 cost time: 1.1722819805145264
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 90 cost time: 1.3105807304382324
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 91 cost time: 1.2810497283935547
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 92 cost time: 1.46805739402771
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 93 cost time: 1.4330379962921143
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 94 cost time: 1.4562280178070068
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 95 cost time: 1.2641723155975342
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 96 cost time: 1.2302381992340088
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 97 cost time: 1.3371574878692627
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 98 cost time: 1.5456445217132568
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.3549189567565918
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 100 cost time: 1.3917245864868164
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8703999519348145
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.927 Vali Acc: 0.115 Test Loss: 1.927 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.229966163635254
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.904 Vali Acc: 0.122 Test Loss: 1.904 Test Acc: 0.122
Validation loss decreased (-0.114796 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 1.2896273136138916
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.877 Vali Acc: 0.144 Test Loss: 1.877 Test Acc: 0.144
Validation loss decreased (-0.122203 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.364072322845459
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.835 Vali Acc: 0.163 Test Loss: 1.835 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 1.2429656982421875
Epoch: 5, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.783 Vali Acc: 0.237 Test Loss: 1.783 Test Acc: 0.237
Validation loss decreased (-0.162945 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 1.3567419052124023
Epoch: 6, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.723 Vali Acc: 0.296 Test Loss: 1.723 Test Acc: 0.296
Validation loss decreased (-0.237019 --> -0.296279).  Saving model ...
Epoch: 7 cost time: 1.375349998474121
Epoch: 7, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.658 Vali Acc: 0.407 Test Loss: 1.658 Test Acc: 0.407
Validation loss decreased (-0.296279 --> -0.407391).  Saving model ...
Epoch: 8 cost time: 1.45485258102417
Epoch: 8, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.589 Vali Acc: 0.485 Test Loss: 1.589 Test Acc: 0.485
Validation loss decreased (-0.407391 --> -0.485169).  Saving model ...
Epoch: 9 cost time: 1.379288673400879
Epoch: 9, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.520 Vali Acc: 0.526 Test Loss: 1.520 Test Acc: 0.526
Validation loss decreased (-0.485169 --> -0.525911).  Saving model ...
Epoch: 10 cost time: 1.1772174835205078
Epoch: 10, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.451 Vali Acc: 0.574 Test Loss: 1.451 Test Acc: 0.574
Validation loss decreased (-0.525911 --> -0.574060).  Saving model ...
Epoch: 11 cost time: 1.2154693603515625
Epoch: 11, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.385 Vali Acc: 0.593 Test Loss: 1.385 Test Acc: 0.593
Validation loss decreased (-0.574060 --> -0.592579).  Saving model ...
Epoch: 12 cost time: 1.21954345703125
Epoch: 12, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.322 Vali Acc: 0.607 Test Loss: 1.322 Test Acc: 0.607
Validation loss decreased (-0.592579 --> -0.607394).  Saving model ...
Epoch: 13 cost time: 1.413282871246338
Epoch: 13, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.263 Vali Acc: 0.600 Test Loss: 1.263 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.28890061378479
Epoch: 14, Steps: 2 | Train Loss: 0.734 Vali Loss: 1.208 Vali Acc: 0.615 Test Loss: 1.208 Test Acc: 0.615
Validation loss decreased (-0.607394 --> -0.614803).  Saving model ...
Epoch: 15 cost time: 1.28029203414917
Epoch: 15, Steps: 2 | Train Loss: 0.617 Vali Loss: 1.156 Vali Acc: 0.626 Test Loss: 1.156 Test Acc: 0.626
Validation loss decreased (-0.614803 --> -0.625914).  Saving model ...
Epoch: 16 cost time: 1.1750178337097168
Epoch: 16, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.105 Vali Acc: 0.656 Test Loss: 1.105 Test Acc: 0.656
Validation loss decreased (-0.625914 --> -0.655545).  Saving model ...
Epoch: 17 cost time: 1.2604343891143799
Epoch: 17, Steps: 2 | Train Loss: 0.417 Vali Loss: 1.059 Vali Acc: 0.674 Test Loss: 1.059 Test Acc: 0.674
Validation loss decreased (-0.655545 --> -0.674063).  Saving model ...
Epoch: 18 cost time: 1.160031795501709
Epoch: 18, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.018 Vali Acc: 0.689 Test Loss: 1.018 Test Acc: 0.689
Validation loss decreased (-0.674063 --> -0.688879).  Saving model ...
Epoch: 19 cost time: 1.162451982498169
Epoch: 19, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.982 Vali Acc: 0.696 Test Loss: 0.982 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696286).  Saving model ...
Epoch: 20 cost time: 1.272395372390747
Epoch: 20, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.950 Vali Acc: 0.689 Test Loss: 0.950 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3573451042175293
Epoch: 21, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.921 Vali Acc: 0.704 Test Loss: 0.921 Test Acc: 0.704
Validation loss decreased (-0.696286 --> -0.703694).  Saving model ...
Epoch: 22 cost time: 1.1680757999420166
Epoch: 22, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.896 Vali Acc: 0.711 Test Loss: 0.896 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711102).  Saving model ...
Epoch: 23 cost time: 1.1530816555023193
Epoch: 23, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.875 Vali Acc: 0.715 Test Loss: 0.875 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 24 cost time: 1.4282464981079102
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.856 Vali Acc: 0.719 Test Loss: 0.856 Test Acc: 0.719
Validation loss decreased (-0.714806 --> -0.718510).  Saving model ...
Epoch: 25 cost time: 1.246126651763916
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.841 Vali Acc: 0.719 Test Loss: 0.841 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 26 cost time: 1.6019423007965088
Epoch: 26, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
Validation loss decreased (-0.718510 --> -0.722214).  Saving model ...
Epoch: 27 cost time: 1.5361363887786865
Epoch: 27, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.819 Vali Acc: 0.730 Test Loss: 0.819 Test Acc: 0.730
Validation loss decreased (-0.722214 --> -0.729621).  Saving model ...
Epoch: 28 cost time: 1.355351448059082
Epoch: 28, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.810 Vali Acc: 0.733 Test Loss: 0.810 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 1.4109113216400146
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.802 Vali Acc: 0.733 Test Loss: 0.802 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 30 cost time: 1.310734510421753
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.795 Vali Acc: 0.737 Test Loss: 0.795 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 31 cost time: 1.3520677089691162
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
Validation loss decreased (-0.737029 --> -0.744437).  Saving model ...
Epoch: 32 cost time: 1.5870840549468994
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.783 Vali Acc: 0.752 Test Loss: 0.783 Test Acc: 0.752
Validation loss decreased (-0.744437 --> -0.751844).  Saving model ...
Epoch: 33 cost time: 1.2264347076416016
Epoch: 33, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.778 Vali Acc: 0.752 Test Loss: 0.778 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 34 cost time: 1.2990429401397705
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 35 cost time: 1.2923188209533691
Epoch: 35, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.768 Vali Acc: 0.759 Test Loss: 0.768 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 36 cost time: 1.3541743755340576
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.763 Vali Acc: 0.763 Test Loss: 0.763 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762955).  Saving model ...
Epoch: 37 cost time: 1.2673132419586182
Epoch: 37, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.759 Vali Acc: 0.767 Test Loss: 0.759 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 38 cost time: 1.2050299644470215
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.754 Vali Acc: 0.767 Test Loss: 0.754 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 39 cost time: 1.380798578262329
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.770 Test Loss: 0.749 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 40 cost time: 1.3517696857452393
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.770 Test Loss: 0.744 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 41 cost time: 1.3317036628723145
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.739 Vali Acc: 0.774 Test Loss: 0.739 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 42 cost time: 1.2017910480499268
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.734 Vali Acc: 0.774 Test Loss: 0.734 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 43 cost time: 1.3007307052612305
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.774 Test Loss: 0.730 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 44 cost time: 1.3494136333465576
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 45 cost time: 1.2892918586730957
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.781 Test Loss: 0.722 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 46 cost time: 1.2895190715789795
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.781 Test Loss: 0.718 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 47 cost time: 1.2528250217437744
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.785 Test Loss: 0.715 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 48 cost time: 1.312544345855713
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.785 Test Loss: 0.712 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 49 cost time: 1.3112785816192627
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.785 Test Loss: 0.708 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 50 cost time: 1.1740875244140625
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.785 Test Loss: 0.705 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 51 cost time: 1.3067700862884521
Epoch: 51, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 52 cost time: 1.3611242771148682
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 53 cost time: 1.228623390197754
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.793 Test Loss: 0.696 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 54 cost time: 1.249542236328125
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.796 Test Loss: 0.693 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 55 cost time: 1.2894561290740967
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 56 cost time: 1.4457640647888184
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.804 Test Loss: 0.688 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 57 cost time: 1.46455717086792
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.804 Test Loss: 0.686 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 58 cost time: 1.346398115158081
Epoch: 58, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.804 Test Loss: 0.683 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 59 cost time: 1.3900399208068848
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 60 cost time: 1.3916795253753662
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 61 cost time: 1.3781778812408447
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.804 Test Loss: 0.676 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 62 cost time: 1.346520185470581
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.804 Test Loss: 0.674 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 63 cost time: 1.395920753479004
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.671 Vali Acc: 0.804 Test Loss: 0.671 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 64 cost time: 1.3540880680084229
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 65 cost time: 1.4245638847351074
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.804 Test Loss: 0.667 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 66 cost time: 1.3579504489898682
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811104).  Saving model ...
Epoch: 67 cost time: 1.4970126152038574
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 68 cost time: 1.2962017059326172
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.811 Test Loss: 0.661 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 69 cost time: 1.2580227851867676
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.3732655048370361
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 71 cost time: 1.4249513149261475
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 72 cost time: 1.4283874034881592
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 73 cost time: 1.3858182430267334
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 74 cost time: 1.3537960052490234
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 75 cost time: 1.4144718647003174
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 76 cost time: 1.5971612930297852
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 77 cost time: 1.2304611206054688
Epoch: 77, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 78 cost time: 1.2919487953186035
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 79 cost time: 1.1851959228515625
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 80 cost time: 1.223250150680542
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 81 cost time: 1.2540204524993896
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 82 cost time: 1.2863681316375732
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 83 cost time: 1.287276268005371
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 84 cost time: 1.1565203666687012
Epoch: 84, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.811 Test Loss: 0.638 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 85 cost time: 1.1970882415771484
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 86 cost time: 1.1708996295928955
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 87 cost time: 1.2746152877807617
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 88 cost time: 1.2845487594604492
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.811 Test Loss: 0.632 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 89 cost time: 1.2779991626739502
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.811 Test Loss: 0.631 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 90 cost time: 1.257720947265625
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.811 Test Loss: 0.630 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 91 cost time: 1.261817455291748
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.811 Test Loss: 0.629 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 92 cost time: 1.3924674987792969
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 93 cost time: 1.333348035812378
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.811 Test Loss: 0.627 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 94 cost time: 1.3615524768829346
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 95 cost time: 1.3277337551116943
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.815 Test Loss: 0.625 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 96 cost time: 1.0380780696868896
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 97 cost time: 1.3036255836486816
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 98 cost time: 1.2601947784423828
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.819 Test Loss: 0.622 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 99 cost time: 1.395812749862671
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 100 cost time: 1.119762897491455
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.883418321609497
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.910 Vali Acc: 0.104 Test Loss: 1.910 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 1.3363933563232422
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.895 Vali Acc: 0.130 Test Loss: 1.895 Test Acc: 0.130
Validation loss decreased (-0.103685 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.5078606605529785
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.877 Vali Acc: 0.133 Test Loss: 1.877 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133315).  Saving model ...
Epoch: 4 cost time: 1.4419488906860352
Epoch: 4, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.848 Vali Acc: 0.159 Test Loss: 1.848 Test Acc: 0.159
Validation loss decreased (-0.133315 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 1.3477671146392822
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.812 Vali Acc: 0.219 Test Loss: 1.812 Test Acc: 0.219
Validation loss decreased (-0.159241 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 1.462637186050415
Epoch: 6, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.770 Vali Acc: 0.252 Test Loss: 1.770 Test Acc: 0.252
Validation loss decreased (-0.218500 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 1.2372097969055176
Epoch: 7, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.724 Vali Acc: 0.326 Test Loss: 1.724 Test Acc: 0.326
Validation loss decreased (-0.251834 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 1.3124606609344482
Epoch: 8, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.675 Vali Acc: 0.393 Test Loss: 1.675 Test Acc: 0.393
Validation loss decreased (-0.325909 --> -0.392576).  Saving model ...
Epoch: 9 cost time: 1.4180972576141357
Epoch: 9, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.624 Vali Acc: 0.452 Test Loss: 1.624 Test Acc: 0.452
Validation loss decreased (-0.392576 --> -0.451836).  Saving model ...
Epoch: 10 cost time: 1.1889755725860596
Epoch: 10, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.572 Vali Acc: 0.474 Test Loss: 1.572 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474058).  Saving model ...
Epoch: 11 cost time: 1.1597063541412354
Epoch: 11, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.522 Vali Acc: 0.485 Test Loss: 1.522 Test Acc: 0.485
Validation loss decreased (-0.474058 --> -0.485170).  Saving model ...
Epoch: 12 cost time: 1.1853935718536377
Epoch: 12, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.472 Vali Acc: 0.496 Test Loss: 1.472 Test Acc: 0.496
Validation loss decreased (-0.485170 --> -0.496282).  Saving model ...
Epoch: 13 cost time: 1.2384893894195557
Epoch: 13, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.425 Vali Acc: 0.511 Test Loss: 1.425 Test Acc: 0.511
Validation loss decreased (-0.496282 --> -0.511097).  Saving model ...
Epoch: 14 cost time: 1.37880539894104
Epoch: 14, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.381 Vali Acc: 0.530 Test Loss: 1.381 Test Acc: 0.530
Validation loss decreased (-0.511097 --> -0.529616).  Saving model ...
Epoch: 15 cost time: 1.2640862464904785
Epoch: 15, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.339 Vali Acc: 0.530 Test Loss: 1.339 Test Acc: 0.530
Validation loss decreased (-0.529616 --> -0.529616).  Saving model ...
Epoch: 16 cost time: 1.3724303245544434
Epoch: 16, Steps: 2 | Train Loss: 0.727 Vali Loss: 1.297 Vali Acc: 0.526 Test Loss: 1.297 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3345935344696045
Epoch: 17, Steps: 2 | Train Loss: 0.653 Vali Loss: 1.258 Vali Acc: 0.533 Test Loss: 1.258 Test Acc: 0.533
Validation loss decreased (-0.529616 --> -0.533321).  Saving model ...
Epoch: 18 cost time: 1.3903472423553467
Epoch: 18, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.223 Vali Acc: 0.552 Test Loss: 1.223 Test Acc: 0.552
Validation loss decreased (-0.533321 --> -0.551840).  Saving model ...
Epoch: 19 cost time: 1.4939079284667969
Epoch: 19, Steps: 2 | Train Loss: 0.473 Vali Loss: 1.192 Vali Acc: 0.563 Test Loss: 1.192 Test Acc: 0.563
Validation loss decreased (-0.551840 --> -0.562951).  Saving model ...
Epoch: 20 cost time: 1.5718731880187988
Epoch: 20, Steps: 2 | Train Loss: 0.431 Vali Loss: 1.163 Vali Acc: 0.581 Test Loss: 1.163 Test Acc: 0.581
Validation loss decreased (-0.562951 --> -0.581470).  Saving model ...
Epoch: 21 cost time: 1.3209941387176514
Epoch: 21, Steps: 2 | Train Loss: 0.334 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
Validation loss decreased (-0.581470 --> -0.581470).  Saving model ...
Epoch: 22 cost time: 1.3578765392303467
Epoch: 22, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.100 Vali Acc: 0.593 Test Loss: 1.100 Test Acc: 0.593
Validation loss decreased (-0.581470 --> -0.592582).  Saving model ...
Epoch: 23 cost time: 1.3952293395996094
Epoch: 23, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.592582 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 1.3609070777893066
Epoch: 24, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.041 Vali Acc: 0.604 Test Loss: 1.041 Test Acc: 0.604
Validation loss decreased (-0.599989 --> -0.603693).  Saving model ...
Epoch: 25 cost time: 1.3108482360839844
Epoch: 25, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
Validation loss decreased (-0.603693 --> -0.622212).  Saving model ...
Epoch: 26 cost time: 1.467177152633667
Epoch: 26, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.988 Vali Acc: 0.630 Test Loss: 0.988 Test Acc: 0.630
Validation loss decreased (-0.622212 --> -0.629620).  Saving model ...
Epoch: 27 cost time: 1.2672703266143799
Epoch: 27, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.965 Vali Acc: 0.637 Test Loss: 0.965 Test Acc: 0.637
Validation loss decreased (-0.629620 --> -0.637027).  Saving model ...
Epoch: 28 cost time: 1.3853435516357422
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.942 Vali Acc: 0.656 Test Loss: 0.942 Test Acc: 0.656
Validation loss decreased (-0.637027 --> -0.655546).  Saving model ...
Epoch: 29 cost time: 1.4083020687103271
Epoch: 29, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.921 Vali Acc: 0.667 Test Loss: 0.921 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 1.3231630325317383
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.902 Vali Acc: 0.678 Test Loss: 0.902 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 31 cost time: 1.4971661567687988
Epoch: 31, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.886 Vali Acc: 0.678 Test Loss: 0.886 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 32 cost time: 1.3966326713562012
Epoch: 32, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.871 Vali Acc: 0.678 Test Loss: 0.871 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 33 cost time: 1.3147623538970947
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.856 Vali Acc: 0.689 Test Loss: 0.856 Test Acc: 0.689
Validation loss decreased (-0.677769 --> -0.688880).  Saving model ...
Epoch: 34 cost time: 1.4334604740142822
Epoch: 34, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.842 Vali Acc: 0.696 Test Loss: 0.842 Test Acc: 0.696
Validation loss decreased (-0.688880 --> -0.696288).  Saving model ...
Epoch: 35 cost time: 1.4194822311401367
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.829 Vali Acc: 0.707 Test Loss: 0.829 Test Acc: 0.707
Validation loss decreased (-0.696288 --> -0.707399).  Saving model ...
Epoch: 36 cost time: 1.4204492568969727
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.818 Vali Acc: 0.707 Test Loss: 0.818 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 37 cost time: 1.292341709136963
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.807 Vali Acc: 0.715 Test Loss: 0.807 Test Acc: 0.715
Validation loss decreased (-0.707399 --> -0.714807).  Saving model ...
Epoch: 38 cost time: 1.221092700958252
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
Validation loss decreased (-0.714807 --> -0.722214).  Saving model ...
Epoch: 39 cost time: 1.483128547668457
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 40 cost time: 1.245168924331665
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.775 Vali Acc: 0.730 Test Loss: 0.775 Test Acc: 0.730
Validation loss decreased (-0.722214 --> -0.729622).  Saving model ...
Epoch: 41 cost time: 1.3634428977966309
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.764 Vali Acc: 0.730 Test Loss: 0.764 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 42 cost time: 1.3263599872589111
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.754 Vali Acc: 0.730 Test Loss: 0.754 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 43 cost time: 1.2734181880950928
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.745 Vali Acc: 0.737 Test Loss: 0.745 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737030).  Saving model ...
Epoch: 44 cost time: 1.2855594158172607
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
Validation loss decreased (-0.737030 --> -0.737030).  Saving model ...
Epoch: 45 cost time: 1.1635749340057373
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.729 Vali Acc: 0.741 Test Loss: 0.729 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740733).  Saving model ...
Epoch: 46 cost time: 1.2621567249298096
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740734).  Saving model ...
Epoch: 47 cost time: 1.21771240234375
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744437).  Saving model ...
Epoch: 48 cost time: 1.218263864517212
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.712 Vali Acc: 0.752 Test Loss: 0.712 Test Acc: 0.752
Validation loss decreased (-0.744437 --> -0.751845).  Saving model ...
Epoch: 49 cost time: 1.4966635704040527
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.707 Vali Acc: 0.752 Test Loss: 0.707 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 50 cost time: 1.321643352508545
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.752 Test Loss: 0.702 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 51 cost time: 1.3436176776885986
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 52 cost time: 1.5731565952301025
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.694 Vali Acc: 0.759 Test Loss: 0.694 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759252).  Saving model ...
Epoch: 53 cost time: 1.3902745246887207
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.759 Test Loss: 0.691 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 54 cost time: 1.3200225830078125
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.759 Test Loss: 0.688 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 55 cost time: 1.4252381324768066
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.759 Test Loss: 0.685 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 56 cost time: 1.1826932430267334
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.759 Test Loss: 0.682 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 57 cost time: 1.4365761280059814
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.759 Test Loss: 0.680 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 58 cost time: 1.3586387634277344
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.759 Test Loss: 0.677 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 59 cost time: 1.210900068283081
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.763 Test Loss: 0.674 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 60 cost time: 1.4711925983428955
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 61 cost time: 1.2950084209442139
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.767 Test Loss: 0.668 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 62 cost time: 1.32598876953125
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.767 Test Loss: 0.664 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 63 cost time: 1.2337448596954346
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.770 Test Loss: 0.661 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 64 cost time: 1.2211127281188965
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.770 Test Loss: 0.659 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 65 cost time: 1.5105881690979004
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 66 cost time: 1.24647855758667
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.774 Test Loss: 0.654 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 67 cost time: 1.3283751010894775
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.774 Test Loss: 0.651 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 68 cost time: 1.3260483741760254
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.774 Test Loss: 0.649 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 69 cost time: 1.419382095336914
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.774 Test Loss: 0.648 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 70 cost time: 1.337996482849121
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.774 Test Loss: 0.646 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 71 cost time: 1.227447748184204
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.774 Test Loss: 0.645 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 72 cost time: 1.2647731304168701
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.774 Test Loss: 0.643 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 73 cost time: 1.5192973613739014
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.774 Test Loss: 0.641 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 74 cost time: 1.272892951965332
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.774 Test Loss: 0.640 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 75 cost time: 1.2460761070251465
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.774 Test Loss: 0.639 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 76 cost time: 1.265885591506958
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.774 Test Loss: 0.637 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 77 cost time: 1.4012343883514404
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.774 Test Loss: 0.636 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 78 cost time: 1.1595752239227295
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.774 Test Loss: 0.636 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 79 cost time: 1.2366089820861816
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.778 Test Loss: 0.635 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777771).  Saving model ...
Epoch: 80 cost time: 1.3522160053253174
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.778 Test Loss: 0.633 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 81 cost time: 1.4049909114837646
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.778 Test Loss: 0.632 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 82 cost time: 1.3996798992156982
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 83 cost time: 1.3589348793029785
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 84 cost time: 1.4134318828582764
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 85 cost time: 1.3313860893249512
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 86 cost time: 1.243405818939209
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.793 Test Loss: 0.626 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 87 cost time: 1.2866268157958984
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.793 Test Loss: 0.625 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 88 cost time: 1.4675123691558838
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.793 Test Loss: 0.624 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 89 cost time: 1.2629222869873047
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.793 Test Loss: 0.623 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 90 cost time: 1.1729350090026855
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.793 Test Loss: 0.622 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 91 cost time: 1.2334933280944824
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.793 Test Loss: 0.620 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 92 cost time: 1.2411606311798096
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.793 Test Loss: 0.618 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 93 cost time: 1.3051567077636719
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.793 Test Loss: 0.617 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 94 cost time: 1.2770814895629883
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.793 Test Loss: 0.615 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 95 cost time: 1.2992634773254395
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 96 cost time: 1.3935840129852295
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 97 cost time: 1.3140525817871094
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 98 cost time: 1.2843172550201416
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 99 cost time: 1.452228307723999
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 100 cost time: 1.3113491535186768
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.077591896057129
Epoch: 1, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.865 Vali Acc: 0.137 Test Loss: 1.865 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 1.5350162982940674
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.856 Vali Acc: 0.152 Test Loss: 1.856 Test Acc: 0.152
Validation loss decreased (-0.137018 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 1.259718418121338
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.843 Vali Acc: 0.156 Test Loss: 1.843 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 1.1448349952697754
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.821 Vali Acc: 0.178 Test Loss: 1.821 Test Acc: 0.178
Validation loss decreased (-0.155537 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 1.4076693058013916
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.793 Vali Acc: 0.204 Test Loss: 1.793 Test Acc: 0.204
Validation loss decreased (-0.177760 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 1.2105302810668945
Epoch: 6, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.759 Vali Acc: 0.230 Test Loss: 1.759 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 7 cost time: 1.3015432357788086
Epoch: 7, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.722 Vali Acc: 0.296 Test Loss: 1.722 Test Acc: 0.296
Validation loss decreased (-0.229612 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 1.379836082458496
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.681 Vali Acc: 0.381 Test Loss: 1.681 Test Acc: 0.381
Validation loss decreased (-0.296279 --> -0.381465).  Saving model ...
Epoch: 9 cost time: 1.2142384052276611
Epoch: 9, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.638 Vali Acc: 0.422 Test Loss: 1.638 Test Acc: 0.422
Validation loss decreased (-0.381465 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 1.4410104751586914
Epoch: 10, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.592 Vali Acc: 0.470 Test Loss: 1.592 Test Acc: 0.470
Validation loss decreased (-0.422206 --> -0.470354).  Saving model ...
Epoch: 11 cost time: 1.2349040508270264
Epoch: 11, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
Validation loss decreased (-0.470354 --> -0.518503).  Saving model ...
Epoch: 12 cost time: 1.1666994094848633
Epoch: 12, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.495 Vali Acc: 0.552 Test Loss: 1.495 Test Acc: 0.552
Validation loss decreased (-0.518503 --> -0.551837).  Saving model ...
Epoch: 13 cost time: 1.2704355716705322
Epoch: 13, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.444 Vali Acc: 0.585 Test Loss: 1.444 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 14 cost time: 1.3909845352172852
Epoch: 14, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.395 Vali Acc: 0.619 Test Loss: 1.395 Test Acc: 0.619
Validation loss decreased (-0.585171 --> -0.618505).  Saving model ...
Epoch: 15 cost time: 1.4604721069335938
Epoch: 15, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.344 Vali Acc: 0.626 Test Loss: 1.344 Test Acc: 0.626
Validation loss decreased (-0.618505 --> -0.625912).  Saving model ...
Epoch: 16 cost time: 1.2805304527282715
Epoch: 16, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.292 Vali Acc: 0.652 Test Loss: 1.292 Test Acc: 0.652
Validation loss decreased (-0.625912 --> -0.651839).  Saving model ...
Epoch: 17 cost time: 1.4400076866149902
Epoch: 17, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.240 Vali Acc: 0.667 Test Loss: 1.240 Test Acc: 0.667
Validation loss decreased (-0.651839 --> -0.666654).  Saving model ...
Epoch: 18 cost time: 1.480029582977295
Epoch: 18, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.189 Vali Acc: 0.670 Test Loss: 1.189 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.670358).  Saving model ...
Epoch: 19 cost time: 1.3831415176391602
Epoch: 19, Steps: 2 | Train Loss: 0.789 Vali Loss: 1.139 Vali Acc: 0.678 Test Loss: 1.139 Test Acc: 0.678
Validation loss decreased (-0.670358 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 1.1514160633087158
Epoch: 20, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.089 Vali Acc: 0.696 Test Loss: 1.089 Test Acc: 0.696
Validation loss decreased (-0.677766 --> -0.696285).  Saving model ...
Epoch: 21 cost time: 1.1172709465026855
Epoch: 21, Steps: 2 | Train Loss: 0.566 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.696285 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 1.3192076683044434
Epoch: 22, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.990 Vali Acc: 0.715 Test Loss: 0.990 Test Acc: 0.715
Validation loss decreased (-0.699990 --> -0.714805).  Saving model ...
Epoch: 23 cost time: 1.1406450271606445
Epoch: 23, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
Validation loss decreased (-0.714805 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 1.2771971225738525
Epoch: 24, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.902 Vali Acc: 0.715 Test Loss: 0.902 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2394027709960938
Epoch: 25, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.862 Vali Acc: 0.722 Test Loss: 0.862 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 26 cost time: 1.378561019897461
Epoch: 26, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.823 Vali Acc: 0.733 Test Loss: 0.823 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 1.3651769161224365
Epoch: 27, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 28 cost time: 1.4089624881744385
Epoch: 28, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 29 cost time: 1.423600435256958
Epoch: 29, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.738 Vali Acc: 0.730 Test Loss: 0.738 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2742252349853516
Epoch: 30, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.715 Vali Acc: 0.741 Test Loss: 0.715 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740734).  Saving model ...
Epoch: 31 cost time: 1.2827181816101074
Epoch: 31, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744437).  Saving model ...
Epoch: 32 cost time: 1.3258419036865234
Epoch: 32, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 33 cost time: 1.2779462337493896
Epoch: 33, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.674 Vali Acc: 0.744 Test Loss: 0.674 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 34 cost time: 1.2434287071228027
Epoch: 34, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 35 cost time: 1.0952999591827393
Epoch: 35, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.755549 --> -0.762957).  Saving model ...
Epoch: 36 cost time: 1.4714670181274414
Epoch: 36, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
Validation loss decreased (-0.762957 --> -0.766660).  Saving model ...
Epoch: 37 cost time: 1.2582437992095947
Epoch: 37, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.617 Vali Acc: 0.770 Test Loss: 0.617 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 38 cost time: 1.2445809841156006
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 39 cost time: 1.2803311347961426
Epoch: 39, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.592 Vali Acc: 0.774 Test Loss: 0.592 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 40 cost time: 1.157813310623169
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.584 Vali Acc: 0.774 Test Loss: 0.584 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 41 cost time: 1.1988821029663086
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.781 Test Loss: 0.576 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781476).  Saving model ...
Epoch: 42 cost time: 1.3749353885650635
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.574 Vali Acc: 0.778 Test Loss: 0.574 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4707436561584473
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.571 Vali Acc: 0.778 Test Loss: 0.571 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.264235258102417
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.569 Vali Acc: 0.781 Test Loss: 0.569 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 45 cost time: 1.195122241973877
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.565 Vali Acc: 0.781 Test Loss: 0.565 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 46 cost time: 1.2870121002197266
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.561 Vali Acc: 0.781 Test Loss: 0.561 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 47 cost time: 1.373887538909912
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.558 Vali Acc: 0.781 Test Loss: 0.558 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 48 cost time: 1.31111741065979
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.781 Test Loss: 0.555 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 49 cost time: 1.5259301662445068
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.785 Test Loss: 0.551 Test Acc: 0.785
Validation loss decreased (-0.781476 --> -0.785180).  Saving model ...
Epoch: 50 cost time: 1.6207489967346191
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.785 Test Loss: 0.546 Test Acc: 0.785
Validation loss decreased (-0.785180 --> -0.785180).  Saving model ...
Epoch: 51 cost time: 1.1943047046661377
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.785180 --> -0.788883).  Saving model ...
Epoch: 52 cost time: 1.207665205001831
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788884).  Saving model ...
Epoch: 53 cost time: 1.4412691593170166
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.788884 --> -0.796291).  Saving model ...
Epoch: 54 cost time: 1.3581016063690186
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
Validation loss decreased (-0.796291 --> -0.799995).  Saving model ...
Epoch: 55 cost time: 1.4690592288970947
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
Validation loss decreased (-0.799995 --> -0.803698).  Saving model ...
Epoch: 56 cost time: 1.305940866470337
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4166662693023682
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4055633544921875
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.800 Test Loss: 0.524 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4417896270751953
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.4416024684906006
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.518 Vali Acc: 0.800 Test Loss: 0.518 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.4742300510406494
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.804 Test Loss: 0.516 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803699).  Saving model ...
Epoch: 62 cost time: 1.446519136428833
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.804 Test Loss: 0.513 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 63 cost time: 1.563997745513916
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 64 cost time: 1.4677810668945312
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.804 Test Loss: 0.506 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 65 cost time: 1.375826120376587
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.804 Test Loss: 0.502 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 66 cost time: 1.3316702842712402
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 67 cost time: 1.2486357688903809
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
Validation loss decreased (-0.803699 --> -0.803699).  Saving model ...
Epoch: 68 cost time: 1.1605005264282227
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.807 Test Loss: 0.490 Test Acc: 0.807
Validation loss decreased (-0.803699 --> -0.807403).  Saving model ...
Epoch: 69 cost time: 1.2350001335144043
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.811 Test Loss: 0.486 Test Acc: 0.811
Validation loss decreased (-0.807403 --> -0.811106).  Saving model ...
Epoch: 70 cost time: 1.3574872016906738
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.811 Test Loss: 0.482 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 71 cost time: 1.5698118209838867
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
Validation loss decreased (-0.811106 --> -0.818514).  Saving model ...
Epoch: 72 cost time: 1.5031490325927734
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 73 cost time: 1.6844379901885986
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
Validation loss decreased (-0.818514 --> -0.822217).  Saving model ...
Epoch: 74 cost time: 1.312088966369629
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 75 cost time: 1.3977396488189697
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.811 Test Loss: 0.473 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.3852381706237793
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.811 Test Loss: 0.472 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.4076800346374512
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.811 Test Loss: 0.471 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.4308898448944092
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.811 Test Loss: 0.471 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.330406665802002
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.811 Test Loss: 0.471 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.25758957862854
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.811 Test Loss: 0.469 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.3066065311431885
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.811 Test Loss: 0.467 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.3065989017486572
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.1158461570739746
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.1609165668487549
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.815 Test Loss: 0.461 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.884246587753296
Epoch: 1, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.845 Vali Acc: 0.185 Test Loss: 1.845 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 1.2952961921691895
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.838 Vali Acc: 0.189 Test Loss: 1.838 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 1.2843806743621826
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.823 Vali Acc: 0.196 Test Loss: 1.823 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 1.1920523643493652
Epoch: 4, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.791 Vali Acc: 0.230 Test Loss: 1.791 Test Acc: 0.230
Validation loss decreased (-0.196278 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 1.203000783920288
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.749 Vali Acc: 0.278 Test Loss: 1.749 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277760).  Saving model ...
Epoch: 6 cost time: 1.1782572269439697
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.699 Vali Acc: 0.337 Test Loss: 1.699 Test Acc: 0.337
Validation loss decreased (-0.277760 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 1.371830701828003
Epoch: 7, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.642 Vali Acc: 0.404 Test Loss: 1.642 Test Acc: 0.404
Validation loss decreased (-0.337020 --> -0.403687).  Saving model ...
Epoch: 8 cost time: 1.1880288124084473
Epoch: 8, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.580 Vali Acc: 0.459 Test Loss: 1.580 Test Acc: 0.459
Validation loss decreased (-0.403687 --> -0.459243).  Saving model ...
Epoch: 9 cost time: 1.3099689483642578
Epoch: 9, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.515 Vali Acc: 0.481 Test Loss: 1.515 Test Acc: 0.481
Validation loss decreased (-0.459243 --> -0.481466).  Saving model ...
Epoch: 10 cost time: 1.2511420249938965
Epoch: 10, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.447 Vali Acc: 0.511 Test Loss: 1.447 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511097).  Saving model ...
Epoch: 11 cost time: 1.175285816192627
Epoch: 11, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.377 Vali Acc: 0.556 Test Loss: 1.377 Test Acc: 0.556
Validation loss decreased (-0.511097 --> -0.555542).  Saving model ...
Epoch: 12 cost time: 1.2473948001861572
Epoch: 12, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.307 Vali Acc: 0.600 Test Loss: 1.307 Test Acc: 0.600
Validation loss decreased (-0.555542 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 1.2223970890045166
Epoch: 13, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.239 Vali Acc: 0.644 Test Loss: 1.239 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644432).  Saving model ...
Epoch: 14 cost time: 1.2565569877624512
Epoch: 14, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.172 Vali Acc: 0.678 Test Loss: 1.172 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 15 cost time: 1.1594018936157227
Epoch: 15, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.104 Vali Acc: 0.719 Test Loss: 1.104 Test Acc: 0.719
Validation loss decreased (-0.677766 --> -0.718507).  Saving model ...
Epoch: 16 cost time: 1.1842904090881348
Epoch: 16, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.037 Vali Acc: 0.752 Test Loss: 1.037 Test Acc: 0.752
Validation loss decreased (-0.718507 --> -0.751841).  Saving model ...
Epoch: 17 cost time: 1.0809509754180908
Epoch: 17, Steps: 2 | Train Loss: 1.137 Vali Loss: 0.972 Vali Acc: 0.785 Test Loss: 0.972 Test Acc: 0.785
Validation loss decreased (-0.751841 --> -0.785175).  Saving model ...
Epoch: 18 cost time: 1.236696720123291
Epoch: 18, Steps: 2 | Train Loss: 1.135 Vali Loss: 0.908 Vali Acc: 0.811 Test Loss: 0.908 Test Acc: 0.811
Validation loss decreased (-0.785175 --> -0.811102).  Saving model ...
Epoch: 19 cost time: 1.2607650756835938
Epoch: 19, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.849 Vali Acc: 0.822 Test Loss: 0.849 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 1.415104627609253
Epoch: 20, Steps: 2 | Train Loss: 1.054 Vali Loss: 0.794 Vali Acc: 0.844 Test Loss: 0.794 Test Acc: 0.844
Validation loss decreased (-0.822214 --> -0.844437).  Saving model ...
Epoch: 21 cost time: 1.5745503902435303
Epoch: 21, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855548).  Saving model ...
Epoch: 22 cost time: 1.3473501205444336
Epoch: 22, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.690 Vali Acc: 0.870 Test Loss: 0.690 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 23 cost time: 1.4309780597686768
Epoch: 23, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.643 Vali Acc: 0.874 Test Loss: 0.643 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874068).  Saving model ...
Epoch: 24 cost time: 1.2660248279571533
Epoch: 24, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.2542812824249268
Epoch: 25, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.554 Vali Acc: 0.878 Test Loss: 0.554 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.4780068397521973
Epoch: 26, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.515 Vali Acc: 0.874 Test Loss: 0.515 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3913486003875732
Epoch: 27, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1053259372711182
Epoch: 28, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.453 Vali Acc: 0.874 Test Loss: 0.453 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1884183883666992
Epoch: 29, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.429 Vali Acc: 0.881 Test Loss: 0.429 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881477).  Saving model ...
Epoch: 30 cost time: 1.2619225978851318
Epoch: 30, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 31 cost time: 1.1563889980316162
Epoch: 31, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.388 Vali Acc: 0.881 Test Loss: 0.388 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881478).  Saving model ...
Epoch: 32 cost time: 1.2323753833770752
Epoch: 32, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888885).  Saving model ...
Epoch: 33 cost time: 1.3409082889556885
Epoch: 33, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 1.1622314453125
Epoch: 34, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.899997 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 1.3740506172180176
Epoch: 35, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 1.5499563217163086
Epoch: 36, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 1.4666967391967773
Epoch: 37, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 1.5213301181793213
Epoch: 38, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5044984817504883
Epoch: 39, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4597444534301758
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6591415405273438
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.598437786102295
Epoch: 42, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4479897022247314
Epoch: 43, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3353867530822754
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4718027114868164
Epoch: 45, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3541805744171143
Epoch: 46, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.213841438293457
Epoch: 47, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.837038993835449
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.816 Vali Acc: 0.200 Test Loss: 1.816 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.266787052154541
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.810 Vali Acc: 0.204 Test Loss: 1.810 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 1.381413459777832
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.792 Vali Acc: 0.219 Test Loss: 1.792 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 1.3247857093811035
Epoch: 4, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.753 Vali Acc: 0.259 Test Loss: 1.753 Test Acc: 0.259
Validation loss decreased (-0.218501 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 1.256810188293457
Epoch: 5, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.701 Vali Acc: 0.333 Test Loss: 1.701 Test Acc: 0.333
Validation loss decreased (-0.259242 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 1.2782630920410156
Epoch: 6, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.640 Vali Acc: 0.381 Test Loss: 1.640 Test Acc: 0.381
Validation loss decreased (-0.333316 --> -0.381465).  Saving model ...
Epoch: 7 cost time: 1.2662780284881592
Epoch: 7, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.570 Vali Acc: 0.437 Test Loss: 1.570 Test Acc: 0.437
Validation loss decreased (-0.381465 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 1.2011632919311523
Epoch: 8, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.494 Vali Acc: 0.493 Test Loss: 1.494 Test Acc: 0.493
Validation loss decreased (-0.437021 --> -0.492578).  Saving model ...
Epoch: 9 cost time: 1.3135340213775635
Epoch: 9, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.417 Vali Acc: 0.548 Test Loss: 1.417 Test Acc: 0.548
Validation loss decreased (-0.492578 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 1.1387603282928467
Epoch: 10, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.336 Vali Acc: 0.615 Test Loss: 1.336 Test Acc: 0.615
Validation loss decreased (-0.548134 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 1.3122642040252686
Epoch: 11, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.256 Vali Acc: 0.659 Test Loss: 1.256 Test Acc: 0.659
Validation loss decreased (-0.614801 --> -0.659247).  Saving model ...
Epoch: 12 cost time: 1.1150271892547607
Epoch: 12, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.178 Vali Acc: 0.704 Test Loss: 1.178 Test Acc: 0.704
Validation loss decreased (-0.659247 --> -0.703692).  Saving model ...
Epoch: 13 cost time: 1.2980945110321045
Epoch: 13, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.103 Vali Acc: 0.744 Test Loss: 1.103 Test Acc: 0.744
Validation loss decreased (-0.703692 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 1.1289000511169434
Epoch: 14, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.030 Vali Acc: 0.774 Test Loss: 1.030 Test Acc: 0.774
Validation loss decreased (-0.744433 --> -0.774064).  Saving model ...
Epoch: 15 cost time: 1.1866095066070557
Epoch: 15, Steps: 2 | Train Loss: 1.375 Vali Loss: 0.961 Vali Acc: 0.796 Test Loss: 0.961 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 16 cost time: 1.1922187805175781
Epoch: 16, Steps: 2 | Train Loss: 1.296 Vali Loss: 0.895 Vali Acc: 0.804 Test Loss: 0.895 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 1.280287504196167
Epoch: 17, Steps: 2 | Train Loss: 1.258 Vali Loss: 0.832 Vali Acc: 0.815 Test Loss: 0.832 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814806).  Saving model ...
Epoch: 18 cost time: 1.3555736541748047
Epoch: 18, Steps: 2 | Train Loss: 1.186 Vali Loss: 0.773 Vali Acc: 0.837 Test Loss: 0.773 Test Acc: 0.837
Validation loss decreased (-0.814806 --> -0.837029).  Saving model ...
Epoch: 19 cost time: 1.2235922813415527
Epoch: 19, Steps: 2 | Train Loss: 1.093 Vali Loss: 0.718 Vali Acc: 0.870 Test Loss: 0.718 Test Acc: 0.870
Validation loss decreased (-0.837029 --> -0.870363).  Saving model ...
Epoch: 20 cost time: 1.205779790878296
Epoch: 20, Steps: 2 | Train Loss: 1.071 Vali Loss: 0.670 Vali Acc: 0.870 Test Loss: 0.670 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870364).  Saving model ...
Epoch: 21 cost time: 1.1916885375976562
Epoch: 21, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.625 Vali Acc: 0.870 Test Loss: 0.625 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 22 cost time: 1.0823228359222412
Epoch: 22, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.177781581878662
Epoch: 23, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.546 Vali Acc: 0.852 Test Loss: 0.546 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1739792823791504
Epoch: 24, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.227877140045166
Epoch: 25, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4071831703186035
Epoch: 26, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0224440097808838
Epoch: 27, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.429 Vali Acc: 0.863 Test Loss: 0.429 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1992926597595215
Epoch: 28, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.107067584991455
Epoch: 29, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.387 Vali Acc: 0.859 Test Loss: 0.387 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1925325393676758
Epoch: 30, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.367 Vali Acc: 0.867 Test Loss: 0.367 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1183969974517822
Epoch: 31, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877774).  Saving model ...
Epoch: 32 cost time: 1.2430148124694824
Epoch: 32, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 1.0372278690338135
Epoch: 33, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.312 Vali Acc: 0.904 Test Loss: 0.312 Test Acc: 0.904
Validation loss decreased (-0.888886 --> -0.903701).  Saving model ...
Epoch: 34 cost time: 1.1869103908538818
Epoch: 34, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 35 cost time: 1.180471658706665
Epoch: 35, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 36 cost time: 1.1637954711914062
Epoch: 36, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 37 cost time: 1.2701725959777832
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3245289325714111
Epoch: 38, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 39 cost time: 1.3854806423187256
Epoch: 39, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
Validation loss decreased (-0.911108 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 1.205376148223877
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 1.2410235404968262
Epoch: 41, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 1.3438904285430908
Epoch: 42, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 1.1034986972808838
Epoch: 43, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2127506732940674
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2437162399291992
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1983838081359863
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1012647151947021
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2427103519439697
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2623748779296875
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3979835510253906
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.379584789276123
Epoch: 51, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.434753656387329
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2786707878112793
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.3399975299835205
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4797477722167969
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.203887939453125
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4375321865081787
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3109180927276611
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.118055820465088
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1989450454711914
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.087900161743164
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.176654577255249
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1402685642242432
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.57462739944458
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2135474681854248
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.200974464416504
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1586189270019531
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2394757270812988
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3161225318908691
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3903512954711914
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.3047270774841309
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.165698766708374
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.068993091583252
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1759488582611084
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.208817720413208
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2906880378723145
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1051414012908936
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3330140113830566
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2266793251037598
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2819719314575195
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 1368454
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.616652488708496
Epoch: 1, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.891 Vali Acc: 0.093 Test Loss: 1.891 Test Acc: 0.093
Validation loss decreased (inf --> -0.092574).  Saving model ...
Epoch: 2 cost time: 1.1346688270568848
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.855 Vali Acc: 0.100 Test Loss: 1.855 Test Acc: 0.100
Validation loss decreased (-0.092574 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 1.2169721126556396
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.813 Vali Acc: 0.130 Test Loss: 1.813 Test Acc: 0.130
Validation loss decreased (-0.099981 --> -0.129612).  Saving model ...
Epoch: 4 cost time: 1.0116491317749023
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.749 Vali Acc: 0.211 Test Loss: 1.749 Test Acc: 0.211
Validation loss decreased (-0.129612 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 1.2256035804748535
Epoch: 5, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.670 Vali Acc: 0.330 Test Loss: 1.670 Test Acc: 0.330
Validation loss decreased (-0.211094 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 1.114713191986084
Epoch: 6, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.582 Vali Acc: 0.448 Test Loss: 1.582 Test Acc: 0.448
Validation loss decreased (-0.329613 --> -0.448132).  Saving model ...
Epoch: 7 cost time: 1.1492838859558105
Epoch: 7, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.486 Vali Acc: 0.548 Test Loss: 1.486 Test Acc: 0.548
Validation loss decreased (-0.448132 --> -0.548133).  Saving model ...
Epoch: 8 cost time: 1.1634092330932617
Epoch: 8, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.387 Vali Acc: 0.633 Test Loss: 1.387 Test Acc: 0.633
Validation loss decreased (-0.548133 --> -0.633319).  Saving model ...
Epoch: 9 cost time: 1.0727286338806152
Epoch: 9, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.288 Vali Acc: 0.659 Test Loss: 1.288 Test Acc: 0.659
Validation loss decreased (-0.633319 --> -0.659246).  Saving model ...
Epoch: 10 cost time: 1.1821589469909668
Epoch: 10, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.192 Vali Acc: 0.693 Test Loss: 1.192 Test Acc: 0.693
Validation loss decreased (-0.659246 --> -0.692581).  Saving model ...
Epoch: 11 cost time: 1.120361089706421
Epoch: 11, Steps: 2 | Train Loss: 0.845 Vali Loss: 1.099 Vali Acc: 0.722 Test Loss: 1.099 Test Acc: 0.722
Validation loss decreased (-0.692581 --> -0.722211).  Saving model ...
Epoch: 12 cost time: 1.2900166511535645
Epoch: 12, Steps: 2 | Train Loss: 0.710 Vali Loss: 1.012 Vali Acc: 0.733 Test Loss: 1.012 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 1.239382266998291
Epoch: 13, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.933 Vali Acc: 0.744 Test Loss: 0.933 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 1.177027940750122
Epoch: 14, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.863 Vali Acc: 0.748 Test Loss: 0.863 Test Acc: 0.748
Validation loss decreased (-0.744435 --> -0.748140).  Saving model ...
Epoch: 15 cost time: 1.2410461902618408
Epoch: 15, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.803 Vali Acc: 0.763 Test Loss: 0.803 Test Acc: 0.763
Validation loss decreased (-0.748140 --> -0.762955).  Saving model ...
Epoch: 16 cost time: 1.2348151206970215
Epoch: 16, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.752 Vali Acc: 0.781 Test Loss: 0.752 Test Acc: 0.781
Validation loss decreased (-0.762955 --> -0.781474).  Saving model ...
Epoch: 17 cost time: 1.1026380062103271
Epoch: 17, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.709 Vali Acc: 0.781 Test Loss: 0.709 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 18 cost time: 1.1477208137512207
Epoch: 18, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.676 Vali Acc: 0.793 Test Loss: 0.676 Test Acc: 0.793
Validation loss decreased (-0.781474 --> -0.792586).  Saving model ...
Epoch: 19 cost time: 1.2506558895111084
Epoch: 19, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 20 cost time: 1.1241896152496338
Epoch: 20, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 21 cost time: 1.325282335281372
Epoch: 21, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803698).  Saving model ...
Epoch: 22 cost time: 1.0999102592468262
Epoch: 22, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 23 cost time: 1.066223382949829
Epoch: 23, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1468429565429688
Epoch: 24, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.597 Vali Acc: 0.807 Test Loss: 0.597 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 25 cost time: 1.173271894454956
Epoch: 25, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.592 Vali Acc: 0.807 Test Loss: 0.592 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 26 cost time: 1.3036797046661377
Epoch: 26, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 1.2626314163208008
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 28 cost time: 1.125929832458496
Epoch: 28, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 29 cost time: 1.2890191078186035
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 30 cost time: 1.2139437198638916
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 31 cost time: 1.1709177494049072
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 32 cost time: 1.235459804534912
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 33 cost time: 1.344555377960205
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 34 cost time: 1.2027993202209473
Epoch: 34, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 35 cost time: 1.1760847568511963
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 36 cost time: 1.2316005229949951
Epoch: 36, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 37 cost time: 1.2340474128723145
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 38 cost time: 1.0596206188201904
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 39 cost time: 1.3094682693481445
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.830 Test Loss: 0.555 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 40 cost time: 1.32395339012146
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.830 Test Loss: 0.553 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 41 cost time: 1.1269664764404297
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 42 cost time: 1.2862846851348877
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.830 Test Loss: 0.551 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 43 cost time: 1.234351634979248
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 44 cost time: 1.1563727855682373
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 45 cost time: 1.313640832901001
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.117846965789795
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840735).  Saving model ...
Epoch: 47 cost time: 1.1637804508209229
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 48 cost time: 1.2780578136444092
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 49 cost time: 1.1482768058776855
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 50 cost time: 1.1539764404296875
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 51 cost time: 1.0066750049591064
Epoch: 51, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 52 cost time: 1.2602810859680176
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 53 cost time: 1.1922352313995361
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 54 cost time: 1.2511892318725586
Epoch: 54, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 55 cost time: 1.1931447982788086
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 56 cost time: 1.3323218822479248
Epoch: 56, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 57 cost time: 1.2328715324401855
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 58 cost time: 1.2750580310821533
Epoch: 58, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 59 cost time: 1.3538179397583008
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 60 cost time: 1.3666038513183594
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.852 Test Loss: 0.530 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 61 cost time: 1.4107141494750977
Epoch: 61, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.4192676544189453
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3056025505065918
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.3729965686798096
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.4175782203674316
Epoch: 65, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.4150395393371582
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.2870235443115234
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.2864933013916016
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.1497828960418701
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.852 Test Loss: 0.517 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 70 cost time: 1.2251296043395996
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.852 Test Loss: 0.516 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 71 cost time: 1.304443597793579
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.852 Test Loss: 0.515 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 72 cost time: 1.1401865482330322
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.852 Test Loss: 0.514 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 73 cost time: 1.1532618999481201
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855550).  Saving model ...
Epoch: 74 cost time: 1.1446363925933838
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 75 cost time: 1.092200517654419
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 76 cost time: 1.2248790264129639
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 77 cost time: 1.1224799156188965
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 78 cost time: 1.1592485904693604
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 79 cost time: 1.2055892944335938
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 80 cost time: 1.3352704048156738
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 81 cost time: 1.2297816276550293
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 82 cost time: 1.1692836284637451
Epoch: 82, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 83 cost time: 1.2490336894989014
Epoch: 83, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 84 cost time: 1.133263349533081
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 85 cost time: 1.1795732975006104
Epoch: 85, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.874 Test Loss: 0.499 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 86 cost time: 1.1590299606323242
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.874 Test Loss: 0.497 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 87 cost time: 1.2095286846160889
Epoch: 87, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.874 Test Loss: 0.496 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 88 cost time: 1.1709272861480713
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.874 Test Loss: 0.495 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 89 cost time: 1.098299264907837
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.874 Test Loss: 0.493 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 90 cost time: 1.2479169368743896
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.874 Test Loss: 0.492 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 91 cost time: 1.3184773921966553
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.874 Test Loss: 0.491 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 92 cost time: 1.275977373123169
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.874 Test Loss: 0.490 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 93 cost time: 1.3015625476837158
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 94 cost time: 1.3060848712921143
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.881 Test Loss: 0.488 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 95 cost time: 1.4010004997253418
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.881 Test Loss: 0.487 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 96 cost time: 1.2108330726623535
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 97 cost time: 1.1833491325378418
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 98 cost time: 1.2473974227905273
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 99 cost time: 1.1920971870422363
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 100 cost time: 1.1596102714538574
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.885 Test Loss: 0.483 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885180).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6281769275665283
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.913 Vali Acc: 0.074 Test Loss: 1.913 Test Acc: 0.074
Validation loss decreased (inf --> -0.074055).  Saving model ...
Epoch: 2 cost time: 1.0175247192382812
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.885 Vali Acc: 0.081 Test Loss: 1.885 Test Acc: 0.081
Validation loss decreased (-0.074055 --> -0.081463).  Saving model ...
Epoch: 3 cost time: 1.0806059837341309
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.852 Vali Acc: 0.111 Test Loss: 1.852 Test Acc: 0.111
Validation loss decreased (-0.081463 --> -0.111093).  Saving model ...
Epoch: 4 cost time: 1.3178684711456299
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.802 Vali Acc: 0.152 Test Loss: 1.802 Test Acc: 0.152
Validation loss decreased (-0.111093 --> -0.151834).  Saving model ...
Epoch: 5 cost time: 1.3368051052093506
Epoch: 5, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.740 Vali Acc: 0.230 Test Loss: 1.740 Test Acc: 0.230
Validation loss decreased (-0.151834 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 1.117443561553955
Epoch: 6, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.670 Vali Acc: 0.322 Test Loss: 1.670 Test Acc: 0.322
Validation loss decreased (-0.229612 --> -0.322206).  Saving model ...
Epoch: 7 cost time: 1.0901260375976562
Epoch: 7, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.593 Vali Acc: 0.411 Test Loss: 1.593 Test Acc: 0.411
Validation loss decreased (-0.322206 --> -0.411095).  Saving model ...
Epoch: 8 cost time: 1.2687628269195557
Epoch: 8, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.513 Vali Acc: 0.478 Test Loss: 1.513 Test Acc: 0.478
Validation loss decreased (-0.411095 --> -0.477763).  Saving model ...
Epoch: 9 cost time: 1.3027381896972656
Epoch: 9, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.431 Vali Acc: 0.541 Test Loss: 1.431 Test Acc: 0.541
Validation loss decreased (-0.477763 --> -0.540726).  Saving model ...
Epoch: 10 cost time: 1.1149673461914062
Epoch: 10, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.352 Vali Acc: 0.578 Test Loss: 1.352 Test Acc: 0.578
Validation loss decreased (-0.540726 --> -0.577764).  Saving model ...
Epoch: 11 cost time: 1.2866384983062744
Epoch: 11, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.275 Vali Acc: 0.607 Test Loss: 1.275 Test Acc: 0.607
Validation loss decreased (-0.577764 --> -0.607395).  Saving model ...
Epoch: 12 cost time: 1.2154903411865234
Epoch: 12, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.200 Vali Acc: 0.633 Test Loss: 1.200 Test Acc: 0.633
Validation loss decreased (-0.607395 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 1.0972959995269775
Epoch: 13, Steps: 2 | Train Loss: 0.734 Vali Loss: 1.130 Vali Acc: 0.648 Test Loss: 1.130 Test Acc: 0.648
Validation loss decreased (-0.633321 --> -0.648137).  Saving model ...
Epoch: 14 cost time: 1.0797357559204102
Epoch: 14, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.066 Vali Acc: 0.670 Test Loss: 1.066 Test Acc: 0.670
Validation loss decreased (-0.648137 --> -0.670360).  Saving model ...
Epoch: 15 cost time: 1.0144524574279785
Epoch: 15, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (-0.670360 --> -0.688879).  Saving model ...
Epoch: 16 cost time: 1.1290907859802246
Epoch: 16, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 1.1063053607940674
Epoch: 17, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.909 Vali Acc: 0.707 Test Loss: 0.909 Test Acc: 0.707
Validation loss decreased (-0.699990 --> -0.707398).  Saving model ...
Epoch: 18 cost time: 1.1845355033874512
Epoch: 18, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.870 Vali Acc: 0.711 Test Loss: 0.870 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 19 cost time: 1.2007348537445068
Epoch: 19, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.838 Vali Acc: 0.715 Test Loss: 0.838 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 20 cost time: 1.1504673957824707
Epoch: 20, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.812 Vali Acc: 0.715 Test Loss: 0.812 Test Acc: 0.715
Validation loss decreased (-0.714806 --> -0.714807).  Saving model ...
Epoch: 21 cost time: 1.2079904079437256
Epoch: 21, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.791 Vali Acc: 0.726 Test Loss: 0.791 Test Acc: 0.726
Validation loss decreased (-0.714807 --> -0.725918).  Saving model ...
Epoch: 22 cost time: 1.3708302974700928
Epoch: 22, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.774 Vali Acc: 0.737 Test Loss: 0.774 Test Acc: 0.737
Validation loss decreased (-0.725918 --> -0.737029).  Saving model ...
Epoch: 23 cost time: 1.3085260391235352
Epoch: 23, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 24 cost time: 1.314387321472168
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.748 Vali Acc: 0.744 Test Loss: 0.748 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 25 cost time: 1.3632400035858154
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.736 Vali Acc: 0.741 Test Loss: 0.736 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3563306331634521
Epoch: 26, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.725 Vali Acc: 0.748 Test Loss: 0.725 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 27 cost time: 1.4139184951782227
Epoch: 27, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.716 Vali Acc: 0.748 Test Loss: 0.716 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 28 cost time: 1.2676911354064941
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.706 Vali Acc: 0.752 Test Loss: 0.706 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 29 cost time: 1.1916911602020264
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.697 Vali Acc: 0.752 Test Loss: 0.697 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 30 cost time: 1.2872440814971924
Epoch: 30, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.689 Vali Acc: 0.752 Test Loss: 0.689 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 31 cost time: 1.349550485610962
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.682 Vali Acc: 0.759 Test Loss: 0.682 Test Acc: 0.759
Validation loss decreased (-0.751845 --> -0.759252).  Saving model ...
Epoch: 32 cost time: 1.2785189151763916
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.676 Vali Acc: 0.763 Test Loss: 0.676 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 33 cost time: 1.312948226928711
Epoch: 33, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.670 Vali Acc: 0.759 Test Loss: 0.670 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2834322452545166
Epoch: 34, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.664 Vali Acc: 0.767 Test Loss: 0.664 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 35 cost time: 1.2230689525604248
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.659 Vali Acc: 0.770 Test Loss: 0.659 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 36 cost time: 1.4344398975372314
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 37 cost time: 1.2919673919677734
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.781 Test Loss: 0.651 Test Acc: 0.781
Validation loss decreased (-0.770364 --> -0.781475).  Saving model ...
Epoch: 38 cost time: 1.3709640502929688
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 39 cost time: 1.5507431030273438
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.793 Test Loss: 0.643 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 40 cost time: 1.3547983169555664
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 41 cost time: 1.2924680709838867
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 42 cost time: 1.449728012084961
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 43 cost time: 1.4366509914398193
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 44 cost time: 1.4085845947265625
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 45 cost time: 1.2440357208251953
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 1.4032719135284424
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 47 cost time: 1.3418912887573242
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 48 cost time: 1.4890925884246826
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 49 cost time: 1.3783955574035645
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3728079795837402
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 51 cost time: 1.4495587348937988
Epoch: 51, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 52 cost time: 1.5577166080474854
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 53 cost time: 1.5014264583587646
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 54 cost time: 1.4296529293060303
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.804 Test Loss: 0.604 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 55 cost time: 1.4041330814361572
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.804 Test Loss: 0.602 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 56 cost time: 1.3393571376800537
Epoch: 56, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 57 cost time: 1.5144424438476562
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 58 cost time: 1.3147871494293213
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 59 cost time: 1.2265441417694092
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.804 Test Loss: 0.595 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 60 cost time: 1.1121509075164795
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 61 cost time: 1.2551677227020264
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.807 Test Loss: 0.592 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 62 cost time: 1.238985300064087
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.811 Test Loss: 0.590 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 63 cost time: 1.1535377502441406
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.811 Test Loss: 0.589 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 1.3440711498260498
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.811 Test Loss: 0.587 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 65 cost time: 1.3161866664886475
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 66 cost time: 1.2830114364624023
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 67 cost time: 1.4151875972747803
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.811 Test Loss: 0.581 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 68 cost time: 1.305985927581787
Epoch: 68, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 69 cost time: 1.3898649215698242
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 70 cost time: 1.2279431819915771
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 71 cost time: 1.4928171634674072
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 72 cost time: 1.5272154808044434
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 73 cost time: 1.3476803302764893
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 74 cost time: 1.2446529865264893
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 75 cost time: 1.304203748703003
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 76 cost time: 1.4107022285461426
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 77 cost time: 1.3039586544036865
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 78 cost time: 1.2817814350128174
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 79 cost time: 1.2720832824707031
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 80 cost time: 1.5079302787780762
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 81 cost time: 1.3951647281646729
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.481351613998413
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.826 Test Loss: 0.555 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 1.3084309101104736
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 84 cost time: 1.2988252639770508
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 85 cost time: 1.348787784576416
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 86 cost time: 1.278529167175293
Epoch: 86, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 87 cost time: 1.297929286956787
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.2790043354034424
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 89 cost time: 1.3642022609710693
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 90 cost time: 1.251194715499878
Epoch: 90, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 91 cost time: 1.128455400466919
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 92 cost time: 1.2671961784362793
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825921).  Saving model ...
Epoch: 93 cost time: 1.2889931201934814
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 94 cost time: 1.3821406364440918
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.830 Test Loss: 0.540 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 95 cost time: 1.2940483093261719
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 96 cost time: 1.5353119373321533
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 97 cost time: 1.370274305343628
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 98 cost time: 1.4141855239868164
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.3492751121520996
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 100 cost time: 1.495713472366333
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.837 Test Loss: 0.536 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3919949531555176
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.904 Vali Acc: 0.093 Test Loss: 1.904 Test Acc: 0.093
Validation loss decreased (inf --> -0.092574).  Saving model ...
Epoch: 2 cost time: 1.257448673248291
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.883 Vali Acc: 0.104 Test Loss: 1.883 Test Acc: 0.104
Validation loss decreased (-0.092574 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 1.1060519218444824
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.859 Vali Acc: 0.144 Test Loss: 1.859 Test Acc: 0.144
Validation loss decreased (-0.103685 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.210097312927246
Epoch: 4, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.821 Vali Acc: 0.178 Test Loss: 1.821 Test Acc: 0.178
Validation loss decreased (-0.144426 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 1.2374827861785889
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.775 Vali Acc: 0.230 Test Loss: 1.775 Test Acc: 0.230
Validation loss decreased (-0.177760 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 1.037898063659668
Epoch: 6, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.722 Vali Acc: 0.267 Test Loss: 1.722 Test Acc: 0.267
Validation loss decreased (-0.229612 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 1.311727523803711
Epoch: 7, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.664 Vali Acc: 0.330 Test Loss: 1.664 Test Acc: 0.330
Validation loss decreased (-0.266649 --> -0.329613).  Saving model ...
Epoch: 8 cost time: 1.1409685611724854
Epoch: 8, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.601 Vali Acc: 0.385 Test Loss: 1.601 Test Acc: 0.385
Validation loss decreased (-0.329613 --> -0.385169).  Saving model ...
Epoch: 9 cost time: 1.4204514026641846
Epoch: 9, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.538 Vali Acc: 0.430 Test Loss: 1.538 Test Acc: 0.430
Validation loss decreased (-0.385169 --> -0.429614).  Saving model ...
Epoch: 10 cost time: 1.345432996749878
Epoch: 10, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.474 Vali Acc: 0.459 Test Loss: 1.474 Test Acc: 0.459
Validation loss decreased (-0.429614 --> -0.459245).  Saving model ...
Epoch: 11 cost time: 1.2230823040008545
Epoch: 11, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.409 Vali Acc: 0.493 Test Loss: 1.409 Test Acc: 0.493
Validation loss decreased (-0.459245 --> -0.492579).  Saving model ...
Epoch: 12 cost time: 1.1816771030426025
Epoch: 12, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.346 Vali Acc: 0.537 Test Loss: 1.346 Test Acc: 0.537
Validation loss decreased (-0.492579 --> -0.537024).  Saving model ...
Epoch: 13 cost time: 1.1723260879516602
Epoch: 13, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.285 Vali Acc: 0.567 Test Loss: 1.285 Test Acc: 0.567
Validation loss decreased (-0.537024 --> -0.566654).  Saving model ...
Epoch: 14 cost time: 1.2432448863983154
Epoch: 14, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.227 Vali Acc: 0.593 Test Loss: 1.227 Test Acc: 0.593
Validation loss decreased (-0.566654 --> -0.592580).  Saving model ...
Epoch: 15 cost time: 1.1720774173736572
Epoch: 15, Steps: 2 | Train Loss: 0.619 Vali Loss: 1.172 Vali Acc: 0.630 Test Loss: 1.172 Test Acc: 0.630
Validation loss decreased (-0.592580 --> -0.629618).  Saving model ...
Epoch: 16 cost time: 1.2628235816955566
Epoch: 16, Steps: 2 | Train Loss: 0.560 Vali Loss: 1.120 Vali Acc: 0.659 Test Loss: 1.120 Test Acc: 0.659
Validation loss decreased (-0.629618 --> -0.659248).  Saving model ...
Epoch: 17 cost time: 1.078594446182251
Epoch: 17, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.072 Vali Acc: 0.681 Test Loss: 1.072 Test Acc: 0.681
Validation loss decreased (-0.659248 --> -0.681471).  Saving model ...
Epoch: 18 cost time: 1.101074457168579
Epoch: 18, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.028 Vali Acc: 0.689 Test Loss: 1.028 Test Acc: 0.689
Validation loss decreased (-0.681471 --> -0.688879).  Saving model ...
Epoch: 19 cost time: 1.1587190628051758
Epoch: 19, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.989 Vali Acc: 0.696 Test Loss: 0.989 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696286).  Saving model ...
Epoch: 20 cost time: 1.230177640914917
Epoch: 20, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.957 Vali Acc: 0.715 Test Loss: 0.957 Test Acc: 0.715
Validation loss decreased (-0.696286 --> -0.714805).  Saving model ...
Epoch: 21 cost time: 1.2633593082427979
Epoch: 21, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.930 Vali Acc: 0.730 Test Loss: 0.930 Test Acc: 0.730
Validation loss decreased (-0.714805 --> -0.729620).  Saving model ...
Epoch: 22 cost time: 1.2926924228668213
Epoch: 22, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.906 Vali Acc: 0.730 Test Loss: 0.906 Test Acc: 0.730
Validation loss decreased (-0.729620 --> -0.729621).  Saving model ...
Epoch: 23 cost time: 1.379796028137207
Epoch: 23, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.885 Vali Acc: 0.741 Test Loss: 0.885 Test Acc: 0.741
Validation loss decreased (-0.729621 --> -0.740732).  Saving model ...
Epoch: 24 cost time: 1.3565733432769775
Epoch: 24, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.865 Vali Acc: 0.744 Test Loss: 0.865 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744436).  Saving model ...
Epoch: 25 cost time: 1.4211900234222412
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.847 Vali Acc: 0.748 Test Loss: 0.847 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 26 cost time: 1.3887059688568115
Epoch: 26, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.829 Vali Acc: 0.759 Test Loss: 0.829 Test Acc: 0.759
Validation loss decreased (-0.748140 --> -0.759251).  Saving model ...
Epoch: 27 cost time: 1.2643227577209473
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.813 Vali Acc: 0.767 Test Loss: 0.813 Test Acc: 0.767
Validation loss decreased (-0.759251 --> -0.766659).  Saving model ...
Epoch: 28 cost time: 1.3227648735046387
Epoch: 28, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.797 Vali Acc: 0.774 Test Loss: 0.797 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774066).  Saving model ...
Epoch: 29 cost time: 1.215900182723999
Epoch: 29, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
Validation loss decreased (-0.774066 --> -0.777770).  Saving model ...
Epoch: 30 cost time: 1.2419712543487549
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.771 Vali Acc: 0.778 Test Loss: 0.771 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 31 cost time: 1.3392717838287354
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 32 cost time: 1.368415117263794
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.750 Vali Acc: 0.774 Test Loss: 0.750 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5984365940093994
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.741 Vali Acc: 0.774 Test Loss: 0.741 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3280270099639893
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 35 cost time: 1.1689729690551758
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 36 cost time: 1.3307583332061768
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 37 cost time: 1.2670273780822754
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.714 Vali Acc: 0.781 Test Loss: 0.714 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 38 cost time: 1.2633304595947266
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.709 Vali Acc: 0.781 Test Loss: 0.709 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 39 cost time: 1.3028757572174072
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.704 Vali Acc: 0.781 Test Loss: 0.704 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 40 cost time: 1.3989965915679932
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.781 Test Loss: 0.699 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 41 cost time: 1.411733627319336
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.695 Vali Acc: 0.781 Test Loss: 0.695 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781475).  Saving model ...
Epoch: 42 cost time: 1.23539400100708
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.781 Test Loss: 0.691 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 43 cost time: 1.2205522060394287
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.687 Vali Acc: 0.785 Test Loss: 0.687 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 44 cost time: 1.2739348411560059
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 45 cost time: 1.2403292655944824
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 46 cost time: 1.260758638381958
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 47 cost time: 1.262035846710205
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 48 cost time: 1.2124605178833008
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.793 Test Loss: 0.668 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 49 cost time: 1.2498857975006104
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.665 Vali Acc: 0.793 Test Loss: 0.665 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 50 cost time: 1.16058349609375
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.793 Test Loss: 0.662 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 51 cost time: 1.1571078300476074
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 52 cost time: 1.106243371963501
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 53 cost time: 1.173480749130249
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 54 cost time: 1.2864890098571777
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 55 cost time: 1.0936987400054932
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 56 cost time: 1.277458667755127
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 57 cost time: 1.3604059219360352
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 58 cost time: 1.2997238636016846
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 59 cost time: 1.300382137298584
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 60 cost time: 1.516413688659668
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 61 cost time: 1.3708207607269287
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 62 cost time: 1.295896053314209
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 63 cost time: 1.3124425411224365
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 64 cost time: 1.365689754486084
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 65 cost time: 1.3163766860961914
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.804 Test Loss: 0.631 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 66 cost time: 1.343390703201294
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.804 Test Loss: 0.629 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 67 cost time: 1.306089162826538
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 68 cost time: 1.2621846199035645
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.807 Test Loss: 0.624 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 69 cost time: 1.1768922805786133
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.807 Test Loss: 0.622 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 70 cost time: 1.2240476608276367
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.807 Test Loss: 0.619 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 71 cost time: 1.3358221054077148
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.807 Test Loss: 0.617 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 72 cost time: 1.238593339920044
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.807 Test Loss: 0.615 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 73 cost time: 1.4329602718353271
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.807 Test Loss: 0.613 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 74 cost time: 1.3585853576660156
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 75 cost time: 1.4182302951812744
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.811 Test Loss: 0.608 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 76 cost time: 1.4227089881896973
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.815 Test Loss: 0.607 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 77 cost time: 1.2412567138671875
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.815 Test Loss: 0.605 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 78 cost time: 1.3725526332855225
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 79 cost time: 1.2193951606750488
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 80 cost time: 1.214076280593872
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 81 cost time: 1.2034811973571777
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 82 cost time: 1.3345775604248047
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 83 cost time: 1.1811082363128662
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.826 Test Loss: 0.595 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 84 cost time: 1.310844898223877
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.826 Test Loss: 0.594 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 85 cost time: 1.2058868408203125
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 86 cost time: 1.534069538116455
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 87 cost time: 1.3509495258331299
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.3546535968780518
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 89 cost time: 1.2479212284088135
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 90 cost time: 1.2536015510559082
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 91 cost time: 1.3407585620880127
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.826 Test Loss: 0.583 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 92 cost time: 1.3690967559814453
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.830 Test Loss: 0.582 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 93 cost time: 1.3721907138824463
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.830 Test Loss: 0.581 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 94 cost time: 1.3756399154663086
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 95 cost time: 1.174971342086792
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 96 cost time: 1.268782377243042
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 97 cost time: 1.117119312286377
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 98 cost time: 1.0861384868621826
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.2225103378295898
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 100 cost time: 1.2161235809326172
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5321106910705566
Epoch: 1, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.860 Vali Acc: 0.148 Test Loss: 1.860 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.1799137592315674
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.846 Vali Acc: 0.159 Test Loss: 1.846 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 1.1181368827819824
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.830 Vali Acc: 0.174 Test Loss: 1.830 Test Acc: 0.174
Validation loss decreased (-0.159241 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 1.0596330165863037
Epoch: 4, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.804 Vali Acc: 0.200 Test Loss: 1.804 Test Acc: 0.200
Validation loss decreased (-0.174056 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 1.0839564800262451
Epoch: 5, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.773 Vali Acc: 0.222 Test Loss: 1.773 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222204).  Saving model ...
Epoch: 6 cost time: 1.1387748718261719
Epoch: 6, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.736 Vali Acc: 0.296 Test Loss: 1.736 Test Acc: 0.296
Validation loss decreased (-0.222204 --> -0.296279).  Saving model ...
Epoch: 7 cost time: 1.2664768695831299
Epoch: 7, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.696 Vali Acc: 0.356 Test Loss: 1.696 Test Acc: 0.356
Validation loss decreased (-0.296279 --> -0.355539).  Saving model ...
Epoch: 8 cost time: 1.2869997024536133
Epoch: 8, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.653 Vali Acc: 0.400 Test Loss: 1.653 Test Acc: 0.400
Validation loss decreased (-0.355539 --> -0.399983).  Saving model ...
Epoch: 9 cost time: 1.1079049110412598
Epoch: 9, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.608 Vali Acc: 0.437 Test Loss: 1.608 Test Acc: 0.437
Validation loss decreased (-0.399983 --> -0.437021).  Saving model ...
Epoch: 10 cost time: 1.153904914855957
Epoch: 10, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.562 Vali Acc: 0.470 Test Loss: 1.562 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 11 cost time: 1.2482271194458008
Epoch: 11, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.514 Vali Acc: 0.496 Test Loss: 1.514 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496281).  Saving model ...
Epoch: 12 cost time: 1.274371862411499
Epoch: 12, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.465 Vali Acc: 0.541 Test Loss: 1.465 Test Acc: 0.541
Validation loss decreased (-0.496281 --> -0.540726).  Saving model ...
Epoch: 13 cost time: 1.2374823093414307
Epoch: 13, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.417 Vali Acc: 0.570 Test Loss: 1.417 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 14 cost time: 1.260998249053955
Epoch: 14, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.371 Vali Acc: 0.585 Test Loss: 1.371 Test Acc: 0.585
Validation loss decreased (-0.570356 --> -0.585171).  Saving model ...
Epoch: 15 cost time: 1.1888649463653564
Epoch: 15, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.327 Vali Acc: 0.604 Test Loss: 1.327 Test Acc: 0.604
Validation loss decreased (-0.585171 --> -0.603690).  Saving model ...
Epoch: 16 cost time: 1.2111284732818604
Epoch: 16, Steps: 2 | Train Loss: 0.759 Vali Loss: 1.284 Vali Acc: 0.596 Test Loss: 1.284 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1777317523956299
Epoch: 17, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.243 Vali Acc: 0.607 Test Loss: 1.243 Test Acc: 0.607
Validation loss decreased (-0.603690 --> -0.607395).  Saving model ...
Epoch: 18 cost time: 1.232968807220459
Epoch: 18, Steps: 2 | Train Loss: 0.682 Vali Loss: 1.206 Vali Acc: 0.604 Test Loss: 1.206 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1577134132385254
Epoch: 19, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.172 Vali Acc: 0.611 Test Loss: 1.172 Test Acc: 0.611
Validation loss decreased (-0.607395 --> -0.611099).  Saving model ...
Epoch: 20 cost time: 1.1674633026123047
Epoch: 20, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.139 Vali Acc: 0.626 Test Loss: 1.139 Test Acc: 0.626
Validation loss decreased (-0.611099 --> -0.625915).  Saving model ...
Epoch: 21 cost time: 1.3088667392730713
Epoch: 21, Steps: 2 | Train Loss: 0.416 Vali Loss: 1.111 Vali Acc: 0.630 Test Loss: 1.111 Test Acc: 0.630
Validation loss decreased (-0.625915 --> -0.629619).  Saving model ...
Epoch: 22 cost time: 1.3045628070831299
Epoch: 22, Steps: 2 | Train Loss: 0.371 Vali Loss: 1.082 Vali Acc: 0.641 Test Loss: 1.082 Test Acc: 0.641
Validation loss decreased (-0.629619 --> -0.640730).  Saving model ...
Epoch: 23 cost time: 1.2224488258361816
Epoch: 23, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.054 Vali Acc: 0.648 Test Loss: 1.054 Test Acc: 0.648
Validation loss decreased (-0.640730 --> -0.648138).  Saving model ...
Epoch: 24 cost time: 1.2310855388641357
Epoch: 24, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.025 Vali Acc: 0.641 Test Loss: 1.025 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1588685512542725
Epoch: 25, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.997 Vali Acc: 0.641 Test Loss: 0.997 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1526384353637695
Epoch: 26, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.970 Vali Acc: 0.648 Test Loss: 0.970 Test Acc: 0.648
Validation loss decreased (-0.648138 --> -0.648138).  Saving model ...
Epoch: 27 cost time: 1.2070350646972656
Epoch: 27, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.943 Vali Acc: 0.667 Test Loss: 0.943 Test Acc: 0.667
Validation loss decreased (-0.648138 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 1.1735954284667969
Epoch: 28, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.916 Vali Acc: 0.681 Test Loss: 0.916 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681472).  Saving model ...
Epoch: 29 cost time: 1.252727746963501
Epoch: 29, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.887 Vali Acc: 0.685 Test Loss: 0.887 Test Acc: 0.685
Validation loss decreased (-0.681472 --> -0.685176).  Saving model ...
Epoch: 30 cost time: 1.2995195388793945
Epoch: 30, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.863 Vali Acc: 0.689 Test Loss: 0.863 Test Acc: 0.689
Validation loss decreased (-0.685176 --> -0.688880).  Saving model ...
Epoch: 31 cost time: 1.165024995803833
Epoch: 31, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.839 Vali Acc: 0.696 Test Loss: 0.839 Test Acc: 0.696
Validation loss decreased (-0.688880 --> -0.696288).  Saving model ...
Epoch: 32 cost time: 1.0882420539855957
Epoch: 32, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.819 Vali Acc: 0.704 Test Loss: 0.819 Test Acc: 0.704
Validation loss decreased (-0.696288 --> -0.703696).  Saving model ...
Epoch: 33 cost time: 1.1064891815185547
Epoch: 33, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.801 Vali Acc: 0.707 Test Loss: 0.801 Test Acc: 0.707
Validation loss decreased (-0.703696 --> -0.707399).  Saving model ...
Epoch: 34 cost time: 1.0865800380706787
Epoch: 34, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.784 Vali Acc: 0.719 Test Loss: 0.784 Test Acc: 0.719
Validation loss decreased (-0.707399 --> -0.718511).  Saving model ...
Epoch: 35 cost time: 1.1315460205078125
Epoch: 35, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.770 Vali Acc: 0.730 Test Loss: 0.770 Test Acc: 0.730
Validation loss decreased (-0.718511 --> -0.729622).  Saving model ...
Epoch: 36 cost time: 1.1253786087036133
Epoch: 36, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.758 Vali Acc: 0.733 Test Loss: 0.758 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
Epoch: 37 cost time: 1.0630645751953125
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.747 Vali Acc: 0.741 Test Loss: 0.747 Test Acc: 0.741
Validation loss decreased (-0.733326 --> -0.740733).  Saving model ...
Epoch: 38 cost time: 1.2158658504486084
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.736 Vali Acc: 0.748 Test Loss: 0.736 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748141).  Saving model ...
Epoch: 39 cost time: 1.121190071105957
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
Validation loss decreased (-0.748141 --> -0.755548).  Saving model ...
Epoch: 40 cost time: 1.0817105770111084
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 41 cost time: 1.2104341983795166
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.710 Vali Acc: 0.759 Test Loss: 0.710 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 42 cost time: 1.1123321056365967
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.702 Vali Acc: 0.763 Test Loss: 0.702 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 43 cost time: 1.3568687438964844
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 44 cost time: 1.1858510971069336
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.763 Test Loss: 0.686 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 45 cost time: 1.1933066844940186
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 46 cost time: 1.2075791358947754
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.672 Vali Acc: 0.767 Test Loss: 0.672 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 47 cost time: 1.2062699794769287
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0491204261779785
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 49 cost time: 1.0523977279663086
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.656 Vali Acc: 0.767 Test Loss: 0.656 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 50 cost time: 1.1998980045318604
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.653 Vali Acc: 0.767 Test Loss: 0.653 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 51 cost time: 1.0201778411865234
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.770 Test Loss: 0.649 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 52 cost time: 1.0430009365081787
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.774 Test Loss: 0.646 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 53 cost time: 1.192779541015625
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.774 Test Loss: 0.643 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 54 cost time: 1.2049181461334229
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.774 Test Loss: 0.641 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 55 cost time: 1.2880022525787354
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777771).  Saving model ...
Epoch: 56 cost time: 1.0912518501281738
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.778 Test Loss: 0.635 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 57 cost time: 1.157069444656372
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.778 Test Loss: 0.632 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 58 cost time: 1.3601431846618652
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.629 Vali Acc: 0.781 Test Loss: 0.629 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 59 cost time: 1.3305399417877197
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.781 Test Loss: 0.626 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 60 cost time: 1.3817002773284912
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.785 Test Loss: 0.624 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 61 cost time: 1.221691370010376
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.785 Test Loss: 0.621 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 62 cost time: 1.1909706592559814
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.793 Test Loss: 0.619 Test Acc: 0.793
Validation loss decreased (-0.785179 --> -0.792586).  Saving model ...
Epoch: 63 cost time: 1.1231274604797363
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.793 Test Loss: 0.617 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 64 cost time: 1.240325689315796
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.793 Test Loss: 0.615 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 65 cost time: 1.10837984085083
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.793 Test Loss: 0.612 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 66 cost time: 1.1530272960662842
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.793 Test Loss: 0.610 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 67 cost time: 1.1536812782287598
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.792586 --> -0.799994).  Saving model ...
Epoch: 68 cost time: 1.219925880432129
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 69 cost time: 1.2194724082946777
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 70 cost time: 1.1224653720855713
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 71 cost time: 1.2043251991271973
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.807 Test Loss: 0.598 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 72 cost time: 1.3225321769714355
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.807 Test Loss: 0.596 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 73 cost time: 1.109090805053711
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.807 Test Loss: 0.594 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 74 cost time: 1.1379384994506836
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 75 cost time: 1.2566077709197998
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.811 Test Loss: 0.590 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 76 cost time: 1.2035982608795166
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.811 Test Loss: 0.587 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 77 cost time: 1.1546251773834229
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 78 cost time: 1.1430745124816895
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 79 cost time: 1.2604351043701172
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 80 cost time: 1.288900375366211
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.811 Test Loss: 0.581 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 81 cost time: 1.0856220722198486
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.811 Test Loss: 0.580 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 82 cost time: 1.1988654136657715
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 83 cost time: 0.9960260391235352
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.811 Test Loss: 0.574 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.0889241695404053
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 85 cost time: 1.1500749588012695
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.815 Test Loss: 0.569 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 86 cost time: 1.0918810367584229
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.815 Test Loss: 0.566 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 87 cost time: 1.2100415229797363
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.815 Test Loss: 0.564 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 88 cost time: 1.2370314598083496
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 89 cost time: 1.2301990985870361
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 90 cost time: 1.3936364650726318
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 91 cost time: 1.3191041946411133
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 92 cost time: 1.228442907333374
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 93 cost time: 1.1780402660369873
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 94 cost time: 1.2224442958831787
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 95 cost time: 1.1517164707183838
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 96 cost time: 1.1015338897705078
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 97 cost time: 1.2470386028289795
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 98 cost time: 1.2087759971618652
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 99 cost time: 1.0644898414611816
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 100 cost time: 0.9528496265411377
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.825925925925926
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.726937770843506
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.911 Vali Acc: 0.133 Test Loss: 1.911 Test Acc: 0.133
Validation loss decreased (inf --> -0.133314).  Saving model ...
Epoch: 2 cost time: 1.2144672870635986
Epoch: 2, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.900 Vali Acc: 0.141 Test Loss: 1.900 Test Acc: 0.141
Validation loss decreased (-0.133314 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.3927381038665771
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.888 Vali Acc: 0.148 Test Loss: 1.888 Test Acc: 0.148
Validation loss decreased (-0.140722 --> -0.148129).  Saving model ...
Epoch: 4 cost time: 1.3098318576812744
Epoch: 4, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.868 Vali Acc: 0.167 Test Loss: 1.868 Test Acc: 0.167
Validation loss decreased (-0.148129 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 1.3253235816955566
Epoch: 5, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.842 Vali Acc: 0.189 Test Loss: 1.842 Test Acc: 0.189
Validation loss decreased (-0.166648 --> -0.188870).  Saving model ...
Epoch: 6 cost time: 1.4018337726593018
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.811 Vali Acc: 0.211 Test Loss: 1.811 Test Acc: 0.211
Validation loss decreased (-0.188870 --> -0.211093).  Saving model ...
Epoch: 7 cost time: 1.2736995220184326
Epoch: 7, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.777 Vali Acc: 0.230 Test Loss: 1.777 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 1.1797223091125488
Epoch: 8, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.741 Vali Acc: 0.270 Test Loss: 1.741 Test Acc: 0.270
Validation loss decreased (-0.229612 --> -0.270353).  Saving model ...
Epoch: 9 cost time: 1.2447395324707031
Epoch: 9, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.703 Vali Acc: 0.315 Test Loss: 1.703 Test Acc: 0.315
Validation loss decreased (-0.270353 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 1.1459770202636719
Epoch: 10, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.661 Vali Acc: 0.341 Test Loss: 1.661 Test Acc: 0.341
Validation loss decreased (-0.314798 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 1.1730148792266846
Epoch: 11, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.616 Vali Acc: 0.356 Test Loss: 1.616 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 1.1720151901245117
Epoch: 12, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.571 Vali Acc: 0.378 Test Loss: 1.571 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 1.0695793628692627
Epoch: 13, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.523 Vali Acc: 0.415 Test Loss: 1.523 Test Acc: 0.415
Validation loss decreased (-0.377762 --> -0.414800).  Saving model ...
Epoch: 14 cost time: 1.1332876682281494
Epoch: 14, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.474 Vali Acc: 0.470 Test Loss: 1.474 Test Acc: 0.470
Validation loss decreased (-0.414800 --> -0.470356).  Saving model ...
Epoch: 15 cost time: 1.2057316303253174
Epoch: 15, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
Validation loss decreased (-0.470356 --> -0.518504).  Saving model ...
Epoch: 16 cost time: 1.3067164421081543
Epoch: 16, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.370 Vali Acc: 0.552 Test Loss: 1.370 Test Acc: 0.552
Validation loss decreased (-0.518504 --> -0.551838).  Saving model ...
Epoch: 17 cost time: 1.1711175441741943
Epoch: 17, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.316 Vali Acc: 0.607 Test Loss: 1.316 Test Acc: 0.607
Validation loss decreased (-0.551838 --> -0.607394).  Saving model ...
Epoch: 18 cost time: 1.3643548488616943
Epoch: 18, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.262 Vali Acc: 0.637 Test Loss: 1.262 Test Acc: 0.637
Validation loss decreased (-0.607394 --> -0.637024).  Saving model ...
Epoch: 19 cost time: 1.4102141857147217
Epoch: 19, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.209 Vali Acc: 0.648 Test Loss: 1.209 Test Acc: 0.648
Validation loss decreased (-0.637024 --> -0.648136).  Saving model ...
Epoch: 20 cost time: 1.4818675518035889
Epoch: 20, Steps: 2 | Train Loss: 0.703 Vali Loss: 1.156 Vali Acc: 0.659 Test Loss: 1.156 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659248).  Saving model ...
Epoch: 21 cost time: 1.265507698059082
Epoch: 21, Steps: 2 | Train Loss: 0.646 Vali Loss: 1.107 Vali Acc: 0.674 Test Loss: 1.107 Test Acc: 0.674
Validation loss decreased (-0.659248 --> -0.674063).  Saving model ...
Epoch: 22 cost time: 1.2629995346069336
Epoch: 22, Steps: 2 | Train Loss: 0.589 Vali Loss: 1.060 Vali Acc: 0.693 Test Loss: 1.060 Test Acc: 0.693
Validation loss decreased (-0.674063 --> -0.692582).  Saving model ...
Epoch: 23 cost time: 1.2554237842559814
Epoch: 23, Steps: 2 | Train Loss: 0.516 Vali Loss: 1.015 Vali Acc: 0.707 Test Loss: 1.015 Test Acc: 0.707
Validation loss decreased (-0.692582 --> -0.707397).  Saving model ...
Epoch: 24 cost time: 1.2768893241882324
Epoch: 24, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.968 Vali Acc: 0.715 Test Loss: 0.968 Test Acc: 0.715
Validation loss decreased (-0.707397 --> -0.714805).  Saving model ...
Epoch: 25 cost time: 1.137681484222412
Epoch: 25, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.923 Vali Acc: 0.726 Test Loss: 0.923 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725917).  Saving model ...
Epoch: 26 cost time: 1.1195380687713623
Epoch: 26, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.878 Vali Acc: 0.730 Test Loss: 0.878 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 27 cost time: 1.118886947631836
Epoch: 27, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.834 Vali Acc: 0.741 Test Loss: 0.834 Test Acc: 0.741
Validation loss decreased (-0.729621 --> -0.740732).  Saving model ...
Epoch: 28 cost time: 1.1733527183532715
Epoch: 28, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.788 Vali Acc: 0.748 Test Loss: 0.788 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 29 cost time: 1.2279107570648193
Epoch: 29, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
Validation loss decreased (-0.748140 --> -0.755548).  Saving model ...
Epoch: 30 cost time: 1.2859532833099365
Epoch: 30, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.716 Vali Acc: 0.748 Test Loss: 0.716 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.294839859008789
Epoch: 31, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.679 Vali Acc: 0.752 Test Loss: 0.679 Test Acc: 0.752
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1351540088653564
Epoch: 32, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.651 Vali Acc: 0.763 Test Loss: 0.651 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762956).  Saving model ...
Epoch: 33 cost time: 1.3343603610992432
Epoch: 33, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 34 cost time: 1.2941150665283203
Epoch: 34, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.603 Vali Acc: 0.778 Test Loss: 0.603 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777772).  Saving model ...
Epoch: 35 cost time: 1.3535587787628174
Epoch: 35, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.588 Vali Acc: 0.778 Test Loss: 0.588 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 36 cost time: 1.208859920501709
Epoch: 36, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.576 Vali Acc: 0.785 Test Loss: 0.576 Test Acc: 0.785
Validation loss decreased (-0.777772 --> -0.785179).  Saving model ...
Epoch: 37 cost time: 1.2733442783355713
Epoch: 37, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.793 Test Loss: 0.563 Test Acc: 0.793
Validation loss decreased (-0.785179 --> -0.792587).  Saving model ...
Epoch: 38 cost time: 1.140577793121338
Epoch: 38, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1356201171875
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.548 Vali Acc: 0.785 Test Loss: 0.548 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0416209697723389
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.542 Vali Acc: 0.793 Test Loss: 0.542 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 41 cost time: 1.0864622592926025
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.793 Test Loss: 0.538 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 42 cost time: 1.1522912979125977
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796291).  Saving model ...
Epoch: 43 cost time: 1.1773583889007568
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
Validation loss decreased (-0.796291 --> -0.799995).  Saving model ...
Epoch: 44 cost time: 1.141129970550537
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.800 Test Loss: 0.525 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 45 cost time: 1.2199151515960693
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1321654319763184
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3613545894622803
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 48 cost time: 1.1156208515167236
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 49 cost time: 1.208475112915039
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.502 Vali Acc: 0.807 Test Loss: 0.502 Test Acc: 0.807
Validation loss decreased (-0.799995 --> -0.807402).  Saving model ...
Epoch: 50 cost time: 1.2877562046051025
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.815 Test Loss: 0.497 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814810).  Saving model ...
Epoch: 51 cost time: 1.3074822425842285
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
Validation loss decreased (-0.814810 --> -0.818514).  Saving model ...
Epoch: 52 cost time: 1.1078550815582275
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.818514 --> -0.822217).  Saving model ...
Epoch: 53 cost time: 1.1012749671936035
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 54 cost time: 1.2920825481414795
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 55 cost time: 1.2874219417572021
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 56 cost time: 1.223409652709961
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 57 cost time: 1.1480436325073242
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 58 cost time: 1.1552739143371582
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.825921 --> -0.833329).  Saving model ...
Epoch: 59 cost time: 1.1161653995513916
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 60 cost time: 1.2700762748718262
Epoch: 60, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.837 Test Loss: 0.479 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837032).  Saving model ...
Epoch: 61 cost time: 1.0902929306030273
Epoch: 61, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 62 cost time: 1.1287686824798584
Epoch: 62, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 63 cost time: 1.2817015647888184
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 64 cost time: 1.157102108001709
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 65 cost time: 1.2272086143493652
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.840736 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 1.3276541233062744
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.852 Test Loss: 0.464 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 67 cost time: 1.1914284229278564
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1302969455718994
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2019639015197754
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.280458927154541
Epoch: 70, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.852 Test Loss: 0.457 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 71 cost time: 1.3163471221923828
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.2717041969299316
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0395410060882568
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0733582973480225
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1934494972229004
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.2235279083251953
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.1334693431854248
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.852 Test Loss: 0.447 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 78 cost time: 1.3655760288238525
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.852 Test Loss: 0.444 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 79 cost time: 1.246062994003296
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.852 Test Loss: 0.441 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 80 cost time: 1.3343899250030518
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.852 Test Loss: 0.440 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 81 cost time: 1.2708766460418701
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855551).  Saving model ...
Epoch: 82 cost time: 1.216130256652832
Epoch: 82, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 83 cost time: 1.2502870559692383
Epoch: 83, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.856 Test Loss: 0.438 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 84 cost time: 1.1869964599609375
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 85 cost time: 1.234727382659912
Epoch: 85, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 86 cost time: 1.2645418643951416
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 87 cost time: 1.2896041870117188
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 88 cost time: 1.1129555702209473
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.859 Test Loss: 0.433 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 89 cost time: 1.293684720993042
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.859 Test Loss: 0.433 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.32081937789917
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.863 Test Loss: 0.432 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862959).  Saving model ...
Epoch: 91 cost time: 1.1067049503326416
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.254528284072876
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.859 Test Loss: 0.430 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.1803851127624512
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.859 Test Loss: 0.429 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.269627332687378
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.859 Test Loss: 0.428 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.4292819499969482
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.859 Test Loss: 0.426 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 1.3198213577270508
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.859 Test Loss: 0.425 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.277754783630371
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.859 Test Loss: 0.425 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 1.2807838916778564
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.859 Test Loss: 0.424 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 1.3910140991210938
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.859 Test Loss: 0.424 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.3359370231628418
Epoch: 100, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.859 Test Loss: 0.423 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.606703758239746
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.886 Vali Acc: 0.156 Test Loss: 1.886 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.13142728805542
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.879 Vali Acc: 0.167 Test Loss: 1.879 Test Acc: 0.167
Validation loss decreased (-0.155537 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 1.2378709316253662
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.865 Vali Acc: 0.170 Test Loss: 1.865 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 1.2496318817138672
Epoch: 4, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.836 Vali Acc: 0.189 Test Loss: 1.836 Test Acc: 0.189
Validation loss decreased (-0.170352 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 1.1473400592803955
Epoch: 5, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.799 Vali Acc: 0.230 Test Loss: 1.799 Test Acc: 0.230
Validation loss decreased (-0.188871 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 1.234368085861206
Epoch: 6, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.754 Vali Acc: 0.293 Test Loss: 1.754 Test Acc: 0.293
Validation loss decreased (-0.229612 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 1.209510326385498
Epoch: 7, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.702 Vali Acc: 0.348 Test Loss: 1.702 Test Acc: 0.348
Validation loss decreased (-0.292575 --> -0.348131).  Saving model ...
Epoch: 8 cost time: 1.202927827835083
Epoch: 8, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.645 Vali Acc: 0.389 Test Loss: 1.645 Test Acc: 0.389
Validation loss decreased (-0.348131 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 1.1819825172424316
Epoch: 9, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.583 Vali Acc: 0.448 Test Loss: 1.583 Test Acc: 0.448
Validation loss decreased (-0.388872 --> -0.448132).  Saving model ...
Epoch: 10 cost time: 1.2634403705596924
Epoch: 10, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.517 Vali Acc: 0.507 Test Loss: 1.517 Test Acc: 0.507
Validation loss decreased (-0.448132 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 1.0781772136688232
Epoch: 11, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.446 Vali Acc: 0.541 Test Loss: 1.446 Test Acc: 0.541
Validation loss decreased (-0.507392 --> -0.540726).  Saving model ...
Epoch: 12 cost time: 1.1925208568572998
Epoch: 12, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
Validation loss decreased (-0.540726 --> -0.581468).  Saving model ...
Epoch: 13 cost time: 1.1602559089660645
Epoch: 13, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.300 Vali Acc: 0.622 Test Loss: 1.300 Test Acc: 0.622
Validation loss decreased (-0.581468 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 1.1086385250091553
Epoch: 14, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.226 Vali Acc: 0.648 Test Loss: 1.226 Test Acc: 0.648
Validation loss decreased (-0.622209 --> -0.648136).  Saving model ...
Epoch: 15 cost time: 1.19297194480896
Epoch: 15, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.153 Vali Acc: 0.696 Test Loss: 1.153 Test Acc: 0.696
Validation loss decreased (-0.648136 --> -0.696285).  Saving model ...
Epoch: 16 cost time: 1.1557259559631348
Epoch: 16, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.081 Vali Acc: 0.711 Test Loss: 1.081 Test Acc: 0.711
Validation loss decreased (-0.696285 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 1.1328661441802979
Epoch: 17, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.012 Vali Acc: 0.759 Test Loss: 1.012 Test Acc: 0.759
Validation loss decreased (-0.711100 --> -0.759249).  Saving model ...
Epoch: 18 cost time: 1.1870300769805908
Epoch: 18, Steps: 2 | Train Loss: 1.177 Vali Loss: 0.946 Vali Acc: 0.793 Test Loss: 0.946 Test Acc: 0.793
Validation loss decreased (-0.759249 --> -0.792583).  Saving model ...
Epoch: 19 cost time: 1.2719507217407227
Epoch: 19, Steps: 2 | Train Loss: 1.138 Vali Loss: 0.883 Vali Acc: 0.804 Test Loss: 0.883 Test Acc: 0.804
Validation loss decreased (-0.792583 --> -0.803695).  Saving model ...
Epoch: 20 cost time: 1.1358582973480225
Epoch: 20, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.822 Vali Acc: 0.830 Test Loss: 0.822 Test Acc: 0.830
Validation loss decreased (-0.803695 --> -0.829621).  Saving model ...
Epoch: 21 cost time: 1.1441948413848877
Epoch: 21, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.763 Vali Acc: 0.833 Test Loss: 0.763 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833326).  Saving model ...
Epoch: 22 cost time: 1.1175014972686768
Epoch: 22, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.707 Vali Acc: 0.848 Test Loss: 0.707 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.848141).  Saving model ...
Epoch: 23 cost time: 1.2167236804962158
Epoch: 23, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 1.1739997863769531
Epoch: 24, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 25 cost time: 1.1389317512512207
Epoch: 25, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.128699541091919
Epoch: 26, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.245124101638794
Epoch: 27, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.494 Vali Acc: 0.874 Test Loss: 0.494 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874069).  Saving model ...
Epoch: 28 cost time: 1.1687111854553223
Epoch: 28, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.461 Vali Acc: 0.874 Test Loss: 0.461 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 29 cost time: 1.1679930686950684
Epoch: 29, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.433 Vali Acc: 0.885 Test Loss: 0.433 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885181).  Saving model ...
Epoch: 30 cost time: 1.1641206741333008
Epoch: 30, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.409 Vali Acc: 0.885 Test Loss: 0.409 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 31 cost time: 1.2389872074127197
Epoch: 31, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.377 Vali Acc: 0.893 Test Loss: 0.377 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 32 cost time: 1.14723801612854
Epoch: 32, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.353 Vali Acc: 0.896 Test Loss: 0.353 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 33 cost time: 1.0496985912322998
Epoch: 33, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.331 Vali Acc: 0.907 Test Loss: 0.331 Test Acc: 0.907
Validation loss decreased (-0.896293 --> -0.907404).  Saving model ...
Epoch: 34 cost time: 1.1378791332244873
Epoch: 34, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 35 cost time: 1.0779123306274414
Epoch: 35, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 1.066462755203247
Epoch: 36, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 37 cost time: 1.1280241012573242
Epoch: 37, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 38 cost time: 1.0790338516235352
Epoch: 38, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 1.2448325157165527
Epoch: 39, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1925480365753174
Epoch: 40, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2732295989990234
Epoch: 41, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1202826499938965
Epoch: 42, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.110743522644043
Epoch: 43, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0977327823638916
Epoch: 44, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 1.2067129611968994
Epoch: 45, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 46 cost time: 1.2980635166168213
Epoch: 46, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1223559379577637
Epoch: 47, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1423163414001465
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0357728004455566
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.293304681777954
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 51 cost time: 1.0652012825012207
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.98681640625
Epoch: 52, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0550613403320312
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1074323654174805
Epoch: 54, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9629464149475098
Epoch: 55, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9714341163635254
Epoch: 56, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.136758804321289
Epoch: 57, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2354483604431152
Epoch: 58, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.240373134613037
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2174451351165771
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.672893524169922
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.909 Vali Acc: 0.126 Test Loss: 1.909 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 1.1968486309051514
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.904 Vali Acc: 0.130 Test Loss: 1.904 Test Acc: 0.130
Validation loss decreased (-0.125907 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.098534345626831
Epoch: 3, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.887 Vali Acc: 0.133 Test Loss: 1.887 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133314).  Saving model ...
Epoch: 4 cost time: 1.2133700847625732
Epoch: 4, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.849 Vali Acc: 0.144 Test Loss: 1.849 Test Acc: 0.144
Validation loss decreased (-0.133314 --> -0.144426).  Saving model ...
Epoch: 5 cost time: 1.3021728992462158
Epoch: 5, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.799 Vali Acc: 0.189 Test Loss: 1.799 Test Acc: 0.189
Validation loss decreased (-0.144426 --> -0.188871).  Saving model ...
Epoch: 6 cost time: 1.0688703060150146
Epoch: 6, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.738 Vali Acc: 0.248 Test Loss: 1.738 Test Acc: 0.248
Validation loss decreased (-0.188871 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 1.2944927215576172
Epoch: 7, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.669 Vali Acc: 0.333 Test Loss: 1.669 Test Acc: 0.333
Validation loss decreased (-0.248131 --> -0.333317).  Saving model ...
Epoch: 8 cost time: 1.1929659843444824
Epoch: 8, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.595 Vali Acc: 0.422 Test Loss: 1.595 Test Acc: 0.422
Validation loss decreased (-0.333317 --> -0.422206).  Saving model ...
Epoch: 9 cost time: 1.3050625324249268
Epoch: 9, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
Validation loss decreased (-0.422206 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.173384428024292
Epoch: 10, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.432 Vali Acc: 0.552 Test Loss: 1.432 Test Acc: 0.552
Validation loss decreased (-0.499985 --> -0.551838).  Saving model ...
Epoch: 11 cost time: 1.1089632511138916
Epoch: 11, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.347 Vali Acc: 0.641 Test Loss: 1.347 Test Acc: 0.641
Validation loss decreased (-0.551838 --> -0.640727).  Saving model ...
Epoch: 12 cost time: 1.2791132926940918
Epoch: 12, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.263 Vali Acc: 0.670 Test Loss: 1.263 Test Acc: 0.670
Validation loss decreased (-0.640727 --> -0.670358).  Saving model ...
Epoch: 13 cost time: 1.3249800205230713
Epoch: 13, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.181 Vali Acc: 0.693 Test Loss: 1.181 Test Acc: 0.693
Validation loss decreased (-0.670358 --> -0.692581).  Saving model ...
Epoch: 14 cost time: 1.361459732055664
Epoch: 14, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.103 Vali Acc: 0.737 Test Loss: 1.103 Test Acc: 0.737
Validation loss decreased (-0.692581 --> -0.737026).  Saving model ...
Epoch: 15 cost time: 1.3937263488769531
Epoch: 15, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.029 Vali Acc: 0.763 Test Loss: 1.029 Test Acc: 0.763
Validation loss decreased (-0.737026 --> -0.762953).  Saving model ...
Epoch: 16 cost time: 1.251861333847046
Epoch: 16, Steps: 2 | Train Loss: 1.307 Vali Loss: 0.958 Vali Acc: 0.793 Test Loss: 0.958 Test Acc: 0.793
Validation loss decreased (-0.762953 --> -0.792583).  Saving model ...
Epoch: 17 cost time: 1.2825298309326172
Epoch: 17, Steps: 2 | Train Loss: 1.203 Vali Loss: 0.893 Vali Acc: 0.793 Test Loss: 0.893 Test Acc: 0.793
Validation loss decreased (-0.792583 --> -0.792584).  Saving model ...
Epoch: 18 cost time: 1.1588997840881348
Epoch: 18, Steps: 2 | Train Loss: 1.267 Vali Loss: 0.832 Vali Acc: 0.811 Test Loss: 0.832 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.2455294132232666
Epoch: 19, Steps: 2 | Train Loss: 1.119 Vali Loss: 0.776 Vali Acc: 0.830 Test Loss: 0.776 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829622).  Saving model ...
Epoch: 20 cost time: 1.3007025718688965
Epoch: 20, Steps: 2 | Train Loss: 1.093 Vali Loss: 0.723 Vali Acc: 0.837 Test Loss: 0.723 Test Acc: 0.837
Validation loss decreased (-0.829622 --> -0.837030).  Saving model ...
Epoch: 21 cost time: 1.1902263164520264
Epoch: 21, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.672 Vali Acc: 0.870 Test Loss: 0.672 Test Acc: 0.870
Validation loss decreased (-0.837030 --> -0.870364).  Saving model ...
Epoch: 22 cost time: 1.2251806259155273
Epoch: 22, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.625 Vali Acc: 0.874 Test Loss: 0.625 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 1.3328666687011719
Epoch: 23, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 24 cost time: 1.3704257011413574
Epoch: 24, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.544 Vali Acc: 0.896 Test Loss: 0.544 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 1.3390192985534668
Epoch: 25, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.316056489944458
Epoch: 26, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 1.2374467849731445
Epoch: 27, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.450 Vali Acc: 0.907 Test Loss: 0.450 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4158408641815186
Epoch: 28, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 1.3198020458221436
Epoch: 29, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1550028324127197
Epoch: 30, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2708280086517334
Epoch: 31, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.356 Vali Acc: 0.904 Test Loss: 0.356 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1485157012939453
Epoch: 32, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.339 Vali Acc: 0.896 Test Loss: 0.339 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1392982006072998
Epoch: 33, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 1.2620494365692139
Epoch: 34, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0659098625183105
Epoch: 35, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 36 cost time: 1.1685466766357422
Epoch: 36, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.278 Vali Acc: 0.915 Test Loss: 0.278 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 37 cost time: 1.158951759338379
Epoch: 37, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 1.166919469833374
Epoch: 38, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 1.3232793807983398
Epoch: 39, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 1.141718864440918
Epoch: 40, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 1.1539084911346436
Epoch: 41, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 1.2019052505493164
Epoch: 42, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 1.1146314144134521
Epoch: 43, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 1.2115168571472168
Epoch: 44, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 1.0671355724334717
Epoch: 45, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.090519905090332
Epoch: 46, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2373747825622559
Epoch: 47, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2744276523590088
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0436201095581055
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0531136989593506
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.196559190750122
Epoch: 51, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1446664333343506
Epoch: 52, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.234936237335205
Epoch: 53, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.350126028060913
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.967991352081299
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.14255690574646
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.303476095199585
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1286430358886719
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1867210865020752
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1385128498077393
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.0658776760101318
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.0636613368988037
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0926017761230469
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1129355430603027
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0885860919952393
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.2389445304870605
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3406317234039307
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.325019359588623
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.25882887840271
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.2045729160308838
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.2533881664276123
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.2555391788482666
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.1902961730957031
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2903788089752197
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 1.2500395774841309
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3380873203277588
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2687318325042725
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.1546642780303955
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.200770616531372
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.3319196701049805
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.408353567123413
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4086148738861084
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7085576057434082
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.4050981998443604
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3836450576782227
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3835701942443848
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.3468585014343262
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.228750467300415
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.305649757385254
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.2633328437805176
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.280644178390503
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.1810951232910156
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.3043453693389893
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.1426827907562256
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.440039873123169
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.322143793106079
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.318626880645752
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3600986003875732
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4213252067565918
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2866227626800537
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.274975061416626
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.4647643566131592
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4254295825958252
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3161098957061768
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.256066083908081
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.247344970703125
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.1943550109863281
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.154909372329712
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.2827763557434082
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.2689518928527832
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3889532089233398
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.2777981758117676
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.188746690750122
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2787978649139404
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3233370780944824
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.3577592372894287
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.3192503452301025
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.2306485176086426
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.23931884765625
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.3267221450805664
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.185037612915039
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.2849352359771729
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0821435451507568
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2023916244506836
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.398352861404419
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.307809829711914
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3986830711364746
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.3810672760009766
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.341397762298584
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 975238
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8986945152282715
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.862 Vali Acc: 0.137 Test Loss: 1.862 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 1.3365604877471924
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.823 Vali Acc: 0.152 Test Loss: 1.823 Test Acc: 0.152
Validation loss decreased (-0.137018 --> -0.151834).  Saving model ...
Epoch: 3 cost time: 1.0773780345916748
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.783 Vali Acc: 0.178 Test Loss: 1.783 Test Acc: 0.178
Validation loss decreased (-0.151834 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.1674728393554688
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.724 Vali Acc: 0.219 Test Loss: 1.724 Test Acc: 0.219
Validation loss decreased (-0.177760 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 1.1244630813598633
Epoch: 5, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.650 Vali Acc: 0.322 Test Loss: 1.650 Test Acc: 0.322
Validation loss decreased (-0.218501 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 1.1164634227752686
Epoch: 6, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.567 Vali Acc: 0.470 Test Loss: 1.567 Test Acc: 0.470
Validation loss decreased (-0.322206 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 1.262298583984375
Epoch: 7, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.479 Vali Acc: 0.567 Test Loss: 1.479 Test Acc: 0.567
Validation loss decreased (-0.470355 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 1.3350117206573486
Epoch: 8, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.386 Vali Acc: 0.619 Test Loss: 1.386 Test Acc: 0.619
Validation loss decreased (-0.566652 --> -0.618505).  Saving model ...
Epoch: 9 cost time: 1.295699119567871
Epoch: 9, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.292 Vali Acc: 0.689 Test Loss: 1.292 Test Acc: 0.689
Validation loss decreased (-0.618505 --> -0.688876).  Saving model ...
Epoch: 10 cost time: 1.261542797088623
Epoch: 10, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.199 Vali Acc: 0.730 Test Loss: 1.199 Test Acc: 0.730
Validation loss decreased (-0.688876 --> -0.729618).  Saving model ...
Epoch: 11 cost time: 1.253009557723999
Epoch: 11, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.110 Vali Acc: 0.748 Test Loss: 1.110 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 12 cost time: 1.277343511581421
Epoch: 12, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.024 Vali Acc: 0.752 Test Loss: 1.024 Test Acc: 0.752
Validation loss decreased (-0.748137 --> -0.751842).  Saving model ...
Epoch: 13 cost time: 1.3507580757141113
Epoch: 13, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.946 Vali Acc: 0.763 Test Loss: 0.946 Test Acc: 0.763
Validation loss decreased (-0.751842 --> -0.762954).  Saving model ...
Epoch: 14 cost time: 1.4490950107574463
Epoch: 14, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.876 Vali Acc: 0.770 Test Loss: 0.876 Test Acc: 0.770
Validation loss decreased (-0.762954 --> -0.770362).  Saving model ...
Epoch: 15 cost time: 1.1030769348144531
Epoch: 15, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.815 Vali Acc: 0.781 Test Loss: 0.815 Test Acc: 0.781
Validation loss decreased (-0.770362 --> -0.781473).  Saving model ...
Epoch: 16 cost time: 1.1806869506835938
Epoch: 16, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.762 Vali Acc: 0.807 Test Loss: 0.762 Test Acc: 0.807
Validation loss decreased (-0.781473 --> -0.807400).  Saving model ...
Epoch: 17 cost time: 1.134589433670044
Epoch: 17, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 1.234086513519287
Epoch: 18, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
Validation loss decreased (-0.811104 --> -0.818512).  Saving model ...
Epoch: 19 cost time: 1.1911253929138184
Epoch: 19, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 20 cost time: 1.1152868270874023
Epoch: 20, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.619 Vali Acc: 0.826 Test Loss: 0.619 Test Acc: 0.826
Validation loss decreased (-0.818512 --> -0.825920).  Saving model ...
Epoch: 21 cost time: 1.2224197387695312
Epoch: 21, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.599 Vali Acc: 0.815 Test Loss: 0.599 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.163027048110962
Epoch: 22, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1120219230651855
Epoch: 23, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.575 Vali Acc: 0.811 Test Loss: 0.575 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1107017993927002
Epoch: 24, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.568 Vali Acc: 0.811 Test Loss: 0.568 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2282297611236572
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.561 Vali Acc: 0.811 Test Loss: 0.561 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2029154300689697
Epoch: 26, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1424288749694824
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.154719591140747
Epoch: 28, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2839608192443848
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2560834884643555
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.825925925925926
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7004590034484863
Epoch: 1, Steps: 2 | Train Loss: 1.960 Vali Loss: 1.887 Vali Acc: 0.085 Test Loss: 1.887 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 1.0114195346832275
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.855 Vali Acc: 0.115 Test Loss: 1.855 Test Acc: 0.115
Validation loss decreased (-0.085166 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 1.0617282390594482
Epoch: 3, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.824 Vali Acc: 0.122 Test Loss: 1.824 Test Acc: 0.122
Validation loss decreased (-0.114796 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 1.2044293880462646
Epoch: 4, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.776 Vali Acc: 0.163 Test Loss: 1.776 Test Acc: 0.163
Validation loss decreased (-0.122204 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 1.2067945003509521
Epoch: 5, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.716 Vali Acc: 0.256 Test Loss: 1.716 Test Acc: 0.256
Validation loss decreased (-0.162945 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 1.053694486618042
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.649 Vali Acc: 0.359 Test Loss: 1.649 Test Acc: 0.359
Validation loss decreased (-0.255538 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 1.1768672466278076
Epoch: 7, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.577 Vali Acc: 0.426 Test Loss: 1.577 Test Acc: 0.426
Validation loss decreased (-0.359243 --> -0.425910).  Saving model ...
Epoch: 8 cost time: 1.2417411804199219
Epoch: 8, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
Validation loss decreased (-0.425910 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.1570940017700195
Epoch: 9, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.423 Vali Acc: 0.567 Test Loss: 1.423 Test Acc: 0.567
Validation loss decreased (-0.499985 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 1.2421212196350098
Epoch: 10, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.344 Vali Acc: 0.630 Test Loss: 1.344 Test Acc: 0.630
Validation loss decreased (-0.566652 --> -0.629616).  Saving model ...
Epoch: 11 cost time: 1.1953651905059814
Epoch: 11, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.268 Vali Acc: 0.656 Test Loss: 1.268 Test Acc: 0.656
Validation loss decreased (-0.629616 --> -0.655543).  Saving model ...
Epoch: 12 cost time: 1.3143627643585205
Epoch: 12, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.192 Vali Acc: 0.667 Test Loss: 1.192 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 1.193753957748413
Epoch: 13, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.121 Vali Acc: 0.696 Test Loss: 1.121 Test Acc: 0.696
Validation loss decreased (-0.666655 --> -0.696285).  Saving model ...
Epoch: 14 cost time: 1.2160389423370361
Epoch: 14, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.054 Vali Acc: 0.704 Test Loss: 1.054 Test Acc: 0.704
Validation loss decreased (-0.696285 --> -0.703693).  Saving model ...
Epoch: 15 cost time: 1.2233295440673828
Epoch: 15, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.995 Vali Acc: 0.715 Test Loss: 0.995 Test Acc: 0.715
Validation loss decreased (-0.703693 --> -0.714805).  Saving model ...
Epoch: 16 cost time: 1.1524221897125244
Epoch: 16, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.943 Vali Acc: 0.726 Test Loss: 0.943 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725916).  Saving model ...
Epoch: 17 cost time: 1.0775361061096191
Epoch: 17, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.895 Vali Acc: 0.733 Test Loss: 0.895 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 1.1713011264801025
Epoch: 18, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
Validation loss decreased (-0.733324 --> -0.737029).  Saving model ...
Epoch: 19 cost time: 1.2340302467346191
Epoch: 19, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
Validation loss decreased (-0.737029 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 1.1260087490081787
Epoch: 20, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.780 Vali Acc: 0.748 Test Loss: 0.780 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 21 cost time: 1.2292163372039795
Epoch: 21, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.751 Vali Acc: 0.759 Test Loss: 0.751 Test Acc: 0.759
Validation loss decreased (-0.748140 --> -0.759252).  Saving model ...
Epoch: 22 cost time: 1.1381030082702637
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.728 Vali Acc: 0.767 Test Loss: 0.728 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 23 cost time: 1.229299783706665
Epoch: 23, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.710 Vali Acc: 0.774 Test Loss: 0.710 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774067).  Saving model ...
Epoch: 24 cost time: 1.2117018699645996
Epoch: 24, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.696 Vali Acc: 0.770 Test Loss: 0.696 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1642463207244873
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.683 Vali Acc: 0.781 Test Loss: 0.683 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781475).  Saving model ...
Epoch: 26 cost time: 1.2320873737335205
Epoch: 26, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 1.4312281608581543
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.663 Vali Acc: 0.793 Test Loss: 0.663 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 28 cost time: 1.2290918827056885
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.792586 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 1.2755322456359863
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.645 Vali Acc: 0.807 Test Loss: 0.645 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807401).  Saving model ...
Epoch: 30 cost time: 1.3451333045959473
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.636 Vali Acc: 0.807 Test Loss: 0.636 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 31 cost time: 1.3837037086486816
Epoch: 31, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.628 Vali Acc: 0.807 Test Loss: 0.628 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 32 cost time: 1.3819479942321777
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3847463130950928
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1846370697021484
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.815 Test Loss: 0.607 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814809).  Saving model ...
Epoch: 35 cost time: 1.2898097038269043
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 36 cost time: 1.3177576065063477
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.815 Test Loss: 0.594 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 37 cost time: 1.2785754203796387
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 38 cost time: 1.2767093181610107
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 1.2299039363861084
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 40 cost time: 1.320577621459961
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.578 Vali Acc: 0.826 Test Loss: 0.578 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 41 cost time: 1.4619619846343994
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 42 cost time: 1.2188019752502441
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.830 Test Loss: 0.571 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 43 cost time: 1.2023391723632812
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.830 Test Loss: 0.568 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 44 cost time: 1.262533187866211
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.830 Test Loss: 0.565 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 45 cost time: 1.4020354747772217
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.830 Test Loss: 0.563 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 46 cost time: 1.5152201652526855
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.830 Test Loss: 0.561 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 47 cost time: 1.483368158340454
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.830 Test Loss: 0.559 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 48 cost time: 1.4129533767700195
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.830 Test Loss: 0.557 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 49 cost time: 1.277721643447876
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.830 Test Loss: 0.554 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 50 cost time: 1.2604477405548096
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 51 cost time: 1.1183860301971436
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.830 Test Loss: 0.550 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 52 cost time: 1.3283979892730713
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.548 Vali Acc: 0.830 Test Loss: 0.548 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 53 cost time: 1.3037352561950684
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.830 Test Loss: 0.545 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 54 cost time: 1.2973525524139404
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.830 Test Loss: 0.543 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 55 cost time: 1.2671558856964111
Epoch: 55, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.830 Test Loss: 0.542 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 56 cost time: 1.3139984607696533
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.830 Test Loss: 0.540 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 57 cost time: 1.2207112312316895
Epoch: 57, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.830 Test Loss: 0.538 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 58 cost time: 1.3583168983459473
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.830 Test Loss: 0.536 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 59 cost time: 1.228083610534668
Epoch: 59, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 60 cost time: 1.2692904472351074
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 61 cost time: 1.29341459274292
Epoch: 61, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 62 cost time: 1.2323744297027588
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 63 cost time: 1.2827513217926025
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 64 cost time: 1.3963475227355957
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 65 cost time: 1.2835679054260254
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 66 cost time: 1.2047498226165771
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.837 Test Loss: 0.525 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 67 cost time: 1.106417179107666
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 68 cost time: 1.1057610511779785
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 69 cost time: 1.1173505783081055
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 70 cost time: 1.3456287384033203
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 71 cost time: 1.2668180465698242
Epoch: 71, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 72 cost time: 1.3048293590545654
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 73 cost time: 1.3133878707885742
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 74 cost time: 1.351881742477417
Epoch: 74, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 75 cost time: 1.397763729095459
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 76 cost time: 1.4033048152923584
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 77 cost time: 1.2990388870239258
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 78 cost time: 1.2015409469604492
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 79 cost time: 1.2978081703186035
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 80 cost time: 1.2201766967773438
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 81 cost time: 1.2592458724975586
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 82 cost time: 1.1461889743804932
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 83 cost time: 1.2578608989715576
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 84 cost time: 1.3167345523834229
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 85 cost time: 1.4684600830078125
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 86 cost time: 1.434260606765747
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 87 cost time: 1.3726017475128174
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 88 cost time: 1.4417064189910889
Epoch: 88, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
Validation loss decreased (-0.848143 --> -0.855551).  Saving model ...
Epoch: 89 cost time: 1.36006760597229
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 90 cost time: 1.4862799644470215
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 91 cost time: 1.378892183303833
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 92 cost time: 1.357168197631836
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 93 cost time: 1.2779817581176758
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 94 cost time: 1.3094322681427002
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 95 cost time: 1.2891845703125
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 96 cost time: 1.3076412677764893
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 97 cost time: 1.2108163833618164
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 98 cost time: 1.3513047695159912
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 99 cost time: 1.3479640483856201
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 100 cost time: 1.4242002964019775
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.904788017272949
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.877 Vali Acc: 0.089 Test Loss: 1.877 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 1.1873562335968018
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.853 Vali Acc: 0.104 Test Loss: 1.853 Test Acc: 0.104
Validation loss decreased (-0.088870 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 1.2148125171661377
Epoch: 3, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.829 Vali Acc: 0.122 Test Loss: 1.829 Test Acc: 0.122
Validation loss decreased (-0.103685 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 1.225950002670288
Epoch: 4, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.795 Vali Acc: 0.181 Test Loss: 1.795 Test Acc: 0.181
Validation loss decreased (-0.122204 --> -0.181464).  Saving model ...
Epoch: 5 cost time: 1.1094868183135986
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.751 Vali Acc: 0.241 Test Loss: 1.751 Test Acc: 0.241
Validation loss decreased (-0.181464 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 1.2281019687652588
Epoch: 6, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.702 Vali Acc: 0.341 Test Loss: 1.702 Test Acc: 0.341
Validation loss decreased (-0.240723 --> -0.340724).  Saving model ...
Epoch: 7 cost time: 1.1525065898895264
Epoch: 7, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.648 Vali Acc: 0.385 Test Loss: 1.648 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 1.1085822582244873
Epoch: 8, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.592 Vali Acc: 0.459 Test Loss: 1.592 Test Acc: 0.459
Validation loss decreased (-0.385169 --> -0.459243).  Saving model ...
Epoch: 9 cost time: 1.0938074588775635
Epoch: 9, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
Validation loss decreased (-0.459243 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.1505422592163086
Epoch: 10, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.471 Vali Acc: 0.526 Test Loss: 1.471 Test Acc: 0.526
Validation loss decreased (-0.499985 --> -0.525911).  Saving model ...
Epoch: 11 cost time: 1.1380953788757324
Epoch: 11, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.411 Vali Acc: 0.563 Test Loss: 1.411 Test Acc: 0.563
Validation loss decreased (-0.525911 --> -0.562949).  Saving model ...
Epoch: 12 cost time: 1.222583293914795
Epoch: 12, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.351 Vali Acc: 0.604 Test Loss: 1.351 Test Acc: 0.604
Validation loss decreased (-0.562949 --> -0.603690).  Saving model ...
Epoch: 13 cost time: 1.1462786197662354
Epoch: 13, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.292 Vali Acc: 0.615 Test Loss: 1.292 Test Acc: 0.615
Validation loss decreased (-0.603690 --> -0.614802).  Saving model ...
Epoch: 14 cost time: 1.1791648864746094
Epoch: 14, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.236 Vali Acc: 0.630 Test Loss: 1.236 Test Acc: 0.630
Validation loss decreased (-0.614802 --> -0.629617).  Saving model ...
Epoch: 15 cost time: 1.2009544372558594
Epoch: 15, Steps: 2 | Train Loss: 0.662 Vali Loss: 1.185 Vali Acc: 0.637 Test Loss: 1.185 Test Acc: 0.637
Validation loss decreased (-0.629617 --> -0.637025).  Saving model ...
Epoch: 16 cost time: 1.195544958114624
Epoch: 16, Steps: 2 | Train Loss: 0.593 Vali Loss: 1.139 Vali Acc: 0.641 Test Loss: 1.139 Test Acc: 0.641
Validation loss decreased (-0.637025 --> -0.640729).  Saving model ...
Epoch: 17 cost time: 1.2308974266052246
Epoch: 17, Steps: 2 | Train Loss: 0.515 Vali Loss: 1.095 Vali Acc: 0.652 Test Loss: 1.095 Test Acc: 0.652
Validation loss decreased (-0.640729 --> -0.651841).  Saving model ...
Epoch: 18 cost time: 1.146984577178955
Epoch: 18, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.054 Vali Acc: 0.659 Test Loss: 1.054 Test Acc: 0.659
Validation loss decreased (-0.651841 --> -0.659249).  Saving model ...
Epoch: 19 cost time: 1.3749244213104248
Epoch: 19, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.012 Vali Acc: 0.681 Test Loss: 1.012 Test Acc: 0.681
Validation loss decreased (-0.659249 --> -0.681471).  Saving model ...
Epoch: 20 cost time: 1.1954164505004883
Epoch: 20, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.976 Vali Acc: 0.715 Test Loss: 0.976 Test Acc: 0.715
Validation loss decreased (-0.681471 --> -0.714805).  Saving model ...
Epoch: 21 cost time: 0.996513843536377
Epoch: 21, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
Validation loss decreased (-0.714805 --> -0.722213).  Saving model ...
Epoch: 22 cost time: 1.2208945751190186
Epoch: 22, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.911 Vali Acc: 0.726 Test Loss: 0.911 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 23 cost time: 1.230729579925537
Epoch: 23, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.885 Vali Acc: 0.726 Test Loss: 0.885 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 24 cost time: 1.0410096645355225
Epoch: 24, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
Validation loss decreased (-0.725917 --> -0.737028).  Saving model ...
Epoch: 25 cost time: 1.2093615531921387
Epoch: 25, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.839 Vali Acc: 0.741 Test Loss: 0.839 Test Acc: 0.741
Validation loss decreased (-0.737028 --> -0.740732).  Saving model ...
Epoch: 26 cost time: 1.259157657623291
Epoch: 26, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.821 Vali Acc: 0.741 Test Loss: 0.821 Test Acc: 0.741
Validation loss decreased (-0.740732 --> -0.740733).  Saving model ...
Epoch: 27 cost time: 1.2999639511108398
Epoch: 27, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744436).  Saving model ...
Epoch: 28 cost time: 1.223339557647705
Epoch: 28, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.790 Vali Acc: 0.748 Test Loss: 0.790 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 29 cost time: 1.262608289718628
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.776 Vali Acc: 0.748 Test Loss: 0.776 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 30 cost time: 1.2409415245056152
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.762 Vali Acc: 0.759 Test Loss: 0.762 Test Acc: 0.759
Validation loss decreased (-0.748140 --> -0.759252).  Saving model ...
Epoch: 31 cost time: 1.4636881351470947
Epoch: 31, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 32 cost time: 1.3942234516143799
Epoch: 32, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.736 Vali Acc: 0.770 Test Loss: 0.736 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 33 cost time: 1.2715511322021484
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.725 Vali Acc: 0.770 Test Loss: 0.725 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 34 cost time: 1.2008426189422607
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 35 cost time: 1.2644145488739014
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
Validation loss decreased (-0.770363 --> -0.777771).  Saving model ...
Epoch: 36 cost time: 1.0765643119812012
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.781 Test Loss: 0.694 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 37 cost time: 1.370959997177124
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.686 Vali Acc: 0.785 Test Loss: 0.686 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 38 cost time: 1.3563225269317627
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.679 Vali Acc: 0.793 Test Loss: 0.679 Test Acc: 0.793
Validation loss decreased (-0.785178 --> -0.792586).  Saving model ...
Epoch: 39 cost time: 1.054152011871338
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 40 cost time: 1.1011004447937012
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.666 Vali Acc: 0.804 Test Loss: 0.666 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803697).  Saving model ...
Epoch: 41 cost time: 1.183668851852417
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.660 Vali Acc: 0.804 Test Loss: 0.660 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 42 cost time: 1.192361831665039
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3443670272827148
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 44 cost time: 1.3310613632202148
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.807 Test Loss: 0.644 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 45 cost time: 1.331071138381958
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 46 cost time: 1.2957777976989746
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 47 cost time: 1.2784395217895508
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 48 cost time: 1.2892541885375977
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.629 Vali Acc: 0.811 Test Loss: 0.629 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 49 cost time: 1.2335703372955322
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.811 Test Loss: 0.625 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 50 cost time: 1.1956188678741455
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.815 Test Loss: 0.622 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 51 cost time: 1.171109914779663
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.815 Test Loss: 0.618 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 52 cost time: 1.2295584678649902
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.815 Test Loss: 0.615 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 53 cost time: 1.1296660900115967
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.815 Test Loss: 0.611 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 54 cost time: 1.2251741886138916
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.332953691482544
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3331458568572998
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.352905035018921
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.811 Test Loss: 0.598 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2137348651885986
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.811 Test Loss: 0.594 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.384793996810913
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.811 Test Loss: 0.591 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.4125046730041504
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.811 Test Loss: 0.588 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.2546894550323486
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.815 Test Loss: 0.586 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 62 cost time: 1.325941562652588
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.401918888092041
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.815 Test Loss: 0.583 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 64 cost time: 1.2027454376220703
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 65 cost time: 1.290266752243042
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 66 cost time: 1.088792324066162
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 67 cost time: 1.2236928939819336
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 68 cost time: 1.189086675643921
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.815 Test Loss: 0.573 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 69 cost time: 1.2451212406158447
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 70 cost time: 1.1708080768585205
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 71 cost time: 1.1588144302368164
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 72 cost time: 1.2327549457550049
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825920).  Saving model ...
Epoch: 73 cost time: 1.2244479656219482
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.826 Test Loss: 0.564 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 74 cost time: 1.0527782440185547
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833328).  Saving model ...
Epoch: 75 cost time: 1.1718730926513672
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 76 cost time: 1.2053897380828857
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 77 cost time: 1.259267807006836
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 78 cost time: 1.154362678527832
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.837 Test Loss: 0.556 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 79 cost time: 1.2110681533813477
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.837 Test Loss: 0.554 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 80 cost time: 1.2398669719696045
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.837 Test Loss: 0.553 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837032).  Saving model ...
Epoch: 81 cost time: 1.255826473236084
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.837 Test Loss: 0.551 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 82 cost time: 1.3765485286712646
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.837 Test Loss: 0.549 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 83 cost time: 1.282944917678833
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.837 Test Loss: 0.548 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 84 cost time: 1.2407753467559814
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.837 Test Loss: 0.546 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 85 cost time: 1.246424674987793
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.837 Test Loss: 0.545 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 86 cost time: 1.1932826042175293
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.837 Test Loss: 0.543 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 87 cost time: 1.2759606838226318
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 88 cost time: 1.2663898468017578
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 89 cost time: 1.0804924964904785
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 90 cost time: 1.0745906829833984
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 91 cost time: 1.088437795639038
Epoch: 91, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 92 cost time: 1.1283576488494873
Epoch: 92, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 93 cost time: 1.0142631530761719
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 94 cost time: 1.0466692447662354
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 95 cost time: 1.0748176574707031
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 96 cost time: 1.1365137100219727
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 97 cost time: 1.0684115886688232
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 98 cost time: 1.0843842029571533
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 99 cost time: 1.0861103534698486
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 100 cost time: 1.0850622653961182
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5125110149383545
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.882 Vali Acc: 0.133 Test Loss: 1.882 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.1554782390594482
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.864 Vali Acc: 0.141 Test Loss: 1.864 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.1366322040557861
Epoch: 3, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.846 Vali Acc: 0.144 Test Loss: 1.846 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.038020133972168
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.822 Vali Acc: 0.167 Test Loss: 1.822 Test Acc: 0.167
Validation loss decreased (-0.144426 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 1.0460360050201416
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.791 Vali Acc: 0.204 Test Loss: 1.791 Test Acc: 0.204
Validation loss decreased (-0.166648 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 1.0691206455230713
Epoch: 6, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.755 Vali Acc: 0.256 Test Loss: 1.755 Test Acc: 0.256
Validation loss decreased (-0.203686 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 1.035715103149414
Epoch: 7, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.716 Vali Acc: 0.296 Test Loss: 1.716 Test Acc: 0.296
Validation loss decreased (-0.255538 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 1.0548136234283447
Epoch: 8, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.674 Vali Acc: 0.378 Test Loss: 1.674 Test Acc: 0.378
Validation loss decreased (-0.296279 --> -0.377761).  Saving model ...
Epoch: 9 cost time: 1.0194056034088135
Epoch: 9, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.631 Vali Acc: 0.419 Test Loss: 1.631 Test Acc: 0.419
Validation loss decreased (-0.377761 --> -0.418502).  Saving model ...
Epoch: 10 cost time: 1.0832784175872803
Epoch: 10, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.586 Vali Acc: 0.456 Test Loss: 1.586 Test Acc: 0.456
Validation loss decreased (-0.418502 --> -0.455540).  Saving model ...
Epoch: 11 cost time: 1.0593478679656982
Epoch: 11, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.541 Vali Acc: 0.489 Test Loss: 1.541 Test Acc: 0.489
Validation loss decreased (-0.455540 --> -0.488873).  Saving model ...
Epoch: 12 cost time: 1.2616908550262451
Epoch: 12, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.495 Vali Acc: 0.507 Test Loss: 1.495 Test Acc: 0.507
Validation loss decreased (-0.488873 --> -0.507392).  Saving model ...
Epoch: 13 cost time: 1.0775134563446045
Epoch: 13, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
Validation loss decreased (-0.507392 --> -0.518504).  Saving model ...
Epoch: 14 cost time: 1.115022897720337
Epoch: 14, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.408 Vali Acc: 0.526 Test Loss: 1.408 Test Acc: 0.526
Validation loss decreased (-0.518504 --> -0.525912).  Saving model ...
Epoch: 15 cost time: 1.1200037002563477
Epoch: 15, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.367 Vali Acc: 0.552 Test Loss: 1.367 Test Acc: 0.552
Validation loss decreased (-0.525912 --> -0.551838).  Saving model ...
Epoch: 16 cost time: 1.0836255550384521
Epoch: 16, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.329 Vali Acc: 0.556 Test Loss: 1.329 Test Acc: 0.556
Validation loss decreased (-0.551838 --> -0.555542).  Saving model ...
Epoch: 17 cost time: 1.089717149734497
Epoch: 17, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.291 Vali Acc: 0.581 Test Loss: 1.291 Test Acc: 0.581
Validation loss decreased (-0.555542 --> -0.581469).  Saving model ...
Epoch: 18 cost time: 1.0724937915802002
Epoch: 18, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.254 Vali Acc: 0.589 Test Loss: 1.254 Test Acc: 0.589
Validation loss decreased (-0.581469 --> -0.588876).  Saving model ...
Epoch: 19 cost time: 1.0729732513427734
Epoch: 19, Steps: 2 | Train Loss: 0.634 Vali Loss: 1.216 Vali Acc: 0.589 Test Loss: 1.216 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588877).  Saving model ...
Epoch: 20 cost time: 1.1809828281402588
Epoch: 20, Steps: 2 | Train Loss: 0.547 Vali Loss: 1.179 Vali Acc: 0.596 Test Loss: 1.179 Test Acc: 0.596
Validation loss decreased (-0.588877 --> -0.596285).  Saving model ...
Epoch: 21 cost time: 1.1111094951629639
Epoch: 21, Steps: 2 | Train Loss: 0.458 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.596285 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 1.02272367477417
Epoch: 22, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.109 Vali Acc: 0.604 Test Loss: 1.109 Test Acc: 0.604
Validation loss decreased (-0.599989 --> -0.603693).  Saving model ...
Epoch: 23 cost time: 1.0105705261230469
Epoch: 23, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.074 Vali Acc: 0.619 Test Loss: 1.074 Test Acc: 0.619
Validation loss decreased (-0.603693 --> -0.618508).  Saving model ...
Epoch: 24 cost time: 1.018294095993042
Epoch: 24, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.036 Vali Acc: 0.626 Test Loss: 1.036 Test Acc: 0.626
Validation loss decreased (-0.618508 --> -0.625916).  Saving model ...
Epoch: 25 cost time: 1.1104707717895508
Epoch: 25, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.000 Vali Acc: 0.637 Test Loss: 1.000 Test Acc: 0.637
Validation loss decreased (-0.625916 --> -0.637027).  Saving model ...
Epoch: 26 cost time: 1.020491361618042
Epoch: 26, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.964 Vali Acc: 0.656 Test Loss: 0.964 Test Acc: 0.656
Validation loss decreased (-0.637027 --> -0.655546).  Saving model ...
Epoch: 27 cost time: 1.1766388416290283
Epoch: 27, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.929 Vali Acc: 0.674 Test Loss: 0.929 Test Acc: 0.674
Validation loss decreased (-0.655546 --> -0.674065).  Saving model ...
Epoch: 28 cost time: 1.0751476287841797
Epoch: 28, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.897 Vali Acc: 0.667 Test Loss: 0.897 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1751983165740967
Epoch: 29, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 30 cost time: 1.2270073890686035
Epoch: 30, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.833 Vali Acc: 0.696 Test Loss: 0.833 Test Acc: 0.696
Validation loss decreased (-0.677769 --> -0.696288).  Saving model ...
Epoch: 31 cost time: 1.013728380203247
Epoch: 31, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.804 Vali Acc: 0.711 Test Loss: 0.804 Test Acc: 0.711
Validation loss decreased (-0.696288 --> -0.711103).  Saving model ...
Epoch: 32 cost time: 1.22831392288208
Epoch: 32, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.776 Vali Acc: 0.719 Test Loss: 0.776 Test Acc: 0.719
Validation loss decreased (-0.711103 --> -0.718511).  Saving model ...
Epoch: 33 cost time: 1.048105001449585
Epoch: 33, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.751 Vali Acc: 0.722 Test Loss: 0.751 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722215).  Saving model ...
Epoch: 34 cost time: 1.0733237266540527
Epoch: 34, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.722215 --> -0.737030).  Saving model ...
Epoch: 35 cost time: 0.9227356910705566
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
Validation loss decreased (-0.737030 --> -0.737030).  Saving model ...
Epoch: 36 cost time: 0.9697730541229248
Epoch: 36, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.696 Vali Acc: 0.741 Test Loss: 0.696 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740734).  Saving model ...
Epoch: 37 cost time: 0.9269299507141113
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.685 Vali Acc: 0.744 Test Loss: 0.685 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744438).  Saving model ...
Epoch: 38 cost time: 1.0218234062194824
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.675 Vali Acc: 0.748 Test Loss: 0.675 Test Acc: 0.748
Validation loss decreased (-0.744438 --> -0.748141).  Saving model ...
Epoch: 39 cost time: 1.0547666549682617
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.668 Vali Acc: 0.752 Test Loss: 0.668 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 40 cost time: 0.9016659259796143
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.660 Vali Acc: 0.756 Test Loss: 0.660 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 41 cost time: 1.0454156398773193
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
Validation loss decreased (-0.755549 --> -0.762956).  Saving model ...
Epoch: 42 cost time: 0.9480772018432617
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.647 Vali Acc: 0.767 Test Loss: 0.647 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 43 cost time: 1.1143097877502441
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.640 Vali Acc: 0.767 Test Loss: 0.640 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 44 cost time: 1.1547009944915771
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.634 Vali Acc: 0.767 Test Loss: 0.634 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 45 cost time: 1.1583302021026611
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.781 Test Loss: 0.627 Test Acc: 0.781
Validation loss decreased (-0.766660 --> -0.781475).  Saving model ...
Epoch: 46 cost time: 1.1693994998931885
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.785 Test Loss: 0.622 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 47 cost time: 1.2540836334228516
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 48 cost time: 1.3310325145721436
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 49 cost time: 1.179551124572754
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 50 cost time: 1.181330919265747
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.793 Test Loss: 0.602 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 51 cost time: 1.1707918643951416
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.793 Test Loss: 0.599 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 52 cost time: 1.2710728645324707
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.793 Test Loss: 0.594 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 53 cost time: 1.18924880027771
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 1.2281177043914795
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 55 cost time: 1.197242259979248
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 56 cost time: 1.342602252960205
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 57 cost time: 1.3062613010406494
Epoch: 57, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.807 Test Loss: 0.578 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 58 cost time: 1.2253022193908691
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.807 Test Loss: 0.574 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 59 cost time: 1.367870569229126
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.807 Test Loss: 0.571 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 60 cost time: 1.1454882621765137
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.807 Test Loss: 0.568 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 61 cost time: 1.3017148971557617
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.807 Test Loss: 0.565 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 62 cost time: 1.1064021587371826
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 63 cost time: 1.218794822692871
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.815 Test Loss: 0.561 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 64 cost time: 1.2512094974517822
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.815 Test Loss: 0.559 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 65 cost time: 1.4439153671264648
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 66 cost time: 1.377661943435669
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 67 cost time: 1.3176870346069336
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 68 cost time: 1.1824431419372559
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 69 cost time: 1.2710628509521484
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 70 cost time: 1.143801212310791
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 71 cost time: 1.1670067310333252
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 72 cost time: 0.9791891574859619
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 73 cost time: 1.2352838516235352
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 74 cost time: 1.2347702980041504
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 75 cost time: 1.226067066192627
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 76 cost time: 1.237041711807251
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 77 cost time: 1.4606733322143555
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 78 cost time: 1.1399405002593994
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 79 cost time: 1.2049405574798584
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 80 cost time: 1.21282958984375
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 81 cost time: 1.1504850387573242
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 82 cost time: 1.1069691181182861
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 83 cost time: 1.2015280723571777
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 84 cost time: 1.0604157447814941
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 85 cost time: 1.2493267059326172
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 86 cost time: 1.1683430671691895
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 87 cost time: 1.2125864028930664
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 88 cost time: 1.1504030227661133
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 89 cost time: 1.2374732494354248
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 90 cost time: 1.2953035831451416
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 91 cost time: 1.431084394454956
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 92 cost time: 1.2378041744232178
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 93 cost time: 1.1579813957214355
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 94 cost time: 1.1595335006713867
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 95 cost time: 1.2865896224975586
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 96 cost time: 1.2273399829864502
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 97 cost time: 1.1046228408813477
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.830 Test Loss: 0.505 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 98 cost time: 1.0314452648162842
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.830 Test Loss: 0.503 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 99 cost time: 1.1475436687469482
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.830 Test Loss: 0.502 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 100 cost time: 0.9986937046051025
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.829625 --> -0.840736).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5796523094177246
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.863 Vali Acc: 0.133 Test Loss: 1.863 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.1022324562072754
Epoch: 2, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.851 Vali Acc: 0.141 Test Loss: 1.851 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.2008461952209473
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.837 Vali Acc: 0.152 Test Loss: 1.837 Test Acc: 0.152
Validation loss decreased (-0.140722 --> -0.151833).  Saving model ...
Epoch: 4 cost time: 1.2795815467834473
Epoch: 4, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.817 Vali Acc: 0.167 Test Loss: 1.817 Test Acc: 0.167
Validation loss decreased (-0.151833 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 1.032778024673462
Epoch: 5, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.792 Vali Acc: 0.181 Test Loss: 1.792 Test Acc: 0.181
Validation loss decreased (-0.166648 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 1.1206440925598145
Epoch: 6, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.762 Vali Acc: 0.181 Test Loss: 1.762 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 1.1680526733398438
Epoch: 7, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.728 Vali Acc: 0.207 Test Loss: 1.728 Test Acc: 0.207
Validation loss decreased (-0.181464 --> -0.207390).  Saving model ...
Epoch: 8 cost time: 1.0702900886535645
Epoch: 8, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.691 Vali Acc: 0.244 Test Loss: 1.691 Test Acc: 0.244
Validation loss decreased (-0.207390 --> -0.244428).  Saving model ...
Epoch: 9 cost time: 1.3131964206695557
Epoch: 9, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.652 Vali Acc: 0.311 Test Loss: 1.652 Test Acc: 0.311
Validation loss decreased (-0.244428 --> -0.311095).  Saving model ...
Epoch: 10 cost time: 1.0079152584075928
Epoch: 10, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.611 Vali Acc: 0.381 Test Loss: 1.611 Test Acc: 0.381
Validation loss decreased (-0.311095 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 1.2357969284057617
Epoch: 11, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.568 Vali Acc: 0.430 Test Loss: 1.568 Test Acc: 0.430
Validation loss decreased (-0.381465 --> -0.429614).  Saving model ...
Epoch: 12 cost time: 1.042405605316162
Epoch: 12, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.524 Vali Acc: 0.459 Test Loss: 1.524 Test Acc: 0.459
Validation loss decreased (-0.429614 --> -0.459244).  Saving model ...
Epoch: 13 cost time: 1.1775550842285156
Epoch: 13, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.480 Vali Acc: 0.530 Test Loss: 1.480 Test Acc: 0.530
Validation loss decreased (-0.459244 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 1.0459203720092773
Epoch: 14, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.434 Vali Acc: 0.570 Test Loss: 1.434 Test Acc: 0.570
Validation loss decreased (-0.529615 --> -0.570356).  Saving model ...
Epoch: 15 cost time: 1.0932056903839111
Epoch: 15, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.389 Vali Acc: 0.600 Test Loss: 1.389 Test Acc: 0.600
Validation loss decreased (-0.570356 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 1.0760433673858643
Epoch: 16, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.343 Vali Acc: 0.607 Test Loss: 1.343 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 17 cost time: 1.211479902267456
Epoch: 17, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.294 Vali Acc: 0.626 Test Loss: 1.294 Test Acc: 0.626
Validation loss decreased (-0.607394 --> -0.625913).  Saving model ...
Epoch: 18 cost time: 1.2220301628112793
Epoch: 18, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.245 Vali Acc: 0.641 Test Loss: 1.245 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640728).  Saving model ...
Epoch: 19 cost time: 1.2217960357666016
Epoch: 19, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.194 Vali Acc: 0.652 Test Loss: 1.194 Test Acc: 0.652
Validation loss decreased (-0.640728 --> -0.651840).  Saving model ...
Epoch: 20 cost time: 1.2514488697052002
Epoch: 20, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.144 Vali Acc: 0.681 Test Loss: 1.144 Test Acc: 0.681
Validation loss decreased (-0.651840 --> -0.681470).  Saving model ...
Epoch: 21 cost time: 1.2335143089294434
Epoch: 21, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.092 Vali Acc: 0.685 Test Loss: 1.092 Test Acc: 0.685
Validation loss decreased (-0.681470 --> -0.685174).  Saving model ...
Epoch: 22 cost time: 1.4120337963104248
Epoch: 22, Steps: 2 | Train Loss: 0.610 Vali Loss: 1.043 Vali Acc: 0.681 Test Loss: 1.043 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3150897026062012
Epoch: 23, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.685174 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 1.2629079818725586
Epoch: 24, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.946 Vali Acc: 0.704 Test Loss: 0.946 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 25 cost time: 1.0795624256134033
Epoch: 25, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.901 Vali Acc: 0.722 Test Loss: 0.901 Test Acc: 0.722
Validation loss decreased (-0.703694 --> -0.722213).  Saving model ...
Epoch: 26 cost time: 1.0681722164154053
Epoch: 26, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
Validation loss decreased (-0.722213 --> -0.729621).  Saving model ...
Epoch: 27 cost time: 1.2481739521026611
Epoch: 27, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.819 Vali Acc: 0.737 Test Loss: 0.819 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737029).  Saving model ...
Epoch: 28 cost time: 1.1687664985656738
Epoch: 28, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.786 Vali Acc: 0.733 Test Loss: 0.786 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1158790588378906
Epoch: 29, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 30 cost time: 1.1678152084350586
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.718 Vali Acc: 0.744 Test Loss: 0.718 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 31 cost time: 1.342893362045288
Epoch: 31, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.682 Vali Acc: 0.763 Test Loss: 0.682 Test Acc: 0.763
Validation loss decreased (-0.744437 --> -0.762956).  Saving model ...
Epoch: 32 cost time: 1.2881660461425781
Epoch: 32, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 33 cost time: 1.3265883922576904
Epoch: 33, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.618 Vali Acc: 0.778 Test Loss: 0.618 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777772).  Saving model ...
Epoch: 34 cost time: 1.332897663116455
Epoch: 34, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.595 Vali Acc: 0.778 Test Loss: 0.595 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 35 cost time: 1.304861307144165
Epoch: 35, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788883).  Saving model ...
Epoch: 36 cost time: 1.2246851921081543
Epoch: 36, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.567 Vali Acc: 0.793 Test Loss: 0.567 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 37 cost time: 1.1575005054473877
Epoch: 37, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.564 Vali Acc: 0.781 Test Loss: 0.564 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1376006603240967
Epoch: 38, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.565 Vali Acc: 0.781 Test Loss: 0.565 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1677918434143066
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.778 Test Loss: 0.565 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.120894193649292
Epoch: 40, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.564 Vali Acc: 0.778 Test Loss: 0.564 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4619441032409668
Epoch: 41, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.561 Vali Acc: 0.781 Test Loss: 0.561 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1929326057434082
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.555 Vali Acc: 0.785 Test Loss: 0.555 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1402099132537842
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.545 Vali Acc: 0.793 Test Loss: 0.545 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 44 cost time: 1.1395885944366455
Epoch: 44, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799995).  Saving model ...
Epoch: 45 cost time: 1.1723856925964355
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.811 Test Loss: 0.520 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 46 cost time: 1.1202499866485596
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
Validation loss decreased (-0.811106 --> -0.818513).  Saving model ...
Epoch: 47 cost time: 1.1250734329223633
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818514).  Saving model ...
Epoch: 48 cost time: 1.1597192287445068
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 49 cost time: 1.3014214038848877
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 50 cost time: 1.2726407051086426
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
Validation loss decreased (-0.818514 --> -0.818514).  Saving model ...
Epoch: 51 cost time: 1.056607723236084
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
Validation loss decreased (-0.818514 --> -0.822218).  Saving model ...
Epoch: 52 cost time: 1.1746070384979248
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.464 Vali Acc: 0.822 Test Loss: 0.464 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 53 cost time: 1.019002914428711
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.822 Test Loss: 0.460 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 54 cost time: 0.9428186416625977
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 55 cost time: 1.142669677734375
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.822218 --> -0.825921).  Saving model ...
Epoch: 56 cost time: 1.090116024017334
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 57 cost time: 1.083817958831787
Epoch: 57, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.826 Test Loss: 0.448 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 58 cost time: 1.0618746280670166
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.444 Vali Acc: 0.830 Test Loss: 0.444 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 59 cost time: 1.0956275463104248
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 60 cost time: 1.0670390129089355
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 61 cost time: 1.1351206302642822
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 62 cost time: 1.1539008617401123
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 63 cost time: 1.2497045993804932
Epoch: 63, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2606534957885742
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0717573165893555
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1872198581695557
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0489380359649658
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1787285804748535
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.830 Test Loss: 0.443 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.067077875137329
Epoch: 69, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.830 Test Loss: 0.441 Test Acc: 0.830
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.1496624946594238
Epoch: 70, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.837 Test Loss: 0.440 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837033).  Saving model ...
Epoch: 71 cost time: 1.2194151878356934
Epoch: 71, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.837033 --> -0.840736).  Saving model ...
Epoch: 72 cost time: 1.2921130657196045
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 73 cost time: 1.2414073944091797
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 74 cost time: 1.1440961360931396
Epoch: 74, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 75 cost time: 1.222843885421753
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 76 cost time: 1.098642110824585
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.844440 --> -0.848144).  Saving model ...
Epoch: 77 cost time: 1.1427409648895264
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 78 cost time: 1.4317033290863037
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 79 cost time: 1.1066138744354248
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 80 cost time: 1.2272229194641113
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.856 Test Loss: 0.417 Test Acc: 0.856
Validation loss decreased (-0.848144 --> -0.855551).  Saving model ...
Epoch: 81 cost time: 1.146801471710205
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.859 Test Loss: 0.414 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 82 cost time: 1.159071683883667
Epoch: 82, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.859 Test Loss: 0.412 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 83 cost time: 1.0435574054718018
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.863 Test Loss: 0.409 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862959).  Saving model ...
Epoch: 84 cost time: 1.1750617027282715
Epoch: 84, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.863 Test Loss: 0.407 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 85 cost time: 1.162862777709961
Epoch: 85, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 86 cost time: 1.0825800895690918
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.863 Test Loss: 0.404 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 87 cost time: 1.0005395412445068
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
Validation loss decreased (-0.862959 --> -0.866663).  Saving model ...
Epoch: 88 cost time: 1.0947558879852295
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.867 Test Loss: 0.402 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 89 cost time: 1.183227777481079
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 90 cost time: 1.1611328125
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 91 cost time: 1.1832067966461182
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 92 cost time: 1.1158037185668945
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 93 cost time: 1.3418724536895752
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.867 Test Loss: 0.397 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 94 cost time: 1.1580252647399902
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.867 Test Loss: 0.395 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 95 cost time: 1.048844814300537
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.867 Test Loss: 0.394 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 96 cost time: 1.1874301433563232
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
Validation loss decreased (-0.866663 --> -0.870366).  Saving model ...
Epoch: 97 cost time: 1.1663682460784912
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 98 cost time: 1.0186169147491455
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 99 cost time: 1.0851049423217773
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 100 cost time: 1.0536696910858154
Epoch: 100, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6293623447418213
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.852 Vali Acc: 0.148 Test Loss: 1.852 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.3906610012054443
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.845 Vali Acc: 0.152 Test Loss: 1.845 Test Acc: 0.152
Validation loss decreased (-0.148130 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 1.1418049335479736
Epoch: 3, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.831 Vali Acc: 0.163 Test Loss: 1.831 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.1185252666473389
Epoch: 4, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.800 Vali Acc: 0.189 Test Loss: 1.800 Test Acc: 0.189
Validation loss decreased (-0.162945 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 1.0575087070465088
Epoch: 5, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.761 Vali Acc: 0.219 Test Loss: 1.761 Test Acc: 0.219
Validation loss decreased (-0.188871 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 1.2667956352233887
Epoch: 6, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.713 Vali Acc: 0.267 Test Loss: 1.713 Test Acc: 0.267
Validation loss decreased (-0.218501 --> -0.266650).  Saving model ...
Epoch: 7 cost time: 1.314582109451294
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.659 Vali Acc: 0.359 Test Loss: 1.659 Test Acc: 0.359
Validation loss decreased (-0.266650 --> -0.359243).  Saving model ...
Epoch: 8 cost time: 1.1635313034057617
Epoch: 8, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.600 Vali Acc: 0.437 Test Loss: 1.600 Test Acc: 0.437
Validation loss decreased (-0.359243 --> -0.437021).  Saving model ...
Epoch: 9 cost time: 1.1387219429016113
Epoch: 9, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.537 Vali Acc: 0.489 Test Loss: 1.537 Test Acc: 0.489
Validation loss decreased (-0.437021 --> -0.488874).  Saving model ...
Epoch: 10 cost time: 1.1638102531433105
Epoch: 10, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.470 Vali Acc: 0.515 Test Loss: 1.470 Test Acc: 0.515
Validation loss decreased (-0.488874 --> -0.514800).  Saving model ...
Epoch: 11 cost time: 1.1459901332855225
Epoch: 11, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.400 Vali Acc: 0.544 Test Loss: 1.400 Test Acc: 0.544
Validation loss decreased (-0.514800 --> -0.544430).  Saving model ...
Epoch: 12 cost time: 1.1182098388671875
Epoch: 12, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.329 Vali Acc: 0.585 Test Loss: 1.329 Test Acc: 0.585
Validation loss decreased (-0.544430 --> -0.585172).  Saving model ...
Epoch: 13 cost time: 1.1175508499145508
Epoch: 13, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.258 Vali Acc: 0.630 Test Loss: 1.258 Test Acc: 0.630
Validation loss decreased (-0.585172 --> -0.629617).  Saving model ...
Epoch: 14 cost time: 1.063049077987671
Epoch: 14, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.188 Vali Acc: 0.656 Test Loss: 1.188 Test Acc: 0.656
Validation loss decreased (-0.629617 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 1.186662197113037
Epoch: 15, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.118 Vali Acc: 0.685 Test Loss: 1.118 Test Acc: 0.685
Validation loss decreased (-0.655544 --> -0.685174).  Saving model ...
Epoch: 16 cost time: 1.3009741306304932
Epoch: 16, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.685174 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 1.2788426876068115
Epoch: 17, Steps: 2 | Train Loss: 1.115 Vali Loss: 0.986 Vali Acc: 0.752 Test Loss: 0.986 Test Acc: 0.752
Validation loss decreased (-0.711101 --> -0.751842).  Saving model ...
Epoch: 18 cost time: 1.129760503768921
Epoch: 18, Steps: 2 | Train Loss: 1.166 Vali Loss: 0.921 Vali Acc: 0.774 Test Loss: 0.921 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774065).  Saving model ...
Epoch: 19 cost time: 1.1161911487579346
Epoch: 19, Steps: 2 | Train Loss: 1.112 Vali Loss: 0.858 Vali Acc: 0.811 Test Loss: 0.858 Test Acc: 0.811
Validation loss decreased (-0.774065 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 1.2223179340362549
Epoch: 20, Steps: 2 | Train Loss: 1.039 Vali Loss: 0.798 Vali Acc: 0.833 Test Loss: 0.798 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 1.1628732681274414
Epoch: 21, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.740 Vali Acc: 0.837 Test Loss: 0.740 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837030).  Saving model ...
Epoch: 22 cost time: 1.1823899745941162
Epoch: 22, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.686 Vali Acc: 0.863 Test Loss: 0.686 Test Acc: 0.863
Validation loss decreased (-0.837030 --> -0.862956).  Saving model ...
Epoch: 23 cost time: 1.1245276927947998
Epoch: 23, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 1.0689151287078857
Epoch: 24, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.590 Vali Acc: 0.885 Test Loss: 0.590 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 25 cost time: 1.0821878910064697
Epoch: 25, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.547 Vali Acc: 0.885 Test Loss: 0.547 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 26 cost time: 1.0636553764343262
Epoch: 26, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.511 Vali Acc: 0.893 Test Loss: 0.511 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892587).  Saving model ...
Epoch: 27 cost time: 1.1370677947998047
Epoch: 27, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.478 Vali Acc: 0.893 Test Loss: 0.478 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 28 cost time: 1.10752272605896
Epoch: 28, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.450 Vali Acc: 0.885 Test Loss: 0.450 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0644822120666504
Epoch: 29, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.427 Vali Acc: 0.881 Test Loss: 0.427 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.050827980041504
Epoch: 30, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.098386526107788
Epoch: 31, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1140999794006348
Epoch: 32, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0644161701202393
Epoch: 33, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.329 Vali Acc: 0.896 Test Loss: 0.329 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896293).  Saving model ...
Epoch: 34 cost time: 1.178757905960083
Epoch: 34, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.972618579864502
Epoch: 35, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 36 cost time: 1.099494457244873
Epoch: 36, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.283 Vali Acc: 0.896 Test Loss: 0.283 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1771986484527588
Epoch: 37, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1119439601898193
Epoch: 38, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 39 cost time: 1.1612350940704346
Epoch: 39, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.261 Vali Acc: 0.907 Test Loss: 0.261 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 40 cost time: 1.326923131942749
Epoch: 40, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 1.3211092948913574
Epoch: 41, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 42 cost time: 1.1610910892486572
Epoch: 42, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.911109 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 1.3152751922607422
Epoch: 43, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 44 cost time: 1.2845001220703125
Epoch: 44, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 1.1484687328338623
Epoch: 45, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 1.245227336883545
Epoch: 46, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0391871929168701
Epoch: 47, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1721000671386719
Epoch: 48, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0673768520355225
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1311838626861572
Epoch: 50, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1529560089111328
Epoch: 51, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1766879558563232
Epoch: 52, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1441469192504883
Epoch: 53, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1199915409088135
Epoch: 54, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.3299481868743896
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6308727264404297
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.829 Vali Acc: 0.204 Test Loss: 1.829 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 1.203888177871704
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.823 Vali Acc: 0.204 Test Loss: 1.823 Test Acc: 0.204
Validation loss decreased (-0.203685 --> -0.203685).  Saving model ...
Epoch: 3 cost time: 1.134056568145752
Epoch: 3, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.806 Vali Acc: 0.219 Test Loss: 1.806 Test Acc: 0.219
Validation loss decreased (-0.203685 --> -0.218500).  Saving model ...
Epoch: 4 cost time: 1.0158956050872803
Epoch: 4, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.766 Vali Acc: 0.241 Test Loss: 1.766 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.1592462062835693
Epoch: 5, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.714 Vali Acc: 0.289 Test Loss: 1.714 Test Acc: 0.289
Validation loss decreased (-0.240723 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 1.2256441116333008
Epoch: 6, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.651 Vali Acc: 0.326 Test Loss: 1.651 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325909).  Saving model ...
Epoch: 7 cost time: 1.1386525630950928
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.584 Vali Acc: 0.400 Test Loss: 1.584 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399984).  Saving model ...
Epoch: 8 cost time: 1.1382849216461182
Epoch: 8, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.508 Vali Acc: 0.507 Test Loss: 1.508 Test Acc: 0.507
Validation loss decreased (-0.399984 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 1.082939863204956
Epoch: 9, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.432 Vali Acc: 0.589 Test Loss: 1.432 Test Acc: 0.589
Validation loss decreased (-0.507392 --> -0.588875).  Saving model ...
Epoch: 10 cost time: 1.036830186843872
Epoch: 10, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.353 Vali Acc: 0.659 Test Loss: 1.353 Test Acc: 0.659
Validation loss decreased (-0.588875 --> -0.659246).  Saving model ...
Epoch: 11 cost time: 1.200291633605957
Epoch: 11, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.273 Vali Acc: 0.700 Test Loss: 1.273 Test Acc: 0.700
Validation loss decreased (-0.659246 --> -0.699987).  Saving model ...
Epoch: 12 cost time: 1.1590657234191895
Epoch: 12, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.196 Vali Acc: 0.722 Test Loss: 1.196 Test Acc: 0.722
Validation loss decreased (-0.699987 --> -0.722210).  Saving model ...
Epoch: 13 cost time: 1.2789678573608398
Epoch: 13, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.122 Vali Acc: 0.756 Test Loss: 1.122 Test Acc: 0.756
Validation loss decreased (-0.722210 --> -0.755544).  Saving model ...
Epoch: 14 cost time: 1.2793138027191162
Epoch: 14, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.051 Vali Acc: 0.767 Test Loss: 1.051 Test Acc: 0.767
Validation loss decreased (-0.755544 --> -0.766656).  Saving model ...
Epoch: 15 cost time: 1.2021291255950928
Epoch: 15, Steps: 2 | Train Loss: 1.220 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777768).  Saving model ...
Epoch: 16 cost time: 1.345827341079712
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 0.924 Vali Acc: 0.804 Test Loss: 0.924 Test Acc: 0.804
Validation loss decreased (-0.777768 --> -0.803694).  Saving model ...
Epoch: 17 cost time: 1.1694576740264893
Epoch: 17, Steps: 2 | Train Loss: 1.229 Vali Loss: 0.866 Vali Acc: 0.822 Test Loss: 0.866 Test Acc: 0.822
Validation loss decreased (-0.803694 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 1.0787482261657715
Epoch: 18, Steps: 2 | Train Loss: 1.238 Vali Loss: 0.810 Vali Acc: 0.830 Test Loss: 0.810 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829622).  Saving model ...
Epoch: 19 cost time: 1.0206773281097412
Epoch: 19, Steps: 2 | Train Loss: 1.090 Vali Loss: 0.758 Vali Acc: 0.852 Test Loss: 0.758 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851844).  Saving model ...
Epoch: 20 cost time: 1.1098906993865967
Epoch: 20, Steps: 2 | Train Loss: 1.136 Vali Loss: 0.711 Vali Acc: 0.859 Test Loss: 0.711 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 21 cost time: 1.1252753734588623
Epoch: 21, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.665 Vali Acc: 0.859 Test Loss: 0.665 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859253).  Saving model ...
Epoch: 22 cost time: 1.193894386291504
Epoch: 22, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 1.311131238937378
Epoch: 23, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.585 Vali Acc: 0.874 Test Loss: 0.585 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 24 cost time: 1.195826768875122
Epoch: 24, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.551 Vali Acc: 0.874 Test Loss: 0.551 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874069).  Saving model ...
Epoch: 25 cost time: 1.333383321762085
Epoch: 25, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.520 Vali Acc: 0.874 Test Loss: 0.520 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 26 cost time: 1.2892377376556396
Epoch: 26, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.495 Vali Acc: 0.874 Test Loss: 0.495 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 27 cost time: 1.238534927368164
Epoch: 27, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.251596212387085
Epoch: 28, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 1.1352357864379883
Epoch: 29, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0958034992218018
Epoch: 30, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.414 Vali Acc: 0.874 Test Loss: 0.414 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1636762619018555
Epoch: 31, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.392 Vali Acc: 0.881 Test Loss: 0.392 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881478).  Saving model ...
Epoch: 32 cost time: 1.2694463729858398
Epoch: 32, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.368 Vali Acc: 0.885 Test Loss: 0.368 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 33 cost time: 1.1222999095916748
Epoch: 33, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.347 Vali Acc: 0.893 Test Loss: 0.347 Test Acc: 0.893
Validation loss decreased (-0.885182 --> -0.892589).  Saving model ...
Epoch: 34 cost time: 1.0471091270446777
Epoch: 34, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.330 Vali Acc: 0.893 Test Loss: 0.330 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 35 cost time: 1.1862919330596924
Epoch: 35, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 36 cost time: 1.1630187034606934
Epoch: 36, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 1.2198028564453125
Epoch: 37, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 1.1278424263000488
Epoch: 38, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 39 cost time: 1.177356481552124
Epoch: 39, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 40 cost time: 1.3842685222625732
Epoch: 40, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.915 Test Loss: 0.259 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 41 cost time: 1.2611784934997559
Epoch: 41, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 42 cost time: 1.219801902770996
Epoch: 42, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 1.1243205070495605
Epoch: 43, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 1.1942501068115234
Epoch: 44, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 1.3869574069976807
Epoch: 45, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 46 cost time: 1.1091253757476807
Epoch: 46, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1866343021392822
Epoch: 47, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1634466648101807
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2107257843017578
Epoch: 49, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1076362133026123
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 1.1926956176757812
Epoch: 51, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2028563022613525
Epoch: 52, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.4317758083343506
Epoch: 53, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.246457576751709
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.255943775177002
Epoch: 55, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3039588928222656
Epoch: 56, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 1.253587245941162
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.143064022064209
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.276111364364624
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.216421365737915
Epoch: 60, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.1458709239959717
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.1026668548583984
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.1559209823608398
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.1534595489501953
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.0242538452148438
Epoch: 65, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.094207763671875
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4354312419891357
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2667441368103027
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0646038055419922
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.1148924827575684
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.0292015075683594
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.1124701499938965
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.04245924949646
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.028409719467163
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1015594005584717
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1706843376159668
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.106605052947998
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9686105251312256
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.061264991760254
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.1276209354400635
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1471161842346191
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3965120315551758
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.024855375289917
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2091302871704102
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.1031975746154785
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0949201583862305
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2645399570465088
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9303691387176514
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 0.8738429546356201
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 0.9891557693481445
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.1267919540405273
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.095874309539795
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.1293883323669434
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.110152244567871
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.1448357105255127
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.1498842239379883
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.1984856128692627
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.0968995094299316
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1855182647705078
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1211910247802734
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.2344331741333008
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.1466362476348877
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.216963291168213
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 0.9846322536468506
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.080437183380127
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.1275475025177002
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1263158321380615
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.0999562740325928
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1099183559417725
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.100144386291504
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.246744155883789
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.0773210525512695
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1231484413146973
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.064112663269043
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.0624475479125977
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.2636137008666992
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.3370819091796875
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.3171627521514893
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.2245206832885742
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.0743513107299805
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.2182459831237793
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.1199543476104736
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2541074752807617
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.1604602336883545
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.1200730800628662
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.176424503326416
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.21370267868042
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.1382725238800049
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1162822246551514
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.1538572311401367
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.2268986701965332
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.152787208557129
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.0622365474700928
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.1157879829406738
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.1186707019805908
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.1472437381744385
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.23197603225708
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.2873024940490723
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.0732500553131104
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.2776150703430176
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2132196426391602
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.0705347061157227
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.2706012725830078
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.128037452697754
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 1.2119266986846924
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.0857033729553223
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.244056224822998
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.1646039485931396
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.139563798904419
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.0963246822357178
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.0894920825958252
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.111457347869873
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.008023977279663
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.1915628910064697
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.3461596965789795
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.1746091842651367
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.0648491382598877
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 1.18980073928833
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.1296119689941406
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.1408300399780273
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1403698921203613
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.054992437362671
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.2035441398620605
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1519160270690918
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.1134424209594727
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.1196272373199463
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 778630
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5290582180023193
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.855 Vali Acc: 0.144 Test Loss: 1.855 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.0932326316833496
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.814 Vali Acc: 0.178 Test Loss: 1.814 Test Acc: 0.178
Validation loss decreased (-0.144426 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.0870475769042969
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.771 Vali Acc: 0.241 Test Loss: 1.771 Test Acc: 0.241
Validation loss decreased (-0.177760 --> -0.240723).  Saving model ...
Epoch: 4 cost time: 1.2152087688446045
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.711 Vali Acc: 0.322 Test Loss: 1.711 Test Acc: 0.322
Validation loss decreased (-0.240723 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 1.0956284999847412
Epoch: 5, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.636 Vali Acc: 0.400 Test Loss: 1.636 Test Acc: 0.400
Validation loss decreased (-0.322205 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 1.1744120121002197
Epoch: 6, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.551 Vali Acc: 0.478 Test Loss: 1.551 Test Acc: 0.478
Validation loss decreased (-0.399984 --> -0.477762).  Saving model ...
Epoch: 7 cost time: 1.1210606098175049
Epoch: 7, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.461 Vali Acc: 0.559 Test Loss: 1.461 Test Acc: 0.559
Validation loss decreased (-0.477762 --> -0.559245).  Saving model ...
Epoch: 8 cost time: 0.9513063430786133
Epoch: 8, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.368 Vali Acc: 0.626 Test Loss: 1.368 Test Acc: 0.626
Validation loss decreased (-0.559245 --> -0.625912).  Saving model ...
Epoch: 9 cost time: 1.062760829925537
Epoch: 9, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.277 Vali Acc: 0.693 Test Loss: 1.277 Test Acc: 0.693
Validation loss decreased (-0.625912 --> -0.692580).  Saving model ...
Epoch: 10 cost time: 1.1098034381866455
Epoch: 10, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.189 Vali Acc: 0.715 Test Loss: 1.189 Test Acc: 0.715
Validation loss decreased (-0.692580 --> -0.714803).  Saving model ...
Epoch: 11 cost time: 1.1516034603118896
Epoch: 11, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.104 Vali Acc: 0.752 Test Loss: 1.104 Test Acc: 0.752
Validation loss decreased (-0.714803 --> -0.751841).  Saving model ...
Epoch: 12 cost time: 1.0267813205718994
Epoch: 12, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.023 Vali Acc: 0.763 Test Loss: 1.023 Test Acc: 0.763
Validation loss decreased (-0.751841 --> -0.762953).  Saving model ...
Epoch: 13 cost time: 1.1664230823516846
Epoch: 13, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.948 Vali Acc: 0.781 Test Loss: 0.948 Test Acc: 0.781
Validation loss decreased (-0.762953 --> -0.781472).  Saving model ...
Epoch: 14 cost time: 1.155855417251587
Epoch: 14, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.879 Vali Acc: 0.796 Test Loss: 0.879 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796288).  Saving model ...
Epoch: 15 cost time: 1.1283204555511475
Epoch: 15, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.819 Vali Acc: 0.804 Test Loss: 0.819 Test Acc: 0.804
Validation loss decreased (-0.796288 --> -0.803696).  Saving model ...
Epoch: 16 cost time: 1.2658376693725586
Epoch: 16, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.767 Vali Acc: 0.815 Test Loss: 0.767 Test Acc: 0.815
Validation loss decreased (-0.803696 --> -0.814807).  Saving model ...
Epoch: 17 cost time: 1.2149085998535156
Epoch: 17, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.722 Vali Acc: 0.807 Test Loss: 0.722 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2411727905273438
Epoch: 18, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.172076940536499
Epoch: 19, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2154788970947266
Epoch: 20, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2344038486480713
Epoch: 21, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1674270629882812
Epoch: 22, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.598 Vali Acc: 0.807 Test Loss: 0.598 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0759689807891846
Epoch: 23, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.814807 --> -0.818513).  Saving model ...
Epoch: 24 cost time: 1.0507657527923584
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 25 cost time: 1.0962228775024414
Epoch: 25, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 26 cost time: 1.0743935108184814
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 27 cost time: 1.0657739639282227
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.548 Vali Acc: 0.830 Test Loss: 0.548 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 28 cost time: 1.2215187549591064
Epoch: 28, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.830 Test Loss: 0.545 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 29 cost time: 1.235827922821045
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 1.221557378768921
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.538 Vali Acc: 0.837 Test Loss: 0.538 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 31 cost time: 1.2750093936920166
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.536 Vali Acc: 0.837 Test Loss: 0.536 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 32 cost time: 1.1092731952667236
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 33 cost time: 1.1310338973999023
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 34 cost time: 1.0758109092712402
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 35 cost time: 1.058901071548462
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 36 cost time: 1.066525936126709
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 1.206707239151001
Epoch: 37, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 38 cost time: 1.0395028591156006
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 39 cost time: 0.9924595355987549
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 40 cost time: 1.1973989009857178
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 41 cost time: 1.1427991390228271
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 42 cost time: 1.1444387435913086
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 43 cost time: 1.2167084217071533
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 44 cost time: 1.1448001861572266
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.510 Vali Acc: 0.852 Test Loss: 0.510 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 45 cost time: 1.1790602207183838
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.852 Test Loss: 0.508 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 46 cost time: 1.2573344707489014
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.852 Test Loss: 0.506 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 47 cost time: 1.2165353298187256
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855551).  Saving model ...
Epoch: 48 cost time: 1.1981375217437744
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 49 cost time: 1.2444803714752197
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 50 cost time: 1.0961029529571533
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859254).  Saving model ...
Epoch: 51 cost time: 1.3014578819274902
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 52 cost time: 0.9820303916931152
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 53 cost time: 1.2600605487823486
Epoch: 53, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 54 cost time: 1.1062889099121094
Epoch: 54, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 55 cost time: 0.9799149036407471
Epoch: 55, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 56 cost time: 1.0352208614349365
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 57 cost time: 1.2092533111572266
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.863 Test Loss: 0.487 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 58 cost time: 1.0977230072021484
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.863 Test Loss: 0.486 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 59 cost time: 1.1868221759796143
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 60 cost time: 1.162426233291626
Epoch: 60, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.863 Test Loss: 0.483 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 61 cost time: 1.0970757007598877
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 62 cost time: 1.0653932094573975
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 63 cost time: 1.0988779067993164
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.863 Test Loss: 0.480 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 64 cost time: 1.1007838249206543
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 65 cost time: 1.0579054355621338
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 66 cost time: 1.0937094688415527
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 67 cost time: 1.0642919540405273
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 68 cost time: 1.0822224617004395
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 69 cost time: 1.0455667972564697
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 70 cost time: 1.0741944313049316
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 71 cost time: 1.0381107330322266
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 72 cost time: 1.0684382915496826
Epoch: 72, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 73 cost time: 1.1004951000213623
Epoch: 73, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 74 cost time: 0.957528829574585
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 75 cost time: 1.2240080833435059
Epoch: 75, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 76 cost time: 1.0736279487609863
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 77 cost time: 1.224217414855957
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 78 cost time: 1.0341601371765137
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 79 cost time: 1.1129302978515625
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 80 cost time: 1.1072871685028076
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.867 Test Loss: 0.459 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 81 cost time: 1.0921316146850586
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 82 cost time: 1.109255313873291
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 83 cost time: 1.110358476638794
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 84 cost time: 1.1331226825714111
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 85 cost time: 1.1189584732055664
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 86 cost time: 1.1499736309051514
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 87 cost time: 1.0486180782318115
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 88 cost time: 1.070509672164917
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.874 Test Loss: 0.452 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 89 cost time: 1.1630468368530273
Epoch: 89, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.874 Test Loss: 0.452 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 90 cost time: 1.2365305423736572
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.874 Test Loss: 0.451 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 91 cost time: 0.9787993431091309
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.874 Test Loss: 0.450 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 92 cost time: 1.0691266059875488
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.881 Test Loss: 0.449 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881477).  Saving model ...
Epoch: 93 cost time: 0.9325425624847412
Epoch: 93, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.881 Test Loss: 0.449 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 94 cost time: 1.0296714305877686
Epoch: 94, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.885 Test Loss: 0.448 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 95 cost time: 1.19081449508667
Epoch: 95, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.885 Test Loss: 0.447 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 96 cost time: 1.047654151916504
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.885 Test Loss: 0.446 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 97 cost time: 1.256880760192871
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.885 Test Loss: 0.445 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 98 cost time: 1.0704073905944824
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.885 Test Loss: 0.444 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 99 cost time: 1.1293928623199463
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.885 Test Loss: 0.444 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 100 cost time: 1.102721929550171
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.885 Test Loss: 0.443 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3299221992492676
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.834 Vali Acc: 0.189 Test Loss: 1.834 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.9413127899169922
Epoch: 2, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.803 Vali Acc: 0.222 Test Loss: 1.803 Test Acc: 0.222
Validation loss decreased (-0.188871 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 1.148693561553955
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.770 Vali Acc: 0.267 Test Loss: 1.770 Test Acc: 0.267
Validation loss decreased (-0.222204 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 1.1072742938995361
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.723 Vali Acc: 0.322 Test Loss: 1.723 Test Acc: 0.322
Validation loss decreased (-0.266649 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 1.0439486503601074
Epoch: 5, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.664 Vali Acc: 0.363 Test Loss: 1.664 Test Acc: 0.363
Validation loss decreased (-0.322205 --> -0.362946).  Saving model ...
Epoch: 6 cost time: 1.038238286972046
Epoch: 6, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.598 Vali Acc: 0.415 Test Loss: 1.598 Test Acc: 0.415
Validation loss decreased (-0.362946 --> -0.414799).  Saving model ...
Epoch: 7 cost time: 1.257507562637329
Epoch: 7, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.528 Vali Acc: 0.474 Test Loss: 1.528 Test Acc: 0.474
Validation loss decreased (-0.414799 --> -0.474059).  Saving model ...
Epoch: 8 cost time: 1.1434457302093506
Epoch: 8, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.456 Vali Acc: 0.530 Test Loss: 1.456 Test Acc: 0.530
Validation loss decreased (-0.474059 --> -0.529615).  Saving model ...
Epoch: 9 cost time: 1.1949856281280518
Epoch: 9, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.384 Vali Acc: 0.567 Test Loss: 1.384 Test Acc: 0.567
Validation loss decreased (-0.529615 --> -0.566653).  Saving model ...
Epoch: 10 cost time: 1.0579001903533936
Epoch: 10, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.315 Vali Acc: 0.581 Test Loss: 1.315 Test Acc: 0.581
Validation loss decreased (-0.566653 --> -0.581468).  Saving model ...
Epoch: 11 cost time: 1.065500020980835
Epoch: 11, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.246 Vali Acc: 0.626 Test Loss: 1.246 Test Acc: 0.626
Validation loss decreased (-0.581468 --> -0.625913).  Saving model ...
Epoch: 12 cost time: 1.0853242874145508
Epoch: 12, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.178 Vali Acc: 0.656 Test Loss: 1.178 Test Acc: 0.656
Validation loss decreased (-0.625913 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 1.1335701942443848
Epoch: 13, Steps: 2 | Train Loss: 0.732 Vali Loss: 1.115 Vali Acc: 0.681 Test Loss: 1.115 Test Acc: 0.681
Validation loss decreased (-0.655544 --> -0.681470).  Saving model ...
Epoch: 14 cost time: 1.1021904945373535
Epoch: 14, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.056 Vali Acc: 0.696 Test Loss: 1.056 Test Acc: 0.696
Validation loss decreased (-0.681470 --> -0.696286).  Saving model ...
Epoch: 15 cost time: 1.0193328857421875
Epoch: 15, Steps: 2 | Train Loss: 0.583 Vali Loss: 1.002 Vali Acc: 0.704 Test Loss: 1.002 Test Acc: 0.704
Validation loss decreased (-0.696286 --> -0.703694).  Saving model ...
Epoch: 16 cost time: 1.0495851039886475
Epoch: 16, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.953 Vali Acc: 0.707 Test Loss: 0.953 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 17 cost time: 1.1558988094329834
Epoch: 17, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.909 Vali Acc: 0.719 Test Loss: 0.909 Test Acc: 0.719
Validation loss decreased (-0.707398 --> -0.718509).  Saving model ...
Epoch: 18 cost time: 1.1487720012664795
Epoch: 18, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
Validation loss decreased (-0.718509 --> -0.733325).  Saving model ...
Epoch: 19 cost time: 1.0991706848144531
Epoch: 19, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 0.9430749416351318
Epoch: 20, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.808 Vali Acc: 0.741 Test Loss: 0.808 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740733).  Saving model ...
Epoch: 21 cost time: 1.0711462497711182
Epoch: 21, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.781 Vali Acc: 0.748 Test Loss: 0.781 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748140).  Saving model ...
Epoch: 22 cost time: 1.327885389328003
Epoch: 22, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.758 Vali Acc: 0.752 Test Loss: 0.758 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 23 cost time: 1.0726377964019775
Epoch: 23, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.737 Vali Acc: 0.752 Test Loss: 0.737 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 24 cost time: 1.108459711074829
Epoch: 24, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.719 Vali Acc: 0.763 Test Loss: 0.719 Test Acc: 0.763
Validation loss decreased (-0.751844 --> -0.762956).  Saving model ...
Epoch: 25 cost time: 1.0551707744598389
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.704 Vali Acc: 0.763 Test Loss: 0.704 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 26 cost time: 1.2491486072540283
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 27 cost time: 1.1828606128692627
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.681 Vali Acc: 0.767 Test Loss: 0.681 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 28 cost time: 1.1958231925964355
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.672 Vali Acc: 0.767 Test Loss: 0.672 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 29 cost time: 1.1562995910644531
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.664 Vali Acc: 0.767 Test Loss: 0.664 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 30 cost time: 1.2101573944091797
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.658 Vali Acc: 0.774 Test Loss: 0.658 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774067).  Saving model ...
Epoch: 31 cost time: 1.2039220333099365
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 32 cost time: 1.1235673427581787
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 33 cost time: 1.1224594116210938
Epoch: 33, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.641 Vali Acc: 0.781 Test Loss: 0.641 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 34 cost time: 1.137460708618164
Epoch: 34, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788883).  Saving model ...
Epoch: 35 cost time: 1.0759758949279785
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 36 cost time: 1.0759568214416504
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.625 Vali Acc: 0.793 Test Loss: 0.625 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 37 cost time: 1.1194241046905518
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.793 Test Loss: 0.621 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 38 cost time: 1.1886274814605713
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.793 Test Loss: 0.616 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 39 cost time: 1.1581008434295654
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.793 Test Loss: 0.612 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 40 cost time: 1.226294755935669
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 41 cost time: 1.1400423049926758
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 42 cost time: 1.1945481300354004
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 43 cost time: 1.1007764339447021
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.804 Test Loss: 0.595 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 44 cost time: 1.1487762928009033
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 45 cost time: 1.0181572437286377
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.807 Test Loss: 0.588 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 46 cost time: 1.0660128593444824
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 47 cost time: 1.0569753646850586
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 48 cost time: 1.0337750911712646
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 49 cost time: 1.0523169040679932
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 50 cost time: 1.0124144554138184
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 51 cost time: 1.0996646881103516
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 52 cost time: 1.0741474628448486
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 53 cost time: 1.1045219898223877
Epoch: 53, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 54 cost time: 1.0634102821350098
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.830 Test Loss: 0.560 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 55 cost time: 1.0927226543426514
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.830 Test Loss: 0.557 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 56 cost time: 1.2440643310546875
Epoch: 56, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 57 cost time: 1.1421892642974854
Epoch: 57, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 58 cost time: 1.1715655326843262
Epoch: 58, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 59 cost time: 1.06911039352417
Epoch: 59, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.830 Test Loss: 0.547 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0714552402496338
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.830 Test Loss: 0.544 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0872132778167725
Epoch: 61, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.830 Test Loss: 0.542 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0920753479003906
Epoch: 62, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.830 Test Loss: 0.540 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0569233894348145
Epoch: 63, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.830 Test Loss: 0.538 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0479834079742432
Epoch: 64, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.830 Test Loss: 0.536 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.0730738639831543
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.830 Test Loss: 0.534 Test Acc: 0.830
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9907164573669434
Epoch: 66, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.830 Test Loss: 0.532 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1821882724761963
Epoch: 67, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.830 Test Loss: 0.530 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.14786696434021
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.830 Test Loss: 0.528 Test Acc: 0.830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4891715049743652
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.848 Vali Acc: 0.207 Test Loss: 1.848 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 1.1169192790985107
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.825 Vali Acc: 0.233 Test Loss: 1.825 Test Acc: 0.233
Validation loss decreased (-0.207389 --> -0.233315).  Saving model ...
Epoch: 3 cost time: 1.0310218334197998
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.801 Vali Acc: 0.244 Test Loss: 1.801 Test Acc: 0.244
Validation loss decreased (-0.233315 --> -0.244426).  Saving model ...
Epoch: 4 cost time: 1.0178272724151611
Epoch: 4, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.767 Vali Acc: 0.274 Test Loss: 1.767 Test Acc: 0.274
Validation loss decreased (-0.244426 --> -0.274056).  Saving model ...
Epoch: 5 cost time: 1.0404243469238281
Epoch: 5, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.724 Vali Acc: 0.307 Test Loss: 1.724 Test Acc: 0.307
Validation loss decreased (-0.274056 --> -0.307390).  Saving model ...
Epoch: 6 cost time: 0.9806244373321533
Epoch: 6, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.675 Vali Acc: 0.374 Test Loss: 1.675 Test Acc: 0.374
Validation loss decreased (-0.307390 --> -0.374057).  Saving model ...
Epoch: 7 cost time: 0.9847486019134521
Epoch: 7, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.623 Vali Acc: 0.422 Test Loss: 1.623 Test Acc: 0.422
Validation loss decreased (-0.374057 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 1.0621106624603271
Epoch: 8, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.569 Vali Acc: 0.452 Test Loss: 1.569 Test Acc: 0.452
Validation loss decreased (-0.422206 --> -0.451836).  Saving model ...
Epoch: 9 cost time: 0.946904182434082
Epoch: 9, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.514 Vali Acc: 0.507 Test Loss: 1.514 Test Acc: 0.507
Validation loss decreased (-0.451836 --> -0.507392).  Saving model ...
Epoch: 10 cost time: 1.1439127922058105
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.459 Vali Acc: 0.552 Test Loss: 1.459 Test Acc: 0.552
Validation loss decreased (-0.507392 --> -0.551837).  Saving model ...
Epoch: 11 cost time: 1.0030477046966553
Epoch: 11, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.404 Vali Acc: 0.567 Test Loss: 1.404 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566653).  Saving model ...
Epoch: 12 cost time: 1.0672519207000732
Epoch: 12, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.349 Vali Acc: 0.589 Test Loss: 1.349 Test Acc: 0.589
Validation loss decreased (-0.566653 --> -0.588875).  Saving model ...
Epoch: 13 cost time: 1.1109511852264404
Epoch: 13, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.296 Vali Acc: 0.604 Test Loss: 1.296 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603691).  Saving model ...
Epoch: 14 cost time: 1.1648986339569092
Epoch: 14, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.245 Vali Acc: 0.615 Test Loss: 1.245 Test Acc: 0.615
Validation loss decreased (-0.603691 --> -0.614802).  Saving model ...
Epoch: 15 cost time: 0.9599251747131348
Epoch: 15, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.196 Vali Acc: 0.633 Test Loss: 1.196 Test Acc: 0.633
Validation loss decreased (-0.614802 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 1.136023998260498
Epoch: 16, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.153 Vali Acc: 0.644 Test Loss: 1.153 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 17 cost time: 1.1171295642852783
Epoch: 17, Steps: 2 | Train Loss: 0.559 Vali Loss: 1.110 Vali Acc: 0.659 Test Loss: 1.110 Test Acc: 0.659
Validation loss decreased (-0.644433 --> -0.659248).  Saving model ...
Epoch: 18 cost time: 1.1876819133758545
Epoch: 18, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.071 Vali Acc: 0.685 Test Loss: 1.071 Test Acc: 0.685
Validation loss decreased (-0.659248 --> -0.685174).  Saving model ...
Epoch: 19 cost time: 1.1755707263946533
Epoch: 19, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.036 Vali Acc: 0.681 Test Loss: 1.036 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.005126714706421
Epoch: 20, Steps: 2 | Train Loss: 0.318 Vali Loss: 1.002 Vali Acc: 0.689 Test Loss: 1.002 Test Acc: 0.689
Validation loss decreased (-0.685174 --> -0.688879).  Saving model ...
Epoch: 21 cost time: 1.1252310276031494
Epoch: 21, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.968 Vali Acc: 0.704 Test Loss: 0.968 Test Acc: 0.704
Validation loss decreased (-0.688879 --> -0.703694).  Saving model ...
Epoch: 22 cost time: 1.1205346584320068
Epoch: 22, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.938 Vali Acc: 0.719 Test Loss: 0.938 Test Acc: 0.719
Validation loss decreased (-0.703694 --> -0.718509).  Saving model ...
Epoch: 23 cost time: 0.9972670078277588
Epoch: 23, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.909 Vali Acc: 0.719 Test Loss: 0.909 Test Acc: 0.719
Validation loss decreased (-0.718509 --> -0.718509).  Saving model ...
Epoch: 24 cost time: 0.9559962749481201
Epoch: 24, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.883 Vali Acc: 0.719 Test Loss: 0.883 Test Acc: 0.719
Validation loss decreased (-0.718509 --> -0.718510).  Saving model ...
Epoch: 25 cost time: 1.0801455974578857
Epoch: 25, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.862 Vali Acc: 0.733 Test Loss: 0.862 Test Acc: 0.733
Validation loss decreased (-0.718510 --> -0.733325).  Saving model ...
Epoch: 26 cost time: 1.0204756259918213
Epoch: 26, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.842 Vali Acc: 0.737 Test Loss: 0.842 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 27 cost time: 1.1446633338928223
Epoch: 27, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.825 Vali Acc: 0.737 Test Loss: 0.825 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 28 cost time: 1.1596062183380127
Epoch: 28, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
Validation loss decreased (-0.737029 --> -0.744436).  Saving model ...
Epoch: 29 cost time: 1.0128791332244873
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.799 Vali Acc: 0.752 Test Loss: 0.799 Test Acc: 0.752
Validation loss decreased (-0.744436 --> -0.751844).  Saving model ...
Epoch: 30 cost time: 1.0674967765808105
Epoch: 30, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 31 cost time: 1.2335119247436523
Epoch: 31, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.778 Vali Acc: 0.759 Test Loss: 0.778 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759251).  Saving model ...
Epoch: 32 cost time: 1.115417718887329
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.769 Vali Acc: 0.770 Test Loss: 0.769 Test Acc: 0.770
Validation loss decreased (-0.759251 --> -0.770363).  Saving model ...
Epoch: 33 cost time: 1.1260857582092285
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.759 Vali Acc: 0.774 Test Loss: 0.759 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774066).  Saving model ...
Epoch: 34 cost time: 1.23927903175354
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.751 Vali Acc: 0.774 Test Loss: 0.751 Test Acc: 0.774
Validation loss decreased (-0.774066 --> -0.774067).  Saving model ...
Epoch: 35 cost time: 1.0071210861206055
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.742 Vali Acc: 0.774 Test Loss: 0.742 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 36 cost time: 1.0989782810211182
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.733 Vali Acc: 0.781 Test Loss: 0.733 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781474).  Saving model ...
Epoch: 37 cost time: 1.1681203842163086
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.724 Vali Acc: 0.785 Test Loss: 0.724 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 38 cost time: 1.0312728881835938
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.717 Vali Acc: 0.796 Test Loss: 0.717 Test Acc: 0.796
Validation loss decreased (-0.785178 --> -0.796289).  Saving model ...
Epoch: 39 cost time: 1.016922950744629
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.796 Test Loss: 0.710 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 40 cost time: 1.03248929977417
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 41 cost time: 1.2765276432037354
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.695 Vali Acc: 0.807 Test Loss: 0.695 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807400).  Saving model ...
Epoch: 42 cost time: 1.2766883373260498
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 43 cost time: 1.2496094703674316
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
Validation loss decreased (-0.811104 --> -0.818512).  Saving model ...
Epoch: 44 cost time: 1.1027307510375977
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 45 cost time: 1.1857714653015137
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.670 Vali Acc: 0.819 Test Loss: 0.670 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 46 cost time: 1.2569351196289062
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 47 cost time: 1.1116502285003662
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 48 cost time: 1.2838711738586426
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 49 cost time: 1.1924326419830322
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 50 cost time: 1.0584063529968262
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 51 cost time: 0.9183661937713623
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 52 cost time: 1.07814621925354
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 53 cost time: 1.0080106258392334
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 54 cost time: 0.9724130630493164
Epoch: 54, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 55 cost time: 1.1802680492401123
Epoch: 55, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 56 cost time: 1.0508086681365967
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 57 cost time: 1.1704535484313965
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 58 cost time: 1.2397286891937256
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 59 cost time: 1.1594221591949463
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 60 cost time: 1.0780880451202393
Epoch: 60, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 61 cost time: 1.240929126739502
Epoch: 61, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 62 cost time: 1.0385081768035889
Epoch: 62, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 63 cost time: 1.0927362442016602
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 64 cost time: 1.13260817527771
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 65 cost time: 1.072192907333374
Epoch: 65, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 66 cost time: 1.0043225288391113
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 67 cost time: 1.0697717666625977
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.826 Test Loss: 0.594 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 68 cost time: 1.1274011135101318
Epoch: 68, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 69 cost time: 1.0881974697113037
Epoch: 69, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 70 cost time: 1.0207266807556152
Epoch: 70, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 71 cost time: 1.109818458557129
Epoch: 71, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 72 cost time: 1.030956745147705
Epoch: 72, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.830 Test Loss: 0.583 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 73 cost time: 1.054248571395874
Epoch: 73, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.830 Test Loss: 0.581 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 74 cost time: 1.1083130836486816
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.830 Test Loss: 0.579 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 75 cost time: 1.1244182586669922
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.830 Test Loss: 0.577 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 76 cost time: 1.0535292625427246
Epoch: 76, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.830 Test Loss: 0.575 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 77 cost time: 1.048861026763916
Epoch: 77, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.830 Test Loss: 0.573 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 78 cost time: 1.1026513576507568
Epoch: 78, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.830 Test Loss: 0.570 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 79 cost time: 1.1136107444763184
Epoch: 79, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.830 Test Loss: 0.568 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 80 cost time: 1.153862476348877
Epoch: 80, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.830 Test Loss: 0.566 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 81 cost time: 1.0758061408996582
Epoch: 81, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.830 Test Loss: 0.565 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 82 cost time: 1.2179796695709229
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.830 Test Loss: 0.563 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 83 cost time: 0.9985909461975098
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.830 Test Loss: 0.561 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 84 cost time: 1.0758261680603027
Epoch: 84, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.830 Test Loss: 0.559 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 85 cost time: 0.9908590316772461
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 86 cost time: 1.0231094360351562
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.837 Test Loss: 0.557 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 87 cost time: 1.0631706714630127
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.837 Test Loss: 0.555 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 88 cost time: 1.1371760368347168
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.837 Test Loss: 0.554 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 89 cost time: 1.0683693885803223
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.837 Test Loss: 0.553 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837032).  Saving model ...
Epoch: 90 cost time: 1.0679855346679688
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.837 Test Loss: 0.552 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 91 cost time: 1.0718047618865967
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 92 cost time: 1.0674259662628174
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.837 Test Loss: 0.550 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.0563337802886963
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 94 cost time: 1.0773205757141113
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 95 cost time: 1.0416030883789062
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 96 cost time: 1.129868745803833
Epoch: 96, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 97 cost time: 1.122173547744751
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 98 cost time: 0.9308311939239502
Epoch: 98, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 99 cost time: 1.0304181575775146
Epoch: 99, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 100 cost time: 1.0565292835235596
Epoch: 100, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.715822458267212
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.824 Vali Acc: 0.189 Test Loss: 1.824 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.0243921279907227
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.807 Vali Acc: 0.233 Test Loss: 1.807 Test Acc: 0.233
Validation loss decreased (-0.188871 --> -0.233315).  Saving model ...
Epoch: 3 cost time: 1.134845495223999
Epoch: 3, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.791 Vali Acc: 0.281 Test Loss: 1.791 Test Acc: 0.281
Validation loss decreased (-0.233315 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 1.1882085800170898
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.768 Vali Acc: 0.296 Test Loss: 1.768 Test Acc: 0.296
Validation loss decreased (-0.281464 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 1.0653536319732666
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.738 Vali Acc: 0.341 Test Loss: 1.738 Test Acc: 0.341
Validation loss decreased (-0.296279 --> -0.340723).  Saving model ...
Epoch: 6 cost time: 1.014195203781128
Epoch: 6, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.706 Vali Acc: 0.356 Test Loss: 1.706 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 7 cost time: 1.0781452655792236
Epoch: 7, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.670 Vali Acc: 0.389 Test Loss: 1.670 Test Acc: 0.389
Validation loss decreased (-0.355538 --> -0.388872).  Saving model ...
Epoch: 8 cost time: 1.0171689987182617
Epoch: 8, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.633 Vali Acc: 0.419 Test Loss: 1.633 Test Acc: 0.419
Validation loss decreased (-0.388872 --> -0.418502).  Saving model ...
Epoch: 9 cost time: 0.9057393074035645
Epoch: 9, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.594 Vali Acc: 0.441 Test Loss: 1.594 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 10 cost time: 0.9889836311340332
Epoch: 10, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.556 Vali Acc: 0.456 Test Loss: 1.556 Test Acc: 0.456
Validation loss decreased (-0.440725 --> -0.455540).  Saving model ...
Epoch: 11 cost time: 1.0352768898010254
Epoch: 11, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.517 Vali Acc: 0.485 Test Loss: 1.517 Test Acc: 0.485
Validation loss decreased (-0.455540 --> -0.485170).  Saving model ...
Epoch: 12 cost time: 1.0050897598266602
Epoch: 12, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.477 Vali Acc: 0.507 Test Loss: 1.477 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507393).  Saving model ...
Epoch: 13 cost time: 1.0882518291473389
Epoch: 13, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.439 Vali Acc: 0.511 Test Loss: 1.439 Test Acc: 0.511
Validation loss decreased (-0.507393 --> -0.511097).  Saving model ...
Epoch: 14 cost time: 1.10740327835083
Epoch: 14, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.401 Vali Acc: 0.533 Test Loss: 1.401 Test Acc: 0.533
Validation loss decreased (-0.511097 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 1.0829169750213623
Epoch: 15, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.364 Vali Acc: 0.544 Test Loss: 1.364 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544431).  Saving model ...
Epoch: 16 cost time: 1.135005235671997
Epoch: 16, Steps: 2 | Train Loss: 0.791 Vali Loss: 1.328 Vali Acc: 0.548 Test Loss: 1.328 Test Acc: 0.548
Validation loss decreased (-0.544431 --> -0.548135).  Saving model ...
Epoch: 17 cost time: 1.0605802536010742
Epoch: 17, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.293 Vali Acc: 0.556 Test Loss: 1.293 Test Acc: 0.556
Validation loss decreased (-0.548135 --> -0.555543).  Saving model ...
Epoch: 18 cost time: 1.1275851726531982
Epoch: 18, Steps: 2 | Train Loss: 0.691 Vali Loss: 1.257 Vali Acc: 0.567 Test Loss: 1.257 Test Acc: 0.567
Validation loss decreased (-0.555543 --> -0.566654).  Saving model ...
Epoch: 19 cost time: 1.0969035625457764
Epoch: 19, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.226 Vali Acc: 0.567 Test Loss: 1.226 Test Acc: 0.567
Validation loss decreased (-0.566654 --> -0.566654).  Saving model ...
Epoch: 20 cost time: 0.9688663482666016
Epoch: 20, Steps: 2 | Train Loss: 0.533 Vali Loss: 1.194 Vali Acc: 0.574 Test Loss: 1.194 Test Acc: 0.574
Validation loss decreased (-0.566654 --> -0.574062).  Saving model ...
Epoch: 21 cost time: 1.145268201828003
Epoch: 21, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.160 Vali Acc: 0.585 Test Loss: 1.160 Test Acc: 0.585
Validation loss decreased (-0.574062 --> -0.585174).  Saving model ...
Epoch: 22 cost time: 1.0602221488952637
Epoch: 22, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.127 Vali Acc: 0.596 Test Loss: 1.127 Test Acc: 0.596
Validation loss decreased (-0.585174 --> -0.596285).  Saving model ...
Epoch: 23 cost time: 1.0499215126037598
Epoch: 23, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.094 Vali Acc: 0.607 Test Loss: 1.094 Test Acc: 0.607
Validation loss decreased (-0.596285 --> -0.607396).  Saving model ...
Epoch: 24 cost time: 1.0779991149902344
Epoch: 24, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.064 Vali Acc: 0.615 Test Loss: 1.064 Test Acc: 0.615
Validation loss decreased (-0.607396 --> -0.614804).  Saving model ...
Epoch: 25 cost time: 1.0486524105072021
Epoch: 25, Steps: 2 | Train Loss: 0.283 Vali Loss: 1.037 Vali Acc: 0.615 Test Loss: 1.037 Test Acc: 0.615
Validation loss decreased (-0.614804 --> -0.614804).  Saving model ...
Epoch: 26 cost time: 1.0531651973724365
Epoch: 26, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.010 Vali Acc: 0.619 Test Loss: 1.010 Test Acc: 0.619
Validation loss decreased (-0.614804 --> -0.618508).  Saving model ...
Epoch: 27 cost time: 1.193134069442749
Epoch: 27, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.985 Vali Acc: 0.644 Test Loss: 0.985 Test Acc: 0.644
Validation loss decreased (-0.618508 --> -0.644435).  Saving model ...
Epoch: 28 cost time: 1.204725980758667
Epoch: 28, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.964 Vali Acc: 0.656 Test Loss: 0.964 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655546).  Saving model ...
Epoch: 29 cost time: 1.1404929161071777
Epoch: 29, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.941 Vali Acc: 0.667 Test Loss: 0.941 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 1.0695393085479736
Epoch: 30, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.918 Vali Acc: 0.670 Test Loss: 0.918 Test Acc: 0.670
Validation loss decreased (-0.666657 --> -0.670361).  Saving model ...
Epoch: 31 cost time: 1.053528070449829
Epoch: 31, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.895 Vali Acc: 0.678 Test Loss: 0.895 Test Acc: 0.678
Validation loss decreased (-0.670361 --> -0.677769).  Saving model ...
Epoch: 32 cost time: 1.1134672164916992
Epoch: 32, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.873 Vali Acc: 0.685 Test Loss: 0.873 Test Acc: 0.685
Validation loss decreased (-0.677769 --> -0.685176).  Saving model ...
Epoch: 33 cost time: 0.984743595123291
Epoch: 33, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.849 Vali Acc: 0.696 Test Loss: 0.849 Test Acc: 0.696
Validation loss decreased (-0.685176 --> -0.696288).  Saving model ...
Epoch: 34 cost time: 1.0964186191558838
Epoch: 34, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.824 Vali Acc: 0.704 Test Loss: 0.824 Test Acc: 0.704
Validation loss decreased (-0.696288 --> -0.703695).  Saving model ...
Epoch: 35 cost time: 1.0804944038391113
Epoch: 35, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.801 Vali Acc: 0.707 Test Loss: 0.801 Test Acc: 0.707
Validation loss decreased (-0.703695 --> -0.707399).  Saving model ...
Epoch: 36 cost time: 1.0897531509399414
Epoch: 36, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.779 Vali Acc: 0.707 Test Loss: 0.779 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707400).  Saving model ...
Epoch: 37 cost time: 1.0577139854431152
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.759 Vali Acc: 0.722 Test Loss: 0.759 Test Acc: 0.722
Validation loss decreased (-0.707400 --> -0.722215).  Saving model ...
Epoch: 38 cost time: 1.2329998016357422
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.740 Vali Acc: 0.722 Test Loss: 0.740 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 39 cost time: 1.1154088973999023
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
Validation loss decreased (-0.722215 --> -0.729622).  Saving model ...
Epoch: 40 cost time: 1.1008248329162598
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.709 Vali Acc: 0.733 Test Loss: 0.709 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
Epoch: 41 cost time: 1.0965449810028076
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.695 Vali Acc: 0.748 Test Loss: 0.695 Test Acc: 0.748
Validation loss decreased (-0.733326 --> -0.748141).  Saving model ...
Epoch: 42 cost time: 1.245500087738037
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.752 Test Loss: 0.683 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 43 cost time: 1.1799750328063965
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 44 cost time: 1.133000373840332
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.663 Vali Acc: 0.759 Test Loss: 0.663 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759253).  Saving model ...
Epoch: 45 cost time: 1.1108641624450684
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.654 Vali Acc: 0.759 Test Loss: 0.654 Test Acc: 0.759
Validation loss decreased (-0.759253 --> -0.759253).  Saving model ...
Epoch: 46 cost time: 1.2121717929840088
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.759253 --> -0.762957).  Saving model ...
Epoch: 47 cost time: 1.0025107860565186
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.762957 --> -0.762957).  Saving model ...
Epoch: 48 cost time: 1.184161901473999
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
Validation loss decreased (-0.762957 --> -0.762957).  Saving model ...
Epoch: 49 cost time: 1.1626508235931396
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
Validation loss decreased (-0.762957 --> -0.762957).  Saving model ...
Epoch: 50 cost time: 1.017007827758789
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.762957 --> -0.762957).  Saving model ...
Epoch: 51 cost time: 1.1331350803375244
Epoch: 51, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.767 Test Loss: 0.615 Test Acc: 0.767
Validation loss decreased (-0.762957 --> -0.766661).  Saving model ...
Epoch: 52 cost time: 1.076425552368164
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
Validation loss decreased (-0.766661 --> -0.770364).  Saving model ...
Epoch: 53 cost time: 1.0147099494934082
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 54 cost time: 1.0115833282470703
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.774 Test Loss: 0.602 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 55 cost time: 1.244293212890625
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.781 Test Loss: 0.597 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781476).  Saving model ...
Epoch: 56 cost time: 0.9497044086456299
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.781 Test Loss: 0.592 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 57 cost time: 0.9820468425750732
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.793 Test Loss: 0.589 Test Acc: 0.793
Validation loss decreased (-0.781476 --> -0.792587).  Saving model ...
Epoch: 58 cost time: 0.9886481761932373
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796290).  Saving model ...
Epoch: 59 cost time: 1.0103089809417725
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 60 cost time: 1.0567207336425781
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.804 Test Loss: 0.579 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803698).  Saving model ...
Epoch: 61 cost time: 0.9653303623199463
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.804 Test Loss: 0.576 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 62 cost time: 1.0987756252288818
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 63 cost time: 0.9892826080322266
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 64 cost time: 1.00834321975708
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 65 cost time: 1.261240005493164
Epoch: 65, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.804 Test Loss: 0.566 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 66 cost time: 1.1666498184204102
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.807 Test Loss: 0.563 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 67 cost time: 1.16471266746521
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.807402 --> -0.818513).  Saving model ...
Epoch: 68 cost time: 1.1476714611053467
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 69 cost time: 1.0867195129394531
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0003395080566406
Epoch: 70, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 71 cost time: 1.0250847339630127
Epoch: 71, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 72 cost time: 0.9829447269439697
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 73 cost time: 1.0434303283691406
Epoch: 73, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 74 cost time: 1.0754094123840332
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 75 cost time: 0.9064562320709229
Epoch: 75, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825921).  Saving model ...
Epoch: 76 cost time: 1.0341427326202393
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 77 cost time: 1.086716890335083
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.830 Test Loss: 0.534 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 78 cost time: 1.0417444705963135
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.830 Test Loss: 0.531 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 79 cost time: 1.0760993957519531
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.830 Test Loss: 0.528 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 80 cost time: 1.0760674476623535
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.837 Test Loss: 0.525 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837032).  Saving model ...
Epoch: 81 cost time: 1.1778428554534912
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 82 cost time: 1.1152012348175049
Epoch: 82, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 83 cost time: 1.0499813556671143
Epoch: 83, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 84 cost time: 0.9593899250030518
Epoch: 84, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 85 cost time: 1.0924708843231201
Epoch: 85, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 86 cost time: 1.0464794635772705
Epoch: 86, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 87 cost time: 1.3330578804016113
Epoch: 87, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 88 cost time: 1.0607352256774902
Epoch: 88, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 89 cost time: 1.1909019947052002
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 90 cost time: 1.06954026222229
Epoch: 90, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 91 cost time: 1.0475537776947021
Epoch: 91, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 92 cost time: 1.2285435199737549
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 93 cost time: 1.070993185043335
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 94 cost time: 1.235440731048584
Epoch: 94, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 95 cost time: 1.1034767627716064
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 96 cost time: 1.2160866260528564
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 97 cost time: 1.1209633350372314
Epoch: 97, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 98 cost time: 1.1632781028747559
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 99 cost time: 0.9809737205505371
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 100 cost time: 1.099628210067749
Epoch: 100, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.465541362762451
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.842 Vali Acc: 0.226 Test Loss: 1.842 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.9078989028930664
Epoch: 2, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.833 Vali Acc: 0.230 Test Loss: 1.833 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 1.12062668800354
Epoch: 3, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.821 Vali Acc: 0.233 Test Loss: 1.821 Test Acc: 0.233
Validation loss decreased (-0.229611 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 1.1207518577575684
Epoch: 4, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.802 Vali Acc: 0.241 Test Loss: 1.802 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.0637249946594238
Epoch: 5, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.779 Vali Acc: 0.256 Test Loss: 1.779 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 1.12648606300354
Epoch: 6, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.750 Vali Acc: 0.267 Test Loss: 1.750 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 1.1465234756469727
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.719 Vali Acc: 0.293 Test Loss: 1.719 Test Acc: 0.293
Validation loss decreased (-0.266649 --> -0.292575).  Saving model ...
Epoch: 8 cost time: 1.006864309310913
Epoch: 8, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.686 Vali Acc: 0.311 Test Loss: 1.686 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 1.1623144149780273
Epoch: 9, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.652 Vali Acc: 0.333 Test Loss: 1.652 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333317).  Saving model ...
Epoch: 10 cost time: 1.056147813796997
Epoch: 10, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.616 Vali Acc: 0.367 Test Loss: 1.616 Test Acc: 0.367
Validation loss decreased (-0.333317 --> -0.366651).  Saving model ...
Epoch: 11 cost time: 0.9689173698425293
Epoch: 11, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.576 Vali Acc: 0.419 Test Loss: 1.576 Test Acc: 0.419
Validation loss decreased (-0.366651 --> -0.418503).  Saving model ...
Epoch: 12 cost time: 1.2510182857513428
Epoch: 12, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.535 Vali Acc: 0.456 Test Loss: 1.535 Test Acc: 0.456
Validation loss decreased (-0.418503 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 1.128910779953003
Epoch: 13, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.492 Vali Acc: 0.478 Test Loss: 1.492 Test Acc: 0.478
Validation loss decreased (-0.455540 --> -0.477763).  Saving model ...
Epoch: 14 cost time: 1.0258619785308838
Epoch: 14, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.448 Vali Acc: 0.496 Test Loss: 1.448 Test Acc: 0.496
Validation loss decreased (-0.477763 --> -0.496282).  Saving model ...
Epoch: 15 cost time: 1.0768797397613525
Epoch: 15, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
Validation loss decreased (-0.496282 --> -0.518504).  Saving model ...
Epoch: 16 cost time: 1.0625073909759521
Epoch: 16, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.357 Vali Acc: 0.552 Test Loss: 1.357 Test Acc: 0.552
Validation loss decreased (-0.518504 --> -0.551838).  Saving model ...
Epoch: 17 cost time: 1.1185011863708496
Epoch: 17, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.308 Vali Acc: 0.570 Test Loss: 1.308 Test Acc: 0.570
Validation loss decreased (-0.551838 --> -0.570357).  Saving model ...
Epoch: 18 cost time: 1.2730462551116943
Epoch: 18, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.257 Vali Acc: 0.600 Test Loss: 1.257 Test Acc: 0.600
Validation loss decreased (-0.570357 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 1.1875004768371582
Epoch: 19, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.208 Vali Acc: 0.626 Test Loss: 1.208 Test Acc: 0.626
Validation loss decreased (-0.599987 --> -0.625914).  Saving model ...
Epoch: 20 cost time: 1.1161823272705078
Epoch: 20, Steps: 2 | Train Loss: 0.745 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
Validation loss decreased (-0.625914 --> -0.655544).  Saving model ...
Epoch: 21 cost time: 1.1388776302337646
Epoch: 21, Steps: 2 | Train Loss: 0.708 Vali Loss: 1.101 Vali Acc: 0.693 Test Loss: 1.101 Test Acc: 0.693
Validation loss decreased (-0.655544 --> -0.692582).  Saving model ...
Epoch: 22 cost time: 1.248197317123413
Epoch: 22, Steps: 2 | Train Loss: 0.623 Vali Loss: 1.046 Vali Acc: 0.696 Test Loss: 1.046 Test Acc: 0.696
Validation loss decreased (-0.692582 --> -0.696286).  Saving model ...
Epoch: 23 cost time: 1.1545486450195312
Epoch: 23, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.991 Vali Acc: 0.719 Test Loss: 0.991 Test Acc: 0.719
Validation loss decreased (-0.696286 --> -0.718509).  Saving model ...
Epoch: 24 cost time: 1.1072328090667725
Epoch: 24, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.935 Vali Acc: 0.722 Test Loss: 0.935 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 25 cost time: 1.0442984104156494
Epoch: 25, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.883 Vali Acc: 0.737 Test Loss: 0.883 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737028).  Saving model ...
Epoch: 26 cost time: 1.0562222003936768
Epoch: 26, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.830 Vali Acc: 0.737 Test Loss: 0.830 Test Acc: 0.737
Validation loss decreased (-0.737028 --> -0.737029).  Saving model ...
Epoch: 27 cost time: 1.200535535812378
Epoch: 27, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
Validation loss decreased (-0.737029 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 0.9711759090423584
Epoch: 28, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.741 Vali Acc: 0.748 Test Loss: 0.741 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1198806762695312
Epoch: 29, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.702 Vali Acc: 0.759 Test Loss: 0.702 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 30 cost time: 1.0606956481933594
Epoch: 30, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.667 Vali Acc: 0.752 Test Loss: 0.667 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.090752124786377
Epoch: 31, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.635 Vali Acc: 0.759 Test Loss: 0.635 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759253).  Saving model ...
Epoch: 32 cost time: 1.1090679168701172
Epoch: 32, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
Validation loss decreased (-0.759253 --> -0.766661).  Saving model ...
Epoch: 33 cost time: 1.1516449451446533
Epoch: 33, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.584 Vali Acc: 0.778 Test Loss: 0.584 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 34 cost time: 1.087928295135498
Epoch: 34, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.553 Vali Acc: 0.793 Test Loss: 0.553 Test Acc: 0.793
Validation loss decreased (-0.777772 --> -0.792587).  Saving model ...
Epoch: 35 cost time: 1.1626577377319336
Epoch: 35, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
Validation loss decreased (-0.792587 --> -0.814810).  Saving model ...
Epoch: 36 cost time: 1.1804242134094238
Epoch: 36, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
Validation loss decreased (-0.814810 --> -0.822217).  Saving model ...
Epoch: 37 cost time: 1.0141239166259766
Epoch: 37, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.830 Test Loss: 0.480 Test Acc: 0.830
Validation loss decreased (-0.822217 --> -0.829625).  Saving model ...
Epoch: 38 cost time: 1.0834887027740479
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.463 Vali Acc: 0.830 Test Loss: 0.463 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 39 cost time: 0.9517951011657715
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.451 Vali Acc: 0.837 Test Loss: 0.451 Test Acc: 0.837
Validation loss decreased (-0.829625 --> -0.837033).  Saving model ...
Epoch: 40 cost time: 1.049363613128662
Epoch: 40, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.837033 --> -0.840736).  Saving model ...
Epoch: 41 cost time: 1.1145155429840088
Epoch: 41, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
Validation loss decreased (-0.840736 --> -0.848144).  Saving model ...
Epoch: 42 cost time: 1.0599076747894287
Epoch: 42, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 43 cost time: 1.0409650802612305
Epoch: 43, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9609265327453613
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3470590114593506
Epoch: 45, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.415 Vali Acc: 0.837 Test Loss: 0.415 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0944368839263916
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.410 Vali Acc: 0.837 Test Loss: 0.410 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0909709930419922
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1299426555633545
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.403 Vali Acc: 0.844 Test Loss: 0.403 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1505084037780762
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1321167945861816
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2513651847839355
Epoch: 51, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9712536334991455
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 53 cost time: 0.9476091861724854
Epoch: 53, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 54 cost time: 0.9097058773040771
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.389 Vali Acc: 0.859 Test Loss: 0.389 Test Acc: 0.859
Validation loss decreased (-0.848144 --> -0.859255).  Saving model ...
Epoch: 55 cost time: 0.9105427265167236
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866663).  Saving model ...
Epoch: 56 cost time: 1.0456135272979736
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
Validation loss decreased (-0.866663 --> -0.870367).  Saving model ...
Epoch: 57 cost time: 0.9966175556182861
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.870367 --> -0.870367).  Saving model ...
Epoch: 58 cost time: 1.0723896026611328
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.373 Vali Acc: 0.874 Test Loss: 0.373 Test Acc: 0.874
Validation loss decreased (-0.870367 --> -0.874070).  Saving model ...
Epoch: 59 cost time: 1.061990737915039
Epoch: 59, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.367 Vali Acc: 0.874 Test Loss: 0.367 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 60 cost time: 1.0483310222625732
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.874 Test Loss: 0.363 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 61 cost time: 1.0453157424926758
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.360 Vali Acc: 0.874 Test Loss: 0.360 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 62 cost time: 1.0277996063232422
Epoch: 62, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 63 cost time: 0.9610302448272705
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 64 cost time: 1.0476725101470947
Epoch: 64, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 65 cost time: 1.094984531402588
Epoch: 65, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0133850574493408
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 67 cost time: 1.0031492710113525
Epoch: 67, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9353187084197998
Epoch: 68, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0038869380950928
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 70 cost time: 1.0500457286834717
Epoch: 70, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9382495880126953
Epoch: 71, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9354209899902344
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9806880950927734
Epoch: 73, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.874 Test Loss: 0.356 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.0509681701660156
Epoch: 74, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.874 Test Loss: 0.356 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.1249659061431885
Epoch: 75, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.874 Test Loss: 0.355 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.1001043319702148
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.874 Test Loss: 0.353 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.0407745838165283
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.874 Test Loss: 0.352 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.098656415939331
Epoch: 78, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.349 Vali Acc: 0.874 Test Loss: 0.349 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.0962984561920166
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.874 Test Loss: 0.347 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.292498826980591
Epoch: 1, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.853 Vali Acc: 0.137 Test Loss: 1.853 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 1.0083746910095215
Epoch: 2, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.846 Vali Acc: 0.137 Test Loss: 1.846 Test Acc: 0.137
Validation loss decreased (-0.137019 --> -0.137019).  Saving model ...
Epoch: 3 cost time: 1.0320374965667725
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.832 Vali Acc: 0.144 Test Loss: 1.832 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.0077345371246338
Epoch: 4, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.804 Vali Acc: 0.185 Test Loss: 1.804 Test Acc: 0.185
Validation loss decreased (-0.144426 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 1.0220928192138672
Epoch: 5, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.768 Vali Acc: 0.226 Test Loss: 1.768 Test Acc: 0.226
Validation loss decreased (-0.185167 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 1.1198420524597168
Epoch: 6, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.725 Vali Acc: 0.281 Test Loss: 1.725 Test Acc: 0.281
Validation loss decreased (-0.225908 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 1.0658602714538574
Epoch: 7, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.677 Vali Acc: 0.315 Test Loss: 1.677 Test Acc: 0.315
Validation loss decreased (-0.281464 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 1.0906753540039062
Epoch: 8, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.624 Vali Acc: 0.330 Test Loss: 1.624 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 9 cost time: 1.0914785861968994
Epoch: 9, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.566 Vali Acc: 0.363 Test Loss: 1.566 Test Acc: 0.363
Validation loss decreased (-0.329613 --> -0.362947).  Saving model ...
Epoch: 10 cost time: 1.0148396492004395
Epoch: 10, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.505 Vali Acc: 0.411 Test Loss: 1.505 Test Acc: 0.411
Validation loss decreased (-0.362947 --> -0.411096).  Saving model ...
Epoch: 11 cost time: 0.9822883605957031
Epoch: 11, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.442 Vali Acc: 0.467 Test Loss: 1.442 Test Acc: 0.467
Validation loss decreased (-0.411096 --> -0.466652).  Saving model ...
Epoch: 12 cost time: 1.1042234897613525
Epoch: 12, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.376 Vali Acc: 0.552 Test Loss: 1.376 Test Acc: 0.552
Validation loss decreased (-0.466652 --> -0.551838).  Saving model ...
Epoch: 13 cost time: 1.1489191055297852
Epoch: 13, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.309 Vali Acc: 0.596 Test Loss: 1.309 Test Acc: 0.596
Validation loss decreased (-0.551838 --> -0.596283).  Saving model ...
Epoch: 14 cost time: 1.066051959991455
Epoch: 14, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.242 Vali Acc: 0.615 Test Loss: 1.242 Test Acc: 0.615
Validation loss decreased (-0.596283 --> -0.614802).  Saving model ...
Epoch: 15 cost time: 1.0415089130401611
Epoch: 15, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.175 Vali Acc: 0.652 Test Loss: 1.175 Test Acc: 0.652
Validation loss decreased (-0.614802 --> -0.651840).  Saving model ...
Epoch: 16 cost time: 1.1557040214538574
Epoch: 16, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.109 Vali Acc: 0.693 Test Loss: 1.109 Test Acc: 0.693
Validation loss decreased (-0.651840 --> -0.692582).  Saving model ...
Epoch: 17 cost time: 1.031099796295166
Epoch: 17, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.042 Vali Acc: 0.715 Test Loss: 1.042 Test Acc: 0.715
Validation loss decreased (-0.692582 --> -0.714804).  Saving model ...
Epoch: 18 cost time: 1.0656476020812988
Epoch: 18, Steps: 2 | Train Loss: 1.165 Vali Loss: 0.976 Vali Acc: 0.737 Test Loss: 0.976 Test Acc: 0.737
Validation loss decreased (-0.714804 --> -0.737027).  Saving model ...
Epoch: 19 cost time: 0.9583611488342285
Epoch: 19, Steps: 2 | Train Loss: 1.073 Vali Loss: 0.912 Vali Acc: 0.785 Test Loss: 0.912 Test Acc: 0.785
Validation loss decreased (-0.737027 --> -0.785176).  Saving model ...
Epoch: 20 cost time: 0.9959907531738281
Epoch: 20, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.849 Vali Acc: 0.815 Test Loss: 0.849 Test Acc: 0.815
Validation loss decreased (-0.785176 --> -0.814806).  Saving model ...
Epoch: 21 cost time: 1.1315460205078125
Epoch: 21, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.788 Vali Acc: 0.833 Test Loss: 0.788 Test Acc: 0.833
Validation loss decreased (-0.814806 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 1.0518486499786377
Epoch: 22, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.730 Vali Acc: 0.852 Test Loss: 0.730 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851845).  Saving model ...
Epoch: 23 cost time: 1.0551464557647705
Epoch: 23, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.675 Vali Acc: 0.863 Test Loss: 0.675 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862956).  Saving model ...
Epoch: 24 cost time: 1.2635478973388672
Epoch: 24, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.622 Vali Acc: 0.881 Test Loss: 0.622 Test Acc: 0.881
Validation loss decreased (-0.862956 --> -0.881475).  Saving model ...
Epoch: 25 cost time: 1.003253698348999
Epoch: 25, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.576 Vali Acc: 0.885 Test Loss: 0.576 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 26 cost time: 1.1336917877197266
Epoch: 26, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 0.927487850189209
Epoch: 27, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.052760124206543
Epoch: 28, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.0143132209777832
Epoch: 29, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.9268908500671387
Epoch: 30, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.399 Vali Acc: 0.896 Test Loss: 0.399 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9048717021942139
Epoch: 31, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.374 Vali Acc: 0.896 Test Loss: 0.374 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.963510274887085
Epoch: 32, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.355 Vali Acc: 0.896 Test Loss: 0.355 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0293292999267578
Epoch: 33, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.339 Vali Acc: 0.893 Test Loss: 0.339 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9811105728149414
Epoch: 34, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.319 Vali Acc: 0.896 Test Loss: 0.319 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0735547542572021
Epoch: 35, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 1.0639972686767578
Epoch: 36, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.281 Vali Acc: 0.907 Test Loss: 0.281 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907405).  Saving model ...
Epoch: 37 cost time: 1.004631519317627
Epoch: 37, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.907405 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 1.0864739418029785
Epoch: 38, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 1.0956385135650635
Epoch: 39, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.0461399555206299
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 1.1398530006408691
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0498480796813965
Epoch: 42, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 1.1284916400909424
Epoch: 43, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 44 cost time: 1.1689422130584717
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 1.059993028640747
Epoch: 45, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9915997982025146
Epoch: 46, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1200437545776367
Epoch: 47, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.057563304901123
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2288894653320312
Epoch: 49, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.252086877822876
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2557244300842285
Epoch: 51, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.140401840209961
Epoch: 52, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1115407943725586
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.1934113502502441
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.383183240890503
Epoch: 1, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.833 Vali Acc: 0.148 Test Loss: 1.833 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.9916353225708008
Epoch: 2, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.828 Vali Acc: 0.156 Test Loss: 1.828 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.932955265045166
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.813 Vali Acc: 0.170 Test Loss: 1.813 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 0.9198658466339111
Epoch: 4, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.778 Vali Acc: 0.226 Test Loss: 1.778 Test Acc: 0.226
Validation loss decreased (-0.170352 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 1.0310664176940918
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.733 Vali Acc: 0.267 Test Loss: 1.733 Test Acc: 0.267
Validation loss decreased (-0.225908 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 0.8858091831207275
Epoch: 6, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.680 Vali Acc: 0.307 Test Loss: 1.680 Test Acc: 0.307
Validation loss decreased (-0.266649 --> -0.307391).  Saving model ...
Epoch: 7 cost time: 1.025524616241455
Epoch: 7, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.621 Vali Acc: 0.359 Test Loss: 1.621 Test Acc: 0.359
Validation loss decreased (-0.307391 --> -0.359243).  Saving model ...
Epoch: 8 cost time: 1.0468127727508545
Epoch: 8, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.556 Vali Acc: 0.411 Test Loss: 1.556 Test Acc: 0.411
Validation loss decreased (-0.359243 --> -0.411096).  Saving model ...
Epoch: 9 cost time: 1.0514585971832275
Epoch: 9, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.487 Vali Acc: 0.474 Test Loss: 1.487 Test Acc: 0.474
Validation loss decreased (-0.411096 --> -0.474059).  Saving model ...
Epoch: 10 cost time: 0.9258313179016113
Epoch: 10, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.415 Vali Acc: 0.522 Test Loss: 1.415 Test Acc: 0.522
Validation loss decreased (-0.474059 --> -0.522208).  Saving model ...
Epoch: 11 cost time: 1.1199231147766113
Epoch: 11, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.341 Vali Acc: 0.570 Test Loss: 1.341 Test Acc: 0.570
Validation loss decreased (-0.522208 --> -0.570357).  Saving model ...
Epoch: 12 cost time: 1.1567659378051758
Epoch: 12, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.267 Vali Acc: 0.607 Test Loss: 1.267 Test Acc: 0.607
Validation loss decreased (-0.570357 --> -0.607395).  Saving model ...
Epoch: 13 cost time: 1.0556919574737549
Epoch: 13, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.194 Vali Acc: 0.659 Test Loss: 1.194 Test Acc: 0.659
Validation loss decreased (-0.607395 --> -0.659247).  Saving model ...
Epoch: 14 cost time: 0.9973118305206299
Epoch: 14, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.123 Vali Acc: 0.704 Test Loss: 1.123 Test Acc: 0.704
Validation loss decreased (-0.659247 --> -0.703692).  Saving model ...
Epoch: 15 cost time: 0.963026762008667
Epoch: 15, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.051 Vali Acc: 0.763 Test Loss: 1.051 Test Acc: 0.763
Validation loss decreased (-0.703692 --> -0.762952).  Saving model ...
Epoch: 16 cost time: 0.9754102230072021
Epoch: 16, Steps: 2 | Train Loss: 1.316 Vali Loss: 0.982 Vali Acc: 0.785 Test Loss: 0.982 Test Acc: 0.785
Validation loss decreased (-0.762952 --> -0.785175).  Saving model ...
Epoch: 17 cost time: 1.020132303237915
Epoch: 17, Steps: 2 | Train Loss: 1.291 Vali Loss: 0.915 Vali Acc: 0.811 Test Loss: 0.915 Test Acc: 0.811
Validation loss decreased (-0.785175 --> -0.811102).  Saving model ...
Epoch: 18 cost time: 0.9622900485992432
Epoch: 18, Steps: 2 | Train Loss: 1.240 Vali Loss: 0.851 Vali Acc: 0.844 Test Loss: 0.851 Test Acc: 0.844
Validation loss decreased (-0.811102 --> -0.844436).  Saving model ...
Epoch: 19 cost time: 1.0535013675689697
Epoch: 19, Steps: 2 | Train Loss: 1.088 Vali Loss: 0.790 Vali Acc: 0.859 Test Loss: 0.790 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859251).  Saving model ...
Epoch: 20 cost time: 1.0696511268615723
Epoch: 20, Steps: 2 | Train Loss: 1.142 Vali Loss: 0.733 Vali Acc: 0.870 Test Loss: 0.733 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 0.920520544052124
Epoch: 21, Steps: 2 | Train Loss: 1.038 Vali Loss: 0.680 Vali Acc: 0.885 Test Loss: 0.680 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 22 cost time: 1.137331247329712
Epoch: 22, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 1.176079511642456
Epoch: 23, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.587 Vali Acc: 0.904 Test Loss: 0.587 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 24 cost time: 1.0390264987945557
Epoch: 24, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.548 Vali Acc: 0.896 Test Loss: 0.548 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0347893238067627
Epoch: 25, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.514 Vali Acc: 0.904 Test Loss: 0.514 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 1.2154779434204102
Epoch: 26, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1198532581329346
Epoch: 27, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1338346004486084
Epoch: 28, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1148099899291992
Epoch: 29, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.403 Vali Acc: 0.885 Test Loss: 0.403 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0170505046844482
Epoch: 30, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9851832389831543
Epoch: 31, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.9872827529907227
Epoch: 32, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.9607701301574707
Epoch: 33, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 1.045423984527588
Epoch: 34, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.00081205368042
Epoch: 35, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.9197113513946533
Epoch: 36, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.09306001663208
Epoch: 37, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 1.0299437046051025
Epoch: 38, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 39 cost time: 0.9836592674255371
Epoch: 39, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 40 cost time: 1.0199346542358398
Epoch: 40, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 41 cost time: 0.972116231918335
Epoch: 41, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 42 cost time: 1.0976483821868896
Epoch: 42, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 1.0222315788269043
Epoch: 43, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 1.1686217784881592
Epoch: 44, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.9785060882568359
Epoch: 45, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0636944770812988
Epoch: 46, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9556009769439697
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9017987251281738
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.007819414138794
Epoch: 49, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0738136768341064
Epoch: 50, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0634186267852783
Epoch: 51, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1165575981140137
Epoch: 52, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1427173614501953
Epoch: 53, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0753953456878662
Epoch: 54, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4457032680511475
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0885934829711914
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0688822269439697
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.0866203308105469
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.971996545791626
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.944918155670166
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9290316104888916
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0498120784759521
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0666427612304688
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2674617767333984
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0875239372253418
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.0615592002868652
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.1409053802490234
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.0743868350982666
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9306497573852539
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.0196382999420166
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.1532063484191895
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.07600736618042
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1796541213989258
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9793660640716553
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 0.931786298751831
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 0.9998903274536133
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.0919907093048096
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.0931413173675537
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1012961864471436
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.0661413669586182
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.0812063217163086
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.017961025238037
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 0.9623041152954102
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.0068678855895996
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.05145263671875
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.0310423374176025
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.0875282287597656
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.0064446926116943
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.091860055923462
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 0.9471783638000488
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.0414164066314697
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9760394096374512
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.1219456195831299
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.0200247764587402
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.0706520080566406
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.0876708030700684
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.976987361907959
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.111419439315796
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0519771575927734
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.0374360084533691
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.1240146160125732
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 0.9885356426239014
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 0.88912034034729
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 0.9007563591003418
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 0.9968624114990234
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 0.9198746681213379
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.0344157218933105
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.1764469146728516
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.3364853858947754
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.179184913635254
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1055488586425781
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.0983717441558838
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.052368402481079
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.1295831203460693
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.1498854160308838
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.0695319175720215
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.086383581161499
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.0531935691833496
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.0523066520690918
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 0.9638891220092773
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1500277519226074
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.0163002014160156
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.0702173709869385
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.3047726154327393
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.055798053741455
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.1849949359893799
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.0817217826843262
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.123396635055542
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.0575401782989502
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.1983070373535156
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9289424419403076
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8664095401763916
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.0409204959869385
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.9229400157928467
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.949364185333252
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.0320079326629639
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1087539196014404
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.082474946975708
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.15840482711792
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.1551434993743896
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.1602540016174316
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.1089892387390137
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 1.1441974639892578
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.1253056526184082
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9953474998474121
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.046950101852417
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.0149729251861572
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.0149712562561035
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.0240464210510254
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.003976821899414
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.2411143779754639
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.1806640625
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.1302945613861084
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.1250028610229492
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 680326
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4488472938537598
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.822 Vali Acc: 0.122 Test Loss: 1.822 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 1.0498921871185303
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.796 Vali Acc: 0.148 Test Loss: 1.796 Test Acc: 0.148
Validation loss decreased (-0.122204 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.0116283893585205
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.768 Vali Acc: 0.170 Test Loss: 1.768 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 4 cost time: 1.0607690811157227
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.725 Vali Acc: 0.219 Test Loss: 1.725 Test Acc: 0.219
Validation loss decreased (-0.170353 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 1.058354377746582
Epoch: 5, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.672 Vali Acc: 0.311 Test Loss: 1.672 Test Acc: 0.311
Validation loss decreased (-0.218501 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 1.0320868492126465
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.611 Vali Acc: 0.419 Test Loss: 1.611 Test Acc: 0.419
Validation loss decreased (-0.311094 --> -0.418502).  Saving model ...
Epoch: 7 cost time: 0.9880573749542236
Epoch: 7, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.544 Vali Acc: 0.522 Test Loss: 1.544 Test Acc: 0.522
Validation loss decreased (-0.418502 --> -0.522207).  Saving model ...
Epoch: 8 cost time: 1.0254096984863281
Epoch: 8, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.473 Vali Acc: 0.578 Test Loss: 1.473 Test Acc: 0.578
Validation loss decreased (-0.522207 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 1.0509252548217773
Epoch: 9, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.400 Vali Acc: 0.622 Test Loss: 1.400 Test Acc: 0.622
Validation loss decreased (-0.577763 --> -0.622208).  Saving model ...
Epoch: 10 cost time: 1.0233454704284668
Epoch: 10, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.329 Vali Acc: 0.648 Test Loss: 1.329 Test Acc: 0.648
Validation loss decreased (-0.622208 --> -0.648135).  Saving model ...
Epoch: 11 cost time: 1.0575199127197266
Epoch: 11, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.259 Vali Acc: 0.689 Test Loss: 1.259 Test Acc: 0.689
Validation loss decreased (-0.648135 --> -0.688876).  Saving model ...
Epoch: 12 cost time: 0.939661979675293
Epoch: 12, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.192 Vali Acc: 0.707 Test Loss: 1.192 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 13 cost time: 0.9207077026367188
Epoch: 13, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.128 Vali Acc: 0.715 Test Loss: 1.128 Test Acc: 0.715
Validation loss decreased (-0.707395 --> -0.714804).  Saving model ...
Epoch: 14 cost time: 0.9386563301086426
Epoch: 14, Steps: 2 | Train Loss: 0.815 Vali Loss: 1.069 Vali Acc: 0.719 Test Loss: 1.069 Test Acc: 0.719
Validation loss decreased (-0.714804 --> -0.718508).  Saving model ...
Epoch: 15 cost time: 1.062892198562622
Epoch: 15, Steps: 2 | Train Loss: 0.728 Vali Loss: 1.015 Vali Acc: 0.726 Test Loss: 1.015 Test Acc: 0.726
Validation loss decreased (-0.718508 --> -0.725916).  Saving model ...
Epoch: 16 cost time: 1.0576608180999756
Epoch: 16, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 1.0654194355010986
Epoch: 17, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.919 Vali Acc: 0.748 Test Loss: 0.919 Test Acc: 0.748
Validation loss decreased (-0.733324 --> -0.748139).  Saving model ...
Epoch: 18 cost time: 1.1546506881713867
Epoch: 18, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.877 Vali Acc: 0.763 Test Loss: 0.877 Test Acc: 0.763
Validation loss decreased (-0.748139 --> -0.762954).  Saving model ...
Epoch: 19 cost time: 1.1007442474365234
Epoch: 19, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.839 Vali Acc: 0.759 Test Loss: 0.839 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1229150295257568
Epoch: 20, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
Validation loss decreased (-0.762954 --> -0.766659).  Saving model ...
Epoch: 21 cost time: 1.0506157875061035
Epoch: 21, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.773 Vali Acc: 0.767 Test Loss: 0.773 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 1.0925548076629639
Epoch: 22, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 23 cost time: 1.0238051414489746
Epoch: 23, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.724 Vali Acc: 0.770 Test Loss: 0.724 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 24 cost time: 1.103924036026001
Epoch: 24, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.707 Vali Acc: 0.785 Test Loss: 0.707 Test Acc: 0.785
Validation loss decreased (-0.770363 --> -0.785178).  Saving model ...
Epoch: 25 cost time: 1.0977425575256348
Epoch: 25, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.691 Vali Acc: 0.785 Test Loss: 0.691 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 26 cost time: 0.9613175392150879
Epoch: 26, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 0.9983763694763184
Epoch: 27, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 28 cost time: 1.0670065879821777
Epoch: 28, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
Validation loss decreased (-0.788882 --> -0.796290).  Saving model ...
Epoch: 29 cost time: 0.8778069019317627
Epoch: 29, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.9980800151824951
Epoch: 30, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 31 cost time: 0.979466438293457
Epoch: 31, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 32 cost time: 1.1046571731567383
Epoch: 32, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.633 Vali Acc: 0.804 Test Loss: 0.633 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 33 cost time: 1.1361629962921143
Epoch: 33, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 34 cost time: 1.0287590026855469
Epoch: 34, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 35 cost time: 1.1174602508544922
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 36 cost time: 1.0629074573516846
Epoch: 36, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 37 cost time: 1.0925452709197998
Epoch: 37, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 38 cost time: 1.1144068241119385
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 39 cost time: 1.0501158237457275
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 40 cost time: 1.023179054260254
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 41 cost time: 1.0240254402160645
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.596 Vali Acc: 0.804 Test Loss: 0.596 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 42 cost time: 0.925438642501831
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 43 cost time: 0.9868965148925781
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 44 cost time: 0.9078655242919922
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 45 cost time: 0.9775867462158203
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 46 cost time: 0.9545896053314209
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.588 Vali Acc: 0.807 Test Loss: 0.588 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 47 cost time: 1.0796723365783691
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.587 Vali Acc: 0.807 Test Loss: 0.587 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 48 cost time: 1.1298305988311768
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 49 cost time: 1.048330307006836
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 50 cost time: 1.1172895431518555
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 51 cost time: 1.0374541282653809
Epoch: 51, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 52 cost time: 1.2105975151062012
Epoch: 52, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 53 cost time: 1.1054415702819824
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.811 Test Loss: 0.582 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 54 cost time: 1.1009442806243896
Epoch: 54, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 55 cost time: 1.0551912784576416
Epoch: 55, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 56 cost time: 0.9185569286346436
Epoch: 56, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 57 cost time: 1.0415678024291992
Epoch: 57, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 58 cost time: 1.0581409931182861
Epoch: 58, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 59 cost time: 1.0820586681365967
Epoch: 59, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 60 cost time: 1.086477279663086
Epoch: 60, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 61 cost time: 1.141639232635498
Epoch: 61, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 62 cost time: 0.9982969760894775
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 63 cost time: 1.0790469646453857
Epoch: 63, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 64 cost time: 1.0528438091278076
Epoch: 64, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 65 cost time: 1.126955509185791
Epoch: 65, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 66 cost time: 1.010707139968872
Epoch: 66, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 67 cost time: 1.0670561790466309
Epoch: 67, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 68 cost time: 1.2372663021087646
Epoch: 68, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 69 cost time: 1.195648431777954
Epoch: 69, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 70 cost time: 0.9548635482788086
Epoch: 70, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 71 cost time: 1.0240046977996826
Epoch: 71, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 72 cost time: 1.0960090160369873
Epoch: 72, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 73 cost time: 0.9740173816680908
Epoch: 73, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 74 cost time: 0.9577929973602295
Epoch: 74, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 75 cost time: 1.0152344703674316
Epoch: 75, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 76 cost time: 1.0336227416992188
Epoch: 76, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 77 cost time: 1.0436835289001465
Epoch: 77, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 78 cost time: 1.2248117923736572
Epoch: 78, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 79 cost time: 1.0603013038635254
Epoch: 79, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 80 cost time: 1.1125202178955078
Epoch: 80, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 81 cost time: 1.1078615188598633
Epoch: 81, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.0416903495788574
Epoch: 82, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 0.9763813018798828
Epoch: 83, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825921).  Saving model ...
Epoch: 84 cost time: 1.04008150100708
Epoch: 84, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 85 cost time: 0.9444112777709961
Epoch: 85, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 86 cost time: 1.1952743530273438
Epoch: 86, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 87 cost time: 1.0962586402893066
Epoch: 87, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 88 cost time: 1.1767899990081787
Epoch: 88, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.826 Test Loss: 0.536 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 89 cost time: 0.9574306011199951
Epoch: 89, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 90 cost time: 0.9925506114959717
Epoch: 90, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 91 cost time: 1.0976359844207764
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 92 cost time: 1.086000680923462
Epoch: 92, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.830 Test Loss: 0.531 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 93 cost time: 1.0584843158721924
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.830 Test Loss: 0.530 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 94 cost time: 1.2309160232543945
Epoch: 94, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.830 Test Loss: 0.529 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 95 cost time: 1.0683066844940186
Epoch: 95, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.830 Test Loss: 0.527 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 96 cost time: 1.24509596824646
Epoch: 96, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.830 Test Loss: 0.526 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 97 cost time: 1.079118251800537
Epoch: 97, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.830 Test Loss: 0.525 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 98 cost time: 1.095282793045044
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.830 Test Loss: 0.523 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 99 cost time: 1.1492292881011963
Epoch: 99, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.830 Test Loss: 0.522 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 100 cost time: 1.0927751064300537
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.36606502532959
Epoch: 1, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.788 Vali Acc: 0.159 Test Loss: 1.788 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 1.0028810501098633
Epoch: 2, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.769 Vali Acc: 0.196 Test Loss: 1.769 Test Acc: 0.196
Validation loss decreased (-0.159241 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 1.2221002578735352
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.747 Vali Acc: 0.230 Test Loss: 1.747 Test Acc: 0.230
Validation loss decreased (-0.196279 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 1.0932095050811768
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.714 Vali Acc: 0.259 Test Loss: 1.714 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 1.0468640327453613
Epoch: 5, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.673 Vali Acc: 0.307 Test Loss: 1.673 Test Acc: 0.307
Validation loss decreased (-0.259242 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 1.1553709506988525
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.626 Vali Acc: 0.370 Test Loss: 1.626 Test Acc: 0.370
Validation loss decreased (-0.307391 --> -0.370354).  Saving model ...
Epoch: 7 cost time: 1.1360373497009277
Epoch: 7, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.574 Vali Acc: 0.448 Test Loss: 1.574 Test Acc: 0.448
Validation loss decreased (-0.370354 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 1.286529541015625
Epoch: 8, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.519 Vali Acc: 0.526 Test Loss: 1.519 Test Acc: 0.526
Validation loss decreased (-0.448132 --> -0.525911).  Saving model ...
Epoch: 9 cost time: 1.2384042739868164
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.462 Vali Acc: 0.563 Test Loss: 1.462 Test Acc: 0.563
Validation loss decreased (-0.525911 --> -0.562948).  Saving model ...
Epoch: 10 cost time: 1.1666686534881592
Epoch: 10, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.406 Vali Acc: 0.611 Test Loss: 1.406 Test Acc: 0.611
Validation loss decreased (-0.562948 --> -0.611097).  Saving model ...
Epoch: 11 cost time: 1.047985553741455
Epoch: 11, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.351 Vali Acc: 0.626 Test Loss: 1.351 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 1.081803321838379
Epoch: 12, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.297 Vali Acc: 0.648 Test Loss: 1.297 Test Acc: 0.648
Validation loss decreased (-0.625912 --> -0.648135).  Saving model ...
Epoch: 13 cost time: 1.2294509410858154
Epoch: 13, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.244 Vali Acc: 0.656 Test Loss: 1.244 Test Acc: 0.656
Validation loss decreased (-0.648135 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 1.0636258125305176
Epoch: 14, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.194 Vali Acc: 0.674 Test Loss: 1.194 Test Acc: 0.674
Validation loss decreased (-0.655543 --> -0.674062).  Saving model ...
Epoch: 15 cost time: 1.1031112670898438
Epoch: 15, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.147 Vali Acc: 0.685 Test Loss: 1.147 Test Acc: 0.685
Validation loss decreased (-0.674062 --> -0.685174).  Saving model ...
Epoch: 16 cost time: 0.9992308616638184
Epoch: 16, Steps: 2 | Train Loss: 0.672 Vali Loss: 1.103 Vali Acc: 0.693 Test Loss: 1.103 Test Acc: 0.693
Validation loss decreased (-0.685174 --> -0.692582).  Saving model ...
Epoch: 17 cost time: 1.070251703262329
Epoch: 17, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.060 Vali Acc: 0.693 Test Loss: 1.060 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 18 cost time: 1.0416758060455322
Epoch: 18, Steps: 2 | Train Loss: 0.587 Vali Loss: 1.019 Vali Acc: 0.704 Test Loss: 1.019 Test Acc: 0.704
Validation loss decreased (-0.692582 --> -0.703694).  Saving model ...
Epoch: 19 cost time: 0.9799652099609375
Epoch: 19, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.981 Vali Acc: 0.704 Test Loss: 0.981 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 20 cost time: 1.2193307876586914
Epoch: 20, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.945 Vali Acc: 0.711 Test Loss: 0.945 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 1.1117093563079834
Epoch: 21, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.911 Vali Acc: 0.707 Test Loss: 0.911 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.141758918762207
Epoch: 22, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.880 Vali Acc: 0.711 Test Loss: 0.880 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 23 cost time: 1.0621864795684814
Epoch: 23, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.853 Vali Acc: 0.722 Test Loss: 0.853 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 24 cost time: 1.1667957305908203
Epoch: 24, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 25 cost time: 1.043487548828125
Epoch: 25, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.809 Vali Acc: 0.730 Test Loss: 0.809 Test Acc: 0.730
Validation loss decreased (-0.722214 --> -0.729622).  Saving model ...
Epoch: 26 cost time: 1.0902996063232422
Epoch: 26, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.791 Vali Acc: 0.733 Test Loss: 0.791 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 1.0288758277893066
Epoch: 27, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 28 cost time: 0.9436023235321045
Epoch: 28, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.762 Vali Acc: 0.752 Test Loss: 0.762 Test Acc: 0.752
Validation loss decreased (-0.744437 --> -0.751844).  Saving model ...
Epoch: 29 cost time: 1.089021921157837
Epoch: 29, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.751 Vali Acc: 0.748 Test Loss: 0.751 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9827179908752441
Epoch: 30, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.740 Vali Acc: 0.752 Test Loss: 0.740 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 31 cost time: 1.0198404788970947
Epoch: 31, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.731 Vali Acc: 0.752 Test Loss: 0.731 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751845).  Saving model ...
Epoch: 32 cost time: 0.9936769008636475
Epoch: 32, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.721 Vali Acc: 0.759 Test Loss: 0.721 Test Acc: 0.759
Validation loss decreased (-0.751845 --> -0.759252).  Saving model ...
Epoch: 33 cost time: 0.9835724830627441
Epoch: 33, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 34 cost time: 1.0469813346862793
Epoch: 34, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.705 Vali Acc: 0.774 Test Loss: 0.705 Test Acc: 0.774
Validation loss decreased (-0.762956 --> -0.774067).  Saving model ...
Epoch: 35 cost time: 1.2166705131530762
Epoch: 35, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 36 cost time: 1.0611460208892822
Epoch: 36, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.691 Vali Acc: 0.778 Test Loss: 0.691 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 37 cost time: 1.0871994495391846
Epoch: 37, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.686 Vali Acc: 0.781 Test Loss: 0.686 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 38 cost time: 1.048340082168579
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.681 Vali Acc: 0.781 Test Loss: 0.681 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 39 cost time: 1.279334545135498
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.676 Vali Acc: 0.785 Test Loss: 0.676 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 40 cost time: 1.0423848628997803
Epoch: 40, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.673 Vali Acc: 0.785 Test Loss: 0.673 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 41 cost time: 1.0156543254852295
Epoch: 41, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.781 Test Loss: 0.670 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1762027740478516
Epoch: 42, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.667 Vali Acc: 0.785 Test Loss: 0.667 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785179).  Saving model ...
Epoch: 43 cost time: 1.0682055950164795
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.665 Vali Acc: 0.785 Test Loss: 0.665 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 44 cost time: 1.0599970817565918
Epoch: 44, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.662 Vali Acc: 0.785 Test Loss: 0.662 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 45 cost time: 1.100923776626587
Epoch: 45, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.660 Vali Acc: 0.785 Test Loss: 0.660 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 46 cost time: 1.0879578590393066
Epoch: 46, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.657 Vali Acc: 0.785 Test Loss: 0.657 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 47 cost time: 1.1895065307617188
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.655 Vali Acc: 0.785 Test Loss: 0.655 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 48 cost time: 1.2794842720031738
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.653 Vali Acc: 0.785 Test Loss: 0.653 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 49 cost time: 1.1953511238098145
Epoch: 49, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.651 Vali Acc: 0.785 Test Loss: 0.651 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 50 cost time: 1.0871970653533936
Epoch: 50, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.649 Vali Acc: 0.785 Test Loss: 0.649 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 51 cost time: 1.052715539932251
Epoch: 51, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.646 Vali Acc: 0.785 Test Loss: 0.646 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 52 cost time: 1.156989336013794
Epoch: 52, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.785 Test Loss: 0.643 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 53 cost time: 1.1846721172332764
Epoch: 53, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.640 Vali Acc: 0.785 Test Loss: 0.640 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 54 cost time: 1.0352346897125244
Epoch: 54, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.785 Test Loss: 0.637 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 55 cost time: 1.0865626335144043
Epoch: 55, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.785 Test Loss: 0.633 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 56 cost time: 0.97304368019104
Epoch: 56, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.630 Vali Acc: 0.785 Test Loss: 0.630 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 57 cost time: 1.2076334953308105
Epoch: 57, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 58 cost time: 1.1446278095245361
Epoch: 58, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 59 cost time: 1.2649290561676025
Epoch: 59, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 60 cost time: 1.0630407333374023
Epoch: 60, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 61 cost time: 1.109140396118164
Epoch: 61, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.614 Vali Acc: 0.789 Test Loss: 0.614 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 62 cost time: 1.183262825012207
Epoch: 62, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
Validation loss decreased (-0.788883 --> -0.796290).  Saving model ...
Epoch: 63 cost time: 1.1129517555236816
Epoch: 63, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 64 cost time: 1.1501994132995605
Epoch: 64, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 65 cost time: 1.1071593761444092
Epoch: 65, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 66 cost time: 1.1712732315063477
Epoch: 66, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 67 cost time: 1.1608233451843262
Epoch: 67, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 68 cost time: 1.0898988246917725
Epoch: 68, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 69 cost time: 1.1329925060272217
Epoch: 69, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.804 Test Loss: 0.588 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803698).  Saving model ...
Epoch: 70 cost time: 1.0755655765533447
Epoch: 70, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 71 cost time: 1.0714185237884521
Epoch: 71, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 72 cost time: 1.0111680030822754
Epoch: 72, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.807 Test Loss: 0.577 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 73 cost time: 1.191429853439331
Epoch: 73, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.807 Test Loss: 0.574 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 74 cost time: 1.1618659496307373
Epoch: 74, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.807 Test Loss: 0.571 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 75 cost time: 1.184075117111206
Epoch: 75, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.568 Vali Acc: 0.807 Test Loss: 0.568 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 76 cost time: 1.2626087665557861
Epoch: 76, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.807 Test Loss: 0.565 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 77 cost time: 1.1976604461669922
Epoch: 77, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.811 Test Loss: 0.562 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 78 cost time: 1.192579746246338
Epoch: 78, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.559 Vali Acc: 0.811 Test Loss: 0.559 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 79 cost time: 1.2665038108825684
Epoch: 79, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
Validation loss decreased (-0.811106 --> -0.814809).  Saving model ...
Epoch: 80 cost time: 1.1852271556854248
Epoch: 80, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 81 cost time: 1.226060390472412
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.811 Test Loss: 0.551 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.105527400970459
Epoch: 82, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.815 Test Loss: 0.548 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 83 cost time: 1.1621496677398682
Epoch: 83, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 84 cost time: 1.1289448738098145
Epoch: 84, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.815 Test Loss: 0.543 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 85 cost time: 1.0788724422454834
Epoch: 85, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 86 cost time: 1.0713727474212646
Epoch: 86, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 87 cost time: 1.1255221366882324
Epoch: 87, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 88 cost time: 1.0106158256530762
Epoch: 88, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 89 cost time: 1.0650765895843506
Epoch: 89, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 90 cost time: 0.9904122352600098
Epoch: 90, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 91 cost time: 1.0594403743743896
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 92 cost time: 1.2040367126464844
Epoch: 92, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 93 cost time: 1.1577260494232178
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 94 cost time: 1.2303485870361328
Epoch: 94, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.830 Test Loss: 0.519 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 95 cost time: 1.2117619514465332
Epoch: 95, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.830 Test Loss: 0.516 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 96 cost time: 0.9290478229522705
Epoch: 96, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.830 Test Loss: 0.513 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 97 cost time: 1.093400478363037
Epoch: 97, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.830 Test Loss: 0.511 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829625).  Saving model ...
Epoch: 98 cost time: 1.0252645015716553
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 0.9500150680541992
Epoch: 99, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 100 cost time: 1.0720999240875244
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.837 Test Loss: 0.504 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3014590740203857
Epoch: 1, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.776 Vali Acc: 0.141 Test Loss: 1.776 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 1.0587692260742188
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.762 Vali Acc: 0.159 Test Loss: 1.762 Test Acc: 0.159
Validation loss decreased (-0.140723 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 1.1179766654968262
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.746 Vali Acc: 0.200 Test Loss: 1.746 Test Acc: 0.200
Validation loss decreased (-0.159242 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.2486298084259033
Epoch: 4, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.721 Vali Acc: 0.248 Test Loss: 1.721 Test Acc: 0.248
Validation loss decreased (-0.199983 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 1.1265623569488525
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.690 Vali Acc: 0.330 Test Loss: 1.690 Test Acc: 0.330
Validation loss decreased (-0.248131 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 1.2262382507324219
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.653 Vali Acc: 0.374 Test Loss: 1.653 Test Acc: 0.374
Validation loss decreased (-0.329613 --> -0.374058).  Saving model ...
Epoch: 7 cost time: 1.169997215270996
Epoch: 7, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.613 Vali Acc: 0.433 Test Loss: 1.613 Test Acc: 0.433
Validation loss decreased (-0.374058 --> -0.433317).  Saving model ...
Epoch: 8 cost time: 1.0540568828582764
Epoch: 8, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.569 Vali Acc: 0.463 Test Loss: 1.569 Test Acc: 0.463
Validation loss decreased (-0.433317 --> -0.462947).  Saving model ...
Epoch: 9 cost time: 1.0141716003417969
Epoch: 9, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.523 Vali Acc: 0.515 Test Loss: 1.523 Test Acc: 0.515
Validation loss decreased (-0.462947 --> -0.514800).  Saving model ...
Epoch: 10 cost time: 1.0152809619903564
Epoch: 10, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.476 Vali Acc: 0.552 Test Loss: 1.476 Test Acc: 0.552
Validation loss decreased (-0.514800 --> -0.551837).  Saving model ...
Epoch: 11 cost time: 1.0557239055633545
Epoch: 11, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.430 Vali Acc: 0.574 Test Loss: 1.430 Test Acc: 0.574
Validation loss decreased (-0.551837 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 1.186004400253296
Epoch: 12, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.384 Vali Acc: 0.600 Test Loss: 1.384 Test Acc: 0.600
Validation loss decreased (-0.574060 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 0.9821836948394775
Epoch: 13, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.338 Vali Acc: 0.611 Test Loss: 1.338 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 1.0192821025848389
Epoch: 14, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.294 Vali Acc: 0.622 Test Loss: 1.294 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 15 cost time: 1.176192283630371
Epoch: 15, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.251 Vali Acc: 0.648 Test Loss: 1.251 Test Acc: 0.648
Validation loss decreased (-0.622209 --> -0.648136).  Saving model ...
Epoch: 16 cost time: 1.2013952732086182
Epoch: 16, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.210 Vali Acc: 0.663 Test Loss: 1.210 Test Acc: 0.663
Validation loss decreased (-0.648136 --> -0.662951).  Saving model ...
Epoch: 17 cost time: 1.1404736042022705
Epoch: 17, Steps: 2 | Train Loss: 0.791 Vali Loss: 1.169 Vali Acc: 0.670 Test Loss: 1.169 Test Acc: 0.670
Validation loss decreased (-0.662951 --> -0.670359).  Saving model ...
Epoch: 18 cost time: 1.1222517490386963
Epoch: 18, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.128 Vali Acc: 0.678 Test Loss: 1.128 Test Acc: 0.678
Validation loss decreased (-0.670359 --> -0.677766).  Saving model ...
Epoch: 19 cost time: 1.042564868927002
Epoch: 19, Steps: 2 | Train Loss: 0.621 Vali Loss: 1.090 Vali Acc: 0.685 Test Loss: 1.090 Test Acc: 0.685
Validation loss decreased (-0.677766 --> -0.685174).  Saving model ...
Epoch: 20 cost time: 1.0847201347351074
Epoch: 20, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.054 Vali Acc: 0.693 Test Loss: 1.054 Test Acc: 0.693
Validation loss decreased (-0.685174 --> -0.692582).  Saving model ...
Epoch: 21 cost time: 1.1336109638214111
Epoch: 21, Steps: 2 | Train Loss: 0.502 Vali Loss: 1.020 Vali Acc: 0.711 Test Loss: 1.020 Test Acc: 0.711
Validation loss decreased (-0.692582 --> -0.711101).  Saving model ...
Epoch: 22 cost time: 1.0353503227233887
Epoch: 22, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.989 Vali Acc: 0.711 Test Loss: 0.989 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 23 cost time: 1.1664001941680908
Epoch: 23, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 1.0625615119934082
Epoch: 24, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.937 Vali Acc: 0.733 Test Loss: 0.937 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 1.1093668937683105
Epoch: 25, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.915 Vali Acc: 0.741 Test Loss: 0.915 Test Acc: 0.741
Validation loss decreased (-0.733324 --> -0.740732).  Saving model ...
Epoch: 26 cost time: 1.2480924129486084
Epoch: 26, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.897 Vali Acc: 0.744 Test Loss: 0.897 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744435).  Saving model ...
Epoch: 27 cost time: 0.9721047878265381
Epoch: 27, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.882 Vali Acc: 0.748 Test Loss: 0.882 Test Acc: 0.748
Validation loss decreased (-0.744435 --> -0.748139).  Saving model ...
Epoch: 28 cost time: 1.1167709827423096
Epoch: 28, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.867 Vali Acc: 0.748 Test Loss: 0.867 Test Acc: 0.748
Validation loss decreased (-0.748139 --> -0.748139).  Saving model ...
Epoch: 29 cost time: 1.217158317565918
Epoch: 29, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.855 Vali Acc: 0.748 Test Loss: 0.855 Test Acc: 0.748
Validation loss decreased (-0.748139 --> -0.748140).  Saving model ...
Epoch: 30 cost time: 1.1439096927642822
Epoch: 30, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.842 Vali Acc: 0.748 Test Loss: 0.842 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 31 cost time: 1.0663447380065918
Epoch: 31, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.832 Vali Acc: 0.748 Test Loss: 0.832 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 32 cost time: 1.074402093887329
Epoch: 32, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.823 Vali Acc: 0.748 Test Loss: 0.823 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 33 cost time: 1.112250804901123
Epoch: 33, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.815 Vali Acc: 0.748 Test Loss: 0.815 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 34 cost time: 1.1165854930877686
Epoch: 34, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.808 Vali Acc: 0.748 Test Loss: 0.808 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 35 cost time: 1.0854558944702148
Epoch: 35, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.802 Vali Acc: 0.752 Test Loss: 0.802 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 36 cost time: 1.038306713104248
Epoch: 36, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.797 Vali Acc: 0.752 Test Loss: 0.797 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 37 cost time: 0.8890361785888672
Epoch: 37, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.792 Vali Acc: 0.752 Test Loss: 0.792 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 38 cost time: 1.0323987007141113
Epoch: 38, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.788 Vali Acc: 0.752 Test Loss: 0.788 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 39 cost time: 1.0225787162780762
Epoch: 39, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.785 Vali Acc: 0.748 Test Loss: 0.785 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0102901458740234
Epoch: 40, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.782 Vali Acc: 0.752 Test Loss: 0.782 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 41 cost time: 0.9400315284729004
Epoch: 41, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.780 Vali Acc: 0.752 Test Loss: 0.780 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 42 cost time: 0.9884130954742432
Epoch: 42, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.777 Vali Acc: 0.752 Test Loss: 0.777 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 43 cost time: 0.930304765701294
Epoch: 43, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.775 Vali Acc: 0.756 Test Loss: 0.775 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 44 cost time: 1.0777490139007568
Epoch: 44, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.773 Vali Acc: 0.759 Test Loss: 0.773 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 45 cost time: 1.0254435539245605
Epoch: 45, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.770 Vali Acc: 0.763 Test Loss: 0.770 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762955).  Saving model ...
Epoch: 46 cost time: 0.9203133583068848
Epoch: 46, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.768 Vali Acc: 0.770 Test Loss: 0.768 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 47 cost time: 1.0914483070373535
Epoch: 47, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.766 Vali Acc: 0.767 Test Loss: 0.766 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0341639518737793
Epoch: 48, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.763 Vali Acc: 0.770 Test Loss: 0.763 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 49 cost time: 1.0300471782684326
Epoch: 49, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.761 Vali Acc: 0.770 Test Loss: 0.761 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 50 cost time: 1.2471680641174316
Epoch: 50, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.758 Vali Acc: 0.770 Test Loss: 0.758 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 51 cost time: 1.0933339595794678
Epoch: 51, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.754 Vali Acc: 0.774 Test Loss: 0.754 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 52 cost time: 1.1034677028656006
Epoch: 52, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.749 Vali Acc: 0.774 Test Loss: 0.749 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 53 cost time: 1.1935741901397705
Epoch: 53, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 54 cost time: 1.1517033576965332
Epoch: 54, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.740 Vali Acc: 0.781 Test Loss: 0.740 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 55 cost time: 1.1769192218780518
Epoch: 55, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.735 Vali Acc: 0.785 Test Loss: 0.735 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 56 cost time: 1.0842223167419434
Epoch: 56, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.730 Vali Acc: 0.785 Test Loss: 0.730 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 57 cost time: 1.0041172504425049
Epoch: 57, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.724 Vali Acc: 0.785 Test Loss: 0.724 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 58 cost time: 1.1341476440429688
Epoch: 58, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.719 Vali Acc: 0.789 Test Loss: 0.719 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 59 cost time: 1.0433766841888428
Epoch: 59, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 60 cost time: 1.03419828414917
Epoch: 60, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 61 cost time: 0.9439778327941895
Epoch: 61, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 62 cost time: 1.035874843597412
Epoch: 62, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.698 Vali Acc: 0.793 Test Loss: 0.698 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 63 cost time: 0.9607181549072266
Epoch: 63, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.793 Test Loss: 0.693 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 64 cost time: 1.0193603038787842
Epoch: 64, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.688 Vali Acc: 0.793 Test Loss: 0.688 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 65 cost time: 1.0975866317749023
Epoch: 65, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 66 cost time: 1.1399636268615723
Epoch: 66, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 67 cost time: 1.0738654136657715
Epoch: 67, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 68 cost time: 1.1008784770965576
Epoch: 68, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 69 cost time: 1.1217164993286133
Epoch: 69, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.800 Test Loss: 0.668 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 70 cost time: 1.1377301216125488
Epoch: 70, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 71 cost time: 1.1550421714782715
Epoch: 71, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 72 cost time: 1.1132638454437256
Epoch: 72, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 73 cost time: 1.0479285717010498
Epoch: 73, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 74 cost time: 0.9694564342498779
Epoch: 74, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 75 cost time: 1.0899252891540527
Epoch: 75, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.807 Test Loss: 0.646 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 76 cost time: 1.1190216541290283
Epoch: 76, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.807 Test Loss: 0.643 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 77 cost time: 0.9116687774658203
Epoch: 77, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.807 Test Loss: 0.639 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 78 cost time: 1.0559391975402832
Epoch: 78, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.807 Test Loss: 0.636 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 79 cost time: 0.9657015800476074
Epoch: 79, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.807 Test Loss: 0.633 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 80 cost time: 1.0518312454223633
Epoch: 80, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.631 Vali Acc: 0.807 Test Loss: 0.631 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 81 cost time: 0.9402563571929932
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.807 Test Loss: 0.628 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 82 cost time: 1.0864372253417969
Epoch: 82, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 83 cost time: 1.0655605792999268
Epoch: 83, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.811 Test Loss: 0.623 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 84 cost time: 1.2067837715148926
Epoch: 84, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.811 Test Loss: 0.621 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 85 cost time: 1.107198715209961
Epoch: 85, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.811 Test Loss: 0.618 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 86 cost time: 1.0842852592468262
Epoch: 86, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 87 cost time: 1.0988354682922363
Epoch: 87, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 88 cost time: 1.2055141925811768
Epoch: 88, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 89 cost time: 1.0429847240447998
Epoch: 89, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.811 Test Loss: 0.608 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 90 cost time: 1.3229265213012695
Epoch: 90, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 91 cost time: 1.1161692142486572
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 92 cost time: 1.0334405899047852
Epoch: 92, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.811 Test Loss: 0.600 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 93 cost time: 0.9618620872497559
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.815 Test Loss: 0.598 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 94 cost time: 1.073545217514038
Epoch: 94, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 95 cost time: 1.0812437534332275
Epoch: 95, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 96 cost time: 1.0975661277770996
Epoch: 96, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 97 cost time: 1.0702669620513916
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 98 cost time: 1.2132844924926758
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 99 cost time: 1.1508994102478027
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.830 Test Loss: 0.584 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 100 cost time: 1.1503148078918457
Epoch: 100, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.830 Test Loss: 0.582 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4177725315093994
Epoch: 1, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.824 Vali Acc: 0.204 Test Loss: 1.824 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.9309079647064209
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.813 Vali Acc: 0.211 Test Loss: 1.813 Test Acc: 0.211
Validation loss decreased (-0.203685 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.9424211978912354
Epoch: 3, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.802 Vali Acc: 0.211 Test Loss: 1.802 Test Acc: 0.211
Validation loss decreased (-0.211093 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.9812154769897461
Epoch: 4, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.784 Vali Acc: 0.226 Test Loss: 1.784 Test Acc: 0.226
Validation loss decreased (-0.211093 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.9539341926574707
Epoch: 5, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.762 Vali Acc: 0.256 Test Loss: 1.762 Test Acc: 0.256
Validation loss decreased (-0.225908 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.9295456409454346
Epoch: 6, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.737 Vali Acc: 0.274 Test Loss: 1.737 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 7 cost time: 1.1832149028778076
Epoch: 7, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.709 Vali Acc: 0.311 Test Loss: 1.709 Test Acc: 0.311
Validation loss decreased (-0.274057 --> -0.311094).  Saving model ...
Epoch: 8 cost time: 1.1301865577697754
Epoch: 8, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.677 Vali Acc: 0.359 Test Loss: 1.677 Test Acc: 0.359
Validation loss decreased (-0.311094 --> -0.359242).  Saving model ...
Epoch: 9 cost time: 1.0983726978302002
Epoch: 9, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.644 Vali Acc: 0.419 Test Loss: 1.644 Test Acc: 0.419
Validation loss decreased (-0.359242 --> -0.418502).  Saving model ...
Epoch: 10 cost time: 1.0905702114105225
Epoch: 10, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.610 Vali Acc: 0.456 Test Loss: 1.610 Test Acc: 0.456
Validation loss decreased (-0.418502 --> -0.455539).  Saving model ...
Epoch: 11 cost time: 1.0472698211669922
Epoch: 11, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.576 Vali Acc: 0.478 Test Loss: 1.576 Test Acc: 0.478
Validation loss decreased (-0.455539 --> -0.477762).  Saving model ...
Epoch: 12 cost time: 1.0593311786651611
Epoch: 12, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.542 Vali Acc: 0.496 Test Loss: 1.542 Test Acc: 0.496
Validation loss decreased (-0.477762 --> -0.496281).  Saving model ...
Epoch: 13 cost time: 1.0687155723571777
Epoch: 13, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.508 Vali Acc: 0.507 Test Loss: 1.508 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 14 cost time: 1.1470320224761963
Epoch: 14, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.474 Vali Acc: 0.533 Test Loss: 1.474 Test Acc: 0.533
Validation loss decreased (-0.507392 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 0.9098761081695557
Epoch: 15, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.441 Vali Acc: 0.544 Test Loss: 1.441 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544430).  Saving model ...
Epoch: 16 cost time: 1.1121859550476074
Epoch: 16, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.408 Vali Acc: 0.548 Test Loss: 1.408 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 17 cost time: 1.0467042922973633
Epoch: 17, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.376 Vali Acc: 0.548 Test Loss: 1.376 Test Acc: 0.548
Validation loss decreased (-0.548134 --> -0.548134).  Saving model ...
Epoch: 18 cost time: 1.0044491291046143
Epoch: 18, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.344 Vali Acc: 0.548 Test Loss: 1.344 Test Acc: 0.548
Validation loss decreased (-0.548134 --> -0.548135).  Saving model ...
Epoch: 19 cost time: 1.0622291564941406
Epoch: 19, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.314 Vali Acc: 0.548 Test Loss: 1.314 Test Acc: 0.548
Validation loss decreased (-0.548135 --> -0.548135).  Saving model ...
Epoch: 20 cost time: 1.0399348735809326
Epoch: 20, Steps: 2 | Train Loss: 0.781 Vali Loss: 1.284 Vali Acc: 0.548 Test Loss: 1.284 Test Acc: 0.548
Validation loss decreased (-0.548135 --> -0.548135).  Saving model ...
Epoch: 21 cost time: 1.1876354217529297
Epoch: 21, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.255 Vali Acc: 0.552 Test Loss: 1.255 Test Acc: 0.552
Validation loss decreased (-0.548135 --> -0.551839).  Saving model ...
Epoch: 22 cost time: 1.1891028881072998
Epoch: 22, Steps: 2 | Train Loss: 0.660 Vali Loss: 1.227 Vali Acc: 0.567 Test Loss: 1.227 Test Acc: 0.567
Validation loss decreased (-0.551839 --> -0.566654).  Saving model ...
Epoch: 23 cost time: 1.1577396392822266
Epoch: 23, Steps: 2 | Train Loss: 0.582 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
Validation loss decreased (-0.566654 --> -0.581469).  Saving model ...
Epoch: 24 cost time: 1.1783812046051025
Epoch: 24, Steps: 2 | Train Loss: 0.556 Vali Loss: 1.178 Vali Acc: 0.593 Test Loss: 1.178 Test Acc: 0.593
Validation loss decreased (-0.581469 --> -0.592581).  Saving model ...
Epoch: 25 cost time: 1.1207327842712402
Epoch: 25, Steps: 2 | Train Loss: 0.527 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.592581 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 1.1671149730682373
Epoch: 26, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.136 Vali Acc: 0.604 Test Loss: 1.136 Test Acc: 0.604
Validation loss decreased (-0.599988 --> -0.603692).  Saving model ...
Epoch: 27 cost time: 1.145533561706543
Epoch: 27, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.216712474822998
Epoch: 28, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.098 Vali Acc: 0.604 Test Loss: 1.098 Test Acc: 0.604
Validation loss decreased (-0.603692 --> -0.603693).  Saving model ...
Epoch: 29 cost time: 0.9602491855621338
Epoch: 29, Steps: 2 | Train Loss: 0.320 Vali Loss: 1.080 Vali Acc: 0.607 Test Loss: 1.080 Test Acc: 0.607
Validation loss decreased (-0.603693 --> -0.607397).  Saving model ...
Epoch: 30 cost time: 1.0428409576416016
Epoch: 30, Steps: 2 | Train Loss: 0.279 Vali Loss: 1.062 Vali Acc: 0.611 Test Loss: 1.062 Test Acc: 0.611
Validation loss decreased (-0.607397 --> -0.611100).  Saving model ...
Epoch: 31 cost time: 0.982475996017456
Epoch: 31, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.046 Vali Acc: 0.611 Test Loss: 1.046 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611101).  Saving model ...
Epoch: 32 cost time: 1.0581650733947754
Epoch: 32, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.030 Vali Acc: 0.615 Test Loss: 1.030 Test Acc: 0.615
Validation loss decreased (-0.611101 --> -0.614805).  Saving model ...
Epoch: 33 cost time: 1.1765143871307373
Epoch: 33, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.014 Vali Acc: 0.619 Test Loss: 1.014 Test Acc: 0.619
Validation loss decreased (-0.614805 --> -0.618508).  Saving model ...
Epoch: 34 cost time: 1.049346923828125
Epoch: 34, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
Validation loss decreased (-0.618508 --> -0.622212).  Saving model ...
Epoch: 35 cost time: 1.0563738346099854
Epoch: 35, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.986 Vali Acc: 0.630 Test Loss: 0.986 Test Acc: 0.630
Validation loss decreased (-0.622212 --> -0.629620).  Saving model ...
Epoch: 36 cost time: 1.1139836311340332
Epoch: 36, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.973 Vali Acc: 0.644 Test Loss: 0.973 Test Acc: 0.644
Validation loss decreased (-0.629620 --> -0.644435).  Saving model ...
Epoch: 37 cost time: 1.0934374332427979
Epoch: 37, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.960 Vali Acc: 0.648 Test Loss: 0.960 Test Acc: 0.648
Validation loss decreased (-0.644435 --> -0.648139).  Saving model ...
Epoch: 38 cost time: 1.0770955085754395
Epoch: 38, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.948 Vali Acc: 0.656 Test Loss: 0.948 Test Acc: 0.656
Validation loss decreased (-0.648139 --> -0.655546).  Saving model ...
Epoch: 39 cost time: 1.1586987972259521
Epoch: 39, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.936 Vali Acc: 0.659 Test Loss: 0.936 Test Acc: 0.659
Validation loss decreased (-0.655546 --> -0.659250).  Saving model ...
Epoch: 40 cost time: 1.1357829570770264
Epoch: 40, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.925 Vali Acc: 0.670 Test Loss: 0.925 Test Acc: 0.670
Validation loss decreased (-0.659250 --> -0.670361).  Saving model ...
Epoch: 41 cost time: 1.187483549118042
Epoch: 41, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.914 Vali Acc: 0.681 Test Loss: 0.914 Test Acc: 0.681
Validation loss decreased (-0.670361 --> -0.681472).  Saving model ...
Epoch: 42 cost time: 1.2272758483886719
Epoch: 42, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.904 Vali Acc: 0.685 Test Loss: 0.904 Test Acc: 0.685
Validation loss decreased (-0.681472 --> -0.685176).  Saving model ...
Epoch: 43 cost time: 0.9743456840515137
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.894 Vali Acc: 0.681 Test Loss: 0.894 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9358599185943604
Epoch: 44, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.885 Vali Acc: 0.685 Test Loss: 0.885 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685176).  Saving model ...
Epoch: 45 cost time: 0.9245812892913818
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.876 Vali Acc: 0.685 Test Loss: 0.876 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685176).  Saving model ...
Epoch: 46 cost time: 0.9196453094482422
Epoch: 46, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.868 Vali Acc: 0.685 Test Loss: 0.868 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685177).  Saving model ...
Epoch: 47 cost time: 0.9336190223693848
Epoch: 47, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.861 Vali Acc: 0.685 Test Loss: 0.861 Test Acc: 0.685
Validation loss decreased (-0.685177 --> -0.685177).  Saving model ...
Epoch: 48 cost time: 1.0269920825958252
Epoch: 48, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.854 Vali Acc: 0.693 Test Loss: 0.854 Test Acc: 0.693
Validation loss decreased (-0.685177 --> -0.692584).  Saving model ...
Epoch: 49 cost time: 1.0158517360687256
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.847 Vali Acc: 0.693 Test Loss: 0.847 Test Acc: 0.693
Validation loss decreased (-0.692584 --> -0.692584).  Saving model ...
Epoch: 50 cost time: 1.0361449718475342
Epoch: 50, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.841 Vali Acc: 0.693 Test Loss: 0.841 Test Acc: 0.693
Validation loss decreased (-0.692584 --> -0.692584).  Saving model ...
Epoch: 51 cost time: 0.9973642826080322
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.834 Vali Acc: 0.693 Test Loss: 0.834 Test Acc: 0.693
Validation loss decreased (-0.692584 --> -0.692584).  Saving model ...
Epoch: 52 cost time: 1.0285043716430664
Epoch: 52, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.827 Vali Acc: 0.700 Test Loss: 0.827 Test Acc: 0.700
Validation loss decreased (-0.692584 --> -0.699992).  Saving model ...
Epoch: 53 cost time: 1.0610415935516357
Epoch: 53, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.820 Vali Acc: 0.707 Test Loss: 0.820 Test Acc: 0.707
Validation loss decreased (-0.699992 --> -0.707399).  Saving model ...
Epoch: 54 cost time: 1.0589871406555176
Epoch: 54, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.707399 --> -0.711103).  Saving model ...
Epoch: 55 cost time: 0.9173319339752197
Epoch: 55, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.806 Vali Acc: 0.715 Test Loss: 0.806 Test Acc: 0.715
Validation loss decreased (-0.711103 --> -0.714807).  Saving model ...
Epoch: 56 cost time: 1.0788726806640625
Epoch: 56, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.799 Vali Acc: 0.719 Test Loss: 0.799 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718511).  Saving model ...
Epoch: 57 cost time: 0.976693868637085
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.793 Vali Acc: 0.722 Test Loss: 0.793 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722214).  Saving model ...
Epoch: 58 cost time: 1.0259389877319336
Epoch: 58, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.786 Vali Acc: 0.719 Test Loss: 0.786 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9596903324127197
Epoch: 59, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.780 Vali Acc: 0.719 Test Loss: 0.780 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0123026371002197
Epoch: 60, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.774 Vali Acc: 0.722 Test Loss: 0.774 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 61 cost time: 1.0087125301361084
Epoch: 61, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 62 cost time: 0.9841954708099365
Epoch: 62, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.763 Vali Acc: 0.719 Test Loss: 0.763 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9504733085632324
Epoch: 63, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.757 Vali Acc: 0.719 Test Loss: 0.757 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9105067253112793
Epoch: 64, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.752 Vali Acc: 0.719 Test Loss: 0.752 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.036046028137207
Epoch: 65, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 66 cost time: 1.0431897640228271
Epoch: 66, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.741 Vali Acc: 0.719 Test Loss: 0.741 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0583412647247314
Epoch: 67, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.736 Vali Acc: 0.719 Test Loss: 0.736 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1552670001983643
Epoch: 68, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.732 Vali Acc: 0.722 Test Loss: 0.732 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 69 cost time: 1.0617942810058594
Epoch: 69, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.729 Vali Acc: 0.726 Test Loss: 0.729 Test Acc: 0.726
Validation loss decreased (-0.722215 --> -0.725919).  Saving model ...
Epoch: 70 cost time: 1.0965230464935303
Epoch: 70, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.730 Test Loss: 0.725 Test Acc: 0.730
Validation loss decreased (-0.725919 --> -0.729622).  Saving model ...
Epoch: 71 cost time: 1.1266307830810547
Epoch: 71, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737030).  Saving model ...
Epoch: 72 cost time: 1.0966711044311523
Epoch: 72, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.717 Vali Acc: 0.741 Test Loss: 0.717 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740734).  Saving model ...
Epoch: 73 cost time: 1.0045514106750488
Epoch: 73, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 74 cost time: 0.9956114292144775
Epoch: 74, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.711 Vali Acc: 0.741 Test Loss: 0.711 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 75 cost time: 0.9992640018463135
Epoch: 75, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 76 cost time: 1.05570650100708
Epoch: 76, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.741 Test Loss: 0.703 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 77 cost time: 0.9931926727294922
Epoch: 77, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.044959306716919
Epoch: 78, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.733 Test Loss: 0.696 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.0482537746429443
Epoch: 79, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.0212831497192383
Epoch: 80, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.690 Vali Acc: 0.733 Test Loss: 0.690 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.062413215637207
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.9868326187133789
Epoch: 82, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.015451431274414
Epoch: 83, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.0816333293914795
Epoch: 84, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.733 Test Loss: 0.680 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.039363145828247
Epoch: 85, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.677 Vali Acc: 0.733 Test Loss: 0.677 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.1213006973266602
Epoch: 86, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 87 cost time: 0.9920222759246826
Epoch: 87, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.741 Test Loss: 0.672 Test Acc: 0.741
Validation loss decreased (-0.740734 --> -0.740734).  Saving model ...
Epoch: 88 cost time: 0.9388976097106934
Epoch: 88, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744438).  Saving model ...
Epoch: 89 cost time: 0.9825186729431152
Epoch: 89, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.666 Vali Acc: 0.748 Test Loss: 0.666 Test Acc: 0.748
Validation loss decreased (-0.744438 --> -0.748141).  Saving model ...
Epoch: 90 cost time: 0.9876165390014648
Epoch: 90, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.744 Test Loss: 0.663 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9776074886322021
Epoch: 91, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.744 Test Loss: 0.660 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9330828189849854
Epoch: 92, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.748 Test Loss: 0.657 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748142).  Saving model ...
Epoch: 93 cost time: 0.8983278274536133
Epoch: 93, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.752 Test Loss: 0.654 Test Acc: 0.752
Validation loss decreased (-0.748142 --> -0.751845).  Saving model ...
Epoch: 94 cost time: 1.0070877075195312
Epoch: 94, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.756 Test Loss: 0.652 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 95 cost time: 1.0413291454315186
Epoch: 95, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.759 Test Loss: 0.649 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759253).  Saving model ...
Epoch: 96 cost time: 1.042057752609253
Epoch: 96, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.759 Test Loss: 0.646 Test Acc: 0.759
Validation loss decreased (-0.759253 --> -0.759253).  Saving model ...
Epoch: 97 cost time: 1.0590620040893555
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.759 Test Loss: 0.644 Test Acc: 0.759
Validation loss decreased (-0.759253 --> -0.759253).  Saving model ...
Epoch: 98 cost time: 0.9374101161956787
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
Validation loss decreased (-0.759253 --> -0.762957).  Saving model ...
Epoch: 99 cost time: 1.0790600776672363
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
Validation loss decreased (-0.762957 --> -0.770364).  Saving model ...
Epoch: 100 cost time: 0.9716160297393799
Epoch: 100, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7703703703703704
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1331803798675537
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.836 Vali Acc: 0.163 Test Loss: 1.836 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.8498063087463379
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.827 Vali Acc: 0.178 Test Loss: 1.827 Test Acc: 0.178
Validation loss decreased (-0.162945 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.9640977382659912
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.819 Vali Acc: 0.189 Test Loss: 1.819 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.909538984298706
Epoch: 4, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.804 Vali Acc: 0.204 Test Loss: 1.804 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.9339077472686768
Epoch: 5, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.787 Vali Acc: 0.219 Test Loss: 1.787 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.9211292266845703
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.766 Vali Acc: 0.244 Test Loss: 1.766 Test Acc: 0.244
Validation loss decreased (-0.218501 --> -0.244427).  Saving model ...
Epoch: 7 cost time: 1.0179526805877686
Epoch: 7, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.743 Vali Acc: 0.270 Test Loss: 1.743 Test Acc: 0.270
Validation loss decreased (-0.244427 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 1.0508325099945068
Epoch: 8, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.719 Vali Acc: 0.307 Test Loss: 1.719 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 9 cost time: 1.1157958507537842
Epoch: 9, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.693 Vali Acc: 0.333 Test Loss: 1.693 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 10 cost time: 0.9813265800476074
Epoch: 10, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.667 Vali Acc: 0.352 Test Loss: 1.667 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 11 cost time: 0.9859755039215088
Epoch: 11, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.639 Vali Acc: 0.396 Test Loss: 1.639 Test Acc: 0.396
Validation loss decreased (-0.351835 --> -0.396280).  Saving model ...
Epoch: 12 cost time: 1.1070497035980225
Epoch: 12, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.610 Vali Acc: 0.422 Test Loss: 1.610 Test Acc: 0.422
Validation loss decreased (-0.396280 --> -0.422206).  Saving model ...
Epoch: 13 cost time: 1.0830395221710205
Epoch: 13, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.581 Vali Acc: 0.448 Test Loss: 1.581 Test Acc: 0.448
Validation loss decreased (-0.422206 --> -0.448132).  Saving model ...
Epoch: 14 cost time: 1.024256706237793
Epoch: 14, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.551 Vali Acc: 0.496 Test Loss: 1.551 Test Acc: 0.496
Validation loss decreased (-0.448132 --> -0.496281).  Saving model ...
Epoch: 15 cost time: 0.9784462451934814
Epoch: 15, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.520 Vali Acc: 0.537 Test Loss: 1.520 Test Acc: 0.537
Validation loss decreased (-0.496281 --> -0.537022).  Saving model ...
Epoch: 16 cost time: 0.9748249053955078
Epoch: 16, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.489 Vali Acc: 0.548 Test Loss: 1.489 Test Acc: 0.548
Validation loss decreased (-0.537022 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 1.0111167430877686
Epoch: 17, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.459 Vali Acc: 0.559 Test Loss: 1.459 Test Acc: 0.559
Validation loss decreased (-0.548133 --> -0.559245).  Saving model ...
Epoch: 18 cost time: 1.0427720546722412
Epoch: 18, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.429 Vali Acc: 0.556 Test Loss: 1.429 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9616117477416992
Epoch: 19, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.398 Vali Acc: 0.574 Test Loss: 1.398 Test Acc: 0.574
Validation loss decreased (-0.559245 --> -0.574060).  Saving model ...
Epoch: 20 cost time: 0.9751646518707275
Epoch: 20, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.368 Vali Acc: 0.581 Test Loss: 1.368 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 21 cost time: 0.9417874813079834
Epoch: 21, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 22 cost time: 0.955256462097168
Epoch: 22, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.309 Vali Acc: 0.589 Test Loss: 1.309 Test Acc: 0.589
Validation loss decreased (-0.581468 --> -0.588876).  Saving model ...
Epoch: 23 cost time: 0.9811630249023438
Epoch: 23, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.280 Vali Acc: 0.604 Test Loss: 1.280 Test Acc: 0.604
Validation loss decreased (-0.588876 --> -0.603691).  Saving model ...
Epoch: 24 cost time: 1.0066115856170654
Epoch: 24, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.252 Vali Acc: 0.626 Test Loss: 1.252 Test Acc: 0.626
Validation loss decreased (-0.603691 --> -0.625913).  Saving model ...
Epoch: 25 cost time: 1.0869724750518799
Epoch: 25, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.224 Vali Acc: 0.630 Test Loss: 1.224 Test Acc: 0.630
Validation loss decreased (-0.625913 --> -0.629617).  Saving model ...
Epoch: 26 cost time: 0.946110725402832
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 1.197 Vali Acc: 0.633 Test Loss: 1.197 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633321).  Saving model ...
Epoch: 27 cost time: 1.0684013366699219
Epoch: 27, Steps: 2 | Train Loss: 0.653 Vali Loss: 1.171 Vali Acc: 0.648 Test Loss: 1.171 Test Acc: 0.648
Validation loss decreased (-0.633321 --> -0.648136).  Saving model ...
Epoch: 28 cost time: 1.1018078327178955
Epoch: 28, Steps: 2 | Train Loss: 0.569 Vali Loss: 1.144 Vali Acc: 0.667 Test Loss: 1.144 Test Acc: 0.667
Validation loss decreased (-0.648136 --> -0.666655).  Saving model ...
Epoch: 29 cost time: 1.0579352378845215
Epoch: 29, Steps: 2 | Train Loss: 0.637 Vali Loss: 1.118 Vali Acc: 0.689 Test Loss: 1.118 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 30 cost time: 1.041910171508789
Epoch: 30, Steps: 2 | Train Loss: 0.544 Vali Loss: 1.091 Vali Acc: 0.693 Test Loss: 1.091 Test Acc: 0.693
Validation loss decreased (-0.688878 --> -0.692582).  Saving model ...
Epoch: 31 cost time: 1.035796880722046
Epoch: 31, Steps: 2 | Train Loss: 0.479 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.692582 --> -0.699989).  Saving model ...
Epoch: 32 cost time: 0.9731228351593018
Epoch: 32, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 1.0353505611419678
Epoch: 33, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.006 Vali Acc: 0.704 Test Loss: 1.006 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 34 cost time: 1.081040620803833
Epoch: 34, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711101).  Saving model ...
Epoch: 35 cost time: 1.0234730243682861
Epoch: 35, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.950 Vali Acc: 0.715 Test Loss: 0.950 Test Acc: 0.715
Validation loss decreased (-0.711101 --> -0.714805).  Saving model ...
Epoch: 36 cost time: 1.10137939453125
Epoch: 36, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.924 Vali Acc: 0.719 Test Loss: 0.924 Test Acc: 0.719
Validation loss decreased (-0.714805 --> -0.718509).  Saving model ...
Epoch: 37 cost time: 1.1002531051635742
Epoch: 37, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.899 Vali Acc: 0.715 Test Loss: 0.899 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1442792415618896
Epoch: 38, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 1.1057767868041992
Epoch: 39, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 40 cost time: 1.0869243144989014
Epoch: 40, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.843 Vali Acc: 0.722 Test Loss: 0.843 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 41 cost time: 1.0492806434631348
Epoch: 41, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.827 Vali Acc: 0.726 Test Loss: 0.827 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 42 cost time: 1.0966551303863525
Epoch: 42, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.810 Vali Acc: 0.730 Test Loss: 0.810 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 43 cost time: 1.076042890548706
Epoch: 43, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.794 Vali Acc: 0.733 Test Loss: 0.794 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733325).  Saving model ...
Epoch: 44 cost time: 1.0524353981018066
Epoch: 44, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.780 Vali Acc: 0.730 Test Loss: 0.780 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.018890142440796
Epoch: 45, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.764 Vali Acc: 0.733 Test Loss: 0.764 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 46 cost time: 0.9752092361450195
Epoch: 46, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.749 Vali Acc: 0.741 Test Loss: 0.749 Test Acc: 0.741
Validation loss decreased (-0.733326 --> -0.740733).  Saving model ...
Epoch: 47 cost time: 1.0482151508331299
Epoch: 47, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.736 Vali Acc: 0.748 Test Loss: 0.736 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748141).  Saving model ...
Epoch: 48 cost time: 1.214858055114746
Epoch: 48, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
Validation loss decreased (-0.748141 --> -0.755548).  Saving model ...
Epoch: 49 cost time: 1.0418314933776855
Epoch: 49, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.713 Vali Acc: 0.759 Test Loss: 0.713 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 50 cost time: 1.1674010753631592
Epoch: 50, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.703 Vali Acc: 0.759 Test Loss: 0.703 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 51 cost time: 1.002302646636963
Epoch: 51, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766660).  Saving model ...
Epoch: 52 cost time: 1.1053967475891113
Epoch: 52, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 53 cost time: 1.2051095962524414
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.670 Vali Acc: 0.774 Test Loss: 0.670 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 54 cost time: 1.1749634742736816
Epoch: 54, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.659 Vali Acc: 0.774 Test Loss: 0.659 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 55 cost time: 1.133671760559082
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.647 Vali Acc: 0.774 Test Loss: 0.647 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774068).  Saving model ...
Epoch: 56 cost time: 1.2452986240386963
Epoch: 56, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.635 Vali Acc: 0.770 Test Loss: 0.635 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1863796710968018
Epoch: 57, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.625 Vali Acc: 0.770 Test Loss: 0.625 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0998427867889404
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.617 Vali Acc: 0.770 Test Loss: 0.617 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2280805110931396
Epoch: 59, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0588667392730713
Epoch: 60, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9700615406036377
Epoch: 61, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.600 Vali Acc: 0.778 Test Loss: 0.600 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777772).  Saving model ...
Epoch: 62 cost time: 1.0956413745880127
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.596 Vali Acc: 0.778 Test Loss: 0.596 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 63 cost time: 1.162794589996338
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.781 Test Loss: 0.591 Test Acc: 0.781
Validation loss decreased (-0.777772 --> -0.781476).  Saving model ...
Epoch: 64 cost time: 1.160414695739746
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.588 Vali Acc: 0.781 Test Loss: 0.588 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 65 cost time: 1.1878776550292969
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.586 Vali Acc: 0.781 Test Loss: 0.586 Test Acc: 0.781
Validation loss decreased (-0.781476 --> -0.781476).  Saving model ...
Epoch: 66 cost time: 1.3099138736724854
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.781476 --> -0.788883).  Saving model ...
Epoch: 67 cost time: 1.234123945236206
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 68 cost time: 1.1262409687042236
Epoch: 68, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 69 cost time: 1.1264877319335938
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 70 cost time: 1.2261333465576172
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.785 Test Loss: 0.579 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.164487361907959
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.577 Vali Acc: 0.785 Test Loss: 0.577 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.3048110008239746
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.574 Vali Acc: 0.785 Test Loss: 0.574 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.137253761291504
Epoch: 73, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.785 Test Loss: 0.571 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.0785801410675049
Epoch: 74, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.568 Vali Acc: 0.785 Test Loss: 0.568 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.1536319255828857
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.785 Test Loss: 0.566 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.182685375213623
Epoch: 76, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.563 Vali Acc: 0.785 Test Loss: 0.563 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.0710716247558594
Epoch: 77, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.559 Vali Acc: 0.785 Test Loss: 0.559 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.0148162841796875
Epoch: 78, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.785 Test Loss: 0.556 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.1518616676330566
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.785 Test Loss: 0.553 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7888888888888889
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.610063314437866
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.835 Vali Acc: 0.230 Test Loss: 1.835 Test Acc: 0.230
Validation loss decreased (inf --> -0.229611).  Saving model ...
Epoch: 2 cost time: 1.099966287612915
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.830 Vali Acc: 0.230 Test Loss: 1.830 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.9690909385681152
Epoch: 3, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.823 Vali Acc: 0.230 Test Loss: 1.823 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 1.0801410675048828
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.809 Vali Acc: 0.241 Test Loss: 1.809 Test Acc: 0.241
Validation loss decreased (-0.229611 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.0899500846862793
Epoch: 5, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.791 Vali Acc: 0.252 Test Loss: 1.791 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 1.1314241886138916
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.769 Vali Acc: 0.270 Test Loss: 1.769 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 7 cost time: 1.0597915649414062
Epoch: 7, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.744 Vali Acc: 0.270 Test Loss: 1.744 Test Acc: 0.270
Validation loss decreased (-0.270353 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 1.0247414112091064
Epoch: 8, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.717 Vali Acc: 0.300 Test Loss: 1.717 Test Acc: 0.300
Validation loss decreased (-0.270353 --> -0.299983).  Saving model ...
Epoch: 9 cost time: 0.9834527969360352
Epoch: 9, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.685 Vali Acc: 0.337 Test Loss: 1.685 Test Acc: 0.337
Validation loss decreased (-0.299983 --> -0.337020).  Saving model ...
Epoch: 10 cost time: 1.0550589561462402
Epoch: 10, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.653 Vali Acc: 0.356 Test Loss: 1.653 Test Acc: 0.356
Validation loss decreased (-0.337020 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 1.005544662475586
Epoch: 11, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.619 Vali Acc: 0.381 Test Loss: 1.619 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 12 cost time: 1.0850794315338135
Epoch: 12, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.582 Vali Acc: 0.407 Test Loss: 1.582 Test Acc: 0.407
Validation loss decreased (-0.381465 --> -0.407392).  Saving model ...
Epoch: 13 cost time: 1.0257079601287842
Epoch: 13, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.545 Vali Acc: 0.437 Test Loss: 1.545 Test Acc: 0.437
Validation loss decreased (-0.407392 --> -0.437022).  Saving model ...
Epoch: 14 cost time: 1.0800809860229492
Epoch: 14, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.506 Vali Acc: 0.470 Test Loss: 1.506 Test Acc: 0.470
Validation loss decreased (-0.437022 --> -0.470355).  Saving model ...
Epoch: 15 cost time: 1.108647108078003
Epoch: 15, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.465 Vali Acc: 0.496 Test Loss: 1.465 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496282).  Saving model ...
Epoch: 16 cost time: 1.1011061668395996
Epoch: 16, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.422 Vali Acc: 0.526 Test Loss: 1.422 Test Acc: 0.526
Validation loss decreased (-0.496282 --> -0.525912).  Saving model ...
Epoch: 17 cost time: 1.1043283939361572
Epoch: 17, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.379 Vali Acc: 0.537 Test Loss: 1.379 Test Acc: 0.537
Validation loss decreased (-0.525912 --> -0.537023).  Saving model ...
Epoch: 18 cost time: 1.0488293170928955
Epoch: 18, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.335 Vali Acc: 0.574 Test Loss: 1.335 Test Acc: 0.574
Validation loss decreased (-0.537023 --> -0.574061).  Saving model ...
Epoch: 19 cost time: 1.0030064582824707
Epoch: 19, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.291 Vali Acc: 0.585 Test Loss: 1.291 Test Acc: 0.585
Validation loss decreased (-0.574061 --> -0.585172).  Saving model ...
Epoch: 20 cost time: 1.062035322189331
Epoch: 20, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.245 Vali Acc: 0.607 Test Loss: 1.245 Test Acc: 0.607
Validation loss decreased (-0.585172 --> -0.607395).  Saving model ...
Epoch: 21 cost time: 0.9817380905151367
Epoch: 21, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.200 Vali Acc: 0.656 Test Loss: 1.200 Test Acc: 0.656
Validation loss decreased (-0.607395 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 1.0386285781860352
Epoch: 22, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.154 Vali Acc: 0.678 Test Loss: 1.154 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677766).  Saving model ...
Epoch: 23 cost time: 1.018822431564331
Epoch: 23, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.110 Vali Acc: 0.707 Test Loss: 1.110 Test Acc: 0.707
Validation loss decreased (-0.677766 --> -0.707396).  Saving model ...
Epoch: 24 cost time: 1.017714500427246
Epoch: 24, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.067 Vali Acc: 0.711 Test Loss: 1.067 Test Acc: 0.711
Validation loss decreased (-0.707396 --> -0.711100).  Saving model ...
Epoch: 25 cost time: 0.99578857421875
Epoch: 25, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.023 Vali Acc: 0.730 Test Loss: 1.023 Test Acc: 0.730
Validation loss decreased (-0.711100 --> -0.729619).  Saving model ...
Epoch: 26 cost time: 1.086613655090332
Epoch: 26, Steps: 2 | Train Loss: 1.073 Vali Loss: 0.981 Vali Acc: 0.748 Test Loss: 0.981 Test Acc: 0.748
Validation loss decreased (-0.729619 --> -0.748138).  Saving model ...
Epoch: 27 cost time: 1.0352153778076172
Epoch: 27, Steps: 2 | Train Loss: 1.055 Vali Loss: 0.939 Vali Acc: 0.759 Test Loss: 0.939 Test Acc: 0.759
Validation loss decreased (-0.748138 --> -0.759250).  Saving model ...
Epoch: 28 cost time: 0.9932522773742676
Epoch: 28, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.900 Vali Acc: 0.781 Test Loss: 0.900 Test Acc: 0.781
Validation loss decreased (-0.759250 --> -0.781472).  Saving model ...
Epoch: 29 cost time: 1.0777928829193115
Epoch: 29, Steps: 2 | Train Loss: 1.095 Vali Loss: 0.860 Vali Acc: 0.796 Test Loss: 0.860 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796288).  Saving model ...
Epoch: 30 cost time: 0.9471604824066162
Epoch: 30, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
Validation loss decreased (-0.796288 --> -0.803695).  Saving model ...
Epoch: 31 cost time: 0.9826960563659668
Epoch: 31, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0647151470184326
Epoch: 32, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.751 Vali Acc: 0.804 Test Loss: 0.751 Test Acc: 0.804
Validation loss decreased (-0.803695 --> -0.803696).  Saving model ...
Epoch: 33 cost time: 1.0998733043670654
Epoch: 33, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.715 Vali Acc: 0.815 Test Loss: 0.715 Test Acc: 0.815
Validation loss decreased (-0.803696 --> -0.814808).  Saving model ...
Epoch: 34 cost time: 1.0462453365325928
Epoch: 34, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 35 cost time: 1.0911097526550293
Epoch: 35, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
Validation loss decreased (-0.818512 --> -0.833327).  Saving model ...
Epoch: 36 cost time: 1.1327369213104248
Epoch: 36, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.615 Vali Acc: 0.830 Test Loss: 0.615 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0971753597259521
Epoch: 37, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 38 cost time: 1.138474702835083
Epoch: 38, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 39 cost time: 1.0713608264923096
Epoch: 39, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 40 cost time: 1.1154372692108154
Epoch: 40, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.504 Vali Acc: 0.852 Test Loss: 0.504 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 41 cost time: 1.0421051979064941
Epoch: 41, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859254).  Saving model ...
Epoch: 42 cost time: 1.13505220413208
Epoch: 42, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 43 cost time: 0.9419045448303223
Epoch: 43, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 44 cost time: 1.0914156436920166
Epoch: 44, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.439 Vali Acc: 0.874 Test Loss: 0.439 Test Acc: 0.874
Validation loss decreased (-0.866662 --> -0.874070).  Saving model ...
Epoch: 45 cost time: 1.0519211292266846
Epoch: 45, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.430 Vali Acc: 0.867 Test Loss: 0.430 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0034170150756836
Epoch: 46, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1562068462371826
Epoch: 47, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.404 Vali Acc: 0.874 Test Loss: 0.404 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 48 cost time: 1.2140493392944336
Epoch: 48, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.383 Vali Acc: 0.881 Test Loss: 0.383 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881478).  Saving model ...
Epoch: 49 cost time: 1.0879688262939453
Epoch: 49, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.360 Vali Acc: 0.893 Test Loss: 0.360 Test Acc: 0.893
Validation loss decreased (-0.881478 --> -0.892589).  Saving model ...
Epoch: 50 cost time: 1.1218457221984863
Epoch: 50, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.340 Vali Acc: 0.893 Test Loss: 0.340 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 51 cost time: 1.1671757698059082
Epoch: 51, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899997).  Saving model ...
Epoch: 52 cost time: 1.153975486755371
Epoch: 52, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 53 cost time: 1.1539583206176758
Epoch: 53, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.293 Vali Acc: 0.907 Test Loss: 0.293 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 54 cost time: 1.1105444431304932
Epoch: 54, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.283 Vali Acc: 0.907 Test Loss: 0.283 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 55 cost time: 1.1837241649627686
Epoch: 55, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 56 cost time: 1.0437805652618408
Epoch: 56, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 57 cost time: 1.3198249340057373
Epoch: 57, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.907 Test Loss: 0.267 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 58 cost time: 0.9962193965911865
Epoch: 58, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.266 Vali Acc: 0.907 Test Loss: 0.266 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 59 cost time: 1.0561518669128418
Epoch: 59, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1977646350860596
Epoch: 60, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1885862350463867
Epoch: 61, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.163224220275879
Epoch: 62, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.2346601486206055
Epoch: 63, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3084049224853516
Epoch: 64, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2688381671905518
Epoch: 65, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.907 Test Loss: 0.268 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.1810669898986816
Epoch: 66, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 67 cost time: 1.2454833984375
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 68 cost time: 1.2703802585601807
Epoch: 68, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 69 cost time: 1.1332855224609375
Epoch: 69, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 70 cost time: 1.2754874229431152
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 71 cost time: 1.1564936637878418
Epoch: 71, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 72 cost time: 1.201211929321289
Epoch: 72, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 73 cost time: 1.2234385013580322
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 74 cost time: 1.2494442462921143
Epoch: 74, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2921884059906006
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.2385168075561523
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 77 cost time: 1.2300634384155273
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.2807254791259766
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.326293706893921
Epoch: 79, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.252 Vali Acc: 0.915 Test Loss: 0.252 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.2995872497558594
Epoch: 80, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.248568058013916
Epoch: 81, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.915 Test Loss: 0.256 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.1658635139465332
Epoch: 82, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.907 Test Loss: 0.258 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.1896321773529053
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.907 Test Loss: 0.259 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.1162092685699463
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.0689952373504639
Epoch: 85, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.1269793510437012
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5207481384277344
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.879 Vali Acc: 0.156 Test Loss: 1.879 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.1953198909759521
Epoch: 2, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.874 Vali Acc: 0.163 Test Loss: 1.874 Test Acc: 0.163
Validation loss decreased (-0.155537 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 0.9882245063781738
Epoch: 3, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.867 Vali Acc: 0.163 Test Loss: 1.867 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 1.1380360126495361
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.851 Vali Acc: 0.181 Test Loss: 1.851 Test Acc: 0.181
Validation loss decreased (-0.162944 --> -0.181463).  Saving model ...
Epoch: 5 cost time: 1.1033716201782227
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.830 Vali Acc: 0.185 Test Loss: 1.830 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 1.0187530517578125
Epoch: 6, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.806 Vali Acc: 0.211 Test Loss: 1.806 Test Acc: 0.211
Validation loss decreased (-0.185167 --> -0.211093).  Saving model ...
Epoch: 7 cost time: 1.0357427597045898
Epoch: 7, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.777 Vali Acc: 0.233 Test Loss: 1.777 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233316).  Saving model ...
Epoch: 8 cost time: 0.9497299194335938
Epoch: 8, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.745 Vali Acc: 0.278 Test Loss: 1.745 Test Acc: 0.278
Validation loss decreased (-0.233316 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 1.0558607578277588
Epoch: 9, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.710 Vali Acc: 0.315 Test Loss: 1.710 Test Acc: 0.315
Validation loss decreased (-0.277760 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.9459223747253418
Epoch: 10, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.673 Vali Acc: 0.337 Test Loss: 1.673 Test Acc: 0.337
Validation loss decreased (-0.314798 --> -0.337020).  Saving model ...
Epoch: 11 cost time: 1.0932250022888184
Epoch: 11, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.633 Vali Acc: 0.374 Test Loss: 1.633 Test Acc: 0.374
Validation loss decreased (-0.337020 --> -0.374058).  Saving model ...
Epoch: 12 cost time: 1.0131566524505615
Epoch: 12, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.590 Vali Acc: 0.444 Test Loss: 1.590 Test Acc: 0.444
Validation loss decreased (-0.374058 --> -0.444429).  Saving model ...
Epoch: 13 cost time: 1.012580156326294
Epoch: 13, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.545 Vali Acc: 0.493 Test Loss: 1.545 Test Acc: 0.493
Validation loss decreased (-0.444429 --> -0.492577).  Saving model ...
Epoch: 14 cost time: 1.076948642730713
Epoch: 14, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.498 Vali Acc: 0.526 Test Loss: 1.498 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 15 cost time: 1.095372200012207
Epoch: 15, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.449 Vali Acc: 0.567 Test Loss: 1.449 Test Acc: 0.567
Validation loss decreased (-0.525911 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 1.2009170055389404
Epoch: 16, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.400 Vali Acc: 0.600 Test Loss: 1.400 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 17 cost time: 1.1933224201202393
Epoch: 17, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 1.1168382167816162
Epoch: 18, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.302 Vali Acc: 0.644 Test Loss: 1.302 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644431).  Saving model ...
Epoch: 19 cost time: 1.1399564743041992
Epoch: 19, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.252 Vali Acc: 0.656 Test Loss: 1.252 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 1.1225876808166504
Epoch: 20, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.204 Vali Acc: 0.663 Test Loss: 1.204 Test Acc: 0.663
Validation loss decreased (-0.655543 --> -0.662951).  Saving model ...
Epoch: 21 cost time: 1.3064689636230469
Epoch: 21, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.157 Vali Acc: 0.670 Test Loss: 1.157 Test Acc: 0.670
Validation loss decreased (-0.662951 --> -0.670359).  Saving model ...
Epoch: 22 cost time: 1.1758592128753662
Epoch: 22, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.670359 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 1.228196144104004
Epoch: 23, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.067 Vali Acc: 0.681 Test Loss: 1.067 Test Acc: 0.681
Validation loss decreased (-0.677767 --> -0.681471).  Saving model ...
Epoch: 24 cost time: 1.0545239448547363
Epoch: 24, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.024 Vali Acc: 0.704 Test Loss: 1.024 Test Acc: 0.704
Validation loss decreased (-0.681471 --> -0.703693).  Saving model ...
Epoch: 25 cost time: 1.0282354354858398
Epoch: 25, Steps: 2 | Train Loss: 1.231 Vali Loss: 0.980 Vali Acc: 0.722 Test Loss: 0.980 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722212).  Saving model ...
Epoch: 26 cost time: 1.062082290649414
Epoch: 26, Steps: 2 | Train Loss: 1.235 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 27 cost time: 1.118116855621338
Epoch: 27, Steps: 2 | Train Loss: 1.061 Vali Loss: 0.898 Vali Acc: 0.756 Test Loss: 0.898 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 28 cost time: 1.0388309955596924
Epoch: 28, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.858 Vali Acc: 0.770 Test Loss: 0.858 Test Acc: 0.770
Validation loss decreased (-0.755547 --> -0.770362).  Saving model ...
Epoch: 29 cost time: 1.0852811336517334
Epoch: 29, Steps: 2 | Train Loss: 1.064 Vali Loss: 0.820 Vali Acc: 0.785 Test Loss: 0.820 Test Acc: 0.785
Validation loss decreased (-0.770362 --> -0.785177).  Saving model ...
Epoch: 30 cost time: 1.1105022430419922
Epoch: 30, Steps: 2 | Train Loss: 1.090 Vali Loss: 0.784 Vali Acc: 0.804 Test Loss: 0.784 Test Acc: 0.804
Validation loss decreased (-0.785177 --> -0.803696).  Saving model ...
Epoch: 31 cost time: 1.1952364444732666
Epoch: 31, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.749 Vali Acc: 0.807 Test Loss: 0.749 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807400).  Saving model ...
Epoch: 32 cost time: 1.059065818786621
Epoch: 32, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 33 cost time: 1.0979933738708496
Epoch: 33, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
Validation loss decreased (-0.811104 --> -0.818512).  Saving model ...
Epoch: 34 cost time: 0.9813699722290039
Epoch: 34, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.646 Vali Acc: 0.837 Test Loss: 0.646 Test Acc: 0.837
Validation loss decreased (-0.818512 --> -0.837031).  Saving model ...
Epoch: 35 cost time: 1.2860755920410156
Epoch: 35, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.613 Vali Acc: 0.848 Test Loss: 0.613 Test Acc: 0.848
Validation loss decreased (-0.837031 --> -0.848142).  Saving model ...
Epoch: 36 cost time: 1.0172154903411865
Epoch: 36, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.582 Vali Acc: 0.852 Test Loss: 0.582 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851846).  Saving model ...
Epoch: 37 cost time: 1.0142550468444824
Epoch: 37, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.553 Vali Acc: 0.852 Test Loss: 0.553 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 38 cost time: 0.9948194026947021
Epoch: 38, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
Validation loss decreased (-0.851846 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 1.0011577606201172
Epoch: 39, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.496 Vali Acc: 0.881 Test Loss: 0.496 Test Acc: 0.881
Validation loss decreased (-0.866661 --> -0.881477).  Saving model ...
Epoch: 40 cost time: 1.164851188659668
Epoch: 40, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.473 Vali Acc: 0.874 Test Loss: 0.473 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0388498306274414
Epoch: 41, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0268561840057373
Epoch: 42, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.426 Vali Acc: 0.881 Test Loss: 0.426 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 43 cost time: 1.0966849327087402
Epoch: 43, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.405 Vali Acc: 0.881 Test Loss: 0.405 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 44 cost time: 1.10066556930542
Epoch: 44, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
Epoch: 45 cost time: 1.0272023677825928
Epoch: 45, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.9991931915283203
Epoch: 46, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.335 Vali Acc: 0.904 Test Loss: 0.335 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 47 cost time: 1.1225495338439941
Epoch: 47, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.315 Vali Acc: 0.915 Test Loss: 0.315 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914812).  Saving model ...
Epoch: 48 cost time: 0.9928169250488281
Epoch: 48, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 1.0465595722198486
Epoch: 49, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 1.1010327339172363
Epoch: 50, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.9948470592498779
Epoch: 51, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.9864017963409424
Epoch: 52, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.050795316696167
Epoch: 53, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 1.0024504661560059
Epoch: 54, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9987103939056396
Epoch: 55, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.95292067527771
Epoch: 56, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0572738647460938
Epoch: 57, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 58 cost time: 1.252530574798584
Epoch: 58, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0677714347839355
Epoch: 59, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2365589141845703
Epoch: 60, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1642003059387207
Epoch: 61, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.2616100311279297
Epoch: 62, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 63 cost time: 1.203641414642334
Epoch: 63, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 1.2179210186004639
Epoch: 64, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2216944694519043
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 66 cost time: 1.0874965190887451
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 67 cost time: 1.2247490882873535
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1532750129699707
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2145559787750244
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.197139024734497
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.092264175415039
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.144449234008789
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.179100751876831
Epoch: 73, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 74 cost time: 1.1638736724853516
Epoch: 74, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1984405517578125
Epoch: 75, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.2989439964294434
Epoch: 76, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.2174875736236572
Epoch: 77, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.058624505996704
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.1616721153259277
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.1172394752502441
Epoch: 80, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.1423664093017578
Epoch: 81, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.0548782348632812
Epoch: 82, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.0607857704162598
Epoch: 83, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3848876953125
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0150885581970215
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1281068325042725
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.1799890995025635
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.9712111949920654
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0783376693725586
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.023604393005371
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9941127300262451
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.077007532119751
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9683682918548584
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.083651065826416
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0855677127838135
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 0.9870855808258057
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.1281967163085938
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.202521800994873
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.2483012676239014
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.2769801616668701
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3693621158599854
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.2263195514678955
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.261725664138794
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 1.1671092510223389
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.2359097003936768
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.0878527164459229
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.1056427955627441
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.210738182067871
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.0749123096466064
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.0830168724060059
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1860229969024658
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3423690795898438
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2388901710510254
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.2104084491729736
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.3603665828704834
Epoch: 32, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.1696398258209229
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.1406562328338623
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.25118088722229
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1020054817199707
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.153918743133545
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0213375091552734
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.0839605331420898
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.0748708248138428
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3320164680480957
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.3336153030395508
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.2268507480621338
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.2125270366668701
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2054860591888428
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1488475799560547
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2438044548034668
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1178076267242432
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.026853084564209
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0413968563079834
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.3473007678985596
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.1375384330749512
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.247751235961914
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.0296800136566162
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.2187154293060303
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.243453025817871
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.142543077468872
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2460706233978271
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.3471581935882568
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.3548047542572021
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.2504909038543701
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.0778586864471436
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.1136138439178467
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.2853035926818848
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1155478954315186
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.066061019897461
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.091515302658081
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.237915277481079
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.14039945602417
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 0.9973912239074707
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.066136360168457
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.055595874786377
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.119554042816162
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.134584665298462
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.0784938335418701
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.0760657787322998
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 0.9159715175628662
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.018301010131836
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.044938087463379
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.1377315521240234
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2691965103149414
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.1279783248901367
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.0560951232910156
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.1183886528015137
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.1943387985229492
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.153918981552124
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.193910837173462
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.1138529777526855
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.0478980541229248
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.047710657119751
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.1000440120697021
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9900708198547363
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.177321195602417
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.0711390972137451
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.2581188678741455
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.2556161880493164
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.0041124820709229
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.161085605621338
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.189143419265747
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.1335222721099854
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 946374
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.449090003967285
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.880 Vali Acc: 0.115 Test Loss: 1.880 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.9161355495452881
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.854 Vali Acc: 0.133 Test Loss: 1.854 Test Acc: 0.133
Validation loss decreased (-0.114796 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.9484174251556396
Epoch: 3, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.828 Vali Acc: 0.163 Test Loss: 1.828 Test Acc: 0.163
Validation loss decreased (-0.133315 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.0793845653533936
Epoch: 4, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.792 Vali Acc: 0.196 Test Loss: 1.792 Test Acc: 0.196
Validation loss decreased (-0.162945 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.9846594333648682
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.746 Vali Acc: 0.244 Test Loss: 1.746 Test Acc: 0.244
Validation loss decreased (-0.196278 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 0.8413310050964355
Epoch: 6, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.694 Vali Acc: 0.311 Test Loss: 1.694 Test Acc: 0.311
Validation loss decreased (-0.244427 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.9026241302490234
Epoch: 7, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.637 Vali Acc: 0.370 Test Loss: 1.637 Test Acc: 0.370
Validation loss decreased (-0.311094 --> -0.370354).  Saving model ...
Epoch: 8 cost time: 1.0475983619689941
Epoch: 8, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.575 Vali Acc: 0.463 Test Loss: 1.575 Test Acc: 0.463
Validation loss decreased (-0.370354 --> -0.462947).  Saving model ...
Epoch: 9 cost time: 1.1138570308685303
Epoch: 9, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.512 Vali Acc: 0.552 Test Loss: 1.512 Test Acc: 0.552
Validation loss decreased (-0.462947 --> -0.551837).  Saving model ...
Epoch: 10 cost time: 1.0017619132995605
Epoch: 10, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.446 Vali Acc: 0.600 Test Loss: 1.446 Test Acc: 0.600
Validation loss decreased (-0.551837 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 0.8892233371734619
Epoch: 11, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.381 Vali Acc: 0.648 Test Loss: 1.381 Test Acc: 0.648
Validation loss decreased (-0.599986 --> -0.648134).  Saving model ...
Epoch: 12 cost time: 0.9731383323669434
Epoch: 12, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.316 Vali Acc: 0.685 Test Loss: 1.316 Test Acc: 0.685
Validation loss decreased (-0.648134 --> -0.685172).  Saving model ...
Epoch: 13 cost time: 1.1451654434204102
Epoch: 13, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.251 Vali Acc: 0.704 Test Loss: 1.251 Test Acc: 0.704
Validation loss decreased (-0.685172 --> -0.703691).  Saving model ...
Epoch: 14 cost time: 0.9824352264404297
Epoch: 14, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.187 Vali Acc: 0.741 Test Loss: 1.187 Test Acc: 0.741
Validation loss decreased (-0.703691 --> -0.740729).  Saving model ...
Epoch: 15 cost time: 1.1194262504577637
Epoch: 15, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.127 Vali Acc: 0.756 Test Loss: 1.127 Test Acc: 0.756
Validation loss decreased (-0.740729 --> -0.755544).  Saving model ...
Epoch: 16 cost time: 1.032315969467163
Epoch: 16, Steps: 2 | Train Loss: 0.773 Vali Loss: 1.069 Vali Acc: 0.756 Test Loss: 1.069 Test Acc: 0.756
Validation loss decreased (-0.755544 --> -0.755545).  Saving model ...
Epoch: 17 cost time: 1.005660057067871
Epoch: 17, Steps: 2 | Train Loss: 0.737 Vali Loss: 1.015 Vali Acc: 0.763 Test Loss: 1.015 Test Acc: 0.763
Validation loss decreased (-0.755545 --> -0.762953).  Saving model ...
Epoch: 18 cost time: 1.0361218452453613
Epoch: 18, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.964 Vali Acc: 0.770 Test Loss: 0.964 Test Acc: 0.770
Validation loss decreased (-0.762953 --> -0.770361).  Saving model ...
Epoch: 19 cost time: 0.9674944877624512
Epoch: 19, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.917 Vali Acc: 0.793 Test Loss: 0.917 Test Acc: 0.793
Validation loss decreased (-0.770361 --> -0.792583).  Saving model ...
Epoch: 20 cost time: 0.9598619937896729
Epoch: 20, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.0303118228912354
Epoch: 21, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.833 Vali Acc: 0.793 Test Loss: 0.833 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0577542781829834
Epoch: 22, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.797 Vali Acc: 0.796 Test Loss: 0.797 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1740193367004395
Epoch: 23, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.765 Vali Acc: 0.796 Test Loss: 0.765 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1636998653411865
Epoch: 24, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.737 Vali Acc: 0.793 Test Loss: 0.737 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.178922414779663
Epoch: 25, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.1466326713562012
Epoch: 26, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 1.0749573707580566
Epoch: 27, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.674 Vali Acc: 0.804 Test Loss: 0.674 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 28 cost time: 1.2182166576385498
Epoch: 28, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 29 cost time: 1.0544769763946533
Epoch: 29, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 30 cost time: 0.9277298450469971
Epoch: 30, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.632 Vali Acc: 0.807 Test Loss: 0.632 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 31 cost time: 1.1281406879425049
Epoch: 31, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.621 Vali Acc: 0.811 Test Loss: 0.621 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 1.1093730926513672
Epoch: 32, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 33 cost time: 1.0267484188079834
Epoch: 33, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 34 cost time: 1.1122231483459473
Epoch: 34, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.602 Vali Acc: 0.815 Test Loss: 0.602 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 35 cost time: 1.1036713123321533
Epoch: 35, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 36 cost time: 1.1400651931762695
Epoch: 36, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.594 Vali Acc: 0.815 Test Loss: 0.594 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 37 cost time: 1.015737533569336
Epoch: 37, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.591 Vali Acc: 0.815 Test Loss: 0.591 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 38 cost time: 1.0357565879821777
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 39 cost time: 1.0107572078704834
Epoch: 39, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.586 Vali Acc: 0.815 Test Loss: 0.586 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 40 cost time: 1.039168119430542
Epoch: 40, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.584 Vali Acc: 0.815 Test Loss: 0.584 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 41 cost time: 1.1311068534851074
Epoch: 41, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 1.088515043258667
Epoch: 42, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 43 cost time: 1.109786033630371
Epoch: 43, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 44 cost time: 1.0405519008636475
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 45 cost time: 1.1136975288391113
Epoch: 45, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 46 cost time: 1.09140944480896
Epoch: 46, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 47 cost time: 1.0047461986541748
Epoch: 47, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0384109020233154
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1479380130767822
Epoch: 49, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1530301570892334
Epoch: 50, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 51 cost time: 1.1319189071655273
Epoch: 51, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 52 cost time: 1.2358381748199463
Epoch: 52, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 53 cost time: 1.3432509899139404
Epoch: 53, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 54 cost time: 1.1789989471435547
Epoch: 54, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 55 cost time: 1.111070156097412
Epoch: 55, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 56 cost time: 1.0857353210449219
Epoch: 56, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 57 cost time: 1.0653653144836426
Epoch: 57, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 58 cost time: 0.9570796489715576
Epoch: 58, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 59 cost time: 0.969822883605957
Epoch: 59, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 60 cost time: 0.9524633884429932
Epoch: 60, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 61 cost time: 1.099215030670166
Epoch: 61, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 62 cost time: 1.013124704360962
Epoch: 62, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 63 cost time: 1.071368932723999
Epoch: 63, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.830 Test Loss: 0.541 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 64 cost time: 1.0613434314727783
Epoch: 64, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.539 Vali Acc: 0.830 Test Loss: 0.539 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 65 cost time: 1.0855820178985596
Epoch: 65, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 66 cost time: 1.003873586654663
Epoch: 66, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 67 cost time: 1.0716707706451416
Epoch: 67, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 68 cost time: 0.9925699234008789
Epoch: 68, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 1.0133824348449707
Epoch: 69, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 1.0380983352661133
Epoch: 70, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 71 cost time: 0.9532275199890137
Epoch: 71, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 0.9939939975738525
Epoch: 72, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 73 cost time: 0.9292926788330078
Epoch: 73, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 74 cost time: 0.9546964168548584
Epoch: 74, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 75 cost time: 1.02048659324646
Epoch: 75, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 76 cost time: 1.084996223449707
Epoch: 76, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 77 cost time: 1.029649257659912
Epoch: 77, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840736).  Saving model ...
Epoch: 78 cost time: 1.1979081630706787
Epoch: 78, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 79 cost time: 1.0562405586242676
Epoch: 79, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 80 cost time: 1.145608901977539
Epoch: 80, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 81 cost time: 0.9665169715881348
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 82 cost time: 1.03725266456604
Epoch: 82, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 83 cost time: 1.139786958694458
Epoch: 83, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 84 cost time: 1.0835518836975098
Epoch: 84, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 85 cost time: 1.0396308898925781
Epoch: 85, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 86 cost time: 0.9443373680114746
Epoch: 86, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 87 cost time: 1.0048308372497559
Epoch: 87, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 88 cost time: 1.0193371772766113
Epoch: 88, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 89 cost time: 1.1620373725891113
Epoch: 89, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 90 cost time: 1.1359031200408936
Epoch: 90, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 91 cost time: 1.0734362602233887
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 92 cost time: 1.1195347309112549
Epoch: 92, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
Validation loss decreased (-0.840736 --> -0.848143).  Saving model ...
Epoch: 93 cost time: 1.1159634590148926
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 94 cost time: 1.1570911407470703
Epoch: 94, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 95 cost time: 1.2259879112243652
Epoch: 95, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 96 cost time: 1.1976022720336914
Epoch: 96, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 97 cost time: 1.231395959854126
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 98 cost time: 1.1107561588287354
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 99 cost time: 1.1726691722869873
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 100 cost time: 1.048919916152954
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.345191717147827
Epoch: 1, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.911 Vali Acc: 0.119 Test Loss: 1.911 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 1.0132765769958496
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.889 Vali Acc: 0.130 Test Loss: 1.889 Test Acc: 0.130
Validation loss decreased (-0.118499 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.1050546169281006
Epoch: 3, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.868 Vali Acc: 0.141 Test Loss: 1.868 Test Acc: 0.141
Validation loss decreased (-0.129611 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 1.0985691547393799
Epoch: 4, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.839 Vali Acc: 0.148 Test Loss: 1.839 Test Acc: 0.148
Validation loss decreased (-0.140722 --> -0.148130).  Saving model ...
Epoch: 5 cost time: 1.0067377090454102
Epoch: 5, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.802 Vali Acc: 0.178 Test Loss: 1.802 Test Acc: 0.178
Validation loss decreased (-0.148130 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.9827380180358887
Epoch: 6, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.761 Vali Acc: 0.222 Test Loss: 1.761 Test Acc: 0.222
Validation loss decreased (-0.177760 --> -0.222205).  Saving model ...
Epoch: 7 cost time: 1.0758306980133057
Epoch: 7, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.715 Vali Acc: 0.256 Test Loss: 1.715 Test Acc: 0.256
Validation loss decreased (-0.222205 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 1.1716949939727783
Epoch: 8, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.667 Vali Acc: 0.289 Test Loss: 1.667 Test Acc: 0.289
Validation loss decreased (-0.255538 --> -0.288872).  Saving model ...
Epoch: 9 cost time: 1.079026460647583
Epoch: 9, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.617 Vali Acc: 0.341 Test Loss: 1.617 Test Acc: 0.341
Validation loss decreased (-0.288872 --> -0.340725).  Saving model ...
Epoch: 10 cost time: 1.000187635421753
Epoch: 10, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.566 Vali Acc: 0.393 Test Loss: 1.566 Test Acc: 0.393
Validation loss decreased (-0.340725 --> -0.392577).  Saving model ...
Epoch: 11 cost time: 0.8818504810333252
Epoch: 11, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
Validation loss decreased (-0.392577 --> -0.488874).  Saving model ...
Epoch: 12 cost time: 0.9816081523895264
Epoch: 12, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.462 Vali Acc: 0.552 Test Loss: 1.462 Test Acc: 0.552
Validation loss decreased (-0.488874 --> -0.551837).  Saving model ...
Epoch: 13 cost time: 0.9669771194458008
Epoch: 13, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.408 Vali Acc: 0.596 Test Loss: 1.408 Test Acc: 0.596
Validation loss decreased (-0.551837 --> -0.596282).  Saving model ...
Epoch: 14 cost time: 1.1155025959014893
Epoch: 14, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.357 Vali Acc: 0.611 Test Loss: 1.357 Test Acc: 0.611
Validation loss decreased (-0.596282 --> -0.611098).  Saving model ...
Epoch: 15 cost time: 0.8368759155273438
Epoch: 15, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.307 Vali Acc: 0.644 Test Loss: 1.307 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644431).  Saving model ...
Epoch: 16 cost time: 0.9265234470367432
Epoch: 16, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 17 cost time: 1.0571801662445068
Epoch: 17, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.211 Vali Acc: 0.656 Test Loss: 1.211 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 18 cost time: 1.0905065536499023
Epoch: 18, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.166 Vali Acc: 0.659 Test Loss: 1.166 Test Acc: 0.659
Validation loss decreased (-0.655543 --> -0.659248).  Saving model ...
Epoch: 19 cost time: 1.043623924255371
Epoch: 19, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.124 Vali Acc: 0.674 Test Loss: 1.124 Test Acc: 0.674
Validation loss decreased (-0.659248 --> -0.674063).  Saving model ...
Epoch: 20 cost time: 1.0545902252197266
Epoch: 20, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.083 Vali Acc: 0.674 Test Loss: 1.083 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 21 cost time: 0.948836088180542
Epoch: 21, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.046 Vali Acc: 0.685 Test Loss: 1.046 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685175).  Saving model ...
Epoch: 22 cost time: 1.3071930408477783
Epoch: 22, Steps: 2 | Train Loss: 0.474 Vali Loss: 1.009 Vali Acc: 0.685 Test Loss: 1.009 Test Acc: 0.685
Validation loss decreased (-0.685175 --> -0.685175).  Saving model ...
Epoch: 23 cost time: 1.1163535118103027
Epoch: 23, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.976 Vali Acc: 0.689 Test Loss: 0.976 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688879).  Saving model ...
Epoch: 24 cost time: 1.1476986408233643
Epoch: 24, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.944 Vali Acc: 0.707 Test Loss: 0.944 Test Acc: 0.707
Validation loss decreased (-0.688879 --> -0.707398).  Saving model ...
Epoch: 25 cost time: 1.1109085083007812
Epoch: 25, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
Validation loss decreased (-0.707398 --> -0.722213).  Saving model ...
Epoch: 26 cost time: 0.9594781398773193
Epoch: 26, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.887 Vali Acc: 0.726 Test Loss: 0.887 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 27 cost time: 1.0571198463439941
Epoch: 27, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.862 Vali Acc: 0.733 Test Loss: 0.862 Test Acc: 0.733
Validation loss decreased (-0.725917 --> -0.733325).  Saving model ...
Epoch: 28 cost time: 0.9627728462219238
Epoch: 28, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.839 Vali Acc: 0.737 Test Loss: 0.839 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 29 cost time: 0.9983453750610352
Epoch: 29, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.819 Vali Acc: 0.737 Test Loss: 0.819 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 30 cost time: 1.0762135982513428
Epoch: 30, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.801 Vali Acc: 0.737 Test Loss: 0.801 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 31 cost time: 1.0568232536315918
Epoch: 31, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.786 Vali Acc: 0.737 Test Loss: 0.786 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 32 cost time: 1.156855583190918
Epoch: 32, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.772 Vali Acc: 0.741 Test Loss: 0.772 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 33 cost time: 1.1625585556030273
Epoch: 33, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 34 cost time: 1.2417359352111816
Epoch: 34, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.751 Vali Acc: 0.741 Test Loss: 0.751 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 35 cost time: 1.2322709560394287
Epoch: 35, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 36 cost time: 1.3171098232269287
Epoch: 36, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.733 Vali Acc: 0.741 Test Loss: 0.733 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2383196353912354
Epoch: 37, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0325932502746582
Epoch: 38, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.748 Test Loss: 0.719 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 39 cost time: 1.0280325412750244
Epoch: 39, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.713 Vali Acc: 0.759 Test Loss: 0.713 Test Acc: 0.759
Validation loss decreased (-0.748141 --> -0.759252).  Saving model ...
Epoch: 40 cost time: 1.0816314220428467
Epoch: 40, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 41 cost time: 1.1638610363006592
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.700 Vali Acc: 0.763 Test Loss: 0.700 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 42 cost time: 1.117746114730835
Epoch: 42, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770363).  Saving model ...
Epoch: 43 cost time: 1.1031079292297363
Epoch: 43, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.688 Vali Acc: 0.770 Test Loss: 0.688 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 44 cost time: 1.107391119003296
Epoch: 44, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770364).  Saving model ...
Epoch: 45 cost time: 0.9842114448547363
Epoch: 45, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.677 Vali Acc: 0.774 Test Loss: 0.677 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 46 cost time: 1.140923023223877
Epoch: 46, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.672 Vali Acc: 0.774 Test Loss: 0.672 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 47 cost time: 1.022688865661621
Epoch: 47, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.667 Vali Acc: 0.774 Test Loss: 0.667 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 48 cost time: 1.0618901252746582
Epoch: 48, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.662 Vali Acc: 0.774 Test Loss: 0.662 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 49 cost time: 1.2504587173461914
Epoch: 49, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.657 Vali Acc: 0.774 Test Loss: 0.657 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774068).  Saving model ...
Epoch: 50 cost time: 1.1320927143096924
Epoch: 50, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.651 Vali Acc: 0.781 Test Loss: 0.651 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781475).  Saving model ...
Epoch: 51 cost time: 1.014549732208252
Epoch: 51, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 52 cost time: 1.0802266597747803
Epoch: 52, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.641 Vali Acc: 0.793 Test Loss: 0.641 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 53 cost time: 1.0129494667053223
Epoch: 53, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0282740592956543
Epoch: 54, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9018614292144775
Epoch: 55, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9931771755218506
Epoch: 56, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.624 Vali Acc: 0.793 Test Loss: 0.624 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 57 cost time: 1.096372127532959
Epoch: 57, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.793 Test Loss: 0.620 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 58 cost time: 1.0734717845916748
Epoch: 58, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.793 Test Loss: 0.615 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 59 cost time: 1.2184815406799316
Epoch: 59, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.793 Test Loss: 0.611 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 60 cost time: 1.1622512340545654
Epoch: 60, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 61 cost time: 1.0617070198059082
Epoch: 61, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 62 cost time: 1.1967418193817139
Epoch: 62, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 63 cost time: 1.1636478900909424
Epoch: 63, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 64 cost time: 1.1353261470794678
Epoch: 64, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 65 cost time: 1.053645372390747
Epoch: 65, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.586 Vali Acc: 0.800 Test Loss: 0.586 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 66 cost time: 1.1338281631469727
Epoch: 66, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.807 Test Loss: 0.582 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807402).  Saving model ...
Epoch: 67 cost time: 1.0108296871185303
Epoch: 67, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.579 Vali Acc: 0.807 Test Loss: 0.579 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 68 cost time: 1.065941333770752
Epoch: 68, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.807 Test Loss: 0.575 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 69 cost time: 1.0070216655731201
Epoch: 69, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.572 Vali Acc: 0.811 Test Loss: 0.572 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.0625834465026855
Epoch: 70, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.811 Test Loss: 0.568 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 71 cost time: 1.0541386604309082
Epoch: 71, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.815 Test Loss: 0.565 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 72 cost time: 1.0583112239837646
Epoch: 72, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.815 Test Loss: 0.562 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 73 cost time: 1.1750686168670654
Epoch: 73, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.815 Test Loss: 0.559 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 74 cost time: 1.137230634689331
Epoch: 74, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 75 cost time: 1.1605424880981445
Epoch: 75, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 76 cost time: 1.2447283267974854
Epoch: 76, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 77 cost time: 1.1036326885223389
Epoch: 77, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.815 Test Loss: 0.547 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 78 cost time: 1.0978848934173584
Epoch: 78, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 79 cost time: 1.1587107181549072
Epoch: 79, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 80 cost time: 1.0881433486938477
Epoch: 80, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 81 cost time: 1.0647785663604736
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 82 cost time: 0.9716708660125732
Epoch: 82, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 83 cost time: 1.0101971626281738
Epoch: 83, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 84 cost time: 0.9754884243011475
Epoch: 84, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 85 cost time: 0.8933565616607666
Epoch: 85, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.830 Test Loss: 0.526 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 86 cost time: 1.0635082721710205
Epoch: 86, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.830 Test Loss: 0.524 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 87 cost time: 0.953909158706665
Epoch: 87, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.830 Test Loss: 0.522 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 88 cost time: 1.1818406581878662
Epoch: 88, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.519 Vali Acc: 0.830 Test Loss: 0.519 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 89 cost time: 1.1211707592010498
Epoch: 89, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.830 Test Loss: 0.517 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 90 cost time: 1.1279668807983398
Epoch: 90, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.830 Test Loss: 0.514 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 91 cost time: 1.0752770900726318
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.830 Test Loss: 0.512 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829625).  Saving model ...
Epoch: 92 cost time: 1.1092638969421387
Epoch: 92, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.830 Test Loss: 0.510 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 93 cost time: 1.171656608581543
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833328).  Saving model ...
Epoch: 94 cost time: 1.1265711784362793
Epoch: 94, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 95 cost time: 1.0698480606079102
Epoch: 95, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 96 cost time: 0.9834697246551514
Epoch: 96, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 97 cost time: 1.1481387615203857
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 98 cost time: 0.9472837448120117
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.0852689743041992
Epoch: 99, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 100 cost time: 1.0138590335845947
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.345290184020996
Epoch: 1, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.897 Vali Acc: 0.167 Test Loss: 1.897 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 1.0359508991241455
Epoch: 2, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.877 Vali Acc: 0.174 Test Loss: 1.877 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 1.0293631553649902
Epoch: 3, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.860 Vali Acc: 0.170 Test Loss: 1.860 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0638320446014404
Epoch: 4, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.835 Vali Acc: 0.207 Test Loss: 1.835 Test Acc: 0.207
Validation loss decreased (-0.174055 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 1.045943021774292
Epoch: 5, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.804 Vali Acc: 0.219 Test Loss: 1.804 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 1.0956952571868896
Epoch: 6, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.770 Vali Acc: 0.241 Test Loss: 1.770 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 1.013700008392334
Epoch: 7, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.732 Vali Acc: 0.274 Test Loss: 1.732 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.987389326095581
Epoch: 8, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.692 Vali Acc: 0.300 Test Loss: 1.692 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 9 cost time: 0.9644577503204346
Epoch: 9, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.650 Vali Acc: 0.356 Test Loss: 1.650 Test Acc: 0.356
Validation loss decreased (-0.299983 --> -0.355539).  Saving model ...
Epoch: 10 cost time: 0.9065287113189697
Epoch: 10, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.607 Vali Acc: 0.396 Test Loss: 1.607 Test Acc: 0.396
Validation loss decreased (-0.355539 --> -0.396280).  Saving model ...
Epoch: 11 cost time: 0.9891552925109863
Epoch: 11, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.563 Vali Acc: 0.481 Test Loss: 1.563 Test Acc: 0.481
Validation loss decreased (-0.396280 --> -0.481466).  Saving model ...
Epoch: 12 cost time: 1.009812831878662
Epoch: 12, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.519 Vali Acc: 0.537 Test Loss: 1.519 Test Acc: 0.537
Validation loss decreased (-0.481466 --> -0.537022).  Saving model ...
Epoch: 13 cost time: 1.0621192455291748
Epoch: 13, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.474 Vali Acc: 0.563 Test Loss: 1.474 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562948).  Saving model ...
Epoch: 14 cost time: 1.0527677536010742
Epoch: 14, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.431 Vali Acc: 0.581 Test Loss: 1.431 Test Acc: 0.581
Validation loss decreased (-0.562948 --> -0.581467).  Saving model ...
Epoch: 15 cost time: 1.100964069366455
Epoch: 15, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.389 Vali Acc: 0.585 Test Loss: 1.389 Test Acc: 0.585
Validation loss decreased (-0.581467 --> -0.585171).  Saving model ...
Epoch: 16 cost time: 1.0146160125732422
Epoch: 16, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.346 Vali Acc: 0.600 Test Loss: 1.346 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 0.9977352619171143
Epoch: 17, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.306 Vali Acc: 0.604 Test Loss: 1.306 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603691).  Saving model ...
Epoch: 18 cost time: 0.9507660865783691
Epoch: 18, Steps: 2 | Train Loss: 0.855 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9756932258605957
Epoch: 19, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.229 Vali Acc: 0.604 Test Loss: 1.229 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 20 cost time: 1.1107871532440186
Epoch: 20, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.193 Vali Acc: 0.611 Test Loss: 1.193 Test Acc: 0.611
Validation loss decreased (-0.603691 --> -0.611099).  Saving model ...
Epoch: 21 cost time: 1.1600890159606934
Epoch: 21, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.160 Vali Acc: 0.626 Test Loss: 1.160 Test Acc: 0.626
Validation loss decreased (-0.611099 --> -0.625914).  Saving model ...
Epoch: 22 cost time: 0.9249837398529053
Epoch: 22, Steps: 2 | Train Loss: 0.558 Vali Loss: 1.127 Vali Acc: 0.630 Test Loss: 1.127 Test Acc: 0.630
Validation loss decreased (-0.625914 --> -0.629618).  Saving model ...
Epoch: 23 cost time: 0.894819974899292
Epoch: 23, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.096 Vali Acc: 0.644 Test Loss: 1.096 Test Acc: 0.644
Validation loss decreased (-0.629618 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 0.9307715892791748
Epoch: 24, Steps: 2 | Train Loss: 0.474 Vali Loss: 1.067 Vali Acc: 0.648 Test Loss: 1.067 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 25 cost time: 0.955317497253418
Epoch: 25, Steps: 2 | Train Loss: 0.426 Vali Loss: 1.038 Vali Acc: 0.663 Test Loss: 1.038 Test Acc: 0.663
Validation loss decreased (-0.648137 --> -0.662953).  Saving model ...
Epoch: 26 cost time: 0.9275989532470703
Epoch: 26, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.012 Vali Acc: 0.670 Test Loss: 1.012 Test Acc: 0.670
Validation loss decreased (-0.662953 --> -0.670360).  Saving model ...
Epoch: 27 cost time: 0.8578307628631592
Epoch: 27, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.988 Vali Acc: 0.681 Test Loss: 0.988 Test Acc: 0.681
Validation loss decreased (-0.670360 --> -0.681472).  Saving model ...
Epoch: 28 cost time: 0.8726940155029297
Epoch: 28, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.966 Vali Acc: 0.685 Test Loss: 0.966 Test Acc: 0.685
Validation loss decreased (-0.681472 --> -0.685176).  Saving model ...
Epoch: 29 cost time: 1.0422322750091553
Epoch: 29, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.948 Vali Acc: 0.693 Test Loss: 0.948 Test Acc: 0.693
Validation loss decreased (-0.685176 --> -0.692583).  Saving model ...
Epoch: 30 cost time: 1.0124797821044922
Epoch: 30, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.931 Vali Acc: 0.693 Test Loss: 0.931 Test Acc: 0.693
Validation loss decreased (-0.692583 --> -0.692583).  Saving model ...
Epoch: 31 cost time: 0.9977600574493408
Epoch: 31, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.917 Vali Acc: 0.707 Test Loss: 0.917 Test Acc: 0.707
Validation loss decreased (-0.692583 --> -0.707398).  Saving model ...
Epoch: 32 cost time: 1.1227786540985107
Epoch: 32, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.904 Vali Acc: 0.715 Test Loss: 0.904 Test Acc: 0.715
Validation loss decreased (-0.707398 --> -0.714806).  Saving model ...
Epoch: 33 cost time: 1.099092960357666
Epoch: 33, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
Validation loss decreased (-0.714806 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 1.0503919124603271
Epoch: 34, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.885 Vali Acc: 0.722 Test Loss: 0.885 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 35 cost time: 0.9729571342468262
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.876 Vali Acc: 0.726 Test Loss: 0.876 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 36 cost time: 1.014491081237793
Epoch: 36, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.868 Vali Acc: 0.730 Test Loss: 0.868 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 37 cost time: 1.0218884944915771
Epoch: 37, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.860 Vali Acc: 0.730 Test Loss: 0.860 Test Acc: 0.730
Validation loss decreased (-0.729621 --> -0.729621).  Saving model ...
Epoch: 38 cost time: 0.9838955402374268
Epoch: 38, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.853 Vali Acc: 0.737 Test Loss: 0.853 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737029).  Saving model ...
Epoch: 39 cost time: 0.9646446704864502
Epoch: 39, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.846 Vali Acc: 0.737 Test Loss: 0.846 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 40 cost time: 0.920053243637085
Epoch: 40, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.839 Vali Acc: 0.733 Test Loss: 0.839 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9924790859222412
Epoch: 41, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.833 Vali Acc: 0.733 Test Loss: 0.833 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.949793815612793
Epoch: 42, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.827 Vali Acc: 0.726 Test Loss: 0.827 Test Acc: 0.726
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0541296005249023
Epoch: 43, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1226444244384766
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.815 Vali Acc: 0.733 Test Loss: 0.815 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1263408660888672
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.810 Vali Acc: 0.737 Test Loss: 0.810 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 46 cost time: 0.9905614852905273
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.806 Vali Acc: 0.748 Test Loss: 0.806 Test Acc: 0.748
Validation loss decreased (-0.737029 --> -0.748140).  Saving model ...
Epoch: 47 cost time: 1.0400960445404053
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.802 Vali Acc: 0.748 Test Loss: 0.802 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 48 cost time: 1.034515380859375
Epoch: 48, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.796 Vali Acc: 0.752 Test Loss: 0.796 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 49 cost time: 1.0272107124328613
Epoch: 49, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.791 Vali Acc: 0.748 Test Loss: 0.791 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.130913257598877
Epoch: 50, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.785 Vali Acc: 0.748 Test Loss: 0.785 Test Acc: 0.748
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9529454708099365
Epoch: 51, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.779 Vali Acc: 0.748 Test Loss: 0.779 Test Acc: 0.748
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9692850112915039
Epoch: 52, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.773 Vali Acc: 0.748 Test Loss: 0.773 Test Acc: 0.748
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9869916439056396
Epoch: 53, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.768 Vali Acc: 0.748 Test Loss: 0.768 Test Acc: 0.748
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.943458080291748
Epoch: 54, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.764 Vali Acc: 0.752 Test Loss: 0.764 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 55 cost time: 0.9772062301635742
Epoch: 55, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.760 Vali Acc: 0.752 Test Loss: 0.760 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 56 cost time: 1.0892183780670166
Epoch: 56, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.755 Vali Acc: 0.752 Test Loss: 0.755 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 57 cost time: 0.9802300930023193
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.751 Vali Acc: 0.752 Test Loss: 0.751 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 58 cost time: 1.075998306274414
Epoch: 58, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 59 cost time: 1.1558034420013428
Epoch: 59, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.741 Vali Acc: 0.759 Test Loss: 0.741 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 60 cost time: 1.1510038375854492
Epoch: 60, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.759 Test Loss: 0.736 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 61 cost time: 1.1239871978759766
Epoch: 61, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 62 cost time: 1.1011741161346436
Epoch: 62, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.763 Test Loss: 0.727 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 63 cost time: 1.1723158359527588
Epoch: 63, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.763 Test Loss: 0.723 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 64 cost time: 1.1668009757995605
Epoch: 64, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.770 Test Loss: 0.719 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770363).  Saving model ...
Epoch: 65 cost time: 1.012608528137207
Epoch: 65, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.715 Vali Acc: 0.774 Test Loss: 0.715 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 66 cost time: 0.9908146858215332
Epoch: 66, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.712 Vali Acc: 0.774 Test Loss: 0.712 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 67 cost time: 0.9896550178527832
Epoch: 67, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.708 Vali Acc: 0.774 Test Loss: 0.708 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 68 cost time: 1.04644775390625
Epoch: 68, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.705 Vali Acc: 0.778 Test Loss: 0.705 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 69 cost time: 1.1189711093902588
Epoch: 69, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.702 Vali Acc: 0.778 Test Loss: 0.702 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 70 cost time: 1.0326595306396484
Epoch: 70, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.699 Vali Acc: 0.781 Test Loss: 0.699 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 71 cost time: 1.0692625045776367
Epoch: 71, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.695 Vali Acc: 0.781 Test Loss: 0.695 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781475).  Saving model ...
Epoch: 72 cost time: 1.2693626880645752
Epoch: 72, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.692 Vali Acc: 0.781 Test Loss: 0.692 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 73 cost time: 1.1514902114868164
Epoch: 73, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.688 Vali Acc: 0.785 Test Loss: 0.688 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 74 cost time: 1.161724328994751
Epoch: 74, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.785 Test Loss: 0.685 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 75 cost time: 1.1276133060455322
Epoch: 75, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.785 Test Loss: 0.682 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 76 cost time: 1.1413276195526123
Epoch: 76, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.678 Vali Acc: 0.785 Test Loss: 0.678 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 77 cost time: 1.1071059703826904
Epoch: 77, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 78 cost time: 1.0416052341461182
Epoch: 78, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 79 cost time: 0.9889681339263916
Epoch: 79, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 80 cost time: 1.002835988998413
Epoch: 80, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.793 Test Loss: 0.668 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 81 cost time: 0.8908669948577881
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.793 Test Loss: 0.664 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 82 cost time: 0.9945633411407471
Epoch: 82, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.793 Test Loss: 0.661 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 83 cost time: 0.9500014781951904
Epoch: 83, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.793 Test Loss: 0.659 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 84 cost time: 1.0389513969421387
Epoch: 84, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.793 Test Loss: 0.656 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 85 cost time: 0.9839534759521484
Epoch: 85, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.793 Test Loss: 0.652 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 86 cost time: 1.039414644241333
Epoch: 86, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 87 cost time: 1.0511741638183594
Epoch: 87, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 88 cost time: 1.049544334411621
Epoch: 88, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 89 cost time: 1.1098110675811768
Epoch: 89, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 90 cost time: 1.0061790943145752
Epoch: 90, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 91 cost time: 1.0112833976745605
Epoch: 91, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 92 cost time: 0.9479067325592041
Epoch: 92, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 93 cost time: 0.9308512210845947
Epoch: 93, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 94 cost time: 0.8733770847320557
Epoch: 94, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.804 Test Loss: 0.625 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 95 cost time: 1.0220351219177246
Epoch: 95, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9278044700622559
Epoch: 96, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.9549896717071533
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 98 cost time: 0.9267497062683105
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 99 cost time: 1.0644361972808838
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 100 cost time: 0.9570715427398682
Epoch: 100, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8037037037037037
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.437737226486206
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.865 Vali Acc: 0.133 Test Loss: 1.865 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.2522013187408447
Epoch: 2, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.852 Vali Acc: 0.141 Test Loss: 1.852 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 1.1158161163330078
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.841 Vali Acc: 0.148 Test Loss: 1.841 Test Acc: 0.148
Validation loss decreased (-0.140722 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 1.146955966949463
Epoch: 4, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.824 Vali Acc: 0.156 Test Loss: 1.824 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 1.0671541690826416
Epoch: 5, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.802 Vali Acc: 0.185 Test Loss: 1.802 Test Acc: 0.185
Validation loss decreased (-0.155537 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 1.1417593955993652
Epoch: 6, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.777 Vali Acc: 0.215 Test Loss: 1.777 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 1.1216857433319092
Epoch: 7, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.750 Vali Acc: 0.241 Test Loss: 1.750 Test Acc: 0.241
Validation loss decreased (-0.214797 --> -0.240723).  Saving model ...
Epoch: 8 cost time: 1.0234427452087402
Epoch: 8, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.721 Vali Acc: 0.304 Test Loss: 1.721 Test Acc: 0.304
Validation loss decreased (-0.240723 --> -0.303686).  Saving model ...
Epoch: 9 cost time: 1.217165231704712
Epoch: 9, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.691 Vali Acc: 0.352 Test Loss: 1.691 Test Acc: 0.352
Validation loss decreased (-0.303686 --> -0.351835).  Saving model ...
Epoch: 10 cost time: 0.915442943572998
Epoch: 10, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.660 Vali Acc: 0.400 Test Loss: 1.660 Test Acc: 0.400
Validation loss decreased (-0.351835 --> -0.399983).  Saving model ...
Epoch: 11 cost time: 1.0740447044372559
Epoch: 11, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.628 Vali Acc: 0.459 Test Loss: 1.628 Test Acc: 0.459
Validation loss decreased (-0.399983 --> -0.459243).  Saving model ...
Epoch: 12 cost time: 1.0861921310424805
Epoch: 12, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.595 Vali Acc: 0.489 Test Loss: 1.595 Test Acc: 0.489
Validation loss decreased (-0.459243 --> -0.488873).  Saving model ...
Epoch: 13 cost time: 0.9240062236785889
Epoch: 13, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.563 Vali Acc: 0.496 Test Loss: 1.563 Test Acc: 0.496
Validation loss decreased (-0.488873 --> -0.496281).  Saving model ...
Epoch: 14 cost time: 0.9043853282928467
Epoch: 14, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.531 Vali Acc: 0.504 Test Loss: 1.531 Test Acc: 0.504
Validation loss decreased (-0.496281 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.9995605945587158
Epoch: 15, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.503688 --> -0.522207).  Saving model ...
Epoch: 16 cost time: 0.9704389572143555
Epoch: 16, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.467 Vali Acc: 0.522 Test Loss: 1.467 Test Acc: 0.522
Validation loss decreased (-0.522207 --> -0.522208).  Saving model ...
Epoch: 17 cost time: 1.0764689445495605
Epoch: 17, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.436 Vali Acc: 0.537 Test Loss: 1.436 Test Acc: 0.537
Validation loss decreased (-0.522208 --> -0.537023).  Saving model ...
Epoch: 18 cost time: 0.9614920616149902
Epoch: 18, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.405 Vali Acc: 0.556 Test Loss: 1.405 Test Acc: 0.556
Validation loss decreased (-0.537023 --> -0.555542).  Saving model ...
Epoch: 19 cost time: 1.0636579990386963
Epoch: 19, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.376 Vali Acc: 0.559 Test Loss: 1.376 Test Acc: 0.559
Validation loss decreased (-0.555542 --> -0.559245).  Saving model ...
Epoch: 20 cost time: 1.018829345703125
Epoch: 20, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.348 Vali Acc: 0.570 Test Loss: 1.348 Test Acc: 0.570
Validation loss decreased (-0.559245 --> -0.570357).  Saving model ...
Epoch: 21 cost time: 1.129117488861084
Epoch: 21, Steps: 2 | Train Loss: 0.815 Vali Loss: 1.320 Vali Acc: 0.581 Test Loss: 1.320 Test Acc: 0.581
Validation loss decreased (-0.570357 --> -0.581468).  Saving model ...
Epoch: 22 cost time: 0.9819989204406738
Epoch: 22, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.293 Vali Acc: 0.578 Test Loss: 1.293 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9984445571899414
Epoch: 23, Steps: 2 | Train Loss: 0.727 Vali Loss: 1.269 Vali Acc: 0.574 Test Loss: 1.269 Test Acc: 0.574
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.044231653213501
Epoch: 24, Steps: 2 | Train Loss: 0.678 Vali Loss: 1.244 Vali Acc: 0.578 Test Loss: 1.244 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0176806449890137
Epoch: 25, Steps: 2 | Train Loss: 0.605 Vali Loss: 1.219 Vali Acc: 0.581 Test Loss: 1.219 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581469).  Saving model ...
Epoch: 26 cost time: 0.9867498874664307
Epoch: 26, Steps: 2 | Train Loss: 0.571 Vali Loss: 1.197 Vali Acc: 0.589 Test Loss: 1.197 Test Acc: 0.589
Validation loss decreased (-0.581469 --> -0.588877).  Saving model ...
Epoch: 27 cost time: 1.019446849822998
Epoch: 27, Steps: 2 | Train Loss: 0.498 Vali Loss: 1.176 Vali Acc: 0.589 Test Loss: 1.176 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588877).  Saving model ...
Epoch: 28 cost time: 1.0130231380462646
Epoch: 28, Steps: 2 | Train Loss: 0.480 Vali Loss: 1.156 Vali Acc: 0.593 Test Loss: 1.156 Test Acc: 0.593
Validation loss decreased (-0.588877 --> -0.592581).  Saving model ...
Epoch: 29 cost time: 0.963273286819458
Epoch: 29, Steps: 2 | Train Loss: 0.418 Vali Loss: 1.138 Vali Acc: 0.604 Test Loss: 1.138 Test Acc: 0.604
Validation loss decreased (-0.592581 --> -0.603692).  Saving model ...
Epoch: 30 cost time: 1.0548417568206787
Epoch: 30, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.119 Vali Acc: 0.611 Test Loss: 1.119 Test Acc: 0.611
Validation loss decreased (-0.603692 --> -0.611100).  Saving model ...
Epoch: 31 cost time: 1.0316143035888672
Epoch: 31, Steps: 2 | Train Loss: 0.330 Vali Loss: 1.100 Vali Acc: 0.611 Test Loss: 1.100 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611100).  Saving model ...
Epoch: 32 cost time: 1.11602783203125
Epoch: 32, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.081 Vali Acc: 0.615 Test Loss: 1.081 Test Acc: 0.615
Validation loss decreased (-0.611100 --> -0.614804).  Saving model ...
Epoch: 33 cost time: 1.3104400634765625
Epoch: 33, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.065 Vali Acc: 0.615 Test Loss: 1.065 Test Acc: 0.615
Validation loss decreased (-0.614804 --> -0.614804).  Saving model ...
Epoch: 34 cost time: 1.0880675315856934
Epoch: 34, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.048 Vali Acc: 0.622 Test Loss: 1.048 Test Acc: 0.622
Validation loss decreased (-0.614804 --> -0.622212).  Saving model ...
Epoch: 35 cost time: 1.154139757156372
Epoch: 35, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.031 Vali Acc: 0.626 Test Loss: 1.031 Test Acc: 0.626
Validation loss decreased (-0.622212 --> -0.625916).  Saving model ...
Epoch: 36 cost time: 1.1536345481872559
Epoch: 36, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.015 Vali Acc: 0.626 Test Loss: 1.015 Test Acc: 0.626
Validation loss decreased (-0.625916 --> -0.625916).  Saving model ...
Epoch: 37 cost time: 1.1335570812225342
Epoch: 37, Steps: 2 | Train Loss: 0.171 Vali Loss: 1.000 Vali Acc: 0.630 Test Loss: 1.000 Test Acc: 0.630
Validation loss decreased (-0.625916 --> -0.629620).  Saving model ...
Epoch: 38 cost time: 1.1110703945159912
Epoch: 38, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.986 Vali Acc: 0.637 Test Loss: 0.986 Test Acc: 0.637
Validation loss decreased (-0.629620 --> -0.637027).  Saving model ...
Epoch: 39 cost time: 1.0030922889709473
Epoch: 39, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.973 Vali Acc: 0.637 Test Loss: 0.973 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 40 cost time: 1.0549678802490234
Epoch: 40, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.960 Vali Acc: 0.637 Test Loss: 0.960 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 41 cost time: 0.9577114582061768
Epoch: 41, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.948 Vali Acc: 0.641 Test Loss: 0.948 Test Acc: 0.641
Validation loss decreased (-0.637027 --> -0.640731).  Saving model ...
Epoch: 42 cost time: 1.0564181804656982
Epoch: 42, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.936 Vali Acc: 0.648 Test Loss: 0.936 Test Acc: 0.648
Validation loss decreased (-0.640731 --> -0.648139).  Saving model ...
Epoch: 43 cost time: 0.9638857841491699
Epoch: 43, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.926 Vali Acc: 0.648 Test Loss: 0.926 Test Acc: 0.648
Validation loss decreased (-0.648139 --> -0.648139).  Saving model ...
Epoch: 44 cost time: 1.1471107006072998
Epoch: 44, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.915 Vali Acc: 0.659 Test Loss: 0.915 Test Acc: 0.659
Validation loss decreased (-0.648139 --> -0.659250).  Saving model ...
Epoch: 45 cost time: 1.156684160232544
Epoch: 45, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.906 Vali Acc: 0.667 Test Loss: 0.906 Test Acc: 0.667
Validation loss decreased (-0.659250 --> -0.666658).  Saving model ...
Epoch: 46 cost time: 1.2138359546661377
Epoch: 46, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 47 cost time: 1.1544926166534424
Epoch: 47, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.890 Vali Acc: 0.670 Test Loss: 0.890 Test Acc: 0.670
Validation loss decreased (-0.666658 --> -0.670361).  Saving model ...
Epoch: 48 cost time: 1.1430766582489014
Epoch: 48, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.882 Vali Acc: 0.674 Test Loss: 0.882 Test Acc: 0.674
Validation loss decreased (-0.670361 --> -0.674065).  Saving model ...
Epoch: 49 cost time: 1.13637113571167
Epoch: 49, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.873 Vali Acc: 0.685 Test Loss: 0.873 Test Acc: 0.685
Validation loss decreased (-0.674065 --> -0.685176).  Saving model ...
Epoch: 50 cost time: 1.0889346599578857
Epoch: 50, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.864 Vali Acc: 0.685 Test Loss: 0.864 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685177).  Saving model ...
Epoch: 51 cost time: 1.019801378250122
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.856 Vali Acc: 0.685 Test Loss: 0.856 Test Acc: 0.685
Validation loss decreased (-0.685177 --> -0.685177).  Saving model ...
Epoch: 52 cost time: 1.024033784866333
Epoch: 52, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.848 Vali Acc: 0.689 Test Loss: 0.848 Test Acc: 0.689
Validation loss decreased (-0.685177 --> -0.688880).  Saving model ...
Epoch: 53 cost time: 1.1431074142456055
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.841 Vali Acc: 0.693 Test Loss: 0.841 Test Acc: 0.693
Validation loss decreased (-0.688880 --> -0.692584).  Saving model ...
Epoch: 54 cost time: 0.945530891418457
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.835 Vali Acc: 0.693 Test Loss: 0.835 Test Acc: 0.693
Validation loss decreased (-0.692584 --> -0.692584).  Saving model ...
Epoch: 55 cost time: 0.9550621509552002
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.828 Vali Acc: 0.707 Test Loss: 0.828 Test Acc: 0.707
Validation loss decreased (-0.692584 --> -0.707399).  Saving model ...
Epoch: 56 cost time: 0.9431636333465576
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.821 Vali Acc: 0.707 Test Loss: 0.821 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 57 cost time: 1.0294866561889648
Epoch: 57, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.814 Vali Acc: 0.715 Test Loss: 0.814 Test Acc: 0.715
Validation loss decreased (-0.707399 --> -0.714807).  Saving model ...
Epoch: 58 cost time: 1.0732805728912354
Epoch: 58, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.807 Vali Acc: 0.719 Test Loss: 0.807 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718510).  Saving model ...
Epoch: 59 cost time: 1.141514778137207
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.800 Vali Acc: 0.719 Test Loss: 0.800 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718511).  Saving model ...
Epoch: 60 cost time: 1.1119799613952637
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.793 Vali Acc: 0.730 Test Loss: 0.793 Test Acc: 0.730
Validation loss decreased (-0.718511 --> -0.729622).  Saving model ...
Epoch: 61 cost time: 1.065375566482544
Epoch: 61, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.787 Vali Acc: 0.737 Test Loss: 0.787 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737029).  Saving model ...
Epoch: 62 cost time: 1.1132614612579346
Epoch: 62, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.781 Vali Acc: 0.737 Test Loss: 0.781 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 63 cost time: 1.0741662979125977
Epoch: 63, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.775 Vali Acc: 0.737 Test Loss: 0.775 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 64 cost time: 1.0625600814819336
Epoch: 64, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.770 Vali Acc: 0.737 Test Loss: 0.770 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 65 cost time: 1.1326971054077148
Epoch: 65, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.765 Vali Acc: 0.737 Test Loss: 0.765 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 66 cost time: 0.9986541271209717
Epoch: 66, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 67 cost time: 1.0014548301696777
Epoch: 67, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.757 Vali Acc: 0.741 Test Loss: 0.757 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 68 cost time: 0.9645998477935791
Epoch: 68, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 69 cost time: 0.9712615013122559
Epoch: 69, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 70 cost time: 1.0720164775848389
Epoch: 70, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0829715728759766
Epoch: 71, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 72 cost time: 1.0590765476226807
Epoch: 72, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.739 Vali Acc: 0.748 Test Loss: 0.739 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 73 cost time: 1.0724186897277832
Epoch: 73, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.735 Vali Acc: 0.748 Test Loss: 0.735 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 74 cost time: 1.0958378314971924
Epoch: 74, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.732 Vali Acc: 0.748 Test Loss: 0.732 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 75 cost time: 1.0517535209655762
Epoch: 75, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.748 Test Loss: 0.728 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 76 cost time: 0.9795567989349365
Epoch: 76, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.724 Vali Acc: 0.752 Test Loss: 0.724 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 77 cost time: 1.034348487854004
Epoch: 77, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.721 Vali Acc: 0.756 Test Loss: 0.721 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755548).  Saving model ...
Epoch: 78 cost time: 1.010056734085083
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.718 Vali Acc: 0.759 Test Loss: 0.718 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 79 cost time: 1.0817358493804932
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.763 Test Loss: 0.715 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 80 cost time: 0.9940359592437744
Epoch: 80, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 81 cost time: 1.0580942630767822
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 82 cost time: 1.0657579898834229
Epoch: 82, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 83 cost time: 1.1486694812774658
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.704 Vali Acc: 0.767 Test Loss: 0.704 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 84 cost time: 1.0192456245422363
Epoch: 84, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.701 Vali Acc: 0.770 Test Loss: 0.701 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770363).  Saving model ...
Epoch: 85 cost time: 1.0894789695739746
Epoch: 85, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 86 cost time: 1.1005988121032715
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 87 cost time: 0.960155725479126
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.691 Vali Acc: 0.770 Test Loss: 0.691 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 88 cost time: 1.007652759552002
Epoch: 88, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.770 Test Loss: 0.688 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 89 cost time: 0.9223415851593018
Epoch: 89, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.770 Test Loss: 0.685 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770364).  Saving model ...
Epoch: 90 cost time: 0.9999983310699463
Epoch: 90, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.770 Test Loss: 0.683 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 91 cost time: 0.9439182281494141
Epoch: 91, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 92 cost time: 0.8701198101043701
Epoch: 92, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.677 Vali Acc: 0.767 Test Loss: 0.677 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.8751692771911621
Epoch: 93, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 94 cost time: 1.0668425559997559
Epoch: 94, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 95 cost time: 1.0217902660369873
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.778 Test Loss: 0.669 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777771).  Saving model ...
Epoch: 96 cost time: 0.9878458976745605
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.666 Vali Acc: 0.781 Test Loss: 0.666 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 97 cost time: 1.0553879737854004
Epoch: 97, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.781 Test Loss: 0.663 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 98 cost time: 1.2279703617095947
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.661 Vali Acc: 0.785 Test Loss: 0.661 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 99 cost time: 1.148242473602295
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.785 Test Loss: 0.659 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 100 cost time: 1.1517260074615479
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.785 Test Loss: 0.657 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7851851851851852
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3195865154266357
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.873 Vali Acc: 0.163 Test Loss: 1.873 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 1.104227066040039
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.863 Vali Acc: 0.167 Test Loss: 1.863 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 1.1171092987060547
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.853 Vali Acc: 0.167 Test Loss: 1.853 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.9939086437225342
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.838 Vali Acc: 0.170 Test Loss: 1.838 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 1.0667543411254883
Epoch: 5, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.819 Vali Acc: 0.174 Test Loss: 1.819 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 6 cost time: 1.08780837059021
Epoch: 6, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.798 Vali Acc: 0.178 Test Loss: 1.798 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 7 cost time: 1.1353530883789062
Epoch: 7, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.774 Vali Acc: 0.193 Test Loss: 1.774 Test Acc: 0.193
Validation loss decreased (-0.177760 --> -0.192575).  Saving model ...
Epoch: 8 cost time: 1.0677893161773682
Epoch: 8, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.748 Vali Acc: 0.193 Test Loss: 1.748 Test Acc: 0.193
Validation loss decreased (-0.192575 --> -0.192575).  Saving model ...
Epoch: 9 cost time: 1.142162561416626
Epoch: 9, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.721 Vali Acc: 0.222 Test Loss: 1.721 Test Acc: 0.222
Validation loss decreased (-0.192575 --> -0.222205).  Saving model ...
Epoch: 10 cost time: 1.1457488536834717
Epoch: 10, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.693 Vali Acc: 0.304 Test Loss: 1.693 Test Acc: 0.304
Validation loss decreased (-0.222205 --> -0.303687).  Saving model ...
Epoch: 11 cost time: 1.1228647232055664
Epoch: 11, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.663 Vali Acc: 0.381 Test Loss: 1.663 Test Acc: 0.381
Validation loss decreased (-0.303687 --> -0.381465).  Saving model ...
Epoch: 12 cost time: 1.0955679416656494
Epoch: 12, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.634 Vali Acc: 0.433 Test Loss: 1.634 Test Acc: 0.433
Validation loss decreased (-0.381465 --> -0.433317).  Saving model ...
Epoch: 13 cost time: 1.0340957641601562
Epoch: 13, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.605 Vali Acc: 0.456 Test Loss: 1.605 Test Acc: 0.456
Validation loss decreased (-0.433317 --> -0.455540).  Saving model ...
Epoch: 14 cost time: 1.0109994411468506
Epoch: 14, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.575 Vali Acc: 0.478 Test Loss: 1.575 Test Acc: 0.478
Validation loss decreased (-0.455540 --> -0.477762).  Saving model ...
Epoch: 15 cost time: 1.1553773880004883
Epoch: 15, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.545 Vali Acc: 0.493 Test Loss: 1.545 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 16 cost time: 0.9267494678497314
Epoch: 16, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.514 Vali Acc: 0.515 Test Loss: 1.514 Test Acc: 0.515
Validation loss decreased (-0.492577 --> -0.514800).  Saving model ...
Epoch: 17 cost time: 1.1791069507598877
Epoch: 17, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.484 Vali Acc: 0.530 Test Loss: 1.484 Test Acc: 0.530
Validation loss decreased (-0.514800 --> -0.529615).  Saving model ...
Epoch: 18 cost time: 1.0512559413909912
Epoch: 18, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.454 Vali Acc: 0.537 Test Loss: 1.454 Test Acc: 0.537
Validation loss decreased (-0.529615 --> -0.537022).  Saving model ...
Epoch: 19 cost time: 1.1513023376464844
Epoch: 19, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.424 Vali Acc: 0.552 Test Loss: 1.424 Test Acc: 0.552
Validation loss decreased (-0.537022 --> -0.551838).  Saving model ...
Epoch: 20 cost time: 1.099672794342041
Epoch: 20, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.393 Vali Acc: 0.574 Test Loss: 1.393 Test Acc: 0.574
Validation loss decreased (-0.551838 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 1.120948314666748
Epoch: 21, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.364 Vali Acc: 0.600 Test Loss: 1.364 Test Acc: 0.600
Validation loss decreased (-0.574060 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 1.1596508026123047
Epoch: 22, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.334 Vali Acc: 0.604 Test Loss: 1.334 Test Acc: 0.604
Validation loss decreased (-0.599986 --> -0.603690).  Saving model ...
Epoch: 23 cost time: 1.1655616760253906
Epoch: 23, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.305 Vali Acc: 0.622 Test Loss: 1.305 Test Acc: 0.622
Validation loss decreased (-0.603690 --> -0.622209).  Saving model ...
Epoch: 24 cost time: 1.0650622844696045
Epoch: 24, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.275 Vali Acc: 0.633 Test Loss: 1.275 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 25 cost time: 0.8848452568054199
Epoch: 25, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.246 Vali Acc: 0.630 Test Loss: 1.246 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9605426788330078
Epoch: 26, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.218 Vali Acc: 0.630 Test Loss: 1.218 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9265666007995605
Epoch: 27, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.190 Vali Acc: 0.637 Test Loss: 1.190 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.637025).  Saving model ...
Epoch: 28 cost time: 0.895301103591919
Epoch: 28, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.162 Vali Acc: 0.641 Test Loss: 1.162 Test Acc: 0.641
Validation loss decreased (-0.637025 --> -0.640729).  Saving model ...
Epoch: 29 cost time: 0.9036035537719727
Epoch: 29, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.135 Vali Acc: 0.652 Test Loss: 1.135 Test Acc: 0.652
Validation loss decreased (-0.640729 --> -0.651841).  Saving model ...
Epoch: 30 cost time: 1.0122504234313965
Epoch: 30, Steps: 2 | Train Loss: 0.582 Vali Loss: 1.107 Vali Acc: 0.663 Test Loss: 1.107 Test Acc: 0.663
Validation loss decreased (-0.651841 --> -0.662952).  Saving model ...
Epoch: 31 cost time: 0.9837119579315186
Epoch: 31, Steps: 2 | Train Loss: 0.554 Vali Loss: 1.080 Vali Acc: 0.678 Test Loss: 1.080 Test Acc: 0.678
Validation loss decreased (-0.662952 --> -0.677767).  Saving model ...
Epoch: 32 cost time: 0.9009158611297607
Epoch: 32, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.052 Vali Acc: 0.681 Test Loss: 1.052 Test Acc: 0.681
Validation loss decreased (-0.677767 --> -0.681471).  Saving model ...
Epoch: 33 cost time: 1.0401198863983154
Epoch: 33, Steps: 2 | Train Loss: 0.457 Vali Loss: 1.022 Vali Acc: 0.693 Test Loss: 1.022 Test Acc: 0.693
Validation loss decreased (-0.681471 --> -0.692582).  Saving model ...
Epoch: 34 cost time: 1.0962107181549072
Epoch: 34, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
Validation loss decreased (-0.692582 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 1.1783418655395508
Epoch: 35, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 1.1290490627288818
Epoch: 36, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.928 Vali Acc: 0.711 Test Loss: 0.928 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711102).  Saving model ...
Epoch: 37 cost time: 0.9366071224212646
Epoch: 37, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.897 Vali Acc: 0.715 Test Loss: 0.897 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 38 cost time: 1.0412468910217285
Epoch: 38, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.865 Vali Acc: 0.722 Test Loss: 0.865 Test Acc: 0.722
Validation loss decreased (-0.714806 --> -0.722214).  Saving model ...
Epoch: 39 cost time: 0.9499020576477051
Epoch: 39, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.834 Vali Acc: 0.737 Test Loss: 0.834 Test Acc: 0.737
Validation loss decreased (-0.722214 --> -0.737029).  Saving model ...
Epoch: 40 cost time: 1.0191795825958252
Epoch: 40, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.805 Vali Acc: 0.741 Test Loss: 0.805 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 41 cost time: 1.035703182220459
Epoch: 41, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.778 Vali Acc: 0.744 Test Loss: 0.778 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 42 cost time: 1.0149669647216797
Epoch: 42, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 1.044820785522461
Epoch: 43, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.726 Vali Acc: 0.759 Test Loss: 0.726 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 44 cost time: 1.0331933498382568
Epoch: 44, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.704 Vali Acc: 0.763 Test Loss: 0.704 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 45 cost time: 0.9858405590057373
Epoch: 45, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.686 Vali Acc: 0.763 Test Loss: 0.686 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 46 cost time: 1.0678517818450928
Epoch: 46, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.670 Vali Acc: 0.770 Test Loss: 0.670 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 47 cost time: 1.0378687381744385
Epoch: 47, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.656 Vali Acc: 0.781 Test Loss: 0.656 Test Acc: 0.781
Validation loss decreased (-0.770364 --> -0.781475).  Saving model ...
Epoch: 48 cost time: 1.0831937789916992
Epoch: 48, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.642 Vali Acc: 0.781 Test Loss: 0.642 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 49 cost time: 1.1364564895629883
Epoch: 49, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.628 Vali Acc: 0.785 Test Loss: 0.628 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 50 cost time: 1.1731758117675781
Epoch: 50, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.785179 --> -0.796290).  Saving model ...
Epoch: 51 cost time: 1.255307912826538
Epoch: 51, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 52 cost time: 0.9085352420806885
Epoch: 52, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 53 cost time: 0.989140510559082
Epoch: 53, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0575320720672607
Epoch: 54, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0109319686889648
Epoch: 55, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1102657318115234
Epoch: 56, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.189037561416626
Epoch: 57, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.811 Test Loss: 0.546 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811106).  Saving model ...
Epoch: 58 cost time: 1.1429557800292969
Epoch: 58, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.811 Test Loss: 0.536 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 59 cost time: 1.1735172271728516
Epoch: 59, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 60 cost time: 1.127049207687378
Epoch: 60, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 61 cost time: 1.098313570022583
Epoch: 61, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 62 cost time: 1.1562082767486572
Epoch: 62, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 63 cost time: 1.1770081520080566
Epoch: 63, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 64 cost time: 1.0945734977722168
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 65 cost time: 1.0537970066070557
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 66 cost time: 0.996070146560669
Epoch: 66, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 67 cost time: 0.9630527496337891
Epoch: 67, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.466 Vali Acc: 0.830 Test Loss: 0.466 Test Acc: 0.830
Validation loss decreased (-0.822218 --> -0.829625).  Saving model ...
Epoch: 68 cost time: 1.041917324066162
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.462 Vali Acc: 0.837 Test Loss: 0.462 Test Acc: 0.837
Validation loss decreased (-0.829625 --> -0.837032).  Saving model ...
Epoch: 69 cost time: 1.156785488128662
Epoch: 69, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.458 Vali Acc: 0.837 Test Loss: 0.458 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 70 cost time: 1.0977869033813477
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.456 Vali Acc: 0.837 Test Loss: 0.456 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 71 cost time: 1.1879291534423828
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.454 Vali Acc: 0.837 Test Loss: 0.454 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 72 cost time: 1.0889146327972412
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.452 Vali Acc: 0.837 Test Loss: 0.452 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837033).  Saving model ...
Epoch: 73 cost time: 1.2199718952178955
Epoch: 73, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.451 Vali Acc: 0.837 Test Loss: 0.451 Test Acc: 0.837
Validation loss decreased (-0.837033 --> -0.837033).  Saving model ...
Epoch: 74 cost time: 1.198063850402832
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.452 Vali Acc: 0.837 Test Loss: 0.452 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.061635971069336
Epoch: 75, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.452 Vali Acc: 0.837 Test Loss: 0.452 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.126185655593872
Epoch: 76, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.452 Vali Acc: 0.837 Test Loss: 0.452 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.100846290588379
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.451 Vali Acc: 0.837 Test Loss: 0.451 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.0224978923797607
Epoch: 78, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.451 Vali Acc: 0.837 Test Loss: 0.451 Test Acc: 0.837
Validation loss decreased (-0.837033 --> -0.837033).  Saving model ...
Epoch: 79 cost time: 1.0190486907958984
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.448 Vali Acc: 0.837 Test Loss: 0.448 Test Acc: 0.837
Validation loss decreased (-0.837033 --> -0.837033).  Saving model ...
Epoch: 80 cost time: 1.1265652179718018
Epoch: 80, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.837033 --> -0.848144).  Saving model ...
Epoch: 81 cost time: 1.0327355861663818
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 82 cost time: 1.033926010131836
Epoch: 82, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 83 cost time: 0.9878997802734375
Epoch: 83, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 84 cost time: 1.1273682117462158
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 85 cost time: 1.1235246658325195
Epoch: 85, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.423 Vali Acc: 0.859 Test Loss: 0.423 Test Acc: 0.859
Validation loss decreased (-0.848144 --> -0.859255).  Saving model ...
Epoch: 86 cost time: 1.0854449272155762
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866662).  Saving model ...
Epoch: 87 cost time: 1.193803071975708
Epoch: 87, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 88 cost time: 1.1590909957885742
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 89 cost time: 1.1481945514678955
Epoch: 89, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 90 cost time: 1.057990550994873
Epoch: 90, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 91 cost time: 0.9491868019104004
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 92 cost time: 1.0044219493865967
Epoch: 92, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.398 Vali Acc: 0.874 Test Loss: 0.398 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 93 cost time: 1.1451020240783691
Epoch: 93, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 94 cost time: 1.1728241443634033
Epoch: 94, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 95 cost time: 1.1133322715759277
Epoch: 95, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.392 Vali Acc: 0.874 Test Loss: 0.392 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.2491719722747803
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.390 Vali Acc: 0.874 Test Loss: 0.390 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.1725201606750488
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.874 Test Loss: 0.388 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.0605823993682861
Epoch: 98, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.874 Test Loss: 0.386 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.160883903503418
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.874 Test Loss: 0.384 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 1.0966200828552246
Epoch: 100, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3756003379821777
Epoch: 1, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.772 Vali Acc: 0.211 Test Loss: 1.772 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.1804537773132324
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.767 Vali Acc: 0.215 Test Loss: 1.767 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.9755003452301025
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.760 Vali Acc: 0.219 Test Loss: 1.760 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.9654183387756348
Epoch: 4, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.747 Vali Acc: 0.237 Test Loss: 1.747 Test Acc: 0.237
Validation loss decreased (-0.218501 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 0.9377701282501221
Epoch: 5, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.730 Vali Acc: 0.267 Test Loss: 1.730 Test Acc: 0.267
Validation loss decreased (-0.237020 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 1.0749080181121826
Epoch: 6, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.711 Vali Acc: 0.293 Test Loss: 1.711 Test Acc: 0.293
Validation loss decreased (-0.266649 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 1.0603060722351074
Epoch: 7, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.688 Vali Acc: 0.307 Test Loss: 1.688 Test Acc: 0.307
Validation loss decreased (-0.292575 --> -0.307391).  Saving model ...
Epoch: 8 cost time: 1.0970208644866943
Epoch: 8, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.663 Vali Acc: 0.326 Test Loss: 1.663 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 9 cost time: 1.072934627532959
Epoch: 9, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.637 Vali Acc: 0.348 Test Loss: 1.637 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348132).  Saving model ...
Epoch: 10 cost time: 1.1090593338012695
Epoch: 10, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.609 Vali Acc: 0.370 Test Loss: 1.609 Test Acc: 0.370
Validation loss decreased (-0.348132 --> -0.370354).  Saving model ...
Epoch: 11 cost time: 1.1071364879608154
Epoch: 11, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.579 Vali Acc: 0.381 Test Loss: 1.579 Test Acc: 0.381
Validation loss decreased (-0.370354 --> -0.381466).  Saving model ...
Epoch: 12 cost time: 1.1089038848876953
Epoch: 12, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
Validation loss decreased (-0.381466 --> -0.399985).  Saving model ...
Epoch: 13 cost time: 1.2167677879333496
Epoch: 13, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.516 Vali Acc: 0.419 Test Loss: 1.516 Test Acc: 0.419
Validation loss decreased (-0.399985 --> -0.418503).  Saving model ...
Epoch: 14 cost time: 1.1413614749908447
Epoch: 14, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.482 Vali Acc: 0.463 Test Loss: 1.482 Test Acc: 0.463
Validation loss decreased (-0.418503 --> -0.462948).  Saving model ...
Epoch: 15 cost time: 1.0340733528137207
Epoch: 15, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.448 Vali Acc: 0.500 Test Loss: 1.448 Test Acc: 0.500
Validation loss decreased (-0.462948 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 1.0506672859191895
Epoch: 16, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.412 Vali Acc: 0.530 Test Loss: 1.412 Test Acc: 0.530
Validation loss decreased (-0.499986 --> -0.529616).  Saving model ...
Epoch: 17 cost time: 1.1169424057006836
Epoch: 17, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.375 Vali Acc: 0.537 Test Loss: 1.375 Test Acc: 0.537
Validation loss decreased (-0.529616 --> -0.537023).  Saving model ...
Epoch: 18 cost time: 1.0565481185913086
Epoch: 18, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.337 Vali Acc: 0.563 Test Loss: 1.337 Test Acc: 0.563
Validation loss decreased (-0.537023 --> -0.562950).  Saving model ...
Epoch: 19 cost time: 1.049987554550171
Epoch: 19, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.298 Vali Acc: 0.600 Test Loss: 1.298 Test Acc: 0.600
Validation loss decreased (-0.562950 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 0.9911046028137207
Epoch: 20, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.259 Vali Acc: 0.622 Test Loss: 1.259 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622210).  Saving model ...
Epoch: 21 cost time: 1.113659381866455
Epoch: 21, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.220 Vali Acc: 0.656 Test Loss: 1.220 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655543).  Saving model ...
Epoch: 22 cost time: 1.1225988864898682
Epoch: 22, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.181 Vali Acc: 0.678 Test Loss: 1.181 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677766).  Saving model ...
Epoch: 23 cost time: 1.2258331775665283
Epoch: 23, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.141 Vali Acc: 0.704 Test Loss: 1.141 Test Acc: 0.704
Validation loss decreased (-0.677766 --> -0.703692).  Saving model ...
Epoch: 24 cost time: 1.1508002281188965
Epoch: 24, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.102 Vali Acc: 0.737 Test Loss: 1.102 Test Acc: 0.737
Validation loss decreased (-0.703692 --> -0.737026).  Saving model ...
Epoch: 25 cost time: 1.1846566200256348
Epoch: 25, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.063 Vali Acc: 0.756 Test Loss: 1.063 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 26 cost time: 1.0594747066497803
Epoch: 26, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.025 Vali Acc: 0.770 Test Loss: 1.025 Test Acc: 0.770
Validation loss decreased (-0.755545 --> -0.770360).  Saving model ...
Epoch: 27 cost time: 1.0747535228729248
Epoch: 27, Steps: 2 | Train Loss: 1.097 Vali Loss: 0.986 Vali Acc: 0.796 Test Loss: 0.986 Test Acc: 0.796
Validation loss decreased (-0.770360 --> -0.796286).  Saving model ...
Epoch: 28 cost time: 0.9182131290435791
Epoch: 28, Steps: 2 | Train Loss: 0.999 Vali Loss: 0.948 Vali Acc: 0.796 Test Loss: 0.948 Test Acc: 0.796
Validation loss decreased (-0.796286 --> -0.796287).  Saving model ...
Epoch: 29 cost time: 0.992002010345459
Epoch: 29, Steps: 2 | Train Loss: 1.041 Vali Loss: 0.910 Vali Acc: 0.804 Test Loss: 0.910 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 30 cost time: 0.9131722450256348
Epoch: 30, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.872 Vali Acc: 0.822 Test Loss: 0.872 Test Acc: 0.822
Validation loss decreased (-0.803695 --> -0.822214).  Saving model ...
Epoch: 31 cost time: 0.9689488410949707
Epoch: 31, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.834 Vali Acc: 0.830 Test Loss: 0.834 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829621).  Saving model ...
Epoch: 32 cost time: 1.135758876800537
Epoch: 32, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
Validation loss decreased (-0.829621 --> -0.844436).  Saving model ...
Epoch: 33 cost time: 1.167431354522705
Epoch: 33, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.760 Vali Acc: 0.852 Test Loss: 0.760 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 34 cost time: 1.181434154510498
Epoch: 34, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.724 Vali Acc: 0.870 Test Loss: 0.724 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 35 cost time: 1.1382451057434082
Epoch: 35, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 36 cost time: 1.1018311977386475
Epoch: 36, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.653 Vali Acc: 0.893 Test Loss: 0.653 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892586).  Saving model ...
Epoch: 37 cost time: 1.074570894241333
Epoch: 37, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.621 Vali Acc: 0.893 Test Loss: 0.621 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 38 cost time: 1.1166980266571045
Epoch: 38, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.588 Vali Acc: 0.907 Test Loss: 0.588 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907402).  Saving model ...
Epoch: 39 cost time: 1.0888018608093262
Epoch: 39, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.555 Vali Acc: 0.904 Test Loss: 0.555 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.047663927078247
Epoch: 40, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.524 Vali Acc: 0.911 Test Loss: 0.524 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 41 cost time: 1.0715391635894775
Epoch: 41, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.493 Vali Acc: 0.907 Test Loss: 0.493 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9900104999542236
Epoch: 42, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.464 Vali Acc: 0.907 Test Loss: 0.464 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0249040126800537
Epoch: 43, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 44 cost time: 1.1108171939849854
Epoch: 44, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 45 cost time: 1.0924413204193115
Epoch: 45, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 46 cost time: 1.0616192817687988
Epoch: 46, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.370 Vali Acc: 0.919 Test Loss: 0.370 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 47 cost time: 1.052668571472168
Epoch: 47, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 48 cost time: 1.0024430751800537
Epoch: 48, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0865814685821533
Epoch: 49, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.993077278137207
Epoch: 50, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.299 Vali Acc: 0.915 Test Loss: 0.299 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.021630048751831
Epoch: 51, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0041263103485107
Epoch: 52, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.915 Test Loss: 0.276 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.14988374710083
Epoch: 53, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.268 Vali Acc: 0.915 Test Loss: 0.268 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.073195219039917
Epoch: 54, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.259 Vali Acc: 0.915 Test Loss: 0.259 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.344985008239746
Epoch: 55, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 1.2174098491668701
Epoch: 56, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 1.1393587589263916
Epoch: 57, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 1.0414760112762451
Epoch: 58, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 1.1165006160736084
Epoch: 59, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 1.2434353828430176
Epoch: 60, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 1.1181139945983887
Epoch: 61, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 1.0058245658874512
Epoch: 62, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 63 cost time: 0.9340808391571045
Epoch: 63, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.9976723194122314
Epoch: 64, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9612007141113281
Epoch: 65, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9922981262207031
Epoch: 66, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.9206283092498779
Epoch: 67, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.992424726486206
Epoch: 68, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.8980495929718018
Epoch: 69, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 70 cost time: 1.0814237594604492
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 71 cost time: 1.0761723518371582
Epoch: 71, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0857141017913818
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.082162618637085
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0736896991729736
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1260089874267578
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.1719238758087158
Epoch: 76, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.1349449157714844
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.0273196697235107
Epoch: 78, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.1701364517211914
Epoch: 79, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.0452182292938232
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5307130813598633
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.878 Vali Acc: 0.115 Test Loss: 1.878 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.9800126552581787
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.874 Vali Acc: 0.122 Test Loss: 1.874 Test Acc: 0.122
Validation loss decreased (-0.114796 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.9688742160797119
Epoch: 3, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.868 Vali Acc: 0.122 Test Loss: 1.868 Test Acc: 0.122
Validation loss decreased (-0.122203 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 1.077009677886963
Epoch: 4, Steps: 2 | Train Loss: 1.922 Vali Loss: 1.855 Vali Acc: 0.115 Test Loss: 1.855 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0376091003417969
Epoch: 5, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.838 Vali Acc: 0.130 Test Loss: 1.838 Test Acc: 0.130
Validation loss decreased (-0.122204 --> -0.129611).  Saving model ...
Epoch: 6 cost time: 1.0957038402557373
Epoch: 6, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.818 Vali Acc: 0.148 Test Loss: 1.818 Test Acc: 0.148
Validation loss decreased (-0.129611 --> -0.148130).  Saving model ...
Epoch: 7 cost time: 1.0615534782409668
Epoch: 7, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.795 Vali Acc: 0.159 Test Loss: 1.795 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 8 cost time: 0.9871888160705566
Epoch: 8, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.769 Vali Acc: 0.196 Test Loss: 1.769 Test Acc: 0.196
Validation loss decreased (-0.159241 --> -0.196279).  Saving model ...
Epoch: 9 cost time: 1.0323965549468994
Epoch: 9, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.741 Vali Acc: 0.233 Test Loss: 1.741 Test Acc: 0.233
Validation loss decreased (-0.196279 --> -0.233316).  Saving model ...
Epoch: 10 cost time: 0.9947159290313721
Epoch: 10, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.710 Vali Acc: 0.270 Test Loss: 1.710 Test Acc: 0.270
Validation loss decreased (-0.233316 --> -0.270353).  Saving model ...
Epoch: 11 cost time: 0.9821152687072754
Epoch: 11, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.677 Vali Acc: 0.311 Test Loss: 1.677 Test Acc: 0.311
Validation loss decreased (-0.270353 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 1.0450754165649414
Epoch: 12, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.642 Vali Acc: 0.341 Test Loss: 1.642 Test Acc: 0.341
Validation loss decreased (-0.311094 --> -0.340724).  Saving model ...
Epoch: 13 cost time: 0.9395427703857422
Epoch: 13, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.606 Vali Acc: 0.393 Test Loss: 1.606 Test Acc: 0.393
Validation loss decreased (-0.340724 --> -0.392577).  Saving model ...
Epoch: 14 cost time: 0.9921760559082031
Epoch: 14, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.568 Vali Acc: 0.433 Test Loss: 1.568 Test Acc: 0.433
Validation loss decreased (-0.392577 --> -0.433318).  Saving model ...
Epoch: 15 cost time: 1.1923563480377197
Epoch: 15, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.527 Vali Acc: 0.478 Test Loss: 1.527 Test Acc: 0.478
Validation loss decreased (-0.433318 --> -0.477763).  Saving model ...
Epoch: 16 cost time: 1.047159194946289
Epoch: 16, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.486 Vali Acc: 0.507 Test Loss: 1.486 Test Acc: 0.507
Validation loss decreased (-0.477763 --> -0.507393).  Saving model ...
Epoch: 17 cost time: 1.0652732849121094
Epoch: 17, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.444 Vali Acc: 0.541 Test Loss: 1.444 Test Acc: 0.541
Validation loss decreased (-0.507393 --> -0.540726).  Saving model ...
Epoch: 18 cost time: 1.0661249160766602
Epoch: 18, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.401 Vali Acc: 0.567 Test Loss: 1.401 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566653).  Saving model ...
Epoch: 19 cost time: 0.9801554679870605
Epoch: 19, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.358 Vali Acc: 0.596 Test Loss: 1.358 Test Acc: 0.596
Validation loss decreased (-0.566653 --> -0.596283).  Saving model ...
Epoch: 20 cost time: 1.1397528648376465
Epoch: 20, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
Validation loss decreased (-0.596283 --> -0.622209).  Saving model ...
Epoch: 21 cost time: 1.0466821193695068
Epoch: 21, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.271 Vali Acc: 0.641 Test Loss: 1.271 Test Acc: 0.641
Validation loss decreased (-0.622209 --> -0.640728).  Saving model ...
Epoch: 22 cost time: 1.1441411972045898
Epoch: 22, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.228 Vali Acc: 0.681 Test Loss: 1.228 Test Acc: 0.681
Validation loss decreased (-0.640728 --> -0.681469).  Saving model ...
Epoch: 23 cost time: 1.0067951679229736
Epoch: 23, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.186 Vali Acc: 0.707 Test Loss: 1.186 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707396).  Saving model ...
Epoch: 24 cost time: 1.0516119003295898
Epoch: 24, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.143 Vali Acc: 0.715 Test Loss: 1.143 Test Acc: 0.715
Validation loss decreased (-0.707396 --> -0.714803).  Saving model ...
Epoch: 25 cost time: 0.9618270397186279
Epoch: 25, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.101 Vali Acc: 0.756 Test Loss: 1.101 Test Acc: 0.756
Validation loss decreased (-0.714803 --> -0.755545).  Saving model ...
Epoch: 26 cost time: 1.0588502883911133
Epoch: 26, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.061 Vali Acc: 0.767 Test Loss: 1.061 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766656).  Saving model ...
Epoch: 27 cost time: 0.9352114200592041
Epoch: 27, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.020 Vali Acc: 0.770 Test Loss: 1.020 Test Acc: 0.770
Validation loss decreased (-0.766656 --> -0.770360).  Saving model ...
Epoch: 28 cost time: 1.0762743949890137
Epoch: 28, Steps: 2 | Train Loss: 1.135 Vali Loss: 0.981 Vali Acc: 0.781 Test Loss: 0.981 Test Acc: 0.781
Validation loss decreased (-0.770360 --> -0.781472).  Saving model ...
Epoch: 29 cost time: 1.1397323608398438
Epoch: 29, Steps: 2 | Train Loss: 1.080 Vali Loss: 0.941 Vali Acc: 0.796 Test Loss: 0.941 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796287).  Saving model ...
Epoch: 30 cost time: 1.175257921218872
Epoch: 30, Steps: 2 | Train Loss: 0.958 Vali Loss: 0.901 Vali Acc: 0.793 Test Loss: 0.901 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1748268604278564
Epoch: 31, Steps: 2 | Train Loss: 1.078 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
Validation loss decreased (-0.796287 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 1.1660256385803223
Epoch: 32, Steps: 2 | Train Loss: 1.014 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 1.0149805545806885
Epoch: 33, Steps: 2 | Train Loss: 0.968 Vali Loss: 0.785 Vali Acc: 0.811 Test Loss: 0.785 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 34 cost time: 1.2021348476409912
Epoch: 34, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 35 cost time: 1.1193950176239014
Epoch: 35, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.708 Vali Acc: 0.833 Test Loss: 0.708 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 36 cost time: 0.993110179901123
Epoch: 36, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855549).  Saving model ...
Epoch: 37 cost time: 0.9888455867767334
Epoch: 37, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 38 cost time: 1.0091571807861328
Epoch: 38, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.598 Vali Acc: 0.881 Test Loss: 0.598 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881476).  Saving model ...
Epoch: 39 cost time: 0.992189884185791
Epoch: 39, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.562 Vali Acc: 0.893 Test Loss: 0.562 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892587).  Saving model ...
Epoch: 40 cost time: 1.1068127155303955
Epoch: 40, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 41 cost time: 1.070288896560669
Epoch: 41, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.494 Vali Acc: 0.919 Test Loss: 0.494 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 42 cost time: 1.2672762870788574
Epoch: 42, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 43 cost time: 1.2130892276763916
Epoch: 43, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.431 Vali Acc: 0.926 Test Loss: 0.431 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 44 cost time: 1.1088955402374268
Epoch: 44, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 45 cost time: 1.2178046703338623
Epoch: 45, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.381 Vali Acc: 0.930 Test Loss: 0.381 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 46 cost time: 1.191474437713623
Epoch: 46, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 1.2029352188110352
Epoch: 47, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 48 cost time: 1.2856667041778564
Epoch: 48, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.080608606338501
Epoch: 49, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0434250831604004
Epoch: 50, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0124998092651367
Epoch: 51, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 1.0872704982757568
Epoch: 52, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 1.0861001014709473
Epoch: 53, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.253795862197876
Epoch: 54, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.1849708557128906
Epoch: 55, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 1.1496996879577637
Epoch: 56, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1642332077026367
Epoch: 57, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 1.1518521308898926
Epoch: 58, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0913469791412354
Epoch: 59, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0981380939483643
Epoch: 60, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0573906898498535
Epoch: 61, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.039360523223877
Epoch: 62, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.117605209350586
Epoch: 63, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0889239311218262
Epoch: 64, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.1453700065612793
Epoch: 65, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1010658740997314
Epoch: 66, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.1981678009033203
Epoch: 67, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.267493963241577
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.9859733581542969
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0635731220245361
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.9857776165008545
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.0509226322174072
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.038222312927246
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9396567344665527
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9457144737243652
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 0.998502254486084
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 0.9085092544555664
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 0.9564085006713867
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0059232711791992
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.1460416316986084
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0156030654907227
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0267393589019775
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 0.9771885871887207
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.0710062980651855
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9835944175720215
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.0696587562561035
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 0.9302418231964111
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 0.9683616161346436
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 0.9868838787078857
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 0.9529573917388916
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 0.9719171524047852
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0805590152740479
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.0938129425048828
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1562864780426025
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0108683109283447
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.0896580219268799
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.181952953338623
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.2081751823425293
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.1440544128417969
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.1126015186309814
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.0172481536865234
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.012192726135254
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.037287950515747
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.1697468757629395
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.093827247619629
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.0286169052124023
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0635261535644531
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.1346840858459473
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.111469030380249
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1622114181518555
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.1579957008361816
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2119123935699463
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.276097297668457
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.0733067989349365
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.1340227127075195
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.105647325515747
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.0625178813934326
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.1014070510864258
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.010117769241333
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 0.976372241973877
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.1381003856658936
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.23228120803833
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.173809289932251
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1637322902679443
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.2108714580535889
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.3482346534729004
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.137375831604004
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.084721326828003
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.0829486846923828
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 0.9702515602111816
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.0997886657714844
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.277965784072876
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.0693933963775635
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1117222309112549
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.2574703693389893
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.2059710025787354
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.276001214981079
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0978550910949707
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.142465353012085
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.1268656253814697
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.0349438190460205
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.0556836128234863
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0715396404266357
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.1761674880981445
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9965376853942871
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.0635223388671875
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.030946969985962
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.1204321384429932
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.1822412014007568
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.1068856716156006
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.1322484016418457
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.177208662033081
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.1485717296600342
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 0.98526930809021
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.059828281402588
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 0.8564784526824951
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.0229859352111816
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.142303705215454
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 1.0062167644500732
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.1727986335754395
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1377151012420654
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.1554286479949951
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.0852580070495605
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.2277772426605225
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.1812167167663574
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.2569315433502197
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.114140272140503
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 553158
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1970362663269043
Epoch: 1, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.805 Vali Acc: 0.174 Test Loss: 1.805 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.8665499687194824
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.781 Vali Acc: 0.211 Test Loss: 1.781 Test Acc: 0.211
Validation loss decreased (-0.174056 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 1.0613226890563965
Epoch: 3, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.758 Vali Acc: 0.244 Test Loss: 1.758 Test Acc: 0.244
Validation loss decreased (-0.211093 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 1.024024486541748
Epoch: 4, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.729 Vali Acc: 0.281 Test Loss: 1.729 Test Acc: 0.281
Validation loss decreased (-0.244427 --> -0.281464).  Saving model ...
Epoch: 5 cost time: 1.1409742832183838
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.691 Vali Acc: 0.344 Test Loss: 1.691 Test Acc: 0.344
Validation loss decreased (-0.281464 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 1.0143067836761475
Epoch: 6, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.647 Vali Acc: 0.393 Test Loss: 1.647 Test Acc: 0.393
Validation loss decreased (-0.344428 --> -0.392576).  Saving model ...
Epoch: 7 cost time: 1.0125377178192139
Epoch: 7, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.598 Vali Acc: 0.459 Test Loss: 1.598 Test Acc: 0.459
Validation loss decreased (-0.392576 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 1.0492055416107178
Epoch: 8, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.546 Vali Acc: 0.519 Test Loss: 1.546 Test Acc: 0.519
Validation loss decreased (-0.459243 --> -0.518503).  Saving model ...
Epoch: 9 cost time: 1.083383560180664
Epoch: 9, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.493 Vali Acc: 0.570 Test Loss: 1.493 Test Acc: 0.570
Validation loss decreased (-0.518503 --> -0.570355).  Saving model ...
Epoch: 10 cost time: 1.0062668323516846
Epoch: 10, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.437 Vali Acc: 0.611 Test Loss: 1.437 Test Acc: 0.611
Validation loss decreased (-0.570355 --> -0.611097).  Saving model ...
Epoch: 11 cost time: 1.1670072078704834
Epoch: 11, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.380 Vali Acc: 0.652 Test Loss: 1.380 Test Acc: 0.652
Validation loss decreased (-0.611097 --> -0.651838).  Saving model ...
Epoch: 12 cost time: 0.9942834377288818
Epoch: 12, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.323 Vali Acc: 0.674 Test Loss: 1.323 Test Acc: 0.674
Validation loss decreased (-0.651838 --> -0.674061).  Saving model ...
Epoch: 13 cost time: 1.1351242065429688
Epoch: 13, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.267 Vali Acc: 0.696 Test Loss: 1.267 Test Acc: 0.696
Validation loss decreased (-0.674061 --> -0.696284).  Saving model ...
Epoch: 14 cost time: 0.9924509525299072
Epoch: 14, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.211 Vali Acc: 0.707 Test Loss: 1.211 Test Acc: 0.707
Validation loss decreased (-0.696284 --> -0.707395).  Saving model ...
Epoch: 15 cost time: 1.078244686126709
Epoch: 15, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.158 Vali Acc: 0.719 Test Loss: 1.158 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718507).  Saving model ...
Epoch: 16 cost time: 0.8948531150817871
Epoch: 16, Steps: 2 | Train Loss: 0.811 Vali Loss: 1.106 Vali Acc: 0.737 Test Loss: 1.106 Test Acc: 0.737
Validation loss decreased (-0.718507 --> -0.737026).  Saving model ...
Epoch: 17 cost time: 1.250316858291626
Epoch: 17, Steps: 2 | Train Loss: 0.672 Vali Loss: 1.057 Vali Acc: 0.756 Test Loss: 1.057 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 18 cost time: 0.9874179363250732
Epoch: 18, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.010 Vali Acc: 0.763 Test Loss: 1.010 Test Acc: 0.763
Validation loss decreased (-0.755545 --> -0.762953).  Saving model ...
Epoch: 19 cost time: 0.9521992206573486
Epoch: 19, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.967 Vali Acc: 0.767 Test Loss: 0.967 Test Acc: 0.767
Validation loss decreased (-0.762953 --> -0.766657).  Saving model ...
Epoch: 20 cost time: 1.0898926258087158
Epoch: 20, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.926 Vali Acc: 0.759 Test Loss: 0.926 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0686492919921875
Epoch: 21, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.888 Vali Acc: 0.763 Test Loss: 0.888 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9416697025299072
Epoch: 22, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.853 Vali Acc: 0.763 Test Loss: 0.853 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9553699493408203
Epoch: 23, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.821 Vali Acc: 0.770 Test Loss: 0.821 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770362).  Saving model ...
Epoch: 24 cost time: 0.9918551445007324
Epoch: 24, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.792 Vali Acc: 0.781 Test Loss: 0.792 Test Acc: 0.781
Validation loss decreased (-0.770362 --> -0.781474).  Saving model ...
Epoch: 25 cost time: 1.0603365898132324
Epoch: 25, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.767 Vali Acc: 0.781 Test Loss: 0.767 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 26 cost time: 0.9913184642791748
Epoch: 26, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.746 Vali Acc: 0.774 Test Loss: 0.746 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0078678131103516
Epoch: 27, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.727 Vali Acc: 0.774 Test Loss: 0.727 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9747180938720703
Epoch: 28, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.710 Vali Acc: 0.774 Test Loss: 0.710 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.007091760635376
Epoch: 29, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.694 Vali Acc: 0.785 Test Loss: 0.694 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 30 cost time: 1.1053190231323242
Epoch: 30, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.681 Vali Acc: 0.785 Test Loss: 0.681 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 31 cost time: 1.1829242706298828
Epoch: 31, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 32 cost time: 1.1421053409576416
Epoch: 32, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.662 Vali Acc: 0.793 Test Loss: 0.662 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 33 cost time: 1.0708577632904053
Epoch: 33, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.655 Vali Acc: 0.793 Test Loss: 0.655 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 34 cost time: 1.1637613773345947
Epoch: 34, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.650 Vali Acc: 0.793 Test Loss: 0.650 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 35 cost time: 1.1680355072021484
Epoch: 35, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.646 Vali Acc: 0.793 Test Loss: 0.646 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 36 cost time: 1.1197211742401123
Epoch: 36, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.642 Vali Acc: 0.793 Test Loss: 0.642 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 37 cost time: 1.057741641998291
Epoch: 37, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.638 Vali Acc: 0.793 Test Loss: 0.638 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 38 cost time: 0.963634729385376
Epoch: 38, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.636 Vali Acc: 0.793 Test Loss: 0.636 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 39 cost time: 1.08988618850708
Epoch: 39, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.633 Vali Acc: 0.793 Test Loss: 0.633 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 40 cost time: 1.01763916015625
Epoch: 40, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 41 cost time: 0.9751791954040527
Epoch: 41, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.628 Vali Acc: 0.793 Test Loss: 0.628 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0345516204833984
Epoch: 42, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.626 Vali Acc: 0.793 Test Loss: 0.626 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.195749044418335
Epoch: 43, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.624 Vali Acc: 0.793 Test Loss: 0.624 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1080045700073242
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.622 Vali Acc: 0.793 Test Loss: 0.622 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1291184425354004
Epoch: 45, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 46 cost time: 1.1775102615356445
Epoch: 46, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 47 cost time: 1.1876442432403564
Epoch: 47, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 48 cost time: 1.1281685829162598
Epoch: 48, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 49 cost time: 1.0908968448638916
Epoch: 49, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 50 cost time: 1.0504801273345947
Epoch: 50, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 51 cost time: 0.9908950328826904
Epoch: 51, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 52 cost time: 1.0238749980926514
Epoch: 52, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.607 Vali Acc: 0.807 Test Loss: 0.607 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807401).  Saving model ...
Epoch: 53 cost time: 0.9986724853515625
Epoch: 53, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.807 Test Loss: 0.605 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 54 cost time: 1.0653140544891357
Epoch: 54, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 55 cost time: 1.0993008613586426
Epoch: 55, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.601 Vali Acc: 0.815 Test Loss: 0.601 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 56 cost time: 1.175546646118164
Epoch: 56, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.815 Test Loss: 0.599 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 57 cost time: 1.0853440761566162
Epoch: 57, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 58 cost time: 1.0681209564208984
Epoch: 58, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.595 Vali Acc: 0.815 Test Loss: 0.595 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 59 cost time: 1.1530966758728027
Epoch: 59, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 60 cost time: 1.1133012771606445
Epoch: 60, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.815 Test Loss: 0.591 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 61 cost time: 1.0586707592010498
Epoch: 61, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 62 cost time: 1.0463228225708008
Epoch: 62, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 63 cost time: 1.042107343673706
Epoch: 63, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 64 cost time: 1.0890171527862549
Epoch: 64, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 65 cost time: 1.0332443714141846
Epoch: 65, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 66 cost time: 1.0635080337524414
Epoch: 66, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 67 cost time: 1.1408865451812744
Epoch: 67, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 68 cost time: 1.1999421119689941
Epoch: 68, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 69 cost time: 1.2434489727020264
Epoch: 69, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 70 cost time: 1.0723297595977783
Epoch: 70, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 71 cost time: 1.1760632991790771
Epoch: 71, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.573 Vali Acc: 0.830 Test Loss: 0.573 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 72 cost time: 1.2002842426300049
Epoch: 72, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.571 Vali Acc: 0.830 Test Loss: 0.571 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 73 cost time: 1.1319079399108887
Epoch: 73, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.830 Test Loss: 0.569 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 74 cost time: 1.0857553482055664
Epoch: 74, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.567 Vali Acc: 0.830 Test Loss: 0.567 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 75 cost time: 1.0357897281646729
Epoch: 75, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.830 Test Loss: 0.566 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 76 cost time: 0.9979634284973145
Epoch: 76, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.830 Test Loss: 0.564 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 77 cost time: 1.0790929794311523
Epoch: 77, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.830 Test Loss: 0.562 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 78 cost time: 1.143239974975586
Epoch: 78, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.830 Test Loss: 0.560 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 79 cost time: 1.2098743915557861
Epoch: 79, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.830 Test Loss: 0.558 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 80 cost time: 1.1284024715423584
Epoch: 80, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 81 cost time: 1.131777048110962
Epoch: 81, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 82 cost time: 1.081007480621338
Epoch: 82, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 83 cost time: 1.031358242034912
Epoch: 83, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.837 Test Loss: 0.550 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 84 cost time: 1.1499335765838623
Epoch: 84, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.837 Test Loss: 0.548 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 85 cost time: 1.1744487285614014
Epoch: 85, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.837 Test Loss: 0.546 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 86 cost time: 1.1877191066741943
Epoch: 86, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.837 Test Loss: 0.544 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 87 cost time: 1.0510351657867432
Epoch: 87, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.542 Vali Acc: 0.837 Test Loss: 0.542 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 88 cost time: 0.9635543823242188
Epoch: 88, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.837 Test Loss: 0.541 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 89 cost time: 1.0552127361297607
Epoch: 89, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.837 Test Loss: 0.539 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 90 cost time: 1.0611155033111572
Epoch: 90, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9929354190826416
Epoch: 91, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.99114990234375
Epoch: 92, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.837 Test Loss: 0.535 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 93 cost time: 1.0827221870422363
Epoch: 93, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.837 Test Loss: 0.534 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 94 cost time: 0.9875059127807617
Epoch: 94, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.837 Test Loss: 0.532 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 95 cost time: 0.9535007476806641
Epoch: 95, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.837 Test Loss: 0.531 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 96 cost time: 1.194789171218872
Epoch: 96, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.837 Test Loss: 0.529 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 97 cost time: 1.0813448429107666
Epoch: 97, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.837 Test Loss: 0.527 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 98 cost time: 1.186307430267334
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.837 Test Loss: 0.526 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 99 cost time: 1.0846662521362305
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 100 cost time: 1.1626200675964355
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840736).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3537187576293945
Epoch: 1, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.778 Vali Acc: 0.230 Test Loss: 1.778 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 1.0698177814483643
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.761 Vali Acc: 0.267 Test Loss: 1.761 Test Acc: 0.267
Validation loss decreased (-0.229612 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.9173223972320557
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.744 Vali Acc: 0.289 Test Loss: 1.744 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288871).  Saving model ...
Epoch: 4 cost time: 0.9596824645996094
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.723 Vali Acc: 0.311 Test Loss: 1.723 Test Acc: 0.311
Validation loss decreased (-0.288871 --> -0.311094).  Saving model ...
Epoch: 5 cost time: 0.9441516399383545
Epoch: 5, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.695 Vali Acc: 0.370 Test Loss: 1.695 Test Acc: 0.370
Validation loss decreased (-0.311094 --> -0.370353).  Saving model ...
Epoch: 6 cost time: 1.0997848510742188
Epoch: 6, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.662 Vali Acc: 0.404 Test Loss: 1.662 Test Acc: 0.404
Validation loss decreased (-0.370353 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 1.113175630569458
Epoch: 7, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.626 Vali Acc: 0.452 Test Loss: 1.626 Test Acc: 0.452
Validation loss decreased (-0.403687 --> -0.451836).  Saving model ...
Epoch: 8 cost time: 1.0937275886535645
Epoch: 8, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.587 Vali Acc: 0.500 Test Loss: 1.587 Test Acc: 0.500
Validation loss decreased (-0.451836 --> -0.499984).  Saving model ...
Epoch: 9 cost time: 1.0209369659423828
Epoch: 9, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.547 Vali Acc: 0.537 Test Loss: 1.547 Test Acc: 0.537
Validation loss decreased (-0.499984 --> -0.537022).  Saving model ...
Epoch: 10 cost time: 1.176581621170044
Epoch: 10, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.505 Vali Acc: 0.544 Test Loss: 1.505 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544429).  Saving model ...
Epoch: 11 cost time: 1.0811245441436768
Epoch: 11, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.461 Vali Acc: 0.593 Test Loss: 1.461 Test Acc: 0.593
Validation loss decreased (-0.544429 --> -0.592578).  Saving model ...
Epoch: 12 cost time: 1.0986995697021484
Epoch: 12, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.418 Vali Acc: 0.607 Test Loss: 1.418 Test Acc: 0.607
Validation loss decreased (-0.592578 --> -0.607393).  Saving model ...
Epoch: 13 cost time: 0.9910256862640381
Epoch: 13, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.374 Vali Acc: 0.626 Test Loss: 1.374 Test Acc: 0.626
Validation loss decreased (-0.607393 --> -0.625912).  Saving model ...
Epoch: 14 cost time: 0.9488942623138428
Epoch: 14, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.331 Vali Acc: 0.644 Test Loss: 1.331 Test Acc: 0.644
Validation loss decreased (-0.625912 --> -0.644431).  Saving model ...
Epoch: 15 cost time: 0.9501700401306152
Epoch: 15, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.290 Vali Acc: 0.641 Test Loss: 1.290 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9809186458587646
Epoch: 16, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.248 Vali Acc: 0.648 Test Loss: 1.248 Test Acc: 0.648
Validation loss decreased (-0.644431 --> -0.648136).  Saving model ...
Epoch: 17 cost time: 1.0084969997406006
Epoch: 17, Steps: 2 | Train Loss: 0.789 Vali Loss: 1.208 Vali Acc: 0.667 Test Loss: 1.208 Test Acc: 0.667
Validation loss decreased (-0.648136 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 0.9031915664672852
Epoch: 18, Steps: 2 | Train Loss: 0.739 Vali Loss: 1.170 Vali Acc: 0.670 Test Loss: 1.170 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.670359).  Saving model ...
Epoch: 19 cost time: 0.8916668891906738
Epoch: 19, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.133 Vali Acc: 0.681 Test Loss: 1.133 Test Acc: 0.681
Validation loss decreased (-0.670359 --> -0.681470).  Saving model ...
Epoch: 20 cost time: 0.9922630786895752
Epoch: 20, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.097 Vali Acc: 0.689 Test Loss: 1.097 Test Acc: 0.689
Validation loss decreased (-0.681470 --> -0.688878).  Saving model ...
Epoch: 21 cost time: 0.9914455413818359
Epoch: 21, Steps: 2 | Train Loss: 0.582 Vali Loss: 1.063 Vali Acc: 0.693 Test Loss: 1.063 Test Acc: 0.693
Validation loss decreased (-0.688878 --> -0.692582).  Saving model ...
Epoch: 22 cost time: 1.077876329421997
Epoch: 22, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.031 Vali Acc: 0.693 Test Loss: 1.031 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 23 cost time: 0.9680788516998291
Epoch: 23, Steps: 2 | Train Loss: 0.422 Vali Loss: 1.000 Vali Acc: 0.693 Test Loss: 1.000 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692583).  Saving model ...
Epoch: 24 cost time: 1.0032947063446045
Epoch: 24, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.971 Vali Acc: 0.696 Test Loss: 0.971 Test Acc: 0.696
Validation loss decreased (-0.692583 --> -0.696287).  Saving model ...
Epoch: 25 cost time: 1.0980236530303955
Epoch: 25, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.944 Vali Acc: 0.704 Test Loss: 0.944 Test Acc: 0.704
Validation loss decreased (-0.696287 --> -0.703694).  Saving model ...
Epoch: 26 cost time: 0.9970057010650635
Epoch: 26, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.919 Vali Acc: 0.704 Test Loss: 0.919 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703695).  Saving model ...
Epoch: 27 cost time: 0.9312136173248291
Epoch: 27, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.895 Vali Acc: 0.704 Test Loss: 0.895 Test Acc: 0.704
Validation loss decreased (-0.703695 --> -0.703695).  Saving model ...
Epoch: 28 cost time: 0.9553849697113037
Epoch: 28, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.874 Vali Acc: 0.707 Test Loss: 0.874 Test Acc: 0.707
Validation loss decreased (-0.703695 --> -0.707399).  Saving model ...
Epoch: 29 cost time: 1.001133680343628
Epoch: 29, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.854 Vali Acc: 0.707 Test Loss: 0.854 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 30 cost time: 1.109595775604248
Epoch: 30, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
Validation loss decreased (-0.707399 --> -0.722214).  Saving model ...
Epoch: 31 cost time: 1.0815439224243164
Epoch: 31, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.820 Vali Acc: 0.722 Test Loss: 0.820 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 32 cost time: 1.0170893669128418
Epoch: 32, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.805 Vali Acc: 0.722 Test Loss: 0.805 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 33 cost time: 1.187558889389038
Epoch: 33, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.794 Vali Acc: 0.730 Test Loss: 0.794 Test Acc: 0.730
Validation loss decreased (-0.722214 --> -0.729622).  Saving model ...
Epoch: 34 cost time: 1.227552890777588
Epoch: 34, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 35 cost time: 1.1994163990020752
Epoch: 35, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.775 Vali Acc: 0.733 Test Loss: 0.775 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
Epoch: 36 cost time: 1.2088947296142578
Epoch: 36, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
Validation loss decreased (-0.733326 --> -0.737029).  Saving model ...
Epoch: 37 cost time: 1.0375306606292725
Epoch: 37, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.758 Vali Acc: 0.737 Test Loss: 0.758 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 38 cost time: 1.0826835632324219
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.751 Vali Acc: 0.741 Test Loss: 0.751 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 39 cost time: 1.1425132751464844
Epoch: 39, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 40 cost time: 1.051109790802002
Epoch: 40, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.738 Vali Acc: 0.748 Test Loss: 0.738 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 41 cost time: 1.1786220073699951
Epoch: 41, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.732 Vali Acc: 0.748 Test Loss: 0.732 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 42 cost time: 1.0563085079193115
Epoch: 42, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.726 Vali Acc: 0.748 Test Loss: 0.726 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 43 cost time: 0.9307091236114502
Epoch: 43, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.721 Vali Acc: 0.752 Test Loss: 0.721 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 44 cost time: 0.9834342002868652
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
Validation loss decreased (-0.751845 --> -0.762956).  Saving model ...
Epoch: 45 cost time: 1.047818899154663
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.712 Vali Acc: 0.759 Test Loss: 0.712 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9532146453857422
Epoch: 46, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.708 Vali Acc: 0.759 Test Loss: 0.708 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1332652568817139
Epoch: 47, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 48 cost time: 1.1522002220153809
Epoch: 48, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 49 cost time: 1.1320436000823975
Epoch: 49, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 50 cost time: 1.0704734325408936
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 51 cost time: 1.1677038669586182
Epoch: 51, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.687 Vali Acc: 0.770 Test Loss: 0.687 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 52 cost time: 1.041240930557251
Epoch: 52, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.683 Vali Acc: 0.774 Test Loss: 0.683 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 53 cost time: 0.9494271278381348
Epoch: 53, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.679 Vali Acc: 0.778 Test Loss: 0.679 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 54 cost time: 0.9181497097015381
Epoch: 54, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.674 Vali Acc: 0.778 Test Loss: 0.674 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 55 cost time: 0.9495089054107666
Epoch: 55, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.670 Vali Acc: 0.778 Test Loss: 0.670 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 56 cost time: 1.076732873916626
Epoch: 56, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.666 Vali Acc: 0.778 Test Loss: 0.666 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 57 cost time: 0.9597163200378418
Epoch: 57, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.662 Vali Acc: 0.778 Test Loss: 0.662 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 58 cost time: 0.9996767044067383
Epoch: 58, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.778 Test Loss: 0.658 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 59 cost time: 1.0680749416351318
Epoch: 59, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 60 cost time: 1.07777738571167
Epoch: 60, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.651 Vali Acc: 0.778 Test Loss: 0.651 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 61 cost time: 0.9105186462402344
Epoch: 61, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.778 Test Loss: 0.648 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 62 cost time: 0.966195821762085
Epoch: 62, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.644 Vali Acc: 0.778 Test Loss: 0.644 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 63 cost time: 1.0575065612792969
Epoch: 63, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 64 cost time: 1.0749905109405518
Epoch: 64, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 65 cost time: 1.0783228874206543
Epoch: 65, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.636 Vali Acc: 0.778 Test Loss: 0.636 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 66 cost time: 1.0934147834777832
Epoch: 66, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.778 Test Loss: 0.633 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 67 cost time: 1.0316290855407715
Epoch: 67, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 68 cost time: 1.0531296730041504
Epoch: 68, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.774 Test Loss: 0.627 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0392937660217285
Epoch: 69, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.774 Test Loss: 0.624 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.088167667388916
Epoch: 70, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.778 Test Loss: 0.621 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 71 cost time: 1.1634604930877686
Epoch: 71, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.781 Test Loss: 0.618 Test Acc: 0.781
Validation loss decreased (-0.777772 --> -0.781475).  Saving model ...
Epoch: 72 cost time: 1.087373971939087
Epoch: 72, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.781 Test Loss: 0.615 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 73 cost time: 1.0488231182098389
Epoch: 73, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.612 Vali Acc: 0.781 Test Loss: 0.612 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 74 cost time: 1.1779682636260986
Epoch: 74, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.785 Test Loss: 0.609 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 75 cost time: 1.0993068218231201
Epoch: 75, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 76 cost time: 1.1205129623413086
Epoch: 76, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.793 Test Loss: 0.604 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 77 cost time: 0.9839293956756592
Epoch: 77, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.793 Test Loss: 0.602 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 78 cost time: 0.9523143768310547
Epoch: 78, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.793 Test Loss: 0.599 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 79 cost time: 0.9881982803344727
Epoch: 79, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799994).  Saving model ...
Epoch: 80 cost time: 0.9945671558380127
Epoch: 80, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 81 cost time: 1.0265769958496094
Epoch: 81, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 82 cost time: 1.0703182220458984
Epoch: 82, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 83 cost time: 1.19407057762146
Epoch: 83, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 84 cost time: 1.1788477897644043
Epoch: 84, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.804 Test Loss: 0.585 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 85 cost time: 1.0912001132965088
Epoch: 85, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 86 cost time: 1.072110891342163
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.807 Test Loss: 0.582 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 87 cost time: 1.0848143100738525
Epoch: 87, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.807 Test Loss: 0.580 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 88 cost time: 1.0775730609893799
Epoch: 88, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.807 Test Loss: 0.578 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 89 cost time: 1.056030511856079
Epoch: 89, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.807 Test Loss: 0.577 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 90 cost time: 1.1076009273529053
Epoch: 90, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.811 Test Loss: 0.575 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 91 cost time: 0.997713565826416
Epoch: 91, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 92 cost time: 1.0551307201385498
Epoch: 92, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 93 cost time: 1.0145080089569092
Epoch: 93, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 94 cost time: 0.9945635795593262
Epoch: 94, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.815 Test Loss: 0.570 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 95 cost time: 1.0234394073486328
Epoch: 95, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 96 cost time: 1.1395955085754395
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.815 Test Loss: 0.567 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 97 cost time: 1.1073968410491943
Epoch: 97, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 98 cost time: 1.0992200374603271
Epoch: 98, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 99 cost time: 1.1075034141540527
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 100 cost time: 1.1363775730133057
Epoch: 100, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2041118144989014
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.796 Vali Acc: 0.226 Test Loss: 1.796 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 1.0400769710540771
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.782 Vali Acc: 0.263 Test Loss: 1.782 Test Acc: 0.263
Validation loss decreased (-0.225908 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.8540229797363281
Epoch: 3, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.769 Vali Acc: 0.281 Test Loss: 1.769 Test Acc: 0.281
Validation loss decreased (-0.262945 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.8959596157073975
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.752 Vali Acc: 0.315 Test Loss: 1.752 Test Acc: 0.315
Validation loss decreased (-0.281464 --> -0.314797).  Saving model ...
Epoch: 5 cost time: 0.8854477405548096
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.730 Vali Acc: 0.367 Test Loss: 1.730 Test Acc: 0.367
Validation loss decreased (-0.314797 --> -0.366649).  Saving model ...
Epoch: 6 cost time: 1.0784926414489746
Epoch: 6, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.704 Vali Acc: 0.389 Test Loss: 1.704 Test Acc: 0.389
Validation loss decreased (-0.366649 --> -0.388872).  Saving model ...
Epoch: 7 cost time: 1.1150178909301758
Epoch: 7, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.675 Vali Acc: 0.419 Test Loss: 1.675 Test Acc: 0.419
Validation loss decreased (-0.388872 --> -0.418502).  Saving model ...
Epoch: 8 cost time: 1.0166916847229004
Epoch: 8, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.644 Vali Acc: 0.437 Test Loss: 1.644 Test Acc: 0.437
Validation loss decreased (-0.418502 --> -0.437021).  Saving model ...
Epoch: 9 cost time: 1.0853002071380615
Epoch: 9, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.612 Vali Acc: 0.463 Test Loss: 1.612 Test Acc: 0.463
Validation loss decreased (-0.437021 --> -0.462947).  Saving model ...
Epoch: 10 cost time: 1.0039024353027344
Epoch: 10, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.578 Vali Acc: 0.496 Test Loss: 1.578 Test Acc: 0.496
Validation loss decreased (-0.462947 --> -0.496281).  Saving model ...
Epoch: 11 cost time: 0.9311130046844482
Epoch: 11, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.542 Vali Acc: 0.522 Test Loss: 1.542 Test Acc: 0.522
Validation loss decreased (-0.496281 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 1.0592937469482422
Epoch: 12, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.506 Vali Acc: 0.548 Test Loss: 1.506 Test Acc: 0.548
Validation loss decreased (-0.522207 --> -0.548133).  Saving model ...
Epoch: 13 cost time: 1.0072243213653564
Epoch: 13, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.470 Vali Acc: 0.552 Test Loss: 1.470 Test Acc: 0.552
Validation loss decreased (-0.548133 --> -0.551837).  Saving model ...
Epoch: 14 cost time: 0.9582540988922119
Epoch: 14, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.433 Vali Acc: 0.578 Test Loss: 1.433 Test Acc: 0.578
Validation loss decreased (-0.551837 --> -0.577763).  Saving model ...
Epoch: 15 cost time: 0.9216382503509521
Epoch: 15, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.397 Vali Acc: 0.596 Test Loss: 1.397 Test Acc: 0.596
Validation loss decreased (-0.577763 --> -0.596282).  Saving model ...
Epoch: 16 cost time: 0.9728667736053467
Epoch: 16, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.360 Vali Acc: 0.604 Test Loss: 1.360 Test Acc: 0.604
Validation loss decreased (-0.596282 --> -0.603690).  Saving model ...
Epoch: 17 cost time: 0.866945743560791
Epoch: 17, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.324 Vali Acc: 0.622 Test Loss: 1.324 Test Acc: 0.622
Validation loss decreased (-0.603690 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 0.8675594329833984
Epoch: 18, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.289 Vali Acc: 0.615 Test Loss: 1.289 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9140124320983887
Epoch: 19, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.255 Vali Acc: 0.619 Test Loss: 1.255 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8780286312103271
Epoch: 20, Steps: 2 | Train Loss: 0.758 Vali Loss: 1.222 Vali Acc: 0.619 Test Loss: 1.222 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9298880100250244
Epoch: 21, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.190 Vali Acc: 0.622 Test Loss: 1.190 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 22 cost time: 0.8584744930267334
Epoch: 22, Steps: 2 | Train Loss: 0.616 Vali Loss: 1.160 Vali Acc: 0.637 Test Loss: 1.160 Test Acc: 0.637
Validation loss decreased (-0.622210 --> -0.637025).  Saving model ...
Epoch: 23 cost time: 1.0367405414581299
Epoch: 23, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.131 Vali Acc: 0.648 Test Loss: 1.131 Test Acc: 0.648
Validation loss decreased (-0.637025 --> -0.648137).  Saving model ...
Epoch: 24 cost time: 1.0526013374328613
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.103 Vali Acc: 0.663 Test Loss: 1.103 Test Acc: 0.663
Validation loss decreased (-0.648137 --> -0.662952).  Saving model ...
Epoch: 25 cost time: 1.0031523704528809
Epoch: 25, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.077 Vali Acc: 0.678 Test Loss: 1.077 Test Acc: 0.678
Validation loss decreased (-0.662952 --> -0.677767).  Saving model ...
Epoch: 26 cost time: 0.9771854877471924
Epoch: 26, Steps: 2 | Train Loss: 0.388 Vali Loss: 1.051 Vali Acc: 0.685 Test Loss: 1.051 Test Acc: 0.685
Validation loss decreased (-0.677767 --> -0.685175).  Saving model ...
Epoch: 27 cost time: 1.0245802402496338
Epoch: 27, Steps: 2 | Train Loss: 0.368 Vali Loss: 1.026 Vali Acc: 0.681 Test Loss: 1.026 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0266261100769043
Epoch: 28, Steps: 2 | Train Loss: 0.317 Vali Loss: 1.002 Vali Acc: 0.693 Test Loss: 1.002 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692583).  Saving model ...
Epoch: 29 cost time: 0.924752950668335
Epoch: 29, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.980 Vali Acc: 0.689 Test Loss: 0.980 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7855031490325928
Epoch: 30, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.959 Vali Acc: 0.693 Test Loss: 0.959 Test Acc: 0.693
Validation loss decreased (-0.692583 --> -0.692583).  Saving model ...
Epoch: 31 cost time: 0.8032255172729492
Epoch: 31, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.941 Vali Acc: 0.704 Test Loss: 0.941 Test Acc: 0.704
Validation loss decreased (-0.692583 --> -0.703694).  Saving model ...
Epoch: 32 cost time: 0.9270374774932861
Epoch: 32, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.924 Vali Acc: 0.711 Test Loss: 0.924 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711102).  Saving model ...
Epoch: 33 cost time: 0.900162935256958
Epoch: 33, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.911 Vali Acc: 0.719 Test Loss: 0.911 Test Acc: 0.719
Validation loss decreased (-0.711102 --> -0.718509).  Saving model ...
Epoch: 34 cost time: 0.9146938323974609
Epoch: 34, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.900 Vali Acc: 0.719 Test Loss: 0.900 Test Acc: 0.719
Validation loss decreased (-0.718509 --> -0.718510).  Saving model ...
Epoch: 35 cost time: 0.9439272880554199
Epoch: 35, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.890 Vali Acc: 0.719 Test Loss: 0.890 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 36 cost time: 0.9485485553741455
Epoch: 36, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.881 Vali Acc: 0.722 Test Loss: 0.881 Test Acc: 0.722
Validation loss decreased (-0.718510 --> -0.722213).  Saving model ...
Epoch: 37 cost time: 0.8992464542388916
Epoch: 37, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.872 Vali Acc: 0.726 Test Loss: 0.872 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 38 cost time: 0.9598095417022705
Epoch: 38, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.864 Vali Acc: 0.726 Test Loss: 0.864 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 39 cost time: 0.9883410930633545
Epoch: 39, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.857 Vali Acc: 0.737 Test Loss: 0.857 Test Acc: 0.737
Validation loss decreased (-0.725917 --> -0.737028).  Saving model ...
Epoch: 40 cost time: 1.0801122188568115
Epoch: 40, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.737028 --> -0.744436).  Saving model ...
Epoch: 41 cost time: 1.0430607795715332
Epoch: 41, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.842 Vali Acc: 0.744 Test Loss: 0.842 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 42 cost time: 1.0470163822174072
Epoch: 42, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.835 Vali Acc: 0.748 Test Loss: 0.835 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 43 cost time: 0.9623732566833496
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.829 Vali Acc: 0.752 Test Loss: 0.829 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 44 cost time: 1.104503870010376
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.824 Vali Acc: 0.756 Test Loss: 0.824 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755547).  Saving model ...
Epoch: 45 cost time: 1.0648133754730225
Epoch: 45, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.819 Vali Acc: 0.759 Test Loss: 0.819 Test Acc: 0.759
Validation loss decreased (-0.755547 --> -0.759251).  Saving model ...
Epoch: 46 cost time: 0.9931471347808838
Epoch: 46, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.814 Vali Acc: 0.759 Test Loss: 0.814 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759251).  Saving model ...
Epoch: 47 cost time: 0.9727034568786621
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.809 Vali Acc: 0.759 Test Loss: 0.809 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759251).  Saving model ...
Epoch: 48 cost time: 0.9679176807403564
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.804 Vali Acc: 0.763 Test Loss: 0.804 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762955).  Saving model ...
Epoch: 49 cost time: 1.0708587169647217
Epoch: 49, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.800 Vali Acc: 0.763 Test Loss: 0.800 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 50 cost time: 0.9353630542755127
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.796 Vali Acc: 0.767 Test Loss: 0.796 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 51 cost time: 1.0419044494628906
Epoch: 51, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 52 cost time: 1.0580534934997559
Epoch: 52, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.788 Vali Acc: 0.767 Test Loss: 0.788 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 53 cost time: 1.1662912368774414
Epoch: 53, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 54 cost time: 1.086479902267456
Epoch: 54, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 55 cost time: 1.1566541194915771
Epoch: 55, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.774 Vali Acc: 0.770 Test Loss: 0.774 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 56 cost time: 1.126533031463623
Epoch: 56, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.769 Vali Acc: 0.770 Test Loss: 0.769 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 57 cost time: 1.1776714324951172
Epoch: 57, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.765 Vali Acc: 0.774 Test Loss: 0.765 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774066).  Saving model ...
Epoch: 58 cost time: 1.1484692096710205
Epoch: 58, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.761 Vali Acc: 0.774 Test Loss: 0.761 Test Acc: 0.774
Validation loss decreased (-0.774066 --> -0.774066).  Saving model ...
Epoch: 59 cost time: 0.9699831008911133
Epoch: 59, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.757 Vali Acc: 0.774 Test Loss: 0.757 Test Acc: 0.774
Validation loss decreased (-0.774066 --> -0.774067).  Saving model ...
Epoch: 60 cost time: 0.9867956638336182
Epoch: 60, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.752 Vali Acc: 0.774 Test Loss: 0.752 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 61 cost time: 1.0566534996032715
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.748 Vali Acc: 0.774 Test Loss: 0.748 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 62 cost time: 0.9740989208221436
Epoch: 62, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.744 Vali Acc: 0.774 Test Loss: 0.744 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 63 cost time: 0.9859964847564697
Epoch: 63, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.739 Vali Acc: 0.774 Test Loss: 0.739 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 64 cost time: 0.9810240268707275
Epoch: 64, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.774 Test Loss: 0.735 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 65 cost time: 1.1023955345153809
Epoch: 65, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.732 Vali Acc: 0.781 Test Loss: 0.732 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781474).  Saving model ...
Epoch: 66 cost time: 1.1371657848358154
Epoch: 66, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.728 Vali Acc: 0.781 Test Loss: 0.728 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 67 cost time: 1.0334327220916748
Epoch: 67, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.724 Vali Acc: 0.778 Test Loss: 0.724 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1216814517974854
Epoch: 68, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.720 Vali Acc: 0.778 Test Loss: 0.720 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1386187076568604
Epoch: 69, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.716 Vali Acc: 0.778 Test Loss: 0.716 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.1514472961425781
Epoch: 70, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0903537273406982
Epoch: 71, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.709 Vali Acc: 0.781 Test Loss: 0.709 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 72 cost time: 1.1163678169250488
Epoch: 72, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.781 Test Loss: 0.705 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 73 cost time: 1.017963171005249
Epoch: 73, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.781 Test Loss: 0.702 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 74 cost time: 1.0522229671478271
Epoch: 74, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.699 Vali Acc: 0.781 Test Loss: 0.699 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 75 cost time: 1.0039842128753662
Epoch: 75, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.695 Vali Acc: 0.781 Test Loss: 0.695 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781475).  Saving model ...
Epoch: 76 cost time: 1.0596210956573486
Epoch: 76, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.692 Vali Acc: 0.781 Test Loss: 0.692 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 77 cost time: 0.9441084861755371
Epoch: 77, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.689 Vali Acc: 0.781 Test Loss: 0.689 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 78 cost time: 1.0074687004089355
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.781 Test Loss: 0.686 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 79 cost time: 1.0451164245605469
Epoch: 79, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.684 Vali Acc: 0.781 Test Loss: 0.684 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 80 cost time: 1.1198127269744873
Epoch: 80, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.781 Test Loss: 0.681 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 81 cost time: 1.1574325561523438
Epoch: 81, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.785 Test Loss: 0.679 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785178).  Saving model ...
Epoch: 82 cost time: 1.1035974025726318
Epoch: 82, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 83 cost time: 1.086012840270996
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 84 cost time: 1.122267246246338
Epoch: 84, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.793 Test Loss: 0.672 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 85 cost time: 1.1649491786956787
Epoch: 85, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.793 Test Loss: 0.670 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 86 cost time: 1.0397851467132568
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.796 Test Loss: 0.669 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 87 cost time: 1.0293474197387695
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 88 cost time: 0.9990968704223633
Epoch: 88, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803697).  Saving model ...
Epoch: 89 cost time: 0.9976720809936523
Epoch: 89, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.804 Test Loss: 0.663 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 90 cost time: 0.9549484252929688
Epoch: 90, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 91 cost time: 1.000826120376587
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.804 Test Loss: 0.659 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 92 cost time: 1.0502545833587646
Epoch: 92, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 93 cost time: 0.9762754440307617
Epoch: 93, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.655 Vali Acc: 0.807 Test Loss: 0.655 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 94 cost time: 0.9346644878387451
Epoch: 94, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.807 Test Loss: 0.654 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 95 cost time: 1.0413947105407715
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 96 cost time: 1.0439846515655518
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.811 Test Loss: 0.651 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 97 cost time: 1.103562355041504
Epoch: 97, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 98 cost time: 1.0213816165924072
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 99 cost time: 0.993492841720581
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.815 Test Loss: 0.646 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 100 cost time: 1.1101038455963135
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.815 Test Loss: 0.644 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.260711431503296
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.849 Vali Acc: 0.130 Test Loss: 1.849 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.9585165977478027
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.837 Vali Acc: 0.137 Test Loss: 1.837 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137019).  Saving model ...
Epoch: 3 cost time: 0.9751698970794678
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.826 Vali Acc: 0.141 Test Loss: 1.826 Test Acc: 0.141
Validation loss decreased (-0.137019 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 1.0182421207427979
Epoch: 4, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.814 Vali Acc: 0.152 Test Loss: 1.814 Test Acc: 0.152
Validation loss decreased (-0.140722 --> -0.151834).  Saving model ...
Epoch: 5 cost time: 1.1480166912078857
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.797 Vali Acc: 0.178 Test Loss: 1.797 Test Acc: 0.178
Validation loss decreased (-0.151834 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 1.0261530876159668
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.777 Vali Acc: 0.196 Test Loss: 1.777 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 1.0195667743682861
Epoch: 7, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.755 Vali Acc: 0.226 Test Loss: 1.755 Test Acc: 0.226
Validation loss decreased (-0.196279 --> -0.225908).  Saving model ...
Epoch: 8 cost time: 0.9620187282562256
Epoch: 8, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
Validation loss decreased (-0.225908 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 1.1630175113677979
Epoch: 9, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.707 Vali Acc: 0.293 Test Loss: 1.707 Test Acc: 0.293
Validation loss decreased (-0.259242 --> -0.292576).  Saving model ...
Epoch: 10 cost time: 1.047950029373169
Epoch: 10, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.680 Vali Acc: 0.322 Test Loss: 1.680 Test Acc: 0.322
Validation loss decreased (-0.292576 --> -0.322205).  Saving model ...
Epoch: 11 cost time: 1.0463621616363525
Epoch: 11, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.653 Vali Acc: 0.367 Test Loss: 1.653 Test Acc: 0.367
Validation loss decreased (-0.322205 --> -0.366650).  Saving model ...
Epoch: 12 cost time: 1.1054883003234863
Epoch: 12, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.625 Vali Acc: 0.415 Test Loss: 1.625 Test Acc: 0.415
Validation loss decreased (-0.366650 --> -0.414799).  Saving model ...
Epoch: 13 cost time: 1.0850844383239746
Epoch: 13, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.596 Vali Acc: 0.430 Test Loss: 1.596 Test Acc: 0.430
Validation loss decreased (-0.414799 --> -0.429614).  Saving model ...
Epoch: 14 cost time: 0.9938979148864746
Epoch: 14, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.567 Vali Acc: 0.459 Test Loss: 1.567 Test Acc: 0.459
Validation loss decreased (-0.429614 --> -0.459244).  Saving model ...
Epoch: 15 cost time: 1.053227424621582
Epoch: 15, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.538 Vali Acc: 0.485 Test Loss: 1.538 Test Acc: 0.485
Validation loss decreased (-0.459244 --> -0.485170).  Saving model ...
Epoch: 16 cost time: 0.9843523502349854
Epoch: 16, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.509 Vali Acc: 0.493 Test Loss: 1.509 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492578).  Saving model ...
Epoch: 17 cost time: 0.9162700176239014
Epoch: 17, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.479 Vali Acc: 0.515 Test Loss: 1.479 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514800).  Saving model ...
Epoch: 18 cost time: 1.1549148559570312
Epoch: 18, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.450 Vali Acc: 0.533 Test Loss: 1.450 Test Acc: 0.533
Validation loss decreased (-0.514800 --> -0.533319).  Saving model ...
Epoch: 19 cost time: 1.1442995071411133
Epoch: 19, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.422 Vali Acc: 0.544 Test Loss: 1.422 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544430).  Saving model ...
Epoch: 20 cost time: 1.0597736835479736
Epoch: 20, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.393 Vali Acc: 0.552 Test Loss: 1.393 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551838).  Saving model ...
Epoch: 21 cost time: 1.056715965270996
Epoch: 21, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.365 Vali Acc: 0.552 Test Loss: 1.365 Test Acc: 0.552
Validation loss decreased (-0.551838 --> -0.551838).  Saving model ...
Epoch: 22 cost time: 0.9905977249145508
Epoch: 22, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.338 Vali Acc: 0.559 Test Loss: 1.338 Test Acc: 0.559
Validation loss decreased (-0.551838 --> -0.559246).  Saving model ...
Epoch: 23 cost time: 1.1281523704528809
Epoch: 23, Steps: 2 | Train Loss: 0.770 Vali Loss: 1.312 Vali Acc: 0.559 Test Loss: 1.312 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559246).  Saving model ...
Epoch: 24 cost time: 1.062037706375122
Epoch: 24, Steps: 2 | Train Loss: 0.723 Vali Loss: 1.286 Vali Acc: 0.559 Test Loss: 1.286 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559246).  Saving model ...
Epoch: 25 cost time: 1.1359667778015137
Epoch: 25, Steps: 2 | Train Loss: 0.739 Vali Loss: 1.261 Vali Acc: 0.552 Test Loss: 1.261 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0627377033233643
Epoch: 26, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.237 Vali Acc: 0.548 Test Loss: 1.237 Test Acc: 0.548
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0020933151245117
Epoch: 27, Steps: 2 | Train Loss: 0.576 Vali Loss: 1.214 Vali Acc: 0.556 Test Loss: 1.214 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9760513305664062
Epoch: 28, Steps: 2 | Train Loss: 0.537 Vali Loss: 1.192 Vali Acc: 0.559 Test Loss: 1.192 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559247).  Saving model ...
Epoch: 29 cost time: 0.9790668487548828
Epoch: 29, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.170 Vali Acc: 0.563 Test Loss: 1.170 Test Acc: 0.563
Validation loss decreased (-0.559247 --> -0.562951).  Saving model ...
Epoch: 30 cost time: 1.110715389251709
Epoch: 30, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.150 Vali Acc: 0.567 Test Loss: 1.150 Test Acc: 0.567
Validation loss decreased (-0.562951 --> -0.566655).  Saving model ...
Epoch: 31 cost time: 0.9403579235076904
Epoch: 31, Steps: 2 | Train Loss: 0.435 Vali Loss: 1.128 Vali Acc: 0.567 Test Loss: 1.128 Test Acc: 0.567
Validation loss decreased (-0.566655 --> -0.566655).  Saving model ...
Epoch: 32 cost time: 0.8987994194030762
Epoch: 32, Steps: 2 | Train Loss: 0.359 Vali Loss: 1.107 Vali Acc: 0.570 Test Loss: 1.107 Test Acc: 0.570
Validation loss decreased (-0.566655 --> -0.570359).  Saving model ...
Epoch: 33 cost time: 0.9037730693817139
Epoch: 33, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.088 Vali Acc: 0.570 Test Loss: 1.088 Test Acc: 0.570
Validation loss decreased (-0.570359 --> -0.570359).  Saving model ...
Epoch: 34 cost time: 1.069805383682251
Epoch: 34, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.070 Vali Acc: 0.578 Test Loss: 1.070 Test Acc: 0.578
Validation loss decreased (-0.570359 --> -0.577767).  Saving model ...
Epoch: 35 cost time: 1.039337158203125
Epoch: 35, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.051 Vali Acc: 0.589 Test Loss: 1.051 Test Acc: 0.589
Validation loss decreased (-0.577767 --> -0.588878).  Saving model ...
Epoch: 36 cost time: 0.9768016338348389
Epoch: 36, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.032 Vali Acc: 0.589 Test Loss: 1.032 Test Acc: 0.589
Validation loss decreased (-0.588878 --> -0.588879).  Saving model ...
Epoch: 37 cost time: 0.9200587272644043
Epoch: 37, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.012 Vali Acc: 0.596 Test Loss: 1.012 Test Acc: 0.596
Validation loss decreased (-0.588879 --> -0.596286).  Saving model ...
Epoch: 38 cost time: 0.8653647899627686
Epoch: 38, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.994 Vali Acc: 0.596 Test Loss: 0.994 Test Acc: 0.596
Validation loss decreased (-0.596286 --> -0.596286).  Saving model ...
Epoch: 39 cost time: 1.0764033794403076
Epoch: 39, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.977 Vali Acc: 0.607 Test Loss: 0.977 Test Acc: 0.607
Validation loss decreased (-0.596286 --> -0.607398).  Saving model ...
Epoch: 40 cost time: 1.1463215351104736
Epoch: 40, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.959 Vali Acc: 0.626 Test Loss: 0.959 Test Acc: 0.626
Validation loss decreased (-0.607398 --> -0.625916).  Saving model ...
Epoch: 41 cost time: 0.8317456245422363
Epoch: 41, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.942 Vali Acc: 0.630 Test Loss: 0.942 Test Acc: 0.630
Validation loss decreased (-0.625916 --> -0.629620).  Saving model ...
Epoch: 42 cost time: 0.9510576725006104
Epoch: 42, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.926 Vali Acc: 0.633 Test Loss: 0.926 Test Acc: 0.633
Validation loss decreased (-0.629620 --> -0.633324).  Saving model ...
Epoch: 43 cost time: 0.8443078994750977
Epoch: 43, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.911 Vali Acc: 0.641 Test Loss: 0.911 Test Acc: 0.641
Validation loss decreased (-0.633324 --> -0.640732).  Saving model ...
Epoch: 44 cost time: 0.9374368190765381
Epoch: 44, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.898 Vali Acc: 0.644 Test Loss: 0.898 Test Acc: 0.644
Validation loss decreased (-0.640732 --> -0.644435).  Saving model ...
Epoch: 45 cost time: 0.9542989730834961
Epoch: 45, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.887 Vali Acc: 0.644 Test Loss: 0.887 Test Acc: 0.644
Validation loss decreased (-0.644435 --> -0.644436).  Saving model ...
Epoch: 46 cost time: 1.028449296951294
Epoch: 46, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.875 Vali Acc: 0.641 Test Loss: 0.875 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9389686584472656
Epoch: 47, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.866 Vali Acc: 0.644 Test Loss: 0.866 Test Acc: 0.644
Validation loss decreased (-0.644436 --> -0.644436).  Saving model ...
Epoch: 48 cost time: 0.9196803569793701
Epoch: 48, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.856 Vali Acc: 0.648 Test Loss: 0.856 Test Acc: 0.648
Validation loss decreased (-0.644436 --> -0.648140).  Saving model ...
Epoch: 49 cost time: 0.8583950996398926
Epoch: 49, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.848 Vali Acc: 0.644 Test Loss: 0.848 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0701868534088135
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.841 Vali Acc: 0.648 Test Loss: 0.841 Test Acc: 0.648
Validation loss decreased (-0.648140 --> -0.648140).  Saving model ...
Epoch: 51 cost time: 0.959601640701294
Epoch: 51, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.834 Vali Acc: 0.652 Test Loss: 0.834 Test Acc: 0.652
Validation loss decreased (-0.648140 --> -0.651844).  Saving model ...
Epoch: 52 cost time: 1.011207103729248
Epoch: 52, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.827 Vali Acc: 0.656 Test Loss: 0.827 Test Acc: 0.656
Validation loss decreased (-0.651844 --> -0.655547).  Saving model ...
Epoch: 53 cost time: 1.0318639278411865
Epoch: 53, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.820 Vali Acc: 0.659 Test Loss: 0.820 Test Acc: 0.659
Validation loss decreased (-0.655547 --> -0.659251).  Saving model ...
Epoch: 54 cost time: 1.106396198272705
Epoch: 54, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.813 Vali Acc: 0.663 Test Loss: 0.813 Test Acc: 0.663
Validation loss decreased (-0.659251 --> -0.662955).  Saving model ...
Epoch: 55 cost time: 1.0002410411834717
Epoch: 55, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.807 Vali Acc: 0.670 Test Loss: 0.807 Test Acc: 0.670
Validation loss decreased (-0.662955 --> -0.670362).  Saving model ...
Epoch: 56 cost time: 1.0250012874603271
Epoch: 56, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.800 Vali Acc: 0.674 Test Loss: 0.800 Test Acc: 0.674
Validation loss decreased (-0.670362 --> -0.674066).  Saving model ...
Epoch: 57 cost time: 0.9239895343780518
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.794 Vali Acc: 0.685 Test Loss: 0.794 Test Acc: 0.685
Validation loss decreased (-0.674066 --> -0.685177).  Saving model ...
Epoch: 58 cost time: 1.0119922161102295
Epoch: 58, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.788 Vali Acc: 0.685 Test Loss: 0.788 Test Acc: 0.685
Validation loss decreased (-0.685177 --> -0.685177).  Saving model ...
Epoch: 59 cost time: 0.9836702346801758
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.782 Vali Acc: 0.689 Test Loss: 0.782 Test Acc: 0.689
Validation loss decreased (-0.685177 --> -0.688881).  Saving model ...
Epoch: 60 cost time: 0.9396722316741943
Epoch: 60, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.776 Vali Acc: 0.693 Test Loss: 0.776 Test Acc: 0.693
Validation loss decreased (-0.688881 --> -0.692585).  Saving model ...
Epoch: 61 cost time: 0.9640915393829346
Epoch: 61, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.769 Vali Acc: 0.696 Test Loss: 0.769 Test Acc: 0.696
Validation loss decreased (-0.692585 --> -0.696289).  Saving model ...
Epoch: 62 cost time: 0.9857916831970215
Epoch: 62, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.763 Vali Acc: 0.696 Test Loss: 0.763 Test Acc: 0.696
Validation loss decreased (-0.696289 --> -0.696289).  Saving model ...
Epoch: 63 cost time: 0.9027352333068848
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.757 Vali Acc: 0.696 Test Loss: 0.757 Test Acc: 0.696
Validation loss decreased (-0.696289 --> -0.696289).  Saving model ...
Epoch: 64 cost time: 0.9696857929229736
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.753 Vali Acc: 0.693 Test Loss: 0.753 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0891499519348145
Epoch: 65, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.749 Vali Acc: 0.693 Test Loss: 0.749 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0992140769958496
Epoch: 66, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.745 Vali Acc: 0.696 Test Loss: 0.745 Test Acc: 0.696
Validation loss decreased (-0.696289 --> -0.696289).  Saving model ...
Epoch: 67 cost time: 0.9678902626037598
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.741 Vali Acc: 0.700 Test Loss: 0.741 Test Acc: 0.700
Validation loss decreased (-0.696289 --> -0.699993).  Saving model ...
Epoch: 68 cost time: 1.2095320224761963
Epoch: 68, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.737 Vali Acc: 0.700 Test Loss: 0.737 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 69 cost time: 1.1039352416992188
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.733 Vali Acc: 0.700 Test Loss: 0.733 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 70 cost time: 1.0961828231811523
Epoch: 70, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.730 Vali Acc: 0.704 Test Loss: 0.730 Test Acc: 0.704
Validation loss decreased (-0.699993 --> -0.703696).  Saving model ...
Epoch: 71 cost time: 0.9796104431152344
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.727 Vali Acc: 0.704 Test Loss: 0.727 Test Acc: 0.704
Validation loss decreased (-0.703696 --> -0.703696).  Saving model ...
Epoch: 72 cost time: 0.869469404220581
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.704 Test Loss: 0.723 Test Acc: 0.704
Validation loss decreased (-0.703696 --> -0.703696).  Saving model ...
Epoch: 73 cost time: 1.0332508087158203
Epoch: 73, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.720 Vali Acc: 0.707 Test Loss: 0.720 Test Acc: 0.707
Validation loss decreased (-0.703696 --> -0.707400).  Saving model ...
Epoch: 74 cost time: 0.9859614372253418
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.717 Vali Acc: 0.719 Test Loss: 0.717 Test Acc: 0.719
Validation loss decreased (-0.707400 --> -0.718511).  Saving model ...
Epoch: 75 cost time: 0.9609706401824951
Epoch: 75, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.714 Vali Acc: 0.719 Test Loss: 0.714 Test Acc: 0.719
Validation loss decreased (-0.718511 --> -0.718511).  Saving model ...
Epoch: 76 cost time: 1.2419788837432861
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722215).  Saving model ...
Epoch: 77 cost time: 0.9197075366973877
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.707 Vali Acc: 0.726 Test Loss: 0.707 Test Acc: 0.726
Validation loss decreased (-0.722215 --> -0.725919).  Saving model ...
Epoch: 78 cost time: 1.0009756088256836
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.725919 --> -0.729623).  Saving model ...
Epoch: 79 cost time: 1.033590316772461
Epoch: 79, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.729623 --> -0.729623).  Saving model ...
Epoch: 80 cost time: 0.9936552047729492
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.698 Vali Acc: 0.730 Test Loss: 0.698 Test Acc: 0.730
Validation loss decreased (-0.729623 --> -0.729623).  Saving model ...
Epoch: 81 cost time: 0.9781970977783203
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
Validation loss decreased (-0.729623 --> -0.733326).  Saving model ...
Epoch: 82 cost time: 1.04207444190979
Epoch: 82, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
Validation loss decreased (-0.733326 --> -0.737030).  Saving model ...
Epoch: 83 cost time: 1.0432538986206055
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
Validation loss decreased (-0.737030 --> -0.737030).  Saving model ...
Epoch: 84 cost time: 1.0423312187194824
Epoch: 84, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.741 Test Loss: 0.685 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740734).  Saving model ...
Epoch: 85 cost time: 1.0430023670196533
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.683 Vali Acc: 0.744 Test Loss: 0.683 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744438).  Saving model ...
Epoch: 86 cost time: 1.0484082698822021
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.680 Vali Acc: 0.744 Test Loss: 0.680 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 87 cost time: 1.0547351837158203
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.0881857872009277
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.744 Test Loss: 0.674 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 89 cost time: 1.060197114944458
Epoch: 89, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 90 cost time: 1.0723724365234375
Epoch: 90, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.748 Test Loss: 0.669 Test Acc: 0.748
Validation loss decreased (-0.744438 --> -0.748141).  Saving model ...
Epoch: 91 cost time: 1.2198212146759033
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.752 Test Loss: 0.667 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 92 cost time: 1.152003526687622
Epoch: 92, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.664 Vali Acc: 0.752 Test Loss: 0.664 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 93 cost time: 1.0884175300598145
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.663 Vali Acc: 0.748 Test Loss: 0.663 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1421360969543457
Epoch: 94, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.752 Test Loss: 0.661 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 95 cost time: 1.0496647357940674
Epoch: 95, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.752 Test Loss: 0.659 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 96 cost time: 1.0401084423065186
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.752 Test Loss: 0.658 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 97 cost time: 1.1897122859954834
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.756 Test Loss: 0.656 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 98 cost time: 1.1866419315338135
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.756 Test Loss: 0.654 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 99 cost time: 1.0646324157714844
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.756 Test Loss: 0.653 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 100 cost time: 0.9149496555328369
Epoch: 100, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7666666666666667
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0424604415893555
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.866 Vali Acc: 0.174 Test Loss: 1.866 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.840897798538208
Epoch: 2, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.857 Vali Acc: 0.181 Test Loss: 1.857 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 1.1017849445343018
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.848 Vali Acc: 0.181 Test Loss: 1.848 Test Acc: 0.181
Validation loss decreased (-0.181463 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.8491978645324707
Epoch: 4, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.836 Vali Acc: 0.185 Test Loss: 1.836 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 1.0790281295776367
Epoch: 5, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.821 Vali Acc: 0.211 Test Loss: 1.821 Test Acc: 0.211
Validation loss decreased (-0.185167 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.9826269149780273
Epoch: 6, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.803 Vali Acc: 0.244 Test Loss: 1.803 Test Acc: 0.244
Validation loss decreased (-0.211093 --> -0.244426).  Saving model ...
Epoch: 7 cost time: 1.1413791179656982
Epoch: 7, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.783 Vali Acc: 0.281 Test Loss: 1.783 Test Acc: 0.281
Validation loss decreased (-0.244426 --> -0.281464).  Saving model ...
Epoch: 8 cost time: 0.9683413505554199
Epoch: 8, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.762 Vali Acc: 0.304 Test Loss: 1.762 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303686).  Saving model ...
Epoch: 9 cost time: 0.9274427890777588
Epoch: 9, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.740 Vali Acc: 0.352 Test Loss: 1.740 Test Acc: 0.352
Validation loss decreased (-0.303686 --> -0.351834).  Saving model ...
Epoch: 10 cost time: 1.069859504699707
Epoch: 10, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.716 Vali Acc: 0.370 Test Loss: 1.716 Test Acc: 0.370
Validation loss decreased (-0.351834 --> -0.370353).  Saving model ...
Epoch: 11 cost time: 1.1803743839263916
Epoch: 11, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.692 Vali Acc: 0.393 Test Loss: 1.692 Test Acc: 0.393
Validation loss decreased (-0.370353 --> -0.392576).  Saving model ...
Epoch: 12 cost time: 0.959125280380249
Epoch: 12, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.666 Vali Acc: 0.419 Test Loss: 1.666 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 13 cost time: 0.924769401550293
Epoch: 13, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.640 Vali Acc: 0.448 Test Loss: 1.640 Test Acc: 0.448
Validation loss decreased (-0.418502 --> -0.448132).  Saving model ...
Epoch: 14 cost time: 0.9505095481872559
Epoch: 14, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.613 Vali Acc: 0.474 Test Loss: 1.613 Test Acc: 0.474
Validation loss decreased (-0.448132 --> -0.474058).  Saving model ...
Epoch: 15 cost time: 1.0030689239501953
Epoch: 15, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.586 Vali Acc: 0.478 Test Loss: 1.586 Test Acc: 0.478
Validation loss decreased (-0.474058 --> -0.477762).  Saving model ...
Epoch: 16 cost time: 1.092405080795288
Epoch: 16, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.558 Vali Acc: 0.489 Test Loss: 1.558 Test Acc: 0.489
Validation loss decreased (-0.477762 --> -0.488873).  Saving model ...
Epoch: 17 cost time: 0.9842681884765625
Epoch: 17, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.529 Vali Acc: 0.496 Test Loss: 1.529 Test Acc: 0.496
Validation loss decreased (-0.488873 --> -0.496281).  Saving model ...
Epoch: 18 cost time: 1.0568480491638184
Epoch: 18, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.500 Vali Acc: 0.526 Test Loss: 1.500 Test Acc: 0.526
Validation loss decreased (-0.496281 --> -0.525911).  Saving model ...
Epoch: 19 cost time: 1.07118558883667
Epoch: 19, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.472 Vali Acc: 0.537 Test Loss: 1.472 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 20 cost time: 1.0857703685760498
Epoch: 20, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.443 Vali Acc: 0.556 Test Loss: 1.443 Test Acc: 0.556
Validation loss decreased (-0.537022 --> -0.555541).  Saving model ...
Epoch: 21 cost time: 1.0192203521728516
Epoch: 21, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.414 Vali Acc: 0.567 Test Loss: 1.414 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566653).  Saving model ...
Epoch: 22 cost time: 1.0025384426116943
Epoch: 22, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.385 Vali Acc: 0.585 Test Loss: 1.385 Test Acc: 0.585
Validation loss decreased (-0.566653 --> -0.585171).  Saving model ...
Epoch: 23 cost time: 1.0233309268951416
Epoch: 23, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.355 Vali Acc: 0.593 Test Loss: 1.355 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 24 cost time: 1.0882246494293213
Epoch: 24, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.325 Vali Acc: 0.600 Test Loss: 1.325 Test Acc: 0.600
Validation loss decreased (-0.592579 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 1.2383525371551514
Epoch: 25, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.295 Vali Acc: 0.611 Test Loss: 1.295 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 1.0376346111297607
Epoch: 26, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.266 Vali Acc: 0.615 Test Loss: 1.266 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 27 cost time: 1.1635117530822754
Epoch: 27, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.236 Vali Acc: 0.630 Test Loss: 1.236 Test Acc: 0.630
Validation loss decreased (-0.614802 --> -0.629617).  Saving model ...
Epoch: 28 cost time: 0.969918966293335
Epoch: 28, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.204 Vali Acc: 0.644 Test Loss: 1.204 Test Acc: 0.644
Validation loss decreased (-0.629617 --> -0.644432).  Saving model ...
Epoch: 29 cost time: 1.1061856746673584
Epoch: 29, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.171 Vali Acc: 0.656 Test Loss: 1.171 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 30 cost time: 0.971031665802002
Epoch: 30, Steps: 2 | Train Loss: 0.714 Vali Loss: 1.139 Vali Acc: 0.663 Test Loss: 1.139 Test Acc: 0.663
Validation loss decreased (-0.655544 --> -0.662952).  Saving model ...
Epoch: 31 cost time: 0.9980635643005371
Epoch: 31, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.106 Vali Acc: 0.685 Test Loss: 1.106 Test Acc: 0.685
Validation loss decreased (-0.662952 --> -0.685174).  Saving model ...
Epoch: 32 cost time: 1.0044069290161133
Epoch: 32, Steps: 2 | Train Loss: 0.555 Vali Loss: 1.073 Vali Acc: 0.696 Test Loss: 1.073 Test Acc: 0.696
Validation loss decreased (-0.685174 --> -0.696286).  Saving model ...
Epoch: 33 cost time: 1.0630619525909424
Epoch: 33, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.043 Vali Acc: 0.696 Test Loss: 1.043 Test Acc: 0.696
Validation loss decreased (-0.696286 --> -0.696286).  Saving model ...
Epoch: 34 cost time: 1.008878231048584
Epoch: 34, Steps: 2 | Train Loss: 0.474 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.696286 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 0.9370801448822021
Epoch: 35, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.981 Vali Acc: 0.707 Test Loss: 0.981 Test Acc: 0.707
Validation loss decreased (-0.699990 --> -0.707398).  Saving model ...
Epoch: 36 cost time: 1.1083989143371582
Epoch: 36, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.946 Vali Acc: 0.707 Test Loss: 0.946 Test Acc: 0.707
Validation loss decreased (-0.707398 --> -0.707398).  Saving model ...
Epoch: 37 cost time: 1.0873115062713623
Epoch: 37, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.912 Vali Acc: 0.715 Test Loss: 0.912 Test Acc: 0.715
Validation loss decreased (-0.707398 --> -0.714806).  Saving model ...
Epoch: 38 cost time: 1.0909326076507568
Epoch: 38, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.878 Vali Acc: 0.733 Test Loss: 0.878 Test Acc: 0.733
Validation loss decreased (-0.714806 --> -0.733325).  Saving model ...
Epoch: 39 cost time: 1.0227611064910889
Epoch: 39, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.849 Vali Acc: 0.737 Test Loss: 0.849 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 40 cost time: 0.9014809131622314
Epoch: 40, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.818 Vali Acc: 0.741 Test Loss: 0.818 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 41 cost time: 0.9951696395874023
Epoch: 41, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 42 cost time: 1.0063385963439941
Epoch: 42, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.767 Vali Acc: 0.756 Test Loss: 0.767 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 1.0475349426269531
Epoch: 43, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.747 Vali Acc: 0.752 Test Loss: 0.747 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0660200119018555
Epoch: 44, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.730 Vali Acc: 0.752 Test Loss: 0.730 Test Acc: 0.752
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0523693561553955
Epoch: 45, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.716 Vali Acc: 0.748 Test Loss: 0.716 Test Acc: 0.748
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0825834274291992
Epoch: 46, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9511632919311523
Epoch: 47, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.699 Vali Acc: 0.741 Test Loss: 0.699 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0606653690338135
Epoch: 48, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.986835241317749
Epoch: 49, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0952637195587158
Epoch: 50, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0308361053466797
Epoch: 51, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0428972244262695
Epoch: 52, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.640 Vali Acc: 0.752 Test Loss: 0.640 Test Acc: 0.752
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7555555555555555
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5227084159851074
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.907 Vali Acc: 0.119 Test Loss: 1.907 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.9605293273925781
Epoch: 2, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.902 Vali Acc: 0.122 Test Loss: 1.902 Test Acc: 0.122
Validation loss decreased (-0.118499 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 1.0653877258300781
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.895 Vali Acc: 0.130 Test Loss: 1.895 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 1.0194954872131348
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.882 Vali Acc: 0.137 Test Loss: 1.882 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137018).  Saving model ...
Epoch: 5 cost time: 1.0021371841430664
Epoch: 5, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.866 Vali Acc: 0.152 Test Loss: 1.866 Test Acc: 0.152
Validation loss decreased (-0.137018 --> -0.151833).  Saving model ...
Epoch: 6 cost time: 0.9906368255615234
Epoch: 6, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.847 Vali Acc: 0.159 Test Loss: 1.847 Test Acc: 0.159
Validation loss decreased (-0.151833 --> -0.159241).  Saving model ...
Epoch: 7 cost time: 0.9579818248748779
Epoch: 7, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.825 Vali Acc: 0.170 Test Loss: 1.825 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 8 cost time: 1.0227460861206055
Epoch: 8, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.801 Vali Acc: 0.196 Test Loss: 1.801 Test Acc: 0.196
Validation loss decreased (-0.170352 --> -0.196278).  Saving model ...
Epoch: 9 cost time: 0.9298732280731201
Epoch: 9, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.775 Vali Acc: 0.248 Test Loss: 1.775 Test Acc: 0.248
Validation loss decreased (-0.196278 --> -0.248130).  Saving model ...
Epoch: 10 cost time: 1.0202093124389648
Epoch: 10, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.747 Vali Acc: 0.281 Test Loss: 1.747 Test Acc: 0.281
Validation loss decreased (-0.248130 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.929955005645752
Epoch: 11, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.717 Vali Acc: 0.311 Test Loss: 1.717 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.9785399436950684
Epoch: 12, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.685 Vali Acc: 0.359 Test Loss: 1.685 Test Acc: 0.359
Validation loss decreased (-0.311094 --> -0.359242).  Saving model ...
Epoch: 13 cost time: 1.0201337337493896
Epoch: 13, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.653 Vali Acc: 0.393 Test Loss: 1.653 Test Acc: 0.393
Validation loss decreased (-0.359242 --> -0.392576).  Saving model ...
Epoch: 14 cost time: 0.9407467842102051
Epoch: 14, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.618 Vali Acc: 0.422 Test Loss: 1.618 Test Acc: 0.422
Validation loss decreased (-0.392576 --> -0.422206).  Saving model ...
Epoch: 15 cost time: 0.9587318897247314
Epoch: 15, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.583 Vali Acc: 0.459 Test Loss: 1.583 Test Acc: 0.459
Validation loss decreased (-0.422206 --> -0.459243).  Saving model ...
Epoch: 16 cost time: 0.9955379962921143
Epoch: 16, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.546 Vali Acc: 0.481 Test Loss: 1.546 Test Acc: 0.481
Validation loss decreased (-0.459243 --> -0.481466).  Saving model ...
Epoch: 17 cost time: 1.0285062789916992
Epoch: 17, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.508 Vali Acc: 0.507 Test Loss: 1.508 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 18 cost time: 0.9870810508728027
Epoch: 18, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.468 Vali Acc: 0.526 Test Loss: 1.468 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 19 cost time: 0.9438762664794922
Epoch: 19, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
Validation loss decreased (-0.525911 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 0.8674736022949219
Epoch: 20, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.387 Vali Acc: 0.570 Test Loss: 1.387 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 21 cost time: 0.8357319831848145
Epoch: 21, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.346 Vali Acc: 0.604 Test Loss: 1.346 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603690).  Saving model ...
Epoch: 22 cost time: 0.9200313091278076
Epoch: 22, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.304 Vali Acc: 0.619 Test Loss: 1.304 Test Acc: 0.619
Validation loss decreased (-0.603690 --> -0.618505).  Saving model ...
Epoch: 23 cost time: 0.951362133026123
Epoch: 23, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.262 Vali Acc: 0.626 Test Loss: 1.262 Test Acc: 0.626
Validation loss decreased (-0.618505 --> -0.625913).  Saving model ...
Epoch: 24 cost time: 0.9614841938018799
Epoch: 24, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.221 Vali Acc: 0.641 Test Loss: 1.221 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640729).  Saving model ...
Epoch: 25 cost time: 0.9785914421081543
Epoch: 25, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
Validation loss decreased (-0.640729 --> -0.655544).  Saving model ...
Epoch: 26 cost time: 0.8273525238037109
Epoch: 26, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.137 Vali Acc: 0.670 Test Loss: 1.137 Test Acc: 0.670
Validation loss decreased (-0.655544 --> -0.670359).  Saving model ...
Epoch: 27 cost time: 1.1065013408660889
Epoch: 27, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.096 Vali Acc: 0.685 Test Loss: 1.096 Test Acc: 0.685
Validation loss decreased (-0.670359 --> -0.685174).  Saving model ...
Epoch: 28 cost time: 1.0071461200714111
Epoch: 28, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
Validation loss decreased (-0.685174 --> -0.699989).  Saving model ...
Epoch: 29 cost time: 1.0787558555603027
Epoch: 29, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.014 Vali Acc: 0.715 Test Loss: 1.014 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714805).  Saving model ...
Epoch: 30 cost time: 1.0599431991577148
Epoch: 30, Steps: 2 | Train Loss: 1.062 Vali Loss: 0.975 Vali Acc: 0.726 Test Loss: 0.975 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725916).  Saving model ...
Epoch: 31 cost time: 1.0458095073699951
Epoch: 31, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.935 Vali Acc: 0.733 Test Loss: 0.935 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 1.0698707103729248
Epoch: 32, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.895 Vali Acc: 0.748 Test Loss: 0.895 Test Acc: 0.748
Validation loss decreased (-0.733324 --> -0.748139).  Saving model ...
Epoch: 33 cost time: 1.1254918575286865
Epoch: 33, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.856 Vali Acc: 0.781 Test Loss: 0.856 Test Acc: 0.781
Validation loss decreased (-0.748139 --> -0.781473).  Saving model ...
Epoch: 34 cost time: 1.0798089504241943
Epoch: 34, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.819 Vali Acc: 0.789 Test Loss: 0.819 Test Acc: 0.789
Validation loss decreased (-0.781473 --> -0.788881).  Saving model ...
Epoch: 35 cost time: 1.0648376941680908
Epoch: 35, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.782 Vali Acc: 0.804 Test Loss: 0.782 Test Acc: 0.804
Validation loss decreased (-0.788881 --> -0.803696).  Saving model ...
Epoch: 36 cost time: 0.9359803199768066
Epoch: 36, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9024379253387451
Epoch: 37, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.803696 --> -0.811104).  Saving model ...
Epoch: 38 cost time: 0.9201343059539795
Epoch: 38, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.680 Vali Acc: 0.815 Test Loss: 0.680 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 39 cost time: 0.9287128448486328
Epoch: 39, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 40 cost time: 1.0414056777954102
Epoch: 40, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.616 Vali Acc: 0.830 Test Loss: 0.616 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829623).  Saving model ...
Epoch: 41 cost time: 1.0889804363250732
Epoch: 41, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.587 Vali Acc: 0.837 Test Loss: 0.587 Test Acc: 0.837
Validation loss decreased (-0.829623 --> -0.837031).  Saving model ...
Epoch: 42 cost time: 1.112654447555542
Epoch: 42, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.560 Vali Acc: 0.837 Test Loss: 0.560 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 43 cost time: 1.1053378582000732
Epoch: 43, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.837031 --> -0.848143).  Saving model ...
Epoch: 44 cost time: 1.0556201934814453
Epoch: 44, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.848143 --> -0.862958).  Saving model ...
Epoch: 45 cost time: 1.0765838623046875
Epoch: 45, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.862958 --> -0.870366).  Saving model ...
Epoch: 46 cost time: 1.147550344467163
Epoch: 46, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2698354721069336
Epoch: 47, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.433 Vali Acc: 0.874 Test Loss: 0.433 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 48 cost time: 1.051246166229248
Epoch: 48, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.412 Vali Acc: 0.881 Test Loss: 0.412 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881477).  Saving model ...
Epoch: 49 cost time: 1.0373611450195312
Epoch: 49, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
Epoch: 50 cost time: 1.0005500316619873
Epoch: 50, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.375 Vali Acc: 0.893 Test Loss: 0.375 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 51 cost time: 0.9294748306274414
Epoch: 51, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.9508945941925049
Epoch: 52, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 53 cost time: 0.9074864387512207
Epoch: 53, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 54 cost time: 0.8952171802520752
Epoch: 54, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1351797580718994
Epoch: 55, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.028810977935791
Epoch: 56, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0303916931152344
Epoch: 57, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 58 cost time: 1.0416014194488525
Epoch: 58, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 59 cost time: 0.9984145164489746
Epoch: 59, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 60 cost time: 1.1155319213867188
Epoch: 60, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 61 cost time: 1.15028715133667
Epoch: 61, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.256 Vali Acc: 0.915 Test Loss: 0.256 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 62 cost time: 1.0834014415740967
Epoch: 62, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 63 cost time: 1.1576168537139893
Epoch: 63, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 64 cost time: 1.0910284519195557
Epoch: 64, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.244 Vali Acc: 0.915 Test Loss: 0.244 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 65 cost time: 1.1388115882873535
Epoch: 65, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 66 cost time: 1.1051578521728516
Epoch: 66, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 67 cost time: 1.194568395614624
Epoch: 67, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 68 cost time: 1.1879262924194336
Epoch: 68, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 69 cost time: 1.163379192352295
Epoch: 69, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 70 cost time: 1.1786119937896729
Epoch: 70, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 71 cost time: 1.22702956199646
Epoch: 71, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 72 cost time: 1.2207691669464111
Epoch: 72, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 73 cost time: 1.3142693042755127
Epoch: 73, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 74 cost time: 1.1552941799163818
Epoch: 74, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 1.0576167106628418
Epoch: 75, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 1.0781562328338623
Epoch: 76, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 1.0347459316253662
Epoch: 77, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 1.0345160961151123
Epoch: 78, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 1.0548076629638672
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0255749225616455
Epoch: 80, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.1629011631011963
Epoch: 81, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 1.0279664993286133
Epoch: 82, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 1.0015604496002197
Epoch: 83, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.9774832725524902
Epoch: 84, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.005492925643921
Epoch: 85, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.0800731182098389
Epoch: 86, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8378198146820068
Epoch: 87, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.1741769313812256
Epoch: 88, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.0343966484069824
Epoch: 89, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.0345335006713867
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.0095679759979248
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.134814739227295
Epoch: 92, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 1.0059292316436768
Epoch: 93, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 1.0841186046600342
Epoch: 94, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 1.206679344177246
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 1.0949702262878418
Epoch: 96, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 97 cost time: 1.1323261260986328
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1633188724517822
Epoch: 98, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.1477131843566895
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.1882658004760742
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.330740213394165
Epoch: 1, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.883 Vali Acc: 0.111 Test Loss: 1.883 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 1.0373890399932861
Epoch: 2, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.879 Vali Acc: 0.111 Test Loss: 1.879 Test Acc: 0.111
Validation loss decreased (-0.111092 --> -0.111092).  Saving model ...
Epoch: 3 cost time: 1.0285215377807617
Epoch: 3, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.872 Vali Acc: 0.115 Test Loss: 1.872 Test Acc: 0.115
Validation loss decreased (-0.111092 --> -0.114796).  Saving model ...
Epoch: 4 cost time: 1.020113229751587
Epoch: 4, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.859 Vali Acc: 0.119 Test Loss: 1.859 Test Acc: 0.119
Validation loss decreased (-0.114796 --> -0.118500).  Saving model ...
Epoch: 5 cost time: 1.1909425258636475
Epoch: 5, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.842 Vali Acc: 0.119 Test Loss: 1.842 Test Acc: 0.119
Validation loss decreased (-0.118500 --> -0.118500).  Saving model ...
Epoch: 6 cost time: 0.9979782104492188
Epoch: 6, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.821 Vali Acc: 0.137 Test Loss: 1.821 Test Acc: 0.137
Validation loss decreased (-0.118500 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 1.2446599006652832
Epoch: 7, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.797 Vali Acc: 0.156 Test Loss: 1.797 Test Acc: 0.156
Validation loss decreased (-0.137019 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 1.2158751487731934
Epoch: 8, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.771 Vali Acc: 0.167 Test Loss: 1.771 Test Acc: 0.167
Validation loss decreased (-0.155538 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.1059746742248535
Epoch: 9, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.743 Vali Acc: 0.189 Test Loss: 1.743 Test Acc: 0.189
Validation loss decreased (-0.166649 --> -0.188871).  Saving model ...
Epoch: 10 cost time: 1.09710693359375
Epoch: 10, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.711 Vali Acc: 0.230 Test Loss: 1.711 Test Acc: 0.230
Validation loss decreased (-0.188871 --> -0.229613).  Saving model ...
Epoch: 11 cost time: 1.021162986755371
Epoch: 11, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.678 Vali Acc: 0.296 Test Loss: 1.678 Test Acc: 0.296
Validation loss decreased (-0.229613 --> -0.296280).  Saving model ...
Epoch: 12 cost time: 1.093564510345459
Epoch: 12, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.643 Vali Acc: 0.337 Test Loss: 1.643 Test Acc: 0.337
Validation loss decreased (-0.296280 --> -0.337021).  Saving model ...
Epoch: 13 cost time: 1.0790619850158691
Epoch: 13, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.606 Vali Acc: 0.370 Test Loss: 1.606 Test Acc: 0.370
Validation loss decreased (-0.337021 --> -0.370354).  Saving model ...
Epoch: 14 cost time: 1.0037906169891357
Epoch: 14, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (-0.370354 --> -0.411095).  Saving model ...
Epoch: 15 cost time: 1.0371854305267334
Epoch: 15, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.527 Vali Acc: 0.441 Test Loss: 1.527 Test Acc: 0.441
Validation loss decreased (-0.411095 --> -0.440725).  Saving model ...
Epoch: 16 cost time: 1.0814387798309326
Epoch: 16, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.485 Vali Acc: 0.481 Test Loss: 1.485 Test Acc: 0.481
Validation loss decreased (-0.440725 --> -0.481467).  Saving model ...
Epoch: 17 cost time: 0.9077050685882568
Epoch: 17, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.442 Vali Acc: 0.511 Test Loss: 1.442 Test Acc: 0.511
Validation loss decreased (-0.481467 --> -0.511097).  Saving model ...
Epoch: 18 cost time: 1.2781517505645752
Epoch: 18, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.399 Vali Acc: 0.570 Test Loss: 1.399 Test Acc: 0.570
Validation loss decreased (-0.511097 --> -0.570356).  Saving model ...
Epoch: 19 cost time: 1.1888821125030518
Epoch: 19, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.353 Vali Acc: 0.633 Test Loss: 1.353 Test Acc: 0.633
Validation loss decreased (-0.570356 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 1.121187686920166
Epoch: 20, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.307 Vali Acc: 0.681 Test Loss: 1.307 Test Acc: 0.681
Validation loss decreased (-0.633320 --> -0.681468).  Saving model ...
Epoch: 21 cost time: 1.1324191093444824
Epoch: 21, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.261 Vali Acc: 0.700 Test Loss: 1.261 Test Acc: 0.700
Validation loss decreased (-0.681468 --> -0.699987).  Saving model ...
Epoch: 22 cost time: 1.166572093963623
Epoch: 22, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.214 Vali Acc: 0.715 Test Loss: 1.214 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714803).  Saving model ...
Epoch: 23 cost time: 1.1968903541564941
Epoch: 23, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.167 Vali Acc: 0.730 Test Loss: 1.167 Test Acc: 0.730
Validation loss decreased (-0.714803 --> -0.729618).  Saving model ...
Epoch: 24 cost time: 0.9470484256744385
Epoch: 24, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.122 Vali Acc: 0.759 Test Loss: 1.122 Test Acc: 0.759
Validation loss decreased (-0.729618 --> -0.759248).  Saving model ...
Epoch: 25 cost time: 1.0056822299957275
Epoch: 25, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.076 Vali Acc: 0.778 Test Loss: 1.076 Test Acc: 0.778
Validation loss decreased (-0.759248 --> -0.777767).  Saving model ...
Epoch: 26 cost time: 1.0073723793029785
Epoch: 26, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.031 Vali Acc: 0.793 Test Loss: 1.031 Test Acc: 0.793
Validation loss decreased (-0.777767 --> -0.792582).  Saving model ...
Epoch: 27 cost time: 0.9804117679595947
Epoch: 27, Steps: 2 | Train Loss: 1.205 Vali Loss: 0.988 Vali Acc: 0.800 Test Loss: 0.988 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799990).  Saving model ...
Epoch: 28 cost time: 0.9923768043518066
Epoch: 28, Steps: 2 | Train Loss: 1.079 Vali Loss: 0.945 Vali Acc: 0.807 Test Loss: 0.945 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 29 cost time: 0.9334173202514648
Epoch: 29, Steps: 2 | Train Loss: 1.128 Vali Loss: 0.903 Vali Acc: 0.841 Test Loss: 0.903 Test Acc: 0.841
Validation loss decreased (-0.807398 --> -0.840732).  Saving model ...
Epoch: 30 cost time: 1.1512162685394287
Epoch: 30, Steps: 2 | Train Loss: 1.118 Vali Loss: 0.862 Vali Acc: 0.844 Test Loss: 0.862 Test Acc: 0.844
Validation loss decreased (-0.840732 --> -0.844436).  Saving model ...
Epoch: 31 cost time: 1.2443857192993164
Epoch: 31, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1202173233032227
Epoch: 32, Steps: 2 | Train Loss: 1.062 Vali Loss: 0.783 Vali Acc: 0.848 Test Loss: 0.783 Test Acc: 0.848
Validation loss decreased (-0.844436 --> -0.848140).  Saving model ...
Epoch: 33 cost time: 1.0118799209594727
Epoch: 33, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0794365406036377
Epoch: 34, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.713 Vali Acc: 0.848 Test Loss: 0.713 Test Acc: 0.848
Validation loss decreased (-0.848140 --> -0.848141).  Saving model ...
Epoch: 35 cost time: 1.0641131401062012
Epoch: 35, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 1.0536739826202393
Epoch: 36, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 37 cost time: 1.1893901824951172
Epoch: 37, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 38 cost time: 1.0716748237609863
Epoch: 38, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.590 Vali Acc: 0.870 Test Loss: 0.590 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 39 cost time: 0.8612236976623535
Epoch: 39, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870365).  Saving model ...
Epoch: 40 cost time: 1.0201220512390137
Epoch: 40, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.540 Vali Acc: 0.874 Test Loss: 0.540 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 41 cost time: 0.9765856266021729
Epoch: 41, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.517 Vali Acc: 0.874 Test Loss: 0.517 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 42 cost time: 1.126960039138794
Epoch: 42, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9348301887512207
Epoch: 43, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0055060386657715
Epoch: 44, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.005225658416748
Epoch: 45, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.449 Vali Acc: 0.867 Test Loss: 0.449 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.131052017211914
Epoch: 46, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1970772743225098
Epoch: 47, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0125641822814941
Epoch: 48, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877774).  Saving model ...
Epoch: 49 cost time: 0.9818925857543945
Epoch: 49, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.367 Vali Acc: 0.885 Test Loss: 0.367 Test Acc: 0.885
Validation loss decreased (-0.877774 --> -0.885182).  Saving model ...
Epoch: 50 cost time: 1.0391418933868408
Epoch: 50, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.346 Vali Acc: 0.896 Test Loss: 0.346 Test Acc: 0.896
Validation loss decreased (-0.885182 --> -0.896293).  Saving model ...
Epoch: 51 cost time: 1.0120503902435303
Epoch: 51, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
Validation loss decreased (-0.896293 --> -0.907404).  Saving model ...
Epoch: 52 cost time: 1.0122685432434082
Epoch: 52, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.907404 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.9002573490142822
Epoch: 53, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.975428581237793
Epoch: 54, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 55 cost time: 0.9839401245117188
Epoch: 55, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.9313275814056396
Epoch: 56, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 1.0085079669952393
Epoch: 57, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 58 cost time: 0.8772306442260742
Epoch: 58, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 1.2566142082214355
Epoch: 59, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 60 cost time: 1.040386438369751
Epoch: 60, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 1.0837571620941162
Epoch: 61, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 1.0735740661621094
Epoch: 62, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0416738986968994
Epoch: 63, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 1.0667245388031006
Epoch: 64, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 1.188858985900879
Epoch: 65, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 66 cost time: 1.0915989875793457
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0092146396636963
Epoch: 67, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9856789112091064
Epoch: 68, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1011242866516113
Epoch: 69, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1199979782104492
Epoch: 70, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.02628493309021
Epoch: 71, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.181030511856079
Epoch: 72, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0008721351623535
Epoch: 73, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.1888365745544434
Epoch: 74, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.071423053741455
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.339912176132202
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0435662269592285
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.075566053390503
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2084040641784668
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.037440299987793
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0340487957000732
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1457550525665283
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.0897762775421143
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0136253833770752
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0570366382598877
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.202674388885498
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.1979072093963623
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0548195838928223
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.0162711143493652
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 0.8608715534210205
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9706354141235352
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.934119701385498
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.008730411529541
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 0.9261174201965332
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 0.9910352230072021
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 0.9108130931854248
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.1542015075683594
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.2263033390045166
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.1256139278411865
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.1134674549102783
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.0767719745635986
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 0.970308780670166
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 0.958601713180542
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.1434147357940674
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.1038579940795898
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9488813877105713
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.03141188621521
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.0636634826660156
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.0994176864624023
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.053389310836792
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.0765962600708008
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0490751266479492
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.2101294994354248
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2755658626556396
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1545178890228271
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 0.8827610015869141
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.061208963394165
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.0384070873260498
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 0.9430596828460693
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.0028209686279297
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 0.9107768535614014
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9519855976104736
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.1199116706848145
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1175789833068848
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 0.9816057682037354
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.1316840648651123
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.2764415740966797
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.0018179416656494
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9026827812194824
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0727427005767822
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 0.9194750785827637
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 0.971818208694458
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1443848609924316
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0395312309265137
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.125946044921875
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.104813575744629
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.1293823719024658
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.0785322189331055
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.1076786518096924
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.1179382801055908
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.1697871685028076
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.0028660297393799
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.133610486984253
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.0571808815002441
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.1148476600646973
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.0935523509979248
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9719123840332031
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 0.9409198760986328
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.1665382385253906
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.0136518478393555
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.010164499282837
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.0337519645690918
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 0.9212319850921631
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 1.0707018375396729
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 0.9196579456329346
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 0.924004077911377
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 0.9396727085113525
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.0097832679748535
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.0672616958618164
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.203984260559082
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 0.8634209632873535
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.047100305557251
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9999322891235352
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 1.02681565284729
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0514447689056396
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.2550923824310303
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.083453893661499
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.0895485877990723
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.1038718223571777
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0470845699310303
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.3093233108520508
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.112750768661499
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 0.9927043914794922
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.0682101249694824
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.0297212600708008
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 356550
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.341963291168213
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.837 Vali Acc: 0.148 Test Loss: 1.837 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.0347392559051514
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.809 Vali Acc: 0.167 Test Loss: 1.809 Test Acc: 0.167
Validation loss decreased (-0.148130 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0700242519378662
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.783 Vali Acc: 0.185 Test Loss: 1.783 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 1.1162083148956299
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.753 Vali Acc: 0.196 Test Loss: 1.753 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 1.1459105014801025
Epoch: 5, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.713 Vali Acc: 0.226 Test Loss: 1.713 Test Acc: 0.226
Validation loss decreased (-0.196279 --> -0.225909).  Saving model ...
Epoch: 6 cost time: 1.190683126449585
Epoch: 6, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.667 Vali Acc: 0.285 Test Loss: 1.667 Test Acc: 0.285
Validation loss decreased (-0.225909 --> -0.285169).  Saving model ...
Epoch: 7 cost time: 1.0349390506744385
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.617 Vali Acc: 0.378 Test Loss: 1.617 Test Acc: 0.378
Validation loss decreased (-0.285169 --> -0.377762).  Saving model ...
Epoch: 8 cost time: 0.938626766204834
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.563 Vali Acc: 0.504 Test Loss: 1.563 Test Acc: 0.504
Validation loss decreased (-0.377762 --> -0.503688).  Saving model ...
Epoch: 9 cost time: 0.9752252101898193
Epoch: 9, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.507 Vali Acc: 0.596 Test Loss: 1.507 Test Acc: 0.596
Validation loss decreased (-0.503688 --> -0.596281).  Saving model ...
Epoch: 10 cost time: 0.9556798934936523
Epoch: 10, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.448 Vali Acc: 0.648 Test Loss: 1.448 Test Acc: 0.648
Validation loss decreased (-0.596281 --> -0.648134).  Saving model ...
Epoch: 11 cost time: 0.9460668563842773
Epoch: 11, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.390 Vali Acc: 0.689 Test Loss: 1.390 Test Acc: 0.689
Validation loss decreased (-0.648134 --> -0.688875).  Saving model ...
Epoch: 12 cost time: 0.8353619575500488
Epoch: 12, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.332 Vali Acc: 0.730 Test Loss: 1.332 Test Acc: 0.730
Validation loss decreased (-0.688875 --> -0.729616).  Saving model ...
Epoch: 13 cost time: 0.9385380744934082
Epoch: 13, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.274 Vali Acc: 0.737 Test Loss: 1.274 Test Acc: 0.737
Validation loss decreased (-0.729616 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 1.0272250175476074
Epoch: 14, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.219 Vali Acc: 0.741 Test Loss: 1.219 Test Acc: 0.741
Validation loss decreased (-0.737024 --> -0.740729).  Saving model ...
Epoch: 15 cost time: 1.0749597549438477
Epoch: 15, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.163 Vali Acc: 0.759 Test Loss: 1.163 Test Acc: 0.759
Validation loss decreased (-0.740729 --> -0.759248).  Saving model ...
Epoch: 16 cost time: 1.0468051433563232
Epoch: 16, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.110 Vali Acc: 0.770 Test Loss: 1.110 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770359).  Saving model ...
Epoch: 17 cost time: 0.9725103378295898
Epoch: 17, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.058 Vali Acc: 0.778 Test Loss: 1.058 Test Acc: 0.778
Validation loss decreased (-0.770359 --> -0.777767).  Saving model ...
Epoch: 18 cost time: 0.9653856754302979
Epoch: 18, Steps: 2 | Train Loss: 0.715 Vali Loss: 1.008 Vali Acc: 0.785 Test Loss: 1.008 Test Acc: 0.785
Validation loss decreased (-0.777767 --> -0.785175).  Saving model ...
Epoch: 19 cost time: 0.8783965110778809
Epoch: 19, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.963 Vali Acc: 0.785 Test Loss: 0.963 Test Acc: 0.785
Validation loss decreased (-0.785175 --> -0.785176).  Saving model ...
Epoch: 20 cost time: 0.9152679443359375
Epoch: 20, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.921 Vali Acc: 0.781 Test Loss: 0.921 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9264001846313477
Epoch: 21, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.880 Vali Acc: 0.781 Test Loss: 0.880 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9604775905609131
Epoch: 22, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.842 Vali Acc: 0.785 Test Loss: 0.842 Test Acc: 0.785
Validation loss decreased (-0.785176 --> -0.785177).  Saving model ...
Epoch: 23 cost time: 1.0161969661712646
Epoch: 23, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.809 Vali Acc: 0.785 Test Loss: 0.809 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785177).  Saving model ...
Epoch: 24 cost time: 1.0434651374816895
Epoch: 24, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.778 Vali Acc: 0.781 Test Loss: 0.778 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0944206714630127
Epoch: 25, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.750 Vali Acc: 0.785 Test Loss: 0.750 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785178).  Saving model ...
Epoch: 26 cost time: 1.0739798545837402
Epoch: 26, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 1.1835792064666748
Epoch: 27, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.706 Vali Acc: 0.793 Test Loss: 0.706 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 28 cost time: 1.1429204940795898
Epoch: 28, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.792586 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 1.135253667831421
Epoch: 29, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.006209373474121
Epoch: 30, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 31 cost time: 0.897188663482666
Epoch: 31, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.650 Vali Acc: 0.800 Test Loss: 0.650 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 32 cost time: 0.972581148147583
Epoch: 32, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 33 cost time: 0.9913005828857422
Epoch: 33, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 0.9842300415039062
Epoch: 34, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9093465805053711
Epoch: 35, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 36 cost time: 0.952042818069458
Epoch: 36, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 37 cost time: 0.9354851245880127
Epoch: 37, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 38 cost time: 0.9932150840759277
Epoch: 38, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 39 cost time: 1.1292150020599365
Epoch: 39, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 40 cost time: 1.0134656429290771
Epoch: 40, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.589 Vali Acc: 0.807 Test Loss: 0.589 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 41 cost time: 1.002934217453003
Epoch: 41, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.585 Vali Acc: 0.807 Test Loss: 0.585 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 42 cost time: 1.0190415382385254
Epoch: 42, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
Validation loss decreased (-0.807402 --> -0.814809).  Saving model ...
Epoch: 43 cost time: 1.14736008644104
Epoch: 43, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 44 cost time: 1.2781131267547607
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 45 cost time: 0.9966988563537598
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 46 cost time: 1.1010677814483643
Epoch: 46, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 47 cost time: 1.012970209121704
Epoch: 47, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 48 cost time: 1.020885944366455
Epoch: 48, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 49 cost time: 1.1175057888031006
Epoch: 49, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 50 cost time: 1.182643175125122
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 51 cost time: 1.088214635848999
Epoch: 51, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 52 cost time: 1.2799084186553955
Epoch: 52, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 53 cost time: 1.1471283435821533
Epoch: 53, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825920).  Saving model ...
Epoch: 54 cost time: 1.1671690940856934
Epoch: 54, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.830 Test Loss: 0.545 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 55 cost time: 1.1970303058624268
Epoch: 55, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.830 Test Loss: 0.543 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 56 cost time: 1.1405541896820068
Epoch: 56, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.540 Vali Acc: 0.830 Test Loss: 0.540 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 57 cost time: 1.352010726928711
Epoch: 57, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.537 Vali Acc: 0.830 Test Loss: 0.537 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 58 cost time: 1.0511410236358643
Epoch: 58, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 59 cost time: 1.0600097179412842
Epoch: 59, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 60 cost time: 0.9254424571990967
Epoch: 60, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 61 cost time: 1.1534266471862793
Epoch: 61, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 62 cost time: 1.0816593170166016
Epoch: 62, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 63 cost time: 1.046170711517334
Epoch: 63, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 64 cost time: 1.074305534362793
Epoch: 64, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 65 cost time: 1.1195752620697021
Epoch: 65, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 66 cost time: 1.1539156436920166
Epoch: 66, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 67 cost time: 1.089282512664795
Epoch: 67, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 68 cost time: 1.299788236618042
Epoch: 68, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 1.2774052619934082
Epoch: 69, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 1.2136142253875732
Epoch: 70, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 71 cost time: 1.2146618366241455
Epoch: 71, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 1.1626408100128174
Epoch: 72, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 73 cost time: 1.0819861888885498
Epoch: 73, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 74 cost time: 1.190368413925171
Epoch: 74, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 75 cost time: 1.139366626739502
Epoch: 75, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.491 Vali Acc: 0.837 Test Loss: 0.491 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 76 cost time: 1.1124606132507324
Epoch: 76, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 77 cost time: 1.1986439228057861
Epoch: 77, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 78 cost time: 1.1549789905548096
Epoch: 78, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 79 cost time: 1.1014404296875
Epoch: 79, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 80 cost time: 1.2323851585388184
Epoch: 80, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.844440 --> -0.848143).  Saving model ...
Epoch: 81 cost time: 1.2082538604736328
Epoch: 81, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 82 cost time: 1.1081833839416504
Epoch: 82, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 83 cost time: 1.2243409156799316
Epoch: 83, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.479 Vali Acc: 0.852 Test Loss: 0.479 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 84 cost time: 1.0616657733917236
Epoch: 84, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.852 Test Loss: 0.477 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 85 cost time: 1.1317203044891357
Epoch: 85, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.852 Test Loss: 0.476 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 86 cost time: 1.046694278717041
Epoch: 86, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.852 Test Loss: 0.474 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 87 cost time: 0.9902968406677246
Epoch: 87, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.473 Vali Acc: 0.852 Test Loss: 0.473 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 88 cost time: 1.2222952842712402
Epoch: 88, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.471 Vali Acc: 0.852 Test Loss: 0.471 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 89 cost time: 1.0408587455749512
Epoch: 89, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.852 Test Loss: 0.470 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 90 cost time: 1.0420799255371094
Epoch: 90, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.852 Test Loss: 0.468 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 91 cost time: 1.211958885192871
Epoch: 91, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.467 Vali Acc: 0.852 Test Loss: 0.467 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 92 cost time: 1.2113687992095947
Epoch: 92, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.852 Test Loss: 0.466 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 93 cost time: 1.1366956233978271
Epoch: 93, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.852 Test Loss: 0.464 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 94 cost time: 1.163529634475708
Epoch: 94, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.463 Vali Acc: 0.852 Test Loss: 0.463 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 95 cost time: 1.133352518081665
Epoch: 95, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.852 Test Loss: 0.462 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 96 cost time: 1.137451410293579
Epoch: 96, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.852 Test Loss: 0.461 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 97 cost time: 1.0447194576263428
Epoch: 97, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
Validation loss decreased (-0.851847 --> -0.855551).  Saving model ...
Epoch: 98 cost time: 1.0818965435028076
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.859 Test Loss: 0.458 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 99 cost time: 1.1078906059265137
Epoch: 99, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 100 cost time: 1.0645101070404053
Epoch: 100, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862958).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.440640687942505
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.810 Vali Acc: 0.133 Test Loss: 1.810 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.1633961200714111
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.788 Vali Acc: 0.148 Test Loss: 1.788 Test Acc: 0.148
Validation loss decreased (-0.133315 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.989391565322876
Epoch: 3, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.768 Vali Acc: 0.156 Test Loss: 1.768 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155538).  Saving model ...
Epoch: 4 cost time: 1.0405597686767578
Epoch: 4, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.745 Vali Acc: 0.174 Test Loss: 1.745 Test Acc: 0.174
Validation loss decreased (-0.155538 --> -0.174057).  Saving model ...
Epoch: 5 cost time: 1.0518434047698975
Epoch: 5, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.715 Vali Acc: 0.248 Test Loss: 1.715 Test Acc: 0.248
Validation loss decreased (-0.174057 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 1.0741424560546875
Epoch: 6, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.680 Vali Acc: 0.319 Test Loss: 1.680 Test Acc: 0.319
Validation loss decreased (-0.248131 --> -0.318502).  Saving model ...
Epoch: 7 cost time: 1.041677474975586
Epoch: 7, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.642 Vali Acc: 0.389 Test Loss: 1.642 Test Acc: 0.389
Validation loss decreased (-0.318502 --> -0.388872).  Saving model ...
Epoch: 8 cost time: 0.9619114398956299
Epoch: 8, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.601 Vali Acc: 0.485 Test Loss: 1.601 Test Acc: 0.485
Validation loss decreased (-0.388872 --> -0.485169).  Saving model ...
Epoch: 9 cost time: 0.9787569046020508
Epoch: 9, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.559 Vali Acc: 0.541 Test Loss: 1.559 Test Acc: 0.541
Validation loss decreased (-0.485169 --> -0.540725).  Saving model ...
Epoch: 10 cost time: 0.9617147445678711
Epoch: 10, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
Validation loss decreased (-0.540725 --> -0.581466).  Saving model ...
Epoch: 11 cost time: 1.0837759971618652
Epoch: 11, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.470 Vali Acc: 0.600 Test Loss: 1.470 Test Acc: 0.600
Validation loss decreased (-0.581466 --> -0.599985).  Saving model ...
Epoch: 12 cost time: 0.888422966003418
Epoch: 12, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.426 Vali Acc: 0.622 Test Loss: 1.426 Test Acc: 0.622
Validation loss decreased (-0.599985 --> -0.622208).  Saving model ...
Epoch: 13 cost time: 0.8731484413146973
Epoch: 13, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.382 Vali Acc: 0.644 Test Loss: 1.382 Test Acc: 0.644
Validation loss decreased (-0.622208 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 0.8374230861663818
Epoch: 14, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.339 Vali Acc: 0.648 Test Loss: 1.339 Test Acc: 0.648
Validation loss decreased (-0.644431 --> -0.648135).  Saving model ...
Epoch: 15 cost time: 1.0502734184265137
Epoch: 15, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.296 Vali Acc: 0.663 Test Loss: 1.296 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 16 cost time: 1.0656085014343262
Epoch: 16, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.254 Vali Acc: 0.670 Test Loss: 1.254 Test Acc: 0.670
Validation loss decreased (-0.662950 --> -0.670358).  Saving model ...
Epoch: 17 cost time: 0.9707894325256348
Epoch: 17, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.214 Vali Acc: 0.681 Test Loss: 1.214 Test Acc: 0.681
Validation loss decreased (-0.670358 --> -0.681469).  Saving model ...
Epoch: 18 cost time: 1.0724916458129883
Epoch: 18, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.174 Vali Acc: 0.689 Test Loss: 1.174 Test Acc: 0.689
Validation loss decreased (-0.681469 --> -0.688877).  Saving model ...
Epoch: 19 cost time: 1.1135196685791016
Epoch: 19, Steps: 2 | Train Loss: 0.787 Vali Loss: 1.137 Vali Acc: 0.693 Test Loss: 1.137 Test Acc: 0.693
Validation loss decreased (-0.688877 --> -0.692581).  Saving model ...
Epoch: 20 cost time: 1.0225117206573486
Epoch: 20, Steps: 2 | Train Loss: 0.713 Vali Loss: 1.101 Vali Acc: 0.693 Test Loss: 1.101 Test Acc: 0.693
Validation loss decreased (-0.692581 --> -0.692582).  Saving model ...
Epoch: 21 cost time: 0.9953255653381348
Epoch: 21, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.067 Vali Acc: 0.704 Test Loss: 1.067 Test Acc: 0.704
Validation loss decreased (-0.692582 --> -0.703693).  Saving model ...
Epoch: 22 cost time: 0.9443449974060059
Epoch: 22, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
Validation loss decreased (-0.703693 --> -0.711101).  Saving model ...
Epoch: 23 cost time: 1.010465145111084
Epoch: 23, Steps: 2 | Train Loss: 0.534 Vali Loss: 1.004 Vali Acc: 0.711 Test Loss: 1.004 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 24 cost time: 0.9582173824310303
Epoch: 24, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.975 Vali Acc: 0.707 Test Loss: 0.975 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8851826190948486
Epoch: 25, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.948 Vali Acc: 0.707 Test Loss: 0.948 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9244754314422607
Epoch: 26, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 27 cost time: 1.058488130569458
Epoch: 27, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.898 Vali Acc: 0.726 Test Loss: 0.898 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 28 cost time: 1.0063092708587646
Epoch: 28, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
Validation loss decreased (-0.725917 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 1.1652767658233643
Epoch: 29, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.857 Vali Acc: 0.741 Test Loss: 0.857 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740732).  Saving model ...
Epoch: 30 cost time: 1.1074447631835938
Epoch: 30, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.840 Vali Acc: 0.744 Test Loss: 0.840 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744436).  Saving model ...
Epoch: 31 cost time: 1.1104843616485596
Epoch: 31, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.824 Vali Acc: 0.752 Test Loss: 0.824 Test Acc: 0.752
Validation loss decreased (-0.744436 --> -0.751844).  Saving model ...
Epoch: 32 cost time: 1.1699037551879883
Epoch: 32, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.809 Vali Acc: 0.752 Test Loss: 0.809 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 33 cost time: 1.0407779216766357
Epoch: 33, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.796 Vali Acc: 0.759 Test Loss: 0.796 Test Acc: 0.759
Validation loss decreased (-0.751844 --> -0.759251).  Saving model ...
Epoch: 34 cost time: 1.126441478729248
Epoch: 34, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.783 Vali Acc: 0.767 Test Loss: 0.783 Test Acc: 0.767
Validation loss decreased (-0.759251 --> -0.766659).  Saving model ...
Epoch: 35 cost time: 1.0179636478424072
Epoch: 35, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.772 Vali Acc: 0.767 Test Loss: 0.772 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 36 cost time: 1.0263142585754395
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.761 Vali Acc: 0.774 Test Loss: 0.761 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774066).  Saving model ...
Epoch: 37 cost time: 1.0837085247039795
Epoch: 37, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.752 Vali Acc: 0.774 Test Loss: 0.752 Test Acc: 0.774
Validation loss decreased (-0.774066 --> -0.774067).  Saving model ...
Epoch: 38 cost time: 1.0288915634155273
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.743 Vali Acc: 0.781 Test Loss: 0.743 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781474).  Saving model ...
Epoch: 39 cost time: 1.0770840644836426
Epoch: 39, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.734 Vali Acc: 0.781 Test Loss: 0.734 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 40 cost time: 1.1708977222442627
Epoch: 40, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.727 Vali Acc: 0.781 Test Loss: 0.727 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 41 cost time: 1.268975019454956
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.719 Vali Acc: 0.781 Test Loss: 0.719 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 42 cost time: 1.1035780906677246
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.712 Vali Acc: 0.785 Test Loss: 0.712 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 43 cost time: 1.1836259365081787
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788882).  Saving model ...
Epoch: 44 cost time: 1.2055842876434326
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.699 Vali Acc: 0.793 Test Loss: 0.699 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 45 cost time: 1.3430736064910889
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.693 Vali Acc: 0.796 Test Loss: 0.693 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796289).  Saving model ...
Epoch: 46 cost time: 1.1592934131622314
Epoch: 46, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 47 cost time: 1.1403234004974365
Epoch: 47, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 48 cost time: 1.1484453678131104
Epoch: 48, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796290).  Saving model ...
Epoch: 49 cost time: 1.0184369087219238
Epoch: 49, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.669 Vali Acc: 0.796 Test Loss: 0.669 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 50 cost time: 1.0633940696716309
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799993).  Saving model ...
Epoch: 51 cost time: 0.9193840026855469
Epoch: 51, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 52 cost time: 0.9058375358581543
Epoch: 52, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 53 cost time: 0.9727411270141602
Epoch: 53, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 1.0435407161712646
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 55 cost time: 0.9423205852508545
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.987147331237793
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 57 cost time: 1.0329289436340332
Epoch: 57, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 58 cost time: 1.0532519817352295
Epoch: 58, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 59 cost time: 1.042740821838379
Epoch: 59, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.623 Vali Acc: 0.804 Test Loss: 0.623 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 60 cost time: 1.06862211227417
Epoch: 60, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 61 cost time: 1.025475025177002
Epoch: 61, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.614 Vali Acc: 0.804 Test Loss: 0.614 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 62 cost time: 1.0390088558197021
Epoch: 62, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.610 Vali Acc: 0.807 Test Loss: 0.610 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 63 cost time: 1.0076515674591064
Epoch: 63, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.605 Vali Acc: 0.815 Test Loss: 0.605 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814809).  Saving model ...
Epoch: 64 cost time: 1.0342438220977783
Epoch: 64, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.601 Vali Acc: 0.815 Test Loss: 0.601 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 65 cost time: 1.0670030117034912
Epoch: 65, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 66 cost time: 1.1098856925964355
Epoch: 66, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 67 cost time: 1.0403780937194824
Epoch: 67, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 68 cost time: 1.014420986175537
Epoch: 68, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.586 Vali Acc: 0.815 Test Loss: 0.586 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 69 cost time: 1.3163504600524902
Epoch: 69, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.815 Test Loss: 0.583 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 70 cost time: 1.106266736984253
Epoch: 70, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 71 cost time: 1.2724406719207764
Epoch: 71, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 72 cost time: 1.1690196990966797
Epoch: 72, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 73 cost time: 1.1302926540374756
Epoch: 73, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 74 cost time: 1.101416826248169
Epoch: 74, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 75 cost time: 1.1381983757019043
Epoch: 75, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825920).  Saving model ...
Epoch: 76 cost time: 1.0302002429962158
Epoch: 76, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 77 cost time: 1.0671358108520508
Epoch: 77, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.1547291278839111
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 79 cost time: 1.053734540939331
Epoch: 79, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.556 Vali Acc: 0.830 Test Loss: 0.556 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 80 cost time: 1.1713964939117432
Epoch: 80, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.554 Vali Acc: 0.830 Test Loss: 0.554 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 81 cost time: 1.1063899993896484
Epoch: 81, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 82 cost time: 1.1463398933410645
Epoch: 82, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.830 Test Loss: 0.550 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 83 cost time: 1.0168952941894531
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.548 Vali Acc: 0.830 Test Loss: 0.548 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 84 cost time: 1.1309552192687988
Epoch: 84, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.830 Test Loss: 0.546 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 85 cost time: 1.0691258907318115
Epoch: 85, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.830 Test Loss: 0.544 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 86 cost time: 1.0453989505767822
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 87 cost time: 0.9895420074462891
Epoch: 87, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 88 cost time: 1.0165317058563232
Epoch: 88, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 89 cost time: 1.0179879665374756
Epoch: 89, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 90 cost time: 0.9955267906188965
Epoch: 90, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840735).  Saving model ...
Epoch: 91 cost time: 0.9161064624786377
Epoch: 91, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 92 cost time: 1.0329177379608154
Epoch: 92, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 93 cost time: 1.1002073287963867
Epoch: 93, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 94 cost time: 1.0761637687683105
Epoch: 94, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 95 cost time: 1.0971806049346924
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 96 cost time: 1.0749270915985107
Epoch: 96, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840736).  Saving model ...
Epoch: 97 cost time: 1.224351406097412
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 98 cost time: 1.238783597946167
Epoch: 98, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 99 cost time: 1.129683494567871
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840736).  Saving model ...
Epoch: 100 cost time: 1.07753324508667
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8444444444444444
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3032567501068115
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.796 Vali Acc: 0.167 Test Loss: 1.796 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0778801441192627
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.780 Vali Acc: 0.185 Test Loss: 1.780 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.0137414932250977
Epoch: 3, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.767 Vali Acc: 0.207 Test Loss: 1.767 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 1.0333011150360107
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.751 Vali Acc: 0.233 Test Loss: 1.751 Test Acc: 0.233
Validation loss decreased (-0.207390 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 1.0471324920654297
Epoch: 5, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.729 Vali Acc: 0.289 Test Loss: 1.729 Test Acc: 0.289
Validation loss decreased (-0.233316 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 1.112384557723999
Epoch: 6, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.705 Vali Acc: 0.311 Test Loss: 1.705 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 1.1739940643310547
Epoch: 7, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.677 Vali Acc: 0.370 Test Loss: 1.677 Test Acc: 0.370
Validation loss decreased (-0.311094 --> -0.370354).  Saving model ...
Epoch: 8 cost time: 1.1712768077850342
Epoch: 8, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.647 Vali Acc: 0.422 Test Loss: 1.647 Test Acc: 0.422
Validation loss decreased (-0.370354 --> -0.422206).  Saving model ...
Epoch: 9 cost time: 0.9856302738189697
Epoch: 9, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.616 Vali Acc: 0.456 Test Loss: 1.616 Test Acc: 0.456
Validation loss decreased (-0.422206 --> -0.455539).  Saving model ...
Epoch: 10 cost time: 1.1107933521270752
Epoch: 10, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.584 Vali Acc: 0.481 Test Loss: 1.584 Test Acc: 0.481
Validation loss decreased (-0.455539 --> -0.481466).  Saving model ...
Epoch: 11 cost time: 1.0815951824188232
Epoch: 11, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.552 Vali Acc: 0.504 Test Loss: 1.552 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 12 cost time: 0.9768421649932861
Epoch: 12, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
Validation loss decreased (-0.503688 --> -0.518503).  Saving model ...
Epoch: 13 cost time: 1.0151610374450684
Epoch: 13, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
Validation loss decreased (-0.518503 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.9958255290985107
Epoch: 14, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.453 Vali Acc: 0.548 Test Loss: 1.453 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548134).  Saving model ...
Epoch: 15 cost time: 1.0362436771392822
Epoch: 15, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.419 Vali Acc: 0.570 Test Loss: 1.419 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570356).  Saving model ...
Epoch: 16 cost time: 1.0339796543121338
Epoch: 16, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
Validation loss decreased (-0.570356 --> -0.581468).  Saving model ...
Epoch: 17 cost time: 0.9391932487487793
Epoch: 17, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.354 Vali Acc: 0.604 Test Loss: 1.354 Test Acc: 0.604
Validation loss decreased (-0.581468 --> -0.603690).  Saving model ...
Epoch: 18 cost time: 1.0156526565551758
Epoch: 18, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.322 Vali Acc: 0.604 Test Loss: 1.322 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 19 cost time: 0.938518762588501
Epoch: 19, Steps: 2 | Train Loss: 0.908 Vali Loss: 1.291 Vali Acc: 0.604 Test Loss: 1.291 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603691).  Saving model ...
Epoch: 20 cost time: 0.926325798034668
Epoch: 20, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.261 Vali Acc: 0.615 Test Loss: 1.261 Test Acc: 0.615
Validation loss decreased (-0.603691 --> -0.614802).  Saving model ...
Epoch: 21 cost time: 1.1306593418121338
Epoch: 21, Steps: 2 | Train Loss: 0.786 Vali Loss: 1.232 Vali Acc: 0.615 Test Loss: 1.232 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 22 cost time: 1.022524356842041
Epoch: 22, Steps: 2 | Train Loss: 0.710 Vali Loss: 1.202 Vali Acc: 0.630 Test Loss: 1.202 Test Acc: 0.630
Validation loss decreased (-0.614802 --> -0.629618).  Saving model ...
Epoch: 23 cost time: 1.0116822719573975
Epoch: 23, Steps: 2 | Train Loss: 0.673 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.629618 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 1.0816354751586914
Epoch: 24, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.149 Vali Acc: 0.656 Test Loss: 1.149 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655544).  Saving model ...
Epoch: 25 cost time: 1.0641255378723145
Epoch: 25, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.123 Vali Acc: 0.674 Test Loss: 1.123 Test Acc: 0.674
Validation loss decreased (-0.655544 --> -0.674063).  Saving model ...
Epoch: 26 cost time: 1.1954405307769775
Epoch: 26, Steps: 2 | Train Loss: 0.488 Vali Loss: 1.098 Vali Acc: 0.685 Test Loss: 1.098 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685174).  Saving model ...
Epoch: 27 cost time: 1.046356201171875
Epoch: 27, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.073 Vali Acc: 0.685 Test Loss: 1.073 Test Acc: 0.685
Validation loss decreased (-0.685174 --> -0.685174).  Saving model ...
Epoch: 28 cost time: 1.0396268367767334
Epoch: 28, Steps: 2 | Train Loss: 0.412 Vali Loss: 1.050 Vali Acc: 0.689 Test Loss: 1.050 Test Acc: 0.689
Validation loss decreased (-0.685174 --> -0.688878).  Saving model ...
Epoch: 29 cost time: 1.0699360370635986
Epoch: 29, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.027 Vali Acc: 0.689 Test Loss: 1.027 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 30 cost time: 1.0245213508605957
Epoch: 30, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.006 Vali Acc: 0.696 Test Loss: 1.006 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696286).  Saving model ...
Epoch: 31 cost time: 1.0037055015563965
Epoch: 31, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.986 Vali Acc: 0.696 Test Loss: 0.986 Test Acc: 0.696
Validation loss decreased (-0.696286 --> -0.696286).  Saving model ...
Epoch: 32 cost time: 0.9508895874023438
Epoch: 32, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.968 Vali Acc: 0.704 Test Loss: 0.968 Test Acc: 0.704
Validation loss decreased (-0.696286 --> -0.703694).  Saving model ...
Epoch: 33 cost time: 0.9991312026977539
Epoch: 33, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.950 Vali Acc: 0.707 Test Loss: 0.950 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 34 cost time: 1.1647331714630127
Epoch: 34, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.933 Vali Acc: 0.707 Test Loss: 0.933 Test Acc: 0.707
Validation loss decreased (-0.707398 --> -0.707398).  Saving model ...
Epoch: 35 cost time: 1.1758506298065186
Epoch: 35, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.918 Vali Acc: 0.719 Test Loss: 0.918 Test Acc: 0.719
Validation loss decreased (-0.707398 --> -0.718509).  Saving model ...
Epoch: 36 cost time: 1.1803760528564453
Epoch: 36, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 37 cost time: 1.2374496459960938
Epoch: 37, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.895 Vali Acc: 0.722 Test Loss: 0.895 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 38 cost time: 1.0660350322723389
Epoch: 38, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.885 Vali Acc: 0.722 Test Loss: 0.885 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 1.1071650981903076
Epoch: 39, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.875 Vali Acc: 0.730 Test Loss: 0.875 Test Acc: 0.730
Validation loss decreased (-0.722213 --> -0.729621).  Saving model ...
Epoch: 40 cost time: 1.0129766464233398
Epoch: 40, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.866 Vali Acc: 0.737 Test Loss: 0.866 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737028).  Saving model ...
Epoch: 41 cost time: 1.0016396045684814
Epoch: 41, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.857 Vali Acc: 0.741 Test Loss: 0.857 Test Acc: 0.741
Validation loss decreased (-0.737028 --> -0.740732).  Saving model ...
Epoch: 42 cost time: 1.1237449645996094
Epoch: 42, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744436).  Saving model ...
Epoch: 43 cost time: 1.1843457221984863
Epoch: 43, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.840 Vali Acc: 0.752 Test Loss: 0.840 Test Acc: 0.752
Validation loss decreased (-0.744436 --> -0.751843).  Saving model ...
Epoch: 44 cost time: 1.2009499073028564
Epoch: 44, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.832 Vali Acc: 0.752 Test Loss: 0.832 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751844).  Saving model ...
Epoch: 45 cost time: 1.1000683307647705
Epoch: 45, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.824 Vali Acc: 0.752 Test Loss: 0.824 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 46 cost time: 1.156186819076538
Epoch: 46, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.816 Vali Acc: 0.752 Test Loss: 0.816 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 47 cost time: 1.2564001083374023
Epoch: 47, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755547).  Saving model ...
Epoch: 48 cost time: 1.1352229118347168
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 49 cost time: 1.3968887329101562
Epoch: 49, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.792 Vali Acc: 0.759 Test Loss: 0.792 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759251).  Saving model ...
Epoch: 50 cost time: 1.3377761840820312
Epoch: 50, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.785 Vali Acc: 0.763 Test Loss: 0.785 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762955).  Saving model ...
Epoch: 51 cost time: 1.2924189567565918
Epoch: 51, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 52 cost time: 1.3462631702423096
Epoch: 52, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 53 cost time: 1.3470659255981445
Epoch: 53, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.565978765487671
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.758 Vali Acc: 0.774 Test Loss: 0.758 Test Acc: 0.774
Validation loss decreased (-0.766659 --> -0.774066).  Saving model ...
Epoch: 55 cost time: 1.6216645240783691
Epoch: 55, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.752 Vali Acc: 0.774 Test Loss: 0.752 Test Acc: 0.774
Validation loss decreased (-0.774066 --> -0.774067).  Saving model ...
Epoch: 56 cost time: 1.4938361644744873
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 57 cost time: 1.441774845123291
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 58 cost time: 1.3870506286621094
Epoch: 58, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.732 Vali Acc: 0.781 Test Loss: 0.732 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 59 cost time: 1.496466875076294
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.726 Vali Acc: 0.793 Test Loss: 0.726 Test Acc: 0.793
Validation loss decreased (-0.781474 --> -0.792585).  Saving model ...
Epoch: 60 cost time: 1.6260986328125
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.793 Test Loss: 0.720 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792585).  Saving model ...
Epoch: 61 cost time: 1.614940881729126
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.713 Vali Acc: 0.804 Test Loss: 0.713 Test Acc: 0.804
Validation loss decreased (-0.792585 --> -0.803697).  Saving model ...
Epoch: 62 cost time: 1.3640964031219482
Epoch: 62, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.707 Vali Acc: 0.804 Test Loss: 0.707 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 63 cost time: 1.517305850982666
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.701 Vali Acc: 0.804 Test Loss: 0.701 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 64 cost time: 1.398923635482788
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.696 Vali Acc: 0.807 Test Loss: 0.696 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807400).  Saving model ...
Epoch: 65 cost time: 1.6244943141937256
Epoch: 65, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.690 Vali Acc: 0.807 Test Loss: 0.690 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807401).  Saving model ...
Epoch: 66 cost time: 1.4094147682189941
Epoch: 66, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.685 Vali Acc: 0.807 Test Loss: 0.685 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 67 cost time: 1.5360028743743896
Epoch: 67, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.680 Vali Acc: 0.807 Test Loss: 0.680 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 68 cost time: 1.5368154048919678
Epoch: 68, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.675 Vali Acc: 0.811 Test Loss: 0.675 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811104).  Saving model ...
Epoch: 69 cost time: 1.5062026977539062
Epoch: 69, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 70 cost time: 1.4678936004638672
Epoch: 70, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 71 cost time: 1.4264905452728271
Epoch: 71, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 72 cost time: 1.517021656036377
Epoch: 72, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 73 cost time: 1.6192476749420166
Epoch: 73, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 74 cost time: 1.4353294372558594
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814808).  Saving model ...
Epoch: 75 cost time: 1.5575823783874512
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 76 cost time: 1.5533406734466553
Epoch: 76, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 77 cost time: 1.7006173133850098
Epoch: 77, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 78 cost time: 1.9025135040283203
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 79 cost time: 1.5616519451141357
Epoch: 79, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 80 cost time: 1.7622342109680176
Epoch: 80, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 81 cost time: 1.789947509765625
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 82 cost time: 1.992586612701416
Epoch: 82, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 83 cost time: 1.6065890789031982
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 84 cost time: 1.7405805587768555
Epoch: 84, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 85 cost time: 1.7339766025543213
Epoch: 85, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 86 cost time: 1.5774495601654053
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 87 cost time: 1.698958396911621
Epoch: 87, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.607 Vali Acc: 0.826 Test Loss: 0.607 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.5997247695922852
Epoch: 88, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.605 Vali Acc: 0.830 Test Loss: 0.605 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 89 cost time: 1.6754143238067627
Epoch: 89, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.830 Test Loss: 0.602 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 90 cost time: 1.5010731220245361
Epoch: 90, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.830 Test Loss: 0.600 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 91 cost time: 1.785654067993164
Epoch: 91, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.837 Test Loss: 0.597 Test Acc: 0.837
Validation loss decreased (-0.829624 --> -0.837031).  Saving model ...
Epoch: 92 cost time: 1.5611612796783447
Epoch: 92, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 93 cost time: 1.6613383293151855
Epoch: 93, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 94 cost time: 1.5567586421966553
Epoch: 94, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 95 cost time: 1.817699670791626
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 96 cost time: 1.6583538055419922
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 97 cost time: 1.6313650608062744
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 98 cost time: 1.636671781539917
Epoch: 98, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 99 cost time: 1.6186716556549072
Epoch: 99, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.841 Test Loss: 0.579 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 100 cost time: 1.7236964702606201
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.818723201751709
Epoch: 1, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.793 Vali Acc: 0.207 Test Loss: 1.793 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 1.7333548069000244
Epoch: 2, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.781 Vali Acc: 0.222 Test Loss: 1.781 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 1.713498592376709
Epoch: 3, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.771 Vali Acc: 0.252 Test Loss: 1.771 Test Acc: 0.252
Validation loss decreased (-0.222204 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 1.3261702060699463
Epoch: 4, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.759 Vali Acc: 0.259 Test Loss: 1.759 Test Acc: 0.259
Validation loss decreased (-0.251834 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 1.6496226787567139
Epoch: 5, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.743 Vali Acc: 0.289 Test Loss: 1.743 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 1.6771576404571533
Epoch: 6, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.724 Vali Acc: 0.348 Test Loss: 1.724 Test Acc: 0.348
Validation loss decreased (-0.288871 --> -0.348131).  Saving model ...
Epoch: 7 cost time: 1.6764988899230957
Epoch: 7, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.703 Vali Acc: 0.393 Test Loss: 1.703 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 1.6924772262573242
Epoch: 8, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.681 Vali Acc: 0.433 Test Loss: 1.681 Test Acc: 0.433
Validation loss decreased (-0.392576 --> -0.433317).  Saving model ...
Epoch: 9 cost time: 1.5303916931152344
Epoch: 9, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.658 Vali Acc: 0.467 Test Loss: 1.658 Test Acc: 0.467
Validation loss decreased (-0.433317 --> -0.466650).  Saving model ...
Epoch: 10 cost time: 1.7470893859863281
Epoch: 10, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.634 Vali Acc: 0.467 Test Loss: 1.634 Test Acc: 0.467
Validation loss decreased (-0.466650 --> -0.466650).  Saving model ...
Epoch: 11 cost time: 1.3434910774230957
Epoch: 11, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.609 Vali Acc: 0.485 Test Loss: 1.609 Test Acc: 0.485
Validation loss decreased (-0.466650 --> -0.485169).  Saving model ...
Epoch: 12 cost time: 1.498673677444458
Epoch: 12, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
Validation loss decreased (-0.485169 --> -0.499984).  Saving model ...
Epoch: 13 cost time: 1.658506155014038
Epoch: 13, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.559 Vali Acc: 0.507 Test Loss: 1.559 Test Acc: 0.507
Validation loss decreased (-0.499984 --> -0.507392).  Saving model ...
Epoch: 14 cost time: 2.0357422828674316
Epoch: 14, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.534 Vali Acc: 0.507 Test Loss: 1.534 Test Acc: 0.507
Validation loss decreased (-0.507392 --> -0.507392).  Saving model ...
Epoch: 15 cost time: 1.8213179111480713
Epoch: 15, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.507 Vali Acc: 0.515 Test Loss: 1.507 Test Acc: 0.515
Validation loss decreased (-0.507392 --> -0.514800).  Saving model ...
Epoch: 16 cost time: 1.5538666248321533
Epoch: 16, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.480 Vali Acc: 0.519 Test Loss: 1.480 Test Acc: 0.519
Validation loss decreased (-0.514800 --> -0.518504).  Saving model ...
Epoch: 17 cost time: 1.6178817749023438
Epoch: 17, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.454 Vali Acc: 0.533 Test Loss: 1.454 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 18 cost time: 1.6808300018310547
Epoch: 18, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.428 Vali Acc: 0.530 Test Loss: 1.428 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6595194339752197
Epoch: 19, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.403 Vali Acc: 0.522 Test Loss: 1.403 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.696467638015747
Epoch: 20, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540727).  Saving model ...
Epoch: 21 cost time: 1.7841367721557617
Epoch: 21, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.354 Vali Acc: 0.537 Test Loss: 1.354 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7011656761169434
Epoch: 22, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 23 cost time: 1.8925554752349854
Epoch: 23, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540728).  Saving model ...
Epoch: 24 cost time: 1.9450631141662598
Epoch: 24, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.285 Vali Acc: 0.544 Test Loss: 1.285 Test Acc: 0.544
Validation loss decreased (-0.540728 --> -0.544432).  Saving model ...
Epoch: 25 cost time: 1.626032829284668
Epoch: 25, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.263 Vali Acc: 0.544 Test Loss: 1.263 Test Acc: 0.544
Validation loss decreased (-0.544432 --> -0.544432).  Saving model ...
Epoch: 26 cost time: 1.9424026012420654
Epoch: 26, Steps: 2 | Train Loss: 0.691 Vali Loss: 1.241 Vali Acc: 0.548 Test Loss: 1.241 Test Acc: 0.548
Validation loss decreased (-0.544432 --> -0.548136).  Saving model ...
Epoch: 27 cost time: 1.6641552448272705
Epoch: 27, Steps: 2 | Train Loss: 0.650 Vali Loss: 1.219 Vali Acc: 0.552 Test Loss: 1.219 Test Acc: 0.552
Validation loss decreased (-0.548136 --> -0.551840).  Saving model ...
Epoch: 28 cost time: 1.7871131896972656
Epoch: 28, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.198 Vali Acc: 0.559 Test Loss: 1.198 Test Acc: 0.559
Validation loss decreased (-0.551840 --> -0.559247).  Saving model ...
Epoch: 29 cost time: 1.6942687034606934
Epoch: 29, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.177 Vali Acc: 0.563 Test Loss: 1.177 Test Acc: 0.563
Validation loss decreased (-0.559247 --> -0.562951).  Saving model ...
Epoch: 30 cost time: 1.5016624927520752
Epoch: 30, Steps: 2 | Train Loss: 0.488 Vali Loss: 1.156 Vali Acc: 0.574 Test Loss: 1.156 Test Acc: 0.574
Validation loss decreased (-0.562951 --> -0.574063).  Saving model ...
Epoch: 31 cost time: 1.6879997253417969
Epoch: 31, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.136 Vali Acc: 0.574 Test Loss: 1.136 Test Acc: 0.574
Validation loss decreased (-0.574063 --> -0.574063).  Saving model ...
Epoch: 32 cost time: 1.6670928001403809
Epoch: 32, Steps: 2 | Train Loss: 0.461 Vali Loss: 1.115 Vali Acc: 0.593 Test Loss: 1.115 Test Acc: 0.593
Validation loss decreased (-0.574063 --> -0.592581).  Saving model ...
Epoch: 33 cost time: 1.9119391441345215
Epoch: 33, Steps: 2 | Train Loss: 0.395 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.592581 --> -0.599989).  Saving model ...
Epoch: 34 cost time: 1.599118947982788
Epoch: 34, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.071 Vali Acc: 0.615 Test Loss: 1.071 Test Acc: 0.615
Validation loss decreased (-0.599989 --> -0.614804).  Saving model ...
Epoch: 35 cost time: 1.9278578758239746
Epoch: 35, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.050 Vali Acc: 0.619 Test Loss: 1.050 Test Acc: 0.619
Validation loss decreased (-0.614804 --> -0.618508).  Saving model ...
Epoch: 36 cost time: 1.446228265762329
Epoch: 36, Steps: 2 | Train Loss: 0.246 Vali Loss: 1.030 Vali Acc: 0.626 Test Loss: 1.030 Test Acc: 0.626
Validation loss decreased (-0.618508 --> -0.625916).  Saving model ...
Epoch: 37 cost time: 1.4810879230499268
Epoch: 37, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.010 Vali Acc: 0.630 Test Loss: 1.010 Test Acc: 0.630
Validation loss decreased (-0.625916 --> -0.629620).  Saving model ...
Epoch: 38 cost time: 1.5378055572509766
Epoch: 38, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.991 Vali Acc: 0.637 Test Loss: 0.991 Test Acc: 0.637
Validation loss decreased (-0.629620 --> -0.637027).  Saving model ...
Epoch: 39 cost time: 1.426903486251831
Epoch: 39, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.971 Vali Acc: 0.644 Test Loss: 0.971 Test Acc: 0.644
Validation loss decreased (-0.637027 --> -0.644435).  Saving model ...
Epoch: 40 cost time: 1.4688594341278076
Epoch: 40, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.953 Vali Acc: 0.652 Test Loss: 0.953 Test Acc: 0.652
Validation loss decreased (-0.644435 --> -0.651842).  Saving model ...
Epoch: 41 cost time: 1.533951759338379
Epoch: 41, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.934 Vali Acc: 0.656 Test Loss: 0.934 Test Acc: 0.656
Validation loss decreased (-0.651842 --> -0.655546).  Saving model ...
Epoch: 42 cost time: 1.7051372528076172
Epoch: 42, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.916 Vali Acc: 0.667 Test Loss: 0.916 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666658).  Saving model ...
Epoch: 43 cost time: 1.7734737396240234
Epoch: 43, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.898 Vali Acc: 0.674 Test Loss: 0.898 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.674065).  Saving model ...
Epoch: 44 cost time: 1.5533721446990967
Epoch: 44, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.880 Vali Acc: 0.678 Test Loss: 0.880 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 45 cost time: 1.784595012664795
Epoch: 45, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.864 Vali Acc: 0.689 Test Loss: 0.864 Test Acc: 0.689
Validation loss decreased (-0.677769 --> -0.688880).  Saving model ...
Epoch: 46 cost time: 1.5701274871826172
Epoch: 46, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.849 Vali Acc: 0.700 Test Loss: 0.849 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699992).  Saving model ...
Epoch: 47 cost time: 1.8192620277404785
Epoch: 47, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.834 Vali Acc: 0.715 Test Loss: 0.834 Test Acc: 0.715
Validation loss decreased (-0.699992 --> -0.714806).  Saving model ...
Epoch: 48 cost time: 1.7165064811706543
Epoch: 48, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.820 Vali Acc: 0.715 Test Loss: 0.820 Test Acc: 0.715
Validation loss decreased (-0.714806 --> -0.714807).  Saving model ...
Epoch: 49 cost time: 1.572455644607544
Epoch: 49, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.806 Vali Acc: 0.719 Test Loss: 0.806 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718510).  Saving model ...
Epoch: 50 cost time: 1.6639702320098877
Epoch: 50, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.793 Vali Acc: 0.726 Test Loss: 0.793 Test Acc: 0.726
Validation loss decreased (-0.718510 --> -0.725918).  Saving model ...
Epoch: 51 cost time: 1.55778169631958
Epoch: 51, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.780 Vali Acc: 0.733 Test Loss: 0.780 Test Acc: 0.733
Validation loss decreased (-0.725918 --> -0.733326).  Saving model ...
Epoch: 52 cost time: 1.8927736282348633
Epoch: 52, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.769 Vali Acc: 0.741 Test Loss: 0.769 Test Acc: 0.741
Validation loss decreased (-0.733326 --> -0.740733).  Saving model ...
Epoch: 53 cost time: 1.6325392723083496
Epoch: 53, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.757 Vali Acc: 0.744 Test Loss: 0.757 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 54 cost time: 1.4644899368286133
Epoch: 54, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 55 cost time: 1.6508209705352783
Epoch: 55, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.736 Vali Acc: 0.744 Test Loss: 0.736 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 56 cost time: 1.50130033493042
Epoch: 56, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.726 Vali Acc: 0.752 Test Loss: 0.726 Test Acc: 0.752
Validation loss decreased (-0.744437 --> -0.751845).  Saving model ...
Epoch: 57 cost time: 1.4225950241088867
Epoch: 57, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.718 Vali Acc: 0.752 Test Loss: 0.718 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 58 cost time: 1.6957926750183105
Epoch: 58, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.709 Vali Acc: 0.759 Test Loss: 0.709 Test Acc: 0.759
Validation loss decreased (-0.751845 --> -0.759252).  Saving model ...
Epoch: 59 cost time: 1.8467941284179688
Epoch: 59, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 60 cost time: 1.482417106628418
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.692 Vali Acc: 0.759 Test Loss: 0.692 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6275451183319092
Epoch: 61, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 62 cost time: 1.3934340476989746
Epoch: 62, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 63 cost time: 1.822700023651123
Epoch: 63, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.672 Vali Acc: 0.770 Test Loss: 0.672 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 64 cost time: 1.4629034996032715
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.665 Vali Acc: 0.774 Test Loss: 0.665 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 65 cost time: 1.515498161315918
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.660 Vali Acc: 0.778 Test Loss: 0.660 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 66 cost time: 1.4772906303405762
Epoch: 66, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.654 Vali Acc: 0.785 Test Loss: 0.654 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 67 cost time: 1.528376817703247
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.648 Vali Acc: 0.785 Test Loss: 0.648 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 68 cost time: 1.5534203052520752
Epoch: 68, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.643 Vali Acc: 0.785 Test Loss: 0.643 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 69 cost time: 1.5939562320709229
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.638 Vali Acc: 0.785 Test Loss: 0.638 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 70 cost time: 1.868055820465088
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 71 cost time: 1.7851662635803223
Epoch: 71, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.631 Vali Acc: 0.793 Test Loss: 0.631 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 72 cost time: 1.5548186302185059
Epoch: 72, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 73 cost time: 2.084174156188965
Epoch: 73, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 74 cost time: 1.5976808071136475
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 75 cost time: 1.8830311298370361
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 76 cost time: 1.666954755783081
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 77 cost time: 1.7277717590332031
Epoch: 77, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 78 cost time: 1.6906111240386963
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.793 Test Loss: 0.604 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.764617919921875
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.793 Test Loss: 0.601 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.7577381134033203
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 81 cost time: 1.7854838371276855
Epoch: 81, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 82 cost time: 1.7314317226409912
Epoch: 82, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 83 cost time: 1.6505248546600342
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 84 cost time: 1.80401611328125
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 85 cost time: 1.6077759265899658
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 86 cost time: 1.825049638748169
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 87 cost time: 1.9767837524414062
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.804 Test Loss: 0.582 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 88 cost time: 1.4865636825561523
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.579 Vali Acc: 0.804 Test Loss: 0.579 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 89 cost time: 1.7849533557891846
Epoch: 89, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.804 Test Loss: 0.576 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 90 cost time: 1.6888787746429443
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 91 cost time: 1.637408971786499
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.804 Test Loss: 0.571 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 92 cost time: 1.5799760818481445
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 93 cost time: 1.6716628074645996
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.804 Test Loss: 0.566 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 94 cost time: 1.8650574684143066
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.807 Test Loss: 0.563 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 95 cost time: 1.8563551902770996
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.560 Vali Acc: 0.811 Test Loss: 0.560 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811106).  Saving model ...
Epoch: 96 cost time: 1.7981007099151611
Epoch: 96, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.558 Vali Acc: 0.811 Test Loss: 0.558 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 97 cost time: 1.6285977363586426
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
Validation loss decreased (-0.811106 --> -0.814809).  Saving model ...
Epoch: 98 cost time: 2.053393840789795
Epoch: 98, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 99 cost time: 1.777482509613037
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 100 cost time: 2.0117650032043457
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4432570934295654
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.762 Vali Acc: 0.252 Test Loss: 1.762 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 1.8159592151641846
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.755 Vali Acc: 0.259 Test Loss: 1.755 Test Acc: 0.259
Validation loss decreased (-0.251834 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 1.5503959655761719
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.748 Vali Acc: 0.263 Test Loss: 1.748 Test Acc: 0.263
Validation loss decreased (-0.259242 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 1.453749418258667
Epoch: 4, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.739 Vali Acc: 0.256 Test Loss: 1.739 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8307251930236816
Epoch: 5, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.727 Vali Acc: 0.270 Test Loss: 1.727 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 6 cost time: 1.8181891441345215
Epoch: 6, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.713 Vali Acc: 0.285 Test Loss: 1.713 Test Acc: 0.285
Validation loss decreased (-0.270353 --> -0.285168).  Saving model ...
Epoch: 7 cost time: 1.4356045722961426
Epoch: 7, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.697 Vali Acc: 0.315 Test Loss: 1.697 Test Acc: 0.315
Validation loss decreased (-0.285168 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 1.4379088878631592
Epoch: 8, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.680 Vali Acc: 0.337 Test Loss: 1.680 Test Acc: 0.337
Validation loss decreased (-0.314798 --> -0.337020).  Saving model ...
Epoch: 9 cost time: 1.7180168628692627
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.662 Vali Acc: 0.348 Test Loss: 1.662 Test Acc: 0.348
Validation loss decreased (-0.337020 --> -0.348132).  Saving model ...
Epoch: 10 cost time: 1.834336519241333
Epoch: 10, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.643 Vali Acc: 0.367 Test Loss: 1.643 Test Acc: 0.367
Validation loss decreased (-0.348132 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 1.5634880065917969
Epoch: 11, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.622 Vali Acc: 0.393 Test Loss: 1.622 Test Acc: 0.393
Validation loss decreased (-0.366650 --> -0.392576).  Saving model ...
Epoch: 12 cost time: 1.528193473815918
Epoch: 12, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.601 Vali Acc: 0.422 Test Loss: 1.601 Test Acc: 0.422
Validation loss decreased (-0.392576 --> -0.422206).  Saving model ...
Epoch: 13 cost time: 1.55419921875
Epoch: 13, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.422206 --> -0.444429).  Saving model ...
Epoch: 14 cost time: 1.621981143951416
Epoch: 14, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.558 Vali Acc: 0.456 Test Loss: 1.558 Test Acc: 0.456
Validation loss decreased (-0.444429 --> -0.455540).  Saving model ...
Epoch: 15 cost time: 1.4883649349212646
Epoch: 15, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.455540 --> -0.481466).  Saving model ...
Epoch: 16 cost time: 1.6320197582244873
Epoch: 16, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.510 Vali Acc: 0.511 Test Loss: 1.510 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 1.5813305377960205
Epoch: 17, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
Validation loss decreased (-0.511096 --> -0.529615).  Saving model ...
Epoch: 18 cost time: 1.4916725158691406
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.462 Vali Acc: 0.544 Test Loss: 1.462 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544430).  Saving model ...
Epoch: 19 cost time: 1.6600892543792725
Epoch: 19, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.438 Vali Acc: 0.548 Test Loss: 1.438 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 20 cost time: 1.707012414932251
Epoch: 20, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.413 Vali Acc: 0.556 Test Loss: 1.413 Test Acc: 0.556
Validation loss decreased (-0.548134 --> -0.555541).  Saving model ...
Epoch: 21 cost time: 1.9780709743499756
Epoch: 21, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.387 Vali Acc: 0.556 Test Loss: 1.387 Test Acc: 0.556
Validation loss decreased (-0.555541 --> -0.555542).  Saving model ...
Epoch: 22 cost time: 1.6454977989196777
Epoch: 22, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.360 Vali Acc: 0.556 Test Loss: 1.360 Test Acc: 0.556
Validation loss decreased (-0.555542 --> -0.555542).  Saving model ...
Epoch: 23 cost time: 1.6785192489624023
Epoch: 23, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.333 Vali Acc: 0.559 Test Loss: 1.333 Test Acc: 0.559
Validation loss decreased (-0.555542 --> -0.559246).  Saving model ...
Epoch: 24 cost time: 1.9391379356384277
Epoch: 24, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.305 Vali Acc: 0.567 Test Loss: 1.305 Test Acc: 0.567
Validation loss decreased (-0.559246 --> -0.566654).  Saving model ...
Epoch: 25 cost time: 1.8884871006011963
Epoch: 25, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.277 Vali Acc: 0.581 Test Loss: 1.277 Test Acc: 0.581
Validation loss decreased (-0.566654 --> -0.581469).  Saving model ...
Epoch: 26 cost time: 1.6663627624511719
Epoch: 26, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.249 Vali Acc: 0.585 Test Loss: 1.249 Test Acc: 0.585
Validation loss decreased (-0.581469 --> -0.585173).  Saving model ...
Epoch: 27 cost time: 1.5991616249084473
Epoch: 27, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.221 Vali Acc: 0.604 Test Loss: 1.221 Test Acc: 0.604
Validation loss decreased (-0.585173 --> -0.603691).  Saving model ...
Epoch: 28 cost time: 1.6484243869781494
Epoch: 28, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.191 Vali Acc: 0.615 Test Loss: 1.191 Test Acc: 0.615
Validation loss decreased (-0.603691 --> -0.614803).  Saving model ...
Epoch: 29 cost time: 1.750901222229004
Epoch: 29, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.161 Vali Acc: 0.637 Test Loss: 1.161 Test Acc: 0.637
Validation loss decreased (-0.614803 --> -0.637025).  Saving model ...
Epoch: 30 cost time: 1.6572976112365723
Epoch: 30, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.130 Vali Acc: 0.652 Test Loss: 1.130 Test Acc: 0.652
Validation loss decreased (-0.637025 --> -0.651841).  Saving model ...
Epoch: 31 cost time: 2.0505592823028564
Epoch: 31, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.098 Vali Acc: 0.685 Test Loss: 1.098 Test Acc: 0.685
Validation loss decreased (-0.651841 --> -0.685174).  Saving model ...
Epoch: 32 cost time: 1.7870712280273438
Epoch: 32, Steps: 2 | Train Loss: 0.659 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.685174 --> -0.699989).  Saving model ...
Epoch: 33 cost time: 1.5202951431274414
Epoch: 33, Steps: 2 | Train Loss: 0.607 Vali Loss: 1.031 Vali Acc: 0.707 Test Loss: 1.031 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.707397).  Saving model ...
Epoch: 34 cost time: 1.7643446922302246
Epoch: 34, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
Validation loss decreased (-0.707397 --> -0.722212).  Saving model ...
Epoch: 35 cost time: 1.743532657623291
Epoch: 35, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.961 Vali Acc: 0.719 Test Loss: 0.961 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7104337215423584
Epoch: 36, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.925 Vali Acc: 0.730 Test Loss: 0.925 Test Acc: 0.730
Validation loss decreased (-0.722212 --> -0.729620).  Saving model ...
Epoch: 37 cost time: 1.638672113418579
Epoch: 37, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.891 Vali Acc: 0.741 Test Loss: 0.891 Test Acc: 0.741
Validation loss decreased (-0.729620 --> -0.740732).  Saving model ...
Epoch: 38 cost time: 1.5366969108581543
Epoch: 38, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.858 Vali Acc: 0.748 Test Loss: 0.858 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 39 cost time: 1.574733018875122
Epoch: 39, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.825 Vali Acc: 0.748 Test Loss: 0.825 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 40 cost time: 1.735222578048706
Epoch: 40, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
Validation loss decreased (-0.748140 --> -0.755548).  Saving model ...
Epoch: 41 cost time: 2.1510097980499268
Epoch: 41, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.760 Vali Acc: 0.774 Test Loss: 0.760 Test Acc: 0.774
Validation loss decreased (-0.755548 --> -0.774066).  Saving model ...
Epoch: 42 cost time: 2.091670036315918
Epoch: 42, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.728 Vali Acc: 0.781 Test Loss: 0.728 Test Acc: 0.781
Validation loss decreased (-0.774066 --> -0.781474).  Saving model ...
Epoch: 43 cost time: 2.11141300201416
Epoch: 43, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.697 Vali Acc: 0.781 Test Loss: 0.697 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781475).  Saving model ...
Epoch: 44 cost time: 2.2109413146972656
Epoch: 44, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 45 cost time: 2.1057839393615723
Epoch: 45, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 2.0693163871765137
Epoch: 46, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.616 Vali Acc: 0.807 Test Loss: 0.616 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807401).  Saving model ...
Epoch: 47 cost time: 2.0867836475372314
Epoch: 47, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.594 Vali Acc: 0.807 Test Loss: 0.594 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 48 cost time: 1.9874763488769531
Epoch: 48, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.807401 --> -0.814809).  Saving model ...
Epoch: 49 cost time: 1.9969186782836914
Epoch: 49, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822217).  Saving model ...
Epoch: 50 cost time: 2.086047649383545
Epoch: 50, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.223924398422241
Epoch: 51, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825921).  Saving model ...
Epoch: 52 cost time: 2.026937246322632
Epoch: 52, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.9810271263122559
Epoch: 53, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.024223804473877
Epoch: 54, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.1250877380371094
Epoch: 55, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 56 cost time: 2.446357011795044
Epoch: 56, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.502 Vali Acc: 0.830 Test Loss: 0.502 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 57 cost time: 2.07964825630188
Epoch: 57, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.495 Vali Acc: 0.830 Test Loss: 0.495 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 58 cost time: 2.4088172912597656
Epoch: 58, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.487 Vali Acc: 0.830 Test Loss: 0.487 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 59 cost time: 2.1472420692443848
Epoch: 59, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 60 cost time: 2.183922290802002
Epoch: 60, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.471 Vali Acc: 0.837 Test Loss: 0.471 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837032).  Saving model ...
Epoch: 61 cost time: 2.2427785396575928
Epoch: 61, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.463 Vali Acc: 0.837 Test Loss: 0.463 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 62 cost time: 2.503535747528076
Epoch: 62, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 63 cost time: 2.3969879150390625
Epoch: 63, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.840736 --> -0.848144).  Saving model ...
Epoch: 64 cost time: 2.551403045654297
Epoch: 64, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 65 cost time: 2.1602158546447754
Epoch: 65, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
Validation loss decreased (-0.848144 --> -0.855551).  Saving model ...
Epoch: 66 cost time: 2.1430277824401855
Epoch: 66, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.424 Vali Acc: 0.856 Test Loss: 0.424 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 67 cost time: 1.5601749420166016
Epoch: 67, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.417 Vali Acc: 0.859 Test Loss: 0.417 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 68 cost time: 1.7163898944854736
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.412 Vali Acc: 0.863 Test Loss: 0.412 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862959).  Saving model ...
Epoch: 69 cost time: 1.870020866394043
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 70 cost time: 1.759307861328125
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.402 Vali Acc: 0.863 Test Loss: 0.402 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 71 cost time: 1.9240896701812744
Epoch: 71, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.862959 --> -0.870366).  Saving model ...
Epoch: 72 cost time: 1.7942674160003662
Epoch: 72, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
Validation loss decreased (-0.870366 --> -0.874070).  Saving model ...
Epoch: 73 cost time: 1.938382625579834
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.874 Test Loss: 0.391 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 74 cost time: 1.7881407737731934
Epoch: 74, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.387 Vali Acc: 0.874 Test Loss: 0.387 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 75 cost time: 1.8713405132293701
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.383 Vali Acc: 0.874 Test Loss: 0.383 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 76 cost time: 2.2735183238983154
Epoch: 76, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.380 Vali Acc: 0.874 Test Loss: 0.380 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 77 cost time: 1.857621192932129
Epoch: 77, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.376 Vali Acc: 0.874 Test Loss: 0.376 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 78 cost time: 1.5980961322784424
Epoch: 78, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.373 Vali Acc: 0.874 Test Loss: 0.373 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 79 cost time: 1.6651513576507568
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.370 Vali Acc: 0.878 Test Loss: 0.370 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 80 cost time: 1.703843116760254
Epoch: 80, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.368 Vali Acc: 0.878 Test Loss: 0.368 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 81 cost time: 1.7471468448638916
Epoch: 81, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 82 cost time: 1.5334346294403076
Epoch: 82, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.367 Vali Acc: 0.874 Test Loss: 0.367 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.833127737045288
Epoch: 83, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 84 cost time: 1.769866943359375
Epoch: 84, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 85 cost time: 1.683100938796997
Epoch: 85, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 86 cost time: 2.1145429611206055
Epoch: 86, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 87 cost time: 1.747795581817627
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 88 cost time: 1.857417345046997
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.362 Vali Acc: 0.881 Test Loss: 0.362 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 89 cost time: 1.8059298992156982
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.360 Vali Acc: 0.885 Test Loss: 0.360 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 90 cost time: 1.7091925144195557
Epoch: 90, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888885).  Saving model ...
Epoch: 91 cost time: 2.1611552238464355
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.354 Vali Acc: 0.893 Test Loss: 0.354 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 92 cost time: 1.697911024093628
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.352 Vali Acc: 0.893 Test Loss: 0.352 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 93 cost time: 1.8122408390045166
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899996).  Saving model ...
Epoch: 94 cost time: 1.8353638648986816
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 1.6512432098388672
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.896 Test Loss: 0.347 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7829036712646484
Epoch: 96, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.345 Vali Acc: 0.896 Test Loss: 0.345 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.7595787048339844
Epoch: 97, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.343 Vali Acc: 0.896 Test Loss: 0.343 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 2.060370445251465
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 99 cost time: 1.8314707279205322
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 1.6308557987213135
Epoch: 100, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.3221049308776855
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.801 Vali Acc: 0.170 Test Loss: 1.801 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 2.341970205307007
Epoch: 2, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.796 Vali Acc: 0.178 Test Loss: 1.796 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 2.1668694019317627
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.790 Vali Acc: 0.193 Test Loss: 1.790 Test Acc: 0.193
Validation loss decreased (-0.177760 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 2.1942176818847656
Epoch: 4, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.780 Vali Acc: 0.204 Test Loss: 1.780 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 2.545830726623535
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.767 Vali Acc: 0.219 Test Loss: 1.767 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 2.065113067626953
Epoch: 6, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.751 Vali Acc: 0.241 Test Loss: 1.751 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 1.7823128700256348
Epoch: 7, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 1.8422670364379883
Epoch: 8, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.712 Vali Acc: 0.315 Test Loss: 1.712 Test Acc: 0.315
Validation loss decreased (-0.274057 --> -0.314798).  Saving model ...
Epoch: 9 cost time: 1.8822352886199951
Epoch: 9, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.690 Vali Acc: 0.337 Test Loss: 1.690 Test Acc: 0.337
Validation loss decreased (-0.314798 --> -0.337020).  Saving model ...
Epoch: 10 cost time: 2.3230926990509033
Epoch: 10, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.666 Vali Acc: 0.356 Test Loss: 1.666 Test Acc: 0.356
Validation loss decreased (-0.337020 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 1.8024890422821045
Epoch: 11, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.641 Vali Acc: 0.381 Test Loss: 1.641 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 12 cost time: 2.183880090713501
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.614 Vali Acc: 0.441 Test Loss: 1.614 Test Acc: 0.441
Validation loss decreased (-0.381465 --> -0.440725).  Saving model ...
Epoch: 13 cost time: 2.299283027648926
Epoch: 13, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.586 Vali Acc: 0.467 Test Loss: 1.586 Test Acc: 0.467
Validation loss decreased (-0.440725 --> -0.466651).  Saving model ...
Epoch: 14 cost time: 1.7541077136993408
Epoch: 14, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.556 Vali Acc: 0.500 Test Loss: 1.556 Test Acc: 0.500
Validation loss decreased (-0.466651 --> -0.499984).  Saving model ...
Epoch: 15 cost time: 1.9567971229553223
Epoch: 15, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.526 Vali Acc: 0.504 Test Loss: 1.526 Test Acc: 0.504
Validation loss decreased (-0.499984 --> -0.503688).  Saving model ...
Epoch: 16 cost time: 1.8782718181610107
Epoch: 16, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.493 Vali Acc: 0.541 Test Loss: 1.493 Test Acc: 0.541
Validation loss decreased (-0.503688 --> -0.540726).  Saving model ...
Epoch: 17 cost time: 2.1191020011901855
Epoch: 17, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.459 Vali Acc: 0.556 Test Loss: 1.459 Test Acc: 0.556
Validation loss decreased (-0.540726 --> -0.555541).  Saving model ...
Epoch: 18 cost time: 1.7738301753997803
Epoch: 18, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.424 Vali Acc: 0.578 Test Loss: 1.424 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577764).  Saving model ...
Epoch: 19 cost time: 1.8744592666625977
Epoch: 19, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.388 Vali Acc: 0.600 Test Loss: 1.388 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 2.125896453857422
Epoch: 20, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.352 Vali Acc: 0.619 Test Loss: 1.352 Test Acc: 0.619
Validation loss decreased (-0.599986 --> -0.618505).  Saving model ...
Epoch: 21 cost time: 2.056353807449341
Epoch: 21, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.314 Vali Acc: 0.630 Test Loss: 1.314 Test Acc: 0.630
Validation loss decreased (-0.618505 --> -0.629616).  Saving model ...
Epoch: 22 cost time: 2.298839807510376
Epoch: 22, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.276 Vali Acc: 0.644 Test Loss: 1.276 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644432).  Saving model ...
Epoch: 23 cost time: 2.353511333465576
Epoch: 23, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.236 Vali Acc: 0.659 Test Loss: 1.236 Test Acc: 0.659
Validation loss decreased (-0.644432 --> -0.659247).  Saving model ...
Epoch: 24 cost time: 2.080533266067505
Epoch: 24, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.196 Vali Acc: 0.663 Test Loss: 1.196 Test Acc: 0.663
Validation loss decreased (-0.659247 --> -0.662951).  Saving model ...
Epoch: 25 cost time: 2.547405481338501
Epoch: 25, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.157 Vali Acc: 0.674 Test Loss: 1.157 Test Acc: 0.674
Validation loss decreased (-0.662951 --> -0.674063).  Saving model ...
Epoch: 26 cost time: 2.0249454975128174
Epoch: 26, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.117 Vali Acc: 0.685 Test Loss: 1.117 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685174).  Saving model ...
Epoch: 27 cost time: 1.598024606704712
Epoch: 27, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.079 Vali Acc: 0.704 Test Loss: 1.079 Test Acc: 0.704
Validation loss decreased (-0.685174 --> -0.703693).  Saving model ...
Epoch: 28 cost time: 1.7217528820037842
Epoch: 28, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.040 Vali Acc: 0.722 Test Loss: 1.040 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722212).  Saving model ...
Epoch: 29 cost time: 1.999199390411377
Epoch: 29, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.000 Vali Acc: 0.756 Test Loss: 1.000 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755546).  Saving model ...
Epoch: 30 cost time: 1.6854920387268066
Epoch: 30, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.959 Vali Acc: 0.763 Test Loss: 0.959 Test Acc: 0.763
Validation loss decreased (-0.755546 --> -0.762953).  Saving model ...
Epoch: 31 cost time: 1.6303339004516602
Epoch: 31, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
Validation loss decreased (-0.762953 --> -0.788880).  Saving model ...
Epoch: 32 cost time: 2.3949027061462402
Epoch: 32, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.879 Vali Acc: 0.807 Test Loss: 0.879 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807399).  Saving model ...
Epoch: 33 cost time: 2.1738040447235107
Epoch: 33, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.839 Vali Acc: 0.811 Test Loss: 0.839 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811103).  Saving model ...
Epoch: 34 cost time: 2.325766086578369
Epoch: 34, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.800 Vali Acc: 0.819 Test Loss: 0.800 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 35 cost time: 2.0930330753326416
Epoch: 35, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.762 Vali Acc: 0.830 Test Loss: 0.762 Test Acc: 0.830
Validation loss decreased (-0.818511 --> -0.829622).  Saving model ...
Epoch: 36 cost time: 1.8720791339874268
Epoch: 36, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.725 Vali Acc: 0.830 Test Loss: 0.725 Test Acc: 0.830
Validation loss decreased (-0.829622 --> -0.829622).  Saving model ...
Epoch: 37 cost time: 2.1461052894592285
Epoch: 37, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
Validation loss decreased (-0.829622 --> -0.855549).  Saving model ...
Epoch: 38 cost time: 1.862736463546753
Epoch: 38, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.657 Vali Acc: 0.863 Test Loss: 0.657 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862956).  Saving model ...
Epoch: 39 cost time: 2.2790119647979736
Epoch: 39, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 40 cost time: 2.386777639389038
Epoch: 40, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.591 Vali Acc: 0.881 Test Loss: 0.591 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881476).  Saving model ...
Epoch: 41 cost time: 2.0805373191833496
Epoch: 41, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.559 Vali Acc: 0.893 Test Loss: 0.559 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892587).  Saving model ...
Epoch: 42 cost time: 2.054267644882202
Epoch: 42, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 43 cost time: 1.6837503910064697
Epoch: 43, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.499 Vali Acc: 0.904 Test Loss: 0.499 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 44 cost time: 1.8063511848449707
Epoch: 44, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.473 Vali Acc: 0.911 Test Loss: 0.473 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 45 cost time: 2.1750714778900146
Epoch: 45, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 46 cost time: 2.0877792835235596
Epoch: 46, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.423 Vali Acc: 0.907 Test Loss: 0.423 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0744218826293945
Epoch: 47, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6341993808746338
Epoch: 48, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.9103949069976807
Epoch: 49, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 50 cost time: 2.401766300201416
Epoch: 50, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.345 Vali Acc: 0.915 Test Loss: 0.345 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 51 cost time: 2.3864450454711914
Epoch: 51, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 52 cost time: 2.246249198913574
Epoch: 52, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.437986373901367
Epoch: 53, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.305 Vali Acc: 0.915 Test Loss: 0.305 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 54 cost time: 1.924206256866455
Epoch: 54, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.291 Vali Acc: 0.915 Test Loss: 0.291 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 55 cost time: 1.9676365852355957
Epoch: 55, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 56 cost time: 2.2356925010681152
Epoch: 56, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 57 cost time: 2.1778647899627686
Epoch: 57, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 58 cost time: 1.9703257083892822
Epoch: 58, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 2.5090866088867188
Epoch: 59, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 60 cost time: 2.380985975265503
Epoch: 60, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 1.755004644393921
Epoch: 61, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 1.853874921798706
Epoch: 62, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 2.210867166519165
Epoch: 63, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 2.495884418487549
Epoch: 64, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 65 cost time: 2.025904417037964
Epoch: 65, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.8247358798980713
Epoch: 66, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 2.037750005722046
Epoch: 67, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 2.1094772815704346
Epoch: 68, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.8381290435791016
Epoch: 69, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 2.2908568382263184
Epoch: 70, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.269509792327881
Epoch: 71, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.7101893424987793
Epoch: 72, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.7005925178527832
Epoch: 73, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.162165403366089
Epoch: 74, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 2.338679552078247
Epoch: 75, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 2.248981475830078
Epoch: 76, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 2.7589056491851807
Epoch: 77, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.9223487377166748
Epoch: 78, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 2.069719076156616
Epoch: 79, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.789552927017212
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.825 Vali Acc: 0.144 Test Loss: 1.825 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 2.0398449897766113
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.821 Vali Acc: 0.148 Test Loss: 1.821 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 2.3809821605682373
Epoch: 3, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.815 Vali Acc: 0.152 Test Loss: 1.815 Test Acc: 0.152
Validation loss decreased (-0.148130 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 1.9036035537719727
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.804 Vali Acc: 0.159 Test Loss: 1.804 Test Acc: 0.159
Validation loss decreased (-0.151834 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 1.6993913650512695
Epoch: 5, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.789 Vali Acc: 0.170 Test Loss: 1.789 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 6 cost time: 2.005621910095215
Epoch: 6, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.771 Vali Acc: 0.185 Test Loss: 1.771 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 2.1278204917907715
Epoch: 7, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.751 Vali Acc: 0.204 Test Loss: 1.751 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 8 cost time: 2.0089149475097656
Epoch: 8, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.728 Vali Acc: 0.230 Test Loss: 1.728 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 9 cost time: 1.5832879543304443
Epoch: 9, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.703 Vali Acc: 0.241 Test Loss: 1.703 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240724).  Saving model ...
Epoch: 10 cost time: 2.0593979358673096
Epoch: 10, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.677 Vali Acc: 0.256 Test Loss: 1.677 Test Acc: 0.256
Validation loss decreased (-0.240724 --> -0.255539).  Saving model ...
Epoch: 11 cost time: 1.8673031330108643
Epoch: 11, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.647 Vali Acc: 0.274 Test Loss: 1.647 Test Acc: 0.274
Validation loss decreased (-0.255539 --> -0.274058).  Saving model ...
Epoch: 12 cost time: 2.1889572143554688
Epoch: 12, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.617 Vali Acc: 0.311 Test Loss: 1.617 Test Acc: 0.311
Validation loss decreased (-0.274058 --> -0.311095).  Saving model ...
Epoch: 13 cost time: 2.659132480621338
Epoch: 13, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.584 Vali Acc: 0.333 Test Loss: 1.584 Test Acc: 0.333
Validation loss decreased (-0.311095 --> -0.333317).  Saving model ...
Epoch: 14 cost time: 1.9648849964141846
Epoch: 14, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.550 Vali Acc: 0.381 Test Loss: 1.550 Test Acc: 0.381
Validation loss decreased (-0.333317 --> -0.381466).  Saving model ...
Epoch: 15 cost time: 2.4706716537475586
Epoch: 15, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.513 Vali Acc: 0.433 Test Loss: 1.513 Test Acc: 0.433
Validation loss decreased (-0.381466 --> -0.433318).  Saving model ...
Epoch: 16 cost time: 2.0726497173309326
Epoch: 16, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.474 Vali Acc: 0.470 Test Loss: 1.474 Test Acc: 0.470
Validation loss decreased (-0.433318 --> -0.470356).  Saving model ...
Epoch: 17 cost time: 2.7459545135498047
Epoch: 17, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
Validation loss decreased (-0.470356 --> -0.511097).  Saving model ...
Epoch: 18 cost time: 1.7289228439331055
Epoch: 18, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.391 Vali Acc: 0.574 Test Loss: 1.391 Test Acc: 0.574
Validation loss decreased (-0.511097 --> -0.574060).  Saving model ...
Epoch: 19 cost time: 1.9899466037750244
Epoch: 19, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.348 Vali Acc: 0.633 Test Loss: 1.348 Test Acc: 0.633
Validation loss decreased (-0.574060 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 1.9347877502441406
Epoch: 20, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.305 Vali Acc: 0.678 Test Loss: 1.305 Test Acc: 0.678
Validation loss decreased (-0.633320 --> -0.677765).  Saving model ...
Epoch: 21 cost time: 1.9047107696533203
Epoch: 21, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.262 Vali Acc: 0.719 Test Loss: 1.262 Test Acc: 0.719
Validation loss decreased (-0.677765 --> -0.718506).  Saving model ...
Epoch: 22 cost time: 2.369349718093872
Epoch: 22, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.218 Vali Acc: 0.737 Test Loss: 1.218 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 23 cost time: 2.2354273796081543
Epoch: 23, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.174 Vali Acc: 0.756 Test Loss: 1.174 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 24 cost time: 1.6309623718261719
Epoch: 24, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.130 Vali Acc: 0.770 Test Loss: 1.130 Test Acc: 0.770
Validation loss decreased (-0.755544 --> -0.770359).  Saving model ...
Epoch: 25 cost time: 1.9852895736694336
Epoch: 25, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.086 Vali Acc: 0.789 Test Loss: 1.086 Test Acc: 0.789
Validation loss decreased (-0.770359 --> -0.788878).  Saving model ...
Epoch: 26 cost time: 2.001716375350952
Epoch: 26, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.043 Vali Acc: 0.822 Test Loss: 1.043 Test Acc: 0.822
Validation loss decreased (-0.788878 --> -0.822212).  Saving model ...
Epoch: 27 cost time: 1.761108160018921
Epoch: 27, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.001 Vali Acc: 0.844 Test Loss: 1.001 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844434).  Saving model ...
Epoch: 28 cost time: 1.6891028881072998
Epoch: 28, Steps: 2 | Train Loss: 1.148 Vali Loss: 0.958 Vali Acc: 0.863 Test Loss: 0.958 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 29 cost time: 2.112635374069214
Epoch: 29, Steps: 2 | Train Loss: 1.083 Vali Loss: 0.915 Vali Acc: 0.885 Test Loss: 0.915 Test Acc: 0.885
Validation loss decreased (-0.862953 --> -0.885176).  Saving model ...
Epoch: 30 cost time: 1.9546422958374023
Epoch: 30, Steps: 2 | Train Loss: 1.264 Vali Loss: 0.872 Vali Acc: 0.893 Test Loss: 0.872 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 31 cost time: 2.1680350303649902
Epoch: 31, Steps: 2 | Train Loss: 1.229 Vali Loss: 0.831 Vali Acc: 0.907 Test Loss: 0.831 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907399).  Saving model ...
Epoch: 32 cost time: 2.257092237472534
Epoch: 32, Steps: 2 | Train Loss: 1.119 Vali Loss: 0.791 Vali Acc: 0.911 Test Loss: 0.791 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 33 cost time: 2.295748233795166
Epoch: 33, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.750 Vali Acc: 0.915 Test Loss: 0.750 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 34 cost time: 1.7958879470825195
Epoch: 34, Steps: 2 | Train Loss: 1.036 Vali Loss: 0.712 Vali Acc: 0.919 Test Loss: 0.712 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 35 cost time: 2.301926374435425
Epoch: 35, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.674 Vali Acc: 0.930 Test Loss: 0.674 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929623).  Saving model ...
Epoch: 36 cost time: 2.0497119426727295
Epoch: 36, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.638 Vali Acc: 0.933 Test Loss: 0.638 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 37 cost time: 2.1887340545654297
Epoch: 37, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.604 Vali Acc: 0.941 Test Loss: 0.604 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 38 cost time: 1.614640712738037
Epoch: 38, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.571 Vali Acc: 0.944 Test Loss: 0.571 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 39 cost time: 2.071162462234497
Epoch: 39, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 40 cost time: 2.0373713970184326
Epoch: 40, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.509 Vali Acc: 0.948 Test Loss: 0.509 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 41 cost time: 1.660513162612915
Epoch: 41, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.478 Vali Acc: 0.952 Test Loss: 0.478 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 42 cost time: 2.405977487564087
Epoch: 42, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.449 Vali Acc: 0.952 Test Loss: 0.449 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 43 cost time: 2.2178850173950195
Epoch: 43, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.422 Vali Acc: 0.956 Test Loss: 0.422 Test Acc: 0.956
Validation loss decreased (-0.951847 --> -0.955551).  Saving model ...
Epoch: 44 cost time: 1.9366145133972168
Epoch: 44, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.397 Vali Acc: 0.959 Test Loss: 0.397 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 45 cost time: 2.2252726554870605
Epoch: 45, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.374 Vali Acc: 0.959 Test Loss: 0.374 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 46 cost time: 1.9619166851043701
Epoch: 46, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.351 Vali Acc: 0.959 Test Loss: 0.351 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 47 cost time: 2.0841546058654785
Epoch: 47, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.330 Vali Acc: 0.959 Test Loss: 0.330 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 48 cost time: 2.6649270057678223
Epoch: 48, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.311 Vali Acc: 0.956 Test Loss: 0.311 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.5877699851989746
Epoch: 49, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.295 Vali Acc: 0.956 Test Loss: 0.295 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.075970411300659
Epoch: 50, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.3321340084075928
Epoch: 51, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.1633946895599365
Epoch: 52, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.203287363052368
Epoch: 53, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.45206356048584
Epoch: 54, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.232712984085083
Epoch: 55, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.578655242919922
Epoch: 56, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.0278890132904053
Epoch: 57, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.753575801849365
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.168707847595215
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.164156198501587
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7278556823730469
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8297686576843262
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.8212008476257324
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.7631208896636963
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.841684103012085
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.7575969696044922
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0097062587738037
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.8218443393707275
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9178557395935059
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.6530070304870605
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.8022682666778564
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.9973957538604736
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 2.145390272140503
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 2.286008596420288
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.922048568725586
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3982748985290527
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.8401875495910645
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3064939975738525
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2060611248016357
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8357210159301758
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 2.30340313911438
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.924994707107544
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 2.2153854370117188
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1655571460723877
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0851478576660156
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 2.228093385696411
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.7664477825164795
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 2.3144266605377197
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.7038450241088867
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 2.160432815551758
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 2.565424919128418
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.9833507537841797
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 2.251793146133423
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 2.1592154502868652
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 2.0035855770111084
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 2.2001211643218994
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 2.099107503890991
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 2.250141143798828
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 2.0053887367248535
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.7999353408813477
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 2.0129241943359375
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 2.056903123855591
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.9061288833618164
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.71285080909729
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8541638851165771
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 2.2089483737945557
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.6247587203979492
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.9914476871490479
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.781548023223877
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 2.1479451656341553
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.962190866470337
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 2.2227158546447754
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.0178184509277344
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 2.033071279525757
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 2.1551434993743896
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 2.0616328716278076
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 2.2678370475769043
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 2.20808482170105
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.5129313468933105
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.932863712310791
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.6012442111968994
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.683567762374878
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.1360878944396973
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.1383888721466064
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 2.0208470821380615
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.9161295890808105
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 2.0064754486083984
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.8553743362426758
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.4822194576263428
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.159365653991699
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 2.10556960105896
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 2.6861584186553955
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.9373834133148193
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 2.2318179607391357
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.9594016075134277
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 2.428367853164673
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 2.1373069286346436
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 2.236558198928833
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 2.2115869522094727
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 2.142770290374756
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.8459947109222412
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.9193994998931885
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.8169913291931152
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.8790013790130615
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.9993128776550293
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 2.3427019119262695
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 2.08939528465271
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.8452396392822266
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 2.2435073852539062
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 2.3200085163116455
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 2.378736734390259
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 2.1014857292175293
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 2.0640151500701904
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 2.2628366947174072
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.9337608814239502
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 2.315337896347046
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 2.3202013969421387
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 258246
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.123601675033569
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.757 Vali Acc: 0.219 Test Loss: 1.757 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 1.817981481552124
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.732 Vali Acc: 0.256 Test Loss: 1.732 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 1.8966140747070312
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.709 Vali Acc: 0.259 Test Loss: 1.709 Test Acc: 0.259
Validation loss decreased (-0.255538 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 1.4838628768920898
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.682 Vali Acc: 0.289 Test Loss: 1.682 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 1.6092665195465088
Epoch: 5, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.647 Vali Acc: 0.326 Test Loss: 1.647 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 1.6832225322723389
Epoch: 6, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.606 Vali Acc: 0.396 Test Loss: 1.606 Test Acc: 0.396
Validation loss decreased (-0.325909 --> -0.396280).  Saving model ...
Epoch: 7 cost time: 1.611842155456543
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.560 Vali Acc: 0.456 Test Loss: 1.560 Test Acc: 0.456
Validation loss decreased (-0.396280 --> -0.455540).  Saving model ...
Epoch: 8 cost time: 1.8651995658874512
Epoch: 8, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.511 Vali Acc: 0.507 Test Loss: 1.511 Test Acc: 0.507
Validation loss decreased (-0.455540 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 1.9800968170166016
Epoch: 9, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.458 Vali Acc: 0.574 Test Loss: 1.458 Test Acc: 0.574
Validation loss decreased (-0.507392 --> -0.574059).  Saving model ...
Epoch: 10 cost time: 1.8877222537994385
Epoch: 10, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.404 Vali Acc: 0.611 Test Loss: 1.404 Test Acc: 0.611
Validation loss decreased (-0.574059 --> -0.611097).  Saving model ...
Epoch: 11 cost time: 2.1833856105804443
Epoch: 11, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.349 Vali Acc: 0.656 Test Loss: 1.349 Test Acc: 0.656
Validation loss decreased (-0.611097 --> -0.655542).  Saving model ...
Epoch: 12 cost time: 1.898916482925415
Epoch: 12, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.294 Vali Acc: 0.696 Test Loss: 1.294 Test Acc: 0.696
Validation loss decreased (-0.655542 --> -0.696283).  Saving model ...
Epoch: 13 cost time: 1.7868309020996094
Epoch: 13, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.239 Vali Acc: 0.722 Test Loss: 1.239 Test Acc: 0.722
Validation loss decreased (-0.696283 --> -0.722210).  Saving model ...
Epoch: 14 cost time: 2.024921417236328
Epoch: 14, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.185 Vali Acc: 0.737 Test Loss: 1.185 Test Acc: 0.737
Validation loss decreased (-0.722210 --> -0.737025).  Saving model ...
Epoch: 15 cost time: 1.7321646213531494
Epoch: 15, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.132 Vali Acc: 0.752 Test Loss: 1.132 Test Acc: 0.752
Validation loss decreased (-0.737025 --> -0.751841).  Saving model ...
Epoch: 16 cost time: 2.1035547256469727
Epoch: 16, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.082 Vali Acc: 0.767 Test Loss: 1.082 Test Acc: 0.767
Validation loss decreased (-0.751841 --> -0.766656).  Saving model ...
Epoch: 17 cost time: 2.208293914794922
Epoch: 17, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.033 Vali Acc: 0.774 Test Loss: 1.033 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 18 cost time: 1.970797061920166
Epoch: 18, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.987 Vali Acc: 0.781 Test Loss: 0.987 Test Acc: 0.781
Validation loss decreased (-0.774064 --> -0.781472).  Saving model ...
Epoch: 19 cost time: 1.8274314403533936
Epoch: 19, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.944 Vali Acc: 0.781 Test Loss: 0.944 Test Acc: 0.781
Validation loss decreased (-0.781472 --> -0.781472).  Saving model ...
Epoch: 20 cost time: 1.8867805004119873
Epoch: 20, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.903 Vali Acc: 0.785 Test Loss: 0.903 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 21 cost time: 1.8490369319915771
Epoch: 21, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.866 Vali Acc: 0.793 Test Loss: 0.866 Test Acc: 0.793
Validation loss decreased (-0.785176 --> -0.792584).  Saving model ...
Epoch: 22 cost time: 1.8019189834594727
Epoch: 22, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.830 Vali Acc: 0.796 Test Loss: 0.830 Test Acc: 0.796
Validation loss decreased (-0.792584 --> -0.796288).  Saving model ...
Epoch: 23 cost time: 1.8854365348815918
Epoch: 23, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.798 Vali Acc: 0.793 Test Loss: 0.798 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8994760513305664
Epoch: 24, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.769 Vali Acc: 0.804 Test Loss: 0.769 Test Acc: 0.804
Validation loss decreased (-0.796288 --> -0.803696).  Saving model ...
Epoch: 25 cost time: 1.9219486713409424
Epoch: 25, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.743 Vali Acc: 0.804 Test Loss: 0.743 Test Acc: 0.804
Validation loss decreased (-0.803696 --> -0.803696).  Saving model ...
Epoch: 26 cost time: 1.8233675956726074
Epoch: 26, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.721 Vali Acc: 0.807 Test Loss: 0.721 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807400).  Saving model ...
Epoch: 27 cost time: 1.7135193347930908
Epoch: 27, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.701 Vali Acc: 0.807 Test Loss: 0.701 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 28 cost time: 1.7540748119354248
Epoch: 28, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811104).  Saving model ...
Epoch: 29 cost time: 1.8466873168945312
Epoch: 29, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.667 Vali Acc: 0.815 Test Loss: 0.667 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 30 cost time: 1.7414536476135254
Epoch: 30, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.655 Vali Acc: 0.815 Test Loss: 0.655 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 31 cost time: 1.723433017730713
Epoch: 31, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3235111236572266
Epoch: 32, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7942883968353271
Epoch: 33, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.627 Vali Acc: 0.811 Test Loss: 0.627 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5349092483520508
Epoch: 34, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6775634288787842
Epoch: 35, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.76377534866333
Epoch: 36, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.606 Vali Acc: 0.811 Test Loss: 0.606 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.0607357025146484
Epoch: 37, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9639708995819092
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.597 Vali Acc: 0.807 Test Loss: 0.597 Test Acc: 0.807
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8253438472747803
Epoch: 39, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.594 Vali Acc: 0.807 Test Loss: 0.594 Test Acc: 0.807
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.992124319076538
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.745342493057251
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.769 Vali Acc: 0.259 Test Loss: 1.769 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 1.8706281185150146
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.750 Vali Acc: 0.270 Test Loss: 1.750 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 1.5204715728759766
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.733 Vali Acc: 0.281 Test Loss: 1.733 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 1.9384222030639648
Epoch: 4, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.712 Vali Acc: 0.304 Test Loss: 1.712 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303687).  Saving model ...
Epoch: 5 cost time: 1.6404190063476562
Epoch: 5, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.686 Vali Acc: 0.330 Test Loss: 1.686 Test Acc: 0.330
Validation loss decreased (-0.303687 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 1.7065796852111816
Epoch: 6, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.655 Vali Acc: 0.367 Test Loss: 1.655 Test Acc: 0.367
Validation loss decreased (-0.329613 --> -0.366650).  Saving model ...
Epoch: 7 cost time: 1.8489694595336914
Epoch: 7, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.621 Vali Acc: 0.393 Test Loss: 1.621 Test Acc: 0.393
Validation loss decreased (-0.366650 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 1.9801971912384033
Epoch: 8, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.583 Vali Acc: 0.426 Test Loss: 1.583 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425910).  Saving model ...
Epoch: 9 cost time: 1.8752965927124023
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.542 Vali Acc: 0.467 Test Loss: 1.542 Test Acc: 0.467
Validation loss decreased (-0.425910 --> -0.466651).  Saving model ...
Epoch: 10 cost time: 1.521390438079834
Epoch: 10, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.500 Vali Acc: 0.515 Test Loss: 1.500 Test Acc: 0.515
Validation loss decreased (-0.466651 --> -0.514800).  Saving model ...
Epoch: 11 cost time: 1.7129335403442383
Epoch: 11, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.458 Vali Acc: 0.552 Test Loss: 1.458 Test Acc: 0.552
Validation loss decreased (-0.514800 --> -0.551837).  Saving model ...
Epoch: 12 cost time: 1.5628612041473389
Epoch: 12, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.551837 --> -0.577764).  Saving model ...
Epoch: 13 cost time: 1.842740774154663
Epoch: 13, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.371 Vali Acc: 0.593 Test Loss: 1.371 Test Acc: 0.593
Validation loss decreased (-0.577764 --> -0.592579).  Saving model ...
Epoch: 14 cost time: 1.9815664291381836
Epoch: 14, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.328 Vali Acc: 0.615 Test Loss: 1.328 Test Acc: 0.615
Validation loss decreased (-0.592579 --> -0.614802).  Saving model ...
Epoch: 15 cost time: 1.9861955642700195
Epoch: 15, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.284 Vali Acc: 0.626 Test Loss: 1.284 Test Acc: 0.626
Validation loss decreased (-0.614802 --> -0.625913).  Saving model ...
Epoch: 16 cost time: 1.8179614543914795
Epoch: 16, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.243 Vali Acc: 0.641 Test Loss: 1.243 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640728).  Saving model ...
Epoch: 17 cost time: 2.033289670944214
Epoch: 17, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.203 Vali Acc: 0.637 Test Loss: 1.203 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1519663333892822
Epoch: 18, Steps: 2 | Train Loss: 0.772 Vali Loss: 1.165 Vali Acc: 0.644 Test Loss: 1.165 Test Acc: 0.644
Validation loss decreased (-0.640728 --> -0.644433).  Saving model ...
Epoch: 19 cost time: 1.9345192909240723
Epoch: 19, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.128 Vali Acc: 0.648 Test Loss: 1.128 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 20 cost time: 1.9115779399871826
Epoch: 20, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.092 Vali Acc: 0.652 Test Loss: 1.092 Test Acc: 0.652
Validation loss decreased (-0.648137 --> -0.651841).  Saving model ...
Epoch: 21 cost time: 2.0090346336364746
Epoch: 21, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.059 Vali Acc: 0.681 Test Loss: 1.059 Test Acc: 0.681
Validation loss decreased (-0.651841 --> -0.681471).  Saving model ...
Epoch: 22 cost time: 1.5686776638031006
Epoch: 22, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.026 Vali Acc: 0.689 Test Loss: 1.026 Test Acc: 0.689
Validation loss decreased (-0.681471 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 2.0520427227020264
Epoch: 23, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.995 Vali Acc: 0.693 Test Loss: 0.995 Test Acc: 0.693
Validation loss decreased (-0.688879 --> -0.692583).  Saving model ...
Epoch: 24 cost time: 1.8731656074523926
Epoch: 24, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.966 Vali Acc: 0.704 Test Loss: 0.966 Test Acc: 0.704
Validation loss decreased (-0.692583 --> -0.703694).  Saving model ...
Epoch: 25 cost time: 2.0171656608581543
Epoch: 25, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.938 Vali Acc: 0.719 Test Loss: 0.938 Test Acc: 0.719
Validation loss decreased (-0.703694 --> -0.718509).  Saving model ...
Epoch: 26 cost time: 1.5536189079284668
Epoch: 26, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 27 cost time: 2.7933545112609863
Epoch: 27, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 28 cost time: 1.7904636859893799
Epoch: 28, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.865 Vali Acc: 0.733 Test Loss: 0.865 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 2.014389753341675
Epoch: 29, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 30 cost time: 1.8506617546081543
Epoch: 30, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.825 Vali Acc: 0.748 Test Loss: 0.825 Test Acc: 0.748
Validation loss decreased (-0.733325 --> -0.748140).  Saving model ...
Epoch: 31 cost time: 1.7979645729064941
Epoch: 31, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.808 Vali Acc: 0.748 Test Loss: 0.808 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 32 cost time: 1.8402595520019531
Epoch: 32, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.792 Vali Acc: 0.748 Test Loss: 0.792 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 33 cost time: 1.9514906406402588
Epoch: 33, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.779 Vali Acc: 0.752 Test Loss: 0.779 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 34 cost time: 1.8204073905944824
Epoch: 34, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.767 Vali Acc: 0.756 Test Loss: 0.767 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 35 cost time: 1.7055459022521973
Epoch: 35, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 36 cost time: 2.3700525760650635
Epoch: 36, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 37 cost time: 1.9481942653656006
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.737 Vali Acc: 0.759 Test Loss: 0.737 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 38 cost time: 1.7931227684020996
Epoch: 38, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8584859371185303
Epoch: 39, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.723 Vali Acc: 0.756 Test Loss: 0.723 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8730409145355225
Epoch: 40, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.716 Vali Acc: 0.759 Test Loss: 0.716 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 41 cost time: 2.063690662384033
Epoch: 41, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.710 Vali Acc: 0.759 Test Loss: 0.710 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 42 cost time: 1.7042686939239502
Epoch: 42, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 43 cost time: 2.0071349143981934
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 44 cost time: 1.8173797130584717
Epoch: 44, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 45 cost time: 1.980147123336792
Epoch: 45, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 46 cost time: 1.8500587940216064
Epoch: 46, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 47 cost time: 1.9992091655731201
Epoch: 47, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.673 Vali Acc: 0.770 Test Loss: 0.673 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 48 cost time: 1.936628818511963
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.668 Vali Acc: 0.770 Test Loss: 0.668 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 49 cost time: 1.8631062507629395
Epoch: 49, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 50 cost time: 1.4250292778015137
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 51 cost time: 1.998577356338501
Epoch: 51, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 52 cost time: 1.9879233837127686
Epoch: 52, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.648 Vali Acc: 0.774 Test Loss: 0.648 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 53 cost time: 1.716970443725586
Epoch: 53, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.643 Vali Acc: 0.781 Test Loss: 0.643 Test Acc: 0.781
Validation loss decreased (-0.774068 --> -0.781475).  Saving model ...
Epoch: 54 cost time: 1.8705933094024658
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.639 Vali Acc: 0.785 Test Loss: 0.639 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 55 cost time: 1.8530607223510742
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 56 cost time: 1.6011168956756592
Epoch: 56, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 57 cost time: 1.5922410488128662
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 58 cost time: 1.5114414691925049
Epoch: 58, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 59 cost time: 1.8752012252807617
Epoch: 59, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 60 cost time: 1.559476613998413
Epoch: 60, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 61 cost time: 2.0098583698272705
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.612 Vali Acc: 0.793 Test Loss: 0.612 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 62 cost time: 2.056396245956421
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 63 cost time: 1.6830227375030518
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 64 cost time: 1.8826148509979248
Epoch: 64, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 65 cost time: 1.8697266578674316
Epoch: 65, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.598 Vali Acc: 0.800 Test Loss: 0.598 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 66 cost time: 1.968038558959961
Epoch: 66, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 67 cost time: 1.9236414432525635
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 68 cost time: 1.7598457336425781
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.807 Test Loss: 0.587 Test Acc: 0.807
Validation loss decreased (-0.799994 --> -0.807402).  Saving model ...
Epoch: 69 cost time: 1.9013681411743164
Epoch: 69, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 1.7936391830444336
Epoch: 70, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.811 Test Loss: 0.580 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 71 cost time: 1.652583122253418
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.577 Vali Acc: 0.811 Test Loss: 0.577 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 72 cost time: 2.1150636672973633
Epoch: 72, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.574 Vali Acc: 0.811 Test Loss: 0.574 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 73 cost time: 1.759821891784668
Epoch: 73, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.811 Test Loss: 0.571 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 74 cost time: 1.6351501941680908
Epoch: 74, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 75 cost time: 2.0361921787261963
Epoch: 75, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.815 Test Loss: 0.565 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 76 cost time: 2.182943820953369
Epoch: 76, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.815 Test Loss: 0.562 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 77 cost time: 2.2871031761169434
Epoch: 77, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 78 cost time: 2.266784429550171
Epoch: 78, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 79 cost time: 1.8872122764587402
Epoch: 79, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
Validation loss decreased (-0.822217 --> -0.825920).  Saving model ...
Epoch: 80 cost time: 1.904491662979126
Epoch: 80, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 81 cost time: 2.31227445602417
Epoch: 81, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.9368655681610107
Epoch: 82, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 2.0268120765686035
Epoch: 83, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833328).  Saving model ...
Epoch: 84 cost time: 1.9525885581970215
Epoch: 84, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 85 cost time: 1.6319098472595215
Epoch: 85, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 86 cost time: 1.6539452075958252
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 87 cost time: 1.939441442489624
Epoch: 87, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 88 cost time: 1.8431591987609863
Epoch: 88, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.837 Test Loss: 0.526 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 89 cost time: 2.083181619644165
Epoch: 89, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.6888601779937744
Epoch: 90, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.8221986293792725
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.9881377220153809
Epoch: 92, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.945338249206543
Epoch: 93, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 2.1124353408813477
Epoch: 94, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.837 Test Loss: 0.514 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 95 cost time: 1.7731938362121582
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.512 Vali Acc: 0.837 Test Loss: 0.512 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 96 cost time: 1.48893141746521
Epoch: 96, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840736).  Saving model ...
Epoch: 97 cost time: 1.8842415809631348
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844439).  Saving model ...
Epoch: 98 cost time: 1.8459734916687012
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 99 cost time: 2.0752835273742676
Epoch: 99, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 100 cost time: 2.0166852474212646
Epoch: 100, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.3533666133880615
Epoch: 1, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.773 Vali Acc: 0.237 Test Loss: 1.773 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 2.135876178741455
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.759 Vali Acc: 0.244 Test Loss: 1.759 Test Acc: 0.244
Validation loss decreased (-0.237019 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 1.5799455642700195
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.746 Vali Acc: 0.252 Test Loss: 1.746 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 1.80580472946167
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.731 Vali Acc: 0.263 Test Loss: 1.731 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262946).  Saving model ...
Epoch: 5 cost time: 1.9260437488555908
Epoch: 5, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.711 Vali Acc: 0.281 Test Loss: 1.711 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 1.4972848892211914
Epoch: 6, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.688 Vali Acc: 0.304 Test Loss: 1.688 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 1.5356724262237549
Epoch: 7, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.662 Vali Acc: 0.344 Test Loss: 1.662 Test Acc: 0.344
Validation loss decreased (-0.303687 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 1.773620367050171
Epoch: 8, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.633 Vali Acc: 0.359 Test Loss: 1.633 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 1.7253727912902832
Epoch: 9, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.603 Vali Acc: 0.415 Test Loss: 1.603 Test Acc: 0.415
Validation loss decreased (-0.359243 --> -0.414799).  Saving model ...
Epoch: 10 cost time: 1.6347055435180664
Epoch: 10, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.571 Vali Acc: 0.459 Test Loss: 1.571 Test Acc: 0.459
Validation loss decreased (-0.414799 --> -0.459244).  Saving model ...
Epoch: 11 cost time: 2.0366828441619873
Epoch: 11, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.538 Vali Acc: 0.489 Test Loss: 1.538 Test Acc: 0.489
Validation loss decreased (-0.459244 --> -0.488874).  Saving model ...
Epoch: 12 cost time: 2.151973247528076
Epoch: 12, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
Validation loss decreased (-0.488874 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 1.8837330341339111
Epoch: 13, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.470 Vali Acc: 0.519 Test Loss: 1.470 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518504).  Saving model ...
Epoch: 14 cost time: 1.5914607048034668
Epoch: 14, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.436 Vali Acc: 0.533 Test Loss: 1.436 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 1.878525972366333
Epoch: 15, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.401 Vali Acc: 0.548 Test Loss: 1.401 Test Acc: 0.548
Validation loss decreased (-0.533319 --> -0.548134).  Saving model ...
Epoch: 16 cost time: 1.7973854541778564
Epoch: 16, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.368 Vali Acc: 0.570 Test Loss: 1.368 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570357).  Saving model ...
Epoch: 17 cost time: 1.5592999458312988
Epoch: 17, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.336 Vali Acc: 0.574 Test Loss: 1.336 Test Acc: 0.574
Validation loss decreased (-0.570357 --> -0.574061).  Saving model ...
Epoch: 18 cost time: 1.8979575634002686
Epoch: 18, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.304 Vali Acc: 0.593 Test Loss: 1.304 Test Acc: 0.593
Validation loss decreased (-0.574061 --> -0.592580).  Saving model ...
Epoch: 19 cost time: 2.267040252685547
Epoch: 19, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.273 Vali Acc: 0.611 Test Loss: 1.273 Test Acc: 0.611
Validation loss decreased (-0.592580 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 1.460216999053955
Epoch: 20, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.243 Vali Acc: 0.607 Test Loss: 1.243 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9820325374603271
Epoch: 21, Steps: 2 | Train Loss: 0.717 Vali Loss: 1.213 Vali Acc: 0.619 Test Loss: 1.213 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618506).  Saving model ...
Epoch: 22 cost time: 2.3317105770111084
Epoch: 22, Steps: 2 | Train Loss: 0.697 Vali Loss: 1.185 Vali Acc: 0.626 Test Loss: 1.185 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625914).  Saving model ...
Epoch: 23 cost time: 1.5080664157867432
Epoch: 23, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.157 Vali Acc: 0.630 Test Loss: 1.157 Test Acc: 0.630
Validation loss decreased (-0.625914 --> -0.629618).  Saving model ...
Epoch: 24 cost time: 1.8588740825653076
Epoch: 24, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.131 Vali Acc: 0.644 Test Loss: 1.131 Test Acc: 0.644
Validation loss decreased (-0.629618 --> -0.644433).  Saving model ...
Epoch: 25 cost time: 1.8677668571472168
Epoch: 25, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.106 Vali Acc: 0.656 Test Loss: 1.106 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655544).  Saving model ...
Epoch: 26 cost time: 1.8819952011108398
Epoch: 26, Steps: 2 | Train Loss: 0.489 Vali Loss: 1.082 Vali Acc: 0.667 Test Loss: 1.082 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 27 cost time: 1.5965046882629395
Epoch: 27, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.059 Vali Acc: 0.670 Test Loss: 1.059 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.670360).  Saving model ...
Epoch: 28 cost time: 1.6415553092956543
Epoch: 28, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
Validation loss decreased (-0.670360 --> -0.677767).  Saving model ...
Epoch: 29 cost time: 1.6380589008331299
Epoch: 29, Steps: 2 | Train Loss: 0.352 Vali Loss: 1.015 Vali Acc: 0.685 Test Loss: 1.015 Test Acc: 0.685
Validation loss decreased (-0.677767 --> -0.685175).  Saving model ...
Epoch: 30 cost time: 1.5492815971374512
Epoch: 30, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.996 Vali Acc: 0.693 Test Loss: 0.996 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692583).  Saving model ...
Epoch: 31 cost time: 1.6087353229522705
Epoch: 31, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.977 Vali Acc: 0.696 Test Loss: 0.977 Test Acc: 0.696
Validation loss decreased (-0.692583 --> -0.696287).  Saving model ...
Epoch: 32 cost time: 1.5170722007751465
Epoch: 32, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.959 Vali Acc: 0.696 Test Loss: 0.959 Test Acc: 0.696
Validation loss decreased (-0.696287 --> -0.696287).  Saving model ...
Epoch: 33 cost time: 1.7642261981964111
Epoch: 33, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.944 Vali Acc: 0.700 Test Loss: 0.944 Test Acc: 0.700
Validation loss decreased (-0.696287 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 1.6159112453460693
Epoch: 34, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.929 Vali Acc: 0.704 Test Loss: 0.929 Test Acc: 0.704
Validation loss decreased (-0.699991 --> -0.703694).  Saving model ...
Epoch: 35 cost time: 2.036478042602539
Epoch: 35, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.915 Vali Acc: 0.707 Test Loss: 0.915 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 36 cost time: 1.7184805870056152
Epoch: 36, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.902 Vali Acc: 0.711 Test Loss: 0.902 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 37 cost time: 2.1097705364227295
Epoch: 37, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 38 cost time: 1.9015898704528809
Epoch: 38, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 2.0924646854400635
Epoch: 39, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.869 Vali Acc: 0.726 Test Loss: 0.869 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 40 cost time: 1.8926446437835693
Epoch: 40, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.859 Vali Acc: 0.730 Test Loss: 0.859 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 41 cost time: 1.9095025062561035
Epoch: 41, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.849 Vali Acc: 0.730 Test Loss: 0.849 Test Acc: 0.730
Validation loss decreased (-0.729621 --> -0.729621).  Saving model ...
Epoch: 42 cost time: 1.755751371383667
Epoch: 42, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.839 Vali Acc: 0.733 Test Loss: 0.839 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 1.7056825160980225
Epoch: 43, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.830 Vali Acc: 0.741 Test Loss: 0.830 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740732).  Saving model ...
Epoch: 44 cost time: 1.7927546501159668
Epoch: 44, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
Validation loss decreased (-0.740732 --> -0.740733).  Saving model ...
Epoch: 45 cost time: 1.8724761009216309
Epoch: 45, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.813 Vali Acc: 0.748 Test Loss: 0.813 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748140).  Saving model ...
Epoch: 46 cost time: 1.876551866531372
Epoch: 46, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.805 Vali Acc: 0.748 Test Loss: 0.805 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 47 cost time: 1.9293291568756104
Epoch: 47, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.798 Vali Acc: 0.752 Test Loss: 0.798 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 48 cost time: 1.9800739288330078
Epoch: 48, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.791 Vali Acc: 0.752 Test Loss: 0.791 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 49 cost time: 1.8059463500976562
Epoch: 49, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.784 Vali Acc: 0.752 Test Loss: 0.784 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 50 cost time: 1.8234522342681885
Epoch: 50, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 51 cost time: 2.2215189933776855
Epoch: 51, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 52 cost time: 1.6598379611968994
Epoch: 52, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 53 cost time: 1.7783305644989014
Epoch: 53, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.757 Vali Acc: 0.756 Test Loss: 0.757 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 54 cost time: 2.05659818649292
Epoch: 54, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.751 Vali Acc: 0.759 Test Loss: 0.751 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 55 cost time: 1.8060071468353271
Epoch: 55, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.746 Vali Acc: 0.759 Test Loss: 0.746 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 56 cost time: 1.869901418685913
Epoch: 56, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.741 Vali Acc: 0.759 Test Loss: 0.741 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 57 cost time: 2.161635398864746
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.736 Vali Acc: 0.759 Test Loss: 0.736 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 58 cost time: 1.7452061176300049
Epoch: 58, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.731 Vali Acc: 0.767 Test Loss: 0.731 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 59 cost time: 1.7691709995269775
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.727 Vali Acc: 0.770 Test Loss: 0.727 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 60 cost time: 1.8244874477386475
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.723 Vali Acc: 0.770 Test Loss: 0.723 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 61 cost time: 1.8728125095367432
Epoch: 61, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.718 Vali Acc: 0.770 Test Loss: 0.718 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 62 cost time: 1.8386473655700684
Epoch: 62, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 63 cost time: 1.9451773166656494
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.709 Vali Acc: 0.770 Test Loss: 0.709 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 64 cost time: 1.805274486541748
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.705 Vali Acc: 0.770 Test Loss: 0.705 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 65 cost time: 1.7134044170379639
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.701 Vali Acc: 0.770 Test Loss: 0.701 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 66 cost time: 1.798292636871338
Epoch: 66, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.696 Vali Acc: 0.774 Test Loss: 0.696 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 67 cost time: 2.0467705726623535
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.691 Vali Acc: 0.781 Test Loss: 0.691 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781475).  Saving model ...
Epoch: 68 cost time: 1.9314460754394531
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 69 cost time: 1.689713954925537
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 70 cost time: 1.6545958518981934
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 71 cost time: 2.0196168422698975
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.674 Vali Acc: 0.793 Test Loss: 0.674 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 72 cost time: 1.716503620147705
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.793 Test Loss: 0.670 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 73 cost time: 1.9325909614562988
Epoch: 73, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.667 Vali Acc: 0.793 Test Loss: 0.667 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 74 cost time: 1.938838005065918
Epoch: 74, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.663 Vali Acc: 0.793 Test Loss: 0.663 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 75 cost time: 1.7840580940246582
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.660 Vali Acc: 0.793 Test Loss: 0.660 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 76 cost time: 1.6755836009979248
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.656 Vali Acc: 0.793 Test Loss: 0.656 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 77 cost time: 1.935617446899414
Epoch: 77, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.653 Vali Acc: 0.793 Test Loss: 0.653 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 78 cost time: 1.7051734924316406
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 79 cost time: 1.9049201011657715
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 80 cost time: 1.8383564949035645
Epoch: 80, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 81 cost time: 2.7266292572021484
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.796290 --> -0.799994).  Saving model ...
Epoch: 82 cost time: 1.8575997352600098
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 83 cost time: 2.179086923599243
Epoch: 83, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 84 cost time: 1.8700947761535645
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 85 cost time: 1.8410875797271729
Epoch: 85, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 86 cost time: 1.7849009037017822
Epoch: 86, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 87 cost time: 1.6512043476104736
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 88 cost time: 1.725581169128418
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 89 cost time: 2.1563897132873535
Epoch: 89, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 90 cost time: 1.944976568222046
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 91 cost time: 1.717874526977539
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 92 cost time: 1.8381781578063965
Epoch: 92, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.807 Test Loss: 0.611 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 93 cost time: 2.1574461460113525
Epoch: 93, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.807 Test Loss: 0.609 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 94 cost time: 2.350977897644043
Epoch: 94, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.608 Vali Acc: 0.807 Test Loss: 0.608 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 95 cost time: 1.9446067810058594
Epoch: 95, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.807 Test Loss: 0.606 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 96 cost time: 2.0226759910583496
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.807 Test Loss: 0.604 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 97 cost time: 2.0642011165618896
Epoch: 97, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.807 Test Loss: 0.603 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 98 cost time: 2.0896055698394775
Epoch: 98, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 99 cost time: 1.5921499729156494
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.811 Test Loss: 0.599 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 100 cost time: 1.9913311004638672
Epoch: 100, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.460092306137085
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.766 Vali Acc: 0.252 Test Loss: 1.766 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 1.9252958297729492
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.756 Vali Acc: 0.267 Test Loss: 1.756 Test Acc: 0.267
Validation loss decreased (-0.251834 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 1.897049903869629
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.746 Vali Acc: 0.278 Test Loss: 1.746 Test Acc: 0.278
Validation loss decreased (-0.266649 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 2.1759233474731445
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.734 Vali Acc: 0.296 Test Loss: 1.734 Test Acc: 0.296
Validation loss decreased (-0.277760 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 1.8808422088623047
Epoch: 5, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.720 Vali Acc: 0.322 Test Loss: 1.720 Test Acc: 0.322
Validation loss decreased (-0.296279 --> -0.322205).  Saving model ...
Epoch: 6 cost time: 1.6725316047668457
Epoch: 6, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.703 Vali Acc: 0.337 Test Loss: 1.703 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 1.740968942642212
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.684 Vali Acc: 0.348 Test Loss: 1.684 Test Acc: 0.348
Validation loss decreased (-0.337020 --> -0.348131).  Saving model ...
Epoch: 8 cost time: 1.8582816123962402
Epoch: 8, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.663 Vali Acc: 0.374 Test Loss: 1.663 Test Acc: 0.374
Validation loss decreased (-0.348131 --> -0.374057).  Saving model ...
Epoch: 9 cost time: 2.070990562438965
Epoch: 9, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.640 Vali Acc: 0.396 Test Loss: 1.640 Test Acc: 0.396
Validation loss decreased (-0.374057 --> -0.396280).  Saving model ...
Epoch: 10 cost time: 2.0131466388702393
Epoch: 10, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.617 Vali Acc: 0.422 Test Loss: 1.617 Test Acc: 0.422
Validation loss decreased (-0.396280 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 1.8233792781829834
Epoch: 11, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.593 Vali Acc: 0.433 Test Loss: 1.593 Test Acc: 0.433
Validation loss decreased (-0.422206 --> -0.433317).  Saving model ...
Epoch: 12 cost time: 2.222479820251465
Epoch: 12, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.569 Vali Acc: 0.452 Test Loss: 1.569 Test Acc: 0.452
Validation loss decreased (-0.433317 --> -0.451836).  Saving model ...
Epoch: 13 cost time: 1.7372913360595703
Epoch: 13, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.544 Vali Acc: 0.474 Test Loss: 1.544 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474059).  Saving model ...
Epoch: 14 cost time: 1.7735872268676758
Epoch: 14, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.519 Vali Acc: 0.481 Test Loss: 1.519 Test Acc: 0.481
Validation loss decreased (-0.474059 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 1.9933910369873047
Epoch: 15, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.494 Vali Acc: 0.489 Test Loss: 1.494 Test Acc: 0.489
Validation loss decreased (-0.481466 --> -0.488874).  Saving model ...
Epoch: 16 cost time: 1.7711787223815918
Epoch: 16, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.470 Vali Acc: 0.493 Test Loss: 1.470 Test Acc: 0.493
Validation loss decreased (-0.488874 --> -0.492578).  Saving model ...
Epoch: 17 cost time: 1.6250834465026855
Epoch: 17, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
Validation loss decreased (-0.492578 --> -0.518504).  Saving model ...
Epoch: 18 cost time: 2.189469575881958
Epoch: 18, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.422 Vali Acc: 0.533 Test Loss: 1.422 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 19 cost time: 2.0332605838775635
Epoch: 19, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.398 Vali Acc: 0.537 Test Loss: 1.398 Test Acc: 0.537
Validation loss decreased (-0.533319 --> -0.537023).  Saving model ...
Epoch: 20 cost time: 1.8289031982421875
Epoch: 20, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.376 Vali Acc: 0.544 Test Loss: 1.376 Test Acc: 0.544
Validation loss decreased (-0.537023 --> -0.544431).  Saving model ...
Epoch: 21 cost time: 1.8028662204742432
Epoch: 21, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.354 Vali Acc: 0.544 Test Loss: 1.354 Test Acc: 0.544
Validation loss decreased (-0.544431 --> -0.544431).  Saving model ...
Epoch: 22 cost time: 1.8573713302612305
Epoch: 22, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.332 Vali Acc: 0.548 Test Loss: 1.332 Test Acc: 0.548
Validation loss decreased (-0.544431 --> -0.548135).  Saving model ...
Epoch: 23 cost time: 1.8850224018096924
Epoch: 23, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.311 Vali Acc: 0.556 Test Loss: 1.311 Test Acc: 0.556
Validation loss decreased (-0.548135 --> -0.555542).  Saving model ...
Epoch: 24 cost time: 1.7004590034484863
Epoch: 24, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.291 Vali Acc: 0.548 Test Loss: 1.291 Test Acc: 0.548
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3109781742095947
Epoch: 25, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.271 Vali Acc: 0.548 Test Loss: 1.271 Test Acc: 0.548
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1045138835906982
Epoch: 26, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.251 Vali Acc: 0.552 Test Loss: 1.251 Test Acc: 0.552
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.977964162826538
Epoch: 27, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.230 Vali Acc: 0.559 Test Loss: 1.230 Test Acc: 0.559
Validation loss decreased (-0.555542 --> -0.559247).  Saving model ...
Epoch: 28 cost time: 1.8483123779296875
Epoch: 28, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.210 Vali Acc: 0.567 Test Loss: 1.210 Test Acc: 0.567
Validation loss decreased (-0.559247 --> -0.566655).  Saving model ...
Epoch: 29 cost time: 1.4208695888519287
Epoch: 29, Steps: 2 | Train Loss: 0.515 Vali Loss: 1.188 Vali Acc: 0.574 Test Loss: 1.188 Test Acc: 0.574
Validation loss decreased (-0.566655 --> -0.574062).  Saving model ...
Epoch: 30 cost time: 1.9898734092712402
Epoch: 30, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.168 Vali Acc: 0.578 Test Loss: 1.168 Test Acc: 0.578
Validation loss decreased (-0.574062 --> -0.577766).  Saving model ...
Epoch: 31 cost time: 2.0273871421813965
Epoch: 31, Steps: 2 | Train Loss: 0.435 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
Validation loss decreased (-0.577766 --> -0.581470).  Saving model ...
Epoch: 32 cost time: 1.9400949478149414
Epoch: 32, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
Validation loss decreased (-0.581470 --> -0.581470).  Saving model ...
Epoch: 33 cost time: 1.6390037536621094
Epoch: 33, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.104 Vali Acc: 0.593 Test Loss: 1.104 Test Acc: 0.593
Validation loss decreased (-0.581470 --> -0.592582).  Saving model ...
Epoch: 34 cost time: 2.003641128540039
Epoch: 34, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.084 Vali Acc: 0.593 Test Loss: 1.084 Test Acc: 0.593
Validation loss decreased (-0.592582 --> -0.592582).  Saving model ...
Epoch: 35 cost time: 2.6167125701904297
Epoch: 35, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.065 Vali Acc: 0.604 Test Loss: 1.065 Test Acc: 0.604
Validation loss decreased (-0.592582 --> -0.603693).  Saving model ...
Epoch: 36 cost time: 2.247244358062744
Epoch: 36, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.044 Vali Acc: 0.607 Test Loss: 1.044 Test Acc: 0.607
Validation loss decreased (-0.603693 --> -0.607397).  Saving model ...
Epoch: 37 cost time: 1.7083020210266113
Epoch: 37, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.025 Vali Acc: 0.611 Test Loss: 1.025 Test Acc: 0.611
Validation loss decreased (-0.607397 --> -0.611101).  Saving model ...
Epoch: 38 cost time: 1.7315497398376465
Epoch: 38, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.611101 --> -0.622212).  Saving model ...
Epoch: 39 cost time: 1.8932740688323975
Epoch: 39, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.988 Vali Acc: 0.626 Test Loss: 0.988 Test Acc: 0.626
Validation loss decreased (-0.622212 --> -0.625916).  Saving model ...
Epoch: 40 cost time: 1.83359956741333
Epoch: 40, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.968 Vali Acc: 0.637 Test Loss: 0.968 Test Acc: 0.637
Validation loss decreased (-0.625916 --> -0.637027).  Saving model ...
Epoch: 41 cost time: 1.6993045806884766
Epoch: 41, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.949 Vali Acc: 0.637 Test Loss: 0.949 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637028).  Saving model ...
Epoch: 42 cost time: 1.5727581977844238
Epoch: 42, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.930 Vali Acc: 0.644 Test Loss: 0.930 Test Acc: 0.644
Validation loss decreased (-0.637028 --> -0.644435).  Saving model ...
Epoch: 43 cost time: 1.7909350395202637
Epoch: 43, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.913 Vali Acc: 0.656 Test Loss: 0.913 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655546).  Saving model ...
Epoch: 44 cost time: 1.9367585182189941
Epoch: 44, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.897 Vali Acc: 0.663 Test Loss: 0.897 Test Acc: 0.663
Validation loss decreased (-0.655546 --> -0.662954).  Saving model ...
Epoch: 45 cost time: 1.5271449089050293
Epoch: 45, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.881 Vali Acc: 0.681 Test Loss: 0.881 Test Acc: 0.681
Validation loss decreased (-0.662954 --> -0.681473).  Saving model ...
Epoch: 46 cost time: 1.592597246170044
Epoch: 46, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.866 Vali Acc: 0.689 Test Loss: 0.866 Test Acc: 0.689
Validation loss decreased (-0.681473 --> -0.688880).  Saving model ...
Epoch: 47 cost time: 1.4935052394866943
Epoch: 47, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.852 Vali Acc: 0.689 Test Loss: 0.852 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 48 cost time: 1.4812746047973633
Epoch: 48, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.838 Vali Acc: 0.693 Test Loss: 0.838 Test Acc: 0.693
Validation loss decreased (-0.688880 --> -0.692584).  Saving model ...
Epoch: 49 cost time: 1.4721729755401611
Epoch: 49, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.824 Vali Acc: 0.704 Test Loss: 0.824 Test Acc: 0.704
Validation loss decreased (-0.692584 --> -0.703695).  Saving model ...
Epoch: 50 cost time: 1.89382004737854
Epoch: 50, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.811 Vali Acc: 0.704 Test Loss: 0.811 Test Acc: 0.704
Validation loss decreased (-0.703695 --> -0.703696).  Saving model ...
Epoch: 51 cost time: 1.925485372543335
Epoch: 51, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.798 Vali Acc: 0.711 Test Loss: 0.798 Test Acc: 0.711
Validation loss decreased (-0.703696 --> -0.711103).  Saving model ...
Epoch: 52 cost time: 2.084360122680664
Epoch: 52, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.787 Vali Acc: 0.719 Test Loss: 0.787 Test Acc: 0.719
Validation loss decreased (-0.711103 --> -0.718511).  Saving model ...
Epoch: 53 cost time: 2.4575793743133545
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.776 Vali Acc: 0.719 Test Loss: 0.776 Test Acc: 0.719
Validation loss decreased (-0.718511 --> -0.718511).  Saving model ...
Epoch: 54 cost time: 1.7162129878997803
Epoch: 54, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.767 Vali Acc: 0.722 Test Loss: 0.767 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722215).  Saving model ...
Epoch: 55 cost time: 1.7981410026550293
Epoch: 55, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.758 Vali Acc: 0.722 Test Loss: 0.758 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 56 cost time: 1.8213224411010742
Epoch: 56, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.749 Vali Acc: 0.726 Test Loss: 0.749 Test Acc: 0.726
Validation loss decreased (-0.722215 --> -0.725918).  Saving model ...
Epoch: 57 cost time: 1.987563133239746
Epoch: 57, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.740 Vali Acc: 0.726 Test Loss: 0.740 Test Acc: 0.726
Validation loss decreased (-0.725918 --> -0.725919).  Saving model ...
Epoch: 58 cost time: 1.8756511211395264
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.732 Vali Acc: 0.726 Test Loss: 0.732 Test Acc: 0.726
Validation loss decreased (-0.725919 --> -0.725919).  Saving model ...
Epoch: 59 cost time: 2.1501731872558594
Epoch: 59, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.724 Vali Acc: 0.733 Test Loss: 0.724 Test Acc: 0.733
Validation loss decreased (-0.725919 --> -0.733326).  Saving model ...
Epoch: 60 cost time: 2.478811264038086
Epoch: 60, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.716 Vali Acc: 0.733 Test Loss: 0.716 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 61 cost time: 1.8659522533416748
Epoch: 61, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.709 Vali Acc: 0.733 Test Loss: 0.709 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 62 cost time: 2.1684396266937256
Epoch: 62, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.702 Vali Acc: 0.733 Test Loss: 0.702 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 63 cost time: 1.9342966079711914
Epoch: 63, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
Validation loss decreased (-0.733326 --> -0.737030).  Saving model ...
Epoch: 64 cost time: 2.0315568447113037
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.688 Vali Acc: 0.741 Test Loss: 0.688 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740734).  Saving model ...
Epoch: 65 cost time: 2.017258882522583
Epoch: 65, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.681 Vali Acc: 0.744 Test Loss: 0.681 Test Acc: 0.744
Validation loss decreased (-0.740734 --> -0.744438).  Saving model ...
Epoch: 66 cost time: 2.0480973720550537
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 67 cost time: 1.896155834197998
Epoch: 67, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.668 Vali Acc: 0.748 Test Loss: 0.668 Test Acc: 0.748
Validation loss decreased (-0.744438 --> -0.748141).  Saving model ...
Epoch: 68 cost time: 1.6451807022094727
Epoch: 68, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.663 Vali Acc: 0.748 Test Loss: 0.663 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748142).  Saving model ...
Epoch: 69 cost time: 1.932133674621582
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.657 Vali Acc: 0.752 Test Loss: 0.657 Test Acc: 0.752
Validation loss decreased (-0.748142 --> -0.751845).  Saving model ...
Epoch: 70 cost time: 1.623413324356079
Epoch: 70, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
Validation loss decreased (-0.751845 --> -0.762956).  Saving model ...
Epoch: 71 cost time: 2.0407910346984863
Epoch: 71, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 72 cost time: 1.7131407260894775
Epoch: 72, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762957).  Saving model ...
Epoch: 73 cost time: 1.8497982025146484
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.641 Vali Acc: 0.767 Test Loss: 0.641 Test Acc: 0.767
Validation loss decreased (-0.762957 --> -0.766660).  Saving model ...
Epoch: 74 cost time: 1.769423246383667
Epoch: 74, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.637 Vali Acc: 0.767 Test Loss: 0.637 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 75 cost time: 1.8969495296478271
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.767 Test Loss: 0.633 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 76 cost time: 2.3407158851623535
Epoch: 76, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 77 cost time: 1.9917621612548828
Epoch: 77, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.625 Vali Acc: 0.774 Test Loss: 0.625 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 78 cost time: 1.9286706447601318
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.621 Vali Acc: 0.774 Test Loss: 0.621 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 79 cost time: 1.683894157409668
Epoch: 79, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.774 Test Loss: 0.617 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 80 cost time: 1.8178777694702148
Epoch: 80, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.613 Vali Acc: 0.778 Test Loss: 0.613 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777772).  Saving model ...
Epoch: 81 cost time: 1.9154939651489258
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.781 Test Loss: 0.610 Test Acc: 0.781
Validation loss decreased (-0.777772 --> -0.781475).  Saving model ...
Epoch: 82 cost time: 1.9569528102874756
Epoch: 82, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.785 Test Loss: 0.606 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 83 cost time: 1.6195521354675293
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.602 Vali Acc: 0.785 Test Loss: 0.602 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 84 cost time: 1.948681116104126
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.785 Test Loss: 0.599 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 85 cost time: 1.7060315608978271
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.785 Test Loss: 0.596 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 86 cost time: 1.59499192237854
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.785 Test Loss: 0.593 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 87 cost time: 1.8357250690460205
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 88 cost time: 1.6865241527557373
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 89 cost time: 1.6893396377563477
Epoch: 89, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 90 cost time: 1.688690423965454
Epoch: 90, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 91 cost time: 1.914269208908081
Epoch: 91, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.793 Test Loss: 0.583 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 92 cost time: 1.7831344604492188
Epoch: 92, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.793 Test Loss: 0.581 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 93 cost time: 1.8600070476531982
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799994).  Saving model ...
Epoch: 94 cost time: 1.766897201538086
Epoch: 94, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.804 Test Loss: 0.577 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 95 cost time: 2.117676258087158
Epoch: 95, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.804 Test Loss: 0.576 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 96 cost time: 1.9992866516113281
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 97 cost time: 2.0339455604553223
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 98 cost time: 1.6018917560577393
Epoch: 98, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.570 Vali Acc: 0.807 Test Loss: 0.570 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 99 cost time: 2.234171152114868
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.807 Test Loss: 0.568 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 100 cost time: 1.4664161205291748
Epoch: 100, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.811 Test Loss: 0.567 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811105).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.054747581481934
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.895 Vali Acc: 0.156 Test Loss: 1.895 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.7224040031433105
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.889 Vali Acc: 0.156 Test Loss: 1.889 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 1.7590055465698242
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.882 Vali Acc: 0.167 Test Loss: 1.882 Test Acc: 0.167
Validation loss decreased (-0.155537 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 1.862334966659546
Epoch: 4, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.873 Vali Acc: 0.170 Test Loss: 1.873 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 1.7246534824371338
Epoch: 5, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.862 Vali Acc: 0.174 Test Loss: 1.862 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174055).  Saving model ...
Epoch: 6 cost time: 2.156644821166992
Epoch: 6, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.848 Vali Acc: 0.181 Test Loss: 1.848 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 7 cost time: 1.8289494514465332
Epoch: 7, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.833 Vali Acc: 0.189 Test Loss: 1.833 Test Acc: 0.189
Validation loss decreased (-0.181463 --> -0.188871).  Saving model ...
Epoch: 8 cost time: 2.43770170211792
Epoch: 8, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.816 Vali Acc: 0.196 Test Loss: 1.816 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196278).  Saving model ...
Epoch: 9 cost time: 1.858621597290039
Epoch: 9, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.797 Vali Acc: 0.215 Test Loss: 1.797 Test Acc: 0.215
Validation loss decreased (-0.196278 --> -0.214797).  Saving model ...
Epoch: 10 cost time: 1.7186458110809326
Epoch: 10, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.778 Vali Acc: 0.222 Test Loss: 1.778 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222204).  Saving model ...
Epoch: 11 cost time: 1.7445623874664307
Epoch: 11, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.756 Vali Acc: 0.233 Test Loss: 1.756 Test Acc: 0.233
Validation loss decreased (-0.222204 --> -0.233316).  Saving model ...
Epoch: 12 cost time: 1.8619740009307861
Epoch: 12, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.735 Vali Acc: 0.252 Test Loss: 1.735 Test Acc: 0.252
Validation loss decreased (-0.233316 --> -0.251835).  Saving model ...
Epoch: 13 cost time: 2.2611639499664307
Epoch: 13, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.711 Vali Acc: 0.256 Test Loss: 1.711 Test Acc: 0.256
Validation loss decreased (-0.251835 --> -0.255538).  Saving model ...
Epoch: 14 cost time: 1.7629961967468262
Epoch: 14, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.687 Vali Acc: 0.274 Test Loss: 1.687 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 15 cost time: 1.7903087139129639
Epoch: 15, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.662 Vali Acc: 0.285 Test Loss: 1.662 Test Acc: 0.285
Validation loss decreased (-0.274057 --> -0.285169).  Saving model ...
Epoch: 16 cost time: 2.074089288711548
Epoch: 16, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.636 Vali Acc: 0.315 Test Loss: 1.636 Test Acc: 0.315
Validation loss decreased (-0.285169 --> -0.314798).  Saving model ...
Epoch: 17 cost time: 2.089763641357422
Epoch: 17, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.610 Vali Acc: 0.344 Test Loss: 1.610 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344428).  Saving model ...
Epoch: 18 cost time: 2.2236826419830322
Epoch: 18, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.582 Vali Acc: 0.370 Test Loss: 1.582 Test Acc: 0.370
Validation loss decreased (-0.344428 --> -0.370355).  Saving model ...
Epoch: 19 cost time: 1.8263232707977295
Epoch: 19, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.554 Vali Acc: 0.396 Test Loss: 1.554 Test Acc: 0.396
Validation loss decreased (-0.370355 --> -0.396281).  Saving model ...
Epoch: 20 cost time: 1.5669856071472168
Epoch: 20, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.525 Vali Acc: 0.433 Test Loss: 1.525 Test Acc: 0.433
Validation loss decreased (-0.396281 --> -0.433318).  Saving model ...
Epoch: 21 cost time: 1.9916503429412842
Epoch: 21, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.496 Vali Acc: 0.481 Test Loss: 1.496 Test Acc: 0.481
Validation loss decreased (-0.433318 --> -0.481467).  Saving model ...
Epoch: 22 cost time: 1.6473579406738281
Epoch: 22, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.466 Vali Acc: 0.515 Test Loss: 1.466 Test Acc: 0.515
Validation loss decreased (-0.481467 --> -0.514800).  Saving model ...
Epoch: 23 cost time: 1.8062419891357422
Epoch: 23, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.437 Vali Acc: 0.544 Test Loss: 1.437 Test Acc: 0.544
Validation loss decreased (-0.514800 --> -0.544430).  Saving model ...
Epoch: 24 cost time: 2.50703501701355
Epoch: 24, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.406 Vali Acc: 0.552 Test Loss: 1.406 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551838).  Saving model ...
Epoch: 25 cost time: 1.901193380355835
Epoch: 25, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.375 Vali Acc: 0.574 Test Loss: 1.375 Test Acc: 0.574
Validation loss decreased (-0.551838 --> -0.574060).  Saving model ...
Epoch: 26 cost time: 1.767350435256958
Epoch: 26, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.343 Vali Acc: 0.585 Test Loss: 1.343 Test Acc: 0.585
Validation loss decreased (-0.574060 --> -0.585172).  Saving model ...
Epoch: 27 cost time: 1.776944637298584
Epoch: 27, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.311 Vali Acc: 0.607 Test Loss: 1.311 Test Acc: 0.607
Validation loss decreased (-0.585172 --> -0.607394).  Saving model ...
Epoch: 28 cost time: 2.0023529529571533
Epoch: 28, Steps: 2 | Train Loss: 0.790 Vali Loss: 1.279 Vali Acc: 0.626 Test Loss: 1.279 Test Acc: 0.626
Validation loss decreased (-0.607394 --> -0.625913).  Saving model ...
Epoch: 29 cost time: 2.1746840476989746
Epoch: 29, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.246 Vali Acc: 0.648 Test Loss: 1.246 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648136).  Saving model ...
Epoch: 30 cost time: 1.6955926418304443
Epoch: 30, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.213 Vali Acc: 0.663 Test Loss: 1.213 Test Acc: 0.663
Validation loss decreased (-0.648136 --> -0.662951).  Saving model ...
Epoch: 31 cost time: 1.935598373413086
Epoch: 31, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.178 Vali Acc: 0.670 Test Loss: 1.178 Test Acc: 0.670
Validation loss decreased (-0.662951 --> -0.670359).  Saving model ...
Epoch: 32 cost time: 1.7553999423980713
Epoch: 32, Steps: 2 | Train Loss: 0.627 Vali Loss: 1.142 Vali Acc: 0.678 Test Loss: 1.142 Test Acc: 0.678
Validation loss decreased (-0.670359 --> -0.677766).  Saving model ...
Epoch: 33 cost time: 1.7708165645599365
Epoch: 33, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 34 cost time: 1.9839813709259033
Epoch: 34, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.070 Vali Acc: 0.693 Test Loss: 1.070 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7454097270965576
Epoch: 35, Steps: 2 | Train Loss: 0.545 Vali Loss: 1.033 Vali Acc: 0.711 Test Loss: 1.033 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 36 cost time: 2.0163846015930176
Epoch: 36, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722212).  Saving model ...
Epoch: 37 cost time: 1.7110707759857178
Epoch: 37, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.955 Vali Acc: 0.737 Test Loss: 0.955 Test Acc: 0.737
Validation loss decreased (-0.722212 --> -0.737027).  Saving model ...
Epoch: 38 cost time: 1.7822303771972656
Epoch: 38, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.916 Vali Acc: 0.744 Test Loss: 0.916 Test Acc: 0.744
Validation loss decreased (-0.737027 --> -0.744435).  Saving model ...
Epoch: 39 cost time: 1.9692962169647217
Epoch: 39, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.879 Vali Acc: 0.752 Test Loss: 0.879 Test Acc: 0.752
Validation loss decreased (-0.744435 --> -0.751843).  Saving model ...
Epoch: 40 cost time: 1.7109899520874023
Epoch: 40, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.840 Vali Acc: 0.763 Test Loss: 0.840 Test Acc: 0.763
Validation loss decreased (-0.751843 --> -0.762955).  Saving model ...
Epoch: 41 cost time: 2.158128499984741
Epoch: 41, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.804 Vali Acc: 0.770 Test Loss: 0.804 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770362).  Saving model ...
Epoch: 42 cost time: 1.944373607635498
Epoch: 42, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.770 Vali Acc: 0.778 Test Loss: 0.770 Test Acc: 0.778
Validation loss decreased (-0.770362 --> -0.777770).  Saving model ...
Epoch: 43 cost time: 2.1822376251220703
Epoch: 43, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.737 Vali Acc: 0.785 Test Loss: 0.737 Test Acc: 0.785
Validation loss decreased (-0.777770 --> -0.785178).  Saving model ...
Epoch: 44 cost time: 1.8733916282653809
Epoch: 44, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.709 Vali Acc: 0.796 Test Loss: 0.709 Test Acc: 0.796
Validation loss decreased (-0.785178 --> -0.796289).  Saving model ...
Epoch: 45 cost time: 1.9533376693725586
Epoch: 45, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
Validation loss decreased (-0.796289 --> -0.796289).  Saving model ...
Epoch: 46 cost time: 1.7474143505096436
Epoch: 46, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 47 cost time: 1.845484733581543
Epoch: 47, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 48 cost time: 1.718083381652832
Epoch: 48, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 49 cost time: 1.7314186096191406
Epoch: 49, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 50 cost time: 1.8888604640960693
Epoch: 50, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8172669410705566
Epoch: 51, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 52 cost time: 1.7758922576904297
Epoch: 52, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
Validation loss decreased (-0.803698 --> -0.814809).  Saving model ...
Epoch: 53 cost time: 1.6982645988464355
Epoch: 53, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 54 cost time: 2.303607702255249
Epoch: 54, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822217).  Saving model ...
Epoch: 55 cost time: 1.9264731407165527
Epoch: 55, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.502 Vali Acc: 0.819 Test Loss: 0.502 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.0421011447906494
Epoch: 56, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.485 Vali Acc: 0.830 Test Loss: 0.485 Test Acc: 0.830
Validation loss decreased (-0.822217 --> -0.829625).  Saving model ...
Epoch: 57 cost time: 1.6255416870117188
Epoch: 57, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.468 Vali Acc: 0.830 Test Loss: 0.468 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 58 cost time: 1.8336553573608398
Epoch: 58, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 59 cost time: 1.9969842433929443
Epoch: 59, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.443 Vali Acc: 0.837 Test Loss: 0.443 Test Acc: 0.837
Validation loss decreased (-0.833329 --> -0.837033).  Saving model ...
Epoch: 60 cost time: 1.7684993743896484
Epoch: 60, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.436 Vali Acc: 0.837 Test Loss: 0.436 Test Acc: 0.837
Validation loss decreased (-0.837033 --> -0.837033).  Saving model ...
Epoch: 61 cost time: 1.6784563064575195
Epoch: 61, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.429 Vali Acc: 0.841 Test Loss: 0.429 Test Acc: 0.841
Validation loss decreased (-0.837033 --> -0.840736).  Saving model ...
Epoch: 62 cost time: 2.128519296646118
Epoch: 62, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840737).  Saving model ...
Epoch: 63 cost time: 1.8379795551300049
Epoch: 63, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
Validation loss decreased (-0.840737 --> -0.840737).  Saving model ...
Epoch: 64 cost time: 2.0200629234313965
Epoch: 64, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
Validation loss decreased (-0.840737 --> -0.848144).  Saving model ...
Epoch: 65 cost time: 2.130526304244995
Epoch: 65, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.2325937747955322
Epoch: 66, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.3741273880004883
Epoch: 67, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.7620046138763428
Epoch: 68, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.7301411628723145
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.429 Vali Acc: 0.837 Test Loss: 0.429 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.1033425331115723
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.429 Vali Acc: 0.837 Test Loss: 0.429 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.0536701679229736
Epoch: 71, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.428 Vali Acc: 0.837 Test Loss: 0.428 Test Acc: 0.837
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.6917214393615723
Epoch: 72, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.424 Vali Acc: 0.837 Test Loss: 0.424 Test Acc: 0.837
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.832967758178711
Epoch: 73, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.9026527404785156
Epoch: 74, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.848144 --> -0.848144).  Saving model ...
Epoch: 75 cost time: 1.8563940525054932
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.402 Vali Acc: 0.856 Test Loss: 0.402 Test Acc: 0.856
Validation loss decreased (-0.848144 --> -0.855552).  Saving model ...
Epoch: 76 cost time: 2.132619619369507
Epoch: 76, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.392 Vali Acc: 0.859 Test Loss: 0.392 Test Acc: 0.859
Validation loss decreased (-0.855552 --> -0.859255).  Saving model ...
Epoch: 77 cost time: 1.6703014373779297
Epoch: 77, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.383 Vali Acc: 0.859 Test Loss: 0.383 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 78 cost time: 1.647179126739502
Epoch: 78, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866663).  Saving model ...
Epoch: 79 cost time: 1.7239906787872314
Epoch: 79, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 80 cost time: 2.1797759532928467
Epoch: 80, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.365 Vali Acc: 0.874 Test Loss: 0.365 Test Acc: 0.874
Validation loss decreased (-0.866663 --> -0.874070).  Saving model ...
Epoch: 81 cost time: 1.657716989517212
Epoch: 81, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.874 Test Loss: 0.361 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 82 cost time: 2.427300453186035
Epoch: 82, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.357 Vali Acc: 0.874 Test Loss: 0.357 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 83 cost time: 1.61246657371521
Epoch: 83, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.353 Vali Acc: 0.881 Test Loss: 0.353 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881478).  Saving model ...
Epoch: 84 cost time: 1.8341100215911865
Epoch: 84, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.349 Vali Acc: 0.881 Test Loss: 0.349 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 85 cost time: 1.8972694873809814
Epoch: 85, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.885 Test Loss: 0.346 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 86 cost time: 2.3546390533447266
Epoch: 86, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.343 Vali Acc: 0.893 Test Loss: 0.343 Test Acc: 0.893
Validation loss decreased (-0.885182 --> -0.892589).  Saving model ...
Epoch: 87 cost time: 1.6612911224365234
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.896 Test Loss: 0.341 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 88 cost time: 1.4998326301574707
Epoch: 88, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.896 Test Loss: 0.339 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 89 cost time: 1.6431567668914795
Epoch: 89, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 90 cost time: 1.7266907691955566
Epoch: 90, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 91 cost time: 1.6825881004333496
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 92 cost time: 1.463690996170044
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.5885286331176758
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.9831886291503906
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.893 Test Loss: 0.338 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.9048206806182861
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.893 Test Loss: 0.337 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.568483829498291
Epoch: 96, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.336 Vali Acc: 0.896 Test Loss: 0.336 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 97 cost time: 1.5182816982269287
Epoch: 97, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.896 Test Loss: 0.334 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 98 cost time: 1.638059377670288
Epoch: 98, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.896 Test Loss: 0.331 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 99 cost time: 2.0657408237457275
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 2.274806022644043
Epoch: 100, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5501444339752197
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.904 Vali Acc: 0.119 Test Loss: 1.904 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 1.765242338180542
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.899 Vali Acc: 0.130 Test Loss: 1.899 Test Acc: 0.130
Validation loss decreased (-0.118499 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.818422555923462
Epoch: 3, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.893 Vali Acc: 0.133 Test Loss: 1.893 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133314).  Saving model ...
Epoch: 4 cost time: 1.7508487701416016
Epoch: 4, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.881 Vali Acc: 0.133 Test Loss: 1.881 Test Acc: 0.133
Validation loss decreased (-0.133314 --> -0.133315).  Saving model ...
Epoch: 5 cost time: 1.6225793361663818
Epoch: 5, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.866 Vali Acc: 0.141 Test Loss: 1.866 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 6 cost time: 1.5449903011322021
Epoch: 6, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.849 Vali Acc: 0.144 Test Loss: 1.849 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 7 cost time: 1.79677152633667
Epoch: 7, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.828 Vali Acc: 0.159 Test Loss: 1.828 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 8 cost time: 1.5698482990264893
Epoch: 8, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.805 Vali Acc: 0.178 Test Loss: 1.805 Test Acc: 0.178
Validation loss decreased (-0.159241 --> -0.177760).  Saving model ...
Epoch: 9 cost time: 1.6617982387542725
Epoch: 9, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.781 Vali Acc: 0.200 Test Loss: 1.781 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199982).  Saving model ...
Epoch: 10 cost time: 1.8200137615203857
Epoch: 10, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.754 Vali Acc: 0.233 Test Loss: 1.754 Test Acc: 0.233
Validation loss decreased (-0.199982 --> -0.233316).  Saving model ...
Epoch: 11 cost time: 1.7102203369140625
Epoch: 11, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.726 Vali Acc: 0.263 Test Loss: 1.726 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 12 cost time: 2.279970407485962
Epoch: 12, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.696 Vali Acc: 0.296 Test Loss: 1.696 Test Acc: 0.296
Validation loss decreased (-0.262946 --> -0.296279).  Saving model ...
Epoch: 13 cost time: 2.3239800930023193
Epoch: 13, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.663 Vali Acc: 0.330 Test Loss: 1.663 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 14 cost time: 2.301792621612549
Epoch: 14, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.629 Vali Acc: 0.385 Test Loss: 1.629 Test Acc: 0.385
Validation loss decreased (-0.329613 --> -0.385169).  Saving model ...
Epoch: 15 cost time: 1.7998673915863037
Epoch: 15, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.385169 --> -0.440725).  Saving model ...
Epoch: 16 cost time: 1.8545928001403809
Epoch: 16, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.555 Vali Acc: 0.489 Test Loss: 1.555 Test Acc: 0.489
Validation loss decreased (-0.440725 --> -0.488873).  Saving model ...
Epoch: 17 cost time: 2.0241527557373047
Epoch: 17, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.516 Vali Acc: 0.507 Test Loss: 1.516 Test Acc: 0.507
Validation loss decreased (-0.488873 --> -0.507392).  Saving model ...
Epoch: 18 cost time: 1.7237358093261719
Epoch: 18, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.475 Vali Acc: 0.537 Test Loss: 1.475 Test Acc: 0.537
Validation loss decreased (-0.507392 --> -0.537022).  Saving model ...
Epoch: 19 cost time: 1.9429140090942383
Epoch: 19, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.432 Vali Acc: 0.563 Test Loss: 1.432 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562949).  Saving model ...
Epoch: 20 cost time: 1.6028335094451904
Epoch: 20, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.387 Vali Acc: 0.619 Test Loss: 1.387 Test Acc: 0.619
Validation loss decreased (-0.562949 --> -0.618505).  Saving model ...
Epoch: 21 cost time: 1.4430899620056152
Epoch: 21, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.341 Vali Acc: 0.652 Test Loss: 1.341 Test Acc: 0.652
Validation loss decreased (-0.618505 --> -0.651838).  Saving model ...
Epoch: 22 cost time: 2.1289288997650146
Epoch: 22, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.295 Vali Acc: 0.678 Test Loss: 1.295 Test Acc: 0.678
Validation loss decreased (-0.651838 --> -0.677765).  Saving model ...
Epoch: 23 cost time: 2.075528144836426
Epoch: 23, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.249 Vali Acc: 0.696 Test Loss: 1.249 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696284).  Saving model ...
Epoch: 24 cost time: 1.7170133590698242
Epoch: 24, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.203 Vali Acc: 0.726 Test Loss: 1.203 Test Acc: 0.726
Validation loss decreased (-0.696284 --> -0.725914).  Saving model ...
Epoch: 25 cost time: 1.9803550243377686
Epoch: 25, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.156 Vali Acc: 0.733 Test Loss: 1.156 Test Acc: 0.733
Validation loss decreased (-0.725914 --> -0.733322).  Saving model ...
Epoch: 26 cost time: 1.8549177646636963
Epoch: 26, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.110 Vali Acc: 0.752 Test Loss: 1.110 Test Acc: 0.752
Validation loss decreased (-0.733322 --> -0.751841).  Saving model ...
Epoch: 27 cost time: 1.6925559043884277
Epoch: 27, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
Validation loss decreased (-0.751841 --> -0.755545).  Saving model ...
Epoch: 28 cost time: 1.8670570850372314
Epoch: 28, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.018 Vali Acc: 0.770 Test Loss: 1.018 Test Acc: 0.770
Validation loss decreased (-0.755545 --> -0.770360).  Saving model ...
Epoch: 29 cost time: 1.8702290058135986
Epoch: 29, Steps: 2 | Train Loss: 1.062 Vali Loss: 0.974 Vali Acc: 0.774 Test Loss: 0.974 Test Acc: 0.774
Validation loss decreased (-0.770360 --> -0.774064).  Saving model ...
Epoch: 30 cost time: 1.7672734260559082
Epoch: 30, Steps: 2 | Train Loss: 1.024 Vali Loss: 0.930 Vali Acc: 0.781 Test Loss: 0.930 Test Acc: 0.781
Validation loss decreased (-0.774064 --> -0.781472).  Saving model ...
Epoch: 31 cost time: 1.6227262020111084
Epoch: 31, Steps: 2 | Train Loss: 1.018 Vali Loss: 0.887 Vali Acc: 0.793 Test Loss: 0.887 Test Acc: 0.793
Validation loss decreased (-0.781472 --> -0.792584).  Saving model ...
Epoch: 32 cost time: 1.8298678398132324
Epoch: 32, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.847 Vali Acc: 0.811 Test Loss: 0.847 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811103).  Saving model ...
Epoch: 33 cost time: 1.6983473300933838
Epoch: 33, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.809 Vali Acc: 0.815 Test Loss: 0.809 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 34 cost time: 1.5755870342254639
Epoch: 34, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 35 cost time: 1.691051959991455
Epoch: 35, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.736 Vali Acc: 0.837 Test Loss: 0.736 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 36 cost time: 1.7059857845306396
Epoch: 36, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
Validation loss decreased (-0.837030 --> -0.844437).  Saving model ...
Epoch: 37 cost time: 1.6356492042541504
Epoch: 37, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.665 Vali Acc: 0.859 Test Loss: 0.665 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859253).  Saving model ...
Epoch: 38 cost time: 1.8028321266174316
Epoch: 38, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.631 Vali Acc: 0.859 Test Loss: 0.631 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859253).  Saving model ...
Epoch: 39 cost time: 1.5882885456085205
Epoch: 39, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 1.6773459911346436
Epoch: 40, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.568 Vali Acc: 0.870 Test Loss: 0.568 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 41 cost time: 1.5988783836364746
Epoch: 41, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.537 Vali Acc: 0.881 Test Loss: 0.537 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 42 cost time: 1.7663860321044922
Epoch: 42, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 1.8233540058135986
Epoch: 43, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 1.6807105541229248
Epoch: 44, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.454 Vali Acc: 0.911 Test Loss: 0.454 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 45 cost time: 1.76839280128479
Epoch: 45, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.430 Vali Acc: 0.915 Test Loss: 0.430 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 46 cost time: 1.4357836246490479
Epoch: 46, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.409 Vali Acc: 0.915 Test Loss: 0.409 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 47 cost time: 1.922179937362671
Epoch: 47, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.392 Vali Acc: 0.911 Test Loss: 0.392 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8414418697357178
Epoch: 48, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7100498676300049
Epoch: 49, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.1295382976531982
Epoch: 50, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.347 Vali Acc: 0.907 Test Loss: 0.347 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.7921273708343506
Epoch: 51, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.904 Test Loss: 0.333 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.7370927333831787
Epoch: 52, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.1680715084075928
Epoch: 53, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.020723342895508
Epoch: 54, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 55 cost time: 1.6919312477111816
Epoch: 55, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 56 cost time: 1.8373355865478516
Epoch: 56, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 57 cost time: 1.5325193405151367
Epoch: 57, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 58 cost time: 1.710139274597168
Epoch: 58, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 59 cost time: 1.6178662776947021
Epoch: 59, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 60 cost time: 1.8985977172851562
Epoch: 60, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 61 cost time: 1.878626823425293
Epoch: 61, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 62 cost time: 1.7961549758911133
Epoch: 62, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 63 cost time: 1.769301414489746
Epoch: 63, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 64 cost time: 1.5811223983764648
Epoch: 64, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.8543634414672852
Epoch: 65, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.811518907546997
Epoch: 66, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.2693545818328857
Epoch: 67, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.397573471069336
Epoch: 68, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.8518788814544678
Epoch: 69, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.181535243988037
Epoch: 70, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.2133822441101074
Epoch: 71, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.9285194873809814
Epoch: 72, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.724811315536499
Epoch: 73, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 74 cost time: 1.9827144145965576
Epoch: 74, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 75 cost time: 1.5321414470672607
Epoch: 75, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 76 cost time: 1.8498365879058838
Epoch: 76, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 77 cost time: 2.072075128555298
Epoch: 77, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 78 cost time: 1.453657627105713
Epoch: 78, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 1.8973915576934814
Epoch: 79, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 1.8633012771606445
Epoch: 80, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 1.8130407333374023
Epoch: 81, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.935842514038086
Epoch: 82, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.9599452018737793
Epoch: 83, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.7502474784851074
Epoch: 84, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 85 cost time: 1.7586331367492676
Epoch: 85, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.01503324508667
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.6461832523345947
Epoch: 87, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.9984691143035889
Epoch: 88, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 2.3996641635894775
Epoch: 89, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.841604232788086
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.910447359085083
Epoch: 91, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.5832171440124512
Epoch: 92, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 2.097062110900879
Epoch: 93, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 1.6208972930908203
Epoch: 94, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 5.05840277671814
Epoch: 1, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.884 Vali Acc: 0.137 Test Loss: 1.884 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 1.8588297367095947
Epoch: 2, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.881 Vali Acc: 0.137 Test Loss: 1.881 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 2.042846202850342
Epoch: 3, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.875 Vali Acc: 0.144 Test Loss: 1.875 Test Acc: 0.144
Validation loss decreased (-0.137018 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.7445597648620605
Epoch: 4, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.863 Vali Acc: 0.156 Test Loss: 1.863 Test Acc: 0.156
Validation loss decreased (-0.144426 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 1.7714629173278809
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.848 Vali Acc: 0.156 Test Loss: 1.848 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 6 cost time: 1.8789887428283691
Epoch: 6, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.830 Vali Acc: 0.181 Test Loss: 1.830 Test Acc: 0.181
Validation loss decreased (-0.155537 --> -0.181463).  Saving model ...
Epoch: 7 cost time: 1.6462504863739014
Epoch: 7, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.809 Vali Acc: 0.215 Test Loss: 1.809 Test Acc: 0.215
Validation loss decreased (-0.181463 --> -0.214797).  Saving model ...
Epoch: 8 cost time: 1.5860137939453125
Epoch: 8, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.786 Vali Acc: 0.222 Test Loss: 1.786 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222204).  Saving model ...
Epoch: 9 cost time: 1.498589038848877
Epoch: 9, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.759 Vali Acc: 0.241 Test Loss: 1.759 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 10 cost time: 1.5603468418121338
Epoch: 10, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259242).  Saving model ...
Epoch: 11 cost time: 1.7113025188446045
Epoch: 11, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.700 Vali Acc: 0.267 Test Loss: 1.700 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266650).  Saving model ...
Epoch: 12 cost time: 1.6291768550872803
Epoch: 12, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.667 Vali Acc: 0.285 Test Loss: 1.667 Test Acc: 0.285
Validation loss decreased (-0.266650 --> -0.285169).  Saving model ...
Epoch: 13 cost time: 1.8619122505187988
Epoch: 13, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.631 Vali Acc: 0.322 Test Loss: 1.631 Test Acc: 0.322
Validation loss decreased (-0.285169 --> -0.322206).  Saving model ...
Epoch: 14 cost time: 1.9695143699645996
Epoch: 14, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.593 Vali Acc: 0.374 Test Loss: 1.593 Test Acc: 0.374
Validation loss decreased (-0.322206 --> -0.374058).  Saving model ...
Epoch: 15 cost time: 1.6262495517730713
Epoch: 15, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.554 Vali Acc: 0.419 Test Loss: 1.554 Test Acc: 0.419
Validation loss decreased (-0.374058 --> -0.418503).  Saving model ...
Epoch: 16 cost time: 2.0655713081359863
Epoch: 16, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.513 Vali Acc: 0.456 Test Loss: 1.513 Test Acc: 0.456
Validation loss decreased (-0.418503 --> -0.455540).  Saving model ...
Epoch: 17 cost time: 1.683302640914917
Epoch: 17, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.471 Vali Acc: 0.507 Test Loss: 1.471 Test Acc: 0.507
Validation loss decreased (-0.455540 --> -0.507393).  Saving model ...
Epoch: 18 cost time: 1.7110590934753418
Epoch: 18, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.427 Vali Acc: 0.556 Test Loss: 1.427 Test Acc: 0.556
Validation loss decreased (-0.507393 --> -0.555541).  Saving model ...
Epoch: 19 cost time: 1.6912715435028076
Epoch: 19, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.383 Vali Acc: 0.581 Test Loss: 1.383 Test Acc: 0.581
Validation loss decreased (-0.555541 --> -0.581468).  Saving model ...
Epoch: 20 cost time: 1.9231314659118652
Epoch: 20, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.338 Vali Acc: 0.630 Test Loss: 1.338 Test Acc: 0.630
Validation loss decreased (-0.581468 --> -0.629616).  Saving model ...
Epoch: 21 cost time: 1.8982353210449219
Epoch: 21, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.292 Vali Acc: 0.674 Test Loss: 1.292 Test Acc: 0.674
Validation loss decreased (-0.629616 --> -0.674061).  Saving model ...
Epoch: 22 cost time: 1.7411160469055176
Epoch: 22, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.247 Vali Acc: 0.681 Test Loss: 1.247 Test Acc: 0.681
Validation loss decreased (-0.674061 --> -0.681469).  Saving model ...
Epoch: 23 cost time: 1.702359914779663
Epoch: 23, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.202 Vali Acc: 0.711 Test Loss: 1.202 Test Acc: 0.711
Validation loss decreased (-0.681469 --> -0.711099).  Saving model ...
Epoch: 24 cost time: 1.8566160202026367
Epoch: 24, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.159 Vali Acc: 0.726 Test Loss: 1.159 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 25 cost time: 1.948009729385376
Epoch: 25, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.115 Vali Acc: 0.748 Test Loss: 1.115 Test Acc: 0.748
Validation loss decreased (-0.725914 --> -0.748137).  Saving model ...
Epoch: 26 cost time: 1.6756970882415771
Epoch: 26, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.072 Vali Acc: 0.763 Test Loss: 1.072 Test Acc: 0.763
Validation loss decreased (-0.748137 --> -0.762952).  Saving model ...
Epoch: 27 cost time: 1.6026124954223633
Epoch: 27, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.029 Vali Acc: 0.793 Test Loss: 1.029 Test Acc: 0.793
Validation loss decreased (-0.762952 --> -0.792582).  Saving model ...
Epoch: 28 cost time: 1.5174529552459717
Epoch: 28, Steps: 2 | Train Loss: 1.125 Vali Loss: 0.988 Vali Acc: 0.796 Test Loss: 0.988 Test Acc: 0.796
Validation loss decreased (-0.792582 --> -0.796286).  Saving model ...
Epoch: 29 cost time: 1.5822608470916748
Epoch: 29, Steps: 2 | Train Loss: 1.165 Vali Loss: 0.947 Vali Acc: 0.815 Test Loss: 0.947 Test Acc: 0.815
Validation loss decreased (-0.796286 --> -0.814805).  Saving model ...
Epoch: 30 cost time: 1.943129062652588
Epoch: 30, Steps: 2 | Train Loss: 1.184 Vali Loss: 0.907 Vali Acc: 0.819 Test Loss: 0.907 Test Acc: 0.819
Validation loss decreased (-0.814805 --> -0.818509).  Saving model ...
Epoch: 31 cost time: 2.1464149951934814
Epoch: 31, Steps: 2 | Train Loss: 1.091 Vali Loss: 0.868 Vali Acc: 0.837 Test Loss: 0.868 Test Acc: 0.837
Validation loss decreased (-0.818509 --> -0.837028).  Saving model ...
Epoch: 32 cost time: 2.1022732257843018
Epoch: 32, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.830 Vali Acc: 0.848 Test Loss: 0.830 Test Acc: 0.848
Validation loss decreased (-0.837028 --> -0.848140).  Saving model ...
Epoch: 33 cost time: 2.2879230976104736
Epoch: 33, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.794 Vali Acc: 0.859 Test Loss: 0.794 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859251).  Saving model ...
Epoch: 34 cost time: 2.2908637523651123
Epoch: 34, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.759 Vali Acc: 0.867 Test Loss: 0.759 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 35 cost time: 1.7496063709259033
Epoch: 35, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.726 Vali Acc: 0.870 Test Loss: 0.726 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 36 cost time: 2.20316743850708
Epoch: 36, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.694 Vali Acc: 0.881 Test Loss: 0.694 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881475).  Saving model ...
Epoch: 37 cost time: 1.8521742820739746
Epoch: 37, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.664 Vali Acc: 0.885 Test Loss: 0.664 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 38 cost time: 2.248905897140503
Epoch: 38, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0263328552246094
Epoch: 39, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.607 Vali Acc: 0.885 Test Loss: 0.607 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 40 cost time: 1.804046392440796
Epoch: 40, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.579 Vali Acc: 0.893 Test Loss: 0.579 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 41 cost time: 1.6034362316131592
Epoch: 41, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.553 Vali Acc: 0.896 Test Loss: 0.553 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 42 cost time: 1.5323946475982666
Epoch: 42, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.529 Vali Acc: 0.893 Test Loss: 0.529 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7105891704559326
Epoch: 43, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.505 Vali Acc: 0.893 Test Loss: 0.505 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8457107543945312
Epoch: 44, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 1.68861722946167
Epoch: 45, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 1.5339915752410889
Epoch: 46, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 1.8623368740081787
Epoch: 47, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.419 Vali Acc: 0.904 Test Loss: 0.419 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 48 cost time: 1.6404120922088623
Epoch: 48, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.402 Vali Acc: 0.907 Test Loss: 0.402 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907403).  Saving model ...
Epoch: 49 cost time: 1.991283893585205
Epoch: 49, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.382 Vali Acc: 0.904 Test Loss: 0.382 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.9636967182159424
Epoch: 50, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 51 cost time: 2.083557605743408
Epoch: 51, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.337 Vali Acc: 0.915 Test Loss: 0.337 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7106554508209229
Epoch: 52, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 53 cost time: 1.8135812282562256
Epoch: 53, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 54 cost time: 1.6900701522827148
Epoch: 54, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 1.6195306777954102
Epoch: 55, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 56 cost time: 1.7605605125427246
Epoch: 56, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 1.7580063343048096
Epoch: 57, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 58 cost time: 2.0258898735046387
Epoch: 58, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 59 cost time: 1.7078649997711182
Epoch: 59, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 60 cost time: 1.8070008754730225
Epoch: 60, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 1.6604554653167725
Epoch: 61, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 62 cost time: 1.9774985313415527
Epoch: 62, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 63 cost time: 1.8774135112762451
Epoch: 63, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 64 cost time: 1.4317951202392578
Epoch: 64, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 65 cost time: 1.545670509338379
Epoch: 65, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 66 cost time: 1.8920300006866455
Epoch: 66, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 67 cost time: 1.8425371646881104
Epoch: 67, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 68 cost time: 1.7314424514770508
Epoch: 68, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 1.8345427513122559
Epoch: 69, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 70 cost time: 2.1493871212005615
Epoch: 70, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 2.0262014865875244
Epoch: 71, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 72 cost time: 1.5005643367767334
Epoch: 72, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 73 cost time: 1.5385279655456543
Epoch: 73, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 2.054466962814331
Epoch: 74, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.8632991313934326
Epoch: 75, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.295257568359375
Epoch: 76, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.2779603004455566
Epoch: 77, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 78 cost time: 1.7168042659759521
Epoch: 78, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 2.023310899734497
Epoch: 79, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 80 cost time: 1.3598062992095947
Epoch: 80, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 81 cost time: 1.5254051685333252
Epoch: 81, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 82 cost time: 1.7830657958984375
Epoch: 82, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 83 cost time: 1.6287579536437988
Epoch: 83, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 84 cost time: 1.6357088088989258
Epoch: 84, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.865403175354004
Epoch: 85, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.933959722518921
Epoch: 86, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.7475943565368652
Epoch: 87, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.7657063007354736
Epoch: 88, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 2.002912998199463
Epoch: 89, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.734833002090454
Epoch: 90, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.8504250049591064
Epoch: 91, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.679929494857788
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 1.8474762439727783
Epoch: 93, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.248700141906738
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.630704641342163
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.6716759204864502
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.4313318729400635
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4444634914398193
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8872337341308594
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 2.010636329650879
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8648533821105957
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5771896839141846
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.829878330230713
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7492194175720215
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.8197100162506104
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.535229206085205
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.6708836555480957
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.863403081893921
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5900931358337402
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7912087440490723
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.6248126029968262
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8465206623077393
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.820399284362793
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6736016273498535
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6567115783691406
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.6968591213226318
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.7302026748657227
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.8775339126586914
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.8842501640319824
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 2.03254771232605
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9845013618469238
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 2.0270142555236816
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.6873273849487305
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.5064804553985596
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.6642115116119385
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 2.0307106971740723
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.6292223930358887
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1692585945129395
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.0080034732818604
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.6406340599060059
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.7334315776824951
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.7382125854492188
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.7955214977264404
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.9514400959014893
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.6755175590515137
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 2.3808882236480713
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 2.02101469039917
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.7217402458190918
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.661527156829834
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.7846291065216064
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.9801974296569824
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.6071114540100098
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 2.0281059741973877
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.665827751159668
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.7628824710845947
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.7865321636199951
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.9544034004211426
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.9640920162200928
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6645936965942383
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.59991455078125
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.8297343254089355
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.8389883041381836
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.989220142364502
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.8337349891662598
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.7681996822357178
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.5714142322540283
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.8672151565551758
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.7644824981689453
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.5080842971801758
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.9020791053771973
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.8856556415557861
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.9822978973388672
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.8415658473968506
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.3393747806549072
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.9634191989898682
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.7246668338775635
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 209094
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.567439556121826
Epoch: 1, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.904 Vali Acc: 0.156 Test Loss: 1.904 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.390559434890747
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.886 Vali Acc: 0.156 Test Loss: 1.886 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 1.4275736808776855
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.865 Vali Acc: 0.163 Test Loss: 1.865 Test Acc: 0.163
Validation loss decreased (-0.155537 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 1.5974853038787842
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.837 Vali Acc: 0.174 Test Loss: 1.837 Test Acc: 0.174
Validation loss decreased (-0.162944 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 1.424894094467163
Epoch: 5, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.800 Vali Acc: 0.200 Test Loss: 1.800 Test Acc: 0.200
Validation loss decreased (-0.174056 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 1.6312553882598877
Epoch: 6, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.757 Vali Acc: 0.237 Test Loss: 1.757 Test Acc: 0.237
Validation loss decreased (-0.199982 --> -0.237019).  Saving model ...
Epoch: 7 cost time: 1.5414905548095703
Epoch: 7, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.709 Vali Acc: 0.300 Test Loss: 1.709 Test Acc: 0.300
Validation loss decreased (-0.237019 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 1.8117661476135254
Epoch: 8, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.659 Vali Acc: 0.333 Test Loss: 1.659 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 1.7686383724212646
Epoch: 9, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.607 Vali Acc: 0.404 Test Loss: 1.607 Test Acc: 0.404
Validation loss decreased (-0.333317 --> -0.403688).  Saving model ...
Epoch: 10 cost time: 1.8039324283599854
Epoch: 10, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.553 Vali Acc: 0.444 Test Loss: 1.553 Test Acc: 0.444
Validation loss decreased (-0.403688 --> -0.444429).  Saving model ...
Epoch: 11 cost time: 1.7964842319488525
Epoch: 11, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.500 Vali Acc: 0.504 Test Loss: 1.500 Test Acc: 0.504
Validation loss decreased (-0.444429 --> -0.503689).  Saving model ...
Epoch: 12 cost time: 1.8023433685302734
Epoch: 12, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.446 Vali Acc: 0.559 Test Loss: 1.446 Test Acc: 0.559
Validation loss decreased (-0.503689 --> -0.559245).  Saving model ...
Epoch: 13 cost time: 1.7014527320861816
Epoch: 13, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.392 Vali Acc: 0.596 Test Loss: 1.392 Test Acc: 0.596
Validation loss decreased (-0.559245 --> -0.596282).  Saving model ...
Epoch: 14 cost time: 1.70597243309021
Epoch: 14, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.340 Vali Acc: 0.630 Test Loss: 1.340 Test Acc: 0.630
Validation loss decreased (-0.596282 --> -0.629616).  Saving model ...
Epoch: 15 cost time: 1.6563618183135986
Epoch: 15, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.290 Vali Acc: 0.678 Test Loss: 1.290 Test Acc: 0.678
Validation loss decreased (-0.629616 --> -0.677765).  Saving model ...
Epoch: 16 cost time: 1.935736894607544
Epoch: 16, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.241 Vali Acc: 0.700 Test Loss: 1.241 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 17 cost time: 1.5537171363830566
Epoch: 17, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.195 Vali Acc: 0.711 Test Loss: 1.195 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 18 cost time: 1.6574442386627197
Epoch: 18, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 19 cost time: 1.4920501708984375
Epoch: 19, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.106 Vali Acc: 0.756 Test Loss: 1.106 Test Acc: 0.756
Validation loss decreased (-0.733322 --> -0.755544).  Saving model ...
Epoch: 20 cost time: 1.4979281425476074
Epoch: 20, Steps: 2 | Train Loss: 0.775 Vali Loss: 1.065 Vali Acc: 0.763 Test Loss: 1.065 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 21 cost time: 1.57759690284729
Epoch: 21, Steps: 2 | Train Loss: 0.697 Vali Loss: 1.025 Vali Acc: 0.774 Test Loss: 1.025 Test Acc: 0.774
Validation loss decreased (-0.762952 --> -0.774064).  Saving model ...
Epoch: 22 cost time: 1.2464134693145752
Epoch: 22, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.988 Vali Acc: 0.785 Test Loss: 0.988 Test Acc: 0.785
Validation loss decreased (-0.774064 --> -0.785175).  Saving model ...
Epoch: 23 cost time: 1.7137012481689453
Epoch: 23, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.955 Vali Acc: 0.785 Test Loss: 0.955 Test Acc: 0.785
Validation loss decreased (-0.785175 --> -0.785176).  Saving model ...
Epoch: 24 cost time: 1.875462293624878
Epoch: 24, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.921 Vali Acc: 0.796 Test Loss: 0.921 Test Acc: 0.796
Validation loss decreased (-0.785176 --> -0.796287).  Saving model ...
Epoch: 25 cost time: 1.4474925994873047
Epoch: 25, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
Validation loss decreased (-0.796287 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 1.5342988967895508
Epoch: 26, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.862 Vali Acc: 0.800 Test Loss: 0.862 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 1.4525394439697266
Epoch: 27, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.835 Vali Acc: 0.807 Test Loss: 0.835 Test Acc: 0.807
Validation loss decreased (-0.799991 --> -0.807399).  Saving model ...
Epoch: 28 cost time: 1.6006200313568115
Epoch: 28, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.810 Vali Acc: 0.804 Test Loss: 0.810 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9228572845458984
Epoch: 29, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.787 Vali Acc: 0.807 Test Loss: 0.787 Test Acc: 0.807
Validation loss decreased (-0.807399 --> -0.807400).  Saving model ...
Epoch: 30 cost time: 1.5533123016357422
Epoch: 30, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811103).  Saving model ...
Epoch: 31 cost time: 1.7437667846679688
Epoch: 31, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.746 Vali Acc: 0.807 Test Loss: 0.746 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3492200374603271
Epoch: 32, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.728 Vali Acc: 0.807 Test Loss: 0.728 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4945647716522217
Epoch: 33, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 34 cost time: 1.6337909698486328
Epoch: 34, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.696 Vali Acc: 0.815 Test Loss: 0.696 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 35 cost time: 1.626896619796753
Epoch: 35, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.681 Vali Acc: 0.819 Test Loss: 0.681 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 36 cost time: 1.4190852642059326
Epoch: 36, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.668 Vali Acc: 0.822 Test Loss: 0.668 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 37 cost time: 1.6973605155944824
Epoch: 37, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.656 Vali Acc: 0.826 Test Loss: 0.656 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825919).  Saving model ...
Epoch: 38 cost time: 1.8417012691497803
Epoch: 38, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.647 Vali Acc: 0.830 Test Loss: 0.647 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 39 cost time: 1.5961041450500488
Epoch: 39, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.8257405757904053
Epoch: 40, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 1.9624264240264893
Epoch: 41, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 1.5433318614959717
Epoch: 42, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.616 Vali Acc: 0.837 Test Loss: 0.616 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 43 cost time: 1.7787833213806152
Epoch: 43, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.609 Vali Acc: 0.837 Test Loss: 0.609 Test Acc: 0.837
Validation loss decreased (-0.837031 --> -0.837031).  Saving model ...
Epoch: 44 cost time: 1.553459882736206
Epoch: 44, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
Validation loss decreased (-0.837031 --> -0.840735).  Saving model ...
Epoch: 45 cost time: 1.6961069107055664
Epoch: 45, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.840735 --> -0.840735).  Saving model ...
Epoch: 46 cost time: 1.7862443923950195
Epoch: 46, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 47 cost time: 1.5352370738983154
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 48 cost time: 1.4448506832122803
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 49 cost time: 1.591278076171875
Epoch: 49, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 50 cost time: 1.512573003768921
Epoch: 50, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 51 cost time: 1.6725332736968994
Epoch: 51, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848142).  Saving model ...
Epoch: 52 cost time: 1.4163918495178223
Epoch: 52, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 53 cost time: 1.7272589206695557
Epoch: 53, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848142).  Saving model ...
Epoch: 54 cost time: 2.018920421600342
Epoch: 54, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8462786674499512
Epoch: 55, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7219085693359375
Epoch: 56, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.8436946868896484
Epoch: 57, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
Validation loss decreased (-0.848142 --> -0.848143).  Saving model ...
Epoch: 58 cost time: 1.9637651443481445
Epoch: 58, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 59 cost time: 1.6890885829925537
Epoch: 59, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 60 cost time: 1.41400146484375
Epoch: 60, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 61 cost time: 1.6877069473266602
Epoch: 61, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 62 cost time: 1.4832453727722168
Epoch: 62, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.6659212112426758
Epoch: 63, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.5397202968597412
Epoch: 64, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.5975735187530518
Epoch: 65, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.7217040061950684
Epoch: 66, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.7399694919586182
Epoch: 67, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.573634147644043
Epoch: 68, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.5428190231323242
Epoch: 69, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.7338600158691406
Epoch: 70, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.738715648651123
Epoch: 71, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.362874746322632
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.903 Vali Acc: 0.185 Test Loss: 1.903 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 1.6831915378570557
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.888 Vali Acc: 0.181 Test Loss: 1.888 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8628735542297363
Epoch: 3, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.873 Vali Acc: 0.181 Test Loss: 1.873 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7377920150756836
Epoch: 4, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.852 Vali Acc: 0.189 Test Loss: 1.852 Test Acc: 0.189
Validation loss decreased (-0.185166 --> -0.188870).  Saving model ...
Epoch: 5 cost time: 1.8049497604370117
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.824 Vali Acc: 0.204 Test Loss: 1.824 Test Acc: 0.204
Validation loss decreased (-0.188870 --> -0.203685).  Saving model ...
Epoch: 6 cost time: 1.612961769104004
Epoch: 6, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.793 Vali Acc: 0.226 Test Loss: 1.793 Test Acc: 0.226
Validation loss decreased (-0.203685 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 1.7635693550109863
Epoch: 7, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.757 Vali Acc: 0.270 Test Loss: 1.757 Test Acc: 0.270
Validation loss decreased (-0.225908 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 1.5716605186462402
Epoch: 8, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.720 Vali Acc: 0.315 Test Loss: 1.720 Test Acc: 0.315
Validation loss decreased (-0.270353 --> -0.314798).  Saving model ...
Epoch: 9 cost time: 1.863973617553711
Epoch: 9, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.681 Vali Acc: 0.348 Test Loss: 1.681 Test Acc: 0.348
Validation loss decreased (-0.314798 --> -0.348131).  Saving model ...
Epoch: 10 cost time: 2.0449390411376953
Epoch: 10, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.641 Vali Acc: 0.381 Test Loss: 1.641 Test Acc: 0.381
Validation loss decreased (-0.348131 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 2.0144739151000977
Epoch: 11, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.599 Vali Acc: 0.426 Test Loss: 1.599 Test Acc: 0.426
Validation loss decreased (-0.381465 --> -0.425910).  Saving model ...
Epoch: 12 cost time: 1.769016981124878
Epoch: 12, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.558 Vali Acc: 0.456 Test Loss: 1.558 Test Acc: 0.456
Validation loss decreased (-0.425910 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 2.268972396850586
Epoch: 13, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.516 Vali Acc: 0.504 Test Loss: 1.516 Test Acc: 0.504
Validation loss decreased (-0.455540 --> -0.503689).  Saving model ...
Epoch: 14 cost time: 1.4906280040740967
Epoch: 14, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.475 Vali Acc: 0.537 Test Loss: 1.475 Test Acc: 0.537
Validation loss decreased (-0.503689 --> -0.537022).  Saving model ...
Epoch: 15 cost time: 1.5589351654052734
Epoch: 15, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.435 Vali Acc: 0.556 Test Loss: 1.435 Test Acc: 0.556
Validation loss decreased (-0.537022 --> -0.555541).  Saving model ...
Epoch: 16 cost time: 1.687622308731079
Epoch: 16, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.395 Vali Acc: 0.570 Test Loss: 1.395 Test Acc: 0.570
Validation loss decreased (-0.555541 --> -0.570356).  Saving model ...
Epoch: 17 cost time: 1.5035109519958496
Epoch: 17, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.357 Vali Acc: 0.574 Test Loss: 1.357 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574061).  Saving model ...
Epoch: 18 cost time: 1.9104981422424316
Epoch: 18, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
Validation loss decreased (-0.574061 --> -0.588876).  Saving model ...
Epoch: 19 cost time: 1.5456047058105469
Epoch: 19, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.283 Vali Acc: 0.611 Test Loss: 1.283 Test Acc: 0.611
Validation loss decreased (-0.588876 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 1.3542635440826416
Epoch: 20, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.248 Vali Acc: 0.622 Test Loss: 1.248 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 21 cost time: 1.5176177024841309
Epoch: 21, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 1.5401091575622559
Epoch: 22, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.182 Vali Acc: 0.648 Test Loss: 1.182 Test Acc: 0.648
Validation loss decreased (-0.633321 --> -0.648136).  Saving model ...
Epoch: 23 cost time: 1.491382122039795
Epoch: 23, Steps: 2 | Train Loss: 0.695 Vali Loss: 1.151 Vali Acc: 0.659 Test Loss: 1.151 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659248).  Saving model ...
Epoch: 24 cost time: 1.7572290897369385
Epoch: 24, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.120 Vali Acc: 0.663 Test Loss: 1.120 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 25 cost time: 1.5871150493621826
Epoch: 25, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.091 Vali Acc: 0.670 Test Loss: 1.091 Test Acc: 0.670
Validation loss decreased (-0.662952 --> -0.670359).  Saving model ...
Epoch: 26 cost time: 1.8822641372680664
Epoch: 26, Steps: 2 | Train Loss: 0.565 Vali Loss: 1.064 Vali Acc: 0.681 Test Loss: 1.064 Test Acc: 0.681
Validation loss decreased (-0.670359 --> -0.681471).  Saving model ...
Epoch: 27 cost time: 1.789815902709961
Epoch: 27, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.038 Vali Acc: 0.685 Test Loss: 1.038 Test Acc: 0.685
Validation loss decreased (-0.681471 --> -0.685175).  Saving model ...
Epoch: 28 cost time: 1.9868392944335938
Epoch: 28, Steps: 2 | Train Loss: 0.477 Vali Loss: 1.013 Vali Acc: 0.689 Test Loss: 1.013 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688879).  Saving model ...
Epoch: 29 cost time: 1.6468288898468018
Epoch: 29, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.988 Vali Acc: 0.696 Test Loss: 0.988 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696286).  Saving model ...
Epoch: 30 cost time: 1.9736740589141846
Epoch: 30, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.966 Vali Acc: 0.711 Test Loss: 0.966 Test Acc: 0.711
Validation loss decreased (-0.696286 --> -0.711101).  Saving model ...
Epoch: 31 cost time: 1.8471722602844238
Epoch: 31, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.944 Vali Acc: 0.715 Test Loss: 0.944 Test Acc: 0.715
Validation loss decreased (-0.711101 --> -0.714805).  Saving model ...
Epoch: 32 cost time: 1.6304583549499512
Epoch: 32, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.924 Vali Acc: 0.726 Test Loss: 0.924 Test Acc: 0.726
Validation loss decreased (-0.714805 --> -0.725917).  Saving model ...
Epoch: 33 cost time: 1.7844133377075195
Epoch: 33, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.906 Vali Acc: 0.726 Test Loss: 0.906 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 34 cost time: 2.166381597518921
Epoch: 34, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.891 Vali Acc: 0.730 Test Loss: 0.891 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 35 cost time: 1.6530330181121826
Epoch: 35, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.875 Vali Acc: 0.737 Test Loss: 0.875 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737028).  Saving model ...
Epoch: 36 cost time: 1.5917184352874756
Epoch: 36, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.861 Vali Acc: 0.744 Test Loss: 0.861 Test Acc: 0.744
Validation loss decreased (-0.737028 --> -0.744436).  Saving model ...
Epoch: 37 cost time: 1.6325771808624268
Epoch: 37, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.848 Vali Acc: 0.756 Test Loss: 0.848 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 38 cost time: 1.7331712245941162
Epoch: 38, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.837 Vali Acc: 0.752 Test Loss: 0.837 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6325709819793701
Epoch: 39, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.828 Vali Acc: 0.752 Test Loss: 0.828 Test Acc: 0.752
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0079879760742188
Epoch: 40, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.820 Vali Acc: 0.752 Test Loss: 0.820 Test Acc: 0.752
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8706259727478027
Epoch: 41, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.812 Vali Acc: 0.752 Test Loss: 0.812 Test Acc: 0.752
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6478254795074463
Epoch: 42, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 43 cost time: 1.796989917755127
Epoch: 43, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 44 cost time: 1.7549629211425781
Epoch: 44, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.793 Vali Acc: 0.752 Test Loss: 0.793 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8464467525482178
Epoch: 45, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 46 cost time: 1.6713054180145264
Epoch: 46, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 47 cost time: 2.1805524826049805
Epoch: 47, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762955).  Saving model ...
Epoch: 48 cost time: 1.7658424377441406
Epoch: 48, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.773 Vali Acc: 0.763 Test Loss: 0.773 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 49 cost time: 1.9505414962768555
Epoch: 49, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.768 Vali Acc: 0.767 Test Loss: 0.768 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 50 cost time: 1.7414391040802002
Epoch: 50, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.762 Vali Acc: 0.767 Test Loss: 0.762 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 51 cost time: 1.560192346572876
Epoch: 51, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 52 cost time: 1.55120849609375
Epoch: 52, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 53 cost time: 1.482703685760498
Epoch: 53, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 54 cost time: 1.6383602619171143
Epoch: 54, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.741 Vali Acc: 0.770 Test Loss: 0.741 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 55 cost time: 1.67716383934021
Epoch: 55, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.735 Vali Acc: 0.774 Test Loss: 0.735 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 56 cost time: 2.435774326324463
Epoch: 56, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.729 Vali Acc: 0.778 Test Loss: 0.729 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777770).  Saving model ...
Epoch: 57 cost time: 2.2039737701416016
Epoch: 57, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 58 cost time: 2.0673015117645264
Epoch: 58, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.718 Vali Acc: 0.781 Test Loss: 0.718 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781474).  Saving model ...
Epoch: 59 cost time: 1.7033452987670898
Epoch: 59, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.714 Vali Acc: 0.778 Test Loss: 0.714 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.113237142562866
Epoch: 60, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.710 Vali Acc: 0.778 Test Loss: 0.710 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.0753018856048584
Epoch: 61, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.708 Vali Acc: 0.781 Test Loss: 0.708 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781474).  Saving model ...
Epoch: 62 cost time: 2.1386489868164062
Epoch: 62, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
Validation loss decreased (-0.781474 --> -0.788882).  Saving model ...
Epoch: 63 cost time: 1.920759677886963
Epoch: 63, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 64 cost time: 1.748201847076416
Epoch: 64, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 65 cost time: 1.799455165863037
Epoch: 65, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.704 Vali Acc: 0.785 Test Loss: 0.704 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.87335205078125
Epoch: 66, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.702 Vali Acc: 0.785 Test Loss: 0.702 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.4673912525177002
Epoch: 67, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.701 Vali Acc: 0.785 Test Loss: 0.701 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.6490504741668701
Epoch: 68, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.699 Vali Acc: 0.785 Test Loss: 0.699 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.834542989730835
Epoch: 69, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.698 Vali Acc: 0.785 Test Loss: 0.698 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.9824845790863037
Epoch: 70, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 71 cost time: 1.5565125942230225
Epoch: 71, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 72 cost time: 1.5298771858215332
Epoch: 72, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 73 cost time: 2.0484650135040283
Epoch: 73, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 74 cost time: 1.8816027641296387
Epoch: 74, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 75 cost time: 1.7405169010162354
Epoch: 75, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 76 cost time: 2.057624578475952
Epoch: 76, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 77 cost time: 1.9756269454956055
Epoch: 77, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 78 cost time: 1.7899093627929688
Epoch: 78, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 79 cost time: 2.133147716522217
Epoch: 79, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.675 Vali Acc: 0.793 Test Loss: 0.675 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 80 cost time: 2.036226987838745
Epoch: 80, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.673 Vali Acc: 0.793 Test Loss: 0.673 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 81 cost time: 2.007728099822998
Epoch: 81, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.671 Vali Acc: 0.793 Test Loss: 0.671 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 82 cost time: 2.0780277252197266
Epoch: 82, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.669 Vali Acc: 0.793 Test Loss: 0.669 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 83 cost time: 2.330695629119873
Epoch: 83, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.666 Vali Acc: 0.793 Test Loss: 0.666 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 84 cost time: 1.8911144733428955
Epoch: 84, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.664 Vali Acc: 0.793 Test Loss: 0.664 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 85 cost time: 1.783989667892456
Epoch: 85, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 86 cost time: 1.6722712516784668
Epoch: 86, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 87 cost time: 1.7212636470794678
Epoch: 87, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 88 cost time: 2.095136880874634
Epoch: 88, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 89 cost time: 1.9387693405151367
Epoch: 89, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 90 cost time: 2.232168674468994
Epoch: 90, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 91 cost time: 2.074612617492676
Epoch: 91, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 92 cost time: 2.0190255641937256
Epoch: 92, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 93 cost time: 1.575305700302124
Epoch: 93, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.645 Vali Acc: 0.796 Test Loss: 0.645 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 94 cost time: 1.8010444641113281
Epoch: 94, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 95 cost time: 1.9708802700042725
Epoch: 95, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 96 cost time: 2.166649580001831
Epoch: 96, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 97 cost time: 2.164484977722168
Epoch: 97, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 98 cost time: 2.066412925720215
Epoch: 98, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 99 cost time: 2.016108751296997
Epoch: 99, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 100 cost time: 1.7501161098480225
Epoch: 100, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7962962962962963
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5424928665161133
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.844 Vali Acc: 0.207 Test Loss: 1.844 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 1.7338852882385254
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.833 Vali Acc: 0.207 Test Loss: 1.833 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 1.6747760772705078
Epoch: 3, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.822 Vali Acc: 0.200 Test Loss: 1.822 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4452049732208252
Epoch: 4, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.807 Vali Acc: 0.200 Test Loss: 1.807 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8250603675842285
Epoch: 5, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.787 Vali Acc: 0.207 Test Loss: 1.787 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 1.612975835800171
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.765 Vali Acc: 0.226 Test Loss: 1.765 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 1.7664780616760254
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.739 Vali Acc: 0.259 Test Loss: 1.739 Test Acc: 0.259
Validation loss decreased (-0.225908 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 1.623065710067749
Epoch: 8, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.712 Vali Acc: 0.296 Test Loss: 1.712 Test Acc: 0.296
Validation loss decreased (-0.259242 --> -0.296279).  Saving model ...
Epoch: 9 cost time: 1.527780294418335
Epoch: 9, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.684 Vali Acc: 0.348 Test Loss: 1.684 Test Acc: 0.348
Validation loss decreased (-0.296279 --> -0.348131).  Saving model ...
Epoch: 10 cost time: 1.8628919124603271
Epoch: 10, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.654 Vali Acc: 0.381 Test Loss: 1.654 Test Acc: 0.381
Validation loss decreased (-0.348131 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 1.8070123195648193
Epoch: 11, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.624 Vali Acc: 0.411 Test Loss: 1.624 Test Acc: 0.411
Validation loss decreased (-0.381465 --> -0.411095).  Saving model ...
Epoch: 12 cost time: 1.871755599975586
Epoch: 12, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.594 Vali Acc: 0.448 Test Loss: 1.594 Test Acc: 0.448
Validation loss decreased (-0.411095 --> -0.448132).  Saving model ...
Epoch: 13 cost time: 1.8146159648895264
Epoch: 13, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.565 Vali Acc: 0.467 Test Loss: 1.565 Test Acc: 0.467
Validation loss decreased (-0.448132 --> -0.466651).  Saving model ...
Epoch: 14 cost time: 1.5209465026855469
Epoch: 14, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.535 Vali Acc: 0.470 Test Loss: 1.535 Test Acc: 0.470
Validation loss decreased (-0.466651 --> -0.470355).  Saving model ...
Epoch: 15 cost time: 1.5378565788269043
Epoch: 15, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.507 Vali Acc: 0.489 Test Loss: 1.507 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488874).  Saving model ...
Epoch: 16 cost time: 1.5677201747894287
Epoch: 16, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
Validation loss decreased (-0.488874 --> -0.499985).  Saving model ...
Epoch: 17 cost time: 2.0830540657043457
Epoch: 17, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.451 Vali Acc: 0.507 Test Loss: 1.451 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507393).  Saving model ...
Epoch: 18 cost time: 1.6818366050720215
Epoch: 18, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
Validation loss decreased (-0.507393 --> -0.518504).  Saving model ...
Epoch: 19 cost time: 1.6853384971618652
Epoch: 19, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.398 Vali Acc: 0.511 Test Loss: 1.398 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6470625400543213
Epoch: 20, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.372 Vali Acc: 0.530 Test Loss: 1.372 Test Acc: 0.530
Validation loss decreased (-0.518504 --> -0.529616).  Saving model ...
Epoch: 21 cost time: 1.6683428287506104
Epoch: 21, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.347 Vali Acc: 0.552 Test Loss: 1.347 Test Acc: 0.552
Validation loss decreased (-0.529616 --> -0.551838).  Saving model ...
Epoch: 22 cost time: 1.733405351638794
Epoch: 22, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.323 Vali Acc: 0.567 Test Loss: 1.323 Test Acc: 0.567
Validation loss decreased (-0.551838 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 1.9165611267089844
Epoch: 23, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.300 Vali Acc: 0.570 Test Loss: 1.300 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.570357).  Saving model ...
Epoch: 24 cost time: 2.106013774871826
Epoch: 24, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.276 Vali Acc: 0.596 Test Loss: 1.276 Test Acc: 0.596
Validation loss decreased (-0.570357 --> -0.596284).  Saving model ...
Epoch: 25 cost time: 2.0278642177581787
Epoch: 25, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.254 Vali Acc: 0.604 Test Loss: 1.254 Test Acc: 0.604
Validation loss decreased (-0.596284 --> -0.603691).  Saving model ...
Epoch: 26 cost time: 2.000447988510132
Epoch: 26, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.233 Vali Acc: 0.619 Test Loss: 1.233 Test Acc: 0.619
Validation loss decreased (-0.603691 --> -0.618506).  Saving model ...
Epoch: 27 cost time: 1.9009757041931152
Epoch: 27, Steps: 2 | Train Loss: 0.601 Vali Loss: 1.211 Vali Acc: 0.619 Test Loss: 1.211 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 28 cost time: 2.340972423553467
Epoch: 28, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.190 Vali Acc: 0.630 Test Loss: 1.190 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629618).  Saving model ...
Epoch: 29 cost time: 2.0406575202941895
Epoch: 29, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.169 Vali Acc: 0.644 Test Loss: 1.169 Test Acc: 0.644
Validation loss decreased (-0.629618 --> -0.644433).  Saving model ...
Epoch: 30 cost time: 1.8268375396728516
Epoch: 30, Steps: 2 | Train Loss: 0.534 Vali Loss: 1.149 Vali Acc: 0.637 Test Loss: 1.149 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.710904836654663
Epoch: 31, Steps: 2 | Train Loss: 0.434 Vali Loss: 1.130 Vali Acc: 0.637 Test Loss: 1.130 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6420807838439941
Epoch: 32, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.112 Vali Acc: 0.637 Test Loss: 1.112 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6255810260772705
Epoch: 33, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.095 Vali Acc: 0.641 Test Loss: 1.095 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6080262660980225
Epoch: 34, Steps: 2 | Train Loss: 0.345 Vali Loss: 1.080 Vali Acc: 0.656 Test Loss: 1.080 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 35 cost time: 1.7839114665985107
Epoch: 35, Steps: 2 | Train Loss: 0.357 Vali Loss: 1.065 Vali Acc: 0.656 Test Loss: 1.065 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 36 cost time: 1.627568244934082
Epoch: 36, Steps: 2 | Train Loss: 0.308 Vali Loss: 1.052 Vali Acc: 0.663 Test Loss: 1.052 Test Acc: 0.663
Validation loss decreased (-0.655545 --> -0.662952).  Saving model ...
Epoch: 37 cost time: 2.021378517150879
Epoch: 37, Steps: 2 | Train Loss: 0.281 Vali Loss: 1.039 Vali Acc: 0.659 Test Loss: 1.039 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.1394193172454834
Epoch: 38, Steps: 2 | Train Loss: 0.267 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666656).  Saving model ...
Epoch: 39 cost time: 2.190843343734741
Epoch: 39, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.017 Vali Acc: 0.663 Test Loss: 1.017 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.056704521179199
Epoch: 40, Steps: 2 | Train Loss: 0.241 Vali Loss: 1.007 Vali Acc: 0.670 Test Loss: 1.007 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.670360).  Saving model ...
Epoch: 41 cost time: 1.9579722881317139
Epoch: 41, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.997 Vali Acc: 0.674 Test Loss: 0.997 Test Acc: 0.674
Validation loss decreased (-0.670360 --> -0.674064).  Saving model ...
Epoch: 42 cost time: 2.0711381435394287
Epoch: 42, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.989 Vali Acc: 0.681 Test Loss: 0.989 Test Acc: 0.681
Validation loss decreased (-0.674064 --> -0.681472).  Saving model ...
Epoch: 43 cost time: 2.104787826538086
Epoch: 43, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.981 Vali Acc: 0.681 Test Loss: 0.981 Test Acc: 0.681
Validation loss decreased (-0.681472 --> -0.681472).  Saving model ...
Epoch: 44 cost time: 1.9915518760681152
Epoch: 44, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.973 Vali Acc: 0.681 Test Loss: 0.973 Test Acc: 0.681
Validation loss decreased (-0.681472 --> -0.681472).  Saving model ...
Epoch: 45 cost time: 2.479614496231079
Epoch: 45, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.967 Vali Acc: 0.689 Test Loss: 0.967 Test Acc: 0.689
Validation loss decreased (-0.681472 --> -0.688879).  Saving model ...
Epoch: 46 cost time: 1.7355029582977295
Epoch: 46, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.961 Vali Acc: 0.689 Test Loss: 0.961 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 47 cost time: 1.7806532382965088
Epoch: 47, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.954 Vali Acc: 0.689 Test Loss: 0.954 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 48 cost time: 1.692065715789795
Epoch: 48, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.948 Vali Acc: 0.689 Test Loss: 0.948 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 49 cost time: 1.7232856750488281
Epoch: 49, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.941 Vali Acc: 0.689 Test Loss: 0.941 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 50 cost time: 1.8867506980895996
Epoch: 50, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.935 Vali Acc: 0.689 Test Loss: 0.935 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 51 cost time: 1.7694776058197021
Epoch: 51, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.930 Vali Acc: 0.689 Test Loss: 0.930 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 52 cost time: 2.0628700256347656
Epoch: 52, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.925 Vali Acc: 0.689 Test Loss: 0.925 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 53 cost time: 1.7794651985168457
Epoch: 53, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.920 Vali Acc: 0.689 Test Loss: 0.920 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 54 cost time: 1.8414642810821533
Epoch: 54, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.916 Vali Acc: 0.689 Test Loss: 0.916 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 55 cost time: 1.7933800220489502
Epoch: 55, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.911 Vali Acc: 0.689 Test Loss: 0.911 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 56 cost time: 1.7956855297088623
Epoch: 56, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.906 Vali Acc: 0.689 Test Loss: 0.906 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 57 cost time: 2.337895154953003
Epoch: 57, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.901 Vali Acc: 0.693 Test Loss: 0.901 Test Acc: 0.693
Validation loss decreased (-0.688880 --> -0.692584).  Saving model ...
Epoch: 58 cost time: 1.6791532039642334
Epoch: 58, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.897 Vali Acc: 0.696 Test Loss: 0.897 Test Acc: 0.696
Validation loss decreased (-0.692584 --> -0.696287).  Saving model ...
Epoch: 59 cost time: 1.7461771965026855
Epoch: 59, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.892 Vali Acc: 0.696 Test Loss: 0.892 Test Acc: 0.696
Validation loss decreased (-0.696287 --> -0.696287).  Saving model ...
Epoch: 60 cost time: 1.9457697868347168
Epoch: 60, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.889 Vali Acc: 0.696 Test Loss: 0.889 Test Acc: 0.696
Validation loss decreased (-0.696287 --> -0.696287).  Saving model ...
Epoch: 61 cost time: 1.8262100219726562
Epoch: 61, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.696287 --> -0.699991).  Saving model ...
Epoch: 62 cost time: 1.6565656661987305
Epoch: 62, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.883 Vali Acc: 0.704 Test Loss: 0.883 Test Acc: 0.704
Validation loss decreased (-0.699991 --> -0.703695).  Saving model ...
Epoch: 63 cost time: 1.7884037494659424
Epoch: 63, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.881 Vali Acc: 0.711 Test Loss: 0.881 Test Acc: 0.711
Validation loss decreased (-0.703695 --> -0.711102).  Saving model ...
Epoch: 64 cost time: 1.5586051940917969
Epoch: 64, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.878 Vali Acc: 0.715 Test Loss: 0.878 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 65 cost time: 1.5305571556091309
Epoch: 65, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.875 Vali Acc: 0.711 Test Loss: 0.875 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.4587023258209229
Epoch: 66, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.870 Vali Acc: 0.707 Test Loss: 0.870 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.0291988849639893
Epoch: 67, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.867 Vali Acc: 0.704 Test Loss: 0.867 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.7358760833740234
Epoch: 68, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.863 Vali Acc: 0.704 Test Loss: 0.863 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.1152398586273193
Epoch: 69, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.9794631004333496
Epoch: 70, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.856 Vali Acc: 0.711 Test Loss: 0.856 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.556035041809082
Epoch: 71, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.852 Vali Acc: 0.711 Test Loss: 0.852 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.9262285232543945
Epoch: 72, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.848 Vali Acc: 0.711 Test Loss: 0.848 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 2.03165864944458
Epoch: 73, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.844 Vali Acc: 0.715 Test Loss: 0.844 Test Acc: 0.715
Validation loss decreased (-0.714806 --> -0.714806).  Saving model ...
Epoch: 74 cost time: 1.670712947845459
Epoch: 74, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.839 Vali Acc: 0.715 Test Loss: 0.839 Test Acc: 0.715
Validation loss decreased (-0.714806 --> -0.714806).  Saving model ...
Epoch: 75 cost time: 1.9583029747009277
Epoch: 75, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.835 Vali Acc: 0.722 Test Loss: 0.835 Test Acc: 0.722
Validation loss decreased (-0.714806 --> -0.722214).  Saving model ...
Epoch: 76 cost time: 1.5615952014923096
Epoch: 76, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.831 Vali Acc: 0.722 Test Loss: 0.831 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 77 cost time: 1.975820779800415
Epoch: 77, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 78 cost time: 1.9786896705627441
Epoch: 78, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 79 cost time: 1.8166635036468506
Epoch: 79, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.821 Vali Acc: 0.726 Test Loss: 0.821 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 80 cost time: 1.8551738262176514
Epoch: 80, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.818 Vali Acc: 0.726 Test Loss: 0.818 Test Acc: 0.726
Validation loss decreased (-0.725918 --> -0.725918).  Saving model ...
Epoch: 81 cost time: 1.6634187698364258
Epoch: 81, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.815 Vali Acc: 0.730 Test Loss: 0.815 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729621).  Saving model ...
Epoch: 82 cost time: 1.8522577285766602
Epoch: 82, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.812 Vali Acc: 0.730 Test Loss: 0.812 Test Acc: 0.730
Validation loss decreased (-0.729621 --> -0.729622).  Saving model ...
Epoch: 83 cost time: 1.6071183681488037
Epoch: 83, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.809 Vali Acc: 0.730 Test Loss: 0.809 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 84 cost time: 2.0076684951782227
Epoch: 84, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.806 Vali Acc: 0.730 Test Loss: 0.806 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 85 cost time: 2.012120008468628
Epoch: 85, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.803 Vali Acc: 0.737 Test Loss: 0.803 Test Acc: 0.737
Validation loss decreased (-0.729622 --> -0.737029).  Saving model ...
Epoch: 86 cost time: 1.7760703563690186
Epoch: 86, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.800 Vali Acc: 0.737 Test Loss: 0.800 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 87 cost time: 1.772217035293579
Epoch: 87, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.796 Vali Acc: 0.737 Test Loss: 0.796 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 88 cost time: 1.9719300270080566
Epoch: 88, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
Validation loss decreased (-0.737029 --> -0.744437).  Saving model ...
Epoch: 89 cost time: 1.631061315536499
Epoch: 89, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 90 cost time: 2.073417901992798
Epoch: 90, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 91 cost time: 1.7681519985198975
Epoch: 91, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.783 Vali Acc: 0.741 Test Loss: 0.783 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.9117226600646973
Epoch: 92, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.779 Vali Acc: 0.744 Test Loss: 0.779 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 93 cost time: 2.076343059539795
Epoch: 93, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.776 Vali Acc: 0.748 Test Loss: 0.776 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 94 cost time: 1.9495751857757568
Epoch: 94, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.773 Vali Acc: 0.748 Test Loss: 0.773 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 95 cost time: 1.6194393634796143
Epoch: 95, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.770 Vali Acc: 0.748 Test Loss: 0.770 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 96 cost time: 2.111546039581299
Epoch: 96, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.748 Test Loss: 0.766 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 97 cost time: 2.060046434402466
Epoch: 97, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.763 Vali Acc: 0.748 Test Loss: 0.763 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748141).  Saving model ...
Epoch: 98 cost time: 2.279529333114624
Epoch: 98, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.748 Test Loss: 0.760 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 99 cost time: 2.001847505569458
Epoch: 99, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.757 Vali Acc: 0.748 Test Loss: 0.757 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 100 cost time: 2.287975311279297
Epoch: 100, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.754 Vali Acc: 0.748 Test Loss: 0.754 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.15793251991272
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.819 Vali Acc: 0.207 Test Loss: 1.819 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 2.169219970703125
Epoch: 2, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.811 Vali Acc: 0.226 Test Loss: 1.811 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 1.930389404296875
Epoch: 3, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.802 Vali Acc: 0.233 Test Loss: 1.802 Test Acc: 0.233
Validation loss decreased (-0.225908 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 1.9954233169555664
Epoch: 4, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.790 Vali Acc: 0.241 Test Loss: 1.790 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.874678373336792
Epoch: 5, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.774 Vali Acc: 0.252 Test Loss: 1.774 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 2.1388847827911377
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.756 Vali Acc: 0.263 Test Loss: 1.756 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262945).  Saving model ...
Epoch: 7 cost time: 1.7400226593017578
Epoch: 7, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.735 Vali Acc: 0.285 Test Loss: 1.735 Test Acc: 0.285
Validation loss decreased (-0.262945 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 2.047372579574585
Epoch: 8, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.712 Vali Acc: 0.319 Test Loss: 1.712 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 1.9576811790466309
Epoch: 9, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.689 Vali Acc: 0.326 Test Loss: 1.689 Test Acc: 0.326
Validation loss decreased (-0.318501 --> -0.325909).  Saving model ...
Epoch: 10 cost time: 2.343315839767456
Epoch: 10, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.664 Vali Acc: 0.352 Test Loss: 1.664 Test Acc: 0.352
Validation loss decreased (-0.325909 --> -0.351835).  Saving model ...
Epoch: 11 cost time: 2.0205764770507812
Epoch: 11, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.640 Vali Acc: 0.396 Test Loss: 1.640 Test Acc: 0.396
Validation loss decreased (-0.351835 --> -0.396280).  Saving model ...
Epoch: 12 cost time: 2.499573230743408
Epoch: 12, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.614 Vali Acc: 0.437 Test Loss: 1.614 Test Acc: 0.437
Validation loss decreased (-0.396280 --> -0.437021).  Saving model ...
Epoch: 13 cost time: 1.993842363357544
Epoch: 13, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.589 Vali Acc: 0.448 Test Loss: 1.589 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448132).  Saving model ...
Epoch: 14 cost time: 2.001972198486328
Epoch: 14, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.564 Vali Acc: 0.463 Test Loss: 1.564 Test Acc: 0.463
Validation loss decreased (-0.448132 --> -0.462947).  Saving model ...
Epoch: 15 cost time: 1.5968337059020996
Epoch: 15, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.539 Vali Acc: 0.478 Test Loss: 1.539 Test Acc: 0.478
Validation loss decreased (-0.462947 --> -0.477762).  Saving model ...
Epoch: 16 cost time: 1.9439411163330078
Epoch: 16, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.516 Vali Acc: 0.493 Test Loss: 1.516 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 17 cost time: 1.4641945362091064
Epoch: 17, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.492 Vali Acc: 0.507 Test Loss: 1.492 Test Acc: 0.507
Validation loss decreased (-0.492577 --> -0.507392).  Saving model ...
Epoch: 18 cost time: 2.033383369445801
Epoch: 18, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.470 Vali Acc: 0.526 Test Loss: 1.470 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 19 cost time: 1.9274954795837402
Epoch: 19, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.447 Vali Acc: 0.541 Test Loss: 1.447 Test Acc: 0.541
Validation loss decreased (-0.525911 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 2.304401159286499
Epoch: 20, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.425 Vali Acc: 0.552 Test Loss: 1.425 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551838).  Saving model ...
Epoch: 21 cost time: 2.419496536254883
Epoch: 21, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.403 Vali Acc: 0.559 Test Loss: 1.403 Test Acc: 0.559
Validation loss decreased (-0.551838 --> -0.559245).  Saving model ...
Epoch: 22 cost time: 2.070650100708008
Epoch: 22, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.383 Vali Acc: 0.578 Test Loss: 1.383 Test Acc: 0.578
Validation loss decreased (-0.559245 --> -0.577764).  Saving model ...
Epoch: 23 cost time: 2.032104969024658
Epoch: 23, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.363 Vali Acc: 0.578 Test Loss: 1.363 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577764).  Saving model ...
Epoch: 24 cost time: 2.1525421142578125
Epoch: 24, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.344 Vali Acc: 0.570 Test Loss: 1.344 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.171316385269165
Epoch: 25, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.326 Vali Acc: 0.570 Test Loss: 1.326 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0233144760131836
Epoch: 26, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.309 Vali Acc: 0.574 Test Loss: 1.309 Test Acc: 0.574
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8255505561828613
Epoch: 27, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.293 Vali Acc: 0.570 Test Loss: 1.293 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8299903869628906
Epoch: 28, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8405001163482666
Epoch: 29, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.261 Vali Acc: 0.574 Test Loss: 1.261 Test Acc: 0.574
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6181004047393799
Epoch: 30, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.245 Vali Acc: 0.578 Test Loss: 1.245 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577765).  Saving model ...
Epoch: 31 cost time: 2.1862103939056396
Epoch: 31, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.229 Vali Acc: 0.581 Test Loss: 1.229 Test Acc: 0.581
Validation loss decreased (-0.577765 --> -0.581469).  Saving model ...
Epoch: 32 cost time: 2.1692864894866943
Epoch: 32, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.214 Vali Acc: 0.578 Test Loss: 1.214 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.574093818664551
Epoch: 33, Steps: 2 | Train Loss: 0.614 Vali Loss: 1.199 Vali Acc: 0.578 Test Loss: 1.199 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9243836402893066
Epoch: 34, Steps: 2 | Train Loss: 0.535 Vali Loss: 1.186 Vali Acc: 0.578 Test Loss: 1.186 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0346384048461914
Epoch: 35, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.172 Vali Acc: 0.589 Test Loss: 1.172 Test Acc: 0.589
Validation loss decreased (-0.581469 --> -0.588877).  Saving model ...
Epoch: 36 cost time: 1.8661983013153076
Epoch: 36, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.159 Vali Acc: 0.593 Test Loss: 1.159 Test Acc: 0.593
Validation loss decreased (-0.588877 --> -0.592581).  Saving model ...
Epoch: 37 cost time: 2.3523879051208496
Epoch: 37, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.146 Vali Acc: 0.593 Test Loss: 1.146 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 38 cost time: 2.1231045722961426
Epoch: 38, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.134 Vali Acc: 0.593 Test Loss: 1.134 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 39 cost time: 1.8021931648254395
Epoch: 39, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.122 Vali Acc: 0.596 Test Loss: 1.122 Test Acc: 0.596
Validation loss decreased (-0.592581 --> -0.596285).  Saving model ...
Epoch: 40 cost time: 1.7684686183929443
Epoch: 40, Steps: 2 | Train Loss: 0.399 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.596285 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 1.664602518081665
Epoch: 41, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 42 cost time: 2.029839277267456
Epoch: 42, Steps: 2 | Train Loss: 0.357 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 1.8841733932495117
Epoch: 43, Steps: 2 | Train Loss: 0.340 Vali Loss: 1.078 Vali Acc: 0.607 Test Loss: 1.078 Test Acc: 0.607
Validation loss decreased (-0.599989 --> -0.607397).  Saving model ...
Epoch: 44 cost time: 1.8682827949523926
Epoch: 44, Steps: 2 | Train Loss: 0.292 Vali Loss: 1.069 Vali Acc: 0.619 Test Loss: 1.069 Test Acc: 0.619
Validation loss decreased (-0.607397 --> -0.618508).  Saving model ...
Epoch: 45 cost time: 1.7497007846832275
Epoch: 45, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.061 Vali Acc: 0.615 Test Loss: 1.061 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9821579456329346
Epoch: 46, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.054 Vali Acc: 0.615 Test Loss: 1.054 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.1806583404541016
Epoch: 47, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.047 Vali Acc: 0.615 Test Loss: 1.047 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.657522201538086
Epoch: 48, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.040 Vali Acc: 0.611 Test Loss: 1.040 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0666377544403076
Epoch: 49, Steps: 2 | Train Loss: 0.207 Vali Loss: 1.033 Vali Acc: 0.615 Test Loss: 1.033 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.1819772720336914
Epoch: 50, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.026 Vali Acc: 0.604 Test Loss: 1.026 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.068044900894165
Epoch: 51, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.019 Vali Acc: 0.607 Test Loss: 1.019 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8308618068695068
Epoch: 52, Steps: 2 | Train Loss: 0.193 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
Validation loss decreased (-0.618508 --> -0.622212).  Saving model ...
Epoch: 53 cost time: 2.2735366821289062
Epoch: 53, Steps: 2 | Train Loss: 0.154 Vali Loss: 1.006 Vali Acc: 0.626 Test Loss: 1.006 Test Acc: 0.626
Validation loss decreased (-0.622212 --> -0.625916).  Saving model ...
Epoch: 54 cost time: 2.122300863265991
Epoch: 54, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.999 Vali Acc: 0.626 Test Loss: 0.999 Test Acc: 0.626
Validation loss decreased (-0.625916 --> -0.625916).  Saving model ...
Epoch: 55 cost time: 2.2235913276672363
Epoch: 55, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.993 Vali Acc: 0.626 Test Loss: 0.993 Test Acc: 0.626
Validation loss decreased (-0.625916 --> -0.625916).  Saving model ...
Epoch: 56 cost time: 1.6072158813476562
Epoch: 56, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.988 Vali Acc: 0.630 Test Loss: 0.988 Test Acc: 0.630
Validation loss decreased (-0.625916 --> -0.629620).  Saving model ...
Epoch: 57 cost time: 1.940535306930542
Epoch: 57, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.982 Vali Acc: 0.637 Test Loss: 0.982 Test Acc: 0.637
Validation loss decreased (-0.629620 --> -0.637027).  Saving model ...
Epoch: 58 cost time: 2.121962547302246
Epoch: 58, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.975 Vali Acc: 0.637 Test Loss: 0.975 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 59 cost time: 1.9699442386627197
Epoch: 59, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.968 Vali Acc: 0.633 Test Loss: 0.968 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.0533511638641357
Epoch: 60, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.961 Vali Acc: 0.637 Test Loss: 0.961 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 61 cost time: 2.0497593879699707
Epoch: 61, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.953 Vali Acc: 0.637 Test Loss: 0.953 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637028).  Saving model ...
Epoch: 62 cost time: 2.0137455463409424
Epoch: 62, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.945 Vali Acc: 0.637 Test Loss: 0.945 Test Acc: 0.637
Validation loss decreased (-0.637028 --> -0.637028).  Saving model ...
Epoch: 63 cost time: 1.9115729331970215
Epoch: 63, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.936 Vali Acc: 0.637 Test Loss: 0.936 Test Acc: 0.637
Validation loss decreased (-0.637028 --> -0.637028).  Saving model ...
Epoch: 64 cost time: 1.69028902053833
Epoch: 64, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.929 Vali Acc: 0.641 Test Loss: 0.929 Test Acc: 0.641
Validation loss decreased (-0.637028 --> -0.640731).  Saving model ...
Epoch: 65 cost time: 1.555668830871582
Epoch: 65, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.922 Vali Acc: 0.641 Test Loss: 0.922 Test Acc: 0.641
Validation loss decreased (-0.640731 --> -0.640732).  Saving model ...
Epoch: 66 cost time: 1.8273532390594482
Epoch: 66, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.914 Vali Acc: 0.644 Test Loss: 0.914 Test Acc: 0.644
Validation loss decreased (-0.640732 --> -0.644435).  Saving model ...
Epoch: 67 cost time: 1.6706855297088623
Epoch: 67, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.907 Vali Acc: 0.652 Test Loss: 0.907 Test Acc: 0.652
Validation loss decreased (-0.644435 --> -0.651843).  Saving model ...
Epoch: 68 cost time: 2.465226888656616
Epoch: 68, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.900 Vali Acc: 0.659 Test Loss: 0.900 Test Acc: 0.659
Validation loss decreased (-0.651843 --> -0.659250).  Saving model ...
Epoch: 69 cost time: 2.635908365249634
Epoch: 69, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.894 Vali Acc: 0.659 Test Loss: 0.894 Test Acc: 0.659
Validation loss decreased (-0.659250 --> -0.659250).  Saving model ...
Epoch: 70 cost time: 2.110401153564453
Epoch: 70, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.887 Vali Acc: 0.659 Test Loss: 0.887 Test Acc: 0.659
Validation loss decreased (-0.659250 --> -0.659250).  Saving model ...
Epoch: 71 cost time: 1.848881483078003
Epoch: 71, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.880 Vali Acc: 0.667 Test Loss: 0.880 Test Acc: 0.667
Validation loss decreased (-0.659250 --> -0.666658).  Saving model ...
Epoch: 72 cost time: 1.3999710083007812
Epoch: 72, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.873 Vali Acc: 0.670 Test Loss: 0.873 Test Acc: 0.670
Validation loss decreased (-0.666658 --> -0.670362).  Saving model ...
Epoch: 73 cost time: 1.880718469619751
Epoch: 73, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.867 Vali Acc: 0.670 Test Loss: 0.867 Test Acc: 0.670
Validation loss decreased (-0.670362 --> -0.670362).  Saving model ...
Epoch: 74 cost time: 2.166609764099121
Epoch: 74, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.860 Vali Acc: 0.674 Test Loss: 0.860 Test Acc: 0.674
Validation loss decreased (-0.670362 --> -0.674065).  Saving model ...
Epoch: 75 cost time: 1.8255393505096436
Epoch: 75, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.854 Vali Acc: 0.678 Test Loss: 0.854 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 76 cost time: 1.799476146697998
Epoch: 76, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.848 Vali Acc: 0.678 Test Loss: 0.848 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 77 cost time: 1.612778902053833
Epoch: 77, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.843 Vali Acc: 0.681 Test Loss: 0.843 Test Acc: 0.681
Validation loss decreased (-0.677769 --> -0.681473).  Saving model ...
Epoch: 78 cost time: 1.4059967994689941
Epoch: 78, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.839 Vali Acc: 0.685 Test Loss: 0.839 Test Acc: 0.685
Validation loss decreased (-0.681473 --> -0.685177).  Saving model ...
Epoch: 79 cost time: 1.9825224876403809
Epoch: 79, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.835 Vali Acc: 0.685 Test Loss: 0.835 Test Acc: 0.685
Validation loss decreased (-0.685177 --> -0.685177).  Saving model ...
Epoch: 80 cost time: 1.8691799640655518
Epoch: 80, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.832 Vali Acc: 0.685 Test Loss: 0.832 Test Acc: 0.685
Validation loss decreased (-0.685177 --> -0.685177).  Saving model ...
Epoch: 81 cost time: 1.7684462070465088
Epoch: 81, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.829 Vali Acc: 0.689 Test Loss: 0.829 Test Acc: 0.689
Validation loss decreased (-0.685177 --> -0.688881).  Saving model ...
Epoch: 82 cost time: 1.881962776184082
Epoch: 82, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.826 Vali Acc: 0.693 Test Loss: 0.826 Test Acc: 0.693
Validation loss decreased (-0.688881 --> -0.692584).  Saving model ...
Epoch: 83 cost time: 2.017829656600952
Epoch: 83, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.823 Vali Acc: 0.696 Test Loss: 0.823 Test Acc: 0.696
Validation loss decreased (-0.692584 --> -0.696288).  Saving model ...
Epoch: 84 cost time: 1.7538139820098877
Epoch: 84, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.819 Vali Acc: 0.696 Test Loss: 0.819 Test Acc: 0.696
Validation loss decreased (-0.696288 --> -0.696288).  Saving model ...
Epoch: 85 cost time: 1.8265159130096436
Epoch: 85, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.815 Vali Acc: 0.696 Test Loss: 0.815 Test Acc: 0.696
Validation loss decreased (-0.696288 --> -0.696288).  Saving model ...
Epoch: 86 cost time: 2.166612148284912
Epoch: 86, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.810 Vali Acc: 0.700 Test Loss: 0.810 Test Acc: 0.700
Validation loss decreased (-0.696288 --> -0.699992).  Saving model ...
Epoch: 87 cost time: 1.537994623184204
Epoch: 87, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.805 Vali Acc: 0.700 Test Loss: 0.805 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 88 cost time: 1.5375118255615234
Epoch: 88, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.801 Vali Acc: 0.704 Test Loss: 0.801 Test Acc: 0.704
Validation loss decreased (-0.699992 --> -0.703696).  Saving model ...
Epoch: 89 cost time: 1.596850872039795
Epoch: 89, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.795 Vali Acc: 0.707 Test Loss: 0.795 Test Acc: 0.707
Validation loss decreased (-0.703696 --> -0.707399).  Saving model ...
Epoch: 90 cost time: 1.6898655891418457
Epoch: 90, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.790 Vali Acc: 0.707 Test Loss: 0.790 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707400).  Saving model ...
Epoch: 91 cost time: 1.7774262428283691
Epoch: 91, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.785 Vali Acc: 0.711 Test Loss: 0.785 Test Acc: 0.711
Validation loss decreased (-0.707400 --> -0.711103).  Saving model ...
Epoch: 92 cost time: 1.9651765823364258
Epoch: 92, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 93 cost time: 1.9212205410003662
Epoch: 93, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.775 Vali Acc: 0.715 Test Loss: 0.775 Test Acc: 0.715
Validation loss decreased (-0.711103 --> -0.714807).  Saving model ...
Epoch: 94 cost time: 2.010073661804199
Epoch: 94, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.770 Vali Acc: 0.711 Test Loss: 0.770 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.6331732273101807
Epoch: 95, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.765 Vali Acc: 0.722 Test Loss: 0.765 Test Acc: 0.722
Validation loss decreased (-0.714807 --> -0.722215).  Saving model ...
Epoch: 96 cost time: 1.7866847515106201
Epoch: 96, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.760 Vali Acc: 0.726 Test Loss: 0.760 Test Acc: 0.726
Validation loss decreased (-0.722215 --> -0.725918).  Saving model ...
Epoch: 97 cost time: 1.7390542030334473
Epoch: 97, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.756 Vali Acc: 0.726 Test Loss: 0.756 Test Acc: 0.726
Validation loss decreased (-0.725918 --> -0.725918).  Saving model ...
Epoch: 98 cost time: 1.9678969383239746
Epoch: 98, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.753 Vali Acc: 0.730 Test Loss: 0.753 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 99 cost time: 1.7235307693481445
Epoch: 99, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
Validation loss decreased (-0.729622 --> -0.729622).  Saving model ...
Epoch: 100 cost time: 1.5931227207183838
Epoch: 100, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.746 Vali Acc: 0.733 Test Loss: 0.746 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7333333333333333
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.8599095344543457
Epoch: 1, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.806 Vali Acc: 0.193 Test Loss: 1.806 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 1.7671315670013428
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.801 Vali Acc: 0.204 Test Loss: 1.801 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 2.1449246406555176
Epoch: 3, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.795 Vali Acc: 0.204 Test Loss: 1.795 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 1.7065410614013672
Epoch: 4, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.788 Vali Acc: 0.204 Test Loss: 1.788 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 1.620483636856079
Epoch: 5, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.778 Vali Acc: 0.219 Test Loss: 1.778 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 1.4717543125152588
Epoch: 6, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.767 Vali Acc: 0.226 Test Loss: 1.767 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 1.8246355056762695
Epoch: 7, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.755 Vali Acc: 0.248 Test Loss: 1.755 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 8 cost time: 1.7794394493103027
Epoch: 8, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.741 Vali Acc: 0.263 Test Loss: 1.741 Test Acc: 0.263
Validation loss decreased (-0.248131 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 1.5763123035430908
Epoch: 9, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.727 Vali Acc: 0.296 Test Loss: 1.727 Test Acc: 0.296
Validation loss decreased (-0.262946 --> -0.296279).  Saving model ...
Epoch: 10 cost time: 1.832657814025879
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.712 Vali Acc: 0.330 Test Loss: 1.712 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 1.6118249893188477
Epoch: 11, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.696 Vali Acc: 0.341 Test Loss: 1.696 Test Acc: 0.341
Validation loss decreased (-0.329613 --> -0.340724).  Saving model ...
Epoch: 12 cost time: 1.656177043914795
Epoch: 12, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.680 Vali Acc: 0.356 Test Loss: 1.680 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 13 cost time: 1.6181471347808838
Epoch: 13, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.664 Vali Acc: 0.396 Test Loss: 1.664 Test Acc: 0.396
Validation loss decreased (-0.355539 --> -0.396280).  Saving model ...
Epoch: 14 cost time: 1.756608486175537
Epoch: 14, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.647 Vali Acc: 0.452 Test Loss: 1.647 Test Acc: 0.452
Validation loss decreased (-0.396280 --> -0.451835).  Saving model ...
Epoch: 15 cost time: 1.5365490913391113
Epoch: 15, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.629 Vali Acc: 0.459 Test Loss: 1.629 Test Acc: 0.459
Validation loss decreased (-0.451835 --> -0.459243).  Saving model ...
Epoch: 16 cost time: 1.616523027420044
Epoch: 16, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.612 Vali Acc: 0.474 Test Loss: 1.612 Test Acc: 0.474
Validation loss decreased (-0.459243 --> -0.474058).  Saving model ...
Epoch: 17 cost time: 1.9548969268798828
Epoch: 17, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.595 Vali Acc: 0.478 Test Loss: 1.595 Test Acc: 0.478
Validation loss decreased (-0.474058 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 1.950352668762207
Epoch: 18, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.578 Vali Acc: 0.496 Test Loss: 1.578 Test Acc: 0.496
Validation loss decreased (-0.477762 --> -0.496281).  Saving model ...
Epoch: 19 cost time: 1.695709228515625
Epoch: 19, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.561 Vali Acc: 0.507 Test Loss: 1.561 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 20 cost time: 1.564746379852295
Epoch: 20, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.544 Vali Acc: 0.511 Test Loss: 1.544 Test Acc: 0.511
Validation loss decreased (-0.507392 --> -0.511096).  Saving model ...
Epoch: 21 cost time: 1.5418031215667725
Epoch: 21, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.526 Vali Acc: 0.526 Test Loss: 1.526 Test Acc: 0.526
Validation loss decreased (-0.511096 --> -0.525911).  Saving model ...
Epoch: 22 cost time: 1.798384189605713
Epoch: 22, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.508 Vali Acc: 0.537 Test Loss: 1.508 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 23 cost time: 1.962937593460083
Epoch: 23, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.491 Vali Acc: 0.533 Test Loss: 1.491 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7685003280639648
Epoch: 24, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.473 Vali Acc: 0.537 Test Loss: 1.473 Test Acc: 0.537
Validation loss decreased (-0.537022 --> -0.537022).  Saving model ...
Epoch: 25 cost time: 1.6795930862426758
Epoch: 25, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.456 Vali Acc: 0.552 Test Loss: 1.456 Test Acc: 0.552
Validation loss decreased (-0.537022 --> -0.551837).  Saving model ...
Epoch: 26 cost time: 1.44551420211792
Epoch: 26, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.437 Vali Acc: 0.567 Test Loss: 1.437 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566652).  Saving model ...
Epoch: 27 cost time: 1.6039175987243652
Epoch: 27, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.419 Vali Acc: 0.570 Test Loss: 1.419 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.570356).  Saving model ...
Epoch: 28 cost time: 1.4860436916351318
Epoch: 28, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.401 Vali Acc: 0.578 Test Loss: 1.401 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577764).  Saving model ...
Epoch: 29 cost time: 1.5645692348480225
Epoch: 29, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.383 Vali Acc: 0.578 Test Loss: 1.383 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577764).  Saving model ...
Epoch: 30 cost time: 1.4979362487792969
Epoch: 30, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.364 Vali Acc: 0.585 Test Loss: 1.364 Test Acc: 0.585
Validation loss decreased (-0.577764 --> -0.585172).  Saving model ...
Epoch: 31 cost time: 1.4763343334197998
Epoch: 31, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.346 Vali Acc: 0.593 Test Loss: 1.346 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592579).  Saving model ...
Epoch: 32 cost time: 1.6052730083465576
Epoch: 32, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.328 Vali Acc: 0.596 Test Loss: 1.328 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 33 cost time: 1.582120418548584
Epoch: 33, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.310 Vali Acc: 0.596 Test Loss: 1.310 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 34 cost time: 1.8829574584960938
Epoch: 34, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.293 Vali Acc: 0.611 Test Loss: 1.293 Test Acc: 0.611
Validation loss decreased (-0.596283 --> -0.611098).  Saving model ...
Epoch: 35 cost time: 1.425506830215454
Epoch: 35, Steps: 2 | Train Loss: 0.852 Vali Loss: 1.275 Vali Acc: 0.622 Test Loss: 1.275 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 36 cost time: 1.403613567352295
Epoch: 36, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.257 Vali Acc: 0.626 Test Loss: 1.257 Test Acc: 0.626
Validation loss decreased (-0.622209 --> -0.625913).  Saving model ...
Epoch: 37 cost time: 1.9104201793670654
Epoch: 37, Steps: 2 | Train Loss: 0.779 Vali Loss: 1.239 Vali Acc: 0.633 Test Loss: 1.239 Test Acc: 0.633
Validation loss decreased (-0.625913 --> -0.633321).  Saving model ...
Epoch: 38 cost time: 1.5740077495574951
Epoch: 38, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.221 Vali Acc: 0.622 Test Loss: 1.221 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.505216121673584
Epoch: 39, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.202 Vali Acc: 0.619 Test Loss: 1.202 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5361084938049316
Epoch: 40, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.183 Vali Acc: 0.630 Test Loss: 1.183 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.629164457321167
Epoch: 41, Steps: 2 | Train Loss: 0.691 Vali Loss: 1.164 Vali Acc: 0.630 Test Loss: 1.164 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6032378673553467
Epoch: 42, Steps: 2 | Train Loss: 0.564 Vali Loss: 1.144 Vali Acc: 0.641 Test Loss: 1.144 Test Acc: 0.641
Validation loss decreased (-0.633321 --> -0.640729).  Saving model ...
Epoch: 43 cost time: 1.6070806980133057
Epoch: 43, Steps: 2 | Train Loss: 0.612 Vali Loss: 1.126 Vali Acc: 0.648 Test Loss: 1.126 Test Acc: 0.648
Validation loss decreased (-0.640729 --> -0.648137).  Saving model ...
Epoch: 44 cost time: 1.5901672840118408
Epoch: 44, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.106 Vali Acc: 0.663 Test Loss: 1.106 Test Acc: 0.663
Validation loss decreased (-0.648137 --> -0.662952).  Saving model ...
Epoch: 45 cost time: 1.7280185222625732
Epoch: 45, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.087 Vali Acc: 0.674 Test Loss: 1.087 Test Acc: 0.674
Validation loss decreased (-0.662952 --> -0.674063).  Saving model ...
Epoch: 46 cost time: 1.457360029220581
Epoch: 46, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
Validation loss decreased (-0.674063 --> -0.677767).  Saving model ...
Epoch: 47 cost time: 1.5386199951171875
Epoch: 47, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.044 Vali Acc: 0.678 Test Loss: 1.044 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 48 cost time: 1.449991226196289
Epoch: 48, Steps: 2 | Train Loss: 0.426 Vali Loss: 1.022 Vali Acc: 0.689 Test Loss: 1.022 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 49 cost time: 1.8505620956420898
Epoch: 49, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.001 Vali Acc: 0.689 Test Loss: 1.001 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 50 cost time: 1.5568792819976807
Epoch: 50, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.980 Vali Acc: 0.711 Test Loss: 0.980 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711101).  Saving model ...
Epoch: 51 cost time: 1.7240078449249268
Epoch: 51, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.959 Vali Acc: 0.715 Test Loss: 0.959 Test Acc: 0.715
Validation loss decreased (-0.711101 --> -0.714805).  Saving model ...
Epoch: 52 cost time: 1.5748562812805176
Epoch: 52, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.939 Vali Acc: 0.719 Test Loss: 0.939 Test Acc: 0.719
Validation loss decreased (-0.714805 --> -0.718509).  Saving model ...
Epoch: 53 cost time: 1.4781923294067383
Epoch: 53, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.921 Vali Acc: 0.730 Test Loss: 0.921 Test Acc: 0.730
Validation loss decreased (-0.718509 --> -0.729620).  Saving model ...
Epoch: 54 cost time: 1.6045310497283936
Epoch: 54, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.904 Vali Acc: 0.733 Test Loss: 0.904 Test Acc: 0.733
Validation loss decreased (-0.729620 --> -0.733324).  Saving model ...
Epoch: 55 cost time: 1.5384929180145264
Epoch: 55, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.886 Vali Acc: 0.737 Test Loss: 0.886 Test Acc: 0.737
Validation loss decreased (-0.733324 --> -0.737028).  Saving model ...
Epoch: 56 cost time: 1.6371910572052002
Epoch: 56, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.868 Vali Acc: 0.737 Test Loss: 0.868 Test Acc: 0.737
Validation loss decreased (-0.737028 --> -0.737028).  Saving model ...
Epoch: 57 cost time: 1.5662059783935547
Epoch: 57, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.737028 --> -0.744436).  Saving model ...
Epoch: 58 cost time: 2.00805401802063
Epoch: 58, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.831 Vali Acc: 0.744 Test Loss: 0.831 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 59 cost time: 1.6036510467529297
Epoch: 59, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 60 cost time: 1.5781378746032715
Epoch: 60, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.792 Vali Acc: 0.748 Test Loss: 0.792 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 61 cost time: 1.848850965499878
Epoch: 61, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.775 Vali Acc: 0.748 Test Loss: 0.775 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 62 cost time: 1.605395793914795
Epoch: 62, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.761 Vali Acc: 0.752 Test Loss: 0.761 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 63 cost time: 1.3860948085784912
Epoch: 63, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.747 Vali Acc: 0.752 Test Loss: 0.747 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 64 cost time: 1.5573556423187256
Epoch: 64, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 65 cost time: 1.7585508823394775
Epoch: 65, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.718 Vali Acc: 0.763 Test Loss: 0.718 Test Acc: 0.763
Validation loss decreased (-0.755548 --> -0.762956).  Saving model ...
Epoch: 66 cost time: 1.6655476093292236
Epoch: 66, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.703 Vali Acc: 0.767 Test Loss: 0.703 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 67 cost time: 1.6413044929504395
Epoch: 67, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.691 Vali Acc: 0.770 Test Loss: 0.691 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770363).  Saving model ...
Epoch: 68 cost time: 1.5635230541229248
Epoch: 68, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.681 Vali Acc: 0.770 Test Loss: 0.681 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770364).  Saving model ...
Epoch: 69 cost time: 1.5946664810180664
Epoch: 69, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 70 cost time: 1.8658826351165771
Epoch: 70, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 71 cost time: 1.387244462966919
Epoch: 71, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.657 Vali Acc: 0.774 Test Loss: 0.657 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774068).  Saving model ...
Epoch: 72 cost time: 1.613562822341919
Epoch: 72, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.649 Vali Acc: 0.774 Test Loss: 0.649 Test Acc: 0.774
Validation loss decreased (-0.774068 --> -0.774068).  Saving model ...
Epoch: 73 cost time: 1.5133416652679443
Epoch: 73, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.5101635456085205
Epoch: 74, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.630 Vali Acc: 0.770 Test Loss: 0.630 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.4933898448944092
Epoch: 75, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.621 Vali Acc: 0.778 Test Loss: 0.621 Test Acc: 0.778
Validation loss decreased (-0.774068 --> -0.777772).  Saving model ...
Epoch: 76 cost time: 1.6162440776824951
Epoch: 76, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.613 Vali Acc: 0.785 Test Loss: 0.613 Test Acc: 0.785
Validation loss decreased (-0.777772 --> -0.785179).  Saving model ...
Epoch: 77 cost time: 1.8266479969024658
Epoch: 77, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 78 cost time: 1.435678243637085
Epoch: 78, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.596 Vali Acc: 0.793 Test Loss: 0.596 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 79 cost time: 1.4016773700714111
Epoch: 79, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
Validation loss decreased (-0.792587 --> -0.799994).  Saving model ...
Epoch: 80 cost time: 1.6625850200653076
Epoch: 80, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.582 Vali Acc: 0.804 Test Loss: 0.582 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 81 cost time: 1.5956366062164307
Epoch: 81, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.577 Vali Acc: 0.807 Test Loss: 0.577 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807402).  Saving model ...
Epoch: 82 cost time: 1.4721310138702393
Epoch: 82, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.569 Vali Acc: 0.807 Test Loss: 0.569 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 83 cost time: 1.7450318336486816
Epoch: 83, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.563 Vali Acc: 0.807 Test Loss: 0.563 Test Acc: 0.807
Validation loss decreased (-0.807402 --> -0.807402).  Saving model ...
Epoch: 84 cost time: 1.9712977409362793
Epoch: 84, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.557 Vali Acc: 0.811 Test Loss: 0.557 Test Acc: 0.811
Validation loss decreased (-0.807402 --> -0.811106).  Saving model ...
Epoch: 85 cost time: 1.664548397064209
Epoch: 85, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.552 Vali Acc: 0.811 Test Loss: 0.552 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 86 cost time: 1.4808876514434814
Epoch: 86, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.811 Test Loss: 0.549 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 87 cost time: 1.6615159511566162
Epoch: 87, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.545 Vali Acc: 0.811 Test Loss: 0.545 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 88 cost time: 1.7088871002197266
Epoch: 88, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.543 Vali Acc: 0.815 Test Loss: 0.543 Test Acc: 0.815
Validation loss decreased (-0.811106 --> -0.814809).  Saving model ...
Epoch: 89 cost time: 1.49851393699646
Epoch: 89, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.540 Vali Acc: 0.815 Test Loss: 0.540 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 90 cost time: 1.6244714260101318
Epoch: 90, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 91 cost time: 1.593393087387085
Epoch: 91, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.534 Vali Acc: 0.815 Test Loss: 0.534 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 92 cost time: 1.8083655834197998
Epoch: 92, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818513).  Saving model ...
Epoch: 93 cost time: 1.4662721157073975
Epoch: 93, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 94 cost time: 1.7858586311340332
Epoch: 94, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
Validation loss decreased (-0.818513 --> -0.818513).  Saving model ...
Epoch: 95 cost time: 1.771533727645874
Epoch: 95, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
Validation loss decreased (-0.818513 --> -0.825921).  Saving model ...
Epoch: 96 cost time: 1.646324634552002
Epoch: 96, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.517 Vali Acc: 0.830 Test Loss: 0.517 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829624).  Saving model ...
Epoch: 97 cost time: 1.775428295135498
Epoch: 97, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.514 Vali Acc: 0.830 Test Loss: 0.514 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 98 cost time: 1.734227180480957
Epoch: 98, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.512 Vali Acc: 0.830 Test Loss: 0.512 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829625).  Saving model ...
Epoch: 99 cost time: 1.4163520336151123
Epoch: 99, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.508 Vali Acc: 0.830 Test Loss: 0.508 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 100 cost time: 1.5792956352233887
Epoch: 100, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.27201771736145
Epoch: 1, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.828 Vali Acc: 0.159 Test Loss: 1.828 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 2.1548757553100586
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.824 Vali Acc: 0.163 Test Loss: 1.824 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 1.7117700576782227
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.818 Vali Acc: 0.163 Test Loss: 1.818 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.9617867469787598
Epoch: 4, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.809 Vali Acc: 0.163 Test Loss: 1.809 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 1.5094680786132812
Epoch: 5, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.798 Vali Acc: 0.167 Test Loss: 1.798 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.9144151210784912
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.784 Vali Acc: 0.189 Test Loss: 1.784 Test Acc: 0.189
Validation loss decreased (-0.166649 --> -0.188871).  Saving model ...
Epoch: 7 cost time: 1.7930891513824463
Epoch: 7, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.768 Vali Acc: 0.196 Test Loss: 1.768 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 8 cost time: 2.057452917098999
Epoch: 8, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.751 Vali Acc: 0.215 Test Loss: 1.751 Test Acc: 0.215
Validation loss decreased (-0.196279 --> -0.214797).  Saving model ...
Epoch: 9 cost time: 1.5093727111816406
Epoch: 9, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.733 Vali Acc: 0.237 Test Loss: 1.733 Test Acc: 0.237
Validation loss decreased (-0.214797 --> -0.237020).  Saving model ...
Epoch: 10 cost time: 1.6748161315917969
Epoch: 10, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.713 Vali Acc: 0.274 Test Loss: 1.713 Test Acc: 0.274
Validation loss decreased (-0.237020 --> -0.274057).  Saving model ...
Epoch: 11 cost time: 2.012298822402954
Epoch: 11, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 12 cost time: 1.6406822204589844
Epoch: 12, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.671 Vali Acc: 0.322 Test Loss: 1.671 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322206).  Saving model ...
Epoch: 13 cost time: 1.8839316368103027
Epoch: 13, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.648 Vali Acc: 0.352 Test Loss: 1.648 Test Acc: 0.352
Validation loss decreased (-0.322206 --> -0.351835).  Saving model ...
Epoch: 14 cost time: 2.2433736324310303
Epoch: 14, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.626 Vali Acc: 0.385 Test Loss: 1.626 Test Acc: 0.385
Validation loss decreased (-0.351835 --> -0.385169).  Saving model ...
Epoch: 15 cost time: 1.734950304031372
Epoch: 15, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.603 Vali Acc: 0.411 Test Loss: 1.603 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411095).  Saving model ...
Epoch: 16 cost time: 1.8142333030700684
Epoch: 16, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.411095 --> -0.444429).  Saving model ...
Epoch: 17 cost time: 2.241112232208252
Epoch: 17, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.557 Vali Acc: 0.470 Test Loss: 1.557 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 18 cost time: 1.984635353088379
Epoch: 18, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.534 Vali Acc: 0.485 Test Loss: 1.534 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 19 cost time: 2.0472497940063477
Epoch: 19, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.510 Vali Acc: 0.507 Test Loss: 1.510 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507392).  Saving model ...
Epoch: 20 cost time: 1.8656013011932373
Epoch: 20, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.487 Vali Acc: 0.519 Test Loss: 1.487 Test Acc: 0.519
Validation loss decreased (-0.507392 --> -0.518504).  Saving model ...
Epoch: 21 cost time: 1.8219406604766846
Epoch: 21, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.463 Vali Acc: 0.530 Test Loss: 1.463 Test Acc: 0.530
Validation loss decreased (-0.518504 --> -0.529615).  Saving model ...
Epoch: 22 cost time: 1.6541287899017334
Epoch: 22, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.439 Vali Acc: 0.567 Test Loss: 1.439 Test Acc: 0.567
Validation loss decreased (-0.529615 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 2.3007476329803467
Epoch: 23, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.415 Vali Acc: 0.567 Test Loss: 1.415 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566653).  Saving model ...
Epoch: 24 cost time: 1.8575060367584229
Epoch: 24, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.392 Vali Acc: 0.567 Test Loss: 1.392 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566653).  Saving model ...
Epoch: 25 cost time: 1.5794925689697266
Epoch: 25, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.368 Vali Acc: 0.574 Test Loss: 1.368 Test Acc: 0.574
Validation loss decreased (-0.566653 --> -0.574060).  Saving model ...
Epoch: 26 cost time: 1.8253986835479736
Epoch: 26, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.344 Vali Acc: 0.596 Test Loss: 1.344 Test Acc: 0.596
Validation loss decreased (-0.574060 --> -0.596283).  Saving model ...
Epoch: 27 cost time: 1.71397066116333
Epoch: 27, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.319 Vali Acc: 0.604 Test Loss: 1.319 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603691).  Saving model ...
Epoch: 28 cost time: 1.8894321918487549
Epoch: 28, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.295 Vali Acc: 0.619 Test Loss: 1.295 Test Acc: 0.619
Validation loss decreased (-0.603691 --> -0.618506).  Saving model ...
Epoch: 29 cost time: 1.9984314441680908
Epoch: 29, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.272 Vali Acc: 0.626 Test Loss: 1.272 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625913).  Saving model ...
Epoch: 30 cost time: 1.8880162239074707
Epoch: 30, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.248 Vali Acc: 0.633 Test Loss: 1.248 Test Acc: 0.633
Validation loss decreased (-0.625913 --> -0.633321).  Saving model ...
Epoch: 31 cost time: 1.8284542560577393
Epoch: 31, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.224 Vali Acc: 0.648 Test Loss: 1.224 Test Acc: 0.648
Validation loss decreased (-0.633321 --> -0.648136).  Saving model ...
Epoch: 32 cost time: 1.9397096633911133
Epoch: 32, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.199 Vali Acc: 0.667 Test Loss: 1.199 Test Acc: 0.667
Validation loss decreased (-0.648136 --> -0.666655).  Saving model ...
Epoch: 33 cost time: 2.0799143314361572
Epoch: 33, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.175 Vali Acc: 0.674 Test Loss: 1.175 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.674062).  Saving model ...
Epoch: 34 cost time: 2.148965835571289
Epoch: 34, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.150 Vali Acc: 0.700 Test Loss: 1.150 Test Acc: 0.700
Validation loss decreased (-0.674062 --> -0.699989).  Saving model ...
Epoch: 35 cost time: 1.692129135131836
Epoch: 35, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.123 Vali Acc: 0.719 Test Loss: 1.123 Test Acc: 0.719
Validation loss decreased (-0.699989 --> -0.718507).  Saving model ...
Epoch: 36 cost time: 1.7952373027801514
Epoch: 36, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.095 Vali Acc: 0.726 Test Loss: 1.095 Test Acc: 0.726
Validation loss decreased (-0.718507 --> -0.725915).  Saving model ...
Epoch: 37 cost time: 1.9959113597869873
Epoch: 37, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.067 Vali Acc: 0.741 Test Loss: 1.067 Test Acc: 0.741
Validation loss decreased (-0.725915 --> -0.740730).  Saving model ...
Epoch: 38 cost time: 1.7959766387939453
Epoch: 38, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.039 Vali Acc: 0.744 Test Loss: 1.039 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744434).  Saving model ...
Epoch: 39 cost time: 2.029365301132202
Epoch: 39, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.010 Vali Acc: 0.756 Test Loss: 1.010 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755545).  Saving model ...
Epoch: 40 cost time: 1.746859073638916
Epoch: 40, Steps: 2 | Train Loss: 1.135 Vali Loss: 0.982 Vali Acc: 0.770 Test Loss: 0.982 Test Acc: 0.770
Validation loss decreased (-0.755545 --> -0.770361).  Saving model ...
Epoch: 41 cost time: 1.8254156112670898
Epoch: 41, Steps: 2 | Train Loss: 1.033 Vali Loss: 0.953 Vali Acc: 0.778 Test Loss: 0.953 Test Acc: 0.778
Validation loss decreased (-0.770361 --> -0.777768).  Saving model ...
Epoch: 42 cost time: 1.9573917388916016
Epoch: 42, Steps: 2 | Train Loss: 1.002 Vali Loss: 0.926 Vali Acc: 0.785 Test Loss: 0.926 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785176).  Saving model ...
Epoch: 43 cost time: 2.2005927562713623
Epoch: 43, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.899 Vali Acc: 0.793 Test Loss: 0.899 Test Acc: 0.793
Validation loss decreased (-0.785176 --> -0.792584).  Saving model ...
Epoch: 44 cost time: 2.0851643085479736
Epoch: 44, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.872 Vali Acc: 0.785 Test Loss: 0.872 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.771836757659912
Epoch: 45, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1542701721191406
Epoch: 46, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.0825164318084717
Epoch: 47, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.792 Vali Acc: 0.793 Test Loss: 0.792 Test Acc: 0.793
Validation loss decreased (-0.792584 --> -0.792585).  Saving model ...
Epoch: 48 cost time: 1.614305019378662
Epoch: 48, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
Validation loss decreased (-0.792585 --> -0.796289).  Saving model ...
Epoch: 49 cost time: 1.7661850452423096
Epoch: 49, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.739 Vali Acc: 0.793 Test Loss: 0.739 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7825257778167725
Epoch: 50, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.712 Vali Acc: 0.793 Test Loss: 0.712 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.1363019943237305
Epoch: 51, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
Validation loss decreased (-0.796289 --> -0.811104).  Saving model ...
Epoch: 52 cost time: 1.9943113327026367
Epoch: 52, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.660 Vali Acc: 0.819 Test Loss: 0.660 Test Acc: 0.819
Validation loss decreased (-0.811104 --> -0.818512).  Saving model ...
Epoch: 53 cost time: 1.9075329303741455
Epoch: 53, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 54 cost time: 2.2042739391326904
Epoch: 54, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.615 Vali Acc: 0.826 Test Loss: 0.615 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 55 cost time: 2.0960826873779297
Epoch: 55, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.593 Vali Acc: 0.830 Test Loss: 0.593 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 56 cost time: 1.6782889366149902
Epoch: 56, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 57 cost time: 1.7232911586761475
Epoch: 57, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840735).  Saving model ...
Epoch: 58 cost time: 1.7924742698669434
Epoch: 58, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 59 cost time: 1.7154903411865234
Epoch: 59, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
Validation loss decreased (-0.844439 --> -0.859254).  Saving model ...
Epoch: 60 cost time: 2.052562952041626
Epoch: 60, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
Validation loss decreased (-0.859254 --> -0.870365).  Saving model ...
Epoch: 61 cost time: 1.6262586116790771
Epoch: 61, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.9644067287445068
Epoch: 62, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.6912355422973633
Epoch: 63, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870366).  Saving model ...
Epoch: 64 cost time: 1.73531174659729
Epoch: 64, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.437 Vali Acc: 0.878 Test Loss: 0.437 Test Acc: 0.878
Validation loss decreased (-0.870366 --> -0.877773).  Saving model ...
Epoch: 65 cost time: 1.810509443283081
Epoch: 65, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.424 Vali Acc: 0.874 Test Loss: 0.424 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.9131982326507568
Epoch: 66, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9991235733032227
Epoch: 67, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.401 Vali Acc: 0.863 Test Loss: 0.401 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.469529628753662
Epoch: 68, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.391 Vali Acc: 0.859 Test Loss: 0.391 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.468524932861328
Epoch: 69, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.380 Vali Acc: 0.863 Test Loss: 0.380 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.8159034252166748
Epoch: 70, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.6714866161346436
Epoch: 71, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.360 Vali Acc: 0.874 Test Loss: 0.360 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.1077768802642822
Epoch: 72, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.350 Vali Acc: 0.878 Test Loss: 0.350 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 73 cost time: 1.5736496448516846
Epoch: 73, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.341 Vali Acc: 0.874 Test Loss: 0.341 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.033151149749756
Epoch: 74, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.332 Vali Acc: 0.881 Test Loss: 0.332 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 75 cost time: 1.777557611465454
Epoch: 75, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.324 Vali Acc: 0.881 Test Loss: 0.324 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 76 cost time: 1.7575218677520752
Epoch: 76, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.318 Vali Acc: 0.881 Test Loss: 0.318 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 77 cost time: 1.8138587474822998
Epoch: 77, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.164747953414917
Epoch: 78, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.310 Vali Acc: 0.881 Test Loss: 0.310 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 79 cost time: 2.1868929862976074
Epoch: 79, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 2.2641453742980957
Epoch: 80, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 2.4314615726470947
Epoch: 81, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.299 Vali Acc: 0.881 Test Loss: 0.299 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 82 cost time: 2.3413262367248535
Epoch: 82, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888886).  Saving model ...
Epoch: 83 cost time: 2.0007944107055664
Epoch: 83, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.893 Test Loss: 0.283 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892590).  Saving model ...
Epoch: 84 cost time: 2.2182939052581787
Epoch: 84, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.893 Test Loss: 0.278 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 85 cost time: 2.406886100769043
Epoch: 85, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.273 Vali Acc: 0.896 Test Loss: 0.273 Test Acc: 0.896
Validation loss decreased (-0.892590 --> -0.896294).  Saving model ...
Epoch: 86 cost time: 1.7493438720703125
Epoch: 86, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
Validation loss decreased (-0.896294 --> -0.899997).  Saving model ...
Epoch: 87 cost time: 2.0905869007110596
Epoch: 87, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 88 cost time: 1.6656062602996826
Epoch: 88, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.262 Vali Acc: 0.904 Test Loss: 0.262 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 89 cost time: 2.0652859210968018
Epoch: 89, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.907 Test Loss: 0.258 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 90 cost time: 2.0475094318389893
Epoch: 90, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.6348209381103516
Epoch: 91, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.9542102813720703
Epoch: 92, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.250 Vali Acc: 0.904 Test Loss: 0.250 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 2.3855230808258057
Epoch: 93, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.248 Vali Acc: 0.904 Test Loss: 0.248 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 1.686288595199585
Epoch: 94, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.904 Test Loss: 0.245 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 2.5625100135803223
Epoch: 95, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.242 Vali Acc: 0.904 Test Loss: 0.242 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 2.0968258380889893
Epoch: 96, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.238 Vali Acc: 0.907 Test Loss: 0.238 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 97 cost time: 2.0321578979492188
Epoch: 97, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.233 Vali Acc: 0.907 Test Loss: 0.233 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 98 cost time: 1.8803212642669678
Epoch: 98, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 99 cost time: 1.7860100269317627
Epoch: 99, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
Validation loss decreased (-0.911109 --> -0.918516).  Saving model ...
Epoch: 100 cost time: 2.5407347679138184
Epoch: 100, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.134442090988159
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.798 Vali Acc: 0.170 Test Loss: 1.798 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 2.2604589462280273
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.793 Vali Acc: 0.170 Test Loss: 1.793 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 1.740401029586792
Epoch: 3, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.788 Vali Acc: 0.174 Test Loss: 1.788 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 1.8202166557312012
Epoch: 4, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.779 Vali Acc: 0.185 Test Loss: 1.779 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 2.122305393218994
Epoch: 5, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.768 Vali Acc: 0.211 Test Loss: 1.768 Test Acc: 0.211
Validation loss decreased (-0.185167 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 1.6347432136535645
Epoch: 6, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.755 Vali Acc: 0.230 Test Loss: 1.755 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 7 cost time: 1.6285772323608398
Epoch: 7, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.740 Vali Acc: 0.244 Test Loss: 1.740 Test Acc: 0.244
Validation loss decreased (-0.229612 --> -0.244427).  Saving model ...
Epoch: 8 cost time: 1.7300631999969482
Epoch: 8, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.724 Vali Acc: 0.274 Test Loss: 1.724 Test Acc: 0.274
Validation loss decreased (-0.244427 --> -0.274057).  Saving model ...
Epoch: 9 cost time: 2.053058385848999
Epoch: 9, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.274057 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 1.976062536239624
Epoch: 10, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.687 Vali Acc: 0.304 Test Loss: 1.687 Test Acc: 0.304
Validation loss decreased (-0.288872 --> -0.303687).  Saving model ...
Epoch: 11 cost time: 1.8448660373687744
Epoch: 11, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.667 Vali Acc: 0.330 Test Loss: 1.667 Test Acc: 0.330
Validation loss decreased (-0.303687 --> -0.329613).  Saving model ...
Epoch: 12 cost time: 1.8353564739227295
Epoch: 12, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.647 Vali Acc: 0.359 Test Loss: 1.647 Test Acc: 0.359
Validation loss decreased (-0.329613 --> -0.359243).  Saving model ...
Epoch: 13 cost time: 2.004072666168213
Epoch: 13, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.625 Vali Acc: 0.396 Test Loss: 1.625 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396280).  Saving model ...
Epoch: 14 cost time: 2.196661949157715
Epoch: 14, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.603 Vali Acc: 0.422 Test Loss: 1.603 Test Acc: 0.422
Validation loss decreased (-0.396280 --> -0.422206).  Saving model ...
Epoch: 15 cost time: 1.9976587295532227
Epoch: 15, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.581 Vali Acc: 0.459 Test Loss: 1.581 Test Acc: 0.459
Validation loss decreased (-0.422206 --> -0.459243).  Saving model ...
Epoch: 16 cost time: 1.8097171783447266
Epoch: 16, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.558 Vali Acc: 0.478 Test Loss: 1.558 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477762).  Saving model ...
Epoch: 17 cost time: 1.7699835300445557
Epoch: 17, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.535 Vali Acc: 0.493 Test Loss: 1.535 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 1.6718041896820068
Epoch: 18, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.510 Vali Acc: 0.511 Test Loss: 1.510 Test Acc: 0.511
Validation loss decreased (-0.492577 --> -0.511096).  Saving model ...
Epoch: 19 cost time: 1.930955171585083
Epoch: 19, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.485 Vali Acc: 0.533 Test Loss: 1.485 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533318).  Saving model ...
Epoch: 20 cost time: 1.8318755626678467
Epoch: 20, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.461 Vali Acc: 0.548 Test Loss: 1.461 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548134).  Saving model ...
Epoch: 21 cost time: 1.951678991317749
Epoch: 21, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.436 Vali Acc: 0.559 Test Loss: 1.436 Test Acc: 0.559
Validation loss decreased (-0.548134 --> -0.559245).  Saving model ...
Epoch: 22 cost time: 2.0561888217926025
Epoch: 22, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.411 Vali Acc: 0.563 Test Loss: 1.411 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 23 cost time: 1.7683498859405518
Epoch: 23, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.385 Vali Acc: 0.574 Test Loss: 1.385 Test Acc: 0.574
Validation loss decreased (-0.562949 --> -0.574060).  Saving model ...
Epoch: 24 cost time: 1.8649165630340576
Epoch: 24, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.360 Vali Acc: 0.585 Test Loss: 1.360 Test Acc: 0.585
Validation loss decreased (-0.574060 --> -0.585172).  Saving model ...
Epoch: 25 cost time: 2.16939377784729
Epoch: 25, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.335 Vali Acc: 0.611 Test Loss: 1.335 Test Acc: 0.611
Validation loss decreased (-0.585172 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 2.081690549850464
Epoch: 26, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.309 Vali Acc: 0.630 Test Loss: 1.309 Test Acc: 0.630
Validation loss decreased (-0.611098 --> -0.629617).  Saving model ...
Epoch: 27 cost time: 1.8194870948791504
Epoch: 27, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.284 Vali Acc: 0.641 Test Loss: 1.284 Test Acc: 0.641
Validation loss decreased (-0.629617 --> -0.640728).  Saving model ...
Epoch: 28 cost time: 2.373265504837036
Epoch: 28, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.259 Vali Acc: 0.663 Test Loss: 1.259 Test Acc: 0.663
Validation loss decreased (-0.640728 --> -0.662950).  Saving model ...
Epoch: 29 cost time: 1.9323530197143555
Epoch: 29, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.235 Vali Acc: 0.670 Test Loss: 1.235 Test Acc: 0.670
Validation loss decreased (-0.662950 --> -0.670358).  Saving model ...
Epoch: 30 cost time: 2.2737903594970703
Epoch: 30, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.211 Vali Acc: 0.678 Test Loss: 1.211 Test Acc: 0.678
Validation loss decreased (-0.670358 --> -0.677766).  Saving model ...
Epoch: 31 cost time: 1.7860548496246338
Epoch: 31, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.187 Vali Acc: 0.678 Test Loss: 1.187 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 32 cost time: 1.7954137325286865
Epoch: 32, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.164 Vali Acc: 0.693 Test Loss: 1.164 Test Acc: 0.693
Validation loss decreased (-0.677766 --> -0.692581).  Saving model ...
Epoch: 33 cost time: 2.1938982009887695
Epoch: 33, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.139 Vali Acc: 0.700 Test Loss: 1.139 Test Acc: 0.700
Validation loss decreased (-0.692581 --> -0.699989).  Saving model ...
Epoch: 34 cost time: 1.9423856735229492
Epoch: 34, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.114 Vali Acc: 0.715 Test Loss: 1.114 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714804).  Saving model ...
Epoch: 35 cost time: 1.700667381286621
Epoch: 35, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.089 Vali Acc: 0.730 Test Loss: 1.089 Test Acc: 0.730
Validation loss decreased (-0.714804 --> -0.729619).  Saving model ...
Epoch: 36 cost time: 1.6677818298339844
Epoch: 36, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.062 Vali Acc: 0.741 Test Loss: 1.062 Test Acc: 0.741
Validation loss decreased (-0.729619 --> -0.740730).  Saving model ...
Epoch: 37 cost time: 1.8078055381774902
Epoch: 37, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.034 Vali Acc: 0.744 Test Loss: 1.034 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744434).  Saving model ...
Epoch: 38 cost time: 1.670252799987793
Epoch: 38, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.007 Vali Acc: 0.752 Test Loss: 1.007 Test Acc: 0.752
Validation loss decreased (-0.744434 --> -0.751842).  Saving model ...
Epoch: 39 cost time: 2.17600679397583
Epoch: 39, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.977 Vali Acc: 0.759 Test Loss: 0.977 Test Acc: 0.759
Validation loss decreased (-0.751842 --> -0.759249).  Saving model ...
Epoch: 40 cost time: 2.021233558654785
Epoch: 40, Steps: 2 | Train Loss: 1.088 Vali Loss: 0.949 Vali Acc: 0.767 Test Loss: 0.949 Test Acc: 0.767
Validation loss decreased (-0.759249 --> -0.766657).  Saving model ...
Epoch: 41 cost time: 1.996917963027954
Epoch: 41, Steps: 2 | Train Loss: 1.021 Vali Loss: 0.921 Vali Acc: 0.767 Test Loss: 0.921 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766657).  Saving model ...
Epoch: 42 cost time: 1.9147651195526123
Epoch: 42, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.894 Vali Acc: 0.770 Test Loss: 0.894 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770361).  Saving model ...
Epoch: 43 cost time: 2.160784959793091
Epoch: 43, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.868 Vali Acc: 0.774 Test Loss: 0.868 Test Acc: 0.774
Validation loss decreased (-0.770361 --> -0.774065).  Saving model ...
Epoch: 44 cost time: 1.6120548248291016
Epoch: 44, Steps: 2 | Train Loss: 0.970 Vali Loss: 0.842 Vali Acc: 0.763 Test Loss: 0.842 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9043121337890625
Epoch: 45, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.8058042526245117
Epoch: 46, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.570206642150879
Epoch: 47, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
Validation loss decreased (-0.774065 --> -0.777770).  Saving model ...
Epoch: 48 cost time: 1.7721545696258545
Epoch: 48, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.743 Vali Acc: 0.781 Test Loss: 0.743 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 49 cost time: 1.7587246894836426
Epoch: 49, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.721 Vali Acc: 0.785 Test Loss: 0.721 Test Acc: 0.785
Validation loss decreased (-0.781474 --> -0.785178).  Saving model ...
Epoch: 50 cost time: 1.9833121299743652
Epoch: 50, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.698 Vali Acc: 0.785 Test Loss: 0.698 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785178).  Saving model ...
Epoch: 51 cost time: 1.752429723739624
Epoch: 51, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.675 Vali Acc: 0.781 Test Loss: 0.675 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5357027053833008
Epoch: 52, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.653 Vali Acc: 0.781 Test Loss: 0.653 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8163113594055176
Epoch: 53, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
Validation loss decreased (-0.785178 --> -0.788883).  Saving model ...
Epoch: 54 cost time: 1.6595468521118164
Epoch: 54, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.612 Vali Acc: 0.781 Test Loss: 0.612 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6567518711090088
Epoch: 55, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.591 Vali Acc: 0.778 Test Loss: 0.591 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7876229286193848
Epoch: 56, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.573 Vali Acc: 0.778 Test Loss: 0.573 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.1309590339660645
Epoch: 57, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.554 Vali Acc: 0.781 Test Loss: 0.554 Test Acc: 0.781
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.750281810760498
Epoch: 58, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.788883 --> -0.796291).  Saving model ...
Epoch: 59 cost time: 2.175031900405884
Epoch: 59, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.516 Vali Acc: 0.811 Test Loss: 0.516 Test Acc: 0.811
Validation loss decreased (-0.796291 --> -0.811106).  Saving model ...
Epoch: 60 cost time: 1.7010650634765625
Epoch: 60, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.497 Vali Acc: 0.830 Test Loss: 0.497 Test Acc: 0.830
Validation loss decreased (-0.811106 --> -0.829625).  Saving model ...
Epoch: 61 cost time: 1.9753963947296143
Epoch: 61, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833329).  Saving model ...
Epoch: 62 cost time: 1.8464815616607666
Epoch: 62, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840736).  Saving model ...
Epoch: 63 cost time: 1.8823235034942627
Epoch: 63, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.451 Vali Acc: 0.852 Test Loss: 0.451 Test Acc: 0.852
Validation loss decreased (-0.840736 --> -0.851847).  Saving model ...
Epoch: 64 cost time: 1.886300802230835
Epoch: 64, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.9681344032287598
Epoch: 65, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.257727861404419
Epoch: 66, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.6863415241241455
Epoch: 67, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.2377936840057373
Epoch: 68, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.399 Vali Acc: 0.837 Test Loss: 0.399 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.015557050704956
Epoch: 69, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.388 Vali Acc: 0.841 Test Loss: 0.388 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.9308671951293945
Epoch: 70, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.381 Vali Acc: 0.837 Test Loss: 0.381 Test Acc: 0.837
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.7045958042144775
Epoch: 71, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.1449568271636963
Epoch: 72, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.372 Vali Acc: 0.830 Test Loss: 0.372 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 2.0384011268615723
Epoch: 73, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.369 Vali Acc: 0.826 Test Loss: 0.369 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.363038539886475
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.690178632736206
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7507948875427246
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 1.7592434883117676
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8308918476104736
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0814337730407715
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.179694890975952
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.990731954574585
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.7965459823608398
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.9648923873901367
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6525142192840576
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.105069875717163
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 2.222027540206909
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.7310688495635986
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.95676589012146
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 2.4172351360321045
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.7366347312927246
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 2.1164228916168213
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.9245076179504395
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.9339544773101807
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 2.1184446811676025
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 2.1498398780822754
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 2.0628020763397217
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.8769981861114502
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.800598382949829
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.8615469932556152
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.8139898777008057
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.760387659072876
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.528529167175293
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.8753278255462646
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 2.289025068283081
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.4622695446014404
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.6864259243011475
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.7948474884033203
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.6868553161621094
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.7607393264770508
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.8746237754821777
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.6463911533355713
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 2.3131113052368164
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.7467257976531982
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.6601974964141846
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.6569697856903076
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6463878154754639
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.7048554420471191
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.7921569347381592
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.7682201862335205
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.995436429977417
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9964439868927002
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 2.0335819721221924
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.7715427875518799
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.908569097518921
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 2.0874640941619873
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8624274730682373
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 2.0496068000793457
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.9763073921203613
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.7251276969909668
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.8917579650878906
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.886218547821045
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.575934648513794
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.6132628917694092
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.473219394683838
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.6966578960418701
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.4138908386230469
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.5074245929718018
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.4876208305358887
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.4589385986328125
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.734926462173462
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.649597406387329
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.3299407958984375
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.5809636116027832
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.4345817565917969
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.26491379737854
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.4763119220733643
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.4825022220611572
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.599602222442627
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.5193228721618652
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.5238606929779053
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.573742389678955
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.7534794807434082
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.9554917812347412
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.5515639781951904
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.3715591430664062
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.4113035202026367
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.4698560237884521
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.459449291229248
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.7615902423858643
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.43971586227417
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.9802358150482178
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 1.9672629833221436
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.4307746887207031
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.5249357223510742
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7227866649627686
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.510791301727295
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 2.1780600547790527
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.3525104522705078
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.7570717334747314
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.3177907466888428
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.4520080089569092
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.5036089420318604
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.7230515480041504
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 440422
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.670851469039917
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.835 Vali Acc: 0.133 Test Loss: 1.835 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.6870336532592773
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.816 Vali Acc: 0.141 Test Loss: 1.816 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 1.5146863460540771
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.800 Vali Acc: 0.152 Test Loss: 1.800 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 1.1492574214935303
Epoch: 4, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.780 Vali Acc: 0.170 Test Loss: 1.780 Test Acc: 0.170
Validation loss decreased (-0.151834 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 1.369753360748291
Epoch: 5, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.755 Vali Acc: 0.178 Test Loss: 1.755 Test Acc: 0.178
Validation loss decreased (-0.170353 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 1.4063560962677002
Epoch: 6, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.725 Vali Acc: 0.215 Test Loss: 1.725 Test Acc: 0.215
Validation loss decreased (-0.177760 --> -0.214798).  Saving model ...
Epoch: 7 cost time: 1.3116118907928467
Epoch: 7, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.692 Vali Acc: 0.256 Test Loss: 1.692 Test Acc: 0.256
Validation loss decreased (-0.214798 --> -0.255539).  Saving model ...
Epoch: 8 cost time: 1.267148733139038
Epoch: 8, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.656 Vali Acc: 0.311 Test Loss: 1.656 Test Acc: 0.311
Validation loss decreased (-0.255539 --> -0.311095).  Saving model ...
Epoch: 9 cost time: 1.243453025817871
Epoch: 9, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.617 Vali Acc: 0.393 Test Loss: 1.617 Test Acc: 0.393
Validation loss decreased (-0.311095 --> -0.392576).  Saving model ...
Epoch: 10 cost time: 1.4803266525268555
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.577 Vali Acc: 0.433 Test Loss: 1.577 Test Acc: 0.433
Validation loss decreased (-0.392576 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 1.3729279041290283
Epoch: 11, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.535 Vali Acc: 0.522 Test Loss: 1.535 Test Acc: 0.522
Validation loss decreased (-0.433318 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 1.4814999103546143
Epoch: 12, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.492 Vali Acc: 0.578 Test Loss: 1.492 Test Acc: 0.578
Validation loss decreased (-0.522207 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 1.400510549545288
Epoch: 13, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.448 Vali Acc: 0.641 Test Loss: 1.448 Test Acc: 0.641
Validation loss decreased (-0.577763 --> -0.640726).  Saving model ...
Epoch: 14 cost time: 1.5441722869873047
Epoch: 14, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.403 Vali Acc: 0.663 Test Loss: 1.403 Test Acc: 0.663
Validation loss decreased (-0.640726 --> -0.662949).  Saving model ...
Epoch: 15 cost time: 1.3305208683013916
Epoch: 15, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.358 Vali Acc: 0.700 Test Loss: 1.358 Test Acc: 0.700
Validation loss decreased (-0.662949 --> -0.699986).  Saving model ...
Epoch: 16 cost time: 1.3991825580596924
Epoch: 16, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.312 Vali Acc: 0.711 Test Loss: 1.312 Test Acc: 0.711
Validation loss decreased (-0.699986 --> -0.711098).  Saving model ...
Epoch: 17 cost time: 1.4680655002593994
Epoch: 17, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.268 Vali Acc: 0.730 Test Loss: 1.268 Test Acc: 0.730
Validation loss decreased (-0.711098 --> -0.729617).  Saving model ...
Epoch: 18 cost time: 1.4884581565856934
Epoch: 18, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.222 Vali Acc: 0.737 Test Loss: 1.222 Test Acc: 0.737
Validation loss decreased (-0.729617 --> -0.737025).  Saving model ...
Epoch: 19 cost time: 1.4177749156951904
Epoch: 19, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.178 Vali Acc: 0.748 Test Loss: 1.178 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
Epoch: 20 cost time: 1.3785638809204102
Epoch: 20, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.135 Vali Acc: 0.748 Test Loss: 1.135 Test Acc: 0.748
Validation loss decreased (-0.748136 --> -0.748137).  Saving model ...
Epoch: 21 cost time: 1.3737099170684814
Epoch: 21, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.091 Vali Acc: 0.756 Test Loss: 1.091 Test Acc: 0.756
Validation loss decreased (-0.748137 --> -0.755545).  Saving model ...
Epoch: 22 cost time: 1.3856642246246338
Epoch: 22, Steps: 2 | Train Loss: 0.816 Vali Loss: 1.050 Vali Acc: 0.756 Test Loss: 1.050 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 23 cost time: 1.4594523906707764
Epoch: 23, Steps: 2 | Train Loss: 0.737 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 24 cost time: 1.424654245376587
Epoch: 24, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.972 Vali Acc: 0.774 Test Loss: 0.972 Test Acc: 0.774
Validation loss decreased (-0.755545 --> -0.774064).  Saving model ...
Epoch: 25 cost time: 1.3134183883666992
Epoch: 25, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.936 Vali Acc: 0.778 Test Loss: 0.936 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 26 cost time: 1.8250195980072021
Epoch: 26, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.901 Vali Acc: 0.785 Test Loss: 0.901 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785176).  Saving model ...
Epoch: 27 cost time: 1.3519234657287598
Epoch: 27, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
Validation loss decreased (-0.785176 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 1.460899829864502
Epoch: 28, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 29 cost time: 1.3003714084625244
Epoch: 29, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.812 Vali Acc: 0.796 Test Loss: 0.812 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.579676866531372
Epoch: 30, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3957445621490479
Epoch: 31, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.322105884552002
Epoch: 32, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.745 Vali Acc: 0.815 Test Loss: 0.745 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814807).  Saving model ...
Epoch: 33 cost time: 1.506943702697754
Epoch: 33, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.727 Vali Acc: 0.822 Test Loss: 0.727 Test Acc: 0.822
Validation loss decreased (-0.814807 --> -0.822215).  Saving model ...
Epoch: 34 cost time: 1.385129451751709
Epoch: 34, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 35 cost time: 1.1681580543518066
Epoch: 35, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 36 cost time: 1.2561798095703125
Epoch: 36, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.684 Vali Acc: 0.826 Test Loss: 0.684 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 37 cost time: 1.307335376739502
Epoch: 37, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.673 Vali Acc: 0.830 Test Loss: 0.673 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 1.3429853916168213
Epoch: 38, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 1.4576992988586426
Epoch: 39, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.533477783203125
Epoch: 40, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 1.3037195205688477
Epoch: 41, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 1.4617524147033691
Epoch: 42, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 43 cost time: 1.33652925491333
Epoch: 43, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 1.3224012851715088
Epoch: 44, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3606016635894775
Epoch: 45, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5090141296386719
Epoch: 46, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3435447216033936
Epoch: 47, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3301715850830078
Epoch: 48, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3461723327636719
Epoch: 49, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3098435401916504
Epoch: 50, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.593 Vali Acc: 0.826 Test Loss: 0.593 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.3609566688537598
Epoch: 51, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.590 Vali Acc: 0.830 Test Loss: 0.590 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3822267055511475
Epoch: 52, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.586 Vali Acc: 0.830 Test Loss: 0.586 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.325774908065796
Epoch: 53, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 54 cost time: 1.4907886981964111
Epoch: 54, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 55 cost time: 1.4308936595916748
Epoch: 55, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 56 cost time: 1.6492562294006348
Epoch: 56, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 57 cost time: 1.898442268371582
Epoch: 57, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.572 Vali Acc: 0.837 Test Loss: 0.572 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837031).  Saving model ...
Epoch: 58 cost time: 1.535604476928711
Epoch: 58, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.6388702392578125
Epoch: 59, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5697548389434814
Epoch: 60, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.754021406173706
Epoch: 61, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.564 Vali Acc: 0.830 Test Loss: 0.564 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.7639284133911133
Epoch: 62, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.562 Vali Acc: 0.830 Test Loss: 0.562 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.4892864227294922
Epoch: 63, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.561 Vali Acc: 0.830 Test Loss: 0.561 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.4888081550598145
Epoch: 64, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.559 Vali Acc: 0.830 Test Loss: 0.559 Test Acc: 0.830
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.6876659393310547
Epoch: 65, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.830 Test Loss: 0.557 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.6741909980773926
Epoch: 66, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.555 Vali Acc: 0.830 Test Loss: 0.555 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.366833209991455
Epoch: 67, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.830 Test Loss: 0.552 Test Acc: 0.830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.6793224811553955
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.873 Vali Acc: 0.111 Test Loss: 1.873 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 1.5401527881622314
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.858 Vali Acc: 0.111 Test Loss: 1.858 Test Acc: 0.111
Validation loss decreased (-0.111092 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 1.3554887771606445
Epoch: 3, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.844 Vali Acc: 0.141 Test Loss: 1.844 Test Acc: 0.141
Validation loss decreased (-0.111093 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 1.412919521331787
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.829 Vali Acc: 0.144 Test Loss: 1.829 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 5 cost time: 1.4119932651519775
Epoch: 5, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.808 Vali Acc: 0.156 Test Loss: 1.808 Test Acc: 0.156
Validation loss decreased (-0.144426 --> -0.155537).  Saving model ...
Epoch: 6 cost time: 1.4413049221038818
Epoch: 6, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.784 Vali Acc: 0.181 Test Loss: 1.784 Test Acc: 0.181
Validation loss decreased (-0.155537 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 1.3658578395843506
Epoch: 7, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.756 Vali Acc: 0.211 Test Loss: 1.756 Test Acc: 0.211
Validation loss decreased (-0.181464 --> -0.211094).  Saving model ...
Epoch: 8 cost time: 1.2914226055145264
Epoch: 8, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.726 Vali Acc: 0.222 Test Loss: 1.726 Test Acc: 0.222
Validation loss decreased (-0.211094 --> -0.222205).  Saving model ...
Epoch: 9 cost time: 1.4930307865142822
Epoch: 9, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.694 Vali Acc: 0.248 Test Loss: 1.694 Test Acc: 0.248
Validation loss decreased (-0.222205 --> -0.248131).  Saving model ...
Epoch: 10 cost time: 1.4320149421691895
Epoch: 10, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.661 Vali Acc: 0.289 Test Loss: 1.661 Test Acc: 0.289
Validation loss decreased (-0.248131 --> -0.288872).  Saving model ...
Epoch: 11 cost time: 1.4572670459747314
Epoch: 11, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.626 Vali Acc: 0.333 Test Loss: 1.626 Test Acc: 0.333
Validation loss decreased (-0.288872 --> -0.333317).  Saving model ...
Epoch: 12 cost time: 1.549422025680542
Epoch: 12, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.591 Vali Acc: 0.378 Test Loss: 1.591 Test Acc: 0.378
Validation loss decreased (-0.333317 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 1.411698579788208
Epoch: 13, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.554 Vali Acc: 0.411 Test Loss: 1.554 Test Acc: 0.411
Validation loss decreased (-0.377762 --> -0.411096).  Saving model ...
Epoch: 14 cost time: 1.2917535305023193
Epoch: 14, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.516 Vali Acc: 0.474 Test Loss: 1.516 Test Acc: 0.474
Validation loss decreased (-0.411096 --> -0.474059).  Saving model ...
Epoch: 15 cost time: 1.5578653812408447
Epoch: 15, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
Validation loss decreased (-0.474059 --> -0.518504).  Saving model ...
Epoch: 16 cost time: 1.4124462604522705
Epoch: 16, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.518504 --> -0.551837).  Saving model ...
Epoch: 17 cost time: 1.4751558303833008
Epoch: 17, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.401 Vali Acc: 0.593 Test Loss: 1.401 Test Acc: 0.593
Validation loss decreased (-0.551837 --> -0.592579).  Saving model ...
Epoch: 18 cost time: 1.5767343044281006
Epoch: 18, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.362 Vali Acc: 0.619 Test Loss: 1.362 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618505).  Saving model ...
Epoch: 19 cost time: 1.4019501209259033
Epoch: 19, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.323 Vali Acc: 0.641 Test Loss: 1.323 Test Acc: 0.641
Validation loss decreased (-0.618505 --> -0.640728).  Saving model ...
Epoch: 20 cost time: 1.4135761260986328
Epoch: 20, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.285 Vali Acc: 0.648 Test Loss: 1.285 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648135).  Saving model ...
Epoch: 21 cost time: 1.3776109218597412
Epoch: 21, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.246 Vali Acc: 0.663 Test Loss: 1.246 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 22 cost time: 1.3535807132720947
Epoch: 22, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.210 Vali Acc: 0.667 Test Loss: 1.210 Test Acc: 0.667
Validation loss decreased (-0.662950 --> -0.666655).  Saving model ...
Epoch: 23 cost time: 1.378211259841919
Epoch: 23, Steps: 2 | Train Loss: 0.831 Vali Loss: 1.175 Vali Acc: 0.689 Test Loss: 1.175 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688877).  Saving model ...
Epoch: 24 cost time: 1.4379286766052246
Epoch: 24, Steps: 2 | Train Loss: 0.816 Vali Loss: 1.141 Vali Acc: 0.704 Test Loss: 1.141 Test Acc: 0.704
Validation loss decreased (-0.688877 --> -0.703692).  Saving model ...
Epoch: 25 cost time: 1.367408037185669
Epoch: 25, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.108 Vali Acc: 0.707 Test Loss: 1.108 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 26 cost time: 1.3344683647155762
Epoch: 26, Steps: 2 | Train Loss: 0.674 Vali Loss: 1.075 Vali Acc: 0.715 Test Loss: 1.075 Test Acc: 0.715
Validation loss decreased (-0.707396 --> -0.714804).  Saving model ...
Epoch: 27 cost time: 1.4021971225738525
Epoch: 27, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.044 Vali Acc: 0.726 Test Loss: 1.044 Test Acc: 0.726
Validation loss decreased (-0.714804 --> -0.725915).  Saving model ...
Epoch: 28 cost time: 1.4782962799072266
Epoch: 28, Steps: 2 | Train Loss: 0.611 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3262169361114502
Epoch: 29, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.986 Vali Acc: 0.726 Test Loss: 0.986 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725916).  Saving model ...
Epoch: 30 cost time: 1.4865562915802002
Epoch: 30, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.960 Vali Acc: 0.730 Test Loss: 0.960 Test Acc: 0.730
Validation loss decreased (-0.725916 --> -0.729620).  Saving model ...
Epoch: 31 cost time: 1.2844057083129883
Epoch: 31, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.937 Vali Acc: 0.741 Test Loss: 0.937 Test Acc: 0.741
Validation loss decreased (-0.729620 --> -0.740731).  Saving model ...
Epoch: 32 cost time: 1.4408037662506104
Epoch: 32, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.916 Vali Acc: 0.744 Test Loss: 0.916 Test Acc: 0.744
Validation loss decreased (-0.740731 --> -0.744435).  Saving model ...
Epoch: 33 cost time: 1.2604222297668457
Epoch: 33, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.897 Vali Acc: 0.737 Test Loss: 0.897 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.505174160003662
Epoch: 34, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.880 Vali Acc: 0.737 Test Loss: 0.880 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2805864810943604
Epoch: 35, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.864 Vali Acc: 0.737 Test Loss: 0.864 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2799072265625
Epoch: 36, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.228966474533081
Epoch: 37, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.837 Vali Acc: 0.730 Test Loss: 0.837 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.652327537536621
Epoch: 38, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.826 Vali Acc: 0.730 Test Loss: 0.826 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3884449005126953
Epoch: 39, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.815 Vali Acc: 0.741 Test Loss: 0.815 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.431182622909546
Epoch: 40, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.807 Vali Acc: 0.737 Test Loss: 0.807 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2952017784118652
Epoch: 41, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.799 Vali Acc: 0.741 Test Loss: 0.799 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5243449211120605
Epoch: 42, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7444444444444445
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.7891845703125
Epoch: 1, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.907 Vali Acc: 0.130 Test Loss: 1.907 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 1.554710865020752
Epoch: 2, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.894 Vali Acc: 0.126 Test Loss: 1.894 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8368444442749023
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.883 Vali Acc: 0.137 Test Loss: 1.883 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137018).  Saving model ...
Epoch: 4 cost time: 1.8095026016235352
Epoch: 4, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.871 Vali Acc: 0.141 Test Loss: 1.871 Test Acc: 0.141
Validation loss decreased (-0.137018 --> -0.140722).  Saving model ...
Epoch: 5 cost time: 1.6705758571624756
Epoch: 5, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.854 Vali Acc: 0.152 Test Loss: 1.854 Test Acc: 0.152
Validation loss decreased (-0.140722 --> -0.151833).  Saving model ...
Epoch: 6 cost time: 1.4924795627593994
Epoch: 6, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.834 Vali Acc: 0.163 Test Loss: 1.834 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162945).  Saving model ...
Epoch: 7 cost time: 1.573099136352539
Epoch: 7, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.812 Vali Acc: 0.178 Test Loss: 1.812 Test Acc: 0.178
Validation loss decreased (-0.162945 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 1.5601296424865723
Epoch: 8, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.788 Vali Acc: 0.193 Test Loss: 1.788 Test Acc: 0.193
Validation loss decreased (-0.177760 --> -0.192575).  Saving model ...
Epoch: 9 cost time: 1.7502896785736084
Epoch: 9, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.762 Vali Acc: 0.204 Test Loss: 1.762 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 10 cost time: 1.5721769332885742
Epoch: 10, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.735 Vali Acc: 0.226 Test Loss: 1.735 Test Acc: 0.226
Validation loss decreased (-0.203686 --> -0.225909).  Saving model ...
Epoch: 11 cost time: 1.7746460437774658
Epoch: 11, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.708 Vali Acc: 0.267 Test Loss: 1.708 Test Acc: 0.267
Validation loss decreased (-0.225909 --> -0.266650).  Saving model ...
Epoch: 12 cost time: 1.5306289196014404
Epoch: 12, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.679 Vali Acc: 0.311 Test Loss: 1.679 Test Acc: 0.311
Validation loss decreased (-0.266650 --> -0.311094).  Saving model ...
Epoch: 13 cost time: 1.5742409229278564
Epoch: 13, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.650 Vali Acc: 0.352 Test Loss: 1.650 Test Acc: 0.352
Validation loss decreased (-0.311094 --> -0.351835).  Saving model ...
Epoch: 14 cost time: 1.6587395668029785
Epoch: 14, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.619 Vali Acc: 0.389 Test Loss: 1.619 Test Acc: 0.389
Validation loss decreased (-0.351835 --> -0.388873).  Saving model ...
Epoch: 15 cost time: 1.3219773769378662
Epoch: 15, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.589 Vali Acc: 0.430 Test Loss: 1.589 Test Acc: 0.430
Validation loss decreased (-0.388873 --> -0.429614).  Saving model ...
Epoch: 16 cost time: 1.4878661632537842
Epoch: 16, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.558 Vali Acc: 0.481 Test Loss: 1.558 Test Acc: 0.481
Validation loss decreased (-0.429614 --> -0.481466).  Saving model ...
Epoch: 17 cost time: 1.499309778213501
Epoch: 17, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.528 Vali Acc: 0.493 Test Loss: 1.528 Test Acc: 0.493
Validation loss decreased (-0.481466 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 1.4095463752746582
Epoch: 18, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.498 Vali Acc: 0.519 Test Loss: 1.498 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518504).  Saving model ...
Epoch: 19 cost time: 1.2098863124847412
Epoch: 19, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.467 Vali Acc: 0.541 Test Loss: 1.467 Test Acc: 0.541
Validation loss decreased (-0.518504 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 1.5523271560668945
Epoch: 20, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.438 Vali Acc: 0.552 Test Loss: 1.438 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551837).  Saving model ...
Epoch: 21 cost time: 1.3155872821807861
Epoch: 21, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.407 Vali Acc: 0.563 Test Loss: 1.407 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562949).  Saving model ...
Epoch: 22 cost time: 1.3310294151306152
Epoch: 22, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.379 Vali Acc: 0.556 Test Loss: 1.379 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.40224289894104
Epoch: 23, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.350 Vali Acc: 0.574 Test Loss: 1.350 Test Acc: 0.574
Validation loss decreased (-0.562949 --> -0.574061).  Saving model ...
Epoch: 24 cost time: 1.4737801551818848
Epoch: 24, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.323 Vali Acc: 0.574 Test Loss: 1.323 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 25 cost time: 1.3333542346954346
Epoch: 25, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.296 Vali Acc: 0.596 Test Loss: 1.296 Test Acc: 0.596
Validation loss decreased (-0.574061 --> -0.596283).  Saving model ...
Epoch: 26 cost time: 1.106140375137329
Epoch: 26, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.269 Vali Acc: 0.604 Test Loss: 1.269 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603691).  Saving model ...
Epoch: 27 cost time: 1.3086481094360352
Epoch: 27, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.243 Vali Acc: 0.611 Test Loss: 1.243 Test Acc: 0.611
Validation loss decreased (-0.603691 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 1.426743507385254
Epoch: 28, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.218 Vali Acc: 0.607 Test Loss: 1.218 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2768001556396484
Epoch: 29, Steps: 2 | Train Loss: 0.674 Vali Loss: 1.194 Vali Acc: 0.615 Test Loss: 1.194 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614803).  Saving model ...
Epoch: 30 cost time: 1.438445806503296
Epoch: 30, Steps: 2 | Train Loss: 0.616 Vali Loss: 1.171 Vali Acc: 0.619 Test Loss: 1.171 Test Acc: 0.619
Validation loss decreased (-0.614803 --> -0.618507).  Saving model ...
Epoch: 31 cost time: 1.59183669090271
Epoch: 31, Steps: 2 | Train Loss: 0.540 Vali Loss: 1.148 Vali Acc: 0.637 Test Loss: 1.148 Test Acc: 0.637
Validation loss decreased (-0.618507 --> -0.637026).  Saving model ...
Epoch: 32 cost time: 1.380002498626709
Epoch: 32, Steps: 2 | Train Loss: 0.527 Vali Loss: 1.128 Vali Acc: 0.641 Test Loss: 1.128 Test Acc: 0.641
Validation loss decreased (-0.637026 --> -0.640729).  Saving model ...
Epoch: 33 cost time: 1.3521974086761475
Epoch: 33, Steps: 2 | Train Loss: 0.509 Vali Loss: 1.109 Vali Acc: 0.648 Test Loss: 1.109 Test Acc: 0.648
Validation loss decreased (-0.640729 --> -0.648137).  Saving model ...
Epoch: 34 cost time: 1.4101097583770752
Epoch: 34, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.092 Vali Acc: 0.656 Test Loss: 1.092 Test Acc: 0.656
Validation loss decreased (-0.648137 --> -0.655545).  Saving model ...
Epoch: 35 cost time: 1.4629597663879395
Epoch: 35, Steps: 2 | Train Loss: 0.430 Vali Loss: 1.075 Vali Acc: 0.659 Test Loss: 1.075 Test Acc: 0.659
Validation loss decreased (-0.655545 --> -0.659249).  Saving model ...
Epoch: 36 cost time: 1.4142735004425049
Epoch: 36, Steps: 2 | Train Loss: 0.425 Vali Loss: 1.060 Vali Acc: 0.659 Test Loss: 1.060 Test Acc: 0.659
Validation loss decreased (-0.659249 --> -0.659249).  Saving model ...
Epoch: 37 cost time: 1.3621511459350586
Epoch: 37, Steps: 2 | Train Loss: 0.362 Vali Loss: 1.047 Vali Acc: 0.674 Test Loss: 1.047 Test Acc: 0.674
Validation loss decreased (-0.659249 --> -0.674064).  Saving model ...
Epoch: 38 cost time: 1.381453514099121
Epoch: 38, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.034 Vali Acc: 0.670 Test Loss: 1.034 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4132378101348877
Epoch: 39, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.022 Vali Acc: 0.670 Test Loss: 1.022 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3523280620574951
Epoch: 40, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.011 Vali Acc: 0.685 Test Loss: 1.011 Test Acc: 0.685
Validation loss decreased (-0.674064 --> -0.685175).  Saving model ...
Epoch: 41 cost time: 1.358142375946045
Epoch: 41, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.000 Vali Acc: 0.689 Test Loss: 1.000 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688879).  Saving model ...
Epoch: 42 cost time: 1.6730201244354248
Epoch: 42, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.991 Vali Acc: 0.693 Test Loss: 0.991 Test Acc: 0.693
Validation loss decreased (-0.688879 --> -0.692583).  Saving model ...
Epoch: 43 cost time: 1.3871550559997559
Epoch: 43, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.982 Vali Acc: 0.704 Test Loss: 0.982 Test Acc: 0.704
Validation loss decreased (-0.692583 --> -0.703694).  Saving model ...
Epoch: 44 cost time: 1.6188910007476807
Epoch: 44, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.975 Vali Acc: 0.704 Test Loss: 0.975 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 45 cost time: 1.489386796951294
Epoch: 45, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.967 Vali Acc: 0.700 Test Loss: 0.967 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5712306499481201
Epoch: 46, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5060532093048096
Epoch: 47, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5548925399780273
Epoch: 48, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3606021404266357
Epoch: 49, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3735806941986084
Epoch: 50, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.5057485103607178
Epoch: 51, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.929 Vali Acc: 0.704 Test Loss: 0.929 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 52 cost time: 1.4127132892608643
Epoch: 52, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.924 Vali Acc: 0.707 Test Loss: 0.924 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 53 cost time: 1.3528800010681152
Epoch: 53, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.919 Vali Acc: 0.707 Test Loss: 0.919 Test Acc: 0.707
Validation loss decreased (-0.707398 --> -0.707398).  Saving model ...
Epoch: 54 cost time: 1.484025478363037
Epoch: 54, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.914 Vali Acc: 0.715 Test Loss: 0.914 Test Acc: 0.715
Validation loss decreased (-0.707398 --> -0.714806).  Saving model ...
Epoch: 55 cost time: 1.387549877166748
Epoch: 55, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.910 Vali Acc: 0.707 Test Loss: 0.910 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.7145459651947021
Epoch: 56, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.906 Vali Acc: 0.707 Test Loss: 0.906 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.817793846130371
Epoch: 57, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.902 Vali Acc: 0.707 Test Loss: 0.902 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.5944383144378662
Epoch: 58, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.898 Vali Acc: 0.711 Test Loss: 0.898 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.565793514251709
Epoch: 59, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.6405494213104248
Epoch: 60, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.891 Vali Acc: 0.707 Test Loss: 0.891 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.5070860385894775
Epoch: 61, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.889 Vali Acc: 0.707 Test Loss: 0.889 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.682915210723877
Epoch: 62, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.886 Vali Acc: 0.711 Test Loss: 0.886 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.547680139541626
Epoch: 63, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.883 Vali Acc: 0.715 Test Loss: 0.883 Test Acc: 0.715
Validation loss decreased (-0.714806 --> -0.714806).  Saving model ...
Epoch: 64 cost time: 1.4046742916107178
Epoch: 64, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.880 Vali Acc: 0.719 Test Loss: 0.880 Test Acc: 0.719
Validation loss decreased (-0.714806 --> -0.718510).  Saving model ...
Epoch: 65 cost time: 1.7503459453582764
Epoch: 65, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.877 Vali Acc: 0.719 Test Loss: 0.877 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 66 cost time: 1.5459680557250977
Epoch: 66, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.874 Vali Acc: 0.719 Test Loss: 0.874 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 67 cost time: 1.4384691715240479
Epoch: 67, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.871 Vali Acc: 0.719 Test Loss: 0.871 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 68 cost time: 1.4089019298553467
Epoch: 68, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.868 Vali Acc: 0.719 Test Loss: 0.868 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 69 cost time: 1.4254767894744873
Epoch: 69, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.864 Vali Acc: 0.726 Test Loss: 0.864 Test Acc: 0.726
Validation loss decreased (-0.718510 --> -0.725917).  Saving model ...
Epoch: 70 cost time: 1.361295223236084
Epoch: 70, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.861 Vali Acc: 0.726 Test Loss: 0.861 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 71 cost time: 1.4613895416259766
Epoch: 71, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.859 Vali Acc: 0.730 Test Loss: 0.859 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 72 cost time: 1.6342711448669434
Epoch: 72, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.856 Vali Acc: 0.726 Test Loss: 0.856 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.7311534881591797
Epoch: 73, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.853 Vali Acc: 0.730 Test Loss: 0.853 Test Acc: 0.730
Validation loss decreased (-0.729621 --> -0.729621).  Saving model ...
Epoch: 74 cost time: 1.6059002876281738
Epoch: 74, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.850 Vali Acc: 0.733 Test Loss: 0.850 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 75 cost time: 1.3194844722747803
Epoch: 75, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.847 Vali Acc: 0.733 Test Loss: 0.847 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 76 cost time: 1.8760194778442383
Epoch: 76, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 77 cost time: 1.3138210773468018
Epoch: 77, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.840 Vali Acc: 0.733 Test Loss: 0.840 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 78 cost time: 1.686455488204956
Epoch: 78, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 79 cost time: 1.4267327785491943
Epoch: 79, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.832 Vali Acc: 0.737 Test Loss: 0.832 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 80 cost time: 1.7264306545257568
Epoch: 80, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.829 Vali Acc: 0.737 Test Loss: 0.829 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 81 cost time: 1.6305453777313232
Epoch: 81, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.825 Vali Acc: 0.741 Test Loss: 0.825 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740732).  Saving model ...
Epoch: 82 cost time: 1.2886760234832764
Epoch: 82, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.822 Vali Acc: 0.741 Test Loss: 0.822 Test Acc: 0.741
Validation loss decreased (-0.740732 --> -0.740733).  Saving model ...
Epoch: 83 cost time: 1.5462086200714111
Epoch: 83, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.819 Vali Acc: 0.741 Test Loss: 0.819 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 84 cost time: 1.6592676639556885
Epoch: 84, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.816 Vali Acc: 0.741 Test Loss: 0.816 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 85 cost time: 1.4630393981933594
Epoch: 85, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.814 Vali Acc: 0.741 Test Loss: 0.814 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 86 cost time: 1.3963406085968018
Epoch: 86, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744436).  Saving model ...
Epoch: 87 cost time: 1.6811130046844482
Epoch: 87, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 88 cost time: 1.770467758178711
Epoch: 88, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 89 cost time: 1.5141828060150146
Epoch: 89, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.804 Vali Acc: 0.744 Test Loss: 0.804 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 90 cost time: 1.652479648590088
Epoch: 90, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 91 cost time: 1.5761077404022217
Epoch: 91, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.797 Vali Acc: 0.744 Test Loss: 0.797 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 92 cost time: 1.63450288772583
Epoch: 92, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.794 Vali Acc: 0.744 Test Loss: 0.794 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 93 cost time: 1.4902057647705078
Epoch: 93, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.791 Vali Acc: 0.744 Test Loss: 0.791 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 94 cost time: 1.5698707103729248
Epoch: 94, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 95 cost time: 1.5647168159484863
Epoch: 95, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.784 Vali Acc: 0.748 Test Loss: 0.784 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 96 cost time: 1.407320261001587
Epoch: 96, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.781 Vali Acc: 0.748 Test Loss: 0.781 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 97 cost time: 1.3479030132293701
Epoch: 97, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.778 Vali Acc: 0.748 Test Loss: 0.778 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 98 cost time: 1.5044097900390625
Epoch: 98, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.774 Vali Acc: 0.748 Test Loss: 0.774 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 99 cost time: 1.4566338062286377
Epoch: 99, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.771 Vali Acc: 0.748 Test Loss: 0.771 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 100 cost time: 1.3277359008789062
Epoch: 100, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.768 Vali Acc: 0.752 Test Loss: 0.768 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7518518518518519
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.458700180053711
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.895 Vali Acc: 0.137 Test Loss: 1.895 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 1.156785249710083
Epoch: 2, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.886 Vali Acc: 0.137 Test Loss: 1.886 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 1.234898567199707
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.879 Vali Acc: 0.144 Test Loss: 1.879 Test Acc: 0.144
Validation loss decreased (-0.137018 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.4951748847961426
Epoch: 4, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.870 Vali Acc: 0.144 Test Loss: 1.870 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 5 cost time: 1.4477238655090332
Epoch: 5, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.859 Vali Acc: 0.163 Test Loss: 1.859 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162944).  Saving model ...
Epoch: 6 cost time: 1.2819783687591553
Epoch: 6, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.845 Vali Acc: 0.170 Test Loss: 1.845 Test Acc: 0.170
Validation loss decreased (-0.162944 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 1.4507653713226318
Epoch: 7, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.830 Vali Acc: 0.174 Test Loss: 1.830 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 8 cost time: 1.4540300369262695
Epoch: 8, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.813 Vali Acc: 0.189 Test Loss: 1.813 Test Acc: 0.189
Validation loss decreased (-0.174056 --> -0.188871).  Saving model ...
Epoch: 9 cost time: 1.3632218837738037
Epoch: 9, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.796 Vali Acc: 0.200 Test Loss: 1.796 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 10 cost time: 1.4840247631072998
Epoch: 10, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.776 Vali Acc: 0.219 Test Loss: 1.776 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218501).  Saving model ...
Epoch: 11 cost time: 1.400334358215332
Epoch: 11, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.757 Vali Acc: 0.244 Test Loss: 1.757 Test Acc: 0.244
Validation loss decreased (-0.218501 --> -0.244427).  Saving model ...
Epoch: 12 cost time: 1.6215291023254395
Epoch: 12, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.737 Vali Acc: 0.278 Test Loss: 1.737 Test Acc: 0.278
Validation loss decreased (-0.244427 --> -0.277760).  Saving model ...
Epoch: 13 cost time: 1.193955659866333
Epoch: 13, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.716 Vali Acc: 0.293 Test Loss: 1.716 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 14 cost time: 1.3507359027862549
Epoch: 14, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.694 Vali Acc: 0.330 Test Loss: 1.694 Test Acc: 0.330
Validation loss decreased (-0.292575 --> -0.329613).  Saving model ...
Epoch: 15 cost time: 1.6222724914550781
Epoch: 15, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.672 Vali Acc: 0.404 Test Loss: 1.672 Test Acc: 0.404
Validation loss decreased (-0.329613 --> -0.403687).  Saving model ...
Epoch: 16 cost time: 1.4306244850158691
Epoch: 16, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.650 Vali Acc: 0.430 Test Loss: 1.650 Test Acc: 0.430
Validation loss decreased (-0.403687 --> -0.429613).  Saving model ...
Epoch: 17 cost time: 1.4164984226226807
Epoch: 17, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.629 Vali Acc: 0.426 Test Loss: 1.629 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3468539714813232
Epoch: 18, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.607 Vali Acc: 0.448 Test Loss: 1.607 Test Acc: 0.448
Validation loss decreased (-0.429613 --> -0.448132).  Saving model ...
Epoch: 19 cost time: 1.392857313156128
Epoch: 19, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.586 Vali Acc: 0.470 Test Loss: 1.586 Test Acc: 0.470
Validation loss decreased (-0.448132 --> -0.470355).  Saving model ...
Epoch: 20 cost time: 1.6191964149475098
Epoch: 20, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.564 Vali Acc: 0.481 Test Loss: 1.564 Test Acc: 0.481
Validation loss decreased (-0.470355 --> -0.481466).  Saving model ...
Epoch: 21 cost time: 1.5852084159851074
Epoch: 21, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.543 Vali Acc: 0.489 Test Loss: 1.543 Test Acc: 0.489
Validation loss decreased (-0.481466 --> -0.488873).  Saving model ...
Epoch: 22 cost time: 1.3887240886688232
Epoch: 22, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.523 Vali Acc: 0.504 Test Loss: 1.523 Test Acc: 0.504
Validation loss decreased (-0.488873 --> -0.503688).  Saving model ...
Epoch: 23 cost time: 1.4270873069763184
Epoch: 23, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.502 Vali Acc: 0.496 Test Loss: 1.502 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3742220401763916
Epoch: 24, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.482 Vali Acc: 0.496 Test Loss: 1.482 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.512592077255249
Epoch: 25, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
Validation loss decreased (-0.503688 --> -0.511096).  Saving model ...
Epoch: 26 cost time: 1.482375144958496
Epoch: 26, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.442 Vali Acc: 0.515 Test Loss: 1.442 Test Acc: 0.515
Validation loss decreased (-0.511096 --> -0.514800).  Saving model ...
Epoch: 27 cost time: 1.2158472537994385
Epoch: 27, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.423 Vali Acc: 0.526 Test Loss: 1.423 Test Acc: 0.526
Validation loss decreased (-0.514800 --> -0.525912).  Saving model ...
Epoch: 28 cost time: 1.4139971733093262
Epoch: 28, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.404 Vali Acc: 0.526 Test Loss: 1.404 Test Acc: 0.526
Validation loss decreased (-0.525912 --> -0.525912).  Saving model ...
Epoch: 29 cost time: 1.2541391849517822
Epoch: 29, Steps: 2 | Train Loss: 0.889 Vali Loss: 1.386 Vali Acc: 0.530 Test Loss: 1.386 Test Acc: 0.530
Validation loss decreased (-0.525912 --> -0.529616).  Saving model ...
Epoch: 30 cost time: 1.2355294227600098
Epoch: 30, Steps: 2 | Train Loss: 0.853 Vali Loss: 1.369 Vali Acc: 0.537 Test Loss: 1.369 Test Acc: 0.537
Validation loss decreased (-0.529616 --> -0.537023).  Saving model ...
Epoch: 31 cost time: 1.357776165008545
Epoch: 31, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.352 Vali Acc: 0.548 Test Loss: 1.352 Test Acc: 0.548
Validation loss decreased (-0.537023 --> -0.548135).  Saving model ...
Epoch: 32 cost time: 1.297675609588623
Epoch: 32, Steps: 2 | Train Loss: 0.778 Vali Loss: 1.335 Vali Acc: 0.559 Test Loss: 1.335 Test Acc: 0.559
Validation loss decreased (-0.548135 --> -0.559246).  Saving model ...
Epoch: 33 cost time: 1.3184535503387451
Epoch: 33, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.319 Vali Acc: 0.563 Test Loss: 1.319 Test Acc: 0.563
Validation loss decreased (-0.559246 --> -0.562950).  Saving model ...
Epoch: 34 cost time: 1.2900245189666748
Epoch: 34, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.304 Vali Acc: 0.563 Test Loss: 1.304 Test Acc: 0.563
Validation loss decreased (-0.562950 --> -0.562950).  Saving model ...
Epoch: 35 cost time: 1.2956175804138184
Epoch: 35, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.290 Vali Acc: 0.567 Test Loss: 1.290 Test Acc: 0.567
Validation loss decreased (-0.562950 --> -0.566654).  Saving model ...
Epoch: 36 cost time: 1.4748265743255615
Epoch: 36, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.276 Vali Acc: 0.570 Test Loss: 1.276 Test Acc: 0.570
Validation loss decreased (-0.566654 --> -0.570358).  Saving model ...
Epoch: 37 cost time: 1.4180843830108643
Epoch: 37, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.264 Vali Acc: 0.567 Test Loss: 1.264 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3481323719024658
Epoch: 38, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.252 Vali Acc: 0.563 Test Loss: 1.252 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5759260654449463
Epoch: 39, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.240 Vali Acc: 0.567 Test Loss: 1.240 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.323338270187378
Epoch: 40, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
Validation loss decreased (-0.570358 --> -0.570358).  Saving model ...
Epoch: 41 cost time: 1.2517914772033691
Epoch: 41, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.218 Vali Acc: 0.574 Test Loss: 1.218 Test Acc: 0.574
Validation loss decreased (-0.570358 --> -0.574062).  Saving model ...
Epoch: 42 cost time: 1.3125431537628174
Epoch: 42, Steps: 2 | Train Loss: 0.428 Vali Loss: 1.208 Vali Acc: 0.574 Test Loss: 1.208 Test Acc: 0.574
Validation loss decreased (-0.574062 --> -0.574062).  Saving model ...
Epoch: 43 cost time: 1.321321964263916
Epoch: 43, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.198 Vali Acc: 0.570 Test Loss: 1.198 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2375311851501465
Epoch: 44, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.189 Vali Acc: 0.581 Test Loss: 1.189 Test Acc: 0.581
Validation loss decreased (-0.574062 --> -0.581470).  Saving model ...
Epoch: 45 cost time: 1.3484079837799072
Epoch: 45, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.177 Vali Acc: 0.581 Test Loss: 1.177 Test Acc: 0.581
Validation loss decreased (-0.581470 --> -0.581470).  Saving model ...
Epoch: 46 cost time: 1.1139061450958252
Epoch: 46, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.166 Vali Acc: 0.581 Test Loss: 1.166 Test Acc: 0.581
Validation loss decreased (-0.581470 --> -0.581470).  Saving model ...
Epoch: 47 cost time: 1.1995859146118164
Epoch: 47, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.155 Vali Acc: 0.585 Test Loss: 1.155 Test Acc: 0.585
Validation loss decreased (-0.581470 --> -0.585174).  Saving model ...
Epoch: 48 cost time: 1.1742582321166992
Epoch: 48, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.146 Vali Acc: 0.589 Test Loss: 1.146 Test Acc: 0.589
Validation loss decreased (-0.585174 --> -0.588877).  Saving model ...
Epoch: 49 cost time: 1.0849287509918213
Epoch: 49, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.137 Vali Acc: 0.593 Test Loss: 1.137 Test Acc: 0.593
Validation loss decreased (-0.588877 --> -0.592581).  Saving model ...
Epoch: 50 cost time: 1.2171499729156494
Epoch: 50, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.129 Vali Acc: 0.593 Test Loss: 1.129 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 51 cost time: 1.2125165462493896
Epoch: 51, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.121 Vali Acc: 0.593 Test Loss: 1.121 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 52 cost time: 1.250819444656372
Epoch: 52, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.113 Vali Acc: 0.593 Test Loss: 1.113 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 53 cost time: 1.2756004333496094
Epoch: 53, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.105 Vali Acc: 0.593 Test Loss: 1.105 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592582).  Saving model ...
Epoch: 54 cost time: 1.26678466796875
Epoch: 54, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.592582 --> -0.599989).  Saving model ...
Epoch: 55 cost time: 1.2454800605773926
Epoch: 55, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.088 Vali Acc: 0.604 Test Loss: 1.088 Test Acc: 0.604
Validation loss decreased (-0.599989 --> -0.603693).  Saving model ...
Epoch: 56 cost time: 1.272723913192749
Epoch: 56, Steps: 2 | Train Loss: 0.184 Vali Loss: 1.080 Vali Acc: 0.611 Test Loss: 1.080 Test Acc: 0.611
Validation loss decreased (-0.603693 --> -0.611100).  Saving model ...
Epoch: 57 cost time: 1.36161470413208
Epoch: 57, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.073 Vali Acc: 0.615 Test Loss: 1.073 Test Acc: 0.615
Validation loss decreased (-0.611100 --> -0.614804).  Saving model ...
Epoch: 58 cost time: 1.3974616527557373
Epoch: 58, Steps: 2 | Train Loss: 0.172 Vali Loss: 1.066 Vali Acc: 0.619 Test Loss: 1.066 Test Acc: 0.619
Validation loss decreased (-0.614804 --> -0.618508).  Saving model ...
Epoch: 59 cost time: 1.2360775470733643
Epoch: 59, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.060 Vali Acc: 0.619 Test Loss: 1.060 Test Acc: 0.619
Validation loss decreased (-0.618508 --> -0.618508).  Saving model ...
Epoch: 60 cost time: 1.3699097633361816
Epoch: 60, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.053 Vali Acc: 0.622 Test Loss: 1.053 Test Acc: 0.622
Validation loss decreased (-0.618508 --> -0.622212).  Saving model ...
Epoch: 61 cost time: 1.1433441638946533
Epoch: 61, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.047 Vali Acc: 0.626 Test Loss: 1.047 Test Acc: 0.626
Validation loss decreased (-0.622212 --> -0.625915).  Saving model ...
Epoch: 62 cost time: 1.194437026977539
Epoch: 62, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.039 Vali Acc: 0.630 Test Loss: 1.039 Test Acc: 0.630
Validation loss decreased (-0.625915 --> -0.629619).  Saving model ...
Epoch: 63 cost time: 1.2266156673431396
Epoch: 63, Steps: 2 | Train Loss: 0.119 Vali Loss: 1.033 Vali Acc: 0.630 Test Loss: 1.033 Test Acc: 0.630
Validation loss decreased (-0.629619 --> -0.629619).  Saving model ...
Epoch: 64 cost time: 1.2531309127807617
Epoch: 64, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.026 Vali Acc: 0.630 Test Loss: 1.026 Test Acc: 0.630
Validation loss decreased (-0.629619 --> -0.629619).  Saving model ...
Epoch: 65 cost time: 1.2573215961456299
Epoch: 65, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.019 Vali Acc: 0.630 Test Loss: 1.019 Test Acc: 0.630
Validation loss decreased (-0.629619 --> -0.629619).  Saving model ...
Epoch: 66 cost time: 1.1858291625976562
Epoch: 66, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.012 Vali Acc: 0.630 Test Loss: 1.012 Test Acc: 0.630
Validation loss decreased (-0.629619 --> -0.629620).  Saving model ...
Epoch: 67 cost time: 1.2995688915252686
Epoch: 67, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.005 Vali Acc: 0.633 Test Loss: 1.005 Test Acc: 0.633
Validation loss decreased (-0.629620 --> -0.633323).  Saving model ...
Epoch: 68 cost time: 1.2588839530944824
Epoch: 68, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.998 Vali Acc: 0.633 Test Loss: 0.998 Test Acc: 0.633
Validation loss decreased (-0.633323 --> -0.633323).  Saving model ...
Epoch: 69 cost time: 1.241466760635376
Epoch: 69, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.992 Vali Acc: 0.633 Test Loss: 0.992 Test Acc: 0.633
Validation loss decreased (-0.633323 --> -0.633323).  Saving model ...
Epoch: 70 cost time: 1.3060624599456787
Epoch: 70, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.985 Vali Acc: 0.633 Test Loss: 0.985 Test Acc: 0.633
Validation loss decreased (-0.633323 --> -0.633323).  Saving model ...
Epoch: 71 cost time: 1.3499016761779785
Epoch: 71, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.978 Vali Acc: 0.637 Test Loss: 0.978 Test Acc: 0.637
Validation loss decreased (-0.633323 --> -0.637027).  Saving model ...
Epoch: 72 cost time: 1.3880267143249512
Epoch: 72, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.971 Vali Acc: 0.637 Test Loss: 0.971 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 73 cost time: 1.3028194904327393
Epoch: 73, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.964 Vali Acc: 0.637 Test Loss: 0.964 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 74 cost time: 1.4329073429107666
Epoch: 74, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.958 Vali Acc: 0.637 Test Loss: 0.958 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 75 cost time: 1.3266499042510986
Epoch: 75, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.951 Vali Acc: 0.641 Test Loss: 0.951 Test Acc: 0.641
Validation loss decreased (-0.637027 --> -0.640731).  Saving model ...
Epoch: 76 cost time: 1.1470162868499756
Epoch: 76, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.944 Vali Acc: 0.644 Test Loss: 0.944 Test Acc: 0.644
Validation loss decreased (-0.640731 --> -0.644435).  Saving model ...
Epoch: 77 cost time: 1.2477517127990723
Epoch: 77, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.937 Vali Acc: 0.648 Test Loss: 0.937 Test Acc: 0.648
Validation loss decreased (-0.644435 --> -0.648139).  Saving model ...
Epoch: 78 cost time: 1.333841323852539
Epoch: 78, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.930 Vali Acc: 0.659 Test Loss: 0.930 Test Acc: 0.659
Validation loss decreased (-0.648139 --> -0.659250).  Saving model ...
Epoch: 79 cost time: 1.2771151065826416
Epoch: 79, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.923 Vali Acc: 0.667 Test Loss: 0.923 Test Acc: 0.667
Validation loss decreased (-0.659250 --> -0.666657).  Saving model ...
Epoch: 80 cost time: 1.272510290145874
Epoch: 80, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.915 Vali Acc: 0.674 Test Loss: 0.915 Test Acc: 0.674
Validation loss decreased (-0.666657 --> -0.674065).  Saving model ...
Epoch: 81 cost time: 1.1591339111328125
Epoch: 81, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.907 Vali Acc: 0.674 Test Loss: 0.907 Test Acc: 0.674
Validation loss decreased (-0.674065 --> -0.674065).  Saving model ...
Epoch: 82 cost time: 1.2526969909667969
Epoch: 82, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.899 Vali Acc: 0.674 Test Loss: 0.899 Test Acc: 0.674
Validation loss decreased (-0.674065 --> -0.674065).  Saving model ...
Epoch: 83 cost time: 1.190242052078247
Epoch: 83, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.892 Vali Acc: 0.678 Test Loss: 0.892 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 84 cost time: 1.3569777011871338
Epoch: 84, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.885 Vali Acc: 0.678 Test Loss: 0.885 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 85 cost time: 1.3140249252319336
Epoch: 85, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.878 Vali Acc: 0.681 Test Loss: 0.878 Test Acc: 0.681
Validation loss decreased (-0.677769 --> -0.681473).  Saving model ...
Epoch: 86 cost time: 1.3254296779632568
Epoch: 86, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.871 Vali Acc: 0.685 Test Loss: 0.871 Test Acc: 0.685
Validation loss decreased (-0.681473 --> -0.685176).  Saving model ...
Epoch: 87 cost time: 1.2327024936676025
Epoch: 87, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.865 Vali Acc: 0.689 Test Loss: 0.865 Test Acc: 0.689
Validation loss decreased (-0.685176 --> -0.688880).  Saving model ...
Epoch: 88 cost time: 1.3710687160491943
Epoch: 88, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.859 Vali Acc: 0.693 Test Loss: 0.859 Test Acc: 0.693
Validation loss decreased (-0.688880 --> -0.692584).  Saving model ...
Epoch: 89 cost time: 1.1437156200408936
Epoch: 89, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.854 Vali Acc: 0.696 Test Loss: 0.854 Test Acc: 0.696
Validation loss decreased (-0.692584 --> -0.696288).  Saving model ...
Epoch: 90 cost time: 1.1895010471343994
Epoch: 90, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.848 Vali Acc: 0.704 Test Loss: 0.848 Test Acc: 0.704
Validation loss decreased (-0.696288 --> -0.703695).  Saving model ...
Epoch: 91 cost time: 1.1705293655395508
Epoch: 91, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.844 Vali Acc: 0.700 Test Loss: 0.844 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.2332477569580078
Epoch: 92, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.2173826694488525
Epoch: 93, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.835 Vali Acc: 0.700 Test Loss: 0.835 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.2096154689788818
Epoch: 94, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.830 Vali Acc: 0.700 Test Loss: 0.830 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.145043134689331
Epoch: 95, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.826 Vali Acc: 0.704 Test Loss: 0.826 Test Acc: 0.704
Validation loss decreased (-0.703695 --> -0.703695).  Saving model ...
Epoch: 96 cost time: 1.2224125862121582
Epoch: 96, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.822 Vali Acc: 0.707 Test Loss: 0.822 Test Acc: 0.707
Validation loss decreased (-0.703695 --> -0.707399).  Saving model ...
Epoch: 97 cost time: 1.4392318725585938
Epoch: 97, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.818 Vali Acc: 0.707 Test Loss: 0.818 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 98 cost time: 1.368236780166626
Epoch: 98, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.707399 --> -0.711103).  Saving model ...
Epoch: 99 cost time: 1.3833653926849365
Epoch: 99, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 100 cost time: 1.3631579875946045
Epoch: 100, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.806 Vali Acc: 0.711 Test Loss: 0.806 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7111111111111111
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.845114231109619
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.844 Vali Acc: 0.207 Test Loss: 1.844 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 1.0870826244354248
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.838 Vali Acc: 0.207 Test Loss: 1.838 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 1.3179712295532227
Epoch: 3, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.832 Vali Acc: 0.215 Test Loss: 1.832 Test Acc: 0.215
Validation loss decreased (-0.207389 --> -0.214796).  Saving model ...
Epoch: 4 cost time: 1.142061710357666
Epoch: 4, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.826 Vali Acc: 0.226 Test Loss: 1.826 Test Acc: 0.226
Validation loss decreased (-0.214796 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 1.1564035415649414
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.818 Vali Acc: 0.226 Test Loss: 1.818 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 1.0843007564544678
Epoch: 6, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.808 Vali Acc: 0.226 Test Loss: 1.808 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 1.1219167709350586
Epoch: 7, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.797 Vali Acc: 0.237 Test Loss: 1.797 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237019).  Saving model ...
Epoch: 8 cost time: 1.168907880783081
Epoch: 8, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.785 Vali Acc: 0.252 Test Loss: 1.785 Test Acc: 0.252
Validation loss decreased (-0.237019 --> -0.251834).  Saving model ...
Epoch: 9 cost time: 1.2921769618988037
Epoch: 9, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.772 Vali Acc: 0.256 Test Loss: 1.772 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 1.139108419418335
Epoch: 10, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.759 Vali Acc: 0.267 Test Loss: 1.759 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 11 cost time: 1.1621782779693604
Epoch: 11, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.746 Vali Acc: 0.270 Test Loss: 1.746 Test Acc: 0.270
Validation loss decreased (-0.266649 --> -0.270353).  Saving model ...
Epoch: 12 cost time: 1.191227912902832
Epoch: 12, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.731 Vali Acc: 0.274 Test Loss: 1.731 Test Acc: 0.274
Validation loss decreased (-0.270353 --> -0.274057).  Saving model ...
Epoch: 13 cost time: 1.112931489944458
Epoch: 13, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.716 Vali Acc: 0.289 Test Loss: 1.716 Test Acc: 0.289
Validation loss decreased (-0.274057 --> -0.288872).  Saving model ...
Epoch: 14 cost time: 1.1159677505493164
Epoch: 14, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.700 Vali Acc: 0.311 Test Loss: 1.700 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311094).  Saving model ...
Epoch: 15 cost time: 1.3651204109191895
Epoch: 15, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.684 Vali Acc: 0.330 Test Loss: 1.684 Test Acc: 0.330
Validation loss decreased (-0.311094 --> -0.329613).  Saving model ...
Epoch: 16 cost time: 1.1927714347839355
Epoch: 16, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.667 Vali Acc: 0.348 Test Loss: 1.667 Test Acc: 0.348
Validation loss decreased (-0.329613 --> -0.348131).  Saving model ...
Epoch: 17 cost time: 1.1776525974273682
Epoch: 17, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.651 Vali Acc: 0.367 Test Loss: 1.651 Test Acc: 0.367
Validation loss decreased (-0.348131 --> -0.366650).  Saving model ...
Epoch: 18 cost time: 1.210845708847046
Epoch: 18, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.634 Vali Acc: 0.411 Test Loss: 1.634 Test Acc: 0.411
Validation loss decreased (-0.366650 --> -0.411095).  Saving model ...
Epoch: 19 cost time: 1.0862390995025635
Epoch: 19, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.618 Vali Acc: 0.433 Test Loss: 1.618 Test Acc: 0.433
Validation loss decreased (-0.411095 --> -0.433317).  Saving model ...
Epoch: 20 cost time: 0.9996466636657715
Epoch: 20, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.601 Vali Acc: 0.444 Test Loss: 1.601 Test Acc: 0.444
Validation loss decreased (-0.433317 --> -0.444428).  Saving model ...
Epoch: 21 cost time: 1.1170008182525635
Epoch: 21, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.585 Vali Acc: 0.470 Test Loss: 1.585 Test Acc: 0.470
Validation loss decreased (-0.444428 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 1.1143016815185547
Epoch: 22, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.568 Vali Acc: 0.496 Test Loss: 1.568 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496281).  Saving model ...
Epoch: 23 cost time: 1.1438467502593994
Epoch: 23, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.552 Vali Acc: 0.507 Test Loss: 1.552 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 24 cost time: 1.2469356060028076
Epoch: 24, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.535 Vali Acc: 0.522 Test Loss: 1.535 Test Acc: 0.522
Validation loss decreased (-0.507392 --> -0.522207).  Saving model ...
Epoch: 25 cost time: 1.2983624935150146
Epoch: 25, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.518 Vali Acc: 0.526 Test Loss: 1.518 Test Acc: 0.526
Validation loss decreased (-0.522207 --> -0.525911).  Saving model ...
Epoch: 26 cost time: 1.142031192779541
Epoch: 26, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.501 Vali Acc: 0.537 Test Loss: 1.501 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 27 cost time: 1.1906442642211914
Epoch: 27, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.484 Vali Acc: 0.533 Test Loss: 1.484 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2163524627685547
Epoch: 28, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.467 Vali Acc: 0.552 Test Loss: 1.467 Test Acc: 0.552
Validation loss decreased (-0.537022 --> -0.551837).  Saving model ...
Epoch: 29 cost time: 1.2297029495239258
Epoch: 29, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.450 Vali Acc: 0.570 Test Loss: 1.450 Test Acc: 0.570
Validation loss decreased (-0.551837 --> -0.570356).  Saving model ...
Epoch: 30 cost time: 1.0909984111785889
Epoch: 30, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.433 Vali Acc: 0.574 Test Loss: 1.433 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 31 cost time: 1.1602027416229248
Epoch: 31, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.417 Vali Acc: 0.578 Test Loss: 1.417 Test Acc: 0.578
Validation loss decreased (-0.574060 --> -0.577764).  Saving model ...
Epoch: 32 cost time: 1.2518255710601807
Epoch: 32, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.401 Vali Acc: 0.581 Test Loss: 1.401 Test Acc: 0.581
Validation loss decreased (-0.577764 --> -0.581467).  Saving model ...
Epoch: 33 cost time: 1.1557042598724365
Epoch: 33, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.384 Vali Acc: 0.581 Test Loss: 1.384 Test Acc: 0.581
Validation loss decreased (-0.581467 --> -0.581468).  Saving model ...
Epoch: 34 cost time: 1.06074857711792
Epoch: 34, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.368 Vali Acc: 0.581 Test Loss: 1.368 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 35 cost time: 1.1330375671386719
Epoch: 35, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.581468 --> -0.588875).  Saving model ...
Epoch: 36 cost time: 1.1135811805725098
Epoch: 36, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.334 Vali Acc: 0.593 Test Loss: 1.334 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592579).  Saving model ...
Epoch: 37 cost time: 1.051966667175293
Epoch: 37, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.317 Vali Acc: 0.596 Test Loss: 1.317 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 38 cost time: 1.319732904434204
Epoch: 38, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.300 Vali Acc: 0.615 Test Loss: 1.300 Test Acc: 0.615
Validation loss decreased (-0.596283 --> -0.614802).  Saving model ...
Epoch: 39 cost time: 1.1595017910003662
Epoch: 39, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.283 Vali Acc: 0.630 Test Loss: 1.283 Test Acc: 0.630
Validation loss decreased (-0.614802 --> -0.629617).  Saving model ...
Epoch: 40 cost time: 1.23581862449646
Epoch: 40, Steps: 2 | Train Loss: 0.781 Vali Loss: 1.266 Vali Acc: 0.630 Test Loss: 1.266 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 41 cost time: 1.29917311668396
Epoch: 41, Steps: 2 | Train Loss: 0.755 Vali Loss: 1.248 Vali Acc: 0.630 Test Loss: 1.248 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 42 cost time: 1.0795843601226807
Epoch: 42, Steps: 2 | Train Loss: 0.740 Vali Loss: 1.231 Vali Acc: 0.630 Test Loss: 1.231 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 43 cost time: 1.1344404220581055
Epoch: 43, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.213 Vali Acc: 0.622 Test Loss: 1.213 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1141271591186523
Epoch: 44, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.196 Vali Acc: 0.637 Test Loss: 1.196 Test Acc: 0.637
Validation loss decreased (-0.629617 --> -0.637025).  Saving model ...
Epoch: 45 cost time: 1.2099628448486328
Epoch: 45, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.178 Vali Acc: 0.641 Test Loss: 1.178 Test Acc: 0.641
Validation loss decreased (-0.637025 --> -0.640729).  Saving model ...
Epoch: 46 cost time: 1.1551294326782227
Epoch: 46, Steps: 2 | Train Loss: 0.549 Vali Loss: 1.158 Vali Acc: 0.652 Test Loss: 1.158 Test Acc: 0.652
Validation loss decreased (-0.640729 --> -0.651840).  Saving model ...
Epoch: 47 cost time: 1.1855626106262207
Epoch: 47, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.140 Vali Acc: 0.663 Test Loss: 1.140 Test Acc: 0.663
Validation loss decreased (-0.651840 --> -0.662952).  Saving model ...
Epoch: 48 cost time: 1.196448564529419
Epoch: 48, Steps: 2 | Train Loss: 0.527 Vali Loss: 1.121 Vali Acc: 0.663 Test Loss: 1.121 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 49 cost time: 1.1601064205169678
Epoch: 49, Steps: 2 | Train Loss: 0.510 Vali Loss: 1.104 Vali Acc: 0.663 Test Loss: 1.104 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 50 cost time: 1.1092636585235596
Epoch: 50, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.086 Vali Acc: 0.667 Test Loss: 1.086 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666656).  Saving model ...
Epoch: 51 cost time: 1.2204034328460693
Epoch: 51, Steps: 2 | Train Loss: 0.434 Vali Loss: 1.068 Vali Acc: 0.670 Test Loss: 1.068 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.670360).  Saving model ...
Epoch: 52 cost time: 1.2345376014709473
Epoch: 52, Steps: 2 | Train Loss: 0.427 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2364628314971924
Epoch: 53, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.035 Vali Acc: 0.674 Test Loss: 1.035 Test Acc: 0.674
Validation loss decreased (-0.670360 --> -0.674064).  Saving model ...
Epoch: 54 cost time: 1.131983757019043
Epoch: 54, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.017 Vali Acc: 0.685 Test Loss: 1.017 Test Acc: 0.685
Validation loss decreased (-0.674064 --> -0.685175).  Saving model ...
Epoch: 55 cost time: 1.2145497798919678
Epoch: 55, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.001 Vali Acc: 0.681 Test Loss: 1.001 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0856852531433105
Epoch: 56, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
Validation loss decreased (-0.685175 --> -0.699990).  Saving model ...
Epoch: 57 cost time: 1.046722412109375
Epoch: 57, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.968 Vali Acc: 0.704 Test Loss: 0.968 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 58 cost time: 0.9883954524993896
Epoch: 58, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.950 Vali Acc: 0.704 Test Loss: 0.950 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 59 cost time: 1.0276150703430176
Epoch: 59, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.934 Vali Acc: 0.707 Test Loss: 0.934 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 60 cost time: 1.0223770141601562
Epoch: 60, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.917 Vali Acc: 0.711 Test Loss: 0.917 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 61 cost time: 1.3045978546142578
Epoch: 61, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.903 Vali Acc: 0.715 Test Loss: 0.903 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 62 cost time: 1.2100353240966797
Epoch: 62, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
Validation loss decreased (-0.714806 --> -0.722213).  Saving model ...
Epoch: 63 cost time: 1.146233081817627
Epoch: 63, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.873 Vali Acc: 0.730 Test Loss: 0.873 Test Acc: 0.730
Validation loss decreased (-0.722213 --> -0.729621).  Saving model ...
Epoch: 64 cost time: 1.1829984188079834
Epoch: 64, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
Validation loss decreased (-0.729621 --> -0.737028).  Saving model ...
Epoch: 65 cost time: 1.265047550201416
Epoch: 65, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.840 Vali Acc: 0.744 Test Loss: 0.840 Test Acc: 0.744
Validation loss decreased (-0.737028 --> -0.744436).  Saving model ...
Epoch: 66 cost time: 1.2891554832458496
Epoch: 66, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 67 cost time: 1.2141361236572266
Epoch: 67, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.806 Vali Acc: 0.741 Test Loss: 0.806 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2531721591949463
Epoch: 68, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.791 Vali Acc: 0.741 Test Loss: 0.791 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2287132740020752
Epoch: 69, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.778 Vali Acc: 0.748 Test Loss: 0.778 Test Acc: 0.748
Validation loss decreased (-0.744436 --> -0.748140).  Saving model ...
Epoch: 70 cost time: 1.1824302673339844
Epoch: 70, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
Validation loss decreased (-0.748140 --> -0.755548).  Saving model ...
Epoch: 71 cost time: 1.1583442687988281
Epoch: 71, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.750 Vali Acc: 0.759 Test Loss: 0.750 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 72 cost time: 1.0837345123291016
Epoch: 72, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.736 Vali Acc: 0.759 Test Loss: 0.736 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 73 cost time: 1.0667273998260498
Epoch: 73, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.723 Vali Acc: 0.770 Test Loss: 0.723 Test Acc: 0.770
Validation loss decreased (-0.759252 --> -0.770363).  Saving model ...
Epoch: 74 cost time: 1.1040856838226318
Epoch: 74, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.711 Vali Acc: 0.774 Test Loss: 0.711 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 75 cost time: 1.2487571239471436
Epoch: 75, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.701 Vali Acc: 0.774 Test Loss: 0.701 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 76 cost time: 1.291581630706787
Epoch: 76, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.691 Vali Acc: 0.774 Test Loss: 0.691 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 77 cost time: 1.264134407043457
Epoch: 77, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.3490138053894043
Epoch: 78, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.673 Vali Acc: 0.770 Test Loss: 0.673 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.193476915359497
Epoch: 79, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.664 Vali Acc: 0.774 Test Loss: 0.664 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 80 cost time: 1.3379013538360596
Epoch: 80, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.654 Vali Acc: 0.781 Test Loss: 0.654 Test Acc: 0.781
Validation loss decreased (-0.774067 --> -0.781475).  Saving model ...
Epoch: 81 cost time: 1.3234658241271973
Epoch: 81, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.646 Vali Acc: 0.781 Test Loss: 0.646 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 82 cost time: 1.2033016681671143
Epoch: 82, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.638 Vali Acc: 0.785 Test Loss: 0.638 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 83 cost time: 1.2169160842895508
Epoch: 83, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.631 Vali Acc: 0.785 Test Loss: 0.631 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 84 cost time: 1.341618537902832
Epoch: 84, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 85 cost time: 1.214989423751831
Epoch: 85, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 86 cost time: 1.2296874523162842
Epoch: 86, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 87 cost time: 1.1588470935821533
Epoch: 87, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 88 cost time: 1.1548511981964111
Epoch: 88, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.603 Vali Acc: 0.793 Test Loss: 0.603 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792587).  Saving model ...
Epoch: 89 cost time: 1.187861442565918
Epoch: 89, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.599 Vali Acc: 0.793 Test Loss: 0.599 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 90 cost time: 1.1430275440216064
Epoch: 90, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796290).  Saving model ...
Epoch: 91 cost time: 1.1257693767547607
Epoch: 91, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 92 cost time: 1.2665011882781982
Epoch: 92, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 93 cost time: 1.2098183631896973
Epoch: 93, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 94 cost time: 1.3131639957427979
Epoch: 94, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.589 Vali Acc: 0.793 Test Loss: 0.589 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1833577156066895
Epoch: 95, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 96 cost time: 1.0805082321166992
Epoch: 96, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 97 cost time: 1.1172232627868652
Epoch: 97, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.580 Vali Acc: 0.796 Test Loss: 0.580 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796291).  Saving model ...
Epoch: 98 cost time: 1.0915050506591797
Epoch: 98, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.800 Test Loss: 0.574 Test Acc: 0.800
Validation loss decreased (-0.796291 --> -0.799994).  Saving model ...
Epoch: 99 cost time: 1.1868395805358887
Epoch: 99, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 100 cost time: 1.0497183799743652
Epoch: 100, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.562 Vali Acc: 0.811 Test Loss: 0.562 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9683992862701416
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.795 Vali Acc: 0.181 Test Loss: 1.795 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 1.2125484943389893
Epoch: 2, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.791 Vali Acc: 0.193 Test Loss: 1.791 Test Acc: 0.193
Validation loss decreased (-0.181464 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 1.1901936531066895
Epoch: 3, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.787 Vali Acc: 0.200 Test Loss: 1.787 Test Acc: 0.200
Validation loss decreased (-0.192575 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.2347462177276611
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.780 Vali Acc: 0.207 Test Loss: 1.780 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207390).  Saving model ...
Epoch: 5 cost time: 1.3257286548614502
Epoch: 5, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.772 Vali Acc: 0.207 Test Loss: 1.772 Test Acc: 0.207
Validation loss decreased (-0.207390 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 1.2547717094421387
Epoch: 6, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.763 Vali Acc: 0.207 Test Loss: 1.763 Test Acc: 0.207
Validation loss decreased (-0.207390 --> -0.207390).  Saving model ...
Epoch: 7 cost time: 1.063481092453003
Epoch: 7, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.752 Vali Acc: 0.215 Test Loss: 1.752 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214797).  Saving model ...
Epoch: 8 cost time: 1.1238391399383545
Epoch: 8, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.740 Vali Acc: 0.219 Test Loss: 1.740 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 9 cost time: 1.1501896381378174
Epoch: 9, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.727 Vali Acc: 0.226 Test Loss: 1.727 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225909).  Saving model ...
Epoch: 10 cost time: 1.2323181629180908
Epoch: 10, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.713 Vali Acc: 0.233 Test Loss: 1.713 Test Acc: 0.233
Validation loss decreased (-0.225909 --> -0.233316).  Saving model ...
Epoch: 11 cost time: 1.168703317642212
Epoch: 11, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.699 Vali Acc: 0.237 Test Loss: 1.699 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 12 cost time: 1.0996465682983398
Epoch: 12, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.684 Vali Acc: 0.252 Test Loss: 1.684 Test Acc: 0.252
Validation loss decreased (-0.237020 --> -0.251835).  Saving model ...
Epoch: 13 cost time: 1.2619047164916992
Epoch: 13, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.668 Vali Acc: 0.274 Test Loss: 1.668 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 14 cost time: 1.1205322742462158
Epoch: 14, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.650 Vali Acc: 0.293 Test Loss: 1.650 Test Acc: 0.293
Validation loss decreased (-0.274057 --> -0.292576).  Saving model ...
Epoch: 15 cost time: 1.1106064319610596
Epoch: 15, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.632 Vali Acc: 0.307 Test Loss: 1.632 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 16 cost time: 1.1397128105163574
Epoch: 16, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.614 Vali Acc: 0.344 Test Loss: 1.614 Test Acc: 0.344
Validation loss decreased (-0.307391 --> -0.344428).  Saving model ...
Epoch: 17 cost time: 1.1253108978271484
Epoch: 17, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.595 Vali Acc: 0.363 Test Loss: 1.595 Test Acc: 0.363
Validation loss decreased (-0.344428 --> -0.362947).  Saving model ...
Epoch: 18 cost time: 1.0742087364196777
Epoch: 18, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.576 Vali Acc: 0.393 Test Loss: 1.576 Test Acc: 0.393
Validation loss decreased (-0.362947 --> -0.392577).  Saving model ...
Epoch: 19 cost time: 1.0972676277160645
Epoch: 19, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.556 Vali Acc: 0.411 Test Loss: 1.556 Test Acc: 0.411
Validation loss decreased (-0.392577 --> -0.411096).  Saving model ...
Epoch: 20 cost time: 1.0761845111846924
Epoch: 20, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.535 Vali Acc: 0.448 Test Loss: 1.535 Test Acc: 0.448
Validation loss decreased (-0.411096 --> -0.448133).  Saving model ...
Epoch: 21 cost time: 1.1496689319610596
Epoch: 21, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.514 Vali Acc: 0.470 Test Loss: 1.514 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 1.2746798992156982
Epoch: 22, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.493 Vali Acc: 0.493 Test Loss: 1.493 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492578).  Saving model ...
Epoch: 23 cost time: 1.3554940223693848
Epoch: 23, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.472 Vali Acc: 0.511 Test Loss: 1.472 Test Acc: 0.511
Validation loss decreased (-0.492578 --> -0.511096).  Saving model ...
Epoch: 24 cost time: 1.2469327449798584
Epoch: 24, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.450 Vali Acc: 0.541 Test Loss: 1.450 Test Acc: 0.541
Validation loss decreased (-0.511096 --> -0.540726).  Saving model ...
Epoch: 25 cost time: 1.1854841709136963
Epoch: 25, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.428 Vali Acc: 0.552 Test Loss: 1.428 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551838).  Saving model ...
Epoch: 26 cost time: 1.1733055114746094
Epoch: 26, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.406 Vali Acc: 0.570 Test Loss: 1.406 Test Acc: 0.570
Validation loss decreased (-0.551838 --> -0.570356).  Saving model ...
Epoch: 27 cost time: 1.2891759872436523
Epoch: 27, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.384 Vali Acc: 0.574 Test Loss: 1.384 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 28 cost time: 1.13946533203125
Epoch: 28, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.361 Vali Acc: 0.600 Test Loss: 1.361 Test Acc: 0.600
Validation loss decreased (-0.574060 --> -0.599986).  Saving model ...
Epoch: 29 cost time: 1.1696858406066895
Epoch: 29, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.339 Vali Acc: 0.611 Test Loss: 1.339 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 30 cost time: 1.074141025543213
Epoch: 30, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.315 Vali Acc: 0.619 Test Loss: 1.315 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618505).  Saving model ...
Epoch: 31 cost time: 1.0892658233642578
Epoch: 31, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.292 Vali Acc: 0.626 Test Loss: 1.292 Test Acc: 0.626
Validation loss decreased (-0.618505 --> -0.625913).  Saving model ...
Epoch: 32 cost time: 1.0502641201019287
Epoch: 32, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.268 Vali Acc: 0.633 Test Loss: 1.268 Test Acc: 0.633
Validation loss decreased (-0.625913 --> -0.633321).  Saving model ...
Epoch: 33 cost time: 1.1829273700714111
Epoch: 33, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.243 Vali Acc: 0.656 Test Loss: 1.243 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655543).  Saving model ...
Epoch: 34 cost time: 1.1969325542449951
Epoch: 34, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.218 Vali Acc: 0.663 Test Loss: 1.218 Test Acc: 0.663
Validation loss decreased (-0.655543 --> -0.662951).  Saving model ...
Epoch: 35 cost time: 1.156611442565918
Epoch: 35, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.192 Vali Acc: 0.681 Test Loss: 1.192 Test Acc: 0.681
Validation loss decreased (-0.662951 --> -0.681470).  Saving model ...
Epoch: 36 cost time: 1.307729959487915
Epoch: 36, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.167 Vali Acc: 0.685 Test Loss: 1.167 Test Acc: 0.685
Validation loss decreased (-0.681470 --> -0.685174).  Saving model ...
Epoch: 37 cost time: 1.3740251064300537
Epoch: 37, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.141 Vali Acc: 0.693 Test Loss: 1.141 Test Acc: 0.693
Validation loss decreased (-0.685174 --> -0.692581).  Saving model ...
Epoch: 38 cost time: 1.359468936920166
Epoch: 38, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.114 Vali Acc: 0.711 Test Loss: 1.114 Test Acc: 0.711
Validation loss decreased (-0.692581 --> -0.711100).  Saving model ...
Epoch: 39 cost time: 1.3961849212646484
Epoch: 39, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.089 Vali Acc: 0.726 Test Loss: 1.089 Test Acc: 0.726
Validation loss decreased (-0.711100 --> -0.725915).  Saving model ...
Epoch: 40 cost time: 1.4044840335845947
Epoch: 40, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.063 Vali Acc: 0.748 Test Loss: 1.063 Test Acc: 0.748
Validation loss decreased (-0.725915 --> -0.748138).  Saving model ...
Epoch: 41 cost time: 1.2663764953613281
Epoch: 41, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.037 Vali Acc: 0.756 Test Loss: 1.037 Test Acc: 0.756
Validation loss decreased (-0.748138 --> -0.755545).  Saving model ...
Epoch: 42 cost time: 1.2719664573669434
Epoch: 42, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.011 Vali Acc: 0.767 Test Loss: 1.011 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766657).  Saving model ...
Epoch: 43 cost time: 1.115673303604126
Epoch: 43, Steps: 2 | Train Loss: 1.134 Vali Loss: 0.984 Vali Acc: 0.778 Test Loss: 0.984 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777768).  Saving model ...
Epoch: 44 cost time: 1.2298431396484375
Epoch: 44, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.958 Vali Acc: 0.774 Test Loss: 0.958 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1021466255187988
Epoch: 45, Steps: 2 | Train Loss: 1.050 Vali Loss: 0.931 Vali Acc: 0.770 Test Loss: 0.931 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1449799537658691
Epoch: 46, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.903 Vali Acc: 0.781 Test Loss: 0.903 Test Acc: 0.781
Validation loss decreased (-0.777768 --> -0.781472).  Saving model ...
Epoch: 47 cost time: 1.1717052459716797
Epoch: 47, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.876 Vali Acc: 0.785 Test Loss: 0.876 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 48 cost time: 1.253401756286621
Epoch: 48, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.849 Vali Acc: 0.807 Test Loss: 0.849 Test Acc: 0.807
Validation loss decreased (-0.785176 --> -0.807399).  Saving model ...
Epoch: 49 cost time: 1.4173781871795654
Epoch: 49, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.822 Vali Acc: 0.811 Test Loss: 0.822 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811103).  Saving model ...
Epoch: 50 cost time: 1.3407223224639893
Epoch: 50, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.796 Vali Acc: 0.815 Test Loss: 0.796 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 51 cost time: 1.381467580795288
Epoch: 51, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.769 Vali Acc: 0.815 Test Loss: 0.769 Test Acc: 0.815
Validation loss decreased (-0.814807 --> -0.814807).  Saving model ...
Epoch: 52 cost time: 1.2380740642547607
Epoch: 52, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 53 cost time: 1.3730742931365967
Epoch: 53, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 54 cost time: 1.3570644855499268
Epoch: 54, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.691 Vali Acc: 0.852 Test Loss: 0.691 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 55 cost time: 1.2091596126556396
Epoch: 55, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 56 cost time: 1.1613011360168457
Epoch: 56, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.643 Vali Acc: 0.870 Test Loss: 0.643 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 57 cost time: 1.1300368309020996
Epoch: 57, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1367154121398926
Epoch: 58, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1499168872833252
Epoch: 59, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1171047687530518
Epoch: 60, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.2211031913757324
Epoch: 61, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.4097704887390137
Epoch: 62, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.2317402362823486
Epoch: 63, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.507 Vali Acc: 0.852 Test Loss: 0.507 Test Acc: 0.852
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.269235372543335
Epoch: 64, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.489 Vali Acc: 0.852 Test Loss: 0.489 Test Acc: 0.852
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.3994724750518799
Epoch: 65, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.2952368259429932
Epoch: 66, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.451 Vali Acc: 0.878 Test Loss: 0.451 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877773).  Saving model ...
Epoch: 67 cost time: 1.3369662761688232
Epoch: 67, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.432 Vali Acc: 0.881 Test Loss: 0.432 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 68 cost time: 1.1510226726531982
Epoch: 68, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
Epoch: 69 cost time: 1.1198029518127441
Epoch: 69, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.398 Vali Acc: 0.893 Test Loss: 0.398 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 70 cost time: 1.147322654724121
Epoch: 70, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.383 Vali Acc: 0.904 Test Loss: 0.383 Test Acc: 0.904
Validation loss decreased (-0.892589 --> -0.903700).  Saving model ...
Epoch: 71 cost time: 1.0297966003417969
Epoch: 71, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 72 cost time: 1.0462946891784668
Epoch: 72, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 73 cost time: 1.0928196907043457
Epoch: 73, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.347 Vali Acc: 0.896 Test Loss: 0.347 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9938704967498779
Epoch: 74, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.339 Vali Acc: 0.896 Test Loss: 0.339 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.2663018703460693
Epoch: 75, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.3160228729248047
Epoch: 76, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.324 Vali Acc: 0.907 Test Loss: 0.324 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.1959147453308105
Epoch: 77, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.2643163204193115
Epoch: 78, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.233701229095459
Epoch: 79, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.16542387008667
Epoch: 80, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.157738208770752
Epoch: 81, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.2579867839813232
Epoch: 82, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.647160530090332
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.877 Vali Acc: 0.085 Test Loss: 1.877 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 1.0908889770507812
Epoch: 2, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.873 Vali Acc: 0.085 Test Loss: 1.873 Test Acc: 0.085
Validation loss decreased (-0.085166 --> -0.085166).  Saving model ...
Epoch: 3 cost time: 1.1408076286315918
Epoch: 3, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.868 Vali Acc: 0.085 Test Loss: 1.868 Test Acc: 0.085
Validation loss decreased (-0.085166 --> -0.085167).  Saving model ...
Epoch: 4 cost time: 1.1483781337738037
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.861 Vali Acc: 0.089 Test Loss: 1.861 Test Acc: 0.089
Validation loss decreased (-0.085167 --> -0.088870).  Saving model ...
Epoch: 5 cost time: 1.141556978225708
Epoch: 5, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.852 Vali Acc: 0.093 Test Loss: 1.852 Test Acc: 0.093
Validation loss decreased (-0.088870 --> -0.092574).  Saving model ...
Epoch: 6 cost time: 1.2192089557647705
Epoch: 6, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.841 Vali Acc: 0.104 Test Loss: 1.841 Test Acc: 0.104
Validation loss decreased (-0.092574 --> -0.103685).  Saving model ...
Epoch: 7 cost time: 1.1467113494873047
Epoch: 7, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.828 Vali Acc: 0.107 Test Loss: 1.828 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 8 cost time: 1.2160804271697998
Epoch: 8, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.815 Vali Acc: 0.126 Test Loss: 1.815 Test Acc: 0.126
Validation loss decreased (-0.107389 --> -0.125908).  Saving model ...
Epoch: 9 cost time: 1.111072301864624
Epoch: 9, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.800 Vali Acc: 0.130 Test Loss: 1.800 Test Acc: 0.130
Validation loss decreased (-0.125908 --> -0.129612).  Saving model ...
Epoch: 10 cost time: 1.1795058250427246
Epoch: 10, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.783 Vali Acc: 0.133 Test Loss: 1.783 Test Acc: 0.133
Validation loss decreased (-0.129612 --> -0.133316).  Saving model ...
Epoch: 11 cost time: 1.056046962738037
Epoch: 11, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.766 Vali Acc: 0.163 Test Loss: 1.766 Test Acc: 0.163
Validation loss decreased (-0.133316 --> -0.162945).  Saving model ...
Epoch: 12 cost time: 1.0446124076843262
Epoch: 12, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.748 Vali Acc: 0.174 Test Loss: 1.748 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174057).  Saving model ...
Epoch: 13 cost time: 1.2896335124969482
Epoch: 13, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.728 Vali Acc: 0.196 Test Loss: 1.728 Test Acc: 0.196
Validation loss decreased (-0.174057 --> -0.196279).  Saving model ...
Epoch: 14 cost time: 1.1697008609771729
Epoch: 14, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.708 Vali Acc: 0.211 Test Loss: 1.708 Test Acc: 0.211
Validation loss decreased (-0.196279 --> -0.211094).  Saving model ...
Epoch: 15 cost time: 1.1121728420257568
Epoch: 15, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.686 Vali Acc: 0.256 Test Loss: 1.686 Test Acc: 0.256
Validation loss decreased (-0.211094 --> -0.255539).  Saving model ...
Epoch: 16 cost time: 1.1954073905944824
Epoch: 16, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.664 Vali Acc: 0.296 Test Loss: 1.664 Test Acc: 0.296
Validation loss decreased (-0.255539 --> -0.296280).  Saving model ...
Epoch: 17 cost time: 1.3038628101348877
Epoch: 17, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
Validation loss decreased (-0.296280 --> -0.333317).  Saving model ...
Epoch: 18 cost time: 1.252241849899292
Epoch: 18, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.618 Vali Acc: 0.370 Test Loss: 1.618 Test Acc: 0.370
Validation loss decreased (-0.333317 --> -0.370354).  Saving model ...
Epoch: 19 cost time: 1.3138172626495361
Epoch: 19, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.593 Vali Acc: 0.404 Test Loss: 1.593 Test Acc: 0.404
Validation loss decreased (-0.370354 --> -0.403688).  Saving model ...
Epoch: 20 cost time: 1.3544940948486328
Epoch: 20, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.568 Vali Acc: 0.437 Test Loss: 1.568 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 21 cost time: 1.4008150100708008
Epoch: 21, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.541 Vali Acc: 0.463 Test Loss: 1.541 Test Acc: 0.463
Validation loss decreased (-0.437021 --> -0.462948).  Saving model ...
Epoch: 22 cost time: 1.2504782676696777
Epoch: 22, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
Validation loss decreased (-0.462948 --> -0.488874).  Saving model ...
Epoch: 23 cost time: 1.2784600257873535
Epoch: 23, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.488 Vali Acc: 0.504 Test Loss: 1.488 Test Acc: 0.504
Validation loss decreased (-0.488874 --> -0.503689).  Saving model ...
Epoch: 24 cost time: 1.1977910995483398
Epoch: 24, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.461 Vali Acc: 0.526 Test Loss: 1.461 Test Acc: 0.526
Validation loss decreased (-0.503689 --> -0.525911).  Saving model ...
Epoch: 25 cost time: 1.5471689701080322
Epoch: 25, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.434 Vali Acc: 0.556 Test Loss: 1.434 Test Acc: 0.556
Validation loss decreased (-0.525911 --> -0.555541).  Saving model ...
Epoch: 26 cost time: 1.304697036743164
Epoch: 26, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.407 Vali Acc: 0.567 Test Loss: 1.407 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566653).  Saving model ...
Epoch: 27 cost time: 1.2689952850341797
Epoch: 27, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.380 Vali Acc: 0.593 Test Loss: 1.380 Test Acc: 0.593
Validation loss decreased (-0.566653 --> -0.592579).  Saving model ...
Epoch: 28 cost time: 1.1348519325256348
Epoch: 28, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
Validation loss decreased (-0.592579 --> -0.599986).  Saving model ...
Epoch: 29 cost time: 1.4117398262023926
Epoch: 29, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.324 Vali Acc: 0.615 Test Loss: 1.324 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614802).  Saving model ...
Epoch: 30 cost time: 1.3709802627563477
Epoch: 30, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.295 Vali Acc: 0.626 Test Loss: 1.295 Test Acc: 0.626
Validation loss decreased (-0.614802 --> -0.625913).  Saving model ...
Epoch: 31 cost time: 1.4020230770111084
Epoch: 31, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.265 Vali Acc: 0.641 Test Loss: 1.265 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640728).  Saving model ...
Epoch: 32 cost time: 1.4062025547027588
Epoch: 32, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.235 Vali Acc: 0.670 Test Loss: 1.235 Test Acc: 0.670
Validation loss decreased (-0.640728 --> -0.670358).  Saving model ...
Epoch: 33 cost time: 1.4035999774932861
Epoch: 33, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.205 Vali Acc: 0.693 Test Loss: 1.205 Test Acc: 0.693
Validation loss decreased (-0.670358 --> -0.692581).  Saving model ...
Epoch: 34 cost time: 1.2740225791931152
Epoch: 34, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.175 Vali Acc: 0.719 Test Loss: 1.175 Test Acc: 0.719
Validation loss decreased (-0.692581 --> -0.718507).  Saving model ...
Epoch: 35 cost time: 1.1346962451934814
Epoch: 35, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.146 Vali Acc: 0.726 Test Loss: 1.146 Test Acc: 0.726
Validation loss decreased (-0.718507 --> -0.725914).  Saving model ...
Epoch: 36 cost time: 1.2964272499084473
Epoch: 36, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.116 Vali Acc: 0.744 Test Loss: 1.116 Test Acc: 0.744
Validation loss decreased (-0.725914 --> -0.744433).  Saving model ...
Epoch: 37 cost time: 0.9308972358703613
Epoch: 37, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.087 Vali Acc: 0.759 Test Loss: 1.087 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 38 cost time: 1.2087242603302002
Epoch: 38, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.057 Vali Acc: 0.767 Test Loss: 1.057 Test Acc: 0.767
Validation loss decreased (-0.759248 --> -0.766656).  Saving model ...
Epoch: 39 cost time: 1.1233446598052979
Epoch: 39, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.029 Vali Acc: 0.774 Test Loss: 1.029 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 40 cost time: 1.2465927600860596
Epoch: 40, Steps: 2 | Train Loss: 1.215 Vali Loss: 0.999 Vali Acc: 0.781 Test Loss: 0.999 Test Acc: 0.781
Validation loss decreased (-0.774064 --> -0.781471).  Saving model ...
Epoch: 41 cost time: 1.15010404586792
Epoch: 41, Steps: 2 | Train Loss: 1.208 Vali Loss: 0.970 Vali Acc: 0.785 Test Loss: 0.970 Test Acc: 0.785
Validation loss decreased (-0.781471 --> -0.785175).  Saving model ...
Epoch: 42 cost time: 1.316786527633667
Epoch: 42, Steps: 2 | Train Loss: 1.145 Vali Loss: 0.942 Vali Acc: 0.796 Test Loss: 0.942 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796287).  Saving model ...
Epoch: 43 cost time: 1.3863131999969482
Epoch: 43, Steps: 2 | Train Loss: 1.158 Vali Loss: 0.912 Vali Acc: 0.811 Test Loss: 0.912 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 44 cost time: 1.3076348304748535
Epoch: 44, Steps: 2 | Train Loss: 1.140 Vali Loss: 0.882 Vali Acc: 0.822 Test Loss: 0.882 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 45 cost time: 1.3201632499694824
Epoch: 45, Steps: 2 | Train Loss: 0.997 Vali Loss: 0.853 Vali Acc: 0.833 Test Loss: 0.853 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 46 cost time: 1.3125431537628174
Epoch: 46, Steps: 2 | Train Loss: 0.998 Vali Loss: 0.824 Vali Acc: 0.848 Test Loss: 0.824 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 47 cost time: 1.2689995765686035
Epoch: 47, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.795 Vali Acc: 0.867 Test Loss: 0.795 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866659).  Saving model ...
Epoch: 48 cost time: 1.3070335388183594
Epoch: 48, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.767 Vali Acc: 0.863 Test Loss: 0.767 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2369537353515625
Epoch: 49, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.739 Vali Acc: 0.874 Test Loss: 0.739 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 50 cost time: 1.2092156410217285
Epoch: 50, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.713 Vali Acc: 0.881 Test Loss: 0.713 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881474).  Saving model ...
Epoch: 51 cost time: 1.3302180767059326
Epoch: 51, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.686 Vali Acc: 0.878 Test Loss: 0.686 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1910712718963623
Epoch: 52, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.660 Vali Acc: 0.893 Test Loss: 0.660 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 53 cost time: 1.3427526950836182
Epoch: 53, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.635 Vali Acc: 0.896 Test Loss: 0.635 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 54 cost time: 1.271824836730957
Epoch: 54, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.612 Vali Acc: 0.885 Test Loss: 0.612 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5558795928955078
Epoch: 55, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.589 Vali Acc: 0.881 Test Loss: 0.589 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2183940410614014
Epoch: 56, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.299300193786621
Epoch: 57, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.546 Vali Acc: 0.874 Test Loss: 0.546 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.3773751258850098
Epoch: 58, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.526 Vali Acc: 0.874 Test Loss: 0.526 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.3469691276550293
Epoch: 59, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.2802741527557373
Epoch: 60, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.492 Vali Acc: 0.852 Test Loss: 0.492 Test Acc: 0.852
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1788368225097656
Epoch: 61, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.260941505432129
Epoch: 62, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.466 Vali Acc: 0.852 Test Loss: 0.466 Test Acc: 0.852
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.3599374294281006
Epoch: 63, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.536513566970825
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2294418811798096
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.250603437423706
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1821489334106445
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.1773953437805176
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.424907922744751
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1544904708862305
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2412869930267334
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.157592535018921
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.1489465236663818
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.1234478950500488
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.090221643447876
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.2091634273529053
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.2978579998016357
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1208367347717285
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.465245246887207
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.3353049755096436
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.438810110092163
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.3415277004241943
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.5422368049621582
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 21 cost time: 1.3565411567687988
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 1.5598855018615723
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.353637456893921
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.4679741859436035
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 1.2734873294830322
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.2690715789794922
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.239485740661621
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.340233564376831
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.2721185684204102
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.3852739334106445
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.4656898975372314
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.3217213153839111
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 33 cost time: 1.3187754154205322
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.5129005908966064
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.214693546295166
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.2172927856445312
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.3493425846099854
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.2207887172698975
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1936466693878174
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.1322567462921143
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.1905298233032227
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.2875945568084717
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.164766550064087
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.428835153579712
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.3261222839355469
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.3452699184417725
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.2129290103912354
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.2662339210510254
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.1513159275054932
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.2497954368591309
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.390563726425171
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.3006582260131836
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.4726431369781494
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.2564969062805176
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3342783451080322
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.4530255794525146
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.4275150299072266
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.1480352878570557
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2489855289459229
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.0789909362792969
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.0792310237884521
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.273524284362793
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2583158016204834
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.3626091480255127
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.2570629119873047
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.281618595123291
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.3642857074737549
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.188469409942627
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.3132305145263672
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.339564561843872
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.2613980770111084
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.3995189666748047
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.2314040660858154
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.3633270263671875
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.3657381534576416
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.3649604320526123
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.3817944526672363
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.2916765213012695
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 1.3536999225616455
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.424149990081787
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.3033404350280762
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.0687367916107178
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.1318714618682861
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.1323506832122803
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.1611521244049072
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.1678261756896973
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.3511850833892822
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.1162068843841553
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 1.1406335830688477
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.253791332244873
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 91 cost time: 1.3055317401885986
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 1.1948597431182861
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.1504762172698975
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.247744083404541
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.2947609424591064
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.2725942134857178
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.3155734539031982
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.2388038635253906
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.2304694652557373
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.3379442691802979
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 243814
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8794665336608887
Epoch: 1, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.793 Vali Acc: 0.141 Test Loss: 1.793 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 1.1744799613952637
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.776 Vali Acc: 0.156 Test Loss: 1.776 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 1.125112771987915
Epoch: 3, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.761 Vali Acc: 0.163 Test Loss: 1.761 Test Acc: 0.163
Validation loss decreased (-0.155538 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 1.1779718399047852
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.745 Vali Acc: 0.174 Test Loss: 1.745 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174057).  Saving model ...
Epoch: 5 cost time: 1.3316731452941895
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.724 Vali Acc: 0.204 Test Loss: 1.724 Test Acc: 0.204
Validation loss decreased (-0.174057 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 1.059197187423706
Epoch: 6, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.699 Vali Acc: 0.230 Test Loss: 1.699 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229613).  Saving model ...
Epoch: 7 cost time: 1.0933678150177002
Epoch: 7, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.672 Vali Acc: 0.263 Test Loss: 1.672 Test Acc: 0.263
Validation loss decreased (-0.229613 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 1.1780261993408203
Epoch: 8, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.641 Vali Acc: 0.322 Test Loss: 1.641 Test Acc: 0.322
Validation loss decreased (-0.262946 --> -0.322206).  Saving model ...
Epoch: 9 cost time: 1.0615613460540771
Epoch: 9, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.608 Vali Acc: 0.374 Test Loss: 1.608 Test Acc: 0.374
Validation loss decreased (-0.322206 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 1.1049625873565674
Epoch: 10, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.574 Vali Acc: 0.430 Test Loss: 1.574 Test Acc: 0.430
Validation loss decreased (-0.374058 --> -0.429614).  Saving model ...
Epoch: 11 cost time: 1.2688133716583252
Epoch: 11, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.538 Vali Acc: 0.478 Test Loss: 1.538 Test Acc: 0.478
Validation loss decreased (-0.429614 --> -0.477762).  Saving model ...
Epoch: 12 cost time: 1.1307053565979004
Epoch: 12, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 1.134068250656128
Epoch: 13, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.464 Vali Acc: 0.530 Test Loss: 1.464 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 1.0457720756530762
Epoch: 14, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.425 Vali Acc: 0.570 Test Loss: 1.425 Test Acc: 0.570
Validation loss decreased (-0.529615 --> -0.570356).  Saving model ...
Epoch: 15 cost time: 1.1719539165496826
Epoch: 15, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.386 Vali Acc: 0.607 Test Loss: 1.386 Test Acc: 0.607
Validation loss decreased (-0.570356 --> -0.607394).  Saving model ...
Epoch: 16 cost time: 1.2356486320495605
Epoch: 16, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.346 Vali Acc: 0.648 Test Loss: 1.346 Test Acc: 0.648
Validation loss decreased (-0.607394 --> -0.648135).  Saving model ...
Epoch: 17 cost time: 1.0642082691192627
Epoch: 17, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.306 Vali Acc: 0.678 Test Loss: 1.306 Test Acc: 0.678
Validation loss decreased (-0.648135 --> -0.677765).  Saving model ...
Epoch: 18 cost time: 1.214402198791504
Epoch: 18, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.266 Vali Acc: 0.696 Test Loss: 1.266 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696284).  Saving model ...
Epoch: 19 cost time: 1.4465596675872803
Epoch: 19, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.226 Vali Acc: 0.715 Test Loss: 1.226 Test Acc: 0.715
Validation loss decreased (-0.696284 --> -0.714803).  Saving model ...
Epoch: 20 cost time: 1.3316187858581543
Epoch: 20, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.187 Vali Acc: 0.722 Test Loss: 1.187 Test Acc: 0.722
Validation loss decreased (-0.714803 --> -0.722210).  Saving model ...
Epoch: 21 cost time: 1.20198655128479
Epoch: 21, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.149 Vali Acc: 0.744 Test Loss: 1.149 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744433).  Saving model ...
Epoch: 22 cost time: 1.1923589706420898
Epoch: 22, Steps: 2 | Train Loss: 0.820 Vali Loss: 1.110 Vali Acc: 0.756 Test Loss: 1.110 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755544).  Saving model ...
Epoch: 23 cost time: 1.1882803440093994
Epoch: 23, Steps: 2 | Train Loss: 0.765 Vali Loss: 1.074 Vali Acc: 0.763 Test Loss: 1.074 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 24 cost time: 1.362210750579834
Epoch: 24, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.038 Vali Acc: 0.763 Test Loss: 1.038 Test Acc: 0.763
Validation loss decreased (-0.762952 --> -0.762953).  Saving model ...
Epoch: 25 cost time: 1.2235660552978516
Epoch: 25, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.002 Vali Acc: 0.759 Test Loss: 1.002 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1577913761138916
Epoch: 26, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.969 Vali Acc: 0.767 Test Loss: 0.969 Test Acc: 0.767
Validation loss decreased (-0.762953 --> -0.766657).  Saving model ...
Epoch: 27 cost time: 1.1220800876617432
Epoch: 27, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.937 Vali Acc: 0.770 Test Loss: 0.937 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770361).  Saving model ...
Epoch: 28 cost time: 1.142390251159668
Epoch: 28, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.908 Vali Acc: 0.778 Test Loss: 0.908 Test Acc: 0.778
Validation loss decreased (-0.770361 --> -0.777769).  Saving model ...
Epoch: 29 cost time: 1.2464895248413086
Epoch: 29, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 30 cost time: 1.121781587600708
Epoch: 30, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.852 Vali Acc: 0.789 Test Loss: 0.852 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788880).  Saving model ...
Epoch: 31 cost time: 1.0297741889953613
Epoch: 31, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.828 Vali Acc: 0.785 Test Loss: 0.828 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2387216091156006
Epoch: 32, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.805 Vali Acc: 0.793 Test Loss: 0.805 Test Acc: 0.793
Validation loss decreased (-0.788880 --> -0.792585).  Saving model ...
Epoch: 33 cost time: 1.1030535697937012
Epoch: 33, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799992).  Saving model ...
Epoch: 34 cost time: 1.1966242790222168
Epoch: 34, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.764 Vali Acc: 0.796 Test Loss: 0.764 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0706024169921875
Epoch: 35, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.746 Vali Acc: 0.793 Test Loss: 0.746 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.168351650238037
Epoch: 36, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.731 Vali Acc: 0.807 Test Loss: 0.731 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.807400).  Saving model ...
Epoch: 37 cost time: 1.3340160846710205
Epoch: 37, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.717 Vali Acc: 0.807 Test Loss: 0.717 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 38 cost time: 1.1964383125305176
Epoch: 38, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.705 Vali Acc: 0.807 Test Loss: 0.705 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 39 cost time: 1.0361177921295166
Epoch: 39, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.693 Vali Acc: 0.807 Test Loss: 0.693 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 40 cost time: 1.0695791244506836
Epoch: 40, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1707828044891357
Epoch: 41, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.232004165649414
Epoch: 42, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1596174240112305
Epoch: 43, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.656 Vali Acc: 0.796 Test Loss: 0.656 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1483817100524902
Epoch: 44, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2898674011230469
Epoch: 45, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3302669525146484
Epoch: 46, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2771806716918945
Epoch: 47, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2928454875946045
Epoch: 48, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1852397918701172
Epoch: 49, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.60990309715271
Epoch: 1, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.790 Vali Acc: 0.152 Test Loss: 1.790 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 1.0902581214904785
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.776 Vali Acc: 0.159 Test Loss: 1.776 Test Acc: 0.159
Validation loss decreased (-0.151834 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 1.0533630847930908
Epoch: 3, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.764 Vali Acc: 0.167 Test Loss: 1.764 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.8984811305999756
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.752 Vali Acc: 0.185 Test Loss: 1.752 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.9902431964874268
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.735 Vali Acc: 0.211 Test Loss: 1.735 Test Acc: 0.211
Validation loss decreased (-0.185168 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 1.104132890701294
Epoch: 6, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.716 Vali Acc: 0.233 Test Loss: 1.716 Test Acc: 0.233
Validation loss decreased (-0.211094 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 1.116300106048584
Epoch: 7, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.694 Vali Acc: 0.285 Test Loss: 1.694 Test Acc: 0.285
Validation loss decreased (-0.233316 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 1.0747673511505127
Epoch: 8, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.670 Vali Acc: 0.337 Test Loss: 1.670 Test Acc: 0.337
Validation loss decreased (-0.285168 --> -0.337020).  Saving model ...
Epoch: 9 cost time: 1.0806708335876465
Epoch: 9, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.644 Vali Acc: 0.359 Test Loss: 1.644 Test Acc: 0.359
Validation loss decreased (-0.337020 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 1.0108575820922852
Epoch: 10, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.617 Vali Acc: 0.404 Test Loss: 1.617 Test Acc: 0.404
Validation loss decreased (-0.359243 --> -0.403688).  Saving model ...
Epoch: 11 cost time: 1.0927631855010986
Epoch: 11, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.589 Vali Acc: 0.452 Test Loss: 1.589 Test Acc: 0.452
Validation loss decreased (-0.403688 --> -0.451836).  Saving model ...
Epoch: 12 cost time: 1.1491169929504395
Epoch: 12, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.560 Vali Acc: 0.474 Test Loss: 1.560 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474058).  Saving model ...
Epoch: 13 cost time: 1.2088358402252197
Epoch: 13, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.530 Vali Acc: 0.489 Test Loss: 1.530 Test Acc: 0.489
Validation loss decreased (-0.474058 --> -0.488874).  Saving model ...
Epoch: 14 cost time: 1.142043113708496
Epoch: 14, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.500 Vali Acc: 0.533 Test Loss: 1.500 Test Acc: 0.533
Validation loss decreased (-0.488874 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 1.1880950927734375
Epoch: 15, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.468 Vali Acc: 0.548 Test Loss: 1.468 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548133).  Saving model ...
Epoch: 16 cost time: 1.0321760177612305
Epoch: 16, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1110119819641113
Epoch: 17, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.405 Vali Acc: 0.556 Test Loss: 1.405 Test Acc: 0.556
Validation loss decreased (-0.548133 --> -0.555542).  Saving model ...
Epoch: 18 cost time: 1.0170016288757324
Epoch: 18, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.373 Vali Acc: 0.574 Test Loss: 1.373 Test Acc: 0.574
Validation loss decreased (-0.555542 --> -0.574060).  Saving model ...
Epoch: 19 cost time: 1.1179909706115723
Epoch: 19, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.341 Vali Acc: 0.581 Test Loss: 1.341 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 20 cost time: 1.066070556640625
Epoch: 20, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.310 Vali Acc: 0.593 Test Loss: 1.310 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 1.2052927017211914
Epoch: 21, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.278 Vali Acc: 0.607 Test Loss: 1.278 Test Acc: 0.607
Validation loss decreased (-0.592579 --> -0.607395).  Saving model ...
Epoch: 22 cost time: 1.2512657642364502
Epoch: 22, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.247 Vali Acc: 0.626 Test Loss: 1.247 Test Acc: 0.626
Validation loss decreased (-0.607395 --> -0.625913).  Saving model ...
Epoch: 23 cost time: 1.2640695571899414
Epoch: 23, Steps: 2 | Train Loss: 0.866 Vali Loss: 1.217 Vali Acc: 0.633 Test Loss: 1.217 Test Acc: 0.633
Validation loss decreased (-0.625913 --> -0.633321).  Saving model ...
Epoch: 24 cost time: 1.1509060859680176
Epoch: 24, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.186 Vali Acc: 0.659 Test Loss: 1.186 Test Acc: 0.659
Validation loss decreased (-0.633321 --> -0.659247).  Saving model ...
Epoch: 25 cost time: 1.2978487014770508
Epoch: 25, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.157 Vali Acc: 0.663 Test Loss: 1.157 Test Acc: 0.663
Validation loss decreased (-0.659247 --> -0.662951).  Saving model ...
Epoch: 26 cost time: 1.33064603805542
Epoch: 26, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.127 Vali Acc: 0.670 Test Loss: 1.127 Test Acc: 0.670
Validation loss decreased (-0.662951 --> -0.670359).  Saving model ...
Epoch: 27 cost time: 1.2962632179260254
Epoch: 27, Steps: 2 | Train Loss: 0.649 Vali Loss: 1.099 Vali Acc: 0.674 Test Loss: 1.099 Test Acc: 0.674
Validation loss decreased (-0.670359 --> -0.674063).  Saving model ...
Epoch: 28 cost time: 1.206911325454712
Epoch: 28, Steps: 2 | Train Loss: 0.671 Vali Loss: 1.073 Vali Acc: 0.674 Test Loss: 1.073 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 29 cost time: 1.0394489765167236
Epoch: 29, Steps: 2 | Train Loss: 0.593 Vali Loss: 1.046 Vali Acc: 0.689 Test Loss: 1.046 Test Acc: 0.689
Validation loss decreased (-0.674063 --> -0.688878).  Saving model ...
Epoch: 30 cost time: 1.0437655448913574
Epoch: 30, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.022 Vali Acc: 0.704 Test Loss: 1.022 Test Acc: 0.704
Validation loss decreased (-0.688878 --> -0.703693).  Saving model ...
Epoch: 31 cost time: 1.2096168994903564
Epoch: 31, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
Validation loss decreased (-0.703693 --> -0.711101).  Saving model ...
Epoch: 32 cost time: 1.0224318504333496
Epoch: 32, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 33 cost time: 1.1042213439941406
Epoch: 33, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.954 Vali Acc: 0.715 Test Loss: 0.954 Test Acc: 0.715
Validation loss decreased (-0.711101 --> -0.714805).  Saving model ...
Epoch: 34 cost time: 1.3420000076293945
Epoch: 34, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.935 Vali Acc: 0.719 Test Loss: 0.935 Test Acc: 0.719
Validation loss decreased (-0.714805 --> -0.718509).  Saving model ...
Epoch: 35 cost time: 1.4471898078918457
Epoch: 35, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.917 Vali Acc: 0.719 Test Loss: 0.917 Test Acc: 0.719
Validation loss decreased (-0.718509 --> -0.718509).  Saving model ...
Epoch: 36 cost time: 1.2503843307495117
Epoch: 36, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.901 Vali Acc: 0.722 Test Loss: 0.901 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 37 cost time: 1.3646953105926514
Epoch: 37, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.886 Vali Acc: 0.726 Test Loss: 0.886 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 38 cost time: 1.462980031967163
Epoch: 38, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.871 Vali Acc: 0.726 Test Loss: 0.871 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 39 cost time: 1.489258050918579
Epoch: 39, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.725917 --> -0.733325).  Saving model ...
Epoch: 40 cost time: 1.3901290893554688
Epoch: 40, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.847 Vali Acc: 0.733 Test Loss: 0.847 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 41 cost time: 1.4015958309173584
Epoch: 41, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 42 cost time: 1.3383197784423828
Epoch: 42, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 1.3037402629852295
Epoch: 43, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 44 cost time: 1.6685752868652344
Epoch: 44, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.803 Vali Acc: 0.741 Test Loss: 0.803 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 45 cost time: 1.3436872959136963
Epoch: 45, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.793 Vali Acc: 0.744 Test Loss: 0.793 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 46 cost time: 1.1792306900024414
Epoch: 46, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.784 Vali Acc: 0.748 Test Loss: 0.784 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 47 cost time: 1.3937385082244873
Epoch: 47, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.776 Vali Acc: 0.748 Test Loss: 0.776 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 48 cost time: 1.5779657363891602
Epoch: 48, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.769 Vali Acc: 0.752 Test Loss: 0.769 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 49 cost time: 1.4244120121002197
Epoch: 49, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.761 Vali Acc: 0.752 Test Loss: 0.761 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 50 cost time: 1.2767081260681152
Epoch: 50, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 51 cost time: 1.131392002105713
Epoch: 51, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 52 cost time: 1.26615309715271
Epoch: 52, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 53 cost time: 1.2163832187652588
Epoch: 53, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.737 Vali Acc: 0.756 Test Loss: 0.737 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 54 cost time: 1.1218366622924805
Epoch: 54, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 55 cost time: 1.0238659381866455
Epoch: 55, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.728 Vali Acc: 0.759 Test Loss: 0.728 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 56 cost time: 1.2103655338287354
Epoch: 56, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 57 cost time: 1.1896357536315918
Epoch: 57, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 58 cost time: 1.2039217948913574
Epoch: 58, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.717 Vali Acc: 0.770 Test Loss: 0.717 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770363).  Saving model ...
Epoch: 59 cost time: 1.1754672527313232
Epoch: 59, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 60 cost time: 1.1123037338256836
Epoch: 60, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.711 Vali Acc: 0.774 Test Loss: 0.711 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 61 cost time: 1.1604218482971191
Epoch: 61, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.708 Vali Acc: 0.774 Test Loss: 0.708 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 62 cost time: 1.0926930904388428
Epoch: 62, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.705 Vali Acc: 0.774 Test Loss: 0.705 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 63 cost time: 1.3198614120483398
Epoch: 63, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.702 Vali Acc: 0.774 Test Loss: 0.702 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 64 cost time: 1.2624101638793945
Epoch: 64, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.700 Vali Acc: 0.774 Test Loss: 0.700 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 65 cost time: 1.1574652194976807
Epoch: 65, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.697 Vali Acc: 0.774 Test Loss: 0.697 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 66 cost time: 1.06807279586792
Epoch: 66, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 67 cost time: 1.0630557537078857
Epoch: 67, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 68 cost time: 1.1984226703643799
Epoch: 68, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.687 Vali Acc: 0.778 Test Loss: 0.687 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 69 cost time: 1.1164915561676025
Epoch: 69, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 70 cost time: 1.1405975818634033
Epoch: 70, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.682 Vali Acc: 0.778 Test Loss: 0.682 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 71 cost time: 1.1440701484680176
Epoch: 71, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.679 Vali Acc: 0.778 Test Loss: 0.679 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 72 cost time: 1.3177249431610107
Epoch: 72, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.677 Vali Acc: 0.778 Test Loss: 0.677 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 73 cost time: 1.338787317276001
Epoch: 73, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.674 Vali Acc: 0.778 Test Loss: 0.674 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 74 cost time: 1.2610580921173096
Epoch: 74, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.672 Vali Acc: 0.778 Test Loss: 0.672 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 75 cost time: 1.3630096912384033
Epoch: 75, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.670 Vali Acc: 0.781 Test Loss: 0.670 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 76 cost time: 1.3402044773101807
Epoch: 76, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.668 Vali Acc: 0.781 Test Loss: 0.668 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 77 cost time: 1.1534838676452637
Epoch: 77, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.666 Vali Acc: 0.785 Test Loss: 0.666 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 78 cost time: 1.3367104530334473
Epoch: 78, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.664 Vali Acc: 0.785 Test Loss: 0.664 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 79 cost time: 1.2131881713867188
Epoch: 79, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.662 Vali Acc: 0.781 Test Loss: 0.662 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1650235652923584
Epoch: 80, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.660 Vali Acc: 0.781 Test Loss: 0.660 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.0414295196533203
Epoch: 81, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.658 Vali Acc: 0.778 Test Loss: 0.658 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.2474040985107422
Epoch: 82, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.656 Vali Acc: 0.778 Test Loss: 0.656 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.3261868953704834
Epoch: 83, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.2459886074066162
Epoch: 84, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.652 Vali Acc: 0.781 Test Loss: 0.652 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.212024211883545
Epoch: 85, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.650 Vali Acc: 0.781 Test Loss: 0.650 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.1446502208709717
Epoch: 86, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.647 Vali Acc: 0.781 Test Loss: 0.647 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.255659580230713
Epoch: 87, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.645 Vali Acc: 0.781 Test Loss: 0.645 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.1300694942474365
Epoch: 88, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.644 Vali Acc: 0.778 Test Loss: 0.644 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7851851851851852
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.494823694229126
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.848 Vali Acc: 0.152 Test Loss: 1.848 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 1.0866153240203857
Epoch: 2, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.836 Vali Acc: 0.148 Test Loss: 1.836 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0868821144104004
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.827 Vali Acc: 0.148 Test Loss: 1.827 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0240583419799805
Epoch: 4, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.817 Vali Acc: 0.156 Test Loss: 1.817 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 1.3768482208251953
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.804 Vali Acc: 0.178 Test Loss: 1.804 Test Acc: 0.178
Validation loss decreased (-0.155537 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 1.2740495204925537
Epoch: 6, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.788 Vali Acc: 0.200 Test Loss: 1.788 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 1.1700811386108398
Epoch: 7, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.771 Vali Acc: 0.222 Test Loss: 1.771 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 1.402470350265503
Epoch: 8, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.752 Vali Acc: 0.248 Test Loss: 1.752 Test Acc: 0.248
Validation loss decreased (-0.222205 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 1.3800673484802246
Epoch: 9, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.732 Vali Acc: 0.263 Test Loss: 1.732 Test Acc: 0.263
Validation loss decreased (-0.248131 --> -0.262946).  Saving model ...
Epoch: 10 cost time: 1.3249573707580566
Epoch: 10, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.710 Vali Acc: 0.285 Test Loss: 1.710 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285168).  Saving model ...
Epoch: 11 cost time: 1.0310444831848145
Epoch: 11, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.688 Vali Acc: 0.322 Test Loss: 1.688 Test Acc: 0.322
Validation loss decreased (-0.285168 --> -0.322205).  Saving model ...
Epoch: 12 cost time: 1.4179413318634033
Epoch: 12, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.665 Vali Acc: 0.367 Test Loss: 1.665 Test Acc: 0.367
Validation loss decreased (-0.322205 --> -0.366650).  Saving model ...
Epoch: 13 cost time: 1.1262035369873047
Epoch: 13, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.641 Vali Acc: 0.400 Test Loss: 1.641 Test Acc: 0.400
Validation loss decreased (-0.366650 --> -0.399984).  Saving model ...
Epoch: 14 cost time: 1.1960351467132568
Epoch: 14, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.617 Vali Acc: 0.422 Test Loss: 1.617 Test Acc: 0.422
Validation loss decreased (-0.399984 --> -0.422206).  Saving model ...
Epoch: 15 cost time: 1.1740367412567139
Epoch: 15, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.592 Vali Acc: 0.456 Test Loss: 1.592 Test Acc: 0.456
Validation loss decreased (-0.422206 --> -0.455540).  Saving model ...
Epoch: 16 cost time: 1.3213436603546143
Epoch: 16, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.567 Vali Acc: 0.493 Test Loss: 1.567 Test Acc: 0.493
Validation loss decreased (-0.455540 --> -0.492577).  Saving model ...
Epoch: 17 cost time: 1.318751573562622
Epoch: 17, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.542 Vali Acc: 0.526 Test Loss: 1.542 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 18 cost time: 1.318195104598999
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.516 Vali Acc: 0.526 Test Loss: 1.516 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 19 cost time: 1.3755395412445068
Epoch: 19, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.491 Vali Acc: 0.541 Test Loss: 1.491 Test Acc: 0.541
Validation loss decreased (-0.525911 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 1.3172926902770996
Epoch: 20, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.466 Vali Acc: 0.537 Test Loss: 1.466 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2731013298034668
Epoch: 21, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.442 Vali Acc: 0.544 Test Loss: 1.442 Test Acc: 0.544
Validation loss decreased (-0.540726 --> -0.544430).  Saving model ...
Epoch: 22 cost time: 1.1840829849243164
Epoch: 22, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.417 Vali Acc: 0.567 Test Loss: 1.417 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 1.1608707904815674
Epoch: 23, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.392 Vali Acc: 0.563 Test Loss: 1.392 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2066729068756104
Epoch: 24, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.368 Vali Acc: 0.574 Test Loss: 1.368 Test Acc: 0.574
Validation loss decreased (-0.566653 --> -0.574060).  Saving model ...
Epoch: 25 cost time: 1.4237780570983887
Epoch: 25, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.344 Vali Acc: 0.581 Test Loss: 1.344 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 26 cost time: 1.2707104682922363
Epoch: 26, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.320 Vali Acc: 0.593 Test Loss: 1.320 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 27 cost time: 1.3505189418792725
Epoch: 27, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.296 Vali Acc: 0.596 Test Loss: 1.296 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 28 cost time: 1.443809986114502
Epoch: 28, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.273 Vali Acc: 0.607 Test Loss: 1.273 Test Acc: 0.607
Validation loss decreased (-0.596283 --> -0.607395).  Saving model ...
Epoch: 29 cost time: 1.5059611797332764
Epoch: 29, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.251 Vali Acc: 0.622 Test Loss: 1.251 Test Acc: 0.622
Validation loss decreased (-0.607395 --> -0.622210).  Saving model ...
Epoch: 30 cost time: 1.4057800769805908
Epoch: 30, Steps: 2 | Train Loss: 0.657 Vali Loss: 1.229 Vali Acc: 0.622 Test Loss: 1.229 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 31 cost time: 1.4993853569030762
Epoch: 31, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.208 Vali Acc: 0.626 Test Loss: 1.208 Test Acc: 0.626
Validation loss decreased (-0.622210 --> -0.625914).  Saving model ...
Epoch: 32 cost time: 1.462038516998291
Epoch: 32, Steps: 2 | Train Loss: 0.659 Vali Loss: 1.187 Vali Acc: 0.619 Test Loss: 1.187 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.476057767868042
Epoch: 33, Steps: 2 | Train Loss: 0.594 Vali Loss: 1.167 Vali Acc: 0.619 Test Loss: 1.167 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3212056159973145
Epoch: 34, Steps: 2 | Train Loss: 0.552 Vali Loss: 1.148 Vali Acc: 0.637 Test Loss: 1.148 Test Acc: 0.637
Validation loss decreased (-0.625914 --> -0.637026).  Saving model ...
Epoch: 35 cost time: 1.1608598232269287
Epoch: 35, Steps: 2 | Train Loss: 0.481 Vali Loss: 1.130 Vali Acc: 0.644 Test Loss: 1.130 Test Acc: 0.644
Validation loss decreased (-0.637026 --> -0.644433).  Saving model ...
Epoch: 36 cost time: 1.3517987728118896
Epoch: 36, Steps: 2 | Train Loss: 0.465 Vali Loss: 1.113 Vali Acc: 0.641 Test Loss: 1.113 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4186015129089355
Epoch: 37, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.097 Vali Acc: 0.644 Test Loss: 1.097 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 38 cost time: 0.9569029808044434
Epoch: 38, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.082 Vali Acc: 0.648 Test Loss: 1.082 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 39 cost time: 1.3709490299224854
Epoch: 39, Steps: 2 | Train Loss: 0.393 Vali Loss: 1.067 Vali Acc: 0.667 Test Loss: 1.067 Test Acc: 0.667
Validation loss decreased (-0.648137 --> -0.666656).  Saving model ...
Epoch: 40 cost time: 1.3660032749176025
Epoch: 40, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.054 Vali Acc: 0.663 Test Loss: 1.054 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2589945793151855
Epoch: 41, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.041 Vali Acc: 0.663 Test Loss: 1.041 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3780758380889893
Epoch: 42, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.028 Vali Acc: 0.670 Test Loss: 1.028 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.670360).  Saving model ...
Epoch: 43 cost time: 1.3224730491638184
Epoch: 43, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.016 Vali Acc: 0.674 Test Loss: 1.016 Test Acc: 0.674
Validation loss decreased (-0.670360 --> -0.674064).  Saving model ...
Epoch: 44 cost time: 1.3635108470916748
Epoch: 44, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.004 Vali Acc: 0.678 Test Loss: 1.004 Test Acc: 0.678
Validation loss decreased (-0.674064 --> -0.677768).  Saving model ...
Epoch: 45 cost time: 1.4300274848937988
Epoch: 45, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.993 Vali Acc: 0.685 Test Loss: 0.993 Test Acc: 0.685
Validation loss decreased (-0.677768 --> -0.685175).  Saving model ...
Epoch: 46 cost time: 1.2979545593261719
Epoch: 46, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.982 Vali Acc: 0.689 Test Loss: 0.982 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688879).  Saving model ...
Epoch: 47 cost time: 1.2642436027526855
Epoch: 47, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.973 Vali Acc: 0.689 Test Loss: 0.973 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 48 cost time: 1.4359402656555176
Epoch: 48, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.965 Vali Acc: 0.693 Test Loss: 0.965 Test Acc: 0.693
Validation loss decreased (-0.688879 --> -0.692583).  Saving model ...
Epoch: 49 cost time: 1.297536849975586
Epoch: 49, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.957 Vali Acc: 0.696 Test Loss: 0.957 Test Acc: 0.696
Validation loss decreased (-0.692583 --> -0.696287).  Saving model ...
Epoch: 50 cost time: 1.3324637413024902
Epoch: 50, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.949 Vali Acc: 0.704 Test Loss: 0.949 Test Acc: 0.704
Validation loss decreased (-0.696287 --> -0.703694).  Saving model ...
Epoch: 51 cost time: 1.2805867195129395
Epoch: 51, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.942 Vali Acc: 0.704 Test Loss: 0.942 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 52 cost time: 1.4092226028442383
Epoch: 52, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
Validation loss decreased (-0.703694 --> -0.711102).  Saving model ...
Epoch: 53 cost time: 1.3464341163635254
Epoch: 53, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.931 Vali Acc: 0.711 Test Loss: 0.931 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 54 cost time: 1.313713788986206
Epoch: 54, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.927 Vali Acc: 0.711 Test Loss: 0.927 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 55 cost time: 1.4395990371704102
Epoch: 55, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.922 Vali Acc: 0.711 Test Loss: 0.922 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 56 cost time: 1.3670947551727295
Epoch: 56, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.919 Vali Acc: 0.704 Test Loss: 0.919 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3025872707366943
Epoch: 57, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.914 Vali Acc: 0.704 Test Loss: 0.914 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2681794166564941
Epoch: 58, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.911 Vali Acc: 0.704 Test Loss: 0.911 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1727972030639648
Epoch: 59, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.907 Vali Acc: 0.704 Test Loss: 0.907 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.198364019393921
Epoch: 60, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.903 Vali Acc: 0.704 Test Loss: 0.903 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2606244087219238
Epoch: 61, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.900 Vali Acc: 0.704 Test Loss: 0.900 Test Acc: 0.704
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2243564128875732
Epoch: 62, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.896 Vali Acc: 0.707 Test Loss: 0.896 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.323981523513794
Epoch: 63, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.892 Vali Acc: 0.707 Test Loss: 0.892 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.2654156684875488
Epoch: 64, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.889 Vali Acc: 0.707 Test Loss: 0.889 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.4268369674682617
Epoch: 65, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.885 Vali Acc: 0.707 Test Loss: 0.885 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7111111111111111
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0278255939483643
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.895 Vali Acc: 0.070 Test Loss: 1.895 Test Acc: 0.070
Validation loss decreased (inf --> -0.070351).  Saving model ...
Epoch: 2 cost time: 1.3201382160186768
Epoch: 2, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.886 Vali Acc: 0.074 Test Loss: 1.886 Test Acc: 0.074
Validation loss decreased (-0.070351 --> -0.074055).  Saving model ...
Epoch: 3 cost time: 1.0588750839233398
Epoch: 3, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.879 Vali Acc: 0.074 Test Loss: 1.879 Test Acc: 0.074
Validation loss decreased (-0.074055 --> -0.074055).  Saving model ...
Epoch: 4 cost time: 1.2417652606964111
Epoch: 4, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.871 Vali Acc: 0.074 Test Loss: 1.871 Test Acc: 0.074
Validation loss decreased (-0.074055 --> -0.074055).  Saving model ...
Epoch: 5 cost time: 1.1555132865905762
Epoch: 5, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.861 Vali Acc: 0.085 Test Loss: 1.861 Test Acc: 0.085
Validation loss decreased (-0.074055 --> -0.085167).  Saving model ...
Epoch: 6 cost time: 1.04158353805542
Epoch: 6, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.849 Vali Acc: 0.111 Test Loss: 1.849 Test Acc: 0.111
Validation loss decreased (-0.085167 --> -0.111093).  Saving model ...
Epoch: 7 cost time: 1.114825963973999
Epoch: 7, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.836 Vali Acc: 0.122 Test Loss: 1.836 Test Acc: 0.122
Validation loss decreased (-0.111093 --> -0.122204).  Saving model ...
Epoch: 8 cost time: 1.1403048038482666
Epoch: 8, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.821 Vali Acc: 0.137 Test Loss: 1.821 Test Acc: 0.137
Validation loss decreased (-0.122204 --> -0.137019).  Saving model ...
Epoch: 9 cost time: 1.2056589126586914
Epoch: 9, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.805 Vali Acc: 0.170 Test Loss: 1.805 Test Acc: 0.170
Validation loss decreased (-0.137019 --> -0.170352).  Saving model ...
Epoch: 10 cost time: 1.162827491760254
Epoch: 10, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.789 Vali Acc: 0.196 Test Loss: 1.789 Test Acc: 0.196
Validation loss decreased (-0.170352 --> -0.196278).  Saving model ...
Epoch: 11 cost time: 1.1817610263824463
Epoch: 11, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.772 Vali Acc: 0.226 Test Loss: 1.772 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 12 cost time: 1.1640782356262207
Epoch: 12, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.754 Vali Acc: 0.248 Test Loss: 1.754 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 13 cost time: 1.2591955661773682
Epoch: 13, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.735 Vali Acc: 0.293 Test Loss: 1.735 Test Acc: 0.293
Validation loss decreased (-0.248131 --> -0.292575).  Saving model ...
Epoch: 14 cost time: 1.132904291152954
Epoch: 14, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.717 Vali Acc: 0.344 Test Loss: 1.717 Test Acc: 0.344
Validation loss decreased (-0.292575 --> -0.344427).  Saving model ...
Epoch: 15 cost time: 0.9908056259155273
Epoch: 15, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.697 Vali Acc: 0.389 Test Loss: 1.697 Test Acc: 0.389
Validation loss decreased (-0.344427 --> -0.388872).  Saving model ...
Epoch: 16 cost time: 1.025475025177002
Epoch: 16, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.677 Vali Acc: 0.422 Test Loss: 1.677 Test Acc: 0.422
Validation loss decreased (-0.388872 --> -0.422205).  Saving model ...
Epoch: 17 cost time: 0.9240708351135254
Epoch: 17, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.657 Vali Acc: 0.437 Test Loss: 1.657 Test Acc: 0.437
Validation loss decreased (-0.422205 --> -0.437020).  Saving model ...
Epoch: 18 cost time: 1.1556999683380127
Epoch: 18, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.637 Vali Acc: 0.459 Test Loss: 1.637 Test Acc: 0.459
Validation loss decreased (-0.437020 --> -0.459243).  Saving model ...
Epoch: 19 cost time: 1.0113842487335205
Epoch: 19, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.617 Vali Acc: 0.485 Test Loss: 1.617 Test Acc: 0.485
Validation loss decreased (-0.459243 --> -0.485169).  Saving model ...
Epoch: 20 cost time: 1.1090738773345947
Epoch: 20, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.596 Vali Acc: 0.493 Test Loss: 1.596 Test Acc: 0.493
Validation loss decreased (-0.485169 --> -0.492577).  Saving model ...
Epoch: 21 cost time: 1.2156672477722168
Epoch: 21, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.576 Vali Acc: 0.500 Test Loss: 1.576 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499984).  Saving model ...
Epoch: 22 cost time: 1.1246516704559326
Epoch: 22, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.556 Vali Acc: 0.507 Test Loss: 1.556 Test Acc: 0.507
Validation loss decreased (-0.499984 --> -0.507392).  Saving model ...
Epoch: 23 cost time: 1.1400694847106934
Epoch: 23, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.535 Vali Acc: 0.526 Test Loss: 1.535 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 24 cost time: 1.3082897663116455
Epoch: 24, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.515 Vali Acc: 0.530 Test Loss: 1.515 Test Acc: 0.530
Validation loss decreased (-0.525911 --> -0.529614).  Saving model ...
Epoch: 25 cost time: 1.1669018268585205
Epoch: 25, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.494 Vali Acc: 0.537 Test Loss: 1.494 Test Acc: 0.537
Validation loss decreased (-0.529614 --> -0.537022).  Saving model ...
Epoch: 26 cost time: 1.3332552909851074
Epoch: 26, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.474 Vali Acc: 0.537 Test Loss: 1.474 Test Acc: 0.537
Validation loss decreased (-0.537022 --> -0.537022).  Saving model ...
Epoch: 27 cost time: 1.127108097076416
Epoch: 27, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.453 Vali Acc: 0.544 Test Loss: 1.453 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544430).  Saving model ...
Epoch: 28 cost time: 1.1741652488708496
Epoch: 28, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.434 Vali Acc: 0.548 Test Loss: 1.434 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 29 cost time: 1.1486101150512695
Epoch: 29, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.414 Vali Acc: 0.556 Test Loss: 1.414 Test Acc: 0.556
Validation loss decreased (-0.548134 --> -0.555541).  Saving model ...
Epoch: 30 cost time: 1.1134138107299805
Epoch: 30, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.395 Vali Acc: 0.556 Test Loss: 1.395 Test Acc: 0.556
Validation loss decreased (-0.555541 --> -0.555542).  Saving model ...
Epoch: 31 cost time: 1.2214810848236084
Epoch: 31, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.376 Vali Acc: 0.552 Test Loss: 1.376 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0686719417572021
Epoch: 32, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.358 Vali Acc: 0.552 Test Loss: 1.358 Test Acc: 0.552
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1196386814117432
Epoch: 33, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.340 Vali Acc: 0.556 Test Loss: 1.340 Test Acc: 0.556
Validation loss decreased (-0.555542 --> -0.555542).  Saving model ...
Epoch: 34 cost time: 1.179377794265747
Epoch: 34, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.322 Vali Acc: 0.559 Test Loss: 1.322 Test Acc: 0.559
Validation loss decreased (-0.555542 --> -0.559246).  Saving model ...
Epoch: 35 cost time: 1.1869077682495117
Epoch: 35, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.305 Vali Acc: 0.563 Test Loss: 1.305 Test Acc: 0.563
Validation loss decreased (-0.559246 --> -0.562950).  Saving model ...
Epoch: 36 cost time: 1.1690330505371094
Epoch: 36, Steps: 2 | Train Loss: 0.673 Vali Loss: 1.289 Vali Acc: 0.567 Test Loss: 1.289 Test Acc: 0.567
Validation loss decreased (-0.562950 --> -0.566654).  Saving model ...
Epoch: 37 cost time: 1.335127353668213
Epoch: 37, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.273 Vali Acc: 0.567 Test Loss: 1.273 Test Acc: 0.567
Validation loss decreased (-0.566654 --> -0.566654).  Saving model ...
Epoch: 38 cost time: 1.2490894794464111
Epoch: 38, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.257 Vali Acc: 0.578 Test Loss: 1.257 Test Acc: 0.578
Validation loss decreased (-0.566654 --> -0.577765).  Saving model ...
Epoch: 39 cost time: 1.0919921398162842
Epoch: 39, Steps: 2 | Train Loss: 0.607 Vali Loss: 1.241 Vali Acc: 0.581 Test Loss: 1.241 Test Acc: 0.581
Validation loss decreased (-0.577765 --> -0.581469).  Saving model ...
Epoch: 40 cost time: 1.1642420291900635
Epoch: 40, Steps: 2 | Train Loss: 0.521 Vali Loss: 1.227 Vali Acc: 0.578 Test Loss: 1.227 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.132587194442749
Epoch: 41, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.213 Vali Acc: 0.578 Test Loss: 1.213 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1213104724884033
Epoch: 42, Steps: 2 | Train Loss: 0.488 Vali Loss: 1.199 Vali Acc: 0.585 Test Loss: 1.199 Test Acc: 0.585
Validation loss decreased (-0.581469 --> -0.585173).  Saving model ...
Epoch: 43 cost time: 1.122013807296753
Epoch: 43, Steps: 2 | Train Loss: 0.489 Vali Loss: 1.185 Vali Acc: 0.585 Test Loss: 1.185 Test Acc: 0.585
Validation loss decreased (-0.585173 --> -0.585173).  Saving model ...
Epoch: 44 cost time: 1.2123677730560303
Epoch: 44, Steps: 2 | Train Loss: 0.460 Vali Loss: 1.171 Vali Acc: 0.585 Test Loss: 1.171 Test Acc: 0.585
Validation loss decreased (-0.585173 --> -0.585173).  Saving model ...
Epoch: 45 cost time: 1.087599277496338
Epoch: 45, Steps: 2 | Train Loss: 0.431 Vali Loss: 1.158 Vali Acc: 0.596 Test Loss: 1.158 Test Acc: 0.596
Validation loss decreased (-0.585173 --> -0.596285).  Saving model ...
Epoch: 46 cost time: 1.1607108116149902
Epoch: 46, Steps: 2 | Train Loss: 0.409 Vali Loss: 1.146 Vali Acc: 0.596 Test Loss: 1.146 Test Acc: 0.596
Validation loss decreased (-0.596285 --> -0.596285).  Saving model ...
Epoch: 47 cost time: 1.2083220481872559
Epoch: 47, Steps: 2 | Train Loss: 0.376 Vali Loss: 1.133 Vali Acc: 0.604 Test Loss: 1.133 Test Acc: 0.604
Validation loss decreased (-0.596285 --> -0.603692).  Saving model ...
Epoch: 48 cost time: 1.193100929260254
Epoch: 48, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.120 Vali Acc: 0.607 Test Loss: 1.120 Test Acc: 0.607
Validation loss decreased (-0.603692 --> -0.607396).  Saving model ...
Epoch: 49 cost time: 1.2556214332580566
Epoch: 49, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.109 Vali Acc: 0.611 Test Loss: 1.109 Test Acc: 0.611
Validation loss decreased (-0.607396 --> -0.611100).  Saving model ...
Epoch: 50 cost time: 1.2728912830352783
Epoch: 50, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.097 Vali Acc: 0.611 Test Loss: 1.097 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611100).  Saving model ...
Epoch: 51 cost time: 1.541954517364502
Epoch: 51, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.087 Vali Acc: 0.607 Test Loss: 1.087 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.077681064605713
Epoch: 52, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.078 Vali Acc: 0.607 Test Loss: 1.078 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0890204906463623
Epoch: 53, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.068 Vali Acc: 0.619 Test Loss: 1.068 Test Acc: 0.619
Validation loss decreased (-0.611100 --> -0.618508).  Saving model ...
Epoch: 54 cost time: 1.1825132369995117
Epoch: 54, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.059 Vali Acc: 0.626 Test Loss: 1.059 Test Acc: 0.626
Validation loss decreased (-0.618508 --> -0.625915).  Saving model ...
Epoch: 55 cost time: 1.2570106983184814
Epoch: 55, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.050 Vali Acc: 0.630 Test Loss: 1.050 Test Acc: 0.630
Validation loss decreased (-0.625915 --> -0.629619).  Saving model ...
Epoch: 56 cost time: 1.091510534286499
Epoch: 56, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.042 Vali Acc: 0.641 Test Loss: 1.042 Test Acc: 0.641
Validation loss decreased (-0.629619 --> -0.640730).  Saving model ...
Epoch: 57 cost time: 1.0014657974243164
Epoch: 57, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.032 Vali Acc: 0.641 Test Loss: 1.032 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640730).  Saving model ...
Epoch: 58 cost time: 1.1785557270050049
Epoch: 58, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.023 Vali Acc: 0.641 Test Loss: 1.023 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640731).  Saving model ...
Epoch: 59 cost time: 0.9697074890136719
Epoch: 59, Steps: 2 | Train Loss: 0.177 Vali Loss: 1.014 Vali Acc: 0.641 Test Loss: 1.014 Test Acc: 0.641
Validation loss decreased (-0.640731 --> -0.640731).  Saving model ...
Epoch: 60 cost time: 1.0754704475402832
Epoch: 60, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.004 Vali Acc: 0.644 Test Loss: 1.004 Test Acc: 0.644
Validation loss decreased (-0.640731 --> -0.644434).  Saving model ...
Epoch: 61 cost time: 1.0121312141418457
Epoch: 61, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.994 Vali Acc: 0.644 Test Loss: 0.994 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644435).  Saving model ...
Epoch: 62 cost time: 1.049229383468628
Epoch: 62, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.984 Vali Acc: 0.648 Test Loss: 0.984 Test Acc: 0.648
Validation loss decreased (-0.644435 --> -0.648138).  Saving model ...
Epoch: 63 cost time: 1.0952708721160889
Epoch: 63, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.974 Vali Acc: 0.652 Test Loss: 0.974 Test Acc: 0.652
Validation loss decreased (-0.648138 --> -0.651842).  Saving model ...
Epoch: 64 cost time: 1.1275253295898438
Epoch: 64, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.964 Vali Acc: 0.659 Test Loss: 0.964 Test Acc: 0.659
Validation loss decreased (-0.651842 --> -0.659250).  Saving model ...
Epoch: 65 cost time: 1.1086769104003906
Epoch: 65, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.955 Vali Acc: 0.659 Test Loss: 0.955 Test Acc: 0.659
Validation loss decreased (-0.659250 --> -0.659250).  Saving model ...
Epoch: 66 cost time: 0.9400608539581299
Epoch: 66, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.945 Vali Acc: 0.663 Test Loss: 0.945 Test Acc: 0.663
Validation loss decreased (-0.659250 --> -0.662954).  Saving model ...
Epoch: 67 cost time: 1.0553641319274902
Epoch: 67, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.935 Vali Acc: 0.667 Test Loss: 0.935 Test Acc: 0.667
Validation loss decreased (-0.662954 --> -0.666657).  Saving model ...
Epoch: 68 cost time: 1.0358333587646484
Epoch: 68, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.926 Vali Acc: 0.670 Test Loss: 0.926 Test Acc: 0.670
Validation loss decreased (-0.666657 --> -0.670361).  Saving model ...
Epoch: 69 cost time: 1.181912899017334
Epoch: 69, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.917 Vali Acc: 0.674 Test Loss: 0.917 Test Acc: 0.674
Validation loss decreased (-0.670361 --> -0.674065).  Saving model ...
Epoch: 70 cost time: 1.1489875316619873
Epoch: 70, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.908 Vali Acc: 0.678 Test Loss: 0.908 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 71 cost time: 1.1647706031799316
Epoch: 71, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.899 Vali Acc: 0.674 Test Loss: 0.899 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.3243145942687988
Epoch: 72, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.890 Vali Acc: 0.674 Test Loss: 0.890 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1926047801971436
Epoch: 73, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.881 Vali Acc: 0.685 Test Loss: 0.881 Test Acc: 0.685
Validation loss decreased (-0.677769 --> -0.685176).  Saving model ...
Epoch: 74 cost time: 1.1030149459838867
Epoch: 74, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.874 Vali Acc: 0.685 Test Loss: 0.874 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685176).  Saving model ...
Epoch: 75 cost time: 1.2394907474517822
Epoch: 75, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.866 Vali Acc: 0.693 Test Loss: 0.866 Test Acc: 0.693
Validation loss decreased (-0.685176 --> -0.692584).  Saving model ...
Epoch: 76 cost time: 1.1282215118408203
Epoch: 76, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
Validation loss decreased (-0.692584 --> -0.699991).  Saving model ...
Epoch: 77 cost time: 1.1851720809936523
Epoch: 77, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.851 Vali Acc: 0.707 Test Loss: 0.851 Test Acc: 0.707
Validation loss decreased (-0.699991 --> -0.707399).  Saving model ...
Epoch: 78 cost time: 1.2632694244384766
Epoch: 78, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.844 Vali Acc: 0.711 Test Loss: 0.844 Test Acc: 0.711
Validation loss decreased (-0.707399 --> -0.711103).  Saving model ...
Epoch: 79 cost time: 1.2224116325378418
Epoch: 79, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.837 Vali Acc: 0.711 Test Loss: 0.837 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 80 cost time: 1.0840814113616943
Epoch: 80, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.831 Vali Acc: 0.715 Test Loss: 0.831 Test Acc: 0.715
Validation loss decreased (-0.711103 --> -0.714807).  Saving model ...
Epoch: 81 cost time: 1.0481009483337402
Epoch: 81, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.824 Vali Acc: 0.715 Test Loss: 0.824 Test Acc: 0.715
Validation loss decreased (-0.714807 --> -0.714807).  Saving model ...
Epoch: 82 cost time: 1.0946471691131592
Epoch: 82, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.817 Vali Acc: 0.719 Test Loss: 0.817 Test Acc: 0.719
Validation loss decreased (-0.714807 --> -0.718510).  Saving model ...
Epoch: 83 cost time: 1.165787696838379
Epoch: 83, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.811 Vali Acc: 0.719 Test Loss: 0.811 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 84 cost time: 1.2889342308044434
Epoch: 84, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.805 Vali Acc: 0.726 Test Loss: 0.805 Test Acc: 0.726
Validation loss decreased (-0.718510 --> -0.725918).  Saving model ...
Epoch: 85 cost time: 1.1729333400726318
Epoch: 85, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.799 Vali Acc: 0.730 Test Loss: 0.799 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 86 cost time: 1.1645309925079346
Epoch: 86, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.793 Vali Acc: 0.733 Test Loss: 0.793 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733325).  Saving model ...
Epoch: 87 cost time: 1.1452910900115967
Epoch: 87, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.787 Vali Acc: 0.741 Test Loss: 0.787 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740733).  Saving model ...
Epoch: 88 cost time: 1.0703532695770264
Epoch: 88, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.781 Vali Acc: 0.744 Test Loss: 0.781 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 89 cost time: 1.155992031097412
Epoch: 89, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 90 cost time: 1.0764567852020264
Epoch: 90, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.770 Vali Acc: 0.748 Test Loss: 0.770 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 91 cost time: 1.0898222923278809
Epoch: 91, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.765 Vali Acc: 0.752 Test Loss: 0.765 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 92 cost time: 1.0161609649658203
Epoch: 92, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.760 Vali Acc: 0.748 Test Loss: 0.760 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.9778521060943604
Epoch: 93, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.755 Vali Acc: 0.748 Test Loss: 0.755 Test Acc: 0.748
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.9732275009155273
Epoch: 94, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 95 cost time: 1.2060301303863525
Epoch: 95, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 96 cost time: 1.3586630821228027
Epoch: 96, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.740 Vali Acc: 0.759 Test Loss: 0.740 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 97 cost time: 1.1396374702453613
Epoch: 97, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.735 Vali Acc: 0.759 Test Loss: 0.735 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 98 cost time: 1.2310421466827393
Epoch: 98, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.731 Vali Acc: 0.767 Test Loss: 0.731 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 99 cost time: 1.3572425842285156
Epoch: 99, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.727 Vali Acc: 0.770 Test Loss: 0.727 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 100 cost time: 1.425159215927124
Epoch: 100, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.724 Vali Acc: 0.770 Test Loss: 0.724 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7703703703703704
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4658915996551514
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.832 Vali Acc: 0.122 Test Loss: 1.832 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 1.1417231559753418
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.825 Vali Acc: 0.130 Test Loss: 1.825 Test Acc: 0.130
Validation loss decreased (-0.122204 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.214289903640747
Epoch: 3, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.820 Vali Acc: 0.133 Test Loss: 1.820 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133315).  Saving model ...
Epoch: 4 cost time: 1.2069272994995117
Epoch: 4, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.815 Vali Acc: 0.141 Test Loss: 1.815 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 5 cost time: 1.2545289993286133
Epoch: 5, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.807 Vali Acc: 0.152 Test Loss: 1.807 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 1.2596712112426758
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.799 Vali Acc: 0.159 Test Loss: 1.799 Test Acc: 0.159
Validation loss decreased (-0.151834 --> -0.159241).  Saving model ...
Epoch: 7 cost time: 1.3215727806091309
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.790 Vali Acc: 0.170 Test Loss: 1.790 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 8 cost time: 1.2922592163085938
Epoch: 8, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.780 Vali Acc: 0.185 Test Loss: 1.780 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 9 cost time: 1.2882568836212158
Epoch: 9, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
Validation loss decreased (-0.185167 --> -0.199982).  Saving model ...
Epoch: 10 cost time: 1.187342882156372
Epoch: 10, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.758 Vali Acc: 0.211 Test Loss: 1.758 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211094).  Saving model ...
Epoch: 11 cost time: 1.1621620655059814
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.746 Vali Acc: 0.233 Test Loss: 1.746 Test Acc: 0.233
Validation loss decreased (-0.211094 --> -0.233316).  Saving model ...
Epoch: 12 cost time: 1.2131986618041992
Epoch: 12, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.734 Vali Acc: 0.244 Test Loss: 1.734 Test Acc: 0.244
Validation loss decreased (-0.233316 --> -0.244427).  Saving model ...
Epoch: 13 cost time: 0.9710879325866699
Epoch: 13, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.721 Vali Acc: 0.300 Test Loss: 1.721 Test Acc: 0.300
Validation loss decreased (-0.244427 --> -0.299983).  Saving model ...
Epoch: 14 cost time: 1.231842041015625
Epoch: 14, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333316).  Saving model ...
Epoch: 15 cost time: 1.236452579498291
Epoch: 15, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.694 Vali Acc: 0.352 Test Loss: 1.694 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 16 cost time: 1.1593914031982422
Epoch: 16, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.680 Vali Acc: 0.378 Test Loss: 1.680 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377761).  Saving model ...
Epoch: 17 cost time: 1.1417231559753418
Epoch: 17, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.666 Vali Acc: 0.389 Test Loss: 1.666 Test Acc: 0.389
Validation loss decreased (-0.377761 --> -0.388872).  Saving model ...
Epoch: 18 cost time: 1.1680784225463867
Epoch: 18, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.652 Vali Acc: 0.404 Test Loss: 1.652 Test Acc: 0.404
Validation loss decreased (-0.388872 --> -0.403687).  Saving model ...
Epoch: 19 cost time: 1.1112735271453857
Epoch: 19, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.637 Vali Acc: 0.437 Test Loss: 1.637 Test Acc: 0.437
Validation loss decreased (-0.403687 --> -0.437021).  Saving model ...
Epoch: 20 cost time: 1.3472819328308105
Epoch: 20, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.622 Vali Acc: 0.456 Test Loss: 1.622 Test Acc: 0.456
Validation loss decreased (-0.437021 --> -0.455539).  Saving model ...
Epoch: 21 cost time: 1.1848280429840088
Epoch: 21, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.607 Vali Acc: 0.459 Test Loss: 1.607 Test Acc: 0.459
Validation loss decreased (-0.455539 --> -0.459243).  Saving model ...
Epoch: 22 cost time: 1.1684870719909668
Epoch: 22, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.591 Vali Acc: 0.478 Test Loss: 1.591 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477762).  Saving model ...
Epoch: 23 cost time: 1.577552080154419
Epoch: 23, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.575 Vali Acc: 0.493 Test Loss: 1.575 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 24 cost time: 1.299281358718872
Epoch: 24, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.559 Vali Acc: 0.496 Test Loss: 1.559 Test Acc: 0.496
Validation loss decreased (-0.492577 --> -0.496281).  Saving model ...
Epoch: 25 cost time: 1.2580890655517578
Epoch: 25, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.542 Vali Acc: 0.500 Test Loss: 1.542 Test Acc: 0.500
Validation loss decreased (-0.496281 --> -0.499985).  Saving model ...
Epoch: 26 cost time: 1.1242973804473877
Epoch: 26, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518503).  Saving model ...
Epoch: 27 cost time: 1.1514205932617188
Epoch: 27, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.508 Vali Acc: 0.530 Test Loss: 1.508 Test Acc: 0.530
Validation loss decreased (-0.518503 --> -0.529615).  Saving model ...
Epoch: 28 cost time: 1.2424061298370361
Epoch: 28, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.491 Vali Acc: 0.533 Test Loss: 1.491 Test Acc: 0.533
Validation loss decreased (-0.529615 --> -0.533318).  Saving model ...
Epoch: 29 cost time: 1.145761251449585
Epoch: 29, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.474 Vali Acc: 0.533 Test Loss: 1.474 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533319).  Saving model ...
Epoch: 30 cost time: 1.1144797801971436
Epoch: 30, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.456 Vali Acc: 0.537 Test Loss: 1.456 Test Acc: 0.537
Validation loss decreased (-0.533319 --> -0.537022).  Saving model ...
Epoch: 31 cost time: 1.1816847324371338
Epoch: 31, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.537022 --> -0.551837).  Saving model ...
Epoch: 32 cost time: 1.1479125022888184
Epoch: 32, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.422 Vali Acc: 0.556 Test Loss: 1.422 Test Acc: 0.556
Validation loss decreased (-0.551837 --> -0.555541).  Saving model ...
Epoch: 33 cost time: 1.093153476715088
Epoch: 33, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.404 Vali Acc: 0.559 Test Loss: 1.404 Test Acc: 0.559
Validation loss decreased (-0.555541 --> -0.559245).  Saving model ...
Epoch: 34 cost time: 1.2701139450073242
Epoch: 34, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.386 Vali Acc: 0.563 Test Loss: 1.386 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 35 cost time: 1.222266674041748
Epoch: 35, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.368 Vali Acc: 0.567 Test Loss: 1.368 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566653).  Saving model ...
Epoch: 36 cost time: 1.1631784439086914
Epoch: 36, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.566653 --> -0.588875).  Saving model ...
Epoch: 37 cost time: 1.408442497253418
Epoch: 37, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.333 Vali Acc: 0.589 Test Loss: 1.333 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588876).  Saving model ...
Epoch: 38 cost time: 1.251152753829956
Epoch: 38, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.314 Vali Acc: 0.604 Test Loss: 1.314 Test Acc: 0.604
Validation loss decreased (-0.588876 --> -0.603691).  Saving model ...
Epoch: 39 cost time: 1.2719206809997559
Epoch: 39, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.250046730041504
Epoch: 40, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.276 Vali Acc: 0.619 Test Loss: 1.276 Test Acc: 0.619
Validation loss decreased (-0.603691 --> -0.618506).  Saving model ...
Epoch: 41 cost time: 1.0318779945373535
Epoch: 41, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.256 Vali Acc: 0.630 Test Loss: 1.256 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629617).  Saving model ...
Epoch: 42 cost time: 1.4164397716522217
Epoch: 42, Steps: 2 | Train Loss: 0.742 Vali Loss: 1.234 Vali Acc: 0.630 Test Loss: 1.234 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 43 cost time: 1.125044345855713
Epoch: 43, Steps: 2 | Train Loss: 0.741 Vali Loss: 1.211 Vali Acc: 0.652 Test Loss: 1.211 Test Acc: 0.652
Validation loss decreased (-0.629617 --> -0.651840).  Saving model ...
Epoch: 44 cost time: 1.1802058219909668
Epoch: 44, Steps: 2 | Train Loss: 0.695 Vali Loss: 1.188 Vali Acc: 0.659 Test Loss: 1.188 Test Acc: 0.659
Validation loss decreased (-0.651840 --> -0.659247).  Saving model ...
Epoch: 45 cost time: 1.2682037353515625
Epoch: 45, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.165 Vali Acc: 0.674 Test Loss: 1.165 Test Acc: 0.674
Validation loss decreased (-0.659247 --> -0.674062).  Saving model ...
Epoch: 46 cost time: 1.2679057121276855
Epoch: 46, Steps: 2 | Train Loss: 0.640 Vali Loss: 1.142 Vali Acc: 0.674 Test Loss: 1.142 Test Acc: 0.674
Validation loss decreased (-0.674062 --> -0.674063).  Saving model ...
Epoch: 47 cost time: 1.206130027770996
Epoch: 47, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.119 Vali Acc: 0.681 Test Loss: 1.119 Test Acc: 0.681
Validation loss decreased (-0.674063 --> -0.681470).  Saving model ...
Epoch: 48 cost time: 1.3778190612792969
Epoch: 48, Steps: 2 | Train Loss: 0.570 Vali Loss: 1.096 Vali Acc: 0.689 Test Loss: 1.096 Test Acc: 0.689
Validation loss decreased (-0.681470 --> -0.688878).  Saving model ...
Epoch: 49 cost time: 1.2850520610809326
Epoch: 49, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.073 Vali Acc: 0.693 Test Loss: 1.073 Test Acc: 0.693
Validation loss decreased (-0.688878 --> -0.692582).  Saving model ...
Epoch: 50 cost time: 1.356351613998413
Epoch: 50, Steps: 2 | Train Loss: 0.537 Vali Loss: 1.050 Vali Acc: 0.693 Test Loss: 1.050 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 51 cost time: 1.3269016742706299
Epoch: 51, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.027 Vali Acc: 0.693 Test Loss: 1.027 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 52 cost time: 1.2927558422088623
Epoch: 52, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.006 Vali Acc: 0.696 Test Loss: 1.006 Test Acc: 0.696
Validation loss decreased (-0.692582 --> -0.696286).  Saving model ...
Epoch: 53 cost time: 1.261472463607788
Epoch: 53, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
Validation loss decreased (-0.696286 --> -0.699990).  Saving model ...
Epoch: 54 cost time: 1.2167894840240479
Epoch: 54, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.965 Vali Acc: 0.707 Test Loss: 0.965 Test Acc: 0.707
Validation loss decreased (-0.699990 --> -0.707398).  Saving model ...
Epoch: 55 cost time: 1.2164325714111328
Epoch: 55, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.945 Vali Acc: 0.707 Test Loss: 0.945 Test Acc: 0.707
Validation loss decreased (-0.707398 --> -0.707398).  Saving model ...
Epoch: 56 cost time: 1.166450023651123
Epoch: 56, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.926 Vali Acc: 0.711 Test Loss: 0.926 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 57 cost time: 1.0016734600067139
Epoch: 57, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.907 Vali Acc: 0.715 Test Loss: 0.907 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 58 cost time: 0.982865571975708
Epoch: 58, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.888 Vali Acc: 0.719 Test Loss: 0.888 Test Acc: 0.719
Validation loss decreased (-0.714806 --> -0.718510).  Saving model ...
Epoch: 59 cost time: 1.0927228927612305
Epoch: 59, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.871 Vali Acc: 0.730 Test Loss: 0.871 Test Acc: 0.730
Validation loss decreased (-0.718510 --> -0.729621).  Saving model ...
Epoch: 60 cost time: 1.2583277225494385
Epoch: 60, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.855 Vali Acc: 0.733 Test Loss: 0.855 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 61 cost time: 1.2088980674743652
Epoch: 61, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.840 Vali Acc: 0.752 Test Loss: 0.840 Test Acc: 0.752
Validation loss decreased (-0.733325 --> -0.751843).  Saving model ...
Epoch: 62 cost time: 0.9634206295013428
Epoch: 62, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.825 Vali Acc: 0.752 Test Loss: 0.825 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751844).  Saving model ...
Epoch: 63 cost time: 1.133117437362671
Epoch: 63, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.811 Vali Acc: 0.752 Test Loss: 0.811 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 64 cost time: 1.0369508266448975
Epoch: 64, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.798 Vali Acc: 0.752 Test Loss: 0.798 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 65 cost time: 1.2168619632720947
Epoch: 65, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.786 Vali Acc: 0.752 Test Loss: 0.786 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 66 cost time: 1.1633954048156738
Epoch: 66, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.775 Vali Acc: 0.748 Test Loss: 0.775 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0401973724365234
Epoch: 67, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.763 Vali Acc: 0.748 Test Loss: 0.763 Test Acc: 0.748
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1503417491912842
Epoch: 68, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.752 Vali Acc: 0.759 Test Loss: 0.752 Test Acc: 0.759
Validation loss decreased (-0.751844 --> -0.759252).  Saving model ...
Epoch: 69 cost time: 1.1420345306396484
Epoch: 69, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.741 Vali Acc: 0.759 Test Loss: 0.741 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 70 cost time: 1.0396370887756348
Epoch: 70, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.730 Vali Acc: 0.759 Test Loss: 0.730 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 71 cost time: 1.1864228248596191
Epoch: 71, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.719 Vali Acc: 0.759 Test Loss: 0.719 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 72 cost time: 0.9853205680847168
Epoch: 72, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.704 Vali Acc: 0.759 Test Loss: 0.704 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 73 cost time: 1.4272196292877197
Epoch: 73, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 74 cost time: 1.2050435543060303
Epoch: 74, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770364).  Saving model ...
Epoch: 75 cost time: 1.2169606685638428
Epoch: 75, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.669 Vali Acc: 0.778 Test Loss: 0.669 Test Acc: 0.778
Validation loss decreased (-0.770364 --> -0.777771).  Saving model ...
Epoch: 76 cost time: 1.3555150032043457
Epoch: 76, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.659 Vali Acc: 0.778 Test Loss: 0.659 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 77 cost time: 1.1770586967468262
Epoch: 77, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.651 Vali Acc: 0.781 Test Loss: 0.651 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 78 cost time: 1.2224819660186768
Epoch: 78, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.643 Vali Acc: 0.781 Test Loss: 0.643 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 79 cost time: 1.0648751258850098
Epoch: 79, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.635 Vali Acc: 0.781 Test Loss: 0.635 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 80 cost time: 1.3791272640228271
Epoch: 80, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.627 Vali Acc: 0.781 Test Loss: 0.627 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 81 cost time: 1.2285118103027344
Epoch: 81, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.618 Vali Acc: 0.793 Test Loss: 0.618 Test Acc: 0.793
Validation loss decreased (-0.781475 --> -0.792586).  Saving model ...
Epoch: 82 cost time: 1.0697903633117676
Epoch: 82, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.610 Vali Acc: 0.793 Test Loss: 0.610 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 83 cost time: 1.1288914680480957
Epoch: 83, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.604 Vali Acc: 0.793 Test Loss: 0.604 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792587).  Saving model ...
Epoch: 84 cost time: 1.1246931552886963
Epoch: 84, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.598 Vali Acc: 0.793 Test Loss: 0.598 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 85 cost time: 1.2207310199737549
Epoch: 85, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.593 Vali Acc: 0.793 Test Loss: 0.593 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 86 cost time: 1.0771825313568115
Epoch: 86, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.587 Vali Acc: 0.793 Test Loss: 0.587 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 87 cost time: 1.218721866607666
Epoch: 87, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.582 Vali Acc: 0.793 Test Loss: 0.582 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 88 cost time: 1.3684699535369873
Epoch: 88, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.578 Vali Acc: 0.793 Test Loss: 0.578 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 89 cost time: 1.127478837966919
Epoch: 89, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.574 Vali Acc: 0.793 Test Loss: 0.574 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 90 cost time: 1.1915242671966553
Epoch: 90, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.570 Vali Acc: 0.793 Test Loss: 0.570 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 91 cost time: 1.2676877975463867
Epoch: 91, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.568 Vali Acc: 0.793 Test Loss: 0.568 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 92 cost time: 1.2649283409118652
Epoch: 92, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.567 Vali Acc: 0.793 Test Loss: 0.567 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 93 cost time: 1.1496284008026123
Epoch: 93, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.567 Vali Acc: 0.793 Test Loss: 0.567 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 94 cost time: 1.2035658359527588
Epoch: 94, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.567 Vali Acc: 0.793 Test Loss: 0.567 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 95 cost time: 1.1416990756988525
Epoch: 95, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796291).  Saving model ...
Epoch: 96 cost time: 1.3392126560211182
Epoch: 96, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.796291 --> -0.796291).  Saving model ...
Epoch: 97 cost time: 1.2301881313323975
Epoch: 97, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
Validation loss decreased (-0.796291 --> -0.796291).  Saving model ...
Epoch: 98 cost time: 1.1642401218414307
Epoch: 98, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
Validation loss decreased (-0.796291 --> -0.799994).  Saving model ...
Epoch: 99 cost time: 1.0383644104003906
Epoch: 99, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 100 cost time: 1.146662950515747
Epoch: 100, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.915252447128296
Epoch: 1, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.829 Vali Acc: 0.181 Test Loss: 1.829 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 1.0896599292755127
Epoch: 2, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.825 Vali Acc: 0.193 Test Loss: 1.825 Test Acc: 0.193
Validation loss decreased (-0.181463 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 1.121976375579834
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.821 Vali Acc: 0.200 Test Loss: 1.821 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.0514657497406006
Epoch: 4, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 1.1380550861358643
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.807 Vali Acc: 0.204 Test Loss: 1.807 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.9107818603515625
Epoch: 6, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.798 Vali Acc: 0.211 Test Loss: 1.798 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211093).  Saving model ...
Epoch: 7 cost time: 1.1042876243591309
Epoch: 7, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.788 Vali Acc: 0.226 Test Loss: 1.788 Test Acc: 0.226
Validation loss decreased (-0.211093 --> -0.225908).  Saving model ...
Epoch: 8 cost time: 1.0003175735473633
Epoch: 8, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.776 Vali Acc: 0.241 Test Loss: 1.776 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 1.0616648197174072
Epoch: 9, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.764 Vali Acc: 0.256 Test Loss: 1.764 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 1.117520809173584
Epoch: 10, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
Validation loss decreased (-0.255538 --> -0.259242).  Saving model ...
Epoch: 11 cost time: 1.098341941833496
Epoch: 11, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.736 Vali Acc: 0.274 Test Loss: 1.736 Test Acc: 0.274
Validation loss decreased (-0.259242 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 1.1072461605072021
Epoch: 12, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.721 Vali Acc: 0.311 Test Loss: 1.721 Test Acc: 0.311
Validation loss decreased (-0.274057 --> -0.311094).  Saving model ...
Epoch: 13 cost time: 1.1349539756774902
Epoch: 13, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.706 Vali Acc: 0.337 Test Loss: 1.706 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 14 cost time: 1.2014808654785156
Epoch: 14, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.689 Vali Acc: 0.344 Test Loss: 1.689 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 15 cost time: 1.0997211933135986
Epoch: 15, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.672 Vali Acc: 0.356 Test Loss: 1.672 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 16 cost time: 1.2266442775726318
Epoch: 16, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.654 Vali Acc: 0.374 Test Loss: 1.654 Test Acc: 0.374
Validation loss decreased (-0.355539 --> -0.374058).  Saving model ...
Epoch: 17 cost time: 1.1400063037872314
Epoch: 17, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.636 Vali Acc: 0.404 Test Loss: 1.636 Test Acc: 0.404
Validation loss decreased (-0.374058 --> -0.403687).  Saving model ...
Epoch: 18 cost time: 1.1386735439300537
Epoch: 18, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.616 Vali Acc: 0.415 Test Loss: 1.616 Test Acc: 0.415
Validation loss decreased (-0.403687 --> -0.414799).  Saving model ...
Epoch: 19 cost time: 1.0484592914581299
Epoch: 19, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.596 Vali Acc: 0.426 Test Loss: 1.596 Test Acc: 0.426
Validation loss decreased (-0.414799 --> -0.425910).  Saving model ...
Epoch: 20 cost time: 1.1882603168487549
Epoch: 20, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.576 Vali Acc: 0.444 Test Loss: 1.576 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 1.2067549228668213
Epoch: 21, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.555 Vali Acc: 0.467 Test Loss: 1.555 Test Acc: 0.467
Validation loss decreased (-0.444429 --> -0.466651).  Saving model ...
Epoch: 22 cost time: 1.1233878135681152
Epoch: 22, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.533 Vali Acc: 0.485 Test Loss: 1.533 Test Acc: 0.485
Validation loss decreased (-0.466651 --> -0.485170).  Saving model ...
Epoch: 23 cost time: 1.2952113151550293
Epoch: 23, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.511 Vali Acc: 0.500 Test Loss: 1.511 Test Acc: 0.500
Validation loss decreased (-0.485170 --> -0.499985).  Saving model ...
Epoch: 24 cost time: 1.141676902770996
Epoch: 24, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.489 Vali Acc: 0.507 Test Loss: 1.489 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507393).  Saving model ...
Epoch: 25 cost time: 1.1919095516204834
Epoch: 25, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.466 Vali Acc: 0.522 Test Loss: 1.466 Test Acc: 0.522
Validation loss decreased (-0.507393 --> -0.522208).  Saving model ...
Epoch: 26 cost time: 1.1592354774475098
Epoch: 26, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.443 Vali Acc: 0.526 Test Loss: 1.443 Test Acc: 0.526
Validation loss decreased (-0.522208 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 1.2050590515136719
Epoch: 27, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.420 Vali Acc: 0.537 Test Loss: 1.420 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537023).  Saving model ...
Epoch: 28 cost time: 1.0774736404418945
Epoch: 28, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.396 Vali Acc: 0.548 Test Loss: 1.396 Test Acc: 0.548
Validation loss decreased (-0.537023 --> -0.548134).  Saving model ...
Epoch: 29 cost time: 1.1597139835357666
Epoch: 29, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.372 Vali Acc: 0.559 Test Loss: 1.372 Test Acc: 0.559
Validation loss decreased (-0.548134 --> -0.559246).  Saving model ...
Epoch: 30 cost time: 1.022439956665039
Epoch: 30, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.347 Vali Acc: 0.581 Test Loss: 1.347 Test Acc: 0.581
Validation loss decreased (-0.559246 --> -0.581468).  Saving model ...
Epoch: 31 cost time: 1.074517011642456
Epoch: 31, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.323 Vali Acc: 0.585 Test Loss: 1.323 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 32 cost time: 1.0953283309936523
Epoch: 32, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.299 Vali Acc: 0.596 Test Loss: 1.299 Test Acc: 0.596
Validation loss decreased (-0.585172 --> -0.596283).  Saving model ...
Epoch: 33 cost time: 1.0200984477996826
Epoch: 33, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.274 Vali Acc: 0.615 Test Loss: 1.274 Test Acc: 0.615
Validation loss decreased (-0.596283 --> -0.614802).  Saving model ...
Epoch: 34 cost time: 1.2253410816192627
Epoch: 34, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.249 Vali Acc: 0.630 Test Loss: 1.249 Test Acc: 0.630
Validation loss decreased (-0.614802 --> -0.629617).  Saving model ...
Epoch: 35 cost time: 1.1014659404754639
Epoch: 35, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.224 Vali Acc: 0.630 Test Loss: 1.224 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 36 cost time: 1.0456533432006836
Epoch: 36, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.200 Vali Acc: 0.641 Test Loss: 1.200 Test Acc: 0.641
Validation loss decreased (-0.629617 --> -0.640729).  Saving model ...
Epoch: 37 cost time: 1.3066158294677734
Epoch: 37, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.174 Vali Acc: 0.659 Test Loss: 1.174 Test Acc: 0.659
Validation loss decreased (-0.640729 --> -0.659248).  Saving model ...
Epoch: 38 cost time: 1.2352564334869385
Epoch: 38, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.149 Vali Acc: 0.681 Test Loss: 1.149 Test Acc: 0.681
Validation loss decreased (-0.659248 --> -0.681470).  Saving model ...
Epoch: 39 cost time: 1.3468728065490723
Epoch: 39, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.124 Vali Acc: 0.681 Test Loss: 1.124 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 40 cost time: 1.2844305038452148
Epoch: 40, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.099 Vali Acc: 0.689 Test Loss: 1.099 Test Acc: 0.689
Validation loss decreased (-0.681470 --> -0.688878).  Saving model ...
Epoch: 41 cost time: 1.262801170349121
Epoch: 41, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.074 Vali Acc: 0.711 Test Loss: 1.074 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711100).  Saving model ...
Epoch: 42 cost time: 1.215299367904663
Epoch: 42, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.048 Vali Acc: 0.726 Test Loss: 1.048 Test Acc: 0.726
Validation loss decreased (-0.711100 --> -0.725915).  Saving model ...
Epoch: 43 cost time: 1.397796630859375
Epoch: 43, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.021 Vali Acc: 0.741 Test Loss: 1.021 Test Acc: 0.741
Validation loss decreased (-0.725915 --> -0.740731).  Saving model ...
Epoch: 44 cost time: 1.155951738357544
Epoch: 44, Steps: 2 | Train Loss: 1.112 Vali Loss: 0.995 Vali Acc: 0.748 Test Loss: 0.995 Test Acc: 0.748
Validation loss decreased (-0.740731 --> -0.748138).  Saving model ...
Epoch: 45 cost time: 1.1132736206054688
Epoch: 45, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.969 Vali Acc: 0.759 Test Loss: 0.969 Test Acc: 0.759
Validation loss decreased (-0.748138 --> -0.759250).  Saving model ...
Epoch: 46 cost time: 1.1864063739776611
Epoch: 46, Steps: 2 | Train Loss: 0.985 Vali Loss: 0.943 Vali Acc: 0.778 Test Loss: 0.943 Test Acc: 0.778
Validation loss decreased (-0.759250 --> -0.777768).  Saving model ...
Epoch: 47 cost time: 1.1710011959075928
Epoch: 47, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.917 Vali Acc: 0.789 Test Loss: 0.917 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 48 cost time: 1.1691110134124756
Epoch: 48, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799991).  Saving model ...
Epoch: 49 cost time: 1.279444932937622
Epoch: 49, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.865 Vali Acc: 0.819 Test Loss: 0.865 Test Acc: 0.819
Validation loss decreased (-0.799991 --> -0.818510).  Saving model ...
Epoch: 50 cost time: 1.1345455646514893
Epoch: 50, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.838 Vali Acc: 0.819 Test Loss: 0.838 Test Acc: 0.819
Validation loss decreased (-0.818510 --> -0.818510).  Saving model ...
Epoch: 51 cost time: 1.2039012908935547
Epoch: 51, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.812 Vali Acc: 0.822 Test Loss: 0.812 Test Acc: 0.822
Validation loss decreased (-0.818510 --> -0.822214).  Saving model ...
Epoch: 52 cost time: 1.088803768157959
Epoch: 52, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.786 Vali Acc: 0.822 Test Loss: 0.786 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 53 cost time: 1.1781129837036133
Epoch: 53, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.761 Vali Acc: 0.826 Test Loss: 0.761 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 54 cost time: 1.0835628509521484
Epoch: 54, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.158731460571289
Epoch: 55, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.712 Vali Acc: 0.819 Test Loss: 0.712 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.124570608139038
Epoch: 56, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.688 Vali Acc: 0.819 Test Loss: 0.688 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2040073871612549
Epoch: 57, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.045884132385254
Epoch: 58, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833327).  Saving model ...
Epoch: 59 cost time: 1.076439380645752
Epoch: 59, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 60 cost time: 1.3180665969848633
Epoch: 60, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.588 Vali Acc: 0.837 Test Loss: 0.588 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 61 cost time: 1.2100467681884766
Epoch: 61, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
Validation loss decreased (-0.837031 --> -0.844439).  Saving model ...
Epoch: 62 cost time: 1.1313471794128418
Epoch: 62, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 63 cost time: 1.0958948135375977
Epoch: 63, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3057851791381836
Epoch: 64, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 65 cost time: 1.2033915519714355
Epoch: 65, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 66 cost time: 1.2004597187042236
Epoch: 66, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.470 Vali Acc: 0.852 Test Loss: 0.470 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 67 cost time: 1.367739200592041
Epoch: 67, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859255).  Saving model ...
Epoch: 68 cost time: 1.20796537399292
Epoch: 68, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.432 Vali Acc: 0.859 Test Loss: 0.432 Test Acc: 0.859
Validation loss decreased (-0.859255 --> -0.859255).  Saving model ...
Epoch: 69 cost time: 1.1970884799957275
Epoch: 69, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.859255 --> -0.877774).  Saving model ...
Epoch: 70 cost time: 1.0187885761260986
Epoch: 70, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.397 Vali Acc: 0.881 Test Loss: 0.397 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 71 cost time: 1.1877083778381348
Epoch: 71, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888885).  Saving model ...
Epoch: 72 cost time: 1.248431921005249
Epoch: 72, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.369 Vali Acc: 0.893 Test Loss: 0.369 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 73 cost time: 1.0358874797821045
Epoch: 73, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 1.1348276138305664
Epoch: 74, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.346 Vali Acc: 0.904 Test Loss: 0.346 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 75 cost time: 1.1373498439788818
Epoch: 75, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0793111324310303
Epoch: 76, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.893 Test Loss: 0.330 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.955718994140625
Epoch: 77, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.326 Vali Acc: 0.885 Test Loss: 0.326 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.0814447402954102
Epoch: 78, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.321 Vali Acc: 0.885 Test Loss: 0.321 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.2168402671813965
Epoch: 79, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.317 Vali Acc: 0.885 Test Loss: 0.317 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.1806070804595947
Epoch: 80, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.116612434387207
Epoch: 81, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.307 Vali Acc: 0.885 Test Loss: 0.307 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.1174383163452148
Epoch: 82, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.253504991531372
Epoch: 83, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.298 Vali Acc: 0.885 Test Loss: 0.298 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.2281904220581055
Epoch: 84, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.294 Vali Acc: 0.885 Test Loss: 0.294 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.750680446624756
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.884 Vali Acc: 0.144 Test Loss: 1.884 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.2268495559692383
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.881 Vali Acc: 0.152 Test Loss: 1.881 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 1.067568302154541
Epoch: 3, Steps: 2 | Train Loss: 2.019 Vali Loss: 1.877 Vali Acc: 0.156 Test Loss: 1.877 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 1.2036657333374023
Epoch: 4, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.871 Vali Acc: 0.156 Test Loss: 1.871 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 1.3306889533996582
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.864 Vali Acc: 0.170 Test Loss: 1.864 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 6 cost time: 1.4009230136871338
Epoch: 6, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.855 Vali Acc: 0.185 Test Loss: 1.855 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 1.2675557136535645
Epoch: 7, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.845 Vali Acc: 0.193 Test Loss: 1.845 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 8 cost time: 1.2314245700836182
Epoch: 8, Steps: 2 | Train Loss: 1.944 Vali Loss: 1.833 Vali Acc: 0.219 Test Loss: 1.833 Test Acc: 0.219
Validation loss decreased (-0.192574 --> -0.218500).  Saving model ...
Epoch: 9 cost time: 1.302445888519287
Epoch: 9, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.821 Vali Acc: 0.233 Test Loss: 1.821 Test Acc: 0.233
Validation loss decreased (-0.218500 --> -0.233315).  Saving model ...
Epoch: 10 cost time: 1.2423276901245117
Epoch: 10, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.807 Vali Acc: 0.244 Test Loss: 1.807 Test Acc: 0.244
Validation loss decreased (-0.233315 --> -0.244426).  Saving model ...
Epoch: 11 cost time: 1.1391055583953857
Epoch: 11, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.793 Vali Acc: 0.252 Test Loss: 1.793 Test Acc: 0.252
Validation loss decreased (-0.244426 --> -0.251834).  Saving model ...
Epoch: 12 cost time: 1.1370570659637451
Epoch: 12, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.778 Vali Acc: 0.274 Test Loss: 1.778 Test Acc: 0.274
Validation loss decreased (-0.251834 --> -0.274056).  Saving model ...
Epoch: 13 cost time: 1.123429298400879
Epoch: 13, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.762 Vali Acc: 0.293 Test Loss: 1.762 Test Acc: 0.293
Validation loss decreased (-0.274056 --> -0.292575).  Saving model ...
Epoch: 14 cost time: 1.150728464126587
Epoch: 14, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.746 Vali Acc: 0.304 Test Loss: 1.746 Test Acc: 0.304
Validation loss decreased (-0.292575 --> -0.303686).  Saving model ...
Epoch: 15 cost time: 1.2533533573150635
Epoch: 15, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.729 Vali Acc: 0.322 Test Loss: 1.729 Test Acc: 0.322
Validation loss decreased (-0.303686 --> -0.322205).  Saving model ...
Epoch: 16 cost time: 1.2064111232757568
Epoch: 16, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.711 Vali Acc: 0.348 Test Loss: 1.711 Test Acc: 0.348
Validation loss decreased (-0.322205 --> -0.348131).  Saving model ...
Epoch: 17 cost time: 1.2218823432922363
Epoch: 17, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.693 Vali Acc: 0.370 Test Loss: 1.693 Test Acc: 0.370
Validation loss decreased (-0.348131 --> -0.370353).  Saving model ...
Epoch: 18 cost time: 1.249962329864502
Epoch: 18, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.674 Vali Acc: 0.381 Test Loss: 1.674 Test Acc: 0.381
Validation loss decreased (-0.370353 --> -0.381465).  Saving model ...
Epoch: 19 cost time: 1.3094394207000732
Epoch: 19, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.655 Vali Acc: 0.400 Test Loss: 1.655 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399983).  Saving model ...
Epoch: 20 cost time: 1.2358369827270508
Epoch: 20, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.635 Vali Acc: 0.415 Test Loss: 1.635 Test Acc: 0.415
Validation loss decreased (-0.399983 --> -0.414798).  Saving model ...
Epoch: 21 cost time: 1.2198822498321533
Epoch: 21, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.614 Vali Acc: 0.437 Test Loss: 1.614 Test Acc: 0.437
Validation loss decreased (-0.414798 --> -0.437021).  Saving model ...
Epoch: 22 cost time: 1.3070926666259766
Epoch: 22, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.594 Vali Acc: 0.452 Test Loss: 1.594 Test Acc: 0.452
Validation loss decreased (-0.437021 --> -0.451836).  Saving model ...
Epoch: 23 cost time: 1.1585772037506104
Epoch: 23, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.573 Vali Acc: 0.474 Test Loss: 1.573 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474058).  Saving model ...
Epoch: 24 cost time: 1.234102725982666
Epoch: 24, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.551 Vali Acc: 0.496 Test Loss: 1.551 Test Acc: 0.496
Validation loss decreased (-0.474058 --> -0.496281).  Saving model ...
Epoch: 25 cost time: 1.3317086696624756
Epoch: 25, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.528 Vali Acc: 0.507 Test Loss: 1.528 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 26 cost time: 1.2696359157562256
Epoch: 26, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.505 Vali Acc: 0.526 Test Loss: 1.505 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 1.1138672828674316
Epoch: 27, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.483 Vali Acc: 0.537 Test Loss: 1.483 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 28 cost time: 1.037794828414917
Epoch: 28, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.460 Vali Acc: 0.559 Test Loss: 1.460 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559245).  Saving model ...
Epoch: 29 cost time: 1.2205958366394043
Epoch: 29, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.437 Vali Acc: 0.567 Test Loss: 1.437 Test Acc: 0.567
Validation loss decreased (-0.559245 --> -0.566652).  Saving model ...
Epoch: 30 cost time: 1.1256988048553467
Epoch: 30, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.414 Vali Acc: 0.578 Test Loss: 1.414 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577764).  Saving model ...
Epoch: 31 cost time: 1.1743650436401367
Epoch: 31, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.390 Vali Acc: 0.593 Test Loss: 1.390 Test Acc: 0.593
Validation loss decreased (-0.577764 --> -0.592579).  Saving model ...
Epoch: 32 cost time: 1.2631142139434814
Epoch: 32, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.366 Vali Acc: 0.604 Test Loss: 1.366 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 33 cost time: 1.1959590911865234
Epoch: 33, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.341 Vali Acc: 0.604 Test Loss: 1.341 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 34 cost time: 1.2263574600219727
Epoch: 34, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.317 Vali Acc: 0.622 Test Loss: 1.317 Test Acc: 0.622
Validation loss decreased (-0.603690 --> -0.622209).  Saving model ...
Epoch: 35 cost time: 1.2340400218963623
Epoch: 35, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.292 Vali Acc: 0.630 Test Loss: 1.292 Test Acc: 0.630
Validation loss decreased (-0.622209 --> -0.629617).  Saving model ...
Epoch: 36 cost time: 1.159121036529541
Epoch: 36, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.267 Vali Acc: 0.644 Test Loss: 1.267 Test Acc: 0.644
Validation loss decreased (-0.629617 --> -0.644432).  Saving model ...
Epoch: 37 cost time: 1.082559585571289
Epoch: 37, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.241 Vali Acc: 0.652 Test Loss: 1.241 Test Acc: 0.652
Validation loss decreased (-0.644432 --> -0.651839).  Saving model ...
Epoch: 38 cost time: 0.9522461891174316
Epoch: 38, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.215 Vali Acc: 0.663 Test Loss: 1.215 Test Acc: 0.663
Validation loss decreased (-0.651839 --> -0.662951).  Saving model ...
Epoch: 39 cost time: 0.9936561584472656
Epoch: 39, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.189 Vali Acc: 0.674 Test Loss: 1.189 Test Acc: 0.674
Validation loss decreased (-0.662951 --> -0.674062).  Saving model ...
Epoch: 40 cost time: 1.1694624423980713
Epoch: 40, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.163 Vali Acc: 0.689 Test Loss: 1.163 Test Acc: 0.689
Validation loss decreased (-0.674062 --> -0.688877).  Saving model ...
Epoch: 41 cost time: 1.055901288986206
Epoch: 41, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.136 Vali Acc: 0.700 Test Loss: 1.136 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699989).  Saving model ...
Epoch: 42 cost time: 1.1905062198638916
Epoch: 42, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.108 Vali Acc: 0.707 Test Loss: 1.108 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.707396).  Saving model ...
Epoch: 43 cost time: 1.3268678188323975
Epoch: 43, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.081 Vali Acc: 0.719 Test Loss: 1.081 Test Acc: 0.719
Validation loss decreased (-0.707396 --> -0.718508).  Saving model ...
Epoch: 44 cost time: 1.212989091873169
Epoch: 44, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.053 Vali Acc: 0.722 Test Loss: 1.053 Test Acc: 0.722
Validation loss decreased (-0.718508 --> -0.722212).  Saving model ...
Epoch: 45 cost time: 1.166100025177002
Epoch: 45, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.025 Vali Acc: 0.730 Test Loss: 1.025 Test Acc: 0.730
Validation loss decreased (-0.722212 --> -0.729619).  Saving model ...
Epoch: 46 cost time: 1.217604160308838
Epoch: 46, Steps: 2 | Train Loss: 1.063 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.729619 --> -0.733323).  Saving model ...
Epoch: 47 cost time: 1.1262586116790771
Epoch: 47, Steps: 2 | Train Loss: 1.053 Vali Loss: 0.968 Vali Acc: 0.737 Test Loss: 0.968 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.737027).  Saving model ...
Epoch: 48 cost time: 1.1443192958831787
Epoch: 48, Steps: 2 | Train Loss: 1.132 Vali Loss: 0.940 Vali Acc: 0.741 Test Loss: 0.940 Test Acc: 0.741
Validation loss decreased (-0.737027 --> -0.740731).  Saving model ...
Epoch: 49 cost time: 1.1571521759033203
Epoch: 49, Steps: 2 | Train Loss: 1.077 Vali Loss: 0.912 Vali Acc: 0.763 Test Loss: 0.912 Test Acc: 0.763
Validation loss decreased (-0.740731 --> -0.762954).  Saving model ...
Epoch: 50 cost time: 1.0036237239837646
Epoch: 50, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.884 Vali Acc: 0.778 Test Loss: 0.884 Test Acc: 0.778
Validation loss decreased (-0.762954 --> -0.777769).  Saving model ...
Epoch: 51 cost time: 1.028834581375122
Epoch: 51, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.856 Vali Acc: 0.789 Test Loss: 0.856 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 52 cost time: 0.9774410724639893
Epoch: 52, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.829 Vali Acc: 0.796 Test Loss: 0.829 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796288).  Saving model ...
Epoch: 53 cost time: 1.04752516746521
Epoch: 53, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.804 Vali Acc: 0.789 Test Loss: 0.804 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2155492305755615
Epoch: 54, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.779 Vali Acc: 0.796 Test Loss: 0.779 Test Acc: 0.796
Validation loss decreased (-0.796288 --> -0.796289).  Saving model ...
Epoch: 55 cost time: 1.1966989040374756
Epoch: 55, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0237088203430176
Epoch: 56, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.731 Vali Acc: 0.781 Test Loss: 0.731 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1249885559082031
Epoch: 57, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.706 Vali Acc: 0.781 Test Loss: 0.706 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1840243339538574
Epoch: 58, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.680 Vali Acc: 0.793 Test Loss: 0.680 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1914920806884766
Epoch: 59, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 60 cost time: 1.2586357593536377
Epoch: 60, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 61 cost time: 1.1013922691345215
Epoch: 61, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.604 Vali Acc: 0.804 Test Loss: 0.604 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 62 cost time: 1.139902114868164
Epoch: 62, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.803698 --> -0.818513).  Saving model ...
Epoch: 63 cost time: 1.0217111110687256
Epoch: 63, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.558 Vali Acc: 0.830 Test Loss: 0.558 Test Acc: 0.830
Validation loss decreased (-0.818513 --> -0.829624).  Saving model ...
Epoch: 64 cost time: 1.050839900970459
Epoch: 64, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 65 cost time: 1.1108143329620361
Epoch: 65, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0873053073883057
Epoch: 66, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.0909035205841064
Epoch: 67, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9712679386138916
Epoch: 68, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 69 cost time: 1.0793907642364502
Epoch: 69, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.450 Vali Acc: 0.852 Test Loss: 0.450 Test Acc: 0.852
Validation loss decreased (-0.833329 --> -0.851847).  Saving model ...
Epoch: 70 cost time: 1.137317180633545
Epoch: 70, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
Validation loss decreased (-0.851847 --> -0.862959).  Saving model ...
Epoch: 71 cost time: 1.193159580230713
Epoch: 71, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
Validation loss decreased (-0.862959 --> -0.870366).  Saving model ...
Epoch: 72 cost time: 1.0337958335876465
Epoch: 72, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.407 Vali Acc: 0.885 Test Loss: 0.407 Test Acc: 0.885
Validation loss decreased (-0.870366 --> -0.885181).  Saving model ...
Epoch: 73 cost time: 1.2379231452941895
Epoch: 73, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.393 Vali Acc: 0.885 Test Loss: 0.393 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 74 cost time: 1.155151128768921
Epoch: 74, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 75 cost time: 1.196505069732666
Epoch: 75, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.371 Vali Acc: 0.893 Test Loss: 0.371 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 76 cost time: 1.1650745868682861
Epoch: 76, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899996).  Saving model ...
Epoch: 77 cost time: 1.187354326248169
Epoch: 77, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.352 Vali Acc: 0.893 Test Loss: 0.352 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.3004035949707031
Epoch: 78, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.346 Vali Acc: 0.893 Test Loss: 0.346 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.1762332916259766
Epoch: 79, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.340 Vali Acc: 0.893 Test Loss: 0.340 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.2026841640472412
Epoch: 80, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.4034991264343262
Epoch: 81, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.3828635215759277
Epoch: 82, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.317 Vali Acc: 0.893 Test Loss: 0.317 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.16898512840271
Epoch: 83, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.313 Vali Acc: 0.893 Test Loss: 0.313 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.1739957332611084
Epoch: 84, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.308 Vali Acc: 0.893 Test Loss: 0.308 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.1268789768218994
Epoch: 85, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.303 Vali Acc: 0.893 Test Loss: 0.303 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.2216331958770752
Epoch: 86, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.297 Vali Acc: 0.896 Test Loss: 0.297 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3397459983825684
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.96435546875
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.9013330936431885
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0813002586364746
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0822985172271729
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.9626381397247314
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.1300711631774902
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.1185081005096436
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.1092610359191895
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.3309085369110107
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 1.3041539192199707
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.1684870719909668
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1704235076904297
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2104711532592773
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.1540720462799072
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 16 cost time: 1.1304740905761719
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.0493614673614502
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.1545040607452393
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.0779297351837158
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0823194980621338
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0031991004943848
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 22 cost time: 0.9979782104492188
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.045628547668457
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 1.0660035610198975
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2420094013214111
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.0975089073181152
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 0.9632689952850342
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.294111728668213
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3582484722137451
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.1419258117675781
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 31 cost time: 1.178333044052124
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.1051361560821533
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2386534214019775
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.3047428131103516
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.0286548137664795
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.1332731246948242
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.128906011581421
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.0388591289520264
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.2135779857635498
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.195052146911621
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.1221446990966797
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.0750718116760254
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.1276648044586182
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.2518434524536133
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.1375722885131836
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 46 cost time: 1.0902025699615479
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.2044217586517334
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 48 cost time: 1.1116738319396973
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 1.1356866359710693
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.1342108249664307
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 1.1695902347564697
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.176931381225586
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.1066534519195557
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.1706149578094482
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.032573938369751
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.0915052890777588
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.073676347732544
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.1528170108795166
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.1585180759429932
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.1703360080718994
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.1684772968292236
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.3632698059082031
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.1446666717529297
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.030411958694458
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.134488582611084
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.0271337032318115
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.0564863681793213
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.1109545230865479
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9792475700378418
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.0858590602874756
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.099865436553955
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 1.0581178665161133
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.07135009765625
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.1272313594818115
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.0895805358886719
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.2148025035858154
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.1367013454437256
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.1056759357452393
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.090871810913086
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.1308391094207764
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.1417129039764404
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.1398098468780518
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.1564686298370361
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.2348637580871582
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0384314060211182
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 0.9432787895202637
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0628352165222168
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 0.9266307353973389
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 0.9330596923828125
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0623064041137695
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9463691711425781
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 1.060337781906128
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.134122371673584
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.0767695903778076
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.1524951457977295
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.0720710754394531
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.042353630065918
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.1217379570007324
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.9733242988586426
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.1192429065704346
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 145510
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6436643600463867
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.780 Vali Acc: 0.211 Test Loss: 1.780 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.2269139289855957
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.762 Vali Acc: 0.219 Test Loss: 1.762 Test Acc: 0.219
Validation loss decreased (-0.211093 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 1.001267671585083
Epoch: 3, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.748 Vali Acc: 0.230 Test Loss: 1.748 Test Acc: 0.230
Validation loss decreased (-0.218501 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.9439010620117188
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.733 Vali Acc: 0.248 Test Loss: 1.733 Test Acc: 0.248
Validation loss decreased (-0.229612 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 1.0368857383728027
Epoch: 5, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.713 Vali Acc: 0.274 Test Loss: 1.713 Test Acc: 0.274
Validation loss decreased (-0.248131 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 1.0946495532989502
Epoch: 6, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.690 Vali Acc: 0.304 Test Loss: 1.690 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 1.120162010192871
Epoch: 7, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.663 Vali Acc: 0.341 Test Loss: 1.663 Test Acc: 0.341
Validation loss decreased (-0.303687 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 1.0567519664764404
Epoch: 8, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.635 Vali Acc: 0.359 Test Loss: 1.635 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 1.1509087085723877
Epoch: 9, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.605 Vali Acc: 0.393 Test Loss: 1.605 Test Acc: 0.393
Validation loss decreased (-0.359243 --> -0.392577).  Saving model ...
Epoch: 10 cost time: 1.1628212928771973
Epoch: 10, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.573 Vali Acc: 0.422 Test Loss: 1.573 Test Acc: 0.422
Validation loss decreased (-0.392577 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 1.1597633361816406
Epoch: 11, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.539 Vali Acc: 0.470 Test Loss: 1.539 Test Acc: 0.470
Validation loss decreased (-0.422206 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 1.21767258644104
Epoch: 12, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.505 Vali Acc: 0.504 Test Loss: 1.505 Test Acc: 0.504
Validation loss decreased (-0.470355 --> -0.503689).  Saving model ...
Epoch: 13 cost time: 1.0928986072540283
Epoch: 13, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.470 Vali Acc: 0.559 Test Loss: 1.470 Test Acc: 0.559
Validation loss decreased (-0.503689 --> -0.559245).  Saving model ...
Epoch: 14 cost time: 1.1320562362670898
Epoch: 14, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.434 Vali Acc: 0.611 Test Loss: 1.434 Test Acc: 0.611
Validation loss decreased (-0.559245 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 1.1625571250915527
Epoch: 15, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.397 Vali Acc: 0.630 Test Loss: 1.397 Test Acc: 0.630
Validation loss decreased (-0.611097 --> -0.629616).  Saving model ...
Epoch: 16 cost time: 1.0952565670013428
Epoch: 16, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.361 Vali Acc: 0.659 Test Loss: 1.361 Test Acc: 0.659
Validation loss decreased (-0.629616 --> -0.659246).  Saving model ...
Epoch: 17 cost time: 1.1635639667510986
Epoch: 17, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.324 Vali Acc: 0.678 Test Loss: 1.324 Test Acc: 0.678
Validation loss decreased (-0.659246 --> -0.677765).  Saving model ...
Epoch: 18 cost time: 1.044004201889038
Epoch: 18, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.287 Vali Acc: 0.693 Test Loss: 1.287 Test Acc: 0.693
Validation loss decreased (-0.677765 --> -0.692580).  Saving model ...
Epoch: 19 cost time: 1.119781732559204
Epoch: 19, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.250 Vali Acc: 0.689 Test Loss: 1.250 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0501518249511719
Epoch: 20, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.212 Vali Acc: 0.700 Test Loss: 1.212 Test Acc: 0.700
Validation loss decreased (-0.692580 --> -0.699988).  Saving model ...
Epoch: 21 cost time: 1.0851712226867676
Epoch: 21, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.176 Vali Acc: 0.711 Test Loss: 1.176 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 1.0726709365844727
Epoch: 22, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.140 Vali Acc: 0.719 Test Loss: 1.140 Test Acc: 0.719
Validation loss decreased (-0.711099 --> -0.718507).  Saving model ...
Epoch: 23 cost time: 1.0382280349731445
Epoch: 23, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.106 Vali Acc: 0.737 Test Loss: 1.106 Test Acc: 0.737
Validation loss decreased (-0.718507 --> -0.737026).  Saving model ...
Epoch: 24 cost time: 1.1318082809448242
Epoch: 24, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.073 Vali Acc: 0.737 Test Loss: 1.073 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 25 cost time: 1.157677173614502
Epoch: 25, Steps: 2 | Train Loss: 0.773 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0086183547973633
Epoch: 26, Steps: 2 | Train Loss: 0.713 Vali Loss: 1.010 Vali Acc: 0.744 Test Loss: 1.010 Test Acc: 0.744
Validation loss decreased (-0.737026 --> -0.744434).  Saving model ...
Epoch: 27 cost time: 1.0105900764465332
Epoch: 27, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.981 Vali Acc: 0.752 Test Loss: 0.981 Test Acc: 0.752
Validation loss decreased (-0.744434 --> -0.751842).  Saving model ...
Epoch: 28 cost time: 1.0030596256256104
Epoch: 28, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.952 Vali Acc: 0.759 Test Loss: 0.952 Test Acc: 0.759
Validation loss decreased (-0.751842 --> -0.759250).  Saving model ...
Epoch: 29 cost time: 1.0394203662872314
Epoch: 29, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.924 Vali Acc: 0.767 Test Loss: 0.924 Test Acc: 0.767
Validation loss decreased (-0.759250 --> -0.766657).  Saving model ...
Epoch: 30 cost time: 1.1694884300231934
Epoch: 30, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.897 Vali Acc: 0.778 Test Loss: 0.897 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777769).  Saving model ...
Epoch: 31 cost time: 0.9780497550964355
Epoch: 31, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.871 Vali Acc: 0.789 Test Loss: 0.871 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 32 cost time: 0.9890382289886475
Epoch: 32, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.847 Vali Acc: 0.789 Test Loss: 0.847 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788880).  Saving model ...
Epoch: 33 cost time: 1.1806449890136719
Epoch: 33, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.824 Vali Acc: 0.793 Test Loss: 0.824 Test Acc: 0.793
Validation loss decreased (-0.788880 --> -0.792584).  Saving model ...
Epoch: 34 cost time: 1.100095510482788
Epoch: 34, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.803 Vali Acc: 0.793 Test Loss: 0.803 Test Acc: 0.793
Validation loss decreased (-0.792584 --> -0.792585).  Saving model ...
Epoch: 35 cost time: 1.0143296718597412
Epoch: 35, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.783 Vali Acc: 0.796 Test Loss: 0.783 Test Acc: 0.796
Validation loss decreased (-0.792585 --> -0.796288).  Saving model ...
Epoch: 36 cost time: 1.0983364582061768
Epoch: 36, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.765 Vali Acc: 0.793 Test Loss: 0.765 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1418633460998535
Epoch: 37, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.990351676940918
Epoch: 38, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.733 Vali Acc: 0.793 Test Loss: 0.733 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0803954601287842
Epoch: 39, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
Validation loss decreased (-0.796288 --> -0.796289).  Saving model ...
Epoch: 40 cost time: 1.2046427726745605
Epoch: 40, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.796289 --> -0.799993).  Saving model ...
Epoch: 41 cost time: 1.0302979946136475
Epoch: 41, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.695 Vali Acc: 0.807 Test Loss: 0.695 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807400).  Saving model ...
Epoch: 42 cost time: 0.9541246891021729
Epoch: 42, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.684 Vali Acc: 0.807 Test Loss: 0.684 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807401).  Saving model ...
Epoch: 43 cost time: 1.0228385925292969
Epoch: 43, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.673 Vali Acc: 0.807 Test Loss: 0.673 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 44 cost time: 1.010563850402832
Epoch: 44, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.664 Vali Acc: 0.807 Test Loss: 0.664 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 45 cost time: 1.0075407028198242
Epoch: 45, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.656 Vali Acc: 0.807 Test Loss: 0.656 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 46 cost time: 1.0489912033081055
Epoch: 46, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.648 Vali Acc: 0.807 Test Loss: 0.648 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 47 cost time: 0.9451673030853271
Epoch: 47, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.641 Vali Acc: 0.807 Test Loss: 0.641 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 48 cost time: 0.8635601997375488
Epoch: 48, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 49 cost time: 0.9749715328216553
Epoch: 49, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 50 cost time: 1.1049907207489014
Epoch: 50, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 51 cost time: 1.1298387050628662
Epoch: 51, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.617 Vali Acc: 0.811 Test Loss: 0.617 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 52 cost time: 1.0701351165771484
Epoch: 52, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.612 Vali Acc: 0.815 Test Loss: 0.612 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 53 cost time: 1.1271123886108398
Epoch: 53, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 54 cost time: 1.251600980758667
Epoch: 54, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 55 cost time: 1.1825647354125977
Epoch: 55, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818513).  Saving model ...
Epoch: 56 cost time: 1.225388765335083
Epoch: 56, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.818513 --> -0.822216).  Saving model ...
Epoch: 57 cost time: 1.1274144649505615
Epoch: 57, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 58 cost time: 1.082726240158081
Epoch: 58, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 59 cost time: 0.9489505290985107
Epoch: 59, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 60 cost time: 1.068450927734375
Epoch: 60, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 61 cost time: 1.1660475730895996
Epoch: 61, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 62 cost time: 0.981818437576294
Epoch: 62, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 63 cost time: 0.9918999671936035
Epoch: 63, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 64 cost time: 1.0855724811553955
Epoch: 64, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 65 cost time: 1.0348834991455078
Epoch: 65, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 66 cost time: 1.1324517726898193
Epoch: 66, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.566 Vali Acc: 0.830 Test Loss: 0.566 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 67 cost time: 1.230405569076538
Epoch: 67, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833328).  Saving model ...
Epoch: 68 cost time: 1.0447616577148438
Epoch: 68, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 1.1061749458312988
Epoch: 69, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 1.1735548973083496
Epoch: 70, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 71 cost time: 1.0987253189086914
Epoch: 71, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 1.033522129058838
Epoch: 72, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 73 cost time: 1.1985936164855957
Epoch: 73, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 74 cost time: 1.1849262714385986
Epoch: 74, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 75 cost time: 1.1105079650878906
Epoch: 75, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 76 cost time: 1.1864869594573975
Epoch: 76, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 77 cost time: 1.1684372425079346
Epoch: 77, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 78 cost time: 1.181126594543457
Epoch: 78, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 79 cost time: 1.3505821228027344
Epoch: 79, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 80 cost time: 1.1712543964385986
Epoch: 80, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 81 cost time: 1.1199054718017578
Epoch: 81, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 82 cost time: 1.1712868213653564
Epoch: 82, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.837 Test Loss: 0.537 Test Acc: 0.837
Validation loss decreased (-0.833328 --> -0.837032).  Saving model ...
Epoch: 83 cost time: 1.102588415145874
Epoch: 83, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.535 Vali Acc: 0.837 Test Loss: 0.535 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 84 cost time: 1.0991222858428955
Epoch: 84, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.534 Vali Acc: 0.837 Test Loss: 0.534 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 85 cost time: 1.0059711933135986
Epoch: 85, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.533 Vali Acc: 0.837 Test Loss: 0.533 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 86 cost time: 0.9669458866119385
Epoch: 86, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.531 Vali Acc: 0.837 Test Loss: 0.531 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 87 cost time: 1.1028993129730225
Epoch: 87, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.530 Vali Acc: 0.837 Test Loss: 0.530 Test Acc: 0.837
Validation loss decreased (-0.837032 --> -0.837032).  Saving model ...
Epoch: 88 cost time: 1.2052898406982422
Epoch: 88, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.837032 --> -0.840735).  Saving model ...
Epoch: 89 cost time: 0.899968147277832
Epoch: 89, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 90 cost time: 1.2034265995025635
Epoch: 90, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 91 cost time: 1.128690242767334
Epoch: 91, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 92 cost time: 1.088557481765747
Epoch: 92, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 93 cost time: 1.0282821655273438
Epoch: 93, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 94 cost time: 1.150254249572754
Epoch: 94, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 95 cost time: 1.1270065307617188
Epoch: 95, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 96 cost time: 1.141136646270752
Epoch: 96, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 97 cost time: 1.0858945846557617
Epoch: 97, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 98 cost time: 1.111013650894165
Epoch: 98, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.514 Vali Acc: 0.852 Test Loss: 0.514 Test Acc: 0.852
Validation loss decreased (-0.848143 --> -0.851847).  Saving model ...
Epoch: 99 cost time: 1.0257723331451416
Epoch: 99, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.512 Vali Acc: 0.852 Test Loss: 0.512 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
Epoch: 100 cost time: 1.0547380447387695
Epoch: 100, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.852 Test Loss: 0.510 Test Acc: 0.852
Validation loss decreased (-0.851847 --> -0.851847).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.312382936477661
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.802 Vali Acc: 0.193 Test Loss: 1.802 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 1.0537803173065186
Epoch: 2, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.788 Vali Acc: 0.207 Test Loss: 1.788 Test Acc: 0.207
Validation loss decreased (-0.192575 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 1.0180106163024902
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.777 Vali Acc: 0.207 Test Loss: 1.777 Test Acc: 0.207
Validation loss decreased (-0.207390 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.9666380882263184
Epoch: 4, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.765 Vali Acc: 0.215 Test Loss: 1.765 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.9618310928344727
Epoch: 5, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.750 Vali Acc: 0.222 Test Loss: 1.750 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 1.123868465423584
Epoch: 6, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.731 Vali Acc: 0.233 Test Loss: 1.731 Test Acc: 0.233
Validation loss decreased (-0.222205 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 1.0137624740600586
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.711 Vali Acc: 0.244 Test Loss: 1.711 Test Acc: 0.244
Validation loss decreased (-0.233316 --> -0.244427).  Saving model ...
Epoch: 8 cost time: 1.0734140872955322
Epoch: 8, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.689 Vali Acc: 0.263 Test Loss: 1.689 Test Acc: 0.263
Validation loss decreased (-0.244427 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 1.2930607795715332
Epoch: 9, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.665 Vali Acc: 0.278 Test Loss: 1.665 Test Acc: 0.278
Validation loss decreased (-0.262946 --> -0.277761).  Saving model ...
Epoch: 10 cost time: 1.1638782024383545
Epoch: 10, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.640 Vali Acc: 0.304 Test Loss: 1.640 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 11 cost time: 1.1086959838867188
Epoch: 11, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.613 Vali Acc: 0.333 Test Loss: 1.613 Test Acc: 0.333
Validation loss decreased (-0.303687 --> -0.333317).  Saving model ...
Epoch: 12 cost time: 1.1323778629302979
Epoch: 12, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.586 Vali Acc: 0.378 Test Loss: 1.586 Test Acc: 0.378
Validation loss decreased (-0.333317 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 1.2387163639068604
Epoch: 13, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.558 Vali Acc: 0.426 Test Loss: 1.558 Test Acc: 0.426
Validation loss decreased (-0.377762 --> -0.425910).  Saving model ...
Epoch: 14 cost time: 1.2582066059112549
Epoch: 14, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
Validation loss decreased (-0.425910 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 1.1011512279510498
Epoch: 15, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.500 Vali Acc: 0.515 Test Loss: 1.500 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514800).  Saving model ...
Epoch: 16 cost time: 1.1012277603149414
Epoch: 16, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.470 Vali Acc: 0.563 Test Loss: 1.470 Test Acc: 0.563
Validation loss decreased (-0.514800 --> -0.562948).  Saving model ...
Epoch: 17 cost time: 1.0420219898223877
Epoch: 17, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.441 Vali Acc: 0.589 Test Loss: 1.441 Test Acc: 0.589
Validation loss decreased (-0.562948 --> -0.588874).  Saving model ...
Epoch: 18 cost time: 1.1292247772216797
Epoch: 18, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.410 Vali Acc: 0.622 Test Loss: 1.410 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622208).  Saving model ...
Epoch: 19 cost time: 1.1665852069854736
Epoch: 19, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.380 Vali Acc: 0.622 Test Loss: 1.380 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 20 cost time: 1.0542774200439453
Epoch: 20, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.350 Vali Acc: 0.637 Test Loss: 1.350 Test Acc: 0.637
Validation loss decreased (-0.622208 --> -0.637024).  Saving model ...
Epoch: 21 cost time: 1.1341526508331299
Epoch: 21, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.320 Vali Acc: 0.652 Test Loss: 1.320 Test Acc: 0.652
Validation loss decreased (-0.637024 --> -0.651839).  Saving model ...
Epoch: 22 cost time: 0.9599378108978271
Epoch: 22, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.290 Vali Acc: 0.652 Test Loss: 1.290 Test Acc: 0.652
Validation loss decreased (-0.651839 --> -0.651839).  Saving model ...
Epoch: 23 cost time: 1.2482130527496338
Epoch: 23, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.261 Vali Acc: 0.667 Test Loss: 1.261 Test Acc: 0.667
Validation loss decreased (-0.651839 --> -0.666654).  Saving model ...
Epoch: 24 cost time: 0.9306085109710693
Epoch: 24, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.233 Vali Acc: 0.670 Test Loss: 1.233 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.670358).  Saving model ...
Epoch: 25 cost time: 1.071352481842041
Epoch: 25, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.205 Vali Acc: 0.674 Test Loss: 1.205 Test Acc: 0.674
Validation loss decreased (-0.670358 --> -0.674062).  Saving model ...
Epoch: 26 cost time: 1.1344149112701416
Epoch: 26, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.178 Vali Acc: 0.681 Test Loss: 1.178 Test Acc: 0.681
Validation loss decreased (-0.674062 --> -0.681470).  Saving model ...
Epoch: 27 cost time: 1.0182762145996094
Epoch: 27, Steps: 2 | Train Loss: 0.831 Vali Loss: 1.152 Vali Acc: 0.685 Test Loss: 1.152 Test Acc: 0.685
Validation loss decreased (-0.681470 --> -0.685174).  Saving model ...
Epoch: 28 cost time: 1.1351237297058105
Epoch: 28, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.126 Vali Acc: 0.700 Test Loss: 1.126 Test Acc: 0.700
Validation loss decreased (-0.685174 --> -0.699989).  Saving model ...
Epoch: 29 cost time: 1.1438581943511963
Epoch: 29, Steps: 2 | Train Loss: 0.714 Vali Loss: 1.101 Vali Acc: 0.704 Test Loss: 1.101 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703693).  Saving model ...
Epoch: 30 cost time: 1.2016711235046387
Epoch: 30, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.076 Vali Acc: 0.704 Test Loss: 1.076 Test Acc: 0.704
Validation loss decreased (-0.703693 --> -0.703693).  Saving model ...
Epoch: 31 cost time: 1.1746299266815186
Epoch: 31, Steps: 2 | Train Loss: 0.662 Vali Loss: 1.052 Vali Acc: 0.704 Test Loss: 1.052 Test Acc: 0.704
Validation loss decreased (-0.703693 --> -0.703693).  Saving model ...
Epoch: 32 cost time: 1.1337473392486572
Epoch: 32, Steps: 2 | Train Loss: 0.607 Vali Loss: 1.029 Vali Acc: 0.711 Test Loss: 1.029 Test Acc: 0.711
Validation loss decreased (-0.703693 --> -0.711101).  Saving model ...
Epoch: 33 cost time: 1.241424798965454
Epoch: 33, Steps: 2 | Train Loss: 0.518 Vali Loss: 1.007 Vali Acc: 0.719 Test Loss: 1.007 Test Acc: 0.719
Validation loss decreased (-0.711101 --> -0.718508).  Saving model ...
Epoch: 34 cost time: 1.2959425449371338
Epoch: 34, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.985 Vali Acc: 0.719 Test Loss: 0.985 Test Acc: 0.719
Validation loss decreased (-0.718508 --> -0.718509).  Saving model ...
Epoch: 35 cost time: 1.1445469856262207
Epoch: 35, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.965 Vali Acc: 0.719 Test Loss: 0.965 Test Acc: 0.719
Validation loss decreased (-0.718509 --> -0.718509).  Saving model ...
Epoch: 36 cost time: 1.0856950283050537
Epoch: 36, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
Validation loss decreased (-0.718509 --> -0.722213).  Saving model ...
Epoch: 37 cost time: 1.2765965461730957
Epoch: 37, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.929 Vali Acc: 0.719 Test Loss: 0.929 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0951836109161377
Epoch: 38, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 1.2399625778198242
Epoch: 39, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.897 Vali Acc: 0.726 Test Loss: 0.897 Test Acc: 0.726
Validation loss decreased (-0.722213 --> -0.725917).  Saving model ...
Epoch: 40 cost time: 0.9625370502471924
Epoch: 40, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.883 Vali Acc: 0.730 Test Loss: 0.883 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 41 cost time: 1.3151235580444336
Epoch: 41, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.869 Vali Acc: 0.733 Test Loss: 0.869 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 42 cost time: 1.1915669441223145
Epoch: 42, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.856 Vali Acc: 0.733 Test Loss: 0.856 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 43 cost time: 0.9830994606018066
Epoch: 43, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.844 Vali Acc: 0.737 Test Loss: 0.844 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 44 cost time: 1.186800241470337
Epoch: 44, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.833 Vali Acc: 0.737 Test Loss: 0.833 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 45 cost time: 1.0375070571899414
Epoch: 45, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.823 Vali Acc: 0.737 Test Loss: 0.823 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 46 cost time: 1.0800061225891113
Epoch: 46, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.813 Vali Acc: 0.741 Test Loss: 0.813 Test Acc: 0.741
Validation loss decreased (-0.737029 --> -0.740733).  Saving model ...
Epoch: 47 cost time: 1.1168146133422852
Epoch: 47, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.804 Vali Acc: 0.741 Test Loss: 0.804 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 48 cost time: 1.0525007247924805
Epoch: 48, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 49 cost time: 1.0970406532287598
Epoch: 49, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.787 Vali Acc: 0.741 Test Loss: 0.787 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 50 cost time: 1.132692813873291
Epoch: 50, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.779 Vali Acc: 0.737 Test Loss: 0.779 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1201412677764893
Epoch: 51, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.772 Vali Acc: 0.741 Test Loss: 0.772 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 52 cost time: 1.070289134979248
Epoch: 52, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 53 cost time: 1.0390503406524658
Epoch: 53, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.759 Vali Acc: 0.748 Test Loss: 0.759 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 54 cost time: 0.9075381755828857
Epoch: 54, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.753 Vali Acc: 0.748 Test Loss: 0.753 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 55 cost time: 1.2915170192718506
Epoch: 55, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.748 Vali Acc: 0.748 Test Loss: 0.748 Test Acc: 0.748
Validation loss decreased (-0.748141 --> -0.748141).  Saving model ...
Epoch: 56 cost time: 1.0229475498199463
Epoch: 56, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.743 Vali Acc: 0.752 Test Loss: 0.743 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751844).  Saving model ...
Epoch: 57 cost time: 1.0906918048858643
Epoch: 57, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.738 Vali Acc: 0.752 Test Loss: 0.738 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 58 cost time: 1.008331060409546
Epoch: 58, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 59 cost time: 1.2464423179626465
Epoch: 59, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 60 cost time: 1.0594098567962646
Epoch: 60, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 61 cost time: 1.1023383140563965
Epoch: 61, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.719 Vali Acc: 0.759 Test Loss: 0.719 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 62 cost time: 1.0614910125732422
Epoch: 62, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.714 Vali Acc: 0.759 Test Loss: 0.714 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 63 cost time: 1.1605603694915771
Epoch: 63, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.710 Vali Acc: 0.759 Test Loss: 0.710 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 64 cost time: 1.1502525806427002
Epoch: 64, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.706 Vali Acc: 0.759 Test Loss: 0.706 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 65 cost time: 1.1197752952575684
Epoch: 65, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.703 Vali Acc: 0.767 Test Loss: 0.703 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766660).  Saving model ...
Epoch: 66 cost time: 1.0239324569702148
Epoch: 66, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.699 Vali Acc: 0.767 Test Loss: 0.699 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 67 cost time: 1.2731637954711914
Epoch: 67, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.696 Vali Acc: 0.767 Test Loss: 0.696 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 68 cost time: 0.9962143898010254
Epoch: 68, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.693 Vali Acc: 0.767 Test Loss: 0.693 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 69 cost time: 1.2022197246551514
Epoch: 69, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 70 cost time: 1.1492502689361572
Epoch: 70, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.687 Vali Acc: 0.767 Test Loss: 0.687 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 71 cost time: 1.0199790000915527
Epoch: 71, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.684 Vali Acc: 0.770 Test Loss: 0.684 Test Acc: 0.770
Validation loss decreased (-0.766660 --> -0.770364).  Saving model ...
Epoch: 72 cost time: 1.0466272830963135
Epoch: 72, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 73 cost time: 1.0919480323791504
Epoch: 73, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.677 Vali Acc: 0.770 Test Loss: 0.677 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 74 cost time: 1.2899181842803955
Epoch: 74, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 75 cost time: 1.2032756805419922
Epoch: 75, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.770364 --> -0.770364).  Saving model ...
Epoch: 76 cost time: 1.1945819854736328
Epoch: 76, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.668 Vali Acc: 0.774 Test Loss: 0.668 Test Acc: 0.774
Validation loss decreased (-0.770364 --> -0.774067).  Saving model ...
Epoch: 77 cost time: 1.0890049934387207
Epoch: 77, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.665 Vali Acc: 0.774 Test Loss: 0.665 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 78 cost time: 1.3367972373962402
Epoch: 78, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.662 Vali Acc: 0.774 Test Loss: 0.662 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 79 cost time: 1.3113720417022705
Epoch: 79, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.659 Vali Acc: 0.778 Test Loss: 0.659 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 80 cost time: 1.2606348991394043
Epoch: 80, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.656 Vali Acc: 0.778 Test Loss: 0.656 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 81 cost time: 1.1673190593719482
Epoch: 81, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 82 cost time: 1.305654525756836
Epoch: 82, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 83 cost time: 1.2372491359710693
Epoch: 83, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.647 Vali Acc: 0.781 Test Loss: 0.647 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 84 cost time: 1.0877275466918945
Epoch: 84, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.645 Vali Acc: 0.781 Test Loss: 0.645 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 85 cost time: 1.184662103652954
Epoch: 85, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.642 Vali Acc: 0.781 Test Loss: 0.642 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 86 cost time: 1.064605712890625
Epoch: 86, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.640 Vali Acc: 0.781 Test Loss: 0.640 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 87 cost time: 1.059361457824707
Epoch: 87, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.637 Vali Acc: 0.781 Test Loss: 0.637 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 88 cost time: 1.210930347442627
Epoch: 88, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.781 Test Loss: 0.634 Test Acc: 0.781
Validation loss decreased (-0.781475 --> -0.781475).  Saving model ...
Epoch: 89 cost time: 1.0947976112365723
Epoch: 89, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.631 Vali Acc: 0.785 Test Loss: 0.631 Test Acc: 0.785
Validation loss decreased (-0.781475 --> -0.785179).  Saving model ...
Epoch: 90 cost time: 1.1796798706054688
Epoch: 90, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.785179 --> -0.788883).  Saving model ...
Epoch: 91 cost time: 0.9696023464202881
Epoch: 91, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.626 Vali Acc: 0.793 Test Loss: 0.626 Test Acc: 0.793
Validation loss decreased (-0.788883 --> -0.792586).  Saving model ...
Epoch: 92 cost time: 1.1809101104736328
Epoch: 92, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.623 Vali Acc: 0.793 Test Loss: 0.623 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 93 cost time: 1.0695865154266357
Epoch: 93, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 94 cost time: 1.1664581298828125
Epoch: 94, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 95 cost time: 1.2943477630615234
Epoch: 95, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 96 cost time: 1.1899561882019043
Epoch: 96, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 97 cost time: 1.4131619930267334
Epoch: 97, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 98 cost time: 1.1694376468658447
Epoch: 98, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 99 cost time: 1.22544264793396
Epoch: 99, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
Epoch: 100 cost time: 1.196606159210205
Epoch: 100, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
Validation loss decreased (-0.796290 --> -0.796290).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7962962962962963
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.049654245376587
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.9527020454406738
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.774 Vali Acc: 0.215 Test Loss: 1.774 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 1.0746548175811768
Epoch: 3, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.766 Vali Acc: 0.222 Test Loss: 1.766 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 1.0832710266113281
Epoch: 4, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.757 Vali Acc: 0.230 Test Loss: 1.757 Test Acc: 0.230
Validation loss decreased (-0.222205 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.9888331890106201
Epoch: 5, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.746 Vali Acc: 0.237 Test Loss: 1.746 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237020).  Saving model ...
Epoch: 6 cost time: 1.1617670059204102
Epoch: 6, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.732 Vali Acc: 0.256 Test Loss: 1.732 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 0.965106725692749
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.717 Vali Acc: 0.252 Test Loss: 1.717 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1827657222747803
Epoch: 8, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.702 Vali Acc: 0.263 Test Loss: 1.702 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 1.1656742095947266
Epoch: 9, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.684 Vali Acc: 0.285 Test Loss: 1.684 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285168).  Saving model ...
Epoch: 10 cost time: 1.2295289039611816
Epoch: 10, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.666 Vali Acc: 0.315 Test Loss: 1.666 Test Acc: 0.315
Validation loss decreased (-0.285168 --> -0.314798).  Saving model ...
Epoch: 11 cost time: 0.9596149921417236
Epoch: 11, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.646 Vali Acc: 0.356 Test Loss: 1.646 Test Acc: 0.356
Validation loss decreased (-0.314798 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 1.3186089992523193
Epoch: 12, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.626 Vali Acc: 0.378 Test Loss: 1.626 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 1.0560014247894287
Epoch: 13, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.605 Vali Acc: 0.400 Test Loss: 1.605 Test Acc: 0.400
Validation loss decreased (-0.377762 --> -0.399984).  Saving model ...
Epoch: 14 cost time: 0.9414641857147217
Epoch: 14, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.584 Vali Acc: 0.430 Test Loss: 1.584 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429614).  Saving model ...
Epoch: 15 cost time: 1.149754524230957
Epoch: 15, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.562 Vali Acc: 0.448 Test Loss: 1.562 Test Acc: 0.448
Validation loss decreased (-0.429614 --> -0.448133).  Saving model ...
Epoch: 16 cost time: 1.0643727779388428
Epoch: 16, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.541 Vali Acc: 0.456 Test Loss: 1.541 Test Acc: 0.456
Validation loss decreased (-0.448133 --> -0.455540).  Saving model ...
Epoch: 17 cost time: 1.173574447631836
Epoch: 17, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.518 Vali Acc: 0.478 Test Loss: 1.518 Test Acc: 0.478
Validation loss decreased (-0.455540 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 1.0738403797149658
Epoch: 18, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.496 Vali Acc: 0.515 Test Loss: 1.496 Test Acc: 0.515
Validation loss decreased (-0.477763 --> -0.514800).  Saving model ...
Epoch: 19 cost time: 0.9840807914733887
Epoch: 19, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.473 Vali Acc: 0.522 Test Loss: 1.473 Test Acc: 0.522
Validation loss decreased (-0.514800 --> -0.522207).  Saving model ...
Epoch: 20 cost time: 1.100799560546875
Epoch: 20, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.450 Vali Acc: 0.559 Test Loss: 1.450 Test Acc: 0.559
Validation loss decreased (-0.522207 --> -0.559245).  Saving model ...
Epoch: 21 cost time: 1.0104892253875732
Epoch: 21, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.427 Vali Acc: 0.585 Test Loss: 1.427 Test Acc: 0.585
Validation loss decreased (-0.559245 --> -0.585171).  Saving model ...
Epoch: 22 cost time: 0.9599471092224121
Epoch: 22, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.404 Vali Acc: 0.604 Test Loss: 1.404 Test Acc: 0.604
Validation loss decreased (-0.585171 --> -0.603690).  Saving model ...
Epoch: 23 cost time: 1.1122081279754639
Epoch: 23, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.381 Vali Acc: 0.611 Test Loss: 1.381 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.9929211139678955
Epoch: 24, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.359 Vali Acc: 0.607 Test Loss: 1.359 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.067664623260498
Epoch: 25, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.337 Vali Acc: 0.622 Test Loss: 1.337 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 1.0303113460540771
Epoch: 26, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.316 Vali Acc: 0.630 Test Loss: 1.316 Test Acc: 0.630
Validation loss decreased (-0.622209 --> -0.629616).  Saving model ...
Epoch: 27 cost time: 1.101078987121582
Epoch: 27, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.295 Vali Acc: 0.637 Test Loss: 1.295 Test Acc: 0.637
Validation loss decreased (-0.629616 --> -0.637024).  Saving model ...
Epoch: 28 cost time: 1.0893592834472656
Epoch: 28, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.275 Vali Acc: 0.641 Test Loss: 1.275 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 29 cost time: 1.1029090881347656
Epoch: 29, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.254 Vali Acc: 0.648 Test Loss: 1.254 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648136).  Saving model ...
Epoch: 30 cost time: 1.121340036392212
Epoch: 30, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.233 Vali Acc: 0.648 Test Loss: 1.233 Test Acc: 0.648
Validation loss decreased (-0.648136 --> -0.648136).  Saving model ...
Epoch: 31 cost time: 0.8858606815338135
Epoch: 31, Steps: 2 | Train Loss: 0.758 Vali Loss: 1.213 Vali Acc: 0.652 Test Loss: 1.213 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651840).  Saving model ...
Epoch: 32 cost time: 0.9724137783050537
Epoch: 32, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.193 Vali Acc: 0.652 Test Loss: 1.193 Test Acc: 0.652
Validation loss decreased (-0.651840 --> -0.651840).  Saving model ...
Epoch: 33 cost time: 0.9171433448791504
Epoch: 33, Steps: 2 | Train Loss: 0.595 Vali Loss: 1.174 Vali Acc: 0.656 Test Loss: 1.174 Test Acc: 0.656
Validation loss decreased (-0.651840 --> -0.655544).  Saving model ...
Epoch: 34 cost time: 1.085665225982666
Epoch: 34, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.155 Vali Acc: 0.659 Test Loss: 1.155 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 35 cost time: 1.135913610458374
Epoch: 35, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.137 Vali Acc: 0.663 Test Loss: 1.137 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 36 cost time: 1.0370903015136719
Epoch: 36, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.119 Vali Acc: 0.670 Test Loss: 1.119 Test Acc: 0.670
Validation loss decreased (-0.662952 --> -0.670359).  Saving model ...
Epoch: 37 cost time: 1.2179145812988281
Epoch: 37, Steps: 2 | Train Loss: 0.481 Vali Loss: 1.102 Vali Acc: 0.670 Test Loss: 1.102 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 38 cost time: 1.380392074584961
Epoch: 38, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.087 Vali Acc: 0.681 Test Loss: 1.087 Test Acc: 0.681
Validation loss decreased (-0.670359 --> -0.681471).  Saving model ...
Epoch: 39 cost time: 1.2605042457580566
Epoch: 39, Steps: 2 | Train Loss: 0.434 Vali Loss: 1.071 Vali Acc: 0.678 Test Loss: 1.071 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2173669338226318
Epoch: 40, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.058 Vali Acc: 0.681 Test Loss: 1.058 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 41 cost time: 1.327819585800171
Epoch: 41, Steps: 2 | Train Loss: 0.391 Vali Loss: 1.045 Vali Acc: 0.685 Test Loss: 1.045 Test Acc: 0.685
Validation loss decreased (-0.681471 --> -0.685175).  Saving model ...
Epoch: 42 cost time: 1.0737030506134033
Epoch: 42, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.032 Vali Acc: 0.693 Test Loss: 1.032 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692582).  Saving model ...
Epoch: 43 cost time: 1.2048864364624023
Epoch: 43, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.692582 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 1.0503880977630615
Epoch: 44, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.010 Vali Acc: 0.704 Test Loss: 1.010 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 45 cost time: 1.220128059387207
Epoch: 45, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.000 Vali Acc: 0.704 Test Loss: 1.000 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 46 cost time: 1.0074546337127686
Epoch: 46, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.991 Vali Acc: 0.700 Test Loss: 0.991 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.104569673538208
Epoch: 47, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9545304775238037
Epoch: 48, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.973 Vali Acc: 0.696 Test Loss: 0.973 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9998819828033447
Epoch: 49, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.965 Vali Acc: 0.696 Test Loss: 0.965 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9865894317626953
Epoch: 50, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.957 Vali Acc: 0.696 Test Loss: 0.957 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9823181629180908
Epoch: 51, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9554727077484131
Epoch: 52, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.017199993133545
Epoch: 53, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0336990356445312
Epoch: 54, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.068225622177124
Epoch: 55, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.925 Vali Acc: 0.704 Test Loss: 0.925 Test Acc: 0.704
Validation loss decreased (-0.703694 --> -0.703694).  Saving model ...
Epoch: 56 cost time: 1.075608253479004
Epoch: 56, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.919 Vali Acc: 0.707 Test Loss: 0.919 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707398).  Saving model ...
Epoch: 57 cost time: 1.1311454772949219
Epoch: 57, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.913 Vali Acc: 0.707 Test Loss: 0.913 Test Acc: 0.707
Validation loss decreased (-0.707398 --> -0.707398).  Saving model ...
Epoch: 58 cost time: 1.1074047088623047
Epoch: 58, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 59 cost time: 1.118509292602539
Epoch: 59, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.902 Vali Acc: 0.715 Test Loss: 0.902 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 60 cost time: 1.069634199142456
Epoch: 60, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.897 Vali Acc: 0.719 Test Loss: 0.897 Test Acc: 0.719
Validation loss decreased (-0.714806 --> -0.718510).  Saving model ...
Epoch: 61 cost time: 1.073563814163208
Epoch: 61, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.891 Vali Acc: 0.719 Test Loss: 0.891 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 62 cost time: 1.162841796875
Epoch: 62, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.885 Vali Acc: 0.719 Test Loss: 0.885 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 63 cost time: 1.0175940990447998
Epoch: 63, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.879 Vali Acc: 0.719 Test Loss: 0.879 Test Acc: 0.719
Validation loss decreased (-0.718510 --> -0.718510).  Saving model ...
Epoch: 64 cost time: 1.0236387252807617
Epoch: 64, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
Validation loss decreased (-0.718510 --> -0.722213).  Saving model ...
Epoch: 65 cost time: 1.1878890991210938
Epoch: 65, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 66 cost time: 1.0541372299194336
Epoch: 66, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 67 cost time: 1.1231658458709717
Epoch: 67, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 68 cost time: 1.0155224800109863
Epoch: 68, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.854 Vali Acc: 0.722 Test Loss: 0.854 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 69 cost time: 1.1407744884490967
Epoch: 69, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.849 Vali Acc: 0.726 Test Loss: 0.849 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725917).  Saving model ...
Epoch: 70 cost time: 1.0116055011749268
Epoch: 70, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9572327136993408
Epoch: 71, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.839 Vali Acc: 0.730 Test Loss: 0.839 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 72 cost time: 1.070401906967163
Epoch: 72, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.835 Vali Acc: 0.733 Test Loss: 0.835 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733325).  Saving model ...
Epoch: 73 cost time: 1.1075546741485596
Epoch: 73, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.830 Vali Acc: 0.733 Test Loss: 0.830 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 74 cost time: 1.0888512134552002
Epoch: 74, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 75 cost time: 1.1817903518676758
Epoch: 75, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.821 Vali Acc: 0.733 Test Loss: 0.821 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 76 cost time: 0.9432744979858398
Epoch: 76, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.817 Vali Acc: 0.733 Test Loss: 0.817 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 77 cost time: 0.9103951454162598
Epoch: 77, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.814 Vali Acc: 0.737 Test Loss: 0.814 Test Acc: 0.737
Validation loss decreased (-0.733325 --> -0.737029).  Saving model ...
Epoch: 78 cost time: 0.980858564376831
Epoch: 78, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.809 Vali Acc: 0.737 Test Loss: 0.809 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 79 cost time: 1.1249268054962158
Epoch: 79, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 80 cost time: 1.1282374858856201
Epoch: 80, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.801 Vali Acc: 0.737 Test Loss: 0.801 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 81 cost time: 1.068124771118164
Epoch: 81, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 82 cost time: 1.1011664867401123
Epoch: 82, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.794 Vali Acc: 0.737 Test Loss: 0.794 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 83 cost time: 1.04374361038208
Epoch: 83, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.737029 --> -0.744437).  Saving model ...
Epoch: 84 cost time: 1.079658031463623
Epoch: 84, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 85 cost time: 1.0816621780395508
Epoch: 85, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.783 Vali Acc: 0.748 Test Loss: 0.783 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748140).  Saving model ...
Epoch: 86 cost time: 1.159372329711914
Epoch: 86, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.780 Vali Acc: 0.748 Test Loss: 0.780 Test Acc: 0.748
Validation loss decreased (-0.748140 --> -0.748140).  Saving model ...
Epoch: 87 cost time: 1.154249668121338
Epoch: 87, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.776 Vali Acc: 0.752 Test Loss: 0.776 Test Acc: 0.752
Validation loss decreased (-0.748140 --> -0.751844).  Saving model ...
Epoch: 88 cost time: 1.1069185733795166
Epoch: 88, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.773 Vali Acc: 0.752 Test Loss: 0.773 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 89 cost time: 1.1130375862121582
Epoch: 89, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.770 Vali Acc: 0.752 Test Loss: 0.770 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 90 cost time: 1.1202096939086914
Epoch: 90, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755548).  Saving model ...
Epoch: 91 cost time: 1.008025884628296
Epoch: 91, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.762 Vali Acc: 0.759 Test Loss: 0.762 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
Epoch: 92 cost time: 1.1881828308105469
Epoch: 92, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.759 Vali Acc: 0.759 Test Loss: 0.759 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 93 cost time: 1.1050209999084473
Epoch: 93, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.755 Vali Acc: 0.763 Test Loss: 0.755 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762955).  Saving model ...
Epoch: 94 cost time: 0.9968807697296143
Epoch: 94, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.752 Vali Acc: 0.759 Test Loss: 0.752 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.0030953884124756
Epoch: 95, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.748 Vali Acc: 0.759 Test Loss: 0.748 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.007066011428833
Epoch: 96, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.744 Vali Acc: 0.759 Test Loss: 0.744 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.1013071537017822
Epoch: 97, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.741 Vali Acc: 0.763 Test Loss: 0.741 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762956).  Saving model ...
Epoch: 98 cost time: 1.111405611038208
Epoch: 98, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 99 cost time: 1.0095889568328857
Epoch: 99, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.734 Vali Acc: 0.763 Test Loss: 0.734 Test Acc: 0.763
Validation loss decreased (-0.762956 --> -0.762956).  Saving model ...
Epoch: 100 cost time: 1.0311803817749023
Epoch: 100, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
Validation loss decreased (-0.762956 --> -0.770363).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7703703703703704
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.808018684387207
Epoch: 1, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.780 Vali Acc: 0.181 Test Loss: 1.780 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 1.0635085105895996
Epoch: 2, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.772 Vali Acc: 0.196 Test Loss: 1.772 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 1.0660908222198486
Epoch: 3, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.765 Vali Acc: 0.200 Test Loss: 1.765 Test Acc: 0.200
Validation loss decreased (-0.196279 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.078974962234497
Epoch: 4, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.759 Vali Acc: 0.204 Test Loss: 1.759 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 1.015169620513916
Epoch: 5, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.751 Vali Acc: 0.215 Test Loss: 1.751 Test Acc: 0.215
Validation loss decreased (-0.203686 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 1.1652004718780518
Epoch: 6, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.742 Vali Acc: 0.219 Test Loss: 1.742 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 1.0151255130767822
Epoch: 7, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
Validation loss decreased (-0.218501 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 1.0020051002502441
Epoch: 8, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.720 Vali Acc: 0.278 Test Loss: 1.720 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.9925224781036377
Epoch: 9, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.708 Vali Acc: 0.304 Test Loss: 1.708 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 10 cost time: 0.8786211013793945
Epoch: 10, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.695 Vali Acc: 0.315 Test Loss: 1.695 Test Acc: 0.315
Validation loss decreased (-0.303687 --> -0.314798).  Saving model ...
Epoch: 11 cost time: 1.0199408531188965
Epoch: 11, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.681 Vali Acc: 0.326 Test Loss: 1.681 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 12 cost time: 0.9898014068603516
Epoch: 12, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.666 Vali Acc: 0.348 Test Loss: 1.666 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348131).  Saving model ...
Epoch: 13 cost time: 0.9720206260681152
Epoch: 13, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.652 Vali Acc: 0.359 Test Loss: 1.652 Test Acc: 0.359
Validation loss decreased (-0.348131 --> -0.359243).  Saving model ...
Epoch: 14 cost time: 1.0405652523040771
Epoch: 14, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.637 Vali Acc: 0.381 Test Loss: 1.637 Test Acc: 0.381
Validation loss decreased (-0.359243 --> -0.381465).  Saving model ...
Epoch: 15 cost time: 0.9481797218322754
Epoch: 15, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.621 Vali Acc: 0.393 Test Loss: 1.621 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392576).  Saving model ...
Epoch: 16 cost time: 0.9575033187866211
Epoch: 16, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.605 Vali Acc: 0.415 Test Loss: 1.605 Test Acc: 0.415
Validation loss decreased (-0.392576 --> -0.414799).  Saving model ...
Epoch: 17 cost time: 1.093038558959961
Epoch: 17, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.589 Vali Acc: 0.415 Test Loss: 1.589 Test Acc: 0.415
Validation loss decreased (-0.414799 --> -0.414799).  Saving model ...
Epoch: 18 cost time: 1.084942102432251
Epoch: 18, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.573 Vali Acc: 0.430 Test Loss: 1.573 Test Acc: 0.430
Validation loss decreased (-0.414799 --> -0.429614).  Saving model ...
Epoch: 19 cost time: 1.2705130577087402
Epoch: 19, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.557 Vali Acc: 0.448 Test Loss: 1.557 Test Acc: 0.448
Validation loss decreased (-0.429614 --> -0.448133).  Saving model ...
Epoch: 20 cost time: 1.0536909103393555
Epoch: 20, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.540 Vali Acc: 0.485 Test Loss: 1.540 Test Acc: 0.485
Validation loss decreased (-0.448133 --> -0.485170).  Saving model ...
Epoch: 21 cost time: 1.084932565689087
Epoch: 21, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.524 Vali Acc: 0.478 Test Loss: 1.524 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1292870044708252
Epoch: 22, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.508 Vali Acc: 0.493 Test Loss: 1.508 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492578).  Saving model ...
Epoch: 23 cost time: 1.174079179763794
Epoch: 23, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
Validation loss decreased (-0.492578 --> -0.496281).  Saving model ...
Epoch: 24 cost time: 1.2876801490783691
Epoch: 24, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.475 Vali Acc: 0.496 Test Loss: 1.475 Test Acc: 0.496
Validation loss decreased (-0.496281 --> -0.496282).  Saving model ...
Epoch: 25 cost time: 1.1721887588500977
Epoch: 25, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
Validation loss decreased (-0.496282 --> -0.511097).  Saving model ...
Epoch: 26 cost time: 1.1859138011932373
Epoch: 26, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.444 Vali Acc: 0.511 Test Loss: 1.444 Test Acc: 0.511
Validation loss decreased (-0.511097 --> -0.511097).  Saving model ...
Epoch: 27 cost time: 1.0912704467773438
Epoch: 27, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.428 Vali Acc: 0.515 Test Loss: 1.428 Test Acc: 0.515
Validation loss decreased (-0.511097 --> -0.514801).  Saving model ...
Epoch: 28 cost time: 1.199479103088379
Epoch: 28, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.413 Vali Acc: 0.515 Test Loss: 1.413 Test Acc: 0.515
Validation loss decreased (-0.514801 --> -0.514801).  Saving model ...
Epoch: 29 cost time: 1.0730037689208984
Epoch: 29, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.397 Vali Acc: 0.522 Test Loss: 1.397 Test Acc: 0.522
Validation loss decreased (-0.514801 --> -0.522208).  Saving model ...
Epoch: 30 cost time: 1.160757064819336
Epoch: 30, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.381 Vali Acc: 0.537 Test Loss: 1.381 Test Acc: 0.537
Validation loss decreased (-0.522208 --> -0.537023).  Saving model ...
Epoch: 31 cost time: 1.2459752559661865
Epoch: 31, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.366 Vali Acc: 0.541 Test Loss: 1.366 Test Acc: 0.541
Validation loss decreased (-0.537023 --> -0.540727).  Saving model ...
Epoch: 32 cost time: 1.1728076934814453
Epoch: 32, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.351 Vali Acc: 0.537 Test Loss: 1.351 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2511332035064697
Epoch: 33, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.336 Vali Acc: 0.541 Test Loss: 1.336 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 34 cost time: 1.2424921989440918
Epoch: 34, Steps: 2 | Train Loss: 0.844 Vali Loss: 1.321 Vali Acc: 0.537 Test Loss: 1.321 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1493911743164062
Epoch: 35, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540728).  Saving model ...
Epoch: 36 cost time: 1.2641069889068604
Epoch: 36, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.292 Vali Acc: 0.548 Test Loss: 1.292 Test Acc: 0.548
Validation loss decreased (-0.540728 --> -0.548135).  Saving model ...
Epoch: 37 cost time: 0.9767248630523682
Epoch: 37, Steps: 2 | Train Loss: 0.699 Vali Loss: 1.278 Vali Acc: 0.552 Test Loss: 1.278 Test Acc: 0.552
Validation loss decreased (-0.548135 --> -0.551839).  Saving model ...
Epoch: 38 cost time: 1.016505241394043
Epoch: 38, Steps: 2 | Train Loss: 0.723 Vali Loss: 1.264 Vali Acc: 0.559 Test Loss: 1.264 Test Acc: 0.559
Validation loss decreased (-0.551839 --> -0.559247).  Saving model ...
Epoch: 39 cost time: 1.147343635559082
Epoch: 39, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.250 Vali Acc: 0.567 Test Loss: 1.250 Test Acc: 0.567
Validation loss decreased (-0.559247 --> -0.566654).  Saving model ...
Epoch: 40 cost time: 1.0948030948638916
Epoch: 40, Steps: 2 | Train Loss: 0.611 Vali Loss: 1.237 Vali Acc: 0.570 Test Loss: 1.237 Test Acc: 0.570
Validation loss decreased (-0.566654 --> -0.570358).  Saving model ...
Epoch: 41 cost time: 1.2693760395050049
Epoch: 41, Steps: 2 | Train Loss: 0.616 Vali Loss: 1.224 Vali Acc: 0.570 Test Loss: 1.224 Test Acc: 0.570
Validation loss decreased (-0.570358 --> -0.570358).  Saving model ...
Epoch: 42 cost time: 1.1827855110168457
Epoch: 42, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.212 Vali Acc: 0.574 Test Loss: 1.212 Test Acc: 0.574
Validation loss decreased (-0.570358 --> -0.574062).  Saving model ...
Epoch: 43 cost time: 1.1433758735656738
Epoch: 43, Steps: 2 | Train Loss: 0.583 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
Validation loss decreased (-0.574062 --> -0.581469).  Saving model ...
Epoch: 44 cost time: 1.1430995464324951
Epoch: 44, Steps: 2 | Train Loss: 0.493 Vali Loss: 1.187 Vali Acc: 0.589 Test Loss: 1.187 Test Acc: 0.589
Validation loss decreased (-0.581469 --> -0.588877).  Saving model ...
Epoch: 45 cost time: 1.1544451713562012
Epoch: 45, Steps: 2 | Train Loss: 0.449 Vali Loss: 1.175 Vali Acc: 0.585 Test Loss: 1.175 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1392998695373535
Epoch: 46, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.164 Vali Acc: 0.589 Test Loss: 1.164 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588877).  Saving model ...
Epoch: 47 cost time: 1.1912307739257812
Epoch: 47, Steps: 2 | Train Loss: 0.425 Vali Loss: 1.152 Vali Acc: 0.589 Test Loss: 1.152 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588877).  Saving model ...
Epoch: 48 cost time: 1.2379462718963623
Epoch: 48, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.140 Vali Acc: 0.593 Test Loss: 1.140 Test Acc: 0.593
Validation loss decreased (-0.588877 --> -0.592581).  Saving model ...
Epoch: 49 cost time: 1.2919278144836426
Epoch: 49, Steps: 2 | Train Loss: 0.383 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.592581 --> -0.599989).  Saving model ...
Epoch: 50 cost time: 1.2391278743743896
Epoch: 50, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 51 cost time: 1.0601439476013184
Epoch: 51, Steps: 2 | Train Loss: 0.321 Vali Loss: 1.107 Vali Acc: 0.604 Test Loss: 1.107 Test Acc: 0.604
Validation loss decreased (-0.599989 --> -0.603693).  Saving model ...
Epoch: 52 cost time: 1.1103284358978271
Epoch: 52, Steps: 2 | Train Loss: 0.314 Vali Loss: 1.097 Vali Acc: 0.604 Test Loss: 1.097 Test Acc: 0.604
Validation loss decreased (-0.603693 --> -0.603693).  Saving model ...
Epoch: 53 cost time: 1.2512328624725342
Epoch: 53, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.086 Vali Acc: 0.607 Test Loss: 1.086 Test Acc: 0.607
Validation loss decreased (-0.603693 --> -0.607397).  Saving model ...
Epoch: 54 cost time: 1.202876091003418
Epoch: 54, Steps: 2 | Train Loss: 0.274 Vali Loss: 1.077 Vali Acc: 0.607 Test Loss: 1.077 Test Acc: 0.607
Validation loss decreased (-0.607397 --> -0.607397).  Saving model ...
Epoch: 55 cost time: 1.0996594429016113
Epoch: 55, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.066 Vali Acc: 0.611 Test Loss: 1.066 Test Acc: 0.611
Validation loss decreased (-0.607397 --> -0.611100).  Saving model ...
Epoch: 56 cost time: 1.209622859954834
Epoch: 56, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.055 Vali Acc: 0.611 Test Loss: 1.055 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611101).  Saving model ...
Epoch: 57 cost time: 1.264855146408081
Epoch: 57, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.045 Vali Acc: 0.619 Test Loss: 1.045 Test Acc: 0.619
Validation loss decreased (-0.611101 --> -0.618508).  Saving model ...
Epoch: 58 cost time: 1.2983386516571045
Epoch: 58, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.035 Vali Acc: 0.626 Test Loss: 1.035 Test Acc: 0.626
Validation loss decreased (-0.618508 --> -0.625916).  Saving model ...
Epoch: 59 cost time: 1.3135323524475098
Epoch: 59, Steps: 2 | Train Loss: 0.207 Vali Loss: 1.025 Vali Acc: 0.637 Test Loss: 1.025 Test Acc: 0.637
Validation loss decreased (-0.625916 --> -0.637027).  Saving model ...
Epoch: 60 cost time: 1.1768243312835693
Epoch: 60, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.016 Vali Acc: 0.637 Test Loss: 1.016 Test Acc: 0.637
Validation loss decreased (-0.637027 --> -0.637027).  Saving model ...
Epoch: 61 cost time: 1.0227735042572021
Epoch: 61, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.006 Vali Acc: 0.644 Test Loss: 1.006 Test Acc: 0.644
Validation loss decreased (-0.637027 --> -0.644434).  Saving model ...
Epoch: 62 cost time: 1.0816314220428467
Epoch: 62, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.995 Vali Acc: 0.648 Test Loss: 0.995 Test Acc: 0.648
Validation loss decreased (-0.644434 --> -0.648138).  Saving model ...
Epoch: 63 cost time: 0.8790891170501709
Epoch: 63, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.985 Vali Acc: 0.656 Test Loss: 0.985 Test Acc: 0.656
Validation loss decreased (-0.648138 --> -0.655546).  Saving model ...
Epoch: 64 cost time: 1.0266125202178955
Epoch: 64, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 65 cost time: 1.0772311687469482
Epoch: 65, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.965 Vali Acc: 0.663 Test Loss: 0.965 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9424309730529785
Epoch: 66, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.956 Vali Acc: 0.667 Test Loss: 0.956 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 67 cost time: 1.1657562255859375
Epoch: 67, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.945 Vali Acc: 0.670 Test Loss: 0.945 Test Acc: 0.670
Validation loss decreased (-0.666657 --> -0.670361).  Saving model ...
Epoch: 68 cost time: 0.9922716617584229
Epoch: 68, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.935 Vali Acc: 0.670 Test Loss: 0.935 Test Acc: 0.670
Validation loss decreased (-0.670361 --> -0.670361).  Saving model ...
Epoch: 69 cost time: 1.0245394706726074
Epoch: 69, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.924 Vali Acc: 0.674 Test Loss: 0.924 Test Acc: 0.674
Validation loss decreased (-0.670361 --> -0.674065).  Saving model ...
Epoch: 70 cost time: 1.236438274383545
Epoch: 70, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.914 Vali Acc: 0.678 Test Loss: 0.914 Test Acc: 0.678
Validation loss decreased (-0.674065 --> -0.677769).  Saving model ...
Epoch: 71 cost time: 1.1333718299865723
Epoch: 71, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.904 Vali Acc: 0.678 Test Loss: 0.904 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 72 cost time: 1.0770378112792969
Epoch: 72, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.895 Vali Acc: 0.685 Test Loss: 0.895 Test Acc: 0.685
Validation loss decreased (-0.677769 --> -0.685176).  Saving model ...
Epoch: 73 cost time: 1.1777434349060059
Epoch: 73, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.884 Vali Acc: 0.685 Test Loss: 0.884 Test Acc: 0.685
Validation loss decreased (-0.685176 --> -0.685176).  Saving model ...
Epoch: 74 cost time: 1.1889910697937012
Epoch: 74, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.875 Vali Acc: 0.689 Test Loss: 0.875 Test Acc: 0.689
Validation loss decreased (-0.685176 --> -0.688880).  Saving model ...
Epoch: 75 cost time: 1.1746995449066162
Epoch: 75, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.866 Vali Acc: 0.693 Test Loss: 0.866 Test Acc: 0.693
Validation loss decreased (-0.688880 --> -0.692584).  Saving model ...
Epoch: 76 cost time: 1.156662940979004
Epoch: 76, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.857 Vali Acc: 0.693 Test Loss: 0.857 Test Acc: 0.693
Validation loss decreased (-0.692584 --> -0.692584).  Saving model ...
Epoch: 77 cost time: 1.157327651977539
Epoch: 77, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.848 Vali Acc: 0.696 Test Loss: 0.848 Test Acc: 0.696
Validation loss decreased (-0.692584 --> -0.696288).  Saving model ...
Epoch: 78 cost time: 0.9173738956451416
Epoch: 78, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
Validation loss decreased (-0.696288 --> -0.699992).  Saving model ...
Epoch: 79 cost time: 1.113752841949463
Epoch: 79, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.831 Vali Acc: 0.700 Test Loss: 0.831 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 80 cost time: 1.070711374282837
Epoch: 80, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.822 Vali Acc: 0.707 Test Loss: 0.822 Test Acc: 0.707
Validation loss decreased (-0.699992 --> -0.707399).  Saving model ...
Epoch: 81 cost time: 1.1291179656982422
Epoch: 81, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.815 Vali Acc: 0.707 Test Loss: 0.815 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 82 cost time: 0.9655508995056152
Epoch: 82, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.808 Vali Acc: 0.711 Test Loss: 0.808 Test Acc: 0.711
Validation loss decreased (-0.707399 --> -0.711103).  Saving model ...
Epoch: 83 cost time: 1.1136605739593506
Epoch: 83, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.800 Vali Acc: 0.715 Test Loss: 0.800 Test Acc: 0.715
Validation loss decreased (-0.711103 --> -0.714807).  Saving model ...
Epoch: 84 cost time: 1.1873807907104492
Epoch: 84, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.794 Vali Acc: 0.711 Test Loss: 0.794 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.1871073246002197
Epoch: 85, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.0660285949707031
Epoch: 86, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.780 Vali Acc: 0.726 Test Loss: 0.780 Test Acc: 0.726
Validation loss decreased (-0.714807 --> -0.725918).  Saving model ...
Epoch: 87 cost time: 1.2117817401885986
Epoch: 87, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.774 Vali Acc: 0.730 Test Loss: 0.774 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 88 cost time: 1.0718519687652588
Epoch: 88, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.768 Vali Acc: 0.733 Test Loss: 0.768 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
Epoch: 89 cost time: 1.1384568214416504
Epoch: 89, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
Validation loss decreased (-0.733326 --> -0.737029).  Saving model ...
Epoch: 90 cost time: 1.1216075420379639
Epoch: 90, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737029).  Saving model ...
Epoch: 91 cost time: 1.0961897373199463
Epoch: 91, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.751 Vali Acc: 0.737 Test Loss: 0.751 Test Acc: 0.737
Validation loss decreased (-0.737029 --> -0.737030).  Saving model ...
Epoch: 92 cost time: 1.1720712184906006
Epoch: 92, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.746 Vali Acc: 0.737 Test Loss: 0.746 Test Acc: 0.737
Validation loss decreased (-0.737030 --> -0.737030).  Saving model ...
Epoch: 93 cost time: 1.1223294734954834
Epoch: 93, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.741 Vali Acc: 0.733 Test Loss: 0.741 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.0515811443328857
Epoch: 94, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
Validation loss decreased (-0.737030 --> -0.737030).  Saving model ...
Epoch: 95 cost time: 1.102186679840088
Epoch: 95, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.731 Vali Acc: 0.741 Test Loss: 0.731 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740733).  Saving model ...
Epoch: 96 cost time: 1.3044633865356445
Epoch: 96, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.726 Vali Acc: 0.748 Test Loss: 0.726 Test Acc: 0.748
Validation loss decreased (-0.740733 --> -0.748141).  Saving model ...
Epoch: 97 cost time: 1.1411216259002686
Epoch: 97, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.720 Vali Acc: 0.759 Test Loss: 0.720 Test Acc: 0.759
Validation loss decreased (-0.748141 --> -0.759252).  Saving model ...
Epoch: 98 cost time: 1.1983673572540283
Epoch: 98, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.715 Vali Acc: 0.763 Test Loss: 0.715 Test Acc: 0.763
Validation loss decreased (-0.759252 --> -0.762956).  Saving model ...
Epoch: 99 cost time: 1.095956802368164
Epoch: 99, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
Validation loss decreased (-0.762956 --> -0.766660).  Saving model ...
Epoch: 100 cost time: 1.1923949718475342
Epoch: 100, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.705 Vali Acc: 0.767 Test Loss: 0.705 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7666666666666667
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.594000816345215
Epoch: 1, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.812 Vali Acc: 0.226 Test Loss: 1.812 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 1.0674312114715576
Epoch: 2, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.805 Vali Acc: 0.237 Test Loss: 1.805 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 1.1112854480743408
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.799 Vali Acc: 0.237 Test Loss: 1.799 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.9986846446990967
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.794 Vali Acc: 0.241 Test Loss: 1.794 Test Acc: 0.241
Validation loss decreased (-0.237019 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.9823431968688965
Epoch: 5, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.787 Vali Acc: 0.244 Test Loss: 1.787 Test Acc: 0.244
Validation loss decreased (-0.240723 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 1.0104219913482666
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.778 Vali Acc: 0.252 Test Loss: 1.778 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 1.1280405521392822
Epoch: 7, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.768 Vali Acc: 0.270 Test Loss: 1.768 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 1.095050573348999
Epoch: 8, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.758 Vali Acc: 0.274 Test Loss: 1.758 Test Acc: 0.274
Validation loss decreased (-0.270353 --> -0.274056).  Saving model ...
Epoch: 9 cost time: 1.1332440376281738
Epoch: 9, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.747 Vali Acc: 0.285 Test Loss: 1.747 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285168).  Saving model ...
Epoch: 10 cost time: 1.0930001735687256
Epoch: 10, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.285168 --> -0.296279).  Saving model ...
Epoch: 11 cost time: 1.0327134132385254
Epoch: 11, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.722 Vali Acc: 0.304 Test Loss: 1.722 Test Acc: 0.304
Validation loss decreased (-0.296279 --> -0.303686).  Saving model ...
Epoch: 12 cost time: 1.116919755935669
Epoch: 12, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.709 Vali Acc: 0.307 Test Loss: 1.709 Test Acc: 0.307
Validation loss decreased (-0.303686 --> -0.307390).  Saving model ...
Epoch: 13 cost time: 1.0905213356018066
Epoch: 13, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.696 Vali Acc: 0.319 Test Loss: 1.696 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318502).  Saving model ...
Epoch: 14 cost time: 1.1265661716461182
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.682 Vali Acc: 0.326 Test Loss: 1.682 Test Acc: 0.326
Validation loss decreased (-0.318502 --> -0.325909).  Saving model ...
Epoch: 15 cost time: 1.2792320251464844
Epoch: 15, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.669 Vali Acc: 0.333 Test Loss: 1.669 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333317).  Saving model ...
Epoch: 16 cost time: 1.021132230758667
Epoch: 16, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.654 Vali Acc: 0.344 Test Loss: 1.654 Test Acc: 0.344
Validation loss decreased (-0.333317 --> -0.344428).  Saving model ...
Epoch: 17 cost time: 1.032109260559082
Epoch: 17, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.640 Vali Acc: 0.341 Test Loss: 1.640 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2111921310424805
Epoch: 18, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.625 Vali Acc: 0.344 Test Loss: 1.625 Test Acc: 0.344
Validation loss decreased (-0.344428 --> -0.344428).  Saving model ...
Epoch: 19 cost time: 0.9569611549377441
Epoch: 19, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.609 Vali Acc: 0.359 Test Loss: 1.609 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359243).  Saving model ...
Epoch: 20 cost time: 1.0541157722473145
Epoch: 20, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.594 Vali Acc: 0.370 Test Loss: 1.594 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 21 cost time: 0.920612096786499
Epoch: 21, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.578 Vali Acc: 0.378 Test Loss: 1.578 Test Acc: 0.378
Validation loss decreased (-0.370354 --> -0.377762).  Saving model ...
Epoch: 22 cost time: 0.9559175968170166
Epoch: 22, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.562 Vali Acc: 0.393 Test Loss: 1.562 Test Acc: 0.393
Validation loss decreased (-0.377762 --> -0.392577).  Saving model ...
Epoch: 23 cost time: 1.0183541774749756
Epoch: 23, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.547 Vali Acc: 0.426 Test Loss: 1.547 Test Acc: 0.426
Validation loss decreased (-0.392577 --> -0.425910).  Saving model ...
Epoch: 24 cost time: 1.0457391738891602
Epoch: 24, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.531 Vali Acc: 0.463 Test Loss: 1.531 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462948).  Saving model ...
Epoch: 25 cost time: 0.9789090156555176
Epoch: 25, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.516 Vali Acc: 0.481 Test Loss: 1.516 Test Acc: 0.481
Validation loss decreased (-0.462948 --> -0.481466).  Saving model ...
Epoch: 26 cost time: 1.0150952339172363
Epoch: 26, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.500 Vali Acc: 0.530 Test Loss: 1.500 Test Acc: 0.530
Validation loss decreased (-0.481466 --> -0.529615).  Saving model ...
Epoch: 27 cost time: 1.0083930492401123
Epoch: 27, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.485 Vali Acc: 0.548 Test Loss: 1.485 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548133).  Saving model ...
Epoch: 28 cost time: 1.0530760288238525
Epoch: 28, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.469 Vali Acc: 0.559 Test Loss: 1.469 Test Acc: 0.559
Validation loss decreased (-0.548133 --> -0.559245).  Saving model ...
Epoch: 29 cost time: 1.074103832244873
Epoch: 29, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.453 Vali Acc: 0.589 Test Loss: 1.453 Test Acc: 0.589
Validation loss decreased (-0.559245 --> -0.588874).  Saving model ...
Epoch: 30 cost time: 0.9293863773345947
Epoch: 30, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.436 Vali Acc: 0.604 Test Loss: 1.436 Test Acc: 0.604
Validation loss decreased (-0.588874 --> -0.603689).  Saving model ...
Epoch: 31 cost time: 1.0178868770599365
Epoch: 31, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.420 Vali Acc: 0.615 Test Loss: 1.420 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614801).  Saving model ...
Epoch: 32 cost time: 0.9919586181640625
Epoch: 32, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.403 Vali Acc: 0.615 Test Loss: 1.403 Test Acc: 0.615
Validation loss decreased (-0.614801 --> -0.614801).  Saving model ...
Epoch: 33 cost time: 1.0672006607055664
Epoch: 33, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.386 Vali Acc: 0.622 Test Loss: 1.386 Test Acc: 0.622
Validation loss decreased (-0.614801 --> -0.622208).  Saving model ...
Epoch: 34 cost time: 1.1073808670043945
Epoch: 34, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.369 Vali Acc: 0.626 Test Loss: 1.369 Test Acc: 0.626
Validation loss decreased (-0.622208 --> -0.625912).  Saving model ...
Epoch: 35 cost time: 1.0568017959594727
Epoch: 35, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.351 Vali Acc: 0.641 Test Loss: 1.351 Test Acc: 0.641
Validation loss decreased (-0.625912 --> -0.640727).  Saving model ...
Epoch: 36 cost time: 1.172766923904419
Epoch: 36, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.334 Vali Acc: 0.652 Test Loss: 1.334 Test Acc: 0.652
Validation loss decreased (-0.640727 --> -0.651839).  Saving model ...
Epoch: 37 cost time: 1.0540969371795654
Epoch: 37, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.317 Vali Acc: 0.659 Test Loss: 1.317 Test Acc: 0.659
Validation loss decreased (-0.651839 --> -0.659246).  Saving model ...
Epoch: 38 cost time: 1.146117925643921
Epoch: 38, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.299 Vali Acc: 0.670 Test Loss: 1.299 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 39 cost time: 1.0844955444335938
Epoch: 39, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.282 Vali Acc: 0.663 Test Loss: 1.282 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1466443538665771
Epoch: 40, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.264 Vali Acc: 0.674 Test Loss: 1.264 Test Acc: 0.674
Validation loss decreased (-0.670357 --> -0.674061).  Saving model ...
Epoch: 41 cost time: 1.0619487762451172
Epoch: 41, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.247 Vali Acc: 0.678 Test Loss: 1.247 Test Acc: 0.678
Validation loss decreased (-0.674061 --> -0.677765).  Saving model ...
Epoch: 42 cost time: 1.0320658683776855
Epoch: 42, Steps: 2 | Train Loss: 0.823 Vali Loss: 1.229 Vali Acc: 0.689 Test Loss: 1.229 Test Acc: 0.689
Validation loss decreased (-0.677765 --> -0.688877).  Saving model ...
Epoch: 43 cost time: 0.9898481369018555
Epoch: 43, Steps: 2 | Train Loss: 0.771 Vali Loss: 1.210 Vali Acc: 0.693 Test Loss: 1.210 Test Acc: 0.693
Validation loss decreased (-0.688877 --> -0.692580).  Saving model ...
Epoch: 44 cost time: 1.0738112926483154
Epoch: 44, Steps: 2 | Train Loss: 0.752 Vali Loss: 1.189 Vali Acc: 0.696 Test Loss: 1.189 Test Acc: 0.696
Validation loss decreased (-0.692580 --> -0.696284).  Saving model ...
Epoch: 45 cost time: 1.0183453559875488
Epoch: 45, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.168 Vali Acc: 0.700 Test Loss: 1.168 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 46 cost time: 0.981053352355957
Epoch: 46, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.146 Vali Acc: 0.704 Test Loss: 1.146 Test Acc: 0.704
Validation loss decreased (-0.699988 --> -0.703692).  Saving model ...
Epoch: 47 cost time: 0.9828689098358154
Epoch: 47, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.124 Vali Acc: 0.707 Test Loss: 1.124 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 48 cost time: 1.063157558441162
Epoch: 48, Steps: 2 | Train Loss: 0.560 Vali Loss: 1.102 Vali Acc: 0.707 Test Loss: 1.102 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 49 cost time: 0.952101469039917
Epoch: 49, Steps: 2 | Train Loss: 0.575 Vali Loss: 1.080 Vali Acc: 0.711 Test Loss: 1.080 Test Acc: 0.711
Validation loss decreased (-0.707396 --> -0.711100).  Saving model ...
Epoch: 50 cost time: 1.1059865951538086
Epoch: 50, Steps: 2 | Train Loss: 0.498 Vali Loss: 1.057 Vali Acc: 0.733 Test Loss: 1.057 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 51 cost time: 1.0858526229858398
Epoch: 51, Steps: 2 | Train Loss: 0.546 Vali Loss: 1.033 Vali Acc: 0.744 Test Loss: 1.033 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 52 cost time: 1.0385534763336182
Epoch: 52, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.010 Vali Acc: 0.748 Test Loss: 1.010 Test Acc: 0.748
Validation loss decreased (-0.744434 --> -0.748138).  Saving model ...
Epoch: 53 cost time: 1.0810306072235107
Epoch: 53, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.987 Vali Acc: 0.752 Test Loss: 0.987 Test Acc: 0.752
Validation loss decreased (-0.748138 --> -0.751842).  Saving model ...
Epoch: 54 cost time: 1.280515432357788
Epoch: 54, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
Validation loss decreased (-0.751842 --> -0.755546).  Saving model ...
Epoch: 55 cost time: 1.2797834873199463
Epoch: 55, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.943 Vali Acc: 0.752 Test Loss: 0.943 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.280712604522705
Epoch: 56, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.921 Vali Acc: 0.748 Test Loss: 0.921 Test Acc: 0.748
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.202608585357666
Epoch: 57, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.900 Vali Acc: 0.748 Test Loss: 0.900 Test Acc: 0.748
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.2628872394561768
Epoch: 58, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755547).  Saving model ...
Epoch: 59 cost time: 1.2627193927764893
Epoch: 59, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.860 Vali Acc: 0.756 Test Loss: 0.860 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 60 cost time: 1.352005958557129
Epoch: 60, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.841 Vali Acc: 0.763 Test Loss: 0.841 Test Acc: 0.763
Validation loss decreased (-0.755547 --> -0.762955).  Saving model ...
Epoch: 61 cost time: 1.2280793190002441
Epoch: 61, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.822 Vali Acc: 0.763 Test Loss: 0.822 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 62 cost time: 1.2348182201385498
Epoch: 62, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 63 cost time: 1.29337739944458
Epoch: 63, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 64 cost time: 1.3624556064605713
Epoch: 64, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.770 Vali Acc: 0.781 Test Loss: 0.770 Test Acc: 0.781
Validation loss decreased (-0.777770 --> -0.781474).  Saving model ...
Epoch: 65 cost time: 1.2434155941009521
Epoch: 65, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.754 Vali Acc: 0.774 Test Loss: 0.754 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.2360901832580566
Epoch: 66, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.311255931854248
Epoch: 67, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.730 Vali Acc: 0.774 Test Loss: 0.730 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.2144110202789307
Epoch: 68, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.719 Vali Acc: 0.770 Test Loss: 0.719 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.2125113010406494
Epoch: 69, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.708 Vali Acc: 0.770 Test Loss: 0.708 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.1107702255249023
Epoch: 70, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.695 Vali Acc: 0.774 Test Loss: 0.695 Test Acc: 0.774
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.140467643737793
Epoch: 71, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.682 Vali Acc: 0.778 Test Loss: 0.682 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.2054862976074219
Epoch: 72, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.668 Vali Acc: 0.781 Test Loss: 0.668 Test Acc: 0.781
Validation loss decreased (-0.781474 --> -0.781475).  Saving model ...
Epoch: 73 cost time: 1.1011772155761719
Epoch: 73, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.654 Vali Acc: 0.793 Test Loss: 0.654 Test Acc: 0.793
Validation loss decreased (-0.781475 --> -0.792586).  Saving model ...
Epoch: 74 cost time: 1.2224433422088623
Epoch: 74, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.792586 --> -0.799994).  Saving model ...
Epoch: 75 cost time: 1.0659825801849365
Epoch: 75, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.629 Vali Acc: 0.804 Test Loss: 0.629 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803697).  Saving model ...
Epoch: 76 cost time: 1.3128366470336914
Epoch: 76, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 77 cost time: 1.354341983795166
Epoch: 77, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 78 cost time: 1.2782139778137207
Epoch: 78, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811105).  Saving model ...
Epoch: 79 cost time: 1.2732791900634766
Epoch: 79, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.593 Vali Acc: 0.811 Test Loss: 0.593 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 80 cost time: 1.2252190113067627
Epoch: 80, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 81 cost time: 1.2992568016052246
Epoch: 81, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.579 Vali Acc: 0.811 Test Loss: 0.579 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 82 cost time: 1.330157995223999
Epoch: 82, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
Epoch: 83 cost time: 1.1178622245788574
Epoch: 83, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.564 Vali Acc: 0.815 Test Loss: 0.564 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 84 cost time: 1.2316701412200928
Epoch: 84, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 85 cost time: 1.1304872035980225
Epoch: 85, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 86 cost time: 1.2172105312347412
Epoch: 86, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 87 cost time: 1.2042884826660156
Epoch: 87, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.538 Vali Acc: 0.815 Test Loss: 0.538 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 88 cost time: 1.0380187034606934
Epoch: 88, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.534 Vali Acc: 0.815 Test Loss: 0.534 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 89 cost time: 1.0722072124481201
Epoch: 89, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.530 Vali Acc: 0.815 Test Loss: 0.530 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814810).  Saving model ...
Epoch: 90 cost time: 1.1305532455444336
Epoch: 90, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
Validation loss decreased (-0.814810 --> -0.825921).  Saving model ...
Epoch: 91 cost time: 1.190309762954712
Epoch: 91, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.520 Vali Acc: 0.826 Test Loss: 0.520 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 92 cost time: 1.3262724876403809
Epoch: 92, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 93 cost time: 1.193854570388794
Epoch: 93, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 94 cost time: 1.1621208190917969
Epoch: 94, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
Validation loss decreased (-0.825921 --> -0.825921).  Saving model ...
Epoch: 95 cost time: 1.1691648960113525
Epoch: 95, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.499 Vali Acc: 0.830 Test Loss: 0.499 Test Acc: 0.830
Validation loss decreased (-0.825921 --> -0.829625).  Saving model ...
Epoch: 96 cost time: 1.1513018608093262
Epoch: 96, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.495 Vali Acc: 0.830 Test Loss: 0.495 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 97 cost time: 1.1305603981018066
Epoch: 97, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.489 Vali Acc: 0.830 Test Loss: 0.489 Test Acc: 0.830
Validation loss decreased (-0.829625 --> -0.829625).  Saving model ...
Epoch: 98 cost time: 1.1271915435791016
Epoch: 98, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
Validation loss decreased (-0.829625 --> -0.833328).  Saving model ...
Epoch: 99 cost time: 1.1589555740356445
Epoch: 99, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 100 cost time: 1.069946050643921
Epoch: 100, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7148284912109375
Epoch: 1, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.827 Vali Acc: 0.130 Test Loss: 1.827 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 1.08030104637146
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.823 Vali Acc: 0.130 Test Loss: 1.823 Test Acc: 0.130
Validation loss decreased (-0.129611 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 1.0618205070495605
Epoch: 3, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.819 Vali Acc: 0.130 Test Loss: 1.819 Test Acc: 0.130
Validation loss decreased (-0.129611 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 1.002837896347046
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.814 Vali Acc: 0.130 Test Loss: 1.814 Test Acc: 0.130
Validation loss decreased (-0.129611 --> -0.129611).  Saving model ...
Epoch: 5 cost time: 0.9717550277709961
Epoch: 5, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.807 Vali Acc: 0.144 Test Loss: 1.807 Test Acc: 0.144
Validation loss decreased (-0.129611 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 1.0353813171386719
Epoch: 6, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.799 Vali Acc: 0.152 Test Loss: 1.799 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151834).  Saving model ...
Epoch: 7 cost time: 1.2132437229156494
Epoch: 7, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.790 Vali Acc: 0.163 Test Loss: 1.790 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 8 cost time: 1.1666440963745117
Epoch: 8, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.780 Vali Acc: 0.174 Test Loss: 1.780 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174056).  Saving model ...
Epoch: 9 cost time: 1.1332061290740967
Epoch: 9, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.769 Vali Acc: 0.181 Test Loss: 1.769 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 10 cost time: 0.9082424640655518
Epoch: 10, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.757 Vali Acc: 0.185 Test Loss: 1.757 Test Acc: 0.185
Validation loss decreased (-0.181464 --> -0.185168).  Saving model ...
Epoch: 11 cost time: 1.3168690204620361
Epoch: 11, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.745 Vali Acc: 0.193 Test Loss: 1.745 Test Acc: 0.193
Validation loss decreased (-0.185168 --> -0.192575).  Saving model ...
Epoch: 12 cost time: 1.0595026016235352
Epoch: 12, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.732 Vali Acc: 0.219 Test Loss: 1.732 Test Acc: 0.219
Validation loss decreased (-0.192575 --> -0.218501).  Saving model ...
Epoch: 13 cost time: 0.9531126022338867
Epoch: 13, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.718 Vali Acc: 0.226 Test Loss: 1.718 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225909).  Saving model ...
Epoch: 14 cost time: 1.195065975189209
Epoch: 14, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.704 Vali Acc: 0.237 Test Loss: 1.704 Test Acc: 0.237
Validation loss decreased (-0.225909 --> -0.237020).  Saving model ...
Epoch: 15 cost time: 1.138235092163086
Epoch: 15, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.688 Vali Acc: 0.263 Test Loss: 1.688 Test Acc: 0.263
Validation loss decreased (-0.237020 --> -0.262946).  Saving model ...
Epoch: 16 cost time: 1.1777913570404053
Epoch: 16, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.673 Vali Acc: 0.270 Test Loss: 1.673 Test Acc: 0.270
Validation loss decreased (-0.262946 --> -0.270354).  Saving model ...
Epoch: 17 cost time: 1.0501689910888672
Epoch: 17, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.656 Vali Acc: 0.293 Test Loss: 1.656 Test Acc: 0.293
Validation loss decreased (-0.270354 --> -0.292576).  Saving model ...
Epoch: 18 cost time: 1.026353359222412
Epoch: 18, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.639 Vali Acc: 0.319 Test Loss: 1.639 Test Acc: 0.319
Validation loss decreased (-0.292576 --> -0.318502).  Saving model ...
Epoch: 19 cost time: 1.0431616306304932
Epoch: 19, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.621 Vali Acc: 0.363 Test Loss: 1.621 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 20 cost time: 1.1639554500579834
Epoch: 20, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.602 Vali Acc: 0.385 Test Loss: 1.602 Test Acc: 0.385
Validation loss decreased (-0.362947 --> -0.385169).  Saving model ...
Epoch: 21 cost time: 1.1127536296844482
Epoch: 21, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.584 Vali Acc: 0.396 Test Loss: 1.584 Test Acc: 0.396
Validation loss decreased (-0.385169 --> -0.396280).  Saving model ...
Epoch: 22 cost time: 1.1035919189453125
Epoch: 22, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.566 Vali Acc: 0.441 Test Loss: 1.566 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 23 cost time: 1.0107572078704834
Epoch: 23, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.547 Vali Acc: 0.470 Test Loss: 1.547 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 24 cost time: 1.1455731391906738
Epoch: 24, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.527 Vali Acc: 0.474 Test Loss: 1.527 Test Acc: 0.474
Validation loss decreased (-0.470355 --> -0.474059).  Saving model ...
Epoch: 25 cost time: 1.0985939502716064
Epoch: 25, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.508 Vali Acc: 0.504 Test Loss: 1.508 Test Acc: 0.504
Validation loss decreased (-0.474059 --> -0.503689).  Saving model ...
Epoch: 26 cost time: 1.023289680480957
Epoch: 26, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.489 Vali Acc: 0.526 Test Loss: 1.489 Test Acc: 0.526
Validation loss decreased (-0.503689 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 1.0780184268951416
Epoch: 27, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.469 Vali Acc: 0.541 Test Loss: 1.469 Test Acc: 0.541
Validation loss decreased (-0.525911 --> -0.540726).  Saving model ...
Epoch: 28 cost time: 1.0417892932891846
Epoch: 28, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.449 Vali Acc: 0.578 Test Loss: 1.449 Test Acc: 0.578
Validation loss decreased (-0.540726 --> -0.577763).  Saving model ...
Epoch: 29 cost time: 1.1970973014831543
Epoch: 29, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.428 Vali Acc: 0.589 Test Loss: 1.428 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 30 cost time: 1.145111322402954
Epoch: 30, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.406 Vali Acc: 0.596 Test Loss: 1.406 Test Acc: 0.596
Validation loss decreased (-0.588875 --> -0.596282).  Saving model ...
Epoch: 31 cost time: 1.0641372203826904
Epoch: 31, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.384 Vali Acc: 0.607 Test Loss: 1.384 Test Acc: 0.607
Validation loss decreased (-0.596282 --> -0.607394).  Saving model ...
Epoch: 32 cost time: 1.1565065383911133
Epoch: 32, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.362 Vali Acc: 0.626 Test Loss: 1.362 Test Acc: 0.626
Validation loss decreased (-0.607394 --> -0.625912).  Saving model ...
Epoch: 33 cost time: 1.0876030921936035
Epoch: 33, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
Validation loss decreased (-0.625912 --> -0.644431).  Saving model ...
Epoch: 34 cost time: 1.1771008968353271
Epoch: 34, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.317 Vali Acc: 0.670 Test Loss: 1.317 Test Acc: 0.670
Validation loss decreased (-0.644431 --> -0.670357).  Saving model ...
Epoch: 35 cost time: 1.0641565322875977
Epoch: 35, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.293 Vali Acc: 0.685 Test Loss: 1.293 Test Acc: 0.685
Validation loss decreased (-0.670357 --> -0.685172).  Saving model ...
Epoch: 36 cost time: 1.2550437450408936
Epoch: 36, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.269 Vali Acc: 0.689 Test Loss: 1.269 Test Acc: 0.689
Validation loss decreased (-0.685172 --> -0.688876).  Saving model ...
Epoch: 37 cost time: 1.105201244354248
Epoch: 37, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.245 Vali Acc: 0.693 Test Loss: 1.245 Test Acc: 0.693
Validation loss decreased (-0.688876 --> -0.692580).  Saving model ...
Epoch: 38 cost time: 1.1790473461151123
Epoch: 38, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.220 Vali Acc: 0.707 Test Loss: 1.220 Test Acc: 0.707
Validation loss decreased (-0.692580 --> -0.707395).  Saving model ...
Epoch: 39 cost time: 1.078352928161621
Epoch: 39, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718507).  Saving model ...
Epoch: 40 cost time: 1.0623772144317627
Epoch: 40, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.171 Vali Acc: 0.719 Test Loss: 1.171 Test Acc: 0.719
Validation loss decreased (-0.718507 --> -0.718507).  Saving model ...
Epoch: 41 cost time: 1.2058568000793457
Epoch: 41, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.145 Vali Acc: 0.726 Test Loss: 1.145 Test Acc: 0.726
Validation loss decreased (-0.718507 --> -0.725914).  Saving model ...
Epoch: 42 cost time: 1.228708028793335
Epoch: 42, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.120 Vali Acc: 0.730 Test Loss: 1.120 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 43 cost time: 1.1013848781585693
Epoch: 43, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.094 Vali Acc: 0.737 Test Loss: 1.094 Test Acc: 0.737
Validation loss decreased (-0.729618 --> -0.737026).  Saving model ...
Epoch: 44 cost time: 1.0805649757385254
Epoch: 44, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.067 Vali Acc: 0.748 Test Loss: 1.067 Test Acc: 0.748
Validation loss decreased (-0.737026 --> -0.748137).  Saving model ...
Epoch: 45 cost time: 1.0866057872772217
Epoch: 45, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
Validation loss decreased (-0.748137 --> -0.755545).  Saving model ...
Epoch: 46 cost time: 1.177117109298706
Epoch: 46, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.013 Vali Acc: 0.785 Test Loss: 1.013 Test Acc: 0.785
Validation loss decreased (-0.755545 --> -0.785175).  Saving model ...
Epoch: 47 cost time: 1.0882139205932617
Epoch: 47, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.985 Vali Acc: 0.789 Test Loss: 0.985 Test Acc: 0.789
Validation loss decreased (-0.785175 --> -0.788879).  Saving model ...
Epoch: 48 cost time: 0.966782808303833
Epoch: 48, Steps: 2 | Train Loss: 1.020 Vali Loss: 0.958 Vali Acc: 0.804 Test Loss: 0.958 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 49 cost time: 1.124551773071289
Epoch: 49, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.930 Vali Acc: 0.811 Test Loss: 0.930 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811102).  Saving model ...
Epoch: 50 cost time: 1.053746223449707
Epoch: 50, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.902 Vali Acc: 0.815 Test Loss: 0.902 Test Acc: 0.815
Validation loss decreased (-0.811102 --> -0.814806).  Saving model ...
Epoch: 51 cost time: 1.0610361099243164
Epoch: 51, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
Validation loss decreased (-0.814806 --> -0.818510).  Saving model ...
Epoch: 52 cost time: 1.0219852924346924
Epoch: 52, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.818510 --> -0.833325).  Saving model ...
Epoch: 53 cost time: 1.0028858184814453
Epoch: 53, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.815 Vali Acc: 0.837 Test Loss: 0.815 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 54 cost time: 1.0536854267120361
Epoch: 54, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.786 Vali Acc: 0.852 Test Loss: 0.786 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 55 cost time: 1.0764617919921875
Epoch: 55, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.757 Vali Acc: 0.856 Test Loss: 0.757 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855548).  Saving model ...
Epoch: 56 cost time: 1.1705329418182373
Epoch: 56, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 57 cost time: 1.1802284717559814
Epoch: 57, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855549).  Saving model ...
Epoch: 58 cost time: 1.1578407287597656
Epoch: 58, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.674 Vali Acc: 0.863 Test Loss: 0.674 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862956).  Saving model ...
Epoch: 59 cost time: 1.1786162853240967
Epoch: 59, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 60 cost time: 1.2784271240234375
Epoch: 60, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.622 Vali Acc: 0.874 Test Loss: 0.622 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 61 cost time: 1.2778692245483398
Epoch: 61, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.597 Vali Acc: 0.870 Test Loss: 0.597 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2335691452026367
Epoch: 62, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.573 Vali Acc: 0.870 Test Loss: 0.573 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1209449768066406
Epoch: 63, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0442523956298828
Epoch: 64, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 65 cost time: 1.0393939018249512
Epoch: 65, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.508 Vali Acc: 0.881 Test Loss: 0.508 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 66 cost time: 1.0092167854309082
Epoch: 66, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 1.0056183338165283
Epoch: 67, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.470 Vali Acc: 0.893 Test Loss: 0.470 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 68 cost time: 1.1681878566741943
Epoch: 68, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.453 Vali Acc: 0.893 Test Loss: 0.453 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 69 cost time: 1.1375432014465332
Epoch: 69, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.437 Vali Acc: 0.885 Test Loss: 0.437 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.028351068496704
Epoch: 70, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.422 Vali Acc: 0.885 Test Loss: 0.422 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.240849494934082
Epoch: 71, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.2198855876922607
Epoch: 72, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.1445724964141846
Epoch: 73, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.2061383724212646
Epoch: 74, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.2075412273406982
Epoch: 75, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.365 Vali Acc: 0.881 Test Loss: 0.365 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.3016149997711182
Epoch: 76, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.356 Vali Acc: 0.881 Test Loss: 0.356 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.1736156940460205
Epoch: 77, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.348 Vali Acc: 0.881 Test Loss: 0.348 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.1717448234558105
Epoch: 78, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.338 Vali Acc: 0.885 Test Loss: 0.338 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.016537666320801
Epoch: 1, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.854 Vali Acc: 0.163 Test Loss: 1.854 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 1.3501884937286377
Epoch: 2, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.850 Vali Acc: 0.159 Test Loss: 1.850 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2194230556488037
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.846 Vali Acc: 0.163 Test Loss: 1.846 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 1.3599345684051514
Epoch: 4, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.841 Vali Acc: 0.170 Test Loss: 1.841 Test Acc: 0.170
Validation loss decreased (-0.162944 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 1.3658733367919922
Epoch: 5, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.834 Vali Acc: 0.185 Test Loss: 1.834 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 1.1531236171722412
Epoch: 6, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.826 Vali Acc: 0.193 Test Loss: 1.826 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 7 cost time: 1.3233628273010254
Epoch: 7, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.816 Vali Acc: 0.196 Test Loss: 1.816 Test Acc: 0.196
Validation loss decreased (-0.192574 --> -0.196278).  Saving model ...
Epoch: 8 cost time: 1.2092843055725098
Epoch: 8, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.805 Vali Acc: 0.207 Test Loss: 1.805 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 9 cost time: 1.2573630809783936
Epoch: 9, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.793 Vali Acc: 0.233 Test Loss: 1.793 Test Acc: 0.233
Validation loss decreased (-0.207389 --> -0.233315).  Saving model ...
Epoch: 10 cost time: 1.0365333557128906
Epoch: 10, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.780 Vali Acc: 0.241 Test Loss: 1.780 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 11 cost time: 1.1641407012939453
Epoch: 11, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.766 Vali Acc: 0.267 Test Loss: 1.766 Test Acc: 0.267
Validation loss decreased (-0.240723 --> -0.266649).  Saving model ...
Epoch: 12 cost time: 1.1116573810577393
Epoch: 12, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.751 Vali Acc: 0.285 Test Loss: 1.751 Test Acc: 0.285
Validation loss decreased (-0.266649 --> -0.285168).  Saving model ...
Epoch: 13 cost time: 1.0022666454315186
Epoch: 13, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.736 Vali Acc: 0.311 Test Loss: 1.736 Test Acc: 0.311
Validation loss decreased (-0.285168 --> -0.311094).  Saving model ...
Epoch: 14 cost time: 1.123429298400879
Epoch: 14, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.719 Vali Acc: 0.333 Test Loss: 1.719 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 15 cost time: 1.322864055633545
Epoch: 15, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.702 Vali Acc: 0.356 Test Loss: 1.702 Test Acc: 0.356
Validation loss decreased (-0.333316 --> -0.355539).  Saving model ...
Epoch: 16 cost time: 1.2580652236938477
Epoch: 16, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.684 Vali Acc: 0.378 Test Loss: 1.684 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377761).  Saving model ...
Epoch: 17 cost time: 1.2341625690460205
Epoch: 17, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.665 Vali Acc: 0.381 Test Loss: 1.665 Test Acc: 0.381
Validation loss decreased (-0.377761 --> -0.381465).  Saving model ...
Epoch: 18 cost time: 1.4426889419555664
Epoch: 18, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.646 Vali Acc: 0.404 Test Loss: 1.646 Test Acc: 0.404
Validation loss decreased (-0.381465 --> -0.403687).  Saving model ...
Epoch: 19 cost time: 1.233036756515503
Epoch: 19, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.627 Vali Acc: 0.415 Test Loss: 1.627 Test Acc: 0.415
Validation loss decreased (-0.403687 --> -0.414799).  Saving model ...
Epoch: 20 cost time: 1.2659494876861572
Epoch: 20, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.607 Vali Acc: 0.437 Test Loss: 1.607 Test Acc: 0.437
Validation loss decreased (-0.414799 --> -0.437021).  Saving model ...
Epoch: 21 cost time: 1.320861577987671
Epoch: 21, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.587 Vali Acc: 0.448 Test Loss: 1.587 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448132).  Saving model ...
Epoch: 22 cost time: 1.0386848449707031
Epoch: 22, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.566 Vali Acc: 0.478 Test Loss: 1.566 Test Acc: 0.478
Validation loss decreased (-0.448132 --> -0.477762).  Saving model ...
Epoch: 23 cost time: 1.126485824584961
Epoch: 23, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.545 Vali Acc: 0.489 Test Loss: 1.545 Test Acc: 0.489
Validation loss decreased (-0.477762 --> -0.488873).  Saving model ...
Epoch: 24 cost time: 1.244924545288086
Epoch: 24, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.524 Vali Acc: 0.500 Test Loss: 1.524 Test Acc: 0.500
Validation loss decreased (-0.488873 --> -0.499985).  Saving model ...
Epoch: 25 cost time: 1.2491047382354736
Epoch: 25, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.502 Vali Acc: 0.515 Test Loss: 1.502 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 26 cost time: 1.3265535831451416
Epoch: 26, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.480 Vali Acc: 0.515 Test Loss: 1.480 Test Acc: 0.515
Validation loss decreased (-0.514800 --> -0.514800).  Saving model ...
Epoch: 27 cost time: 1.2167706489562988
Epoch: 27, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.458 Vali Acc: 0.522 Test Loss: 1.458 Test Acc: 0.522
Validation loss decreased (-0.514800 --> -0.522208).  Saving model ...
Epoch: 28 cost time: 1.3283257484436035
Epoch: 28, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.435 Vali Acc: 0.533 Test Loss: 1.435 Test Acc: 0.533
Validation loss decreased (-0.522208 --> -0.533319).  Saving model ...
Epoch: 29 cost time: 1.25333571434021
Epoch: 29, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.411 Vali Acc: 0.548 Test Loss: 1.411 Test Acc: 0.548
Validation loss decreased (-0.533319 --> -0.548134).  Saving model ...
Epoch: 30 cost time: 1.0904064178466797
Epoch: 30, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.388 Vali Acc: 0.556 Test Loss: 1.388 Test Acc: 0.556
Validation loss decreased (-0.548134 --> -0.555542).  Saving model ...
Epoch: 31 cost time: 1.3256044387817383
Epoch: 31, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.364 Vali Acc: 0.570 Test Loss: 1.364 Test Acc: 0.570
Validation loss decreased (-0.555542 --> -0.570357).  Saving model ...
Epoch: 32 cost time: 1.1891071796417236
Epoch: 32, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.340 Vali Acc: 0.581 Test Loss: 1.340 Test Acc: 0.581
Validation loss decreased (-0.570357 --> -0.581468).  Saving model ...
Epoch: 33 cost time: 1.180572509765625
Epoch: 33, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.316 Vali Acc: 0.607 Test Loss: 1.316 Test Acc: 0.607
Validation loss decreased (-0.581468 --> -0.607394).  Saving model ...
Epoch: 34 cost time: 1.2994210720062256
Epoch: 34, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.292 Vali Acc: 0.619 Test Loss: 1.292 Test Acc: 0.619
Validation loss decreased (-0.607394 --> -0.618506).  Saving model ...
Epoch: 35 cost time: 1.2836499214172363
Epoch: 35, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.267 Vali Acc: 0.633 Test Loss: 1.267 Test Acc: 0.633
Validation loss decreased (-0.618506 --> -0.633321).  Saving model ...
Epoch: 36 cost time: 1.347790241241455
Epoch: 36, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.242 Vali Acc: 0.641 Test Loss: 1.242 Test Acc: 0.641
Validation loss decreased (-0.633321 --> -0.640728).  Saving model ...
Epoch: 37 cost time: 1.234710931777954
Epoch: 37, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.216 Vali Acc: 0.667 Test Loss: 1.216 Test Acc: 0.667
Validation loss decreased (-0.640728 --> -0.666655).  Saving model ...
Epoch: 38 cost time: 1.027311086654663
Epoch: 38, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.189 Vali Acc: 0.678 Test Loss: 1.189 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 39 cost time: 1.1572601795196533
Epoch: 39, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.162 Vali Acc: 0.696 Test Loss: 1.162 Test Acc: 0.696
Validation loss decreased (-0.677766 --> -0.696285).  Saving model ...
Epoch: 40 cost time: 1.2552721500396729
Epoch: 40, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.135 Vali Acc: 0.696 Test Loss: 1.135 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 41 cost time: 1.4522068500518799
Epoch: 41, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.107 Vali Acc: 0.689 Test Loss: 1.107 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4420547485351562
Epoch: 42, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.079 Vali Acc: 0.700 Test Loss: 1.079 Test Acc: 0.700
Validation loss decreased (-0.696285 --> -0.699989).  Saving model ...
Epoch: 43 cost time: 1.34610915184021
Epoch: 43, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.051 Vali Acc: 0.715 Test Loss: 1.051 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714804).  Saving model ...
Epoch: 44 cost time: 1.431443214416504
Epoch: 44, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.022 Vali Acc: 0.726 Test Loss: 1.022 Test Acc: 0.726
Validation loss decreased (-0.714804 --> -0.725916).  Saving model ...
Epoch: 45 cost time: 1.2500412464141846
Epoch: 45, Steps: 2 | Train Loss: 1.084 Vali Loss: 0.993 Vali Acc: 0.741 Test Loss: 0.993 Test Acc: 0.741
Validation loss decreased (-0.725916 --> -0.740731).  Saving model ...
Epoch: 46 cost time: 1.2153184413909912
Epoch: 46, Steps: 2 | Train Loss: 1.053 Vali Loss: 0.964 Vali Acc: 0.756 Test Loss: 0.964 Test Acc: 0.756
Validation loss decreased (-0.740731 --> -0.755546).  Saving model ...
Epoch: 47 cost time: 1.151453971862793
Epoch: 47, Steps: 2 | Train Loss: 1.012 Vali Loss: 0.935 Vali Acc: 0.774 Test Loss: 0.935 Test Acc: 0.774
Validation loss decreased (-0.755546 --> -0.774065).  Saving model ...
Epoch: 48 cost time: 1.0705366134643555
Epoch: 48, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.907 Vali Acc: 0.781 Test Loss: 0.907 Test Acc: 0.781
Validation loss decreased (-0.774065 --> -0.781472).  Saving model ...
Epoch: 49 cost time: 1.443601131439209
Epoch: 49, Steps: 2 | Train Loss: 1.017 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.781472 --> -0.799991).  Saving model ...
Epoch: 50 cost time: 1.3198537826538086
Epoch: 50, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.849 Vali Acc: 0.804 Test Loss: 0.849 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 51 cost time: 1.328813076019287
Epoch: 51, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.820 Vali Acc: 0.822 Test Loss: 0.820 Test Acc: 0.822
Validation loss decreased (-0.803695 --> -0.822214).  Saving model ...
Epoch: 52 cost time: 1.3795442581176758
Epoch: 52, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.790 Vali Acc: 0.826 Test Loss: 0.790 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 53 cost time: 1.2400016784667969
Epoch: 53, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833326).  Saving model ...
Epoch: 54 cost time: 1.256011724472046
Epoch: 54, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.734 Vali Acc: 0.841 Test Loss: 0.734 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840733).  Saving model ...
Epoch: 55 cost time: 1.1500179767608643
Epoch: 55, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3096435070037842
Epoch: 56, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.681 Vali Acc: 0.837 Test Loss: 0.681 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0562176704406738
Epoch: 57, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.656 Vali Acc: 0.837 Test Loss: 0.656 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1008222103118896
Epoch: 58, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840734).  Saving model ...
Epoch: 59 cost time: 1.1845598220825195
Epoch: 59, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1806092262268066
Epoch: 60, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.589 Vali Acc: 0.837 Test Loss: 0.589 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.2364225387573242
Epoch: 61, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.567 Vali Acc: 0.830 Test Loss: 0.567 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1753339767456055
Epoch: 62, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.546 Vali Acc: 0.837 Test Loss: 0.546 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3142964839935303
Epoch: 63, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.1041209697723389
Epoch: 64, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840736).  Saving model ...
Epoch: 65 cost time: 1.2139711380004883
Epoch: 65, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 66 cost time: 1.163226842880249
Epoch: 66, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
Validation loss decreased (-0.844440 --> -0.862958).  Saving model ...
Epoch: 67 cost time: 1.1766107082366943
Epoch: 67, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 68 cost time: 1.3312504291534424
Epoch: 68, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 69 cost time: 1.2915375232696533
Epoch: 69, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0910027027130127
Epoch: 70, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.411 Vali Acc: 0.874 Test Loss: 0.411 Test Acc: 0.874
Validation loss decreased (-0.866662 --> -0.874070).  Saving model ...
Epoch: 71 cost time: 1.1219003200531006
Epoch: 71, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.398 Vali Acc: 0.881 Test Loss: 0.398 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881478).  Saving model ...
Epoch: 72 cost time: 1.215172290802002
Epoch: 72, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.386 Vali Acc: 0.881 Test Loss: 0.386 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 73 cost time: 1.1805827617645264
Epoch: 73, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 74 cost time: 1.1267614364624023
Epoch: 74, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888885).  Saving model ...
Epoch: 75 cost time: 1.1836943626403809
Epoch: 75, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.355 Vali Acc: 0.904 Test Loss: 0.355 Test Acc: 0.904
Validation loss decreased (-0.888885 --> -0.903700).  Saving model ...
Epoch: 76 cost time: 1.0984916687011719
Epoch: 76, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.348 Vali Acc: 0.904 Test Loss: 0.348 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 77 cost time: 1.134415864944458
Epoch: 77, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.343 Vali Acc: 0.904 Test Loss: 0.343 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 78 cost time: 1.1789109706878662
Epoch: 78, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.340 Vali Acc: 0.896 Test Loss: 0.340 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2615199089050293
Epoch: 79, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.337 Vali Acc: 0.896 Test Loss: 0.337 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2282369136810303
Epoch: 80, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.334 Vali Acc: 0.896 Test Loss: 0.334 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.1085047721862793
Epoch: 81, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.330 Vali Acc: 0.896 Test Loss: 0.330 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.1062510013580322
Epoch: 82, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.0597693920135498
Epoch: 83, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 84 cost time: 1.1365077495574951
Epoch: 84, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 85 cost time: 1.2255096435546875
Epoch: 85, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 86 cost time: 1.2442781925201416
Epoch: 86, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 87 cost time: 1.1640734672546387
Epoch: 87, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 88 cost time: 1.1543762683868408
Epoch: 88, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.2139878273010254
Epoch: 89, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.233459234237671
Epoch: 90, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 91 cost time: 1.1357200145721436
Epoch: 91, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 92 cost time: 1.2510771751403809
Epoch: 92, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 93 cost time: 1.312504529953003
Epoch: 93, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1271812915802002
Epoch: 94, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.247976541519165
Epoch: 95, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 96 cost time: 1.1259055137634277
Epoch: 96, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 97 cost time: 1.3069381713867188
Epoch: 97, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 98 cost time: 1.242021083831787
Epoch: 98, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.2297940254211426
Epoch: 99, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.3380343914031982
Epoch: 100, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.632049560546875
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1822566986083984
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1603591442108154
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0740630626678467
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.147726058959961
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.1164038181304932
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 1.233184814453125
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.3321025371551514
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 1.2087352275848389
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.191192388534546
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1547014713287354
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1342947483062744
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.304414987564087
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 14 cost time: 1.382129192352295
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.0867326259613037
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3319463729858398
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.2071137428283691
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.2697432041168213
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.362870693206787
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.450838327407837
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.159386157989502
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.153167724609375
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 23 cost time: 1.2121407985687256
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 24 cost time: 0.9987373352050781
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 25 cost time: 0.9849765300750732
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.2171976566314697
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.0972249507904053
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 28 cost time: 1.0898666381835938
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.309617280960083
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.1052677631378174
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.295243501663208
Epoch: 31, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.1020984649658203
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.162410020828247
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.1143012046813965
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.2063548564910889
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.3179564476013184
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.2181658744812012
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.0805296897888184
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 39 cost time: 1.1266765594482422
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 40 cost time: 1.1047933101654053
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 41 cost time: 1.0943031311035156
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.2853009700775146
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 43 cost time: 1.0548934936523438
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 44 cost time: 1.3399174213409424
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 45 cost time: 1.0654881000518799
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.09629487991333
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.2655043601989746
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1865289211273193
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 49 cost time: 0.9585120677947998
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.2647778987884521
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 51 cost time: 0.9328100681304932
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.14359712600708
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 53 cost time: 1.0515422821044922
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.1928462982177734
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1720542907714844
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 56 cost time: 1.2014844417572021
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.34075927734375
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 58 cost time: 1.1343159675598145
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.444267988204956
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.287003755569458
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 61 cost time: 1.2058780193328857
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 62 cost time: 1.3803277015686035
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 63 cost time: 1.2662913799285889
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 64 cost time: 1.3048937320709229
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 65 cost time: 1.27587890625
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.2488675117492676
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.316443920135498
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.2341642379760742
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 69 cost time: 1.0519330501556396
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.1169509887695312
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.1364250183105469
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 72 cost time: 0.9749791622161865
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.2574174404144287
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.2253448963165283
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.3761160373687744
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.1221139430999756
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.309572696685791
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.2781617641448975
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.251960277557373
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.255418300628662
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.1299097537994385
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.1613099575042725
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.0317919254302979
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.074880838394165
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.4624955654144287
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 86 cost time: 1.3032584190368652
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.3326594829559326
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.3021564483642578
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 89 cost time: 1.1413171291351318
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.1017343997955322
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.2879748344421387
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 92 cost time: 1.0339875221252441
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 93 cost time: 1.1733670234680176
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.224109172821045
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 95 cost time: 1.0340266227722168
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 96 cost time: 1.2156610488891602
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 97 cost time: 1.1350653171539307
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 98 cost time: 1.2036497592926025
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 99 cost time: 1.2590079307556152
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 100 cost time: 1.2176039218902588
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 96358
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0678398609161377
Epoch: 1, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1658318042755127
Epoch: 2, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.781 Vali Acc: 0.178 Test Loss: 1.781 Test Acc: 0.178
Validation loss decreased (-0.166649 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.9216775894165039
Epoch: 3, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.767 Vali Acc: 0.185 Test Loss: 1.767 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185168).  Saving model ...
Epoch: 4 cost time: 0.9737906455993652
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.752 Vali Acc: 0.196 Test Loss: 1.752 Test Acc: 0.196
Validation loss decreased (-0.185168 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 1.111929178237915
Epoch: 5, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.733 Vali Acc: 0.207 Test Loss: 1.733 Test Acc: 0.207
Validation loss decreased (-0.196279 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 1.0247695446014404
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.711 Vali Acc: 0.256 Test Loss: 1.711 Test Acc: 0.256
Validation loss decreased (-0.207390 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 1.0703022480010986
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.686 Vali Acc: 0.300 Test Loss: 1.686 Test Acc: 0.300
Validation loss decreased (-0.255538 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 1.0419044494628906
Epoch: 8, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.658 Vali Acc: 0.359 Test Loss: 1.658 Test Acc: 0.359
Validation loss decreased (-0.299983 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 1.0816354751586914
Epoch: 9, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.628 Vali Acc: 0.400 Test Loss: 1.628 Test Acc: 0.400
Validation loss decreased (-0.359243 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 1.1035435199737549
Epoch: 10, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.597 Vali Acc: 0.441 Test Loss: 1.597 Test Acc: 0.441
Validation loss decreased (-0.399984 --> -0.440725).  Saving model ...
Epoch: 11 cost time: 1.0919575691223145
Epoch: 11, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.563 Vali Acc: 0.478 Test Loss: 1.563 Test Acc: 0.478
Validation loss decreased (-0.440725 --> -0.477762).  Saving model ...
Epoch: 12 cost time: 1.0130069255828857
Epoch: 12, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.529 Vali Acc: 0.507 Test Loss: 1.529 Test Acc: 0.507
Validation loss decreased (-0.477762 --> -0.507392).  Saving model ...
Epoch: 13 cost time: 1.1396734714508057
Epoch: 13, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.494 Vali Acc: 0.530 Test Loss: 1.494 Test Acc: 0.530
Validation loss decreased (-0.507392 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 1.1588244438171387
Epoch: 14, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.458 Vali Acc: 0.556 Test Loss: 1.458 Test Acc: 0.556
Validation loss decreased (-0.529615 --> -0.555541).  Saving model ...
Epoch: 15 cost time: 1.155590295791626
Epoch: 15, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.422 Vali Acc: 0.593 Test Loss: 1.422 Test Acc: 0.593
Validation loss decreased (-0.555541 --> -0.592578).  Saving model ...
Epoch: 16 cost time: 1.0692355632781982
Epoch: 16, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.385 Vali Acc: 0.619 Test Loss: 1.385 Test Acc: 0.619
Validation loss decreased (-0.592578 --> -0.618505).  Saving model ...
Epoch: 17 cost time: 1.0390775203704834
Epoch: 17, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.349 Vali Acc: 0.663 Test Loss: 1.349 Test Acc: 0.663
Validation loss decreased (-0.618505 --> -0.662949).  Saving model ...
Epoch: 18 cost time: 1.2612264156341553
Epoch: 18, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.312 Vali Acc: 0.674 Test Loss: 1.312 Test Acc: 0.674
Validation loss decreased (-0.662949 --> -0.674061).  Saving model ...
Epoch: 19 cost time: 0.9918520450592041
Epoch: 19, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.275 Vali Acc: 0.681 Test Loss: 1.275 Test Acc: 0.681
Validation loss decreased (-0.674061 --> -0.681469).  Saving model ...
Epoch: 20 cost time: 1.1062824726104736
Epoch: 20, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.239 Vali Acc: 0.696 Test Loss: 1.239 Test Acc: 0.696
Validation loss decreased (-0.681469 --> -0.696284).  Saving model ...
Epoch: 21 cost time: 1.2066171169281006
Epoch: 21, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.203 Vali Acc: 0.711 Test Loss: 1.203 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 1.173651933670044
Epoch: 22, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.168 Vali Acc: 0.711 Test Loss: 1.168 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711099).  Saving model ...
Epoch: 23 cost time: 1.1232564449310303
Epoch: 23, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.134 Vali Acc: 0.722 Test Loss: 1.134 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722211).  Saving model ...
Epoch: 24 cost time: 1.1485447883605957
Epoch: 24, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.100 Vali Acc: 0.733 Test Loss: 1.100 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733322).  Saving model ...
Epoch: 25 cost time: 1.1701126098632812
Epoch: 25, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.068 Vali Acc: 0.733 Test Loss: 1.068 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733323).  Saving model ...
Epoch: 26 cost time: 1.1302220821380615
Epoch: 26, Steps: 2 | Train Loss: 0.715 Vali Loss: 1.035 Vali Acc: 0.752 Test Loss: 1.035 Test Acc: 0.752
Validation loss decreased (-0.733323 --> -0.751841).  Saving model ...
Epoch: 27 cost time: 1.157782793045044
Epoch: 27, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.005 Vali Acc: 0.756 Test Loss: 1.005 Test Acc: 0.756
Validation loss decreased (-0.751841 --> -0.755546).  Saving model ...
Epoch: 28 cost time: 1.1056311130523682
Epoch: 28, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.976 Vali Acc: 0.759 Test Loss: 0.976 Test Acc: 0.759
Validation loss decreased (-0.755546 --> -0.759249).  Saving model ...
Epoch: 29 cost time: 1.1729583740234375
Epoch: 29, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.948 Vali Acc: 0.774 Test Loss: 0.948 Test Acc: 0.774
Validation loss decreased (-0.759249 --> -0.774065).  Saving model ...
Epoch: 30 cost time: 1.1131343841552734
Epoch: 30, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.921 Vali Acc: 0.781 Test Loss: 0.921 Test Acc: 0.781
Validation loss decreased (-0.774065 --> -0.781472).  Saving model ...
Epoch: 31 cost time: 1.111778974533081
Epoch: 31, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.896 Vali Acc: 0.785 Test Loss: 0.896 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 32 cost time: 1.096196174621582
Epoch: 32, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.871 Vali Acc: 0.781 Test Loss: 0.871 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1352944374084473
Epoch: 33, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.848 Vali Acc: 0.785 Test Loss: 0.848 Test Acc: 0.785
Validation loss decreased (-0.785176 --> -0.785177).  Saving model ...
Epoch: 34 cost time: 1.0345871448516846
Epoch: 34, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.827 Vali Acc: 0.785 Test Loss: 0.827 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785177).  Saving model ...
Epoch: 35 cost time: 1.0767760276794434
Epoch: 35, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.807 Vali Acc: 0.785 Test Loss: 0.807 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785177).  Saving model ...
Epoch: 36 cost time: 1.1136276721954346
Epoch: 36, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.785177 --> -0.788881).  Saving model ...
Epoch: 37 cost time: 1.1944727897644043
Epoch: 37, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.773 Vali Acc: 0.793 Test Loss: 0.773 Test Acc: 0.793
Validation loss decreased (-0.788881 --> -0.792585).  Saving model ...
Epoch: 38 cost time: 1.1584527492523193
Epoch: 38, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.758 Vali Acc: 0.793 Test Loss: 0.758 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792585).  Saving model ...
Epoch: 39 cost time: 1.1912078857421875
Epoch: 39, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.744 Vali Acc: 0.793 Test Loss: 0.744 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792585).  Saving model ...
Epoch: 40 cost time: 1.103926658630371
Epoch: 40, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.731 Vali Acc: 0.793 Test Loss: 0.731 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792585).  Saving model ...
Epoch: 41 cost time: 1.2211804389953613
Epoch: 41, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.719 Vali Acc: 0.793 Test Loss: 0.719 Test Acc: 0.793
Validation loss decreased (-0.792585 --> -0.792585).  Saving model ...
Epoch: 42 cost time: 1.1491997241973877
Epoch: 42, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
Validation loss decreased (-0.792585 --> -0.799993).  Saving model ...
Epoch: 43 cost time: 1.050264835357666
Epoch: 43, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
Validation loss decreased (-0.799993 --> -0.803697).  Saving model ...
Epoch: 44 cost time: 1.1044180393218994
Epoch: 44, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.688 Vali Acc: 0.804 Test Loss: 0.688 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 45 cost time: 1.2041692733764648
Epoch: 45, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.679 Vali Acc: 0.811 Test Loss: 0.679 Test Acc: 0.811
Validation loss decreased (-0.803697 --> -0.811104).  Saving model ...
Epoch: 46 cost time: 1.1090903282165527
Epoch: 46, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.671 Vali Acc: 0.811 Test Loss: 0.671 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 47 cost time: 1.0698802471160889
Epoch: 47, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.663 Vali Acc: 0.815 Test Loss: 0.663 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 48 cost time: 1.043217420578003
Epoch: 48, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 49 cost time: 1.164130449295044
Epoch: 49, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.649 Vali Acc: 0.819 Test Loss: 0.649 Test Acc: 0.819
Validation loss decreased (-0.814808 --> -0.818512).  Saving model ...
Epoch: 50 cost time: 1.0580732822418213
Epoch: 50, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 51 cost time: 1.1306061744689941
Epoch: 51, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 52 cost time: 1.1995000839233398
Epoch: 52, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 53 cost time: 1.1982758045196533
Epoch: 53, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1427485942840576
Epoch: 54, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
Validation loss decreased (-0.818512 --> -0.818512).  Saving model ...
Epoch: 55 cost time: 1.0892128944396973
Epoch: 55, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 56 cost time: 1.225174903869629
Epoch: 56, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 57 cost time: 1.0767462253570557
Epoch: 57, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 58 cost time: 1.0898218154907227
Epoch: 58, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 59 cost time: 1.1983535289764404
Epoch: 59, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 60 cost time: 1.0404083728790283
Epoch: 60, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 61 cost time: 1.0260729789733887
Epoch: 61, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 62 cost time: 1.109450340270996
Epoch: 62, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 63 cost time: 1.1166625022888184
Epoch: 63, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 64 cost time: 1.173433542251587
Epoch: 64, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 65 cost time: 0.959867000579834
Epoch: 65, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 66 cost time: 1.3507297039031982
Epoch: 66, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 67 cost time: 1.1922955513000488
Epoch: 67, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 68 cost time: 1.262704849243164
Epoch: 68, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 69 cost time: 1.0409133434295654
Epoch: 69, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 70 cost time: 1.0458250045776367
Epoch: 70, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 71 cost time: 1.200166940689087
Epoch: 71, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 72 cost time: 1.2787559032440186
Epoch: 72, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 73 cost time: 1.2379121780395508
Epoch: 73, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 74 cost time: 1.3372869491577148
Epoch: 74, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 75 cost time: 1.189276933670044
Epoch: 75, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 76 cost time: 1.312711238861084
Epoch: 76, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 77 cost time: 1.1601831912994385
Epoch: 77, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.564 Vali Acc: 0.826 Test Loss: 0.564 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 78 cost time: 1.1044106483459473
Epoch: 78, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 79 cost time: 1.1225523948669434
Epoch: 79, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 80 cost time: 1.215498447418213
Epoch: 80, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 81 cost time: 1.200106143951416
Epoch: 81, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 82 cost time: 1.2527015209197998
Epoch: 82, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 83 cost time: 1.1498332023620605
Epoch: 83, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.826 Test Loss: 0.555 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 84 cost time: 1.157240390777588
Epoch: 84, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 85 cost time: 1.1025471687316895
Epoch: 85, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 86 cost time: 1.1433074474334717
Epoch: 86, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 87 cost time: 1.0850610733032227
Epoch: 87, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 88 cost time: 1.1179330348968506
Epoch: 88, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 89 cost time: 1.1139483451843262
Epoch: 89, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 90 cost time: 1.0725922584533691
Epoch: 90, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 91 cost time: 1.2122547626495361
Epoch: 91, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
Validation loss decreased (-0.825920 --> -0.825920).  Saving model ...
Epoch: 92 cost time: 1.3011438846588135
Epoch: 92, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.830 Test Loss: 0.544 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 93 cost time: 1.5486931800842285
Epoch: 93, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.543 Vali Acc: 0.830 Test Loss: 0.543 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 94 cost time: 1.2834954261779785
Epoch: 94, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.830 Test Loss: 0.541 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 95 cost time: 1.3105738162994385
Epoch: 95, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.540 Vali Acc: 0.830 Test Loss: 0.540 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 96 cost time: 1.4732365608215332
Epoch: 96, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.539 Vali Acc: 0.830 Test Loss: 0.539 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 97 cost time: 1.4365122318267822
Epoch: 97, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.830 Test Loss: 0.538 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 98 cost time: 1.2552785873413086
Epoch: 98, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.830 Test Loss: 0.536 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 99 cost time: 1.3439617156982422
Epoch: 99, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.535 Vali Acc: 0.830 Test Loss: 0.535 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
Epoch: 100 cost time: 1.301335334777832
Epoch: 100, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.534 Vali Acc: 0.830 Test Loss: 0.534 Test Acc: 0.830
Validation loss decreased (-0.829624 --> -0.829624).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.905132293701172
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.788 Vali Acc: 0.244 Test Loss: 1.788 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.1236586570739746
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.774 Vali Acc: 0.256 Test Loss: 1.774 Test Acc: 0.256
Validation loss decreased (-0.244427 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 1.1450285911560059
Epoch: 3, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.762 Vali Acc: 0.278 Test Loss: 1.762 Test Acc: 0.278
Validation loss decreased (-0.255538 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 1.249328851699829
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.751 Vali Acc: 0.285 Test Loss: 1.751 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 1.0640850067138672
Epoch: 5, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.736 Vali Acc: 0.293 Test Loss: 1.736 Test Acc: 0.293
Validation loss decreased (-0.285168 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 1.0955655574798584
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.719 Vali Acc: 0.293 Test Loss: 1.719 Test Acc: 0.293
Validation loss decreased (-0.292575 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 1.127622365951538
Epoch: 7, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.699 Vali Acc: 0.311 Test Loss: 1.699 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 8 cost time: 1.1305673122406006
Epoch: 8, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.678 Vali Acc: 0.341 Test Loss: 1.678 Test Acc: 0.341
Validation loss decreased (-0.311094 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 1.191354751586914
Epoch: 9, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.655 Vali Acc: 0.370 Test Loss: 1.655 Test Acc: 0.370
Validation loss decreased (-0.340724 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 1.1541893482208252
Epoch: 10, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.630 Vali Acc: 0.400 Test Loss: 1.630 Test Acc: 0.400
Validation loss decreased (-0.370354 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 1.100332260131836
Epoch: 11, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.604 Vali Acc: 0.433 Test Loss: 1.604 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433317).  Saving model ...
Epoch: 12 cost time: 1.2629187107086182
Epoch: 12, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.577 Vali Acc: 0.470 Test Loss: 1.577 Test Acc: 0.470
Validation loss decreased (-0.433317 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 1.145881175994873
Epoch: 13, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.550 Vali Acc: 0.485 Test Loss: 1.550 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 14 cost time: 0.9705073833465576
Epoch: 14, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.522 Vali Acc: 0.500 Test Loss: 1.522 Test Acc: 0.500
Validation loss decreased (-0.485170 --> -0.499985).  Saving model ...
Epoch: 15 cost time: 1.3297159671783447
Epoch: 15, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.494 Vali Acc: 0.533 Test Loss: 1.494 Test Acc: 0.533
Validation loss decreased (-0.499985 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 1.200002908706665
Epoch: 16, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.465 Vali Acc: 0.548 Test Loss: 1.465 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 1.1734485626220703
Epoch: 17, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.437 Vali Acc: 0.574 Test Loss: 1.437 Test Acc: 0.574
Validation loss decreased (-0.548133 --> -0.574060).  Saving model ...
Epoch: 18 cost time: 1.2183024883270264
Epoch: 18, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.407 Vali Acc: 0.600 Test Loss: 1.407 Test Acc: 0.600
Validation loss decreased (-0.574060 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 1.2555313110351562
Epoch: 19, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.378 Vali Acc: 0.611 Test Loss: 1.378 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 1.196876049041748
Epoch: 20, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.349 Vali Acc: 0.626 Test Loss: 1.349 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 21 cost time: 1.2435245513916016
Epoch: 21, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.321 Vali Acc: 0.641 Test Loss: 1.321 Test Acc: 0.641
Validation loss decreased (-0.625912 --> -0.640728).  Saving model ...
Epoch: 22 cost time: 1.252042531967163
Epoch: 22, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.292 Vali Acc: 0.674 Test Loss: 1.292 Test Acc: 0.674
Validation loss decreased (-0.640728 --> -0.674061).  Saving model ...
Epoch: 23 cost time: 1.0993728637695312
Epoch: 23, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.264 Vali Acc: 0.678 Test Loss: 1.264 Test Acc: 0.678
Validation loss decreased (-0.674061 --> -0.677765).  Saving model ...
Epoch: 24 cost time: 1.051537036895752
Epoch: 24, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.236 Vali Acc: 0.681 Test Loss: 1.236 Test Acc: 0.681
Validation loss decreased (-0.677765 --> -0.681469).  Saving model ...
Epoch: 25 cost time: 1.0631773471832275
Epoch: 25, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.209 Vali Acc: 0.685 Test Loss: 1.209 Test Acc: 0.685
Validation loss decreased (-0.681469 --> -0.685173).  Saving model ...
Epoch: 26 cost time: 1.1600215435028076
Epoch: 26, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.182 Vali Acc: 0.681 Test Loss: 1.182 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2093849182128906
Epoch: 27, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.156 Vali Acc: 0.685 Test Loss: 1.156 Test Acc: 0.685
Validation loss decreased (-0.685173 --> -0.685174).  Saving model ...
Epoch: 28 cost time: 1.1866343021392822
Epoch: 28, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.131 Vali Acc: 0.696 Test Loss: 1.131 Test Acc: 0.696
Validation loss decreased (-0.685174 --> -0.696285).  Saving model ...
Epoch: 29 cost time: 1.1791539192199707
Epoch: 29, Steps: 2 | Train Loss: 0.679 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.696285 --> -0.699989).  Saving model ...
Epoch: 30 cost time: 1.0967881679534912
Epoch: 30, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.083 Vali Acc: 0.707 Test Loss: 1.083 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.707397).  Saving model ...
Epoch: 31 cost time: 1.2784111499786377
Epoch: 31, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.060 Vali Acc: 0.715 Test Loss: 1.060 Test Acc: 0.715
Validation loss decreased (-0.707397 --> -0.714804).  Saving model ...
Epoch: 32 cost time: 1.1333246231079102
Epoch: 32, Steps: 2 | Train Loss: 0.624 Vali Loss: 1.037 Vali Acc: 0.722 Test Loss: 1.037 Test Acc: 0.722
Validation loss decreased (-0.714804 --> -0.722212).  Saving model ...
Epoch: 33 cost time: 1.238966464996338
Epoch: 33, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.015 Vali Acc: 0.726 Test Loss: 1.015 Test Acc: 0.726
Validation loss decreased (-0.722212 --> -0.725916).  Saving model ...
Epoch: 34 cost time: 1.265918254852295
Epoch: 34, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.995 Vali Acc: 0.726 Test Loss: 0.995 Test Acc: 0.726
Validation loss decreased (-0.725916 --> -0.725916).  Saving model ...
Epoch: 35 cost time: 1.0662004947662354
Epoch: 35, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
Validation loss decreased (-0.725916 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 1.1847240924835205
Epoch: 36, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
Validation loss decreased (-0.733324 --> -0.737027).  Saving model ...
Epoch: 37 cost time: 1.3744494915008545
Epoch: 37, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.939 Vali Acc: 0.737 Test Loss: 0.939 Test Acc: 0.737
Validation loss decreased (-0.737027 --> -0.737028).  Saving model ...
Epoch: 38 cost time: 1.2581956386566162
Epoch: 38, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.922 Vali Acc: 0.741 Test Loss: 0.922 Test Acc: 0.741
Validation loss decreased (-0.737028 --> -0.740732).  Saving model ...
Epoch: 39 cost time: 1.2255935668945312
Epoch: 39, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.906 Vali Acc: 0.744 Test Loss: 0.906 Test Acc: 0.744
Validation loss decreased (-0.740732 --> -0.744435).  Saving model ...
Epoch: 40 cost time: 1.3264806270599365
Epoch: 40, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744436).  Saving model ...
Epoch: 41 cost time: 1.1677017211914062
Epoch: 41, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.877 Vali Acc: 0.752 Test Loss: 0.877 Test Acc: 0.752
Validation loss decreased (-0.744436 --> -0.751843).  Saving model ...
Epoch: 42 cost time: 1.227102279663086
Epoch: 42, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.864 Vali Acc: 0.752 Test Loss: 0.864 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751843).  Saving model ...
Epoch: 43 cost time: 1.2864761352539062
Epoch: 43, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.852 Vali Acc: 0.756 Test Loss: 0.852 Test Acc: 0.756
Validation loss decreased (-0.751843 --> -0.755547).  Saving model ...
Epoch: 44 cost time: 1.1792054176330566
Epoch: 44, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.840 Vali Acc: 0.756 Test Loss: 0.840 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 45 cost time: 1.244135856628418
Epoch: 45, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.828 Vali Acc: 0.759 Test Loss: 0.828 Test Acc: 0.759
Validation loss decreased (-0.755547 --> -0.759251).  Saving model ...
Epoch: 46 cost time: 1.25740385055542
Epoch: 46, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.817 Vali Acc: 0.759 Test Loss: 0.817 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759251).  Saving model ...
Epoch: 47 cost time: 1.2609524726867676
Epoch: 47, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.807 Vali Acc: 0.763 Test Loss: 0.807 Test Acc: 0.763
Validation loss decreased (-0.759251 --> -0.762955).  Saving model ...
Epoch: 48 cost time: 1.1119623184204102
Epoch: 48, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.797 Vali Acc: 0.763 Test Loss: 0.797 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 49 cost time: 1.0313670635223389
Epoch: 49, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.788 Vali Acc: 0.763 Test Loss: 0.788 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 50 cost time: 1.0726206302642822
Epoch: 50, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
Validation loss decreased (-0.762955 --> -0.766659).  Saving model ...
Epoch: 51 cost time: 1.1843020915985107
Epoch: 51, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.772 Vali Acc: 0.770 Test Loss: 0.772 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 52 cost time: 1.217153549194336
Epoch: 52, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.764 Vali Acc: 0.770 Test Loss: 0.764 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 53 cost time: 1.1399812698364258
Epoch: 53, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.757 Vali Acc: 0.770 Test Loss: 0.757 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 54 cost time: 1.1980056762695312
Epoch: 54, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.750 Vali Acc: 0.774 Test Loss: 0.750 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 55 cost time: 1.3490912914276123
Epoch: 55, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.744 Vali Acc: 0.767 Test Loss: 0.744 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2012555599212646
Epoch: 56, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.738 Vali Acc: 0.770 Test Loss: 0.738 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.074831247329712
Epoch: 57, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.733 Vali Acc: 0.770 Test Loss: 0.733 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1633334159851074
Epoch: 58, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.728 Vali Acc: 0.770 Test Loss: 0.728 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1410765647888184
Epoch: 59, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.723 Vali Acc: 0.770 Test Loss: 0.723 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.2010385990142822
Epoch: 60, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.718 Vali Acc: 0.770 Test Loss: 0.718 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1970124244689941
Epoch: 61, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1224141120910645
Epoch: 62, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.710 Vali Acc: 0.770 Test Loss: 0.710 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.113863468170166
Epoch: 63, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.1706874370574951
Epoch: 64, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.701 Vali Acc: 0.774 Test Loss: 0.701 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 65 cost time: 1.0654428005218506
Epoch: 65, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.697 Vali Acc: 0.774 Test Loss: 0.697 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 66 cost time: 1.446028709411621
Epoch: 66, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.694 Vali Acc: 0.774 Test Loss: 0.694 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 67 cost time: 1.2578699588775635
Epoch: 67, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 68 cost time: 1.3349933624267578
Epoch: 68, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.687 Vali Acc: 0.781 Test Loss: 0.687 Test Acc: 0.781
Validation loss decreased (-0.777771 --> -0.781475).  Saving model ...
Epoch: 69 cost time: 1.2579169273376465
Epoch: 69, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.2423510551452637
Epoch: 70, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
Validation loss decreased (-0.781475 --> -0.788882).  Saving model ...
Epoch: 71 cost time: 1.280787706375122
Epoch: 71, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 72 cost time: 1.298637866973877
Epoch: 72, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 73 cost time: 1.0691378116607666
Epoch: 73, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 74 cost time: 1.0561752319335938
Epoch: 74, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 75 cost time: 1.377216100692749
Epoch: 75, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 76 cost time: 1.4148046970367432
Epoch: 76, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.662 Vali Acc: 0.793 Test Loss: 0.662 Test Acc: 0.793
Validation loss decreased (-0.788882 --> -0.792586).  Saving model ...
Epoch: 77 cost time: 1.1220176219940186
Epoch: 77, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.659 Vali Acc: 0.793 Test Loss: 0.659 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 78 cost time: 1.2855932712554932
Epoch: 78, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.656 Vali Acc: 0.793 Test Loss: 0.656 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 79 cost time: 1.2020719051361084
Epoch: 79, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.653 Vali Acc: 0.793 Test Loss: 0.653 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 80 cost time: 1.054915189743042
Epoch: 80, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.182128667831421
Epoch: 81, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.2521872520446777
Epoch: 82, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.2609553337097168
Epoch: 83, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.1972391605377197
Epoch: 84, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.3021364212036133
Epoch: 85, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.2355663776397705
Epoch: 86, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.632 Vali Acc: 0.793 Test Loss: 0.632 Test Acc: 0.793
Validation loss decreased (-0.792586 --> -0.792586).  Saving model ...
Epoch: 87 cost time: 1.293830394744873
Epoch: 87, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2964198589324951
Epoch: 88, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.792586 --> -0.796290).  Saving model ...
Epoch: 89 cost time: 1.1252844333648682
Epoch: 89, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
Validation loss decreased (-0.796290 --> -0.803697).  Saving model ...
Epoch: 90 cost time: 1.1729919910430908
Epoch: 90, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.622 Vali Acc: 0.804 Test Loss: 0.622 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803697).  Saving model ...
Epoch: 91 cost time: 1.1750288009643555
Epoch: 91, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.803697 --> -0.803698).  Saving model ...
Epoch: 92 cost time: 1.2061078548431396
Epoch: 92, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 93 cost time: 1.4784033298492432
Epoch: 93, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.807 Test Loss: 0.615 Test Acc: 0.807
Validation loss decreased (-0.803698 --> -0.807401).  Saving model ...
Epoch: 94 cost time: 1.1684260368347168
Epoch: 94, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.612 Vali Acc: 0.807 Test Loss: 0.612 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 95 cost time: 1.1487464904785156
Epoch: 95, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.610 Vali Acc: 0.807 Test Loss: 0.610 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 96 cost time: 1.4568300247192383
Epoch: 96, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.608 Vali Acc: 0.807 Test Loss: 0.608 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 97 cost time: 1.1492066383361816
Epoch: 97, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.807 Test Loss: 0.606 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 98 cost time: 1.1559312343597412
Epoch: 98, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.604 Vali Acc: 0.807 Test Loss: 0.604 Test Acc: 0.807
Validation loss decreased (-0.807401 --> -0.807401).  Saving model ...
Epoch: 99 cost time: 1.357938528060913
Epoch: 99, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.811 Test Loss: 0.602 Test Acc: 0.811
Validation loss decreased (-0.807401 --> -0.811105).  Saving model ...
Epoch: 100 cost time: 1.2951335906982422
Epoch: 100, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
Validation loss decreased (-0.811105 --> -0.814809).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.125776767730713
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.802 Vali Acc: 0.222 Test Loss: 1.802 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 1.1686701774597168
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.790 Vali Acc: 0.226 Test Loss: 1.790 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 1.1974916458129883
Epoch: 3, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.781 Vali Acc: 0.233 Test Loss: 1.781 Test Acc: 0.233
Validation loss decreased (-0.225908 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 1.287231683731079
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.773 Vali Acc: 0.252 Test Loss: 1.773 Test Acc: 0.252
Validation loss decreased (-0.233316 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 1.2001590728759766
Epoch: 5, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.762 Vali Acc: 0.263 Test Loss: 1.762 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262945).  Saving model ...
Epoch: 6 cost time: 1.1634480953216553
Epoch: 6, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.748 Vali Acc: 0.278 Test Loss: 1.748 Test Acc: 0.278
Validation loss decreased (-0.262945 --> -0.277760).  Saving model ...
Epoch: 7 cost time: 1.0895905494689941
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.733 Vali Acc: 0.293 Test Loss: 1.733 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 8 cost time: 1.2455501556396484
Epoch: 8, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.716 Vali Acc: 0.311 Test Loss: 1.716 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 1.2149229049682617
Epoch: 9, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.698 Vali Acc: 0.337 Test Loss: 1.698 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 10 cost time: 1.2497210502624512
Epoch: 10, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.679 Vali Acc: 0.356 Test Loss: 1.679 Test Acc: 0.356
Validation loss decreased (-0.337020 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 1.484511375427246
Epoch: 11, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.659 Vali Acc: 0.370 Test Loss: 1.659 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 12 cost time: 1.0553650856018066
Epoch: 12, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.638 Vali Acc: 0.396 Test Loss: 1.638 Test Acc: 0.396
Validation loss decreased (-0.370354 --> -0.396280).  Saving model ...
Epoch: 13 cost time: 1.265674114227295
Epoch: 13, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.617 Vali Acc: 0.430 Test Loss: 1.617 Test Acc: 0.430
Validation loss decreased (-0.396280 --> -0.429613).  Saving model ...
Epoch: 14 cost time: 1.292081356048584
Epoch: 14, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.595 Vali Acc: 0.463 Test Loss: 1.595 Test Acc: 0.463
Validation loss decreased (-0.429613 --> -0.462947).  Saving model ...
Epoch: 15 cost time: 1.101435661315918
Epoch: 15, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.573 Vali Acc: 0.481 Test Loss: 1.573 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481466).  Saving model ...
Epoch: 16 cost time: 1.4387826919555664
Epoch: 16, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.550 Vali Acc: 0.504 Test Loss: 1.550 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 17 cost time: 1.218214988708496
Epoch: 17, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.528 Vali Acc: 0.530 Test Loss: 1.528 Test Acc: 0.530
Validation loss decreased (-0.503688 --> -0.529614).  Saving model ...
Epoch: 18 cost time: 1.3129794597625732
Epoch: 18, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.505 Vali Acc: 0.556 Test Loss: 1.505 Test Acc: 0.556
Validation loss decreased (-0.529614 --> -0.555541).  Saving model ...
Epoch: 19 cost time: 1.273101568222046
Epoch: 19, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.482 Vali Acc: 0.559 Test Loss: 1.482 Test Acc: 0.559
Validation loss decreased (-0.555541 --> -0.559244).  Saving model ...
Epoch: 20 cost time: 1.1372711658477783
Epoch: 20, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.459 Vali Acc: 0.567 Test Loss: 1.459 Test Acc: 0.567
Validation loss decreased (-0.559244 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 1.1970767974853516
Epoch: 21, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.436 Vali Acc: 0.563 Test Loss: 1.436 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.173203945159912
Epoch: 22, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.413 Vali Acc: 0.567 Test Loss: 1.413 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 1.1166727542877197
Epoch: 23, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.390 Vali Acc: 0.596 Test Loss: 1.390 Test Acc: 0.596
Validation loss decreased (-0.566653 --> -0.596282).  Saving model ...
Epoch: 24 cost time: 1.2366902828216553
Epoch: 24, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.367 Vali Acc: 0.615 Test Loss: 1.367 Test Acc: 0.615
Validation loss decreased (-0.596282 --> -0.614801).  Saving model ...
Epoch: 25 cost time: 1.0977914333343506
Epoch: 25, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.344 Vali Acc: 0.633 Test Loss: 1.344 Test Acc: 0.633
Validation loss decreased (-0.614801 --> -0.633320).  Saving model ...
Epoch: 26 cost time: 1.1353728771209717
Epoch: 26, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.321 Vali Acc: 0.630 Test Loss: 1.321 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2130882740020752
Epoch: 27, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.300 Vali Acc: 0.633 Test Loss: 1.300 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 28 cost time: 1.1798136234283447
Epoch: 28, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.279 Vali Acc: 0.633 Test Loss: 1.279 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 29 cost time: 1.1343421936035156
Epoch: 29, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.258 Vali Acc: 0.633 Test Loss: 1.258 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 30 cost time: 1.0686075687408447
Epoch: 30, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.238 Vali Acc: 0.630 Test Loss: 1.238 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.091611385345459
Epoch: 31, Steps: 2 | Train Loss: 0.744 Vali Loss: 1.218 Vali Acc: 0.630 Test Loss: 1.218 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2125747203826904
Epoch: 32, Steps: 2 | Train Loss: 0.741 Vali Loss: 1.198 Vali Acc: 0.633 Test Loss: 1.198 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 33 cost time: 1.3192400932312012
Epoch: 33, Steps: 2 | Train Loss: 0.668 Vali Loss: 1.178 Vali Acc: 0.648 Test Loss: 1.178 Test Acc: 0.648
Validation loss decreased (-0.633321 --> -0.648136).  Saving model ...
Epoch: 34 cost time: 1.2380733489990234
Epoch: 34, Steps: 2 | Train Loss: 0.619 Vali Loss: 1.159 Vali Acc: 0.656 Test Loss: 1.159 Test Acc: 0.656
Validation loss decreased (-0.648136 --> -0.655544).  Saving model ...
Epoch: 35 cost time: 1.2876698970794678
Epoch: 35, Steps: 2 | Train Loss: 0.565 Vali Loss: 1.140 Vali Acc: 0.659 Test Loss: 1.140 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 36 cost time: 1.3121280670166016
Epoch: 36, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.122 Vali Acc: 0.674 Test Loss: 1.122 Test Acc: 0.674
Validation loss decreased (-0.659248 --> -0.674063).  Saving model ...
Epoch: 37 cost time: 1.311241865158081
Epoch: 37, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.105 Vali Acc: 0.681 Test Loss: 1.105 Test Acc: 0.681
Validation loss decreased (-0.674063 --> -0.681470).  Saving model ...
Epoch: 38 cost time: 1.1956205368041992
Epoch: 38, Steps: 2 | Train Loss: 0.479 Vali Loss: 1.088 Vali Acc: 0.681 Test Loss: 1.088 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681471).  Saving model ...
Epoch: 39 cost time: 1.3234524726867676
Epoch: 39, Steps: 2 | Train Loss: 0.476 Vali Loss: 1.073 Vali Acc: 0.681 Test Loss: 1.073 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 40 cost time: 1.4672226905822754
Epoch: 40, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.059 Vali Acc: 0.685 Test Loss: 1.059 Test Acc: 0.685
Validation loss decreased (-0.681471 --> -0.685175).  Saving model ...
Epoch: 41 cost time: 1.2657272815704346
Epoch: 41, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
Validation loss decreased (-0.685175 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 1.2709782123565674
Epoch: 42, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 1.3791403770446777
Epoch: 43, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.019 Vali Acc: 0.700 Test Loss: 1.019 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 1.3433866500854492
Epoch: 44, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.007 Vali Acc: 0.704 Test Loss: 1.007 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 45 cost time: 1.311506986618042
Epoch: 45, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1926136016845703
Epoch: 46, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.985 Vali Acc: 0.700 Test Loss: 0.985 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2653651237487793
Epoch: 47, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2139463424682617
Epoch: 48, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.967 Vali Acc: 0.715 Test Loss: 0.967 Test Acc: 0.715
Validation loss decreased (-0.703694 --> -0.714805).  Saving model ...
Epoch: 49 cost time: 1.2818598747253418
Epoch: 49, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.958 Vali Acc: 0.715 Test Loss: 0.958 Test Acc: 0.715
Validation loss decreased (-0.714805 --> -0.714805).  Saving model ...
Epoch: 50 cost time: 1.13759446144104
Epoch: 50, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.950 Vali Acc: 0.719 Test Loss: 0.950 Test Acc: 0.719
Validation loss decreased (-0.714805 --> -0.718509).  Saving model ...
Epoch: 51 cost time: 1.1333942413330078
Epoch: 51, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.942 Vali Acc: 0.726 Test Loss: 0.942 Test Acc: 0.726
Validation loss decreased (-0.718509 --> -0.725917).  Saving model ...
Epoch: 52 cost time: 1.0759642124176025
Epoch: 52, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2138266563415527
Epoch: 53, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1713368892669678
Epoch: 54, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.919 Vali Acc: 0.726 Test Loss: 0.919 Test Acc: 0.726
Validation loss decreased (-0.725917 --> -0.725917).  Saving model ...
Epoch: 55 cost time: 1.2649741172790527
Epoch: 55, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.913 Vali Acc: 0.730 Test Loss: 0.913 Test Acc: 0.730
Validation loss decreased (-0.725917 --> -0.729621).  Saving model ...
Epoch: 56 cost time: 1.2727665901184082
Epoch: 56, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.906 Vali Acc: 0.726 Test Loss: 0.906 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1549828052520752
Epoch: 57, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.899 Vali Acc: 0.726 Test Loss: 0.899 Test Acc: 0.726
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.237558364868164
Epoch: 58, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.893 Vali Acc: 0.733 Test Loss: 0.893 Test Acc: 0.733
Validation loss decreased (-0.729621 --> -0.733324).  Saving model ...
Epoch: 59 cost time: 1.2914226055145264
Epoch: 59, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 60 cost time: 1.4322245121002197
Epoch: 60, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.880 Vali Acc: 0.730 Test Loss: 0.880 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2796335220336914
Epoch: 61, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.875 Vali Acc: 0.730 Test Loss: 0.875 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2047040462493896
Epoch: 62, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 63 cost time: 1.3917675018310547
Epoch: 63, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.864 Vali Acc: 0.733 Test Loss: 0.864 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 64 cost time: 1.238483190536499
Epoch: 64, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.859 Vali Acc: 0.741 Test Loss: 0.859 Test Acc: 0.741
Validation loss decreased (-0.733325 --> -0.740732).  Saving model ...
Epoch: 65 cost time: 1.1752433776855469
Epoch: 65, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.854 Vali Acc: 0.741 Test Loss: 0.854 Test Acc: 0.741
Validation loss decreased (-0.740732 --> -0.740732).  Saving model ...
Epoch: 66 cost time: 1.287146806716919
Epoch: 66, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.849 Vali Acc: 0.752 Test Loss: 0.849 Test Acc: 0.752
Validation loss decreased (-0.740732 --> -0.751843).  Saving model ...
Epoch: 67 cost time: 1.2246592044830322
Epoch: 67, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.844 Vali Acc: 0.752 Test Loss: 0.844 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751843).  Saving model ...
Epoch: 68 cost time: 1.3171048164367676
Epoch: 68, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.840 Vali Acc: 0.752 Test Loss: 0.840 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751843).  Saving model ...
Epoch: 69 cost time: 1.2601580619812012
Epoch: 69, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.835 Vali Acc: 0.752 Test Loss: 0.835 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751843).  Saving model ...
Epoch: 70 cost time: 1.2669777870178223
Epoch: 70, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.831 Vali Acc: 0.752 Test Loss: 0.831 Test Acc: 0.752
Validation loss decreased (-0.751843 --> -0.751844).  Saving model ...
Epoch: 71 cost time: 1.2048041820526123
Epoch: 71, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.826 Vali Acc: 0.752 Test Loss: 0.826 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 72 cost time: 1.2981653213500977
Epoch: 72, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.821 Vali Acc: 0.752 Test Loss: 0.821 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 73 cost time: 1.1561431884765625
Epoch: 73, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.816 Vali Acc: 0.752 Test Loss: 0.816 Test Acc: 0.752
Validation loss decreased (-0.751844 --> -0.751844).  Saving model ...
Epoch: 74 cost time: 1.072277545928955
Epoch: 74, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.811 Vali Acc: 0.756 Test Loss: 0.811 Test Acc: 0.756
Validation loss decreased (-0.751844 --> -0.755547).  Saving model ...
Epoch: 75 cost time: 1.166572093963623
Epoch: 75, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.807 Vali Acc: 0.752 Test Loss: 0.807 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.2178103923797607
Epoch: 76, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 77 cost time: 1.1158063411712646
Epoch: 77, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.798 Vali Acc: 0.759 Test Loss: 0.798 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759251).  Saving model ...
Epoch: 78 cost time: 1.1836726665496826
Epoch: 78, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.794 Vali Acc: 0.756 Test Loss: 0.794 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2518911361694336
Epoch: 79, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.3417294025421143
Epoch: 80, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.2976903915405273
Epoch: 81, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.0310866832733154
Epoch: 82, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.777 Vali Acc: 0.748 Test Loss: 0.777 Test Acc: 0.748
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.2520160675048828
Epoch: 83, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.773 Vali Acc: 0.752 Test Loss: 0.773 Test Acc: 0.752
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.3076696395874023
Epoch: 84, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.769 Vali Acc: 0.752 Test Loss: 0.769 Test Acc: 0.752
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.178823709487915
Epoch: 85, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.766 Vali Acc: 0.752 Test Loss: 0.766 Test Acc: 0.752
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.2985548973083496
Epoch: 86, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.0546607971191406
Epoch: 87, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.759 Vali Acc: 0.759 Test Loss: 0.759 Test Acc: 0.759
Validation loss decreased (-0.759251 --> -0.759252).  Saving model ...
Epoch: 88 cost time: 1.1732275485992432
Epoch: 88, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.755 Vali Acc: 0.759 Test Loss: 0.755 Test Acc: 0.759
Validation loss decreased (-0.759252 --> -0.759252).  Saving model ...
Epoch: 89 cost time: 1.2056427001953125
Epoch: 89, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766659).  Saving model ...
Epoch: 90 cost time: 1.2954070568084717
Epoch: 90, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 91 cost time: 1.285879135131836
Epoch: 91, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.744 Vali Acc: 0.770 Test Loss: 0.744 Test Acc: 0.770
Validation loss decreased (-0.766659 --> -0.770363).  Saving model ...
Epoch: 92 cost time: 1.1716055870056152
Epoch: 92, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.740 Vali Acc: 0.770 Test Loss: 0.740 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 93 cost time: 1.1468074321746826
Epoch: 93, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.736 Vali Acc: 0.770 Test Loss: 0.736 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 94 cost time: 1.362107515335083
Epoch: 94, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.733 Vali Acc: 0.770 Test Loss: 0.733 Test Acc: 0.770
Validation loss decreased (-0.770363 --> -0.770363).  Saving model ...
Epoch: 95 cost time: 1.072279930114746
Epoch: 95, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.729 Vali Acc: 0.767 Test Loss: 0.729 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.3075344562530518
Epoch: 96, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.726 Vali Acc: 0.767 Test Loss: 0.726 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.2446930408477783
Epoch: 97, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.722 Vali Acc: 0.767 Test Loss: 0.722 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.2379353046417236
Epoch: 98, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.719 Vali Acc: 0.774 Test Loss: 0.719 Test Acc: 0.774
Validation loss decreased (-0.770363 --> -0.774067).  Saving model ...
Epoch: 99 cost time: 1.3531169891357422
Epoch: 99, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.715 Vali Acc: 0.774 Test Loss: 0.715 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
Epoch: 100 cost time: 1.2390170097351074
Epoch: 100, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.712 Vali Acc: 0.774 Test Loss: 0.712 Test Acc: 0.774
Validation loss decreased (-0.774067 --> -0.774067).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.774074074074074
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1021156311035156
Epoch: 1, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.849 Vali Acc: 0.141 Test Loss: 1.849 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 1.126690149307251
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.840 Vali Acc: 0.144 Test Loss: 1.840 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 1.2675731182098389
Epoch: 3, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.833 Vali Acc: 0.144 Test Loss: 1.833 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 1.2440893650054932
Epoch: 4, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.827 Vali Acc: 0.137 Test Loss: 1.827 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.154224157333374
Epoch: 5, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.818 Vali Acc: 0.144 Test Loss: 1.818 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 1.3063273429870605
Epoch: 6, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.809 Vali Acc: 0.152 Test Loss: 1.809 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151834).  Saving model ...
Epoch: 7 cost time: 1.13289475440979
Epoch: 7, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.797 Vali Acc: 0.159 Test Loss: 1.797 Test Acc: 0.159
Validation loss decreased (-0.151834 --> -0.159241).  Saving model ...
Epoch: 8 cost time: 1.339831829071045
Epoch: 8, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.785 Vali Acc: 0.163 Test Loss: 1.785 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 9 cost time: 1.1971688270568848
Epoch: 9, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.772 Vali Acc: 0.181 Test Loss: 1.772 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 10 cost time: 1.253448724746704
Epoch: 10, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.758 Vali Acc: 0.193 Test Loss: 1.758 Test Acc: 0.193
Validation loss decreased (-0.181464 --> -0.192575).  Saving model ...
Epoch: 11 cost time: 1.1256098747253418
Epoch: 11, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.744 Vali Acc: 0.185 Test Loss: 1.744 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.290727138519287
Epoch: 12, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.729 Vali Acc: 0.211 Test Loss: 1.729 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211094).  Saving model ...
Epoch: 13 cost time: 1.2622120380401611
Epoch: 13, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.714 Vali Acc: 0.222 Test Loss: 1.714 Test Acc: 0.222
Validation loss decreased (-0.211094 --> -0.222205).  Saving model ...
Epoch: 14 cost time: 1.1574270725250244
Epoch: 14, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.698 Vali Acc: 0.244 Test Loss: 1.698 Test Acc: 0.244
Validation loss decreased (-0.222205 --> -0.244427).  Saving model ...
Epoch: 15 cost time: 1.172633409500122
Epoch: 15, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.682 Vali Acc: 0.281 Test Loss: 1.682 Test Acc: 0.281
Validation loss decreased (-0.244427 --> -0.281465).  Saving model ...
Epoch: 16 cost time: 1.1906626224517822
Epoch: 16, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.666 Vali Acc: 0.307 Test Loss: 1.666 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 17 cost time: 1.1052098274230957
Epoch: 17, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.649 Vali Acc: 0.326 Test Loss: 1.649 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 18 cost time: 1.3864970207214355
Epoch: 18, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.632 Vali Acc: 0.359 Test Loss: 1.632 Test Acc: 0.359
Validation loss decreased (-0.325909 --> -0.359243).  Saving model ...
Epoch: 19 cost time: 1.068803310394287
Epoch: 19, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.616 Vali Acc: 0.378 Test Loss: 1.616 Test Acc: 0.378
Validation loss decreased (-0.359243 --> -0.377762).  Saving model ...
Epoch: 20 cost time: 1.233137845993042
Epoch: 20, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.599 Vali Acc: 0.393 Test Loss: 1.599 Test Acc: 0.393
Validation loss decreased (-0.377762 --> -0.392577).  Saving model ...
Epoch: 21 cost time: 1.1792736053466797
Epoch: 21, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.582 Vali Acc: 0.393 Test Loss: 1.582 Test Acc: 0.393
Validation loss decreased (-0.392577 --> -0.392577).  Saving model ...
Epoch: 22 cost time: 1.0545423030853271
Epoch: 22, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.565 Vali Acc: 0.400 Test Loss: 1.565 Test Acc: 0.400
Validation loss decreased (-0.392577 --> -0.399984).  Saving model ...
Epoch: 23 cost time: 1.1728222370147705
Epoch: 23, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.548 Vali Acc: 0.430 Test Loss: 1.548 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429614).  Saving model ...
Epoch: 24 cost time: 1.217881441116333
Epoch: 24, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.531 Vali Acc: 0.437 Test Loss: 1.531 Test Acc: 0.437
Validation loss decreased (-0.429614 --> -0.437022).  Saving model ...
Epoch: 25 cost time: 1.3630967140197754
Epoch: 25, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.513 Vali Acc: 0.448 Test Loss: 1.513 Test Acc: 0.448
Validation loss decreased (-0.437022 --> -0.448133).  Saving model ...
Epoch: 26 cost time: 1.139685869216919
Epoch: 26, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.496 Vali Acc: 0.452 Test Loss: 1.496 Test Acc: 0.452
Validation loss decreased (-0.448133 --> -0.451837).  Saving model ...
Epoch: 27 cost time: 1.3003666400909424
Epoch: 27, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.479 Vali Acc: 0.470 Test Loss: 1.479 Test Acc: 0.470
Validation loss decreased (-0.451837 --> -0.470356).  Saving model ...
Epoch: 28 cost time: 1.1950469017028809
Epoch: 28, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.463 Vali Acc: 0.478 Test Loss: 1.463 Test Acc: 0.478
Validation loss decreased (-0.470356 --> -0.477763).  Saving model ...
Epoch: 29 cost time: 1.0095665454864502
Epoch: 29, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.446 Vali Acc: 0.493 Test Loss: 1.446 Test Acc: 0.493
Validation loss decreased (-0.477763 --> -0.492578).  Saving model ...
Epoch: 30 cost time: 1.2956700325012207
Epoch: 30, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.429 Vali Acc: 0.496 Test Loss: 1.429 Test Acc: 0.496
Validation loss decreased (-0.492578 --> -0.496282).  Saving model ...
Epoch: 31 cost time: 1.1168358325958252
Epoch: 31, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.412 Vali Acc: 0.507 Test Loss: 1.412 Test Acc: 0.507
Validation loss decreased (-0.496282 --> -0.507393).  Saving model ...
Epoch: 32 cost time: 1.1604342460632324
Epoch: 32, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.394 Vali Acc: 0.515 Test Loss: 1.394 Test Acc: 0.515
Validation loss decreased (-0.507393 --> -0.514801).  Saving model ...
Epoch: 33 cost time: 1.1397209167480469
Epoch: 33, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.377 Vali Acc: 0.515 Test Loss: 1.377 Test Acc: 0.515
Validation loss decreased (-0.514801 --> -0.514801).  Saving model ...
Epoch: 34 cost time: 1.365854024887085
Epoch: 34, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.360 Vali Acc: 0.522 Test Loss: 1.360 Test Acc: 0.522
Validation loss decreased (-0.514801 --> -0.522209).  Saving model ...
Epoch: 35 cost time: 1.4521782398223877
Epoch: 35, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.344 Vali Acc: 0.530 Test Loss: 1.344 Test Acc: 0.530
Validation loss decreased (-0.522209 --> -0.529616).  Saving model ...
Epoch: 36 cost time: 1.2612824440002441
Epoch: 36, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.327 Vali Acc: 0.537 Test Loss: 1.327 Test Acc: 0.537
Validation loss decreased (-0.529616 --> -0.537024).  Saving model ...
Epoch: 37 cost time: 1.1488111019134521
Epoch: 37, Steps: 2 | Train Loss: 0.735 Vali Loss: 1.311 Vali Acc: 0.544 Test Loss: 1.311 Test Acc: 0.544
Validation loss decreased (-0.537024 --> -0.544431).  Saving model ...
Epoch: 38 cost time: 1.3323140144348145
Epoch: 38, Steps: 2 | Train Loss: 0.746 Vali Loss: 1.295 Vali Acc: 0.556 Test Loss: 1.295 Test Acc: 0.556
Validation loss decreased (-0.544431 --> -0.555543).  Saving model ...
Epoch: 39 cost time: 1.20127534866333
Epoch: 39, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.280 Vali Acc: 0.556 Test Loss: 1.280 Test Acc: 0.556
Validation loss decreased (-0.555543 --> -0.555543).  Saving model ...
Epoch: 40 cost time: 1.1571629047393799
Epoch: 40, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.264 Vali Acc: 0.552 Test Loss: 1.264 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0896670818328857
Epoch: 41, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.248 Vali Acc: 0.559 Test Loss: 1.248 Test Acc: 0.559
Validation loss decreased (-0.555543 --> -0.559247).  Saving model ...
Epoch: 42 cost time: 1.1670305728912354
Epoch: 42, Steps: 2 | Train Loss: 0.639 Vali Loss: 1.234 Vali Acc: 0.570 Test Loss: 1.234 Test Acc: 0.570
Validation loss decreased (-0.559247 --> -0.570358).  Saving model ...
Epoch: 43 cost time: 1.4195494651794434
Epoch: 43, Steps: 2 | Train Loss: 0.599 Vali Loss: 1.220 Vali Acc: 0.570 Test Loss: 1.220 Test Acc: 0.570
Validation loss decreased (-0.570358 --> -0.570358).  Saving model ...
Epoch: 44 cost time: 1.2282295227050781
Epoch: 44, Steps: 2 | Train Loss: 0.559 Vali Loss: 1.206 Vali Acc: 0.574 Test Loss: 1.206 Test Acc: 0.574
Validation loss decreased (-0.570358 --> -0.574062).  Saving model ...
Epoch: 45 cost time: 1.2215476036071777
Epoch: 45, Steps: 2 | Train Loss: 0.545 Vali Loss: 1.193 Vali Acc: 0.570 Test Loss: 1.193 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1606230735778809
Epoch: 46, Steps: 2 | Train Loss: 0.453 Vali Loss: 1.181 Vali Acc: 0.581 Test Loss: 1.181 Test Acc: 0.581
Validation loss decreased (-0.574062 --> -0.581470).  Saving model ...
Epoch: 47 cost time: 1.1748325824737549
Epoch: 47, Steps: 2 | Train Loss: 0.461 Vali Loss: 1.169 Vali Acc: 0.589 Test Loss: 1.169 Test Acc: 0.589
Validation loss decreased (-0.581470 --> -0.588877).  Saving model ...
Epoch: 48 cost time: 1.182692050933838
Epoch: 48, Steps: 2 | Train Loss: 0.461 Vali Loss: 1.157 Vali Acc: 0.589 Test Loss: 1.157 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588877).  Saving model ...
Epoch: 49 cost time: 1.180443286895752
Epoch: 49, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.144 Vali Acc: 0.593 Test Loss: 1.144 Test Acc: 0.593
Validation loss decreased (-0.588877 --> -0.592581).  Saving model ...
Epoch: 50 cost time: 1.2364370822906494
Epoch: 50, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.131 Vali Acc: 0.593 Test Loss: 1.131 Test Acc: 0.593
Validation loss decreased (-0.592581 --> -0.592581).  Saving model ...
Epoch: 51 cost time: 1.2468702793121338
Epoch: 51, Steps: 2 | Train Loss: 0.348 Vali Loss: 1.119 Vali Acc: 0.596 Test Loss: 1.119 Test Acc: 0.596
Validation loss decreased (-0.592581 --> -0.596285).  Saving model ...
Epoch: 52 cost time: 1.1838908195495605
Epoch: 52, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.105 Vali Acc: 0.596 Test Loss: 1.105 Test Acc: 0.596
Validation loss decreased (-0.596285 --> -0.596285).  Saving model ...
Epoch: 53 cost time: 1.2715163230895996
Epoch: 53, Steps: 2 | Train Loss: 0.318 Vali Loss: 1.092 Vali Acc: 0.604 Test Loss: 1.092 Test Acc: 0.604
Validation loss decreased (-0.596285 --> -0.603693).  Saving model ...
Epoch: 54 cost time: 1.1705350875854492
Epoch: 54, Steps: 2 | Train Loss: 0.326 Vali Loss: 1.078 Vali Acc: 0.596 Test Loss: 1.078 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3835763931274414
Epoch: 55, Steps: 2 | Train Loss: 0.304 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2435731887817383
Epoch: 56, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0689828395843506
Epoch: 57, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.041 Vali Acc: 0.607 Test Loss: 1.041 Test Acc: 0.607
Validation loss decreased (-0.603693 --> -0.607397).  Saving model ...
Epoch: 58 cost time: 1.117769479751587
Epoch: 58, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.029 Vali Acc: 0.611 Test Loss: 1.029 Test Acc: 0.611
Validation loss decreased (-0.607397 --> -0.611101).  Saving model ...
Epoch: 59 cost time: 1.0217392444610596
Epoch: 59, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.017 Vali Acc: 0.615 Test Loss: 1.017 Test Acc: 0.615
Validation loss decreased (-0.611101 --> -0.614805).  Saving model ...
Epoch: 60 cost time: 1.0646376609802246
Epoch: 60, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.614805 --> -0.622212).  Saving model ...
Epoch: 61 cost time: 1.1584413051605225
Epoch: 61, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
Validation loss decreased (-0.622212 --> -0.622212).  Saving model ...
Epoch: 62 cost time: 1.1018366813659668
Epoch: 62, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.985 Vali Acc: 0.633 Test Loss: 0.985 Test Acc: 0.633
Validation loss decreased (-0.622212 --> -0.633323).  Saving model ...
Epoch: 63 cost time: 1.0705368518829346
Epoch: 63, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.974 Vali Acc: 0.641 Test Loss: 0.974 Test Acc: 0.641
Validation loss decreased (-0.633323 --> -0.640731).  Saving model ...
Epoch: 64 cost time: 1.143204927444458
Epoch: 64, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.964 Vali Acc: 0.641 Test Loss: 0.964 Test Acc: 0.641
Validation loss decreased (-0.640731 --> -0.640731).  Saving model ...
Epoch: 65 cost time: 1.214102029800415
Epoch: 65, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.953 Vali Acc: 0.644 Test Loss: 0.953 Test Acc: 0.644
Validation loss decreased (-0.640731 --> -0.644435).  Saving model ...
Epoch: 66 cost time: 1.024277925491333
Epoch: 66, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.944 Vali Acc: 0.648 Test Loss: 0.944 Test Acc: 0.648
Validation loss decreased (-0.644435 --> -0.648139).  Saving model ...
Epoch: 67 cost time: 1.1468584537506104
Epoch: 67, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.934 Vali Acc: 0.648 Test Loss: 0.934 Test Acc: 0.648
Validation loss decreased (-0.648139 --> -0.648139).  Saving model ...
Epoch: 68 cost time: 1.1128957271575928
Epoch: 68, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.925 Vali Acc: 0.644 Test Loss: 0.925 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0750937461853027
Epoch: 69, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.916 Vali Acc: 0.648 Test Loss: 0.916 Test Acc: 0.648
Validation loss decreased (-0.648139 --> -0.648139).  Saving model ...
Epoch: 70 cost time: 1.069019079208374
Epoch: 70, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.907 Vali Acc: 0.648 Test Loss: 0.907 Test Acc: 0.648
Validation loss decreased (-0.648139 --> -0.648139).  Saving model ...
Epoch: 71 cost time: 1.080674171447754
Epoch: 71, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.898 Vali Acc: 0.656 Test Loss: 0.898 Test Acc: 0.656
Validation loss decreased (-0.648139 --> -0.655547).  Saving model ...
Epoch: 72 cost time: 1.257284164428711
Epoch: 72, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.889 Vali Acc: 0.659 Test Loss: 0.889 Test Acc: 0.659
Validation loss decreased (-0.655547 --> -0.659250).  Saving model ...
Epoch: 73 cost time: 1.3475871086120605
Epoch: 73, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.881 Vali Acc: 0.663 Test Loss: 0.881 Test Acc: 0.663
Validation loss decreased (-0.659250 --> -0.662954).  Saving model ...
Epoch: 74 cost time: 1.2067372798919678
Epoch: 74, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.873 Vali Acc: 0.670 Test Loss: 0.873 Test Acc: 0.670
Validation loss decreased (-0.662954 --> -0.670362).  Saving model ...
Epoch: 75 cost time: 1.163545846939087
Epoch: 75, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.865 Vali Acc: 0.674 Test Loss: 0.865 Test Acc: 0.674
Validation loss decreased (-0.670362 --> -0.674065).  Saving model ...
Epoch: 76 cost time: 1.1603291034698486
Epoch: 76, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.857 Vali Acc: 0.674 Test Loss: 0.857 Test Acc: 0.674
Validation loss decreased (-0.674065 --> -0.674066).  Saving model ...
Epoch: 77 cost time: 1.3312878608703613
Epoch: 77, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.849 Vali Acc: 0.674 Test Loss: 0.849 Test Acc: 0.674
Validation loss decreased (-0.674066 --> -0.674066).  Saving model ...
Epoch: 78 cost time: 1.1863276958465576
Epoch: 78, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.842 Vali Acc: 0.681 Test Loss: 0.842 Test Acc: 0.681
Validation loss decreased (-0.674066 --> -0.681473).  Saving model ...
Epoch: 79 cost time: 1.1702473163604736
Epoch: 79, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.835 Vali Acc: 0.674 Test Loss: 0.835 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.0671725273132324
Epoch: 80, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.827 Vali Acc: 0.689 Test Loss: 0.827 Test Acc: 0.689
Validation loss decreased (-0.681473 --> -0.688881).  Saving model ...
Epoch: 81 cost time: 1.1319403648376465
Epoch: 81, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.820 Vali Acc: 0.700 Test Loss: 0.820 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699992).  Saving model ...
Epoch: 82 cost time: 1.0825409889221191
Epoch: 82, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.813 Vali Acc: 0.704 Test Loss: 0.813 Test Acc: 0.704
Validation loss decreased (-0.699992 --> -0.703696).  Saving model ...
Epoch: 83 cost time: 1.119743824005127
Epoch: 83, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.806 Vali Acc: 0.707 Test Loss: 0.806 Test Acc: 0.707
Validation loss decreased (-0.703696 --> -0.707399).  Saving model ...
Epoch: 84 cost time: 1.2268626689910889
Epoch: 84, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.799 Vali Acc: 0.707 Test Loss: 0.799 Test Acc: 0.707
Validation loss decreased (-0.707399 --> -0.707399).  Saving model ...
Epoch: 85 cost time: 1.188999891281128
Epoch: 85, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.792 Vali Acc: 0.719 Test Loss: 0.792 Test Acc: 0.719
Validation loss decreased (-0.707399 --> -0.718511).  Saving model ...
Epoch: 86 cost time: 1.2260863780975342
Epoch: 86, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
Validation loss decreased (-0.718511 --> -0.722214).  Saving model ...
Epoch: 87 cost time: 1.074265718460083
Epoch: 87, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.780 Vali Acc: 0.722 Test Loss: 0.780 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 88 cost time: 1.1375117301940918
Epoch: 88, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.774 Vali Acc: 0.726 Test Loss: 0.774 Test Acc: 0.726
Validation loss decreased (-0.722214 --> -0.725918).  Saving model ...
Epoch: 89 cost time: 1.0640430450439453
Epoch: 89, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.768 Vali Acc: 0.730 Test Loss: 0.768 Test Acc: 0.730
Validation loss decreased (-0.725918 --> -0.729622).  Saving model ...
Epoch: 90 cost time: 1.1335713863372803
Epoch: 90, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.761 Vali Acc: 0.733 Test Loss: 0.761 Test Acc: 0.733
Validation loss decreased (-0.729622 --> -0.733326).  Saving model ...
Epoch: 91 cost time: 1.1381466388702393
Epoch: 91, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.755 Vali Acc: 0.733 Test Loss: 0.755 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 92 cost time: 1.1772503852844238
Epoch: 92, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
Validation loss decreased (-0.733326 --> -0.737030).  Saving model ...
Epoch: 93 cost time: 1.2411162853240967
Epoch: 93, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
Validation loss decreased (-0.737030 --> -0.740733).  Saving model ...
Epoch: 94 cost time: 1.1171340942382812
Epoch: 94, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
Validation loss decreased (-0.740733 --> -0.740733).  Saving model ...
Epoch: 95 cost time: 1.2408628463745117
Epoch: 95, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.732 Vali Acc: 0.744 Test Loss: 0.732 Test Acc: 0.744
Validation loss decreased (-0.740733 --> -0.744437).  Saving model ...
Epoch: 96 cost time: 1.103661060333252
Epoch: 96, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.727 Vali Acc: 0.748 Test Loss: 0.727 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 97 cost time: 1.1264963150024414
Epoch: 97, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.722 Vali Acc: 0.752 Test Loss: 0.722 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 98 cost time: 1.1317119598388672
Epoch: 98, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.717 Vali Acc: 0.752 Test Loss: 0.717 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 99 cost time: 1.2441439628601074
Epoch: 99, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755548).  Saving model ...
Epoch: 100 cost time: 1.2451183795928955
Epoch: 100, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.707 Vali Acc: 0.759 Test Loss: 0.707 Test Acc: 0.759
Validation loss decreased (-0.755548 --> -0.759252).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7592592592592593
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.763986587524414
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.865 Vali Acc: 0.115 Test Loss: 1.865 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.187281847000122
Epoch: 2, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.859 Vali Acc: 0.115 Test Loss: 1.859 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 1.4261932373046875
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.855 Vali Acc: 0.115 Test Loss: 1.855 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114796).  Saving model ...
Epoch: 4 cost time: 1.253279685974121
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.850 Vali Acc: 0.115 Test Loss: 1.850 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114796).  Saving model ...
Epoch: 5 cost time: 1.21463942527771
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.845 Vali Acc: 0.122 Test Loss: 1.845 Test Acc: 0.122
Validation loss decreased (-0.114796 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 1.119194507598877
Epoch: 6, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.838 Vali Acc: 0.130 Test Loss: 1.838 Test Acc: 0.130
Validation loss decreased (-0.122204 --> -0.129611).  Saving model ...
Epoch: 7 cost time: 1.1493616104125977
Epoch: 7, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.831 Vali Acc: 0.130 Test Loss: 1.831 Test Acc: 0.130
Validation loss decreased (-0.129611 --> -0.129611).  Saving model ...
Epoch: 8 cost time: 1.320296287536621
Epoch: 8, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.822 Vali Acc: 0.141 Test Loss: 1.822 Test Acc: 0.141
Validation loss decreased (-0.129611 --> -0.140723).  Saving model ...
Epoch: 9 cost time: 1.2374725341796875
Epoch: 9, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.812 Vali Acc: 0.156 Test Loss: 1.812 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155537).  Saving model ...
Epoch: 10 cost time: 1.2154266834259033
Epoch: 10, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.803 Vali Acc: 0.156 Test Loss: 1.803 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155538).  Saving model ...
Epoch: 11 cost time: 1.1730248928070068
Epoch: 11, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.793 Vali Acc: 0.163 Test Loss: 1.793 Test Acc: 0.163
Validation loss decreased (-0.155538 --> -0.162945).  Saving model ...
Epoch: 12 cost time: 1.2592787742614746
Epoch: 12, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.782 Vali Acc: 0.189 Test Loss: 1.782 Test Acc: 0.189
Validation loss decreased (-0.162945 --> -0.188871).  Saving model ...
Epoch: 13 cost time: 1.168881893157959
Epoch: 13, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.770 Vali Acc: 0.193 Test Loss: 1.770 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 14 cost time: 1.2668447494506836
Epoch: 14, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.759 Vali Acc: 0.207 Test Loss: 1.759 Test Acc: 0.207
Validation loss decreased (-0.192575 --> -0.207390).  Saving model ...
Epoch: 15 cost time: 1.1479535102844238
Epoch: 15, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.747 Vali Acc: 0.226 Test Loss: 1.747 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225908).  Saving model ...
Epoch: 16 cost time: 1.1936323642730713
Epoch: 16, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.735 Vali Acc: 0.256 Test Loss: 1.735 Test Acc: 0.256
Validation loss decreased (-0.225908 --> -0.255538).  Saving model ...
Epoch: 17 cost time: 1.302272081375122
Epoch: 17, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.723 Vali Acc: 0.270 Test Loss: 1.723 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 18 cost time: 1.2247798442840576
Epoch: 18, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.710 Vali Acc: 0.296 Test Loss: 1.710 Test Acc: 0.296
Validation loss decreased (-0.270353 --> -0.296279).  Saving model ...
Epoch: 19 cost time: 1.2037949562072754
Epoch: 19, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.697 Vali Acc: 0.307 Test Loss: 1.697 Test Acc: 0.307
Validation loss decreased (-0.296279 --> -0.307390).  Saving model ...
Epoch: 20 cost time: 1.082930088043213
Epoch: 20, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.685 Vali Acc: 0.326 Test Loss: 1.685 Test Acc: 0.326
Validation loss decreased (-0.307390 --> -0.325909).  Saving model ...
Epoch: 21 cost time: 1.1528785228729248
Epoch: 21, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.672 Vali Acc: 0.344 Test Loss: 1.672 Test Acc: 0.344
Validation loss decreased (-0.325909 --> -0.344428).  Saving model ...
Epoch: 22 cost time: 1.324157953262329
Epoch: 22, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.658 Vali Acc: 0.374 Test Loss: 1.658 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374057).  Saving model ...
Epoch: 23 cost time: 1.1249237060546875
Epoch: 23, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.645 Vali Acc: 0.407 Test Loss: 1.645 Test Acc: 0.407
Validation loss decreased (-0.374057 --> -0.407391).  Saving model ...
Epoch: 24 cost time: 1.2783751487731934
Epoch: 24, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.631 Vali Acc: 0.422 Test Loss: 1.631 Test Acc: 0.422
Validation loss decreased (-0.407391 --> -0.422206).  Saving model ...
Epoch: 25 cost time: 1.012157678604126
Epoch: 25, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.617 Vali Acc: 0.437 Test Loss: 1.617 Test Acc: 0.437
Validation loss decreased (-0.422206 --> -0.437021).  Saving model ...
Epoch: 26 cost time: 1.1509552001953125
Epoch: 26, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.602 Vali Acc: 0.448 Test Loss: 1.602 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448132).  Saving model ...
Epoch: 27 cost time: 1.0903651714324951
Epoch: 27, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.588 Vali Acc: 0.456 Test Loss: 1.588 Test Acc: 0.456
Validation loss decreased (-0.448132 --> -0.455540).  Saving model ...
Epoch: 28 cost time: 1.0957562923431396
Epoch: 28, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.575 Vali Acc: 0.467 Test Loss: 1.575 Test Acc: 0.467
Validation loss decreased (-0.455540 --> -0.466651).  Saving model ...
Epoch: 29 cost time: 1.212303876876831
Epoch: 29, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.560 Vali Acc: 0.485 Test Loss: 1.560 Test Acc: 0.485
Validation loss decreased (-0.466651 --> -0.485170).  Saving model ...
Epoch: 30 cost time: 1.135551929473877
Epoch: 30, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.545 Vali Acc: 0.496 Test Loss: 1.545 Test Acc: 0.496
Validation loss decreased (-0.485170 --> -0.496281).  Saving model ...
Epoch: 31 cost time: 1.1613073348999023
Epoch: 31, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.530 Vali Acc: 0.511 Test Loss: 1.530 Test Acc: 0.511
Validation loss decreased (-0.496281 --> -0.511096).  Saving model ...
Epoch: 32 cost time: 1.1569736003875732
Epoch: 32, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.514 Vali Acc: 0.533 Test Loss: 1.514 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533318).  Saving model ...
Epoch: 33 cost time: 1.276879072189331
Epoch: 33, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.498 Vali Acc: 0.541 Test Loss: 1.498 Test Acc: 0.541
Validation loss decreased (-0.533318 --> -0.540726).  Saving model ...
Epoch: 34 cost time: 1.1038615703582764
Epoch: 34, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.482 Vali Acc: 0.552 Test Loss: 1.482 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551837).  Saving model ...
Epoch: 35 cost time: 1.2348268032073975
Epoch: 35, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.466 Vali Acc: 0.552 Test Loss: 1.466 Test Acc: 0.552
Validation loss decreased (-0.551837 --> -0.551837).  Saving model ...
Epoch: 36 cost time: 1.3286828994750977
Epoch: 36, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.449 Vali Acc: 0.563 Test Loss: 1.449 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562948).  Saving model ...
Epoch: 37 cost time: 1.1168148517608643
Epoch: 37, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.432 Vali Acc: 0.563 Test Loss: 1.432 Test Acc: 0.563
Validation loss decreased (-0.562948 --> -0.562949).  Saving model ...
Epoch: 38 cost time: 1.25252366065979
Epoch: 38, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.415 Vali Acc: 0.567 Test Loss: 1.415 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566653).  Saving model ...
Epoch: 39 cost time: 1.3284039497375488
Epoch: 39, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.397 Vali Acc: 0.567 Test Loss: 1.397 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566653).  Saving model ...
Epoch: 40 cost time: 1.3862638473510742
Epoch: 40, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.379 Vali Acc: 0.581 Test Loss: 1.379 Test Acc: 0.581
Validation loss decreased (-0.566653 --> -0.581468).  Saving model ...
Epoch: 41 cost time: 1.1483263969421387
Epoch: 41, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.360 Vali Acc: 0.593 Test Loss: 1.360 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 42 cost time: 1.2949931621551514
Epoch: 42, Steps: 2 | Train Loss: 0.844 Vali Loss: 1.342 Vali Acc: 0.600 Test Loss: 1.342 Test Acc: 0.600
Validation loss decreased (-0.592579 --> -0.599987).  Saving model ...
Epoch: 43 cost time: 1.1153669357299805
Epoch: 43, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.323 Vali Acc: 0.604 Test Loss: 1.323 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603690).  Saving model ...
Epoch: 44 cost time: 1.305417537689209
Epoch: 44, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.305 Vali Acc: 0.611 Test Loss: 1.305 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611098).  Saving model ...
Epoch: 45 cost time: 1.2981979846954346
Epoch: 45, Steps: 2 | Train Loss: 0.719 Vali Loss: 1.285 Vali Acc: 0.611 Test Loss: 1.285 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 46 cost time: 1.315241813659668
Epoch: 46, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.266 Vali Acc: 0.622 Test Loss: 1.266 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 47 cost time: 1.2485175132751465
Epoch: 47, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 48 cost time: 1.4226229190826416
Epoch: 48, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.225 Vali Acc: 0.630 Test Loss: 1.225 Test Acc: 0.630
Validation loss decreased (-0.622210 --> -0.629617).  Saving model ...
Epoch: 49 cost time: 1.2075161933898926
Epoch: 49, Steps: 2 | Train Loss: 0.663 Vali Loss: 1.202 Vali Acc: 0.641 Test Loss: 1.202 Test Acc: 0.641
Validation loss decreased (-0.629617 --> -0.640729).  Saving model ...
Epoch: 50 cost time: 1.2888355255126953
Epoch: 50, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.180 Vali Acc: 0.648 Test Loss: 1.180 Test Acc: 0.648
Validation loss decreased (-0.640729 --> -0.648136).  Saving model ...
Epoch: 51 cost time: 1.251079797744751
Epoch: 51, Steps: 2 | Train Loss: 0.554 Vali Loss: 1.157 Vali Acc: 0.652 Test Loss: 1.157 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651840).  Saving model ...
Epoch: 52 cost time: 1.219677448272705
Epoch: 52, Steps: 2 | Train Loss: 0.533 Vali Loss: 1.133 Vali Acc: 0.663 Test Loss: 1.133 Test Acc: 0.663
Validation loss decreased (-0.651840 --> -0.662952).  Saving model ...
Epoch: 53 cost time: 1.1929144859313965
Epoch: 53, Steps: 2 | Train Loss: 0.523 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666656).  Saving model ...
Epoch: 54 cost time: 1.185384750366211
Epoch: 54, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.087 Vali Acc: 0.678 Test Loss: 1.087 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 55 cost time: 1.2758593559265137
Epoch: 55, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.064 Vali Acc: 0.678 Test Loss: 1.064 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 56 cost time: 1.1866211891174316
Epoch: 56, Steps: 2 | Train Loss: 0.442 Vali Loss: 1.040 Vali Acc: 0.685 Test Loss: 1.040 Test Acc: 0.685
Validation loss decreased (-0.677767 --> -0.685175).  Saving model ...
Epoch: 57 cost time: 1.3209254741668701
Epoch: 57, Steps: 2 | Train Loss: 0.387 Vali Loss: 1.015 Vali Acc: 0.693 Test Loss: 1.015 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692582).  Saving model ...
Epoch: 58 cost time: 1.3146016597747803
Epoch: 58, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.991 Vali Acc: 0.693 Test Loss: 0.991 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692583).  Saving model ...
Epoch: 59 cost time: 1.335242748260498
Epoch: 59, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.967 Vali Acc: 0.696 Test Loss: 0.967 Test Acc: 0.696
Validation loss decreased (-0.692583 --> -0.696287).  Saving model ...
Epoch: 60 cost time: 1.3524348735809326
Epoch: 60, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.696287 --> -0.699991).  Saving model ...
Epoch: 61 cost time: 1.2640645503997803
Epoch: 61, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.923 Vali Acc: 0.707 Test Loss: 0.923 Test Acc: 0.707
Validation loss decreased (-0.699991 --> -0.707398).  Saving model ...
Epoch: 62 cost time: 1.2018978595733643
Epoch: 62, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.902 Vali Acc: 0.711 Test Loss: 0.902 Test Acc: 0.711
Validation loss decreased (-0.707398 --> -0.711102).  Saving model ...
Epoch: 63 cost time: 1.2752749919891357
Epoch: 63, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 64 cost time: 1.1334078311920166
Epoch: 64, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.863 Vali Acc: 0.715 Test Loss: 0.863 Test Acc: 0.715
Validation loss decreased (-0.711102 --> -0.714806).  Saving model ...
Epoch: 65 cost time: 1.2896151542663574
Epoch: 65, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.844 Vali Acc: 0.719 Test Loss: 0.844 Test Acc: 0.719
Validation loss decreased (-0.714806 --> -0.718510).  Saving model ...
Epoch: 66 cost time: 1.1966283321380615
Epoch: 66, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
Validation loss decreased (-0.718510 --> -0.722214).  Saving model ...
Epoch: 67 cost time: 1.352970838546753
Epoch: 67, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.812 Vali Acc: 0.719 Test Loss: 0.812 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2520167827606201
Epoch: 68, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.798 Vali Acc: 0.733 Test Loss: 0.798 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 69 cost time: 1.1476569175720215
Epoch: 69, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 70 cost time: 1.202280044555664
Epoch: 70, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.774 Vali Acc: 0.744 Test Loss: 0.774 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 71 cost time: 1.345855951309204
Epoch: 71, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 72 cost time: 1.273773431777954
Epoch: 72, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 73 cost time: 1.0678012371063232
Epoch: 73, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.738 Vali Acc: 0.748 Test Loss: 0.738 Test Acc: 0.748
Validation loss decreased (-0.744437 --> -0.748141).  Saving model ...
Epoch: 74 cost time: 1.1693456172943115
Epoch: 74, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.725 Vali Acc: 0.752 Test Loss: 0.725 Test Acc: 0.752
Validation loss decreased (-0.748141 --> -0.751845).  Saving model ...
Epoch: 75 cost time: 1.377492904663086
Epoch: 75, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.715 Vali Acc: 0.752 Test Loss: 0.715 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 76 cost time: 1.2409460544586182
Epoch: 76, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.704 Vali Acc: 0.752 Test Loss: 0.704 Test Acc: 0.752
Validation loss decreased (-0.751845 --> -0.751845).  Saving model ...
Epoch: 77 cost time: 1.1993093490600586
Epoch: 77, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
Validation loss decreased (-0.751845 --> -0.755549).  Saving model ...
Epoch: 78 cost time: 1.046548843383789
Epoch: 78, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.685 Vali Acc: 0.759 Test Loss: 0.685 Test Acc: 0.759
Validation loss decreased (-0.755549 --> -0.759252).  Saving model ...
Epoch: 79 cost time: 1.1291594505310059
Epoch: 79, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
Validation loss decreased (-0.759252 --> -0.766660).  Saving model ...
Epoch: 80 cost time: 1.0306782722473145
Epoch: 80, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.665 Vali Acc: 0.774 Test Loss: 0.665 Test Acc: 0.774
Validation loss decreased (-0.766660 --> -0.774067).  Saving model ...
Epoch: 81 cost time: 1.257279872894287
Epoch: 81, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.656 Vali Acc: 0.778 Test Loss: 0.656 Test Acc: 0.778
Validation loss decreased (-0.774067 --> -0.777771).  Saving model ...
Epoch: 82 cost time: 1.3240656852722168
Epoch: 82, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 83 cost time: 1.3471598625183105
Epoch: 83, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.637 Vali Acc: 0.774 Test Loss: 0.637 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.306175947189331
Epoch: 84, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 85 cost time: 1.2242045402526855
Epoch: 85, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.620 Vali Acc: 0.785 Test Loss: 0.620 Test Acc: 0.785
Validation loss decreased (-0.777771 --> -0.785179).  Saving model ...
Epoch: 86 cost time: 1.1377301216125488
Epoch: 86, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.613 Vali Acc: 0.785 Test Loss: 0.613 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 87 cost time: 1.425347089767456
Epoch: 87, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.607 Vali Acc: 0.785 Test Loss: 0.607 Test Acc: 0.785
Validation loss decreased (-0.785179 --> -0.785179).  Saving model ...
Epoch: 88 cost time: 1.1776814460754395
Epoch: 88, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.600 Vali Acc: 0.793 Test Loss: 0.600 Test Acc: 0.793
Validation loss decreased (-0.785179 --> -0.792587).  Saving model ...
Epoch: 89 cost time: 1.2584972381591797
Epoch: 89, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.594 Vali Acc: 0.793 Test Loss: 0.594 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 90 cost time: 1.1736881732940674
Epoch: 90, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.586 Vali Acc: 0.793 Test Loss: 0.586 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 91 cost time: 1.0999274253845215
Epoch: 91, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.579 Vali Acc: 0.793 Test Loss: 0.579 Test Acc: 0.793
Validation loss decreased (-0.792587 --> -0.792587).  Saving model ...
Epoch: 92 cost time: 1.2013113498687744
Epoch: 92, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.792587 --> -0.796291).  Saving model ...
Epoch: 93 cost time: 1.4440159797668457
Epoch: 93, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.796291 --> -0.796291).  Saving model ...
Epoch: 94 cost time: 1.273331880569458
Epoch: 94, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
Validation loss decreased (-0.796291 --> -0.799994).  Saving model ...
Epoch: 95 cost time: 1.2111964225769043
Epoch: 95, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
Validation loss decreased (-0.799994 --> -0.803698).  Saving model ...
Epoch: 96 cost time: 0.9850306510925293
Epoch: 96, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.552 Vali Acc: 0.804 Test Loss: 0.552 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 97 cost time: 1.0890517234802246
Epoch: 97, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.548 Vali Acc: 0.804 Test Loss: 0.548 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 98 cost time: 1.1373038291931152
Epoch: 98, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
Validation loss decreased (-0.803698 --> -0.803698).  Saving model ...
Epoch: 99 cost time: 1.2640092372894287
Epoch: 99, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.541 Vali Acc: 0.811 Test Loss: 0.541 Test Acc: 0.811
Validation loss decreased (-0.803698 --> -0.811106).  Saving model ...
Epoch: 100 cost time: 1.3247268199920654
Epoch: 100, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.538 Vali Acc: 0.811 Test Loss: 0.538 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7150542736053467
Epoch: 1, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.909 Vali Acc: 0.081 Test Loss: 1.909 Test Acc: 0.081
Validation loss decreased (inf --> -0.081462).  Saving model ...
Epoch: 2 cost time: 1.487980842590332
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.904 Vali Acc: 0.081 Test Loss: 1.904 Test Acc: 0.081
Validation loss decreased (-0.081462 --> -0.081462).  Saving model ...
Epoch: 3 cost time: 1.1828267574310303
Epoch: 3, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.900 Vali Acc: 0.081 Test Loss: 1.900 Test Acc: 0.081
Validation loss decreased (-0.081462 --> -0.081462).  Saving model ...
Epoch: 4 cost time: 1.273859977722168
Epoch: 4, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.894 Vali Acc: 0.081 Test Loss: 1.894 Test Acc: 0.081
Validation loss decreased (-0.081462 --> -0.081463).  Saving model ...
Epoch: 5 cost time: 1.0864007472991943
Epoch: 5, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.887 Vali Acc: 0.081 Test Loss: 1.887 Test Acc: 0.081
Validation loss decreased (-0.081463 --> -0.081463).  Saving model ...
Epoch: 6 cost time: 1.1113159656524658
Epoch: 6, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.878 Vali Acc: 0.085 Test Loss: 1.878 Test Acc: 0.085
Validation loss decreased (-0.081463 --> -0.085166).  Saving model ...
Epoch: 7 cost time: 1.3508729934692383
Epoch: 7, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.869 Vali Acc: 0.085 Test Loss: 1.869 Test Acc: 0.085
Validation loss decreased (-0.085166 --> -0.085166).  Saving model ...
Epoch: 8 cost time: 1.1858570575714111
Epoch: 8, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.858 Vali Acc: 0.085 Test Loss: 1.858 Test Acc: 0.085
Validation loss decreased (-0.085166 --> -0.085167).  Saving model ...
Epoch: 9 cost time: 1.2796199321746826
Epoch: 9, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.845 Vali Acc: 0.089 Test Loss: 1.845 Test Acc: 0.089
Validation loss decreased (-0.085167 --> -0.088870).  Saving model ...
Epoch: 10 cost time: 1.1372907161712646
Epoch: 10, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.832 Vali Acc: 0.100 Test Loss: 1.832 Test Acc: 0.100
Validation loss decreased (-0.088870 --> -0.099982).  Saving model ...
Epoch: 11 cost time: 1.159235954284668
Epoch: 11, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.818 Vali Acc: 0.104 Test Loss: 1.818 Test Acc: 0.104
Validation loss decreased (-0.099982 --> -0.103686).  Saving model ...
Epoch: 12 cost time: 1.2011899948120117
Epoch: 12, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.803 Vali Acc: 0.115 Test Loss: 1.803 Test Acc: 0.115
Validation loss decreased (-0.103686 --> -0.114797).  Saving model ...
Epoch: 13 cost time: 1.2755234241485596
Epoch: 13, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.787 Vali Acc: 0.133 Test Loss: 1.787 Test Acc: 0.133
Validation loss decreased (-0.114797 --> -0.133315).  Saving model ...
Epoch: 14 cost time: 1.1956813335418701
Epoch: 14, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.770 Vali Acc: 0.152 Test Loss: 1.770 Test Acc: 0.152
Validation loss decreased (-0.133315 --> -0.151834).  Saving model ...
Epoch: 15 cost time: 1.1730153560638428
Epoch: 15, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.753 Vali Acc: 0.174 Test Loss: 1.753 Test Acc: 0.174
Validation loss decreased (-0.151834 --> -0.174057).  Saving model ...
Epoch: 16 cost time: 1.0322661399841309
Epoch: 16, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.735 Vali Acc: 0.185 Test Loss: 1.735 Test Acc: 0.185
Validation loss decreased (-0.174057 --> -0.185168).  Saving model ...
Epoch: 17 cost time: 1.1228172779083252
Epoch: 17, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.717 Vali Acc: 0.204 Test Loss: 1.717 Test Acc: 0.204
Validation loss decreased (-0.185168 --> -0.203687).  Saving model ...
Epoch: 18 cost time: 1.1881108283996582
Epoch: 18, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.697 Vali Acc: 0.237 Test Loss: 1.697 Test Acc: 0.237
Validation loss decreased (-0.203687 --> -0.237020).  Saving model ...
Epoch: 19 cost time: 1.1092426776885986
Epoch: 19, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.678 Vali Acc: 0.259 Test Loss: 1.678 Test Acc: 0.259
Validation loss decreased (-0.237020 --> -0.259242).  Saving model ...
Epoch: 20 cost time: 1.265937089920044
Epoch: 20, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.658 Vali Acc: 0.281 Test Loss: 1.658 Test Acc: 0.281
Validation loss decreased (-0.259242 --> -0.281465).  Saving model ...
Epoch: 21 cost time: 1.3005683422088623
Epoch: 21, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.636 Vali Acc: 0.348 Test Loss: 1.636 Test Acc: 0.348
Validation loss decreased (-0.281465 --> -0.348132).  Saving model ...
Epoch: 22 cost time: 1.1678898334503174
Epoch: 22, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.614 Vali Acc: 0.374 Test Loss: 1.614 Test Acc: 0.374
Validation loss decreased (-0.348132 --> -0.374058).  Saving model ...
Epoch: 23 cost time: 1.133612871170044
Epoch: 23, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.592 Vali Acc: 0.389 Test Loss: 1.592 Test Acc: 0.389
Validation loss decreased (-0.374058 --> -0.388873).  Saving model ...
Epoch: 24 cost time: 1.1456644535064697
Epoch: 24, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.569 Vali Acc: 0.419 Test Loss: 1.569 Test Acc: 0.419
Validation loss decreased (-0.388873 --> -0.418503).  Saving model ...
Epoch: 25 cost time: 1.2102596759796143
Epoch: 25, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.545 Vali Acc: 0.419 Test Loss: 1.545 Test Acc: 0.419
Validation loss decreased (-0.418503 --> -0.418503).  Saving model ...
Epoch: 26 cost time: 1.1908206939697266
Epoch: 26, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.520 Vali Acc: 0.437 Test Loss: 1.520 Test Acc: 0.437
Validation loss decreased (-0.418503 --> -0.437022).  Saving model ...
Epoch: 27 cost time: 1.2812252044677734
Epoch: 27, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.495 Vali Acc: 0.452 Test Loss: 1.495 Test Acc: 0.452
Validation loss decreased (-0.437022 --> -0.451837).  Saving model ...
Epoch: 28 cost time: 1.2272248268127441
Epoch: 28, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.470 Vali Acc: 0.467 Test Loss: 1.470 Test Acc: 0.467
Validation loss decreased (-0.451837 --> -0.466652).  Saving model ...
Epoch: 29 cost time: 1.0861566066741943
Epoch: 29, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
Validation loss decreased (-0.466652 --> -0.488874).  Saving model ...
Epoch: 30 cost time: 1.1905243396759033
Epoch: 30, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.417 Vali Acc: 0.504 Test Loss: 1.417 Test Acc: 0.504
Validation loss decreased (-0.488874 --> -0.503690).  Saving model ...
Epoch: 31 cost time: 1.2774052619934082
Epoch: 31, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.391 Vali Acc: 0.548 Test Loss: 1.391 Test Acc: 0.548
Validation loss decreased (-0.503690 --> -0.548134).  Saving model ...
Epoch: 32 cost time: 1.0811529159545898
Epoch: 32, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.364 Vali Acc: 0.570 Test Loss: 1.364 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570357).  Saving model ...
Epoch: 33 cost time: 1.2250990867614746
Epoch: 33, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.337 Vali Acc: 0.607 Test Loss: 1.337 Test Acc: 0.607
Validation loss decreased (-0.570357 --> -0.607394).  Saving model ...
Epoch: 34 cost time: 1.251929521560669
Epoch: 34, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.310 Vali Acc: 0.633 Test Loss: 1.310 Test Acc: 0.633
Validation loss decreased (-0.607394 --> -0.633320).  Saving model ...
Epoch: 35 cost time: 1.1031873226165771
Epoch: 35, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.283 Vali Acc: 0.659 Test Loss: 1.283 Test Acc: 0.659
Validation loss decreased (-0.633320 --> -0.659246).  Saving model ...
Epoch: 36 cost time: 1.1040294170379639
Epoch: 36, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.256 Vali Acc: 0.670 Test Loss: 1.256 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670358).  Saving model ...
Epoch: 37 cost time: 1.0183398723602295
Epoch: 37, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.228 Vali Acc: 0.696 Test Loss: 1.228 Test Acc: 0.696
Validation loss decreased (-0.670358 --> -0.696284).  Saving model ...
Epoch: 38 cost time: 1.1278963088989258
Epoch: 38, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.200 Vali Acc: 0.700 Test Loss: 1.200 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 39 cost time: 1.1460092067718506
Epoch: 39, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.172 Vali Acc: 0.715 Test Loss: 1.172 Test Acc: 0.715
Validation loss decreased (-0.699988 --> -0.714803).  Saving model ...
Epoch: 40 cost time: 1.1344709396362305
Epoch: 40, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.145 Vali Acc: 0.719 Test Loss: 1.145 Test Acc: 0.719
Validation loss decreased (-0.714803 --> -0.718507).  Saving model ...
Epoch: 41 cost time: 1.0960838794708252
Epoch: 41, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.118 Vali Acc: 0.719 Test Loss: 1.118 Test Acc: 0.719
Validation loss decreased (-0.718507 --> -0.718507).  Saving model ...
Epoch: 42 cost time: 1.1101100444793701
Epoch: 42, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.092 Vali Acc: 0.722 Test Loss: 1.092 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 43 cost time: 1.0067787170410156
Epoch: 43, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.065 Vali Acc: 0.730 Test Loss: 1.065 Test Acc: 0.730
Validation loss decreased (-0.722211 --> -0.729619).  Saving model ...
Epoch: 44 cost time: 1.1480448246002197
Epoch: 44, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.038 Vali Acc: 0.733 Test Loss: 1.038 Test Acc: 0.733
Validation loss decreased (-0.729619 --> -0.733323).  Saving model ...
Epoch: 45 cost time: 1.1058998107910156
Epoch: 45, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.011 Vali Acc: 0.733 Test Loss: 1.011 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 46 cost time: 1.1117515563964844
Epoch: 46, Steps: 2 | Train Loss: 1.033 Vali Loss: 0.985 Vali Acc: 0.737 Test Loss: 0.985 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.737027).  Saving model ...
Epoch: 47 cost time: 1.239356279373169
Epoch: 47, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.959 Vali Acc: 0.752 Test Loss: 0.959 Test Acc: 0.752
Validation loss decreased (-0.737027 --> -0.751842).  Saving model ...
Epoch: 48 cost time: 1.2083837985992432
Epoch: 48, Steps: 2 | Train Loss: 1.005 Vali Loss: 0.933 Vali Acc: 0.763 Test Loss: 0.933 Test Acc: 0.763
Validation loss decreased (-0.751842 --> -0.762954).  Saving model ...
Epoch: 49 cost time: 1.0994720458984375
Epoch: 49, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.906 Vali Acc: 0.763 Test Loss: 0.906 Test Acc: 0.763
Validation loss decreased (-0.762954 --> -0.762954).  Saving model ...
Epoch: 50 cost time: 1.2393136024475098
Epoch: 50, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.880 Vali Acc: 0.770 Test Loss: 0.880 Test Acc: 0.770
Validation loss decreased (-0.762954 --> -0.770362).  Saving model ...
Epoch: 51 cost time: 1.0773870944976807
Epoch: 51, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.854 Vali Acc: 0.774 Test Loss: 0.854 Test Acc: 0.774
Validation loss decreased (-0.770362 --> -0.774066).  Saving model ...
Epoch: 52 cost time: 1.186471700668335
Epoch: 52, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.828 Vali Acc: 0.778 Test Loss: 0.828 Test Acc: 0.778
Validation loss decreased (-0.774066 --> -0.777770).  Saving model ...
Epoch: 53 cost time: 1.046729326248169
Epoch: 53, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.802 Vali Acc: 0.785 Test Loss: 0.802 Test Acc: 0.785
Validation loss decreased (-0.777770 --> -0.785177).  Saving model ...
Epoch: 54 cost time: 1.283013105392456
Epoch: 54, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.776 Vali Acc: 0.785 Test Loss: 0.776 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785177).  Saving model ...
Epoch: 55 cost time: 1.3605144023895264
Epoch: 55, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.751 Vali Acc: 0.785 Test Loss: 0.751 Test Acc: 0.785
Validation loss decreased (-0.785177 --> -0.785178).  Saving model ...
Epoch: 56 cost time: 1.1669437885284424
Epoch: 56, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.785178 --> -0.799993).  Saving model ...
Epoch: 57 cost time: 1.0850520133972168
Epoch: 57, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.701 Vali Acc: 0.807 Test Loss: 0.701 Test Acc: 0.807
Validation loss decreased (-0.799993 --> -0.807400).  Saving model ...
Epoch: 58 cost time: 1.0784897804260254
Epoch: 58, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.679 Vali Acc: 0.815 Test Loss: 0.679 Test Acc: 0.815
Validation loss decreased (-0.807400 --> -0.814808).  Saving model ...
Epoch: 59 cost time: 1.3375136852264404
Epoch: 59, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 60 cost time: 1.1560990810394287
Epoch: 60, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 61 cost time: 1.0659160614013672
Epoch: 61, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.614 Vali Acc: 0.830 Test Loss: 0.614 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829623).  Saving model ...
Epoch: 62 cost time: 1.2039589881896973
Epoch: 62, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.594 Vali Acc: 0.830 Test Loss: 0.594 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829624).  Saving model ...
Epoch: 63 cost time: 1.2667043209075928
Epoch: 63, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
Validation loss decreased (-0.829624 --> -0.844439).  Saving model ...
Epoch: 64 cost time: 1.2161288261413574
Epoch: 64, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.556 Vali Acc: 0.852 Test Loss: 0.556 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851846).  Saving model ...
Epoch: 65 cost time: 1.096466302871704
Epoch: 65, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 66 cost time: 1.1407761573791504
Epoch: 66, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 67 cost time: 1.1836838722229004
Epoch: 67, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 68 cost time: 1.2677099704742432
Epoch: 68, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.4110982418060303
Epoch: 69, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3708159923553467
Epoch: 70, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2208483219146729
Epoch: 71, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.444 Vali Acc: 0.856 Test Loss: 0.444 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.2735004425048828
Epoch: 72, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.289818286895752
Epoch: 73, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.2654094696044922
Epoch: 74, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.406 Vali Acc: 0.859 Test Loss: 0.406 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.275019645690918
Epoch: 75, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.396 Vali Acc: 0.863 Test Loss: 0.396 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.254732370376587
Epoch: 76, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.385 Vali Acc: 0.863 Test Loss: 0.385 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.3225598335266113
Epoch: 77, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870367).  Saving model ...
Epoch: 78 cost time: 0.9758200645446777
Epoch: 78, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
Validation loss decreased (-0.870367 --> -0.877774).  Saving model ...
Epoch: 79 cost time: 1.223222255706787
Epoch: 79, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 80 cost time: 1.0827913284301758
Epoch: 80, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.341 Vali Acc: 0.885 Test Loss: 0.341 Test Acc: 0.885
Validation loss decreased (-0.877774 --> -0.885182).  Saving model ...
Epoch: 81 cost time: 1.135819911956787
Epoch: 81, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.331 Vali Acc: 0.893 Test Loss: 0.331 Test Acc: 0.893
Validation loss decreased (-0.885182 --> -0.892589).  Saving model ...
Epoch: 82 cost time: 1.127406358718872
Epoch: 82, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.321 Vali Acc: 0.904 Test Loss: 0.321 Test Acc: 0.904
Validation loss decreased (-0.892589 --> -0.903700).  Saving model ...
Epoch: 83 cost time: 1.0726191997528076
Epoch: 83, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.312 Vali Acc: 0.907 Test Loss: 0.312 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 84 cost time: 1.0880365371704102
Epoch: 84, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 85 cost time: 1.1378803253173828
Epoch: 85, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.299 Vali Acc: 0.915 Test Loss: 0.299 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 86 cost time: 1.0858700275421143
Epoch: 86, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.295 Vali Acc: 0.907 Test Loss: 0.295 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.108940839767456
Epoch: 87, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.293 Vali Acc: 0.907 Test Loss: 0.293 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.1461634635925293
Epoch: 88, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.290 Vali Acc: 0.904 Test Loss: 0.290 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.1934430599212646
Epoch: 89, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.287 Vali Acc: 0.904 Test Loss: 0.287 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.2462141513824463
Epoch: 90, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.214125394821167
Epoch: 91, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.0922634601593018
Epoch: 92, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.1938304901123047
Epoch: 93, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.0253877639770508
Epoch: 94, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 1.1342599391937256
Epoch: 95, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7383694648742676
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.872 Vali Acc: 0.133 Test Loss: 1.872 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.177278995513916
Epoch: 2, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.868 Vali Acc: 0.137 Test Loss: 1.868 Test Acc: 0.137
Validation loss decreased (-0.133315 --> -0.137018).  Saving model ...
Epoch: 3 cost time: 1.274637222290039
Epoch: 3, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.864 Vali Acc: 0.137 Test Loss: 1.864 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137018).  Saving model ...
Epoch: 4 cost time: 1.1205990314483643
Epoch: 4, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.859 Vali Acc: 0.141 Test Loss: 1.859 Test Acc: 0.141
Validation loss decreased (-0.137018 --> -0.140722).  Saving model ...
Epoch: 5 cost time: 1.1886632442474365
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.852 Vali Acc: 0.144 Test Loss: 1.852 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 1.3343350887298584
Epoch: 6, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.843 Vali Acc: 0.148 Test Loss: 1.843 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 7 cost time: 1.0229833126068115
Epoch: 7, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.833 Vali Acc: 0.159 Test Loss: 1.833 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 8 cost time: 1.0571978092193604
Epoch: 8, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.822 Vali Acc: 0.167 Test Loss: 1.822 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 9 cost time: 1.0846762657165527
Epoch: 9, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.810 Vali Acc: 0.174 Test Loss: 1.810 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174056).  Saving model ...
Epoch: 10 cost time: 1.0271713733673096
Epoch: 10, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.797 Vali Acc: 0.181 Test Loss: 1.797 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 11 cost time: 1.0802783966064453
Epoch: 11, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.783 Vali Acc: 0.200 Test Loss: 1.783 Test Acc: 0.200
Validation loss decreased (-0.181464 --> -0.199982).  Saving model ...
Epoch: 12 cost time: 1.131584644317627
Epoch: 12, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.769 Vali Acc: 0.211 Test Loss: 1.769 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 13 cost time: 1.2573802471160889
Epoch: 13, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.753 Vali Acc: 0.233 Test Loss: 1.753 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233316).  Saving model ...
Epoch: 14 cost time: 1.1110975742340088
Epoch: 14, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.737 Vali Acc: 0.256 Test Loss: 1.737 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255538).  Saving model ...
Epoch: 15 cost time: 1.1404163837432861
Epoch: 15, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.720 Vali Acc: 0.274 Test Loss: 1.720 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 16 cost time: 1.1603128910064697
Epoch: 16, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.703 Vali Acc: 0.300 Test Loss: 1.703 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 17 cost time: 1.3101534843444824
Epoch: 17, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.684 Vali Acc: 0.326 Test Loss: 1.684 Test Acc: 0.326
Validation loss decreased (-0.299983 --> -0.325909).  Saving model ...
Epoch: 18 cost time: 1.2246315479278564
Epoch: 18, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.665 Vali Acc: 0.356 Test Loss: 1.665 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 19 cost time: 1.301274061203003
Epoch: 19, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.645 Vali Acc: 0.381 Test Loss: 1.645 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 20 cost time: 1.2633953094482422
Epoch: 20, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.625 Vali Acc: 0.393 Test Loss: 1.625 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392576).  Saving model ...
Epoch: 21 cost time: 1.1623752117156982
Epoch: 21, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.604 Vali Acc: 0.419 Test Loss: 1.604 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 22 cost time: 1.1921167373657227
Epoch: 22, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.582 Vali Acc: 0.441 Test Loss: 1.582 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 23 cost time: 1.2997870445251465
Epoch: 23, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.559 Vali Acc: 0.467 Test Loss: 1.559 Test Acc: 0.467
Validation loss decreased (-0.440725 --> -0.466651).  Saving model ...
Epoch: 24 cost time: 1.1478393077850342
Epoch: 24, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.536 Vali Acc: 0.474 Test Loss: 1.536 Test Acc: 0.474
Validation loss decreased (-0.466651 --> -0.474059).  Saving model ...
Epoch: 25 cost time: 1.3616290092468262
Epoch: 25, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
Validation loss decreased (-0.474059 --> -0.499985).  Saving model ...
Epoch: 26 cost time: 1.2470543384552002
Epoch: 26, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.489 Vali Acc: 0.515 Test Loss: 1.489 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 27 cost time: 1.0706045627593994
Epoch: 27, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.465 Vali Acc: 0.530 Test Loss: 1.465 Test Acc: 0.530
Validation loss decreased (-0.514800 --> -0.529615).  Saving model ...
Epoch: 28 cost time: 1.222639560699463
Epoch: 28, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.440 Vali Acc: 0.556 Test Loss: 1.440 Test Acc: 0.556
Validation loss decreased (-0.529615 --> -0.555541).  Saving model ...
Epoch: 29 cost time: 1.1299076080322266
Epoch: 29, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.414 Vali Acc: 0.581 Test Loss: 1.414 Test Acc: 0.581
Validation loss decreased (-0.555541 --> -0.581467).  Saving model ...
Epoch: 30 cost time: 1.116365909576416
Epoch: 30, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.388 Vali Acc: 0.593 Test Loss: 1.388 Test Acc: 0.593
Validation loss decreased (-0.581467 --> -0.592579).  Saving model ...
Epoch: 31 cost time: 1.1375977993011475
Epoch: 31, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.361 Vali Acc: 0.619 Test Loss: 1.361 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618505).  Saving model ...
Epoch: 32 cost time: 1.114107370376587
Epoch: 32, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.334 Vali Acc: 0.630 Test Loss: 1.334 Test Acc: 0.630
Validation loss decreased (-0.618505 --> -0.629616).  Saving model ...
Epoch: 33 cost time: 1.1728649139404297
Epoch: 33, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.307 Vali Acc: 0.633 Test Loss: 1.307 Test Acc: 0.633
Validation loss decreased (-0.629616 --> -0.633320).  Saving model ...
Epoch: 34 cost time: 1.0882878303527832
Epoch: 34, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.280 Vali Acc: 0.652 Test Loss: 1.280 Test Acc: 0.652
Validation loss decreased (-0.633320 --> -0.651839).  Saving model ...
Epoch: 35 cost time: 1.2134315967559814
Epoch: 35, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.253 Vali Acc: 0.681 Test Loss: 1.253 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681469).  Saving model ...
Epoch: 36 cost time: 1.0993921756744385
Epoch: 36, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.225 Vali Acc: 0.689 Test Loss: 1.225 Test Acc: 0.689
Validation loss decreased (-0.681469 --> -0.688877).  Saving model ...
Epoch: 37 cost time: 1.2161071300506592
Epoch: 37, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.198 Vali Acc: 0.696 Test Loss: 1.198 Test Acc: 0.696
Validation loss decreased (-0.688877 --> -0.696284).  Saving model ...
Epoch: 38 cost time: 1.3047494888305664
Epoch: 38, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.172 Vali Acc: 0.711 Test Loss: 1.172 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711099).  Saving model ...
Epoch: 39 cost time: 1.0946040153503418
Epoch: 39, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.145 Vali Acc: 0.730 Test Loss: 1.145 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729618).  Saving model ...
Epoch: 40 cost time: 1.2101390361785889
Epoch: 40, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.118 Vali Acc: 0.741 Test Loss: 1.118 Test Acc: 0.741
Validation loss decreased (-0.729618 --> -0.740730).  Saving model ...
Epoch: 41 cost time: 1.04695463180542
Epoch: 41, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.091 Vali Acc: 0.744 Test Loss: 1.091 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744434).  Saving model ...
Epoch: 42 cost time: 1.3170769214630127
Epoch: 42, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.063 Vali Acc: 0.756 Test Loss: 1.063 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755545).  Saving model ...
Epoch: 43 cost time: 1.1894066333770752
Epoch: 43, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.035 Vali Acc: 0.763 Test Loss: 1.035 Test Acc: 0.763
Validation loss decreased (-0.755545 --> -0.762953).  Saving model ...
Epoch: 44 cost time: 1.3657293319702148
Epoch: 44, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.007 Vali Acc: 0.763 Test Loss: 1.007 Test Acc: 0.763
Validation loss decreased (-0.762953 --> -0.762953).  Saving model ...
Epoch: 45 cost time: 1.078749656677246
Epoch: 45, Steps: 2 | Train Loss: 1.123 Vali Loss: 0.979 Vali Acc: 0.770 Test Loss: 0.979 Test Acc: 0.770
Validation loss decreased (-0.762953 --> -0.770361).  Saving model ...
Epoch: 46 cost time: 1.3826904296875
Epoch: 46, Steps: 2 | Train Loss: 1.151 Vali Loss: 0.952 Vali Acc: 0.781 Test Loss: 0.952 Test Acc: 0.781
Validation loss decreased (-0.770361 --> -0.781472).  Saving model ...
Epoch: 47 cost time: 1.137082576751709
Epoch: 47, Steps: 2 | Train Loss: 1.129 Vali Loss: 0.924 Vali Acc: 0.781 Test Loss: 0.924 Test Acc: 0.781
Validation loss decreased (-0.781472 --> -0.781472).  Saving model ...
Epoch: 48 cost time: 1.2358953952789307
Epoch: 48, Steps: 2 | Train Loss: 1.106 Vali Loss: 0.897 Vali Acc: 0.785 Test Loss: 0.897 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 49 cost time: 1.1696436405181885
Epoch: 49, Steps: 2 | Train Loss: 1.087 Vali Loss: 0.870 Vali Acc: 0.789 Test Loss: 0.870 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 50 cost time: 1.2253913879394531
Epoch: 50, Steps: 2 | Train Loss: 1.025 Vali Loss: 0.844 Vali Acc: 0.796 Test Loss: 0.844 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796288).  Saving model ...
Epoch: 51 cost time: 1.3102672100067139
Epoch: 51, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.817 Vali Acc: 0.804 Test Loss: 0.817 Test Acc: 0.804
Validation loss decreased (-0.796288 --> -0.803696).  Saving model ...
Epoch: 52 cost time: 1.1935145854949951
Epoch: 52, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.792 Vali Acc: 0.807 Test Loss: 0.792 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807399).  Saving model ...
Epoch: 53 cost time: 1.3823907375335693
Epoch: 53, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3177919387817383
Epoch: 54, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.743 Vali Acc: 0.807 Test Loss: 0.743 Test Acc: 0.807
Validation loss decreased (-0.807399 --> -0.807400).  Saving model ...
Epoch: 55 cost time: 1.1194813251495361
Epoch: 55, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0127720832824707
Epoch: 56, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.283484697341919
Epoch: 57, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.4581992626190186
Epoch: 58, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.650 Vali Acc: 0.800 Test Loss: 0.650 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.325326681137085
Epoch: 59, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.627 Vali Acc: 0.815 Test Loss: 0.627 Test Acc: 0.815
Validation loss decreased (-0.807400 --> -0.814809).  Saving model ...
Epoch: 60 cost time: 1.201859712600708
Epoch: 60, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.814809 --> -0.818512).  Saving model ...
Epoch: 61 cost time: 1.339376449584961
Epoch: 61, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 62 cost time: 1.158266305923462
Epoch: 62, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2613823413848877
Epoch: 63, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.3500113487243652
Epoch: 64, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.526 Vali Acc: 0.830 Test Loss: 0.526 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829624).  Saving model ...
Epoch: 65 cost time: 1.1828234195709229
Epoch: 65, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.829624 --> -0.840736).  Saving model ...
Epoch: 66 cost time: 1.1459081172943115
Epoch: 66, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.491 Vali Acc: 0.830 Test Loss: 0.491 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.116852045059204
Epoch: 67, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.2405891418457031
Epoch: 68, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.466 Vali Acc: 0.830 Test Loss: 0.466 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1272923946380615
Epoch: 69, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.455 Vali Acc: 0.830 Test Loss: 0.455 Test Acc: 0.830
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1339669227600098
Epoch: 70, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.444 Vali Acc: 0.830 Test Loss: 0.444 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.2805728912353516
Epoch: 71, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.431 Vali Acc: 0.830 Test Loss: 0.431 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2345786094665527
Epoch: 72, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 73 cost time: 1.1606791019439697
Epoch: 73, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.406 Vali Acc: 0.852 Test Loss: 0.406 Test Acc: 0.852
Validation loss decreased (-0.844440 --> -0.851848).  Saving model ...
Epoch: 74 cost time: 1.166454792022705
Epoch: 74, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
Validation loss decreased (-0.851848 --> -0.855552).  Saving model ...
Epoch: 75 cost time: 1.2755625247955322
Epoch: 75, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.384 Vali Acc: 0.859 Test Loss: 0.384 Test Acc: 0.859
Validation loss decreased (-0.855552 --> -0.859255).  Saving model ...
Epoch: 76 cost time: 1.2248327732086182
Epoch: 76, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.373 Vali Acc: 0.874 Test Loss: 0.373 Test Acc: 0.874
Validation loss decreased (-0.859255 --> -0.874070).  Saving model ...
Epoch: 77 cost time: 1.3410992622375488
Epoch: 77, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 78 cost time: 1.2141973972320557
Epoch: 78, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.357 Vali Acc: 0.881 Test Loss: 0.357 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 79 cost time: 1.1403372287750244
Epoch: 79, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 80 cost time: 1.2746400833129883
Epoch: 80, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2163569927215576
Epoch: 81, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.3240675926208496
Epoch: 82, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.870 Test Loss: 0.341 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.2647199630737305
Epoch: 83, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.2441487312316895
Epoch: 84, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.1973395347595215
Epoch: 85, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.333 Vali Acc: 0.859 Test Loss: 0.333 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.3862221240997314
Epoch: 86, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.3008296489715576
Epoch: 87, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.330 Vali Acc: 0.863 Test Loss: 0.330 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.186046838760376
Epoch: 88, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.323 Vali Acc: 0.870 Test Loss: 0.323 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 1.3907012939453125
Epoch: 89, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.315 Vali Acc: 0.874 Test Loss: 0.315 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 71782
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
 fourier enhanced cross attention used!
modes_q=16, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
>>>>>>>start training : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9747660160064697
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1050829887390137
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1450932025909424
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.148482322692871
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2023894786834717
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 1.1970398426055908
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0681586265563965
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 8 cost time: 1.2634477615356445
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2646420001983643
Epoch: 9, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1582090854644775
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1554622650146484
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 12 cost time: 1.0307650566101074
Epoch: 12, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.1962671279907227
Epoch: 13, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.249927282333374
Epoch: 14, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 15 cost time: 1.1703708171844482
Epoch: 15, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.304758071899414
Epoch: 16, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 17 cost time: 1.1404414176940918
Epoch: 17, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 18 cost time: 1.2116804122924805
Epoch: 18, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 19 cost time: 1.2365210056304932
Epoch: 19, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 20 cost time: 1.0794422626495361
Epoch: 20, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0999219417572021
Epoch: 21, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2736797332763672
Epoch: 22, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.264197826385498
Epoch: 23, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1338558197021484
Epoch: 24, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1761953830718994
Epoch: 25, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 26 cost time: 1.1152441501617432
Epoch: 26, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 27 cost time: 1.0415427684783936
Epoch: 27, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0787134170532227
Epoch: 28, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 29 cost time: 1.2705628871917725
Epoch: 29, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 30 cost time: 1.3157341480255127
Epoch: 30, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2147517204284668
Epoch: 31, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 32 cost time: 1.041031837463379
Epoch: 32, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1590704917907715
Epoch: 33, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 34 cost time: 1.241481065750122
Epoch: 34, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 35 cost time: 1.2141683101654053
Epoch: 35, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 36 cost time: 1.2456731796264648
Epoch: 36, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 37 cost time: 1.176980972290039
Epoch: 37, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 38 cost time: 1.2101099491119385
Epoch: 38, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2347748279571533
Epoch: 39, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4639801979064941
Epoch: 40, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2062244415283203
Epoch: 41, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 42 cost time: 1.1837718486785889
Epoch: 42, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3823652267456055
Epoch: 43, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2608556747436523
Epoch: 44, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2651097774505615
Epoch: 45, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.209080696105957
Epoch: 46, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 47 cost time: 1.2330012321472168
Epoch: 47, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.333522081375122
Epoch: 48, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1217358112335205
Epoch: 49, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 50 cost time: 1.0765492916107178
Epoch: 50, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.181736707687378
Epoch: 51, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 52 cost time: 1.1268575191497803
Epoch: 52, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.212235689163208
Epoch: 53, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 54 cost time: 1.1563642024993896
Epoch: 54, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 55 cost time: 1.032344102859497
Epoch: 55, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1402537822723389
Epoch: 56, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 57 cost time: 1.2161955833435059
Epoch: 57, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2665023803710938
Epoch: 58, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 59 cost time: 1.1576802730560303
Epoch: 59, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 60 cost time: 1.0784287452697754
Epoch: 60, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2296135425567627
Epoch: 61, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.196977138519287
Epoch: 62, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.266179084777832
Epoch: 63, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.111504077911377
Epoch: 64, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.274740219116211
Epoch: 65, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 66 cost time: 1.165215015411377
Epoch: 66, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 67 cost time: 1.2524983882904053
Epoch: 67, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 68 cost time: 1.3598778247833252
Epoch: 68, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1840145587921143
Epoch: 69, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 70 cost time: 1.1869921684265137
Epoch: 70, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 71 cost time: 1.0284593105316162
Epoch: 71, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.070758581161499
Epoch: 72, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 73 cost time: 1.1070780754089355
Epoch: 73, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 74 cost time: 1.1996960639953613
Epoch: 74, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 75 cost time: 1.2942707538604736
Epoch: 75, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 76 cost time: 1.1056041717529297
Epoch: 76, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 77 cost time: 1.041398525238037
Epoch: 77, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 78 cost time: 1.042999029159546
Epoch: 78, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 79 cost time: 1.1135220527648926
Epoch: 79, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 80 cost time: 1.1935131549835205
Epoch: 80, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 81 cost time: 1.1766026020050049
Epoch: 81, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 82 cost time: 1.1242785453796387
Epoch: 82, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 83 cost time: 1.116816759109497
Epoch: 83, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 84 cost time: 1.1168725490570068
Epoch: 84, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 85 cost time: 1.2044100761413574
Epoch: 85, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.302901029586792
Epoch: 86, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 87 cost time: 1.1958625316619873
Epoch: 87, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 88 cost time: 1.1067440509796143
Epoch: 88, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.2298290729522705
Epoch: 89, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 90 cost time: 1.1931121349334717
Epoch: 90, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.216036081314087
Epoch: 91, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.1802928447723389
Epoch: 92, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.1551744937896729
Epoch: 93, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 94 cost time: 1.0298492908477783
Epoch: 94, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1921486854553223
Epoch: 95, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.1679916381835938
Epoch: 96, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.1374516487121582
Epoch: 97, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 1.0408401489257812
Epoch: 98, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 1.0585715770721436
Epoch: 99, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 1.1631269454956055
Epoch: 100, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.792 Vali Acc: 0.167 Test Loss: 1.792 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_FEDformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.16666666666666666
model parameter : 71782
model size : 1.52MB
