Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 86.18622064590454
Epoch: 1, Steps: 17 | Train Loss: 2.101 Vali Loss: 2.801 Vali Acc: 0.251 Test Loss: 2.801 Test Acc: 0.251
Validation loss decreased (inf --> -0.250923).  Saving model ...
Epoch: 2 cost time: 84.68933963775635
Epoch: 2, Steps: 17 | Train Loss: 2.955 Vali Loss: 3.254 Vali Acc: 0.293 Test Loss: 3.254 Test Acc: 0.293
Validation loss decreased (-0.250923 --> -0.292743).  Saving model ...
Epoch: 3 cost time: 77.68986988067627
Epoch: 3, Steps: 17 | Train Loss: 2.960 Vali Loss: 6.587 Vali Acc: 0.262 Test Loss: 6.587 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 83.05871891975403
Epoch: 4, Steps: 17 | Train Loss: 4.328 Vali Loss: 4.354 Vali Acc: 0.270 Test Loss: 4.354 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 76.62398409843445
Epoch: 5, Steps: 17 | Train Loss: 2.416 Vali Loss: 5.081 Vali Acc: 0.247 Test Loss: 5.081 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 88.33403086662292
Epoch: 6, Steps: 17 | Train Loss: 2.502 Vali Loss: 6.044 Vali Acc: 0.251 Test Loss: 6.044 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 84.65625357627869
Epoch: 7, Steps: 17 | Train Loss: 2.570 Vali Loss: 11.222 Vali Acc: 0.255 Test Loss: 11.222 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 84.69021606445312
Epoch: 8, Steps: 17 | Train Loss: 3.411 Vali Loss: 6.747 Vali Acc: 0.251 Test Loss: 6.747 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 83.9182538986206
Epoch: 9, Steps: 17 | Train Loss: 2.754 Vali Loss: 9.419 Vali Acc: 0.281 Test Loss: 9.419 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 79.70315194129944
Epoch: 10, Steps: 17 | Train Loss: 3.115 Vali Loss: 11.080 Vali Acc: 0.262 Test Loss: 11.080 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 78.5158383846283
Epoch: 11, Steps: 17 | Train Loss: 2.793 Vali Loss: 12.214 Vali Acc: 0.259 Test Loss: 12.214 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 83.231036901474
Epoch: 12, Steps: 17 | Train Loss: 3.155 Vali Loss: 14.595 Vali Acc: 0.224 Test Loss: 14.595 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 69.78476929664612
Epoch: 1, Steps: 17 | Train Loss: 2.050 Vali Loss: 2.584 Vali Acc: 0.243 Test Loss: 2.584 Test Acc: 0.243
Validation loss decreased (inf --> -0.243320).  Saving model ...
Epoch: 2 cost time: 61.89962720870972
Epoch: 2, Steps: 17 | Train Loss: 2.374 Vali Loss: 3.286 Vali Acc: 0.240 Test Loss: 3.286 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 70.26114439964294
Epoch: 3, Steps: 17 | Train Loss: 2.596 Vali Loss: 6.600 Vali Acc: 0.285 Test Loss: 6.600 Test Acc: 0.285
Validation loss decreased (-0.243320 --> -0.285105).  Saving model ...
Epoch: 4 cost time: 67.14737701416016
Epoch: 4, Steps: 17 | Train Loss: 3.570 Vali Loss: 4.245 Vali Acc: 0.274 Test Loss: 4.245 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 78.86955857276917
Epoch: 5, Steps: 17 | Train Loss: 3.697 Vali Loss: 5.063 Vali Acc: 0.285 Test Loss: 5.063 Test Acc: 0.285
Validation loss decreased (-0.285105 --> -0.285120).  Saving model ...
Epoch: 6 cost time: 56.89927268028259
Epoch: 6, Steps: 17 | Train Loss: 3.229 Vali Loss: 7.820 Vali Acc: 0.247 Test Loss: 7.820 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 60.809380531311035
Epoch: 7, Steps: 17 | Train Loss: 2.488 Vali Loss: 9.714 Vali Acc: 0.274 Test Loss: 9.714 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 69.77887964248657
Epoch: 8, Steps: 17 | Train Loss: 3.399 Vali Loss: 6.830 Vali Acc: 0.281 Test Loss: 6.830 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 67.63077425956726
Epoch: 9, Steps: 17 | Train Loss: 4.681 Vali Loss: 9.487 Vali Acc: 0.266 Test Loss: 9.487 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 71.07745146751404
Epoch: 10, Steps: 17 | Train Loss: 3.033 Vali Loss: 8.411 Vali Acc: 0.262 Test Loss: 8.411 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 65.58631634712219
Epoch: 11, Steps: 17 | Train Loss: 3.819 Vali Loss: 11.711 Vali Acc: 0.224 Test Loss: 11.711 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 62.25766205787659
Epoch: 12, Steps: 17 | Train Loss: 2.899 Vali Loss: 10.150 Vali Acc: 0.255 Test Loss: 10.150 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 62.23624396324158
Epoch: 13, Steps: 17 | Train Loss: 2.780 Vali Loss: 8.426 Vali Acc: 0.266 Test Loss: 8.426 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 68.7407488822937
Epoch: 14, Steps: 17 | Train Loss: 2.253 Vali Loss: 8.435 Vali Acc: 0.262 Test Loss: 8.435 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 62.91352415084839
Epoch: 15, Steps: 17 | Train Loss: 1.629 Vali Loss: 18.269 Vali Acc: 0.255 Test Loss: 18.269 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 63.78235650062561
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 4.424 Vali Acc: 0.236 Test Loss: 4.424 Test Acc: 0.236
Validation loss decreased (inf --> -0.235697).  Saving model ...
Epoch: 2 cost time: 62.60373282432556
Epoch: 2, Steps: 17 | Train Loss: 2.914 Vali Loss: 4.914 Vali Acc: 0.224 Test Loss: 4.914 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 56.48723220825195
Epoch: 3, Steps: 17 | Train Loss: 3.714 Vali Loss: 7.400 Vali Acc: 0.247 Test Loss: 7.400 Test Acc: 0.247
Validation loss decreased (-0.235697 --> -0.247074).  Saving model ...
Epoch: 4 cost time: 65.56200313568115
Epoch: 4, Steps: 17 | Train Loss: 3.741 Vali Loss: 5.625 Vali Acc: 0.274 Test Loss: 5.625 Test Acc: 0.274
Validation loss decreased (-0.247074 --> -0.273708).  Saving model ...
Epoch: 5 cost time: 60.115429162979126
Epoch: 5, Steps: 17 | Train Loss: 3.097 Vali Loss: 7.764 Vali Acc: 0.278 Test Loss: 7.764 Test Acc: 0.278
Validation loss decreased (-0.273708 --> -0.277489).  Saving model ...
Epoch: 6 cost time: 57.8691771030426
Epoch: 6, Steps: 17 | Train Loss: 4.518 Vali Loss: 8.626 Vali Acc: 0.243 Test Loss: 8.626 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 58.40331268310547
Epoch: 7, Steps: 17 | Train Loss: 3.293 Vali Loss: 8.647 Vali Acc: 0.266 Test Loss: 8.647 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 59.06552028656006
Epoch: 8, Steps: 17 | Train Loss: 2.262 Vali Loss: 7.066 Vali Acc: 0.232 Test Loss: 7.066 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 58.828126192092896
Epoch: 9, Steps: 17 | Train Loss: 3.369 Vali Loss: 10.829 Vali Acc: 0.255 Test Loss: 10.829 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 53.796894550323486
Epoch: 10, Steps: 17 | Train Loss: 2.449 Vali Loss: 12.921 Vali Acc: 0.243 Test Loss: 12.921 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 56.4804573059082
Epoch: 11, Steps: 17 | Train Loss: 3.320 Vali Loss: 20.049 Vali Acc: 0.221 Test Loss: 20.049 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 50.25314283370972
Epoch: 12, Steps: 17 | Train Loss: 2.273 Vali Loss: 14.182 Vali Acc: 0.247 Test Loss: 14.182 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 58.73597002029419
Epoch: 13, Steps: 17 | Train Loss: 2.568 Vali Loss: 14.352 Vali Acc: 0.274 Test Loss: 14.352 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 57.47532105445862
Epoch: 14, Steps: 17 | Train Loss: 3.002 Vali Loss: 16.364 Vali Acc: 0.221 Test Loss: 16.364 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 61.85991859436035
Epoch: 15, Steps: 17 | Train Loss: 2.189 Vali Loss: 21.983 Vali Acc: 0.255 Test Loss: 21.983 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 50.64784002304077
Epoch: 1, Steps: 17 | Train Loss: 1.952 Vali Loss: 4.490 Vali Acc: 0.251 Test Loss: 4.490 Test Acc: 0.251
Validation loss decreased (inf --> -0.250906).  Saving model ...
Epoch: 2 cost time: 47.15211057662964
Epoch: 2, Steps: 17 | Train Loss: 2.379 Vali Loss: 6.945 Vali Acc: 0.243 Test Loss: 6.945 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 51.49342370033264
Epoch: 3, Steps: 17 | Train Loss: 3.227 Vali Loss: 5.780 Vali Acc: 0.251 Test Loss: 5.780 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 43.73702907562256
Epoch: 4, Steps: 17 | Train Loss: 2.203 Vali Loss: 7.306 Vali Acc: 0.278 Test Loss: 7.306 Test Acc: 0.278
Validation loss decreased (-0.250906 --> -0.277493).  Saving model ...
Epoch: 5 cost time: 48.59048128128052
Epoch: 5, Steps: 17 | Train Loss: 2.730 Vali Loss: 7.546 Vali Acc: 0.266 Test Loss: 7.546 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 48.8585319519043
Epoch: 6, Steps: 17 | Train Loss: 2.806 Vali Loss: 13.509 Vali Acc: 0.262 Test Loss: 13.509 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 43.27865433692932
Epoch: 7, Steps: 17 | Train Loss: 2.154 Vali Loss: 11.514 Vali Acc: 0.274 Test Loss: 11.514 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 51.80398893356323
Epoch: 8, Steps: 17 | Train Loss: 2.603 Vali Loss: 11.092 Vali Acc: 0.243 Test Loss: 11.092 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 44.90671467781067
Epoch: 9, Steps: 17 | Train Loss: 3.445 Vali Loss: 11.304 Vali Acc: 0.259 Test Loss: 11.304 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 43.35713720321655
Epoch: 10, Steps: 17 | Train Loss: 2.624 Vali Loss: 21.503 Vali Acc: 0.281 Test Loss: 21.503 Test Acc: 0.281
Validation loss decreased (-0.277493 --> -0.281154).  Saving model ...
Epoch: 11 cost time: 52.69014024734497
Epoch: 11, Steps: 17 | Train Loss: 2.568 Vali Loss: 31.498 Vali Acc: 0.243 Test Loss: 31.498 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 45.973751068115234
Epoch: 12, Steps: 17 | Train Loss: 4.210 Vali Loss: 28.560 Vali Acc: 0.293 Test Loss: 28.560 Test Acc: 0.293
Validation loss decreased (-0.281154 --> -0.292490).  Saving model ...
Epoch: 13 cost time: 47.36275506019592
Epoch: 13, Steps: 17 | Train Loss: 4.315 Vali Loss: 16.518 Vali Acc: 0.259 Test Loss: 16.518 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 52.37604475021362
Epoch: 14, Steps: 17 | Train Loss: 1.601 Vali Loss: 21.849 Vali Acc: 0.289 Test Loss: 21.849 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 46.41647124290466
Epoch: 15, Steps: 17 | Train Loss: 1.868 Vali Loss: 28.323 Vali Acc: 0.240 Test Loss: 28.323 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 50.8333306312561
Epoch: 16, Steps: 17 | Train Loss: 1.714 Vali Loss: 20.104 Vali Acc: 0.236 Test Loss: 20.104 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 46.23283100128174
Epoch: 17, Steps: 17 | Train Loss: 2.047 Vali Loss: 27.685 Vali Acc: 0.228 Test Loss: 27.685 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 47.302711486816406
Epoch: 18, Steps: 17 | Train Loss: 2.473 Vali Loss: 35.933 Vali Acc: 0.262 Test Loss: 35.933 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 55.09938073158264
Epoch: 19, Steps: 17 | Train Loss: 1.491 Vali Loss: 24.389 Vali Acc: 0.243 Test Loss: 24.389 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 41.62865686416626
Epoch: 20, Steps: 17 | Train Loss: 1.337 Vali Loss: 36.157 Vali Acc: 0.259 Test Loss: 36.157 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 50.09409213066101
Epoch: 21, Steps: 17 | Train Loss: 1.335 Vali Loss: 31.853 Vali Acc: 0.217 Test Loss: 31.853 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 45.443453788757324
Epoch: 22, Steps: 17 | Train Loss: 1.597 Vali Loss: 36.064 Vali Acc: 0.270 Test Loss: 36.064 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 38.60481595993042
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 4.408 Vali Acc: 0.247 Test Loss: 4.408 Test Acc: 0.247
Validation loss decreased (inf --> -0.247104).  Saving model ...
Epoch: 2 cost time: 36.22325825691223
Epoch: 2, Steps: 17 | Train Loss: 2.347 Vali Loss: 5.359 Vali Acc: 0.270 Test Loss: 5.359 Test Acc: 0.270
Validation loss decreased (-0.247104 --> -0.269908).  Saving model ...
Epoch: 3 cost time: 40.19388175010681
Epoch: 3, Steps: 17 | Train Loss: 2.820 Vali Loss: 4.978 Vali Acc: 0.270 Test Loss: 4.978 Test Acc: 0.270
Validation loss decreased (-0.269908 --> -0.269912).  Saving model ...
Epoch: 4 cost time: 36.04554343223572
Epoch: 4, Steps: 17 | Train Loss: 2.085 Vali Loss: 7.276 Vali Acc: 0.270 Test Loss: 7.276 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.66951298713684
Epoch: 5, Steps: 17 | Train Loss: 1.994 Vali Loss: 7.892 Vali Acc: 0.281 Test Loss: 7.892 Test Acc: 0.281
Validation loss decreased (-0.269912 --> -0.281290).  Saving model ...
Epoch: 6 cost time: 38.878870487213135
Epoch: 6, Steps: 17 | Train Loss: 2.337 Vali Loss: 13.096 Vali Acc: 0.278 Test Loss: 13.096 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.790226697921753
Epoch: 7, Steps: 17 | Train Loss: 3.062 Vali Loss: 25.102 Vali Acc: 0.255 Test Loss: 25.102 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 33.45167016983032
Epoch: 8, Steps: 17 | Train Loss: 4.067 Vali Loss: 17.127 Vali Acc: 0.281 Test Loss: 17.127 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 35.95932626724243
Epoch: 9, Steps: 17 | Train Loss: 2.254 Vali Loss: 12.522 Vali Acc: 0.232 Test Loss: 12.522 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 34.49357342720032
Epoch: 10, Steps: 17 | Train Loss: 1.795 Vali Loss: 15.640 Vali Acc: 0.281 Test Loss: 15.640 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 35.67400503158569
Epoch: 11, Steps: 17 | Train Loss: 2.441 Vali Loss: 23.881 Vali Acc: 0.274 Test Loss: 23.881 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 39.56577396392822
Epoch: 12, Steps: 17 | Train Loss: 2.958 Vali Loss: 29.436 Vali Acc: 0.278 Test Loss: 29.436 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 35.50461745262146
Epoch: 13, Steps: 17 | Train Loss: 3.361 Vali Loss: 21.964 Vali Acc: 0.262 Test Loss: 21.964 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 33.272669553756714
Epoch: 14, Steps: 17 | Train Loss: 2.193 Vali Loss: 32.697 Vali Acc: 0.255 Test Loss: 32.697 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 38.38911151885986
Epoch: 15, Steps: 17 | Train Loss: 3.181 Vali Loss: 32.853 Vali Acc: 0.240 Test Loss: 32.853 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 31.257131814956665
Epoch: 1, Steps: 17 | Train Loss: 1.854 Vali Loss: 5.550 Vali Acc: 0.259 Test Loss: 5.550 Test Acc: 0.259
Validation loss decreased (inf --> -0.258500).  Saving model ...
Epoch: 2 cost time: 29.753790616989136
Epoch: 2, Steps: 17 | Train Loss: 2.048 Vali Loss: 3.654 Vali Acc: 0.243 Test Loss: 3.654 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.080615758895874
Epoch: 3, Steps: 17 | Train Loss: 1.840 Vali Loss: 5.303 Vali Acc: 0.243 Test Loss: 5.303 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.61123466491699
Epoch: 4, Steps: 17 | Train Loss: 1.694 Vali Loss: 4.730 Vali Acc: 0.243 Test Loss: 4.730 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 35.1113018989563
Epoch: 5, Steps: 17 | Train Loss: 1.951 Vali Loss: 9.691 Vali Acc: 0.228 Test Loss: 9.691 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 27.672061681747437
Epoch: 6, Steps: 17 | Train Loss: 2.159 Vali Loss: 11.318 Vali Acc: 0.262 Test Loss: 11.318 Test Acc: 0.262
Validation loss decreased (-0.258500 --> -0.262244).  Saving model ...
Epoch: 7 cost time: 32.28218483924866
Epoch: 7, Steps: 17 | Train Loss: 1.763 Vali Loss: 15.082 Vali Acc: 0.247 Test Loss: 15.082 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.977603912353516
Epoch: 8, Steps: 17 | Train Loss: 1.509 Vali Loss: 11.589 Vali Acc: 0.247 Test Loss: 11.589 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.6032190322876
Epoch: 9, Steps: 17 | Train Loss: 2.639 Vali Loss: 14.042 Vali Acc: 0.194 Test Loss: 14.042 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 28.41282606124878
Epoch: 10, Steps: 17 | Train Loss: 2.182 Vali Loss: 16.618 Vali Acc: 0.262 Test Loss: 16.618 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 24.56697177886963
Epoch: 11, Steps: 17 | Train Loss: 1.656 Vali Loss: 18.374 Vali Acc: 0.259 Test Loss: 18.374 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 34.77078127861023
Epoch: 12, Steps: 17 | Train Loss: 3.400 Vali Loss: 33.119 Vali Acc: 0.274 Test Loss: 33.119 Test Acc: 0.274
Validation loss decreased (-0.262244 --> -0.273433).  Saving model ...
Epoch: 13 cost time: 33.53229069709778
Epoch: 13, Steps: 17 | Train Loss: 2.148 Vali Loss: 22.924 Vali Acc: 0.251 Test Loss: 22.924 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 28.077428817749023
Epoch: 14, Steps: 17 | Train Loss: 2.966 Vali Loss: 36.817 Vali Acc: 0.236 Test Loss: 36.817 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 29.728880167007446
Epoch: 15, Steps: 17 | Train Loss: 1.438 Vali Loss: 31.892 Vali Acc: 0.259 Test Loss: 31.892 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 36.51072406768799
Epoch: 16, Steps: 17 | Train Loss: 3.334 Vali Loss: 45.902 Vali Acc: 0.259 Test Loss: 45.902 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 30.86521553993225
Epoch: 17, Steps: 17 | Train Loss: 3.426 Vali Loss: 37.843 Vali Acc: 0.270 Test Loss: 37.843 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 29.965059757232666
Epoch: 18, Steps: 17 | Train Loss: 1.823 Vali Loss: 37.455 Vali Acc: 0.262 Test Loss: 37.455 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 32.8074095249176
Epoch: 19, Steps: 17 | Train Loss: 1.755 Vali Loss: 40.326 Vali Acc: 0.213 Test Loss: 40.326 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 35.85747694969177
Epoch: 20, Steps: 17 | Train Loss: 2.559 Vali Loss: 51.852 Vali Acc: 0.232 Test Loss: 51.852 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 28.3123140335083
Epoch: 21, Steps: 17 | Train Loss: 2.155 Vali Loss: 44.474 Vali Acc: 0.274 Test Loss: 44.474 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 29.699668884277344
Epoch: 22, Steps: 17 | Train Loss: 2.065 Vali Loss: 38.676 Vali Acc: 0.251 Test Loss: 38.676 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 27.07042646408081
Epoch: 1, Steps: 17 | Train Loss: 1.756 Vali Loss: 5.000 Vali Acc: 0.251 Test Loss: 5.000 Test Acc: 0.251
Validation loss decreased (inf --> -0.250901).  Saving model ...
Epoch: 2 cost time: 28.401549577713013
Epoch: 2, Steps: 17 | Train Loss: 1.709 Vali Loss: 4.452 Vali Acc: 0.266 Test Loss: 4.452 Test Acc: 0.266
Validation loss decreased (-0.250901 --> -0.266115).  Saving model ...
Epoch: 3 cost time: 30.033746004104614
Epoch: 3, Steps: 17 | Train Loss: 2.755 Vali Loss: 10.828 Vali Acc: 0.255 Test Loss: 10.828 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.65819811820984
Epoch: 4, Steps: 17 | Train Loss: 3.302 Vali Loss: 5.139 Vali Acc: 0.259 Test Loss: 5.139 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.650339126586914
Epoch: 5, Steps: 17 | Train Loss: 2.247 Vali Loss: 7.243 Vali Acc: 0.259 Test Loss: 7.243 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.81079864501953
Epoch: 6, Steps: 17 | Train Loss: 2.647 Vali Loss: 12.782 Vali Acc: 0.270 Test Loss: 12.782 Test Acc: 0.270
Validation loss decreased (-0.266115 --> -0.269834).  Saving model ...
Epoch: 7 cost time: 24.058403730392456
Epoch: 7, Steps: 17 | Train Loss: 1.968 Vali Loss: 10.921 Vali Acc: 0.232 Test Loss: 10.921 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 29.791538953781128
Epoch: 8, Steps: 17 | Train Loss: 1.737 Vali Loss: 12.575 Vali Acc: 0.262 Test Loss: 12.575 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.815436601638794
Epoch: 9, Steps: 17 | Train Loss: 1.566 Vali Loss: 11.953 Vali Acc: 0.240 Test Loss: 11.953 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.58738136291504
Epoch: 10, Steps: 17 | Train Loss: 1.399 Vali Loss: 13.451 Vali Acc: 0.236 Test Loss: 13.451 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.37196159362793
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 22.627 Vali Acc: 0.281 Test Loss: 22.627 Test Acc: 0.281
Validation loss decreased (-0.269834 --> -0.281143).  Saving model ...
Epoch: 12 cost time: 32.471447467803955
Epoch: 12, Steps: 17 | Train Loss: 2.877 Vali Loss: 23.711 Vali Acc: 0.274 Test Loss: 23.711 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.188384532928467
Epoch: 13, Steps: 17 | Train Loss: 2.611 Vali Loss: 21.597 Vali Acc: 0.232 Test Loss: 21.597 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.43123722076416
Epoch: 14, Steps: 17 | Train Loss: 3.832 Vali Loss: 42.078 Vali Acc: 0.270 Test Loss: 42.078 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 26.537770748138428
Epoch: 15, Steps: 17 | Train Loss: 4.238 Vali Loss: 43.024 Vali Acc: 0.255 Test Loss: 43.024 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 31.60672402381897
Epoch: 16, Steps: 17 | Train Loss: 2.670 Vali Loss: 46.159 Vali Acc: 0.251 Test Loss: 46.159 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 26.774497747421265
Epoch: 17, Steps: 17 | Train Loss: 2.335 Vali Loss: 36.297 Vali Acc: 0.240 Test Loss: 36.297 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 24.71961545944214
Epoch: 18, Steps: 17 | Train Loss: 2.061 Vali Loss: 39.400 Vali Acc: 0.243 Test Loss: 39.400 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 28.174713850021362
Epoch: 19, Steps: 17 | Train Loss: 2.503 Vali Loss: 35.330 Vali Acc: 0.243 Test Loss: 35.330 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 28.401867866516113
Epoch: 20, Steps: 17 | Train Loss: 2.851 Vali Loss: 46.690 Vali Acc: 0.251 Test Loss: 46.690 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 27.811644792556763
Epoch: 21, Steps: 17 | Train Loss: 3.247 Vali Loss: 45.737 Vali Acc: 0.232 Test Loss: 45.737 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 23.199971914291382
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 4.533 Vali Acc: 0.255 Test Loss: 4.533 Test Acc: 0.255
Validation loss decreased (inf --> -0.254708).  Saving model ...
Epoch: 2 cost time: 27.005874633789062
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 3.239 Vali Acc: 0.281 Test Loss: 3.239 Test Acc: 0.281
Validation loss decreased (-0.254708 --> -0.281336).  Saving model ...
Epoch: 3 cost time: 29.089325189590454
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 5.312 Vali Acc: 0.270 Test Loss: 5.312 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.787179708480835
Epoch: 4, Steps: 17 | Train Loss: 1.847 Vali Loss: 10.259 Vali Acc: 0.274 Test Loss: 10.259 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.757383584976196
Epoch: 5, Steps: 17 | Train Loss: 3.093 Vali Loss: 10.187 Vali Acc: 0.240 Test Loss: 10.187 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.068040132522583
Epoch: 6, Steps: 17 | Train Loss: 2.929 Vali Loss: 16.082 Vali Acc: 0.259 Test Loss: 16.082 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.02657675743103
Epoch: 7, Steps: 17 | Train Loss: 3.522 Vali Loss: 21.710 Vali Acc: 0.228 Test Loss: 21.710 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 29.13737726211548
Epoch: 8, Steps: 17 | Train Loss: 3.480 Vali Loss: 15.481 Vali Acc: 0.240 Test Loss: 15.481 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 28.98470377922058
Epoch: 9, Steps: 17 | Train Loss: 2.491 Vali Loss: 14.002 Vali Acc: 0.274 Test Loss: 14.002 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.448400497436523
Epoch: 10, Steps: 17 | Train Loss: 2.302 Vali Loss: 23.364 Vali Acc: 0.270 Test Loss: 23.364 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 26.61858320236206
Epoch: 11, Steps: 17 | Train Loss: 1.622 Vali Loss: 19.979 Vali Acc: 0.213 Test Loss: 19.979 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 29.500960111618042
Epoch: 12, Steps: 17 | Train Loss: 2.159 Vali Loss: 35.450 Vali Acc: 0.228 Test Loss: 35.450 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 29.760937929153442
Epoch: 1, Steps: 17 | Train Loss: 1.681 Vali Loss: 5.044 Vali Acc: 0.251 Test Loss: 5.044 Test Acc: 0.251
Validation loss decreased (inf --> -0.250900).  Saving model ...
Epoch: 2 cost time: 20.981086254119873
Epoch: 2, Steps: 17 | Train Loss: 1.884 Vali Loss: 3.344 Vali Acc: 0.278 Test Loss: 3.344 Test Acc: 0.278
Validation loss decreased (-0.250900 --> -0.277533).  Saving model ...
Epoch: 3 cost time: 26.054868936538696
Epoch: 3, Steps: 17 | Train Loss: 2.845 Vali Loss: 7.519 Vali Acc: 0.251 Test Loss: 7.519 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.17747211456299
Epoch: 4, Steps: 17 | Train Loss: 2.149 Vali Loss: 7.889 Vali Acc: 0.270 Test Loss: 7.889 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.158550024032593
Epoch: 5, Steps: 17 | Train Loss: 1.726 Vali Loss: 7.710 Vali Acc: 0.278 Test Loss: 7.710 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.256341218948364
Epoch: 6, Steps: 17 | Train Loss: 1.699 Vali Loss: 11.661 Vali Acc: 0.251 Test Loss: 11.661 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.32445502281189
Epoch: 7, Steps: 17 | Train Loss: 2.104 Vali Loss: 22.175 Vali Acc: 0.266 Test Loss: 22.175 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 24.961228847503662
Epoch: 8, Steps: 17 | Train Loss: 2.127 Vali Loss: 13.403 Vali Acc: 0.270 Test Loss: 13.403 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.463765382766724
Epoch: 9, Steps: 17 | Train Loss: 2.784 Vali Loss: 27.531 Vali Acc: 0.259 Test Loss: 27.531 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 25.526626110076904
Epoch: 10, Steps: 17 | Train Loss: 3.184 Vali Loss: 33.580 Vali Acc: 0.266 Test Loss: 33.580 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.73933720588684
Epoch: 11, Steps: 17 | Train Loss: 4.533 Vali Loss: 29.913 Vali Acc: 0.240 Test Loss: 29.913 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.600569009780884
Epoch: 12, Steps: 17 | Train Loss: 2.237 Vali Loss: 26.681 Vali Acc: 0.221 Test Loss: 26.681 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 29.979022979736328
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 4.417 Vali Acc: 0.251 Test Loss: 4.417 Test Acc: 0.251
Validation loss decreased (inf --> -0.250906).  Saving model ...
Epoch: 2 cost time: 24.724661588668823
Epoch: 2, Steps: 17 | Train Loss: 2.123 Vali Loss: 5.439 Vali Acc: 0.228 Test Loss: 5.439 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.192906141281128
Epoch: 3, Steps: 17 | Train Loss: 2.866 Vali Loss: 6.379 Vali Acc: 0.240 Test Loss: 6.379 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.108126640319824
Epoch: 4, Steps: 17 | Train Loss: 3.603 Vali Loss: 10.126 Vali Acc: 0.266 Test Loss: 10.126 Test Acc: 0.266
Validation loss decreased (-0.250906 --> -0.266058).  Saving model ...
Epoch: 5 cost time: 25.79641556739807
Epoch: 5, Steps: 17 | Train Loss: 3.987 Vali Loss: 15.161 Vali Acc: 0.236 Test Loss: 15.161 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.626526594161987
Epoch: 6, Steps: 17 | Train Loss: 3.521 Vali Loss: 13.728 Vali Acc: 0.270 Test Loss: 13.728 Test Acc: 0.270
Validation loss decreased (-0.266058 --> -0.269825).  Saving model ...
Epoch: 7 cost time: 25.719956159591675
Epoch: 7, Steps: 17 | Train Loss: 2.151 Vali Loss: 13.012 Vali Acc: 0.240 Test Loss: 13.012 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.025534868240356
Epoch: 8, Steps: 17 | Train Loss: 2.603 Vali Loss: 15.238 Vali Acc: 0.232 Test Loss: 15.238 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 27.7529513835907
Epoch: 9, Steps: 17 | Train Loss: 1.992 Vali Loss: 12.524 Vali Acc: 0.281 Test Loss: 12.524 Test Acc: 0.281
Validation loss decreased (-0.269825 --> -0.281244).  Saving model ...
Epoch: 10 cost time: 22.670603036880493
Epoch: 10, Steps: 17 | Train Loss: 2.644 Vali Loss: 19.080 Vali Acc: 0.232 Test Loss: 19.080 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.113944053649902
Epoch: 11, Steps: 17 | Train Loss: 3.145 Vali Loss: 22.242 Vali Acc: 0.232 Test Loss: 22.242 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.38436222076416
Epoch: 12, Steps: 17 | Train Loss: 2.998 Vali Loss: 25.612 Vali Acc: 0.224 Test Loss: 25.612 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.98401713371277
Epoch: 13, Steps: 17 | Train Loss: 2.894 Vali Loss: 27.120 Vali Acc: 0.228 Test Loss: 27.120 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.146648645401
Epoch: 14, Steps: 17 | Train Loss: 2.860 Vali Loss: 25.697 Vali Acc: 0.240 Test Loss: 25.697 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 26.566320657730103
Epoch: 15, Steps: 17 | Train Loss: 2.908 Vali Loss: 37.385 Vali Acc: 0.186 Test Loss: 37.385 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 26.792718410491943
Epoch: 16, Steps: 17 | Train Loss: 2.842 Vali Loss: 37.331 Vali Acc: 0.205 Test Loss: 37.331 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.447900533676147
Epoch: 17, Steps: 17 | Train Loss: 2.498 Vali Loss: 33.525 Vali Acc: 0.247 Test Loss: 33.525 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 26.316325664520264
Epoch: 18, Steps: 17 | Train Loss: 1.883 Vali Loss: 37.194 Vali Acc: 0.262 Test Loss: 37.194 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 29.19820523262024
Epoch: 19, Steps: 17 | Train Loss: 3.219 Vali Loss: 45.382 Vali Acc: 0.224 Test Loss: 45.382 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 20392964
model size : 97.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 60.3782856464386
Epoch: 1, Steps: 17 | Train Loss: 2.039 Vali Loss: 4.156 Vali Acc: 0.251 Test Loss: 4.156 Test Acc: 0.251
Validation loss decreased (inf --> -0.250909).  Saving model ...
Epoch: 2 cost time: 61.652788400650024
Epoch: 2, Steps: 17 | Train Loss: 2.711 Vali Loss: 5.357 Vali Acc: 0.270 Test Loss: 5.357 Test Acc: 0.270
Validation loss decreased (-0.250909 --> -0.269908).  Saving model ...
Epoch: 3 cost time: 52.72932577133179
Epoch: 3, Steps: 17 | Train Loss: 2.922 Vali Loss: 5.457 Vali Acc: 0.255 Test Loss: 5.457 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 66.31634402275085
Epoch: 4, Steps: 17 | Train Loss: 2.819 Vali Loss: 10.260 Vali Acc: 0.259 Test Loss: 10.260 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 54.16268229484558
Epoch: 5, Steps: 17 | Train Loss: 3.659 Vali Loss: 10.261 Vali Acc: 0.259 Test Loss: 10.261 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 66.25933742523193
Epoch: 6, Steps: 17 | Train Loss: 4.302 Vali Loss: 10.325 Vali Acc: 0.262 Test Loss: 10.325 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 58.03827357292175
Epoch: 7, Steps: 17 | Train Loss: 3.328 Vali Loss: 6.696 Vali Acc: 0.281 Test Loss: 6.696 Test Acc: 0.281
Validation loss decreased (-0.269908 --> -0.281302).  Saving model ...
Epoch: 8 cost time: 62.60103392601013
Epoch: 8, Steps: 17 | Train Loss: 4.258 Vali Loss: 9.589 Vali Acc: 0.297 Test Loss: 9.589 Test Acc: 0.297
Validation loss decreased (-0.281302 --> -0.296482).  Saving model ...
Epoch: 9 cost time: 63.01882815361023
Epoch: 9, Steps: 17 | Train Loss: 2.427 Vali Loss: 10.573 Vali Acc: 0.266 Test Loss: 10.573 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 61.343287229537964
Epoch: 10, Steps: 17 | Train Loss: 2.957 Vali Loss: 7.776 Vali Acc: 0.312 Test Loss: 7.776 Test Acc: 0.312
Validation loss decreased (-0.296482 --> -0.311709).  Saving model ...
Epoch: 11 cost time: 61.64909625053406
Epoch: 11, Steps: 17 | Train Loss: 2.058 Vali Loss: 11.021 Vali Acc: 0.270 Test Loss: 11.021 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 60.29202437400818
Epoch: 12, Steps: 17 | Train Loss: 2.186 Vali Loss: 13.952 Vali Acc: 0.297 Test Loss: 13.952 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 58.079923152923584
Epoch: 13, Steps: 17 | Train Loss: 2.254 Vali Loss: 11.838 Vali Acc: 0.221 Test Loss: 11.838 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 60.60554051399231
Epoch: 14, Steps: 17 | Train Loss: 2.012 Vali Loss: 10.238 Vali Acc: 0.243 Test Loss: 10.238 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 65.78473401069641
Epoch: 15, Steps: 17 | Train Loss: 2.631 Vali Loss: 14.902 Vali Acc: 0.228 Test Loss: 14.902 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 59.16649580001831
Epoch: 16, Steps: 17 | Train Loss: 2.461 Vali Loss: 17.116 Vali Acc: 0.262 Test Loss: 17.116 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 65.83828163146973
Epoch: 17, Steps: 17 | Train Loss: 1.661 Vali Loss: 16.350 Vali Acc: 0.255 Test Loss: 16.350 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 59.27800726890564
Epoch: 18, Steps: 17 | Train Loss: 1.966 Vali Loss: 14.995 Vali Acc: 0.255 Test Loss: 14.995 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 65.46325397491455
Epoch: 19, Steps: 17 | Train Loss: 1.352 Vali Loss: 17.827 Vali Acc: 0.266 Test Loss: 17.827 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 56.506810903549194
Epoch: 20, Steps: 17 | Train Loss: 3.188 Vali Loss: 20.663 Vali Acc: 0.236 Test Loss: 20.663 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 56.84959149360657
Epoch: 1, Steps: 17 | Train Loss: 2.096 Vali Loss: 5.679 Vali Acc: 0.266 Test Loss: 5.679 Test Acc: 0.266
Validation loss decreased (inf --> -0.266103).  Saving model ...
Epoch: 2 cost time: 41.735461711883545
Epoch: 2, Steps: 17 | Train Loss: 3.604 Vali Loss: 2.785 Vali Acc: 0.255 Test Loss: 2.785 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.3671019077301
Epoch: 3, Steps: 17 | Train Loss: 2.728 Vali Loss: 3.876 Vali Acc: 0.270 Test Loss: 3.876 Test Acc: 0.270
Validation loss decreased (-0.266103 --> -0.269923).  Saving model ...
Epoch: 4 cost time: 47.05821990966797
Epoch: 4, Steps: 17 | Train Loss: 2.683 Vali Loss: 6.412 Vali Acc: 0.270 Test Loss: 6.412 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 48.88797926902771
Epoch: 5, Steps: 17 | Train Loss: 3.515 Vali Loss: 7.921 Vali Acc: 0.259 Test Loss: 7.921 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 50.627559185028076
Epoch: 6, Steps: 17 | Train Loss: 3.997 Vali Loss: 4.761 Vali Acc: 0.304 Test Loss: 4.761 Test Acc: 0.304
Validation loss decreased (-0.269923 --> -0.304135).  Saving model ...
Epoch: 7 cost time: 49.15572190284729
Epoch: 7, Steps: 17 | Train Loss: 3.195 Vali Loss: 6.731 Vali Acc: 0.251 Test Loss: 6.731 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 48.90803837776184
Epoch: 8, Steps: 17 | Train Loss: 2.706 Vali Loss: 8.476 Vali Acc: 0.255 Test Loss: 8.476 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 43.92641520500183
Epoch: 9, Steps: 17 | Train Loss: 3.034 Vali Loss: 12.170 Vali Acc: 0.255 Test Loss: 12.170 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 50.56921410560608
Epoch: 10, Steps: 17 | Train Loss: 3.455 Vali Loss: 10.069 Vali Acc: 0.228 Test Loss: 10.069 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 46.6246440410614
Epoch: 11, Steps: 17 | Train Loss: 2.950 Vali Loss: 11.334 Vali Acc: 0.262 Test Loss: 11.334 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 50.20662569999695
Epoch: 12, Steps: 17 | Train Loss: 3.256 Vali Loss: 9.095 Vali Acc: 0.266 Test Loss: 9.095 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 49.49287676811218
Epoch: 13, Steps: 17 | Train Loss: 2.211 Vali Loss: 11.420 Vali Acc: 0.247 Test Loss: 11.420 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 45.7506742477417
Epoch: 14, Steps: 17 | Train Loss: 3.003 Vali Loss: 12.825 Vali Acc: 0.240 Test Loss: 12.825 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 48.79110264778137
Epoch: 15, Steps: 17 | Train Loss: 2.083 Vali Loss: 11.477 Vali Acc: 0.255 Test Loss: 11.477 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 43.30830717086792
Epoch: 16, Steps: 17 | Train Loss: 2.247 Vali Loss: 12.721 Vali Acc: 0.251 Test Loss: 12.721 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 42.68146562576294
Epoch: 1, Steps: 17 | Train Loss: 2.033 Vali Loss: 4.120 Vali Acc: 0.224 Test Loss: 4.120 Test Acc: 0.224
Validation loss decreased (inf --> -0.224293).  Saving model ...
Epoch: 2 cost time: 39.045456409454346
Epoch: 2, Steps: 17 | Train Loss: 2.621 Vali Loss: 4.396 Vali Acc: 0.274 Test Loss: 4.396 Test Acc: 0.274
Validation loss decreased (-0.224293 --> -0.273720).  Saving model ...
Epoch: 3 cost time: 42.48871374130249
Epoch: 3, Steps: 17 | Train Loss: 3.220 Vali Loss: 8.461 Vali Acc: 0.262 Test Loss: 8.461 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 38.573885917663574
Epoch: 4, Steps: 17 | Train Loss: 2.870 Vali Loss: 10.905 Vali Acc: 0.243 Test Loss: 10.905 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 36.87083172798157
Epoch: 5, Steps: 17 | Train Loss: 2.511 Vali Loss: 10.533 Vali Acc: 0.262 Test Loss: 10.533 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 36.86709666252136
Epoch: 6, Steps: 17 | Train Loss: 3.302 Vali Loss: 6.515 Vali Acc: 0.247 Test Loss: 6.515 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 39.87732172012329
Epoch: 7, Steps: 17 | Train Loss: 1.743 Vali Loss: 9.073 Vali Acc: 0.240 Test Loss: 9.073 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 34.436477184295654
Epoch: 8, Steps: 17 | Train Loss: 2.912 Vali Loss: 10.626 Vali Acc: 0.259 Test Loss: 10.626 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 34.42977166175842
Epoch: 9, Steps: 17 | Train Loss: 2.299 Vali Loss: 19.502 Vali Acc: 0.243 Test Loss: 19.502 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 38.87824082374573
Epoch: 10, Steps: 17 | Train Loss: 2.553 Vali Loss: 20.365 Vali Acc: 0.228 Test Loss: 20.365 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 42.85708165168762
Epoch: 11, Steps: 17 | Train Loss: 1.953 Vali Loss: 19.301 Vali Acc: 0.228 Test Loss: 19.301 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 37.14083957672119
Epoch: 12, Steps: 17 | Train Loss: 2.228 Vali Loss: 18.814 Vali Acc: 0.259 Test Loss: 18.814 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 31.944631814956665
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 7.288 Vali Acc: 0.236 Test Loss: 7.288 Test Acc: 0.236
Validation loss decreased (inf --> -0.235669).  Saving model ...
Epoch: 2 cost time: 32.49802589416504
Epoch: 2, Steps: 17 | Train Loss: 4.089 Vali Loss: 7.584 Vali Acc: 0.243 Test Loss: 7.584 Test Acc: 0.243
Validation loss decreased (-0.235669 --> -0.243270).  Saving model ...
Epoch: 3 cost time: 30.118932962417603
Epoch: 3, Steps: 17 | Train Loss: 2.915 Vali Loss: 7.582 Vali Acc: 0.289 Test Loss: 7.582 Test Acc: 0.289
Validation loss decreased (-0.243270 --> -0.288898).  Saving model ...
Epoch: 4 cost time: 35.7364182472229
Epoch: 4, Steps: 17 | Train Loss: 2.315 Vali Loss: 10.603 Vali Acc: 0.240 Test Loss: 10.603 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.882094621658325
Epoch: 5, Steps: 17 | Train Loss: 3.729 Vali Loss: 14.092 Vali Acc: 0.266 Test Loss: 14.092 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.782839059829712
Epoch: 6, Steps: 17 | Train Loss: 3.585 Vali Loss: 8.539 Vali Acc: 0.285 Test Loss: 8.539 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.824921369552612
Epoch: 7, Steps: 17 | Train Loss: 2.648 Vali Loss: 10.751 Vali Acc: 0.262 Test Loss: 10.751 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 34.664427042007446
Epoch: 8, Steps: 17 | Train Loss: 2.576 Vali Loss: 21.296 Vali Acc: 0.262 Test Loss: 21.296 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.20296931266785
Epoch: 9, Steps: 17 | Train Loss: 2.233 Vali Loss: 16.682 Vali Acc: 0.259 Test Loss: 16.682 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.332439422607422
Epoch: 10, Steps: 17 | Train Loss: 2.123 Vali Loss: 16.700 Vali Acc: 0.262 Test Loss: 16.700 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 32.504372358322144
Epoch: 11, Steps: 17 | Train Loss: 1.722 Vali Loss: 20.078 Vali Acc: 0.266 Test Loss: 20.078 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 31.42632794380188
Epoch: 12, Steps: 17 | Train Loss: 2.192 Vali Loss: 15.581 Vali Acc: 0.228 Test Loss: 15.581 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 30.207201957702637
Epoch: 13, Steps: 17 | Train Loss: 2.771 Vali Loss: 19.909 Vali Acc: 0.240 Test Loss: 19.909 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.125232219696045
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 7.800 Vali Acc: 0.266 Test Loss: 7.800 Test Acc: 0.266
Validation loss decreased (inf --> -0.266082).  Saving model ...
Epoch: 2 cost time: 27.88454532623291
Epoch: 2, Steps: 17 | Train Loss: 3.852 Vali Loss: 7.095 Vali Acc: 0.262 Test Loss: 7.095 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.795437335968018
Epoch: 3, Steps: 17 | Train Loss: 4.169 Vali Loss: 7.015 Vali Acc: 0.259 Test Loss: 7.015 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.498874187469482
Epoch: 4, Steps: 17 | Train Loss: 2.473 Vali Loss: 5.501 Vali Acc: 0.266 Test Loss: 5.501 Test Acc: 0.266
Validation loss decreased (-0.266082 --> -0.266105).  Saving model ...
Epoch: 5 cost time: 25.475733995437622
Epoch: 5, Steps: 17 | Train Loss: 1.662 Vali Loss: 7.601 Vali Acc: 0.289 Test Loss: 7.601 Test Acc: 0.289
Validation loss decreased (-0.266105 --> -0.288897).  Saving model ...
Epoch: 6 cost time: 27.03053307533264
Epoch: 6, Steps: 17 | Train Loss: 2.059 Vali Loss: 9.138 Vali Acc: 0.240 Test Loss: 9.138 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.813785314559937
Epoch: 7, Steps: 17 | Train Loss: 2.046 Vali Loss: 10.515 Vali Acc: 0.270 Test Loss: 10.515 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.066441297531128
Epoch: 8, Steps: 17 | Train Loss: 1.788 Vali Loss: 26.651 Vali Acc: 0.251 Test Loss: 26.651 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.74970245361328
Epoch: 9, Steps: 17 | Train Loss: 2.020 Vali Loss: 31.339 Vali Acc: 0.259 Test Loss: 31.339 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.74858331680298
Epoch: 10, Steps: 17 | Train Loss: 3.138 Vali Loss: 24.450 Vali Acc: 0.255 Test Loss: 24.450 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.50663471221924
Epoch: 11, Steps: 17 | Train Loss: 2.968 Vali Loss: 17.405 Vali Acc: 0.278 Test Loss: 17.405 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 26.442331790924072
Epoch: 12, Steps: 17 | Train Loss: 1.522 Vali Loss: 16.935 Vali Acc: 0.255 Test Loss: 16.935 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.371798515319824
Epoch: 13, Steps: 17 | Train Loss: 2.935 Vali Loss: 29.103 Vali Acc: 0.232 Test Loss: 29.103 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 25.12960195541382
Epoch: 14, Steps: 17 | Train Loss: 2.696 Vali Loss: 23.250 Vali Acc: 0.289 Test Loss: 23.250 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 26.471265077590942
Epoch: 15, Steps: 17 | Train Loss: 1.350 Vali Loss: 25.438 Vali Acc: 0.274 Test Loss: 25.438 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.986756563186646
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 6.084 Vali Acc: 0.228 Test Loss: 6.084 Test Acc: 0.228
Validation loss decreased (inf --> -0.228076).  Saving model ...
Epoch: 2 cost time: 19.255512475967407
Epoch: 2, Steps: 17 | Train Loss: 2.423 Vali Loss: 4.051 Vali Acc: 0.240 Test Loss: 4.051 Test Acc: 0.240
Validation loss decreased (-0.228076 --> -0.239503).  Saving model ...
Epoch: 3 cost time: 23.666581392288208
Epoch: 3, Steps: 17 | Train Loss: 2.469 Vali Loss: 5.183 Vali Acc: 0.236 Test Loss: 5.183 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.69516158103943
Epoch: 4, Steps: 17 | Train Loss: 2.125 Vali Loss: 6.191 Vali Acc: 0.217 Test Loss: 6.191 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.157276391983032
Epoch: 5, Steps: 17 | Train Loss: 1.597 Vali Loss: 11.523 Vali Acc: 0.262 Test Loss: 11.523 Test Acc: 0.262
Validation loss decreased (-0.239503 --> -0.262242).  Saving model ...
Epoch: 6 cost time: 24.152904510498047
Epoch: 6, Steps: 17 | Train Loss: 1.456 Vali Loss: 9.031 Vali Acc: 0.240 Test Loss: 9.031 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.889023780822754
Epoch: 7, Steps: 17 | Train Loss: 2.279 Vali Loss: 12.637 Vali Acc: 0.262 Test Loss: 12.637 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.349390029907227
Epoch: 8, Steps: 17 | Train Loss: 2.650 Vali Loss: 17.327 Vali Acc: 0.259 Test Loss: 17.327 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.0521719455719
Epoch: 9, Steps: 17 | Train Loss: 1.738 Vali Loss: 22.079 Vali Acc: 0.232 Test Loss: 22.079 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.398921012878418
Epoch: 10, Steps: 17 | Train Loss: 3.435 Vali Loss: 24.455 Vali Acc: 0.255 Test Loss: 24.455 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 21.69310474395752
Epoch: 11, Steps: 17 | Train Loss: 2.283 Vali Loss: 29.560 Vali Acc: 0.232 Test Loss: 29.560 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.59153652191162
Epoch: 12, Steps: 17 | Train Loss: 2.642 Vali Loss: 25.522 Vali Acc: 0.251 Test Loss: 25.522 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.988176107406616
Epoch: 13, Steps: 17 | Train Loss: 1.441 Vali Loss: 27.794 Vali Acc: 0.224 Test Loss: 27.794 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 22.70474886894226
Epoch: 14, Steps: 17 | Train Loss: 1.586 Vali Loss: 23.676 Vali Acc: 0.251 Test Loss: 23.676 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.656140327453613
Epoch: 15, Steps: 17 | Train Loss: 1.857 Vali Loss: 35.047 Vali Acc: 0.243 Test Loss: 35.047 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.605785608291626
Epoch: 1, Steps: 17 | Train Loss: 1.633 Vali Loss: 5.051 Vali Acc: 0.232 Test Loss: 5.051 Test Acc: 0.232
Validation loss decreased (inf --> -0.231889).  Saving model ...
Epoch: 2 cost time: 18.87954306602478
Epoch: 2, Steps: 17 | Train Loss: 1.963 Vali Loss: 4.069 Vali Acc: 0.255 Test Loss: 4.069 Test Acc: 0.255
Validation loss decreased (-0.231889 --> -0.254712).  Saving model ...
Epoch: 3 cost time: 17.43207287788391
Epoch: 3, Steps: 17 | Train Loss: 1.812 Vali Loss: 5.296 Vali Acc: 0.266 Test Loss: 5.296 Test Acc: 0.266
Validation loss decreased (-0.254712 --> -0.266107).  Saving model ...
Epoch: 4 cost time: 21.778038263320923
Epoch: 4, Steps: 17 | Train Loss: 2.073 Vali Loss: 9.455 Vali Acc: 0.251 Test Loss: 9.455 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.92923092842102
Epoch: 5, Steps: 17 | Train Loss: 2.545 Vali Loss: 10.154 Vali Acc: 0.285 Test Loss: 10.154 Test Acc: 0.285
Validation loss decreased (-0.266107 --> -0.285070).  Saving model ...
Epoch: 6 cost time: 23.777732849121094
Epoch: 6, Steps: 17 | Train Loss: 1.639 Vali Loss: 13.191 Vali Acc: 0.259 Test Loss: 13.191 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.5084068775177
Epoch: 7, Steps: 17 | Train Loss: 2.982 Vali Loss: 13.504 Vali Acc: 0.270 Test Loss: 13.504 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.672332763671875
Epoch: 8, Steps: 17 | Train Loss: 3.535 Vali Loss: 14.844 Vali Acc: 0.278 Test Loss: 14.844 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.626944303512573
Epoch: 9, Steps: 17 | Train Loss: 1.714 Vali Loss: 19.489 Vali Acc: 0.274 Test Loss: 19.489 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.3234920501709
Epoch: 10, Steps: 17 | Train Loss: 1.870 Vali Loss: 14.614 Vali Acc: 0.255 Test Loss: 14.614 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 21.30380082130432
Epoch: 11, Steps: 17 | Train Loss: 1.609 Vali Loss: 20.689 Vali Acc: 0.217 Test Loss: 20.689 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.513690948486328
Epoch: 12, Steps: 17 | Train Loss: 3.092 Vali Loss: 24.764 Vali Acc: 0.247 Test Loss: 24.764 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.793873071670532
Epoch: 13, Steps: 17 | Train Loss: 1.863 Vali Loss: 30.182 Vali Acc: 0.224 Test Loss: 30.182 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.35184621810913
Epoch: 14, Steps: 17 | Train Loss: 2.667 Vali Loss: 42.335 Vali Acc: 0.251 Test Loss: 42.335 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 22.66529083251953
Epoch: 15, Steps: 17 | Train Loss: 2.736 Vali Loss: 31.435 Vali Acc: 0.255 Test Loss: 31.435 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.964908361434937
Epoch: 1, Steps: 17 | Train Loss: 1.634 Vali Loss: 6.030 Vali Acc: 0.270 Test Loss: 6.030 Test Acc: 0.270
Validation loss decreased (inf --> -0.269902).  Saving model ...
Epoch: 2 cost time: 17.30317711830139
Epoch: 2, Steps: 17 | Train Loss: 2.372 Vali Loss: 7.120 Vali Acc: 0.251 Test Loss: 7.120 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.9672634601593
Epoch: 3, Steps: 17 | Train Loss: 2.318 Vali Loss: 7.374 Vali Acc: 0.243 Test Loss: 7.374 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.01068663597107
Epoch: 4, Steps: 17 | Train Loss: 2.163 Vali Loss: 6.695 Vali Acc: 0.236 Test Loss: 6.695 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.126709938049316
Epoch: 5, Steps: 17 | Train Loss: 2.271 Vali Loss: 7.784 Vali Acc: 0.266 Test Loss: 7.784 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.614587545394897
Epoch: 6, Steps: 17 | Train Loss: 3.097 Vali Loss: 7.431 Vali Acc: 0.281 Test Loss: 7.431 Test Acc: 0.281
Validation loss decreased (-0.269902 --> -0.281295).  Saving model ...
Epoch: 7 cost time: 21.504656076431274
Epoch: 7, Steps: 17 | Train Loss: 1.961 Vali Loss: 7.648 Vali Acc: 0.274 Test Loss: 7.648 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.47409152984619
Epoch: 8, Steps: 17 | Train Loss: 1.738 Vali Loss: 18.463 Vali Acc: 0.251 Test Loss: 18.463 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.851444721221924
Epoch: 9, Steps: 17 | Train Loss: 1.665 Vali Loss: 15.780 Vali Acc: 0.213 Test Loss: 15.780 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.077611207962036
Epoch: 10, Steps: 17 | Train Loss: 1.985 Vali Loss: 13.138 Vali Acc: 0.240 Test Loss: 13.138 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.87557888031006
Epoch: 11, Steps: 17 | Train Loss: 2.106 Vali Loss: 16.337 Vali Acc: 0.251 Test Loss: 16.337 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.378883361816406
Epoch: 12, Steps: 17 | Train Loss: 1.976 Vali Loss: 25.347 Vali Acc: 0.278 Test Loss: 25.347 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.196956396102905
Epoch: 13, Steps: 17 | Train Loss: 2.299 Vali Loss: 30.148 Vali Acc: 0.224 Test Loss: 30.148 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.079491138458252
Epoch: 14, Steps: 17 | Train Loss: 1.215 Vali Loss: 23.054 Vali Acc: 0.240 Test Loss: 23.054 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.849069595336914
Epoch: 15, Steps: 17 | Train Loss: 1.737 Vali Loss: 25.435 Vali Acc: 0.232 Test Loss: 25.435 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 20.011229991912842
Epoch: 16, Steps: 17 | Train Loss: 2.621 Vali Loss: 28.074 Vali Acc: 0.236 Test Loss: 28.074 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.586034536361694
Epoch: 1, Steps: 17 | Train Loss: 1.611 Vali Loss: 5.232 Vali Acc: 0.259 Test Loss: 5.232 Test Acc: 0.259
Validation loss decreased (inf --> -0.258503).  Saving model ...
Epoch: 2 cost time: 19.121474504470825
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 5.290 Vali Acc: 0.232 Test Loss: 5.290 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.41442108154297
Epoch: 3, Steps: 17 | Train Loss: 2.076 Vali Loss: 5.708 Vali Acc: 0.247 Test Loss: 5.708 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.74325942993164
Epoch: 4, Steps: 17 | Train Loss: 1.790 Vali Loss: 6.372 Vali Acc: 0.247 Test Loss: 6.372 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.44087266921997
Epoch: 5, Steps: 17 | Train Loss: 2.050 Vali Loss: 7.402 Vali Acc: 0.243 Test Loss: 7.402 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.695266008377075
Epoch: 6, Steps: 17 | Train Loss: 2.443 Vali Loss: 11.863 Vali Acc: 0.274 Test Loss: 11.863 Test Acc: 0.274
Validation loss decreased (-0.258503 --> -0.273646).  Saving model ...
Epoch: 7 cost time: 19.963290214538574
Epoch: 7, Steps: 17 | Train Loss: 1.620 Vali Loss: 12.002 Vali Acc: 0.243 Test Loss: 12.002 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.861310720443726
Epoch: 8, Steps: 17 | Train Loss: 2.408 Vali Loss: 17.252 Vali Acc: 0.240 Test Loss: 17.252 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.361159801483154
Epoch: 9, Steps: 17 | Train Loss: 1.533 Vali Loss: 17.912 Vali Acc: 0.209 Test Loss: 17.912 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.215919971466064
Epoch: 10, Steps: 17 | Train Loss: 1.398 Vali Loss: 17.677 Vali Acc: 0.217 Test Loss: 17.677 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.605156898498535
Epoch: 11, Steps: 17 | Train Loss: 2.528 Vali Loss: 21.815 Vali Acc: 0.209 Test Loss: 21.815 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.0944983959198
Epoch: 12, Steps: 17 | Train Loss: 2.234 Vali Loss: 20.376 Vali Acc: 0.224 Test Loss: 20.376 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.487452268600464
Epoch: 13, Steps: 17 | Train Loss: 2.981 Vali Loss: 24.844 Vali Acc: 0.240 Test Loss: 24.844 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.30603313446045
Epoch: 14, Steps: 17 | Train Loss: 1.895 Vali Loss: 26.470 Vali Acc: 0.240 Test Loss: 26.470 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.24403715133667
Epoch: 15, Steps: 17 | Train Loss: 4.034 Vali Loss: 29.295 Vali Acc: 0.217 Test Loss: 29.295 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.76628613471985
Epoch: 16, Steps: 17 | Train Loss: 4.960 Vali Loss: 56.322 Vali Acc: 0.213 Test Loss: 56.322 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.615259170532227
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 4.294 Vali Acc: 0.247 Test Loss: 4.294 Test Acc: 0.247
Validation loss decreased (inf --> -0.247105).  Saving model ...
Epoch: 2 cost time: 17.324958562850952
Epoch: 2, Steps: 17 | Train Loss: 2.286 Vali Loss: 5.609 Vali Acc: 0.270 Test Loss: 5.609 Test Acc: 0.270
Validation loss decreased (-0.247105 --> -0.269906).  Saving model ...
Epoch: 3 cost time: 20.550827980041504
Epoch: 3, Steps: 17 | Train Loss: 2.377 Vali Loss: 10.045 Vali Acc: 0.232 Test Loss: 10.045 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.22151803970337
Epoch: 4, Steps: 17 | Train Loss: 2.130 Vali Loss: 7.418 Vali Acc: 0.285 Test Loss: 7.418 Test Acc: 0.285
Validation loss decreased (-0.269906 --> -0.285097).  Saving model ...
Epoch: 5 cost time: 15.40565800666809
Epoch: 5, Steps: 17 | Train Loss: 2.806 Vali Loss: 8.723 Vali Acc: 0.274 Test Loss: 8.723 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.132640600204468
Epoch: 6, Steps: 17 | Train Loss: 2.556 Vali Loss: 7.358 Vali Acc: 0.270 Test Loss: 7.358 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.926777601242065
Epoch: 7, Steps: 17 | Train Loss: 1.488 Vali Loss: 10.646 Vali Acc: 0.266 Test Loss: 10.646 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.514339923858643
Epoch: 8, Steps: 17 | Train Loss: 2.875 Vali Loss: 22.014 Vali Acc: 0.217 Test Loss: 22.014 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.749773025512695
Epoch: 9, Steps: 17 | Train Loss: 3.584 Vali Loss: 21.749 Vali Acc: 0.202 Test Loss: 21.749 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 16.545976400375366
Epoch: 10, Steps: 17 | Train Loss: 3.744 Vali Loss: 26.172 Vali Acc: 0.247 Test Loss: 26.172 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.83307719230652
Epoch: 11, Steps: 17 | Train Loss: 1.790 Vali Loss: 24.933 Vali Acc: 0.251 Test Loss: 24.933 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.351120710372925
Epoch: 12, Steps: 17 | Train Loss: 1.637 Vali Loss: 20.417 Vali Acc: 0.285 Test Loss: 20.417 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.226071834564209
Epoch: 13, Steps: 17 | Train Loss: 2.246 Vali Loss: 27.864 Vali Acc: 0.243 Test Loss: 27.864 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 17.443048000335693
Epoch: 14, Steps: 17 | Train Loss: 3.135 Vali Loss: 35.766 Vali Acc: 0.236 Test Loss: 35.766 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 17247236
model size : 85.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 48.88474488258362
Epoch: 1, Steps: 17 | Train Loss: 2.932 Vali Loss: 4.926 Vali Acc: 0.270 Test Loss: 4.926 Test Acc: 0.270
Validation loss decreased (inf --> -0.269913).  Saving model ...
Epoch: 2 cost time: 47.57341289520264
Epoch: 2, Steps: 17 | Train Loss: 3.615 Vali Loss: 5.689 Vali Acc: 0.259 Test Loss: 5.689 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.18195700645447
Epoch: 3, Steps: 17 | Train Loss: 3.778 Vali Loss: 7.214 Vali Acc: 0.236 Test Loss: 7.214 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 42.69774627685547
Epoch: 4, Steps: 17 | Train Loss: 3.489 Vali Loss: 6.752 Vali Acc: 0.285 Test Loss: 6.752 Test Acc: 0.285
Validation loss decreased (-0.269913 --> -0.285104).  Saving model ...
Epoch: 5 cost time: 46.12831687927246
Epoch: 5, Steps: 17 | Train Loss: 2.974 Vali Loss: 7.393 Vali Acc: 0.251 Test Loss: 7.393 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 41.828874349594116
Epoch: 6, Steps: 17 | Train Loss: 3.682 Vali Loss: 6.655 Vali Acc: 0.270 Test Loss: 6.655 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 49.06809329986572
Epoch: 7, Steps: 17 | Train Loss: 3.292 Vali Loss: 9.843 Vali Acc: 0.243 Test Loss: 9.843 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 46.51932501792908
Epoch: 8, Steps: 17 | Train Loss: 2.607 Vali Loss: 8.924 Vali Acc: 0.228 Test Loss: 8.924 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 45.41050958633423
Epoch: 9, Steps: 17 | Train Loss: 3.269 Vali Loss: 9.270 Vali Acc: 0.270 Test Loss: 9.270 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 49.16894268989563
Epoch: 10, Steps: 17 | Train Loss: 2.076 Vali Loss: 12.922 Vali Acc: 0.289 Test Loss: 12.922 Test Acc: 0.289
Validation loss decreased (-0.285104 --> -0.288844).  Saving model ...
Epoch: 11 cost time: 40.05539345741272
Epoch: 11, Steps: 17 | Train Loss: 3.240 Vali Loss: 18.154 Vali Acc: 0.278 Test Loss: 18.154 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 48.85932540893555
Epoch: 12, Steps: 17 | Train Loss: 2.905 Vali Loss: 14.078 Vali Acc: 0.243 Test Loss: 14.078 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 42.67890644073486
Epoch: 13, Steps: 17 | Train Loss: 4.782 Vali Loss: 18.292 Vali Acc: 0.247 Test Loss: 18.292 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 46.377686977386475
Epoch: 14, Steps: 17 | Train Loss: 2.406 Vali Loss: 16.040 Vali Acc: 0.285 Test Loss: 16.040 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 47.8599648475647
Epoch: 15, Steps: 17 | Train Loss: 3.847 Vali Loss: 16.068 Vali Acc: 0.247 Test Loss: 16.068 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 42.972980976104736
Epoch: 16, Steps: 17 | Train Loss: 2.741 Vali Loss: 21.191 Vali Acc: 0.262 Test Loss: 21.191 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 47.97396540641785
Epoch: 17, Steps: 17 | Train Loss: 2.745 Vali Loss: 17.110 Vali Acc: 0.243 Test Loss: 17.110 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 44.148168087005615
Epoch: 18, Steps: 17 | Train Loss: 2.369 Vali Loss: 19.670 Vali Acc: 0.236 Test Loss: 19.670 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 48.318248987197876
Epoch: 19, Steps: 17 | Train Loss: 3.556 Vali Loss: 20.219 Vali Acc: 0.274 Test Loss: 20.219 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 44.94973874092102
Epoch: 20, Steps: 17 | Train Loss: 2.450 Vali Loss: 21.128 Vali Acc: 0.293 Test Loss: 21.128 Test Acc: 0.293
Validation loss decreased (-0.288844 --> -0.292564).  Saving model ...
Epoch: 21 cost time: 42.473549127578735
Epoch: 21, Steps: 17 | Train Loss: 2.201 Vali Loss: 27.283 Vali Acc: 0.266 Test Loss: 27.283 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 49.54044485092163
Epoch: 22, Steps: 17 | Train Loss: 2.748 Vali Loss: 24.868 Vali Acc: 0.255 Test Loss: 24.868 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 43.794273138046265
Epoch: 23, Steps: 17 | Train Loss: 2.240 Vali Loss: 26.726 Vali Acc: 0.266 Test Loss: 26.726 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 47.3296639919281
Epoch: 24, Steps: 17 | Train Loss: 2.343 Vali Loss: 24.328 Vali Acc: 0.278 Test Loss: 24.328 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 45.94214415550232
Epoch: 25, Steps: 17 | Train Loss: 2.682 Vali Loss: 28.972 Vali Acc: 0.247 Test Loss: 28.972 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 50.753936767578125
Epoch: 26, Steps: 17 | Train Loss: 2.755 Vali Loss: 30.676 Vali Acc: 0.262 Test Loss: 30.676 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 50.68280267715454
Epoch: 27, Steps: 17 | Train Loss: 1.448 Vali Loss: 31.197 Vali Acc: 0.289 Test Loss: 31.197 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 45.05156970024109
Epoch: 28, Steps: 17 | Train Loss: 1.172 Vali Loss: 28.386 Vali Acc: 0.274 Test Loss: 28.386 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 47.31835865974426
Epoch: 29, Steps: 17 | Train Loss: 2.629 Vali Loss: 31.162 Vali Acc: 0.274 Test Loss: 31.162 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 50.520962715148926
Epoch: 30, Steps: 17 | Train Loss: 1.660 Vali Loss: 31.695 Vali Acc: 0.278 Test Loss: 31.695 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 39.661712646484375
Epoch: 1, Steps: 17 | Train Loss: 2.957 Vali Loss: 4.238 Vali Acc: 0.262 Test Loss: 4.238 Test Acc: 0.262
Validation loss decreased (inf --> -0.262315).  Saving model ...
Epoch: 2 cost time: 40.216304540634155
Epoch: 2, Steps: 17 | Train Loss: 3.354 Vali Loss: 6.159 Vali Acc: 0.255 Test Loss: 6.159 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 38.198517084121704
Epoch: 3, Steps: 17 | Train Loss: 5.614 Vali Loss: 8.108 Vali Acc: 0.247 Test Loss: 8.108 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 40.35689353942871
Epoch: 4, Steps: 17 | Train Loss: 4.181 Vali Loss: 5.008 Vali Acc: 0.255 Test Loss: 5.008 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 43.18905210494995
Epoch: 5, Steps: 17 | Train Loss: 2.627 Vali Loss: 6.593 Vali Acc: 0.270 Test Loss: 6.593 Test Acc: 0.270
Validation loss decreased (-0.262315 --> -0.269896).  Saving model ...
Epoch: 6 cost time: 35.44435381889343
Epoch: 6, Steps: 17 | Train Loss: 2.459 Vali Loss: 9.264 Vali Acc: 0.274 Test Loss: 9.264 Test Acc: 0.274
Validation loss decreased (-0.269896 --> -0.273672).  Saving model ...
Epoch: 7 cost time: 38.11465358734131
Epoch: 7, Steps: 17 | Train Loss: 3.065 Vali Loss: 13.143 Vali Acc: 0.274 Test Loss: 13.143 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 37.53988289833069
Epoch: 8, Steps: 17 | Train Loss: 3.168 Vali Loss: 6.045 Vali Acc: 0.289 Test Loss: 6.045 Test Acc: 0.289
Validation loss decreased (-0.273672 --> -0.288913).  Saving model ...
Epoch: 9 cost time: 32.04359841346741
Epoch: 9, Steps: 17 | Train Loss: 2.487 Vali Loss: 15.195 Vali Acc: 0.262 Test Loss: 15.195 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 37.1207480430603
Epoch: 10, Steps: 17 | Train Loss: 2.706 Vali Loss: 9.937 Vali Acc: 0.278 Test Loss: 9.937 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 38.249281883239746
Epoch: 11, Steps: 17 | Train Loss: 1.835 Vali Loss: 12.974 Vali Acc: 0.240 Test Loss: 12.974 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.97919225692749
Epoch: 12, Steps: 17 | Train Loss: 2.951 Vali Loss: 10.525 Vali Acc: 0.278 Test Loss: 10.525 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 38.53368282318115
Epoch: 13, Steps: 17 | Train Loss: 3.898 Vali Loss: 25.439 Vali Acc: 0.259 Test Loss: 25.439 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 38.84030604362488
Epoch: 14, Steps: 17 | Train Loss: 3.285 Vali Loss: 20.598 Vali Acc: 0.240 Test Loss: 20.598 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 33.49550724029541
Epoch: 15, Steps: 17 | Train Loss: 4.904 Vali Loss: 17.323 Vali Acc: 0.251 Test Loss: 17.323 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 35.39557075500488
Epoch: 16, Steps: 17 | Train Loss: 2.063 Vali Loss: 21.532 Vali Acc: 0.259 Test Loss: 21.532 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 36.86155104637146
Epoch: 17, Steps: 17 | Train Loss: 2.612 Vali Loss: 16.476 Vali Acc: 0.266 Test Loss: 16.476 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 35.254029750823975
Epoch: 18, Steps: 17 | Train Loss: 2.574 Vali Loss: 22.030 Vali Acc: 0.255 Test Loss: 22.030 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 36.04368352890015
Epoch: 1, Steps: 17 | Train Loss: 2.532 Vali Loss: 2.826 Vali Acc: 0.259 Test Loss: 2.826 Test Acc: 0.259
Validation loss decreased (inf --> -0.258527).  Saving model ...
Epoch: 2 cost time: 33.96920847892761
Epoch: 2, Steps: 17 | Train Loss: 2.908 Vali Loss: 5.078 Vali Acc: 0.274 Test Loss: 5.078 Test Acc: 0.274
Validation loss decreased (-0.258527 --> -0.273713).  Saving model ...
Epoch: 3 cost time: 29.90360736846924
Epoch: 3, Steps: 17 | Train Loss: 4.285 Vali Loss: 6.395 Vali Acc: 0.259 Test Loss: 6.395 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.97016787528992
Epoch: 4, Steps: 17 | Train Loss: 2.816 Vali Loss: 6.696 Vali Acc: 0.224 Test Loss: 6.696 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.18517017364502
Epoch: 5, Steps: 17 | Train Loss: 4.318 Vali Loss: 11.020 Vali Acc: 0.243 Test Loss: 11.020 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.146961212158203
Epoch: 6, Steps: 17 | Train Loss: 3.512 Vali Loss: 11.867 Vali Acc: 0.221 Test Loss: 11.867 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.518383026123047
Epoch: 7, Steps: 17 | Train Loss: 5.031 Vali Loss: 25.303 Vali Acc: 0.255 Test Loss: 25.303 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.44958758354187
Epoch: 8, Steps: 17 | Train Loss: 4.434 Vali Loss: 11.297 Vali Acc: 0.274 Test Loss: 11.297 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 34.52109622955322
Epoch: 9, Steps: 17 | Train Loss: 2.908 Vali Loss: 16.705 Vali Acc: 0.255 Test Loss: 16.705 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 30.100345134735107
Epoch: 10, Steps: 17 | Train Loss: 3.975 Vali Loss: 20.037 Vali Acc: 0.236 Test Loss: 20.037 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 32.043325662612915
Epoch: 11, Steps: 17 | Train Loss: 8.015 Vali Loss: 30.682 Vali Acc: 0.255 Test Loss: 30.682 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 34.00273323059082
Epoch: 12, Steps: 17 | Train Loss: 3.011 Vali Loss: 15.947 Vali Acc: 0.274 Test Loss: 15.947 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 23.993600606918335
Epoch: 1, Steps: 17 | Train Loss: 2.504 Vali Loss: 3.493 Vali Acc: 0.259 Test Loss: 3.493 Test Acc: 0.259
Validation loss decreased (inf --> -0.258520).  Saving model ...
Epoch: 2 cost time: 20.822490453720093
Epoch: 2, Steps: 17 | Train Loss: 2.177 Vali Loss: 3.770 Vali Acc: 0.251 Test Loss: 3.770 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.94851064682007
Epoch: 3, Steps: 17 | Train Loss: 3.889 Vali Loss: 8.389 Vali Acc: 0.236 Test Loss: 8.389 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 26.35120391845703
Epoch: 4, Steps: 17 | Train Loss: 2.977 Vali Loss: 7.387 Vali Acc: 0.232 Test Loss: 7.387 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 26.60521936416626
Epoch: 5, Steps: 17 | Train Loss: 4.784 Vali Loss: 11.867 Vali Acc: 0.251 Test Loss: 11.867 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 24.86756157875061
Epoch: 6, Steps: 17 | Train Loss: 4.344 Vali Loss: 14.490 Vali Acc: 0.259 Test Loss: 14.490 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 25.89986228942871
Epoch: 7, Steps: 17 | Train Loss: 2.420 Vali Loss: 12.730 Vali Acc: 0.308 Test Loss: 12.730 Test Acc: 0.308
Validation loss decreased (-0.258520 --> -0.307857).  Saving model ...
Epoch: 8 cost time: 25.27970051765442
Epoch: 8, Steps: 17 | Train Loss: 3.314 Vali Loss: 14.177 Vali Acc: 0.259 Test Loss: 14.177 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.889890909194946
Epoch: 9, Steps: 17 | Train Loss: 2.952 Vali Loss: 15.059 Vali Acc: 0.232 Test Loss: 15.059 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.411508321762085
Epoch: 10, Steps: 17 | Train Loss: 2.560 Vali Loss: 15.066 Vali Acc: 0.274 Test Loss: 15.066 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.379139184951782
Epoch: 11, Steps: 17 | Train Loss: 2.285 Vali Loss: 24.082 Vali Acc: 0.266 Test Loss: 24.082 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.734729051589966
Epoch: 12, Steps: 17 | Train Loss: 1.664 Vali Loss: 25.575 Vali Acc: 0.270 Test Loss: 25.575 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 28.705238342285156
Epoch: 13, Steps: 17 | Train Loss: 2.837 Vali Loss: 24.850 Vali Acc: 0.240 Test Loss: 24.850 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 26.707690238952637
Epoch: 14, Steps: 17 | Train Loss: 2.719 Vali Loss: 22.282 Vali Acc: 0.274 Test Loss: 22.282 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 21.221394062042236
Epoch: 15, Steps: 17 | Train Loss: 2.993 Vali Loss: 30.027 Vali Acc: 0.236 Test Loss: 30.027 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 29.344001531600952
Epoch: 16, Steps: 17 | Train Loss: 2.397 Vali Loss: 32.133 Vali Acc: 0.259 Test Loss: 32.133 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 28.375218868255615
Epoch: 17, Steps: 17 | Train Loss: 5.041 Vali Loss: 27.175 Vali Acc: 0.266 Test Loss: 27.175 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.75646138191223
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 3.726 Vali Acc: 0.259 Test Loss: 3.726 Test Acc: 0.259
Validation loss decreased (inf --> -0.258518).  Saving model ...
Epoch: 2 cost time: 16.953178882598877
Epoch: 2, Steps: 17 | Train Loss: 2.765 Vali Loss: 8.122 Vali Acc: 0.266 Test Loss: 8.122 Test Acc: 0.266
Validation loss decreased (-0.258518 --> -0.266078).  Saving model ...
Epoch: 3 cost time: 16.29946208000183
Epoch: 3, Steps: 17 | Train Loss: 3.363 Vali Loss: 5.452 Vali Acc: 0.278 Test Loss: 5.452 Test Acc: 0.278
Validation loss decreased (-0.266078 --> -0.277512).  Saving model ...
Epoch: 4 cost time: 23.1083562374115
Epoch: 4, Steps: 17 | Train Loss: 1.888 Vali Loss: 6.468 Vali Acc: 0.274 Test Loss: 6.468 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.290953397750854
Epoch: 5, Steps: 17 | Train Loss: 2.090 Vali Loss: 10.788 Vali Acc: 0.247 Test Loss: 10.788 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.182928323745728
Epoch: 6, Steps: 17 | Train Loss: 3.282 Vali Loss: 10.593 Vali Acc: 0.240 Test Loss: 10.593 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.05178737640381
Epoch: 7, Steps: 17 | Train Loss: 3.365 Vali Loss: 9.696 Vali Acc: 0.270 Test Loss: 9.696 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.62746500968933
Epoch: 8, Steps: 17 | Train Loss: 2.473 Vali Loss: 11.785 Vali Acc: 0.243 Test Loss: 11.785 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.519357442855835
Epoch: 9, Steps: 17 | Train Loss: 2.137 Vali Loss: 12.169 Vali Acc: 0.274 Test Loss: 12.169 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.48863697052002
Epoch: 10, Steps: 17 | Train Loss: 1.449 Vali Loss: 23.737 Vali Acc: 0.278 Test Loss: 23.737 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.147903203964233
Epoch: 11, Steps: 17 | Train Loss: 2.195 Vali Loss: 25.615 Vali Acc: 0.251 Test Loss: 25.615 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.782941818237305
Epoch: 12, Steps: 17 | Train Loss: 1.744 Vali Loss: 21.441 Vali Acc: 0.251 Test Loss: 21.441 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.907780170440674
Epoch: 13, Steps: 17 | Train Loss: 1.737 Vali Loss: 31.037 Vali Acc: 0.262 Test Loss: 31.037 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.491406679153442
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 6.094 Vali Acc: 0.259 Test Loss: 6.094 Test Acc: 0.259
Validation loss decreased (inf --> -0.258494).  Saving model ...
Epoch: 2 cost time: 19.52279281616211
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 3.754 Vali Acc: 0.243 Test Loss: 3.754 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.39775848388672
Epoch: 3, Steps: 17 | Train Loss: 1.643 Vali Loss: 9.876 Vali Acc: 0.251 Test Loss: 9.876 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.65331506729126
Epoch: 4, Steps: 17 | Train Loss: 1.850 Vali Loss: 4.985 Vali Acc: 0.232 Test Loss: 4.985 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.010969400405884
Epoch: 5, Steps: 17 | Train Loss: 2.654 Vali Loss: 13.906 Vali Acc: 0.255 Test Loss: 13.906 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.771583795547485
Epoch: 6, Steps: 17 | Train Loss: 3.029 Vali Loss: 15.260 Vali Acc: 0.259 Test Loss: 15.260 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.31711173057556
Epoch: 7, Steps: 17 | Train Loss: 1.564 Vali Loss: 8.770 Vali Acc: 0.236 Test Loss: 8.770 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.84575843811035
Epoch: 8, Steps: 17 | Train Loss: 2.969 Vali Loss: 17.648 Vali Acc: 0.221 Test Loss: 17.648 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.132222414016724
Epoch: 9, Steps: 17 | Train Loss: 1.543 Vali Loss: 31.215 Vali Acc: 0.259 Test Loss: 31.215 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 17.79563617706299
Epoch: 10, Steps: 17 | Train Loss: 2.328 Vali Loss: 27.094 Vali Acc: 0.247 Test Loss: 27.094 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.409808874130249
Epoch: 11, Steps: 17 | Train Loss: 2.866 Vali Loss: 26.829 Vali Acc: 0.278 Test Loss: 26.829 Test Acc: 0.278
Validation loss decreased (-0.258494 --> -0.277298).  Saving model ...
Epoch: 12 cost time: 16.405449867248535
Epoch: 12, Steps: 17 | Train Loss: 1.620 Vali Loss: 19.629 Vali Acc: 0.251 Test Loss: 19.629 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.2950336933136
Epoch: 13, Steps: 17 | Train Loss: 2.881 Vali Loss: 29.969 Vali Acc: 0.255 Test Loss: 29.969 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.91091012954712
Epoch: 14, Steps: 17 | Train Loss: 1.799 Vali Loss: 31.333 Vali Acc: 0.251 Test Loss: 31.333 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.229844331741333
Epoch: 15, Steps: 17 | Train Loss: 3.871 Vali Loss: 28.437 Vali Acc: 0.251 Test Loss: 28.437 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.503984689712524
Epoch: 16, Steps: 17 | Train Loss: 3.822 Vali Loss: 47.755 Vali Acc: 0.228 Test Loss: 47.755 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.77769684791565
Epoch: 17, Steps: 17 | Train Loss: 6.411 Vali Loss: 42.452 Vali Acc: 0.213 Test Loss: 42.452 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.802453994750977
Epoch: 18, Steps: 17 | Train Loss: 2.630 Vali Loss: 37.296 Vali Acc: 0.243 Test Loss: 37.296 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 20.59052538871765
Epoch: 19, Steps: 17 | Train Loss: 1.953 Vali Loss: 46.403 Vali Acc: 0.232 Test Loss: 46.403 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 17.79115104675293
Epoch: 20, Steps: 17 | Train Loss: 1.894 Vali Loss: 56.337 Vali Acc: 0.232 Test Loss: 56.337 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 21.17432713508606
Epoch: 21, Steps: 17 | Train Loss: 3.708 Vali Loss: 45.292 Vali Acc: 0.232 Test Loss: 45.292 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.802268028259277
Epoch: 1, Steps: 17 | Train Loss: 1.855 Vali Loss: 6.397 Vali Acc: 0.251 Test Loss: 6.397 Test Acc: 0.251
Validation loss decreased (inf --> -0.250887).  Saving model ...
Epoch: 2 cost time: 14.68718957901001
Epoch: 2, Steps: 17 | Train Loss: 2.202 Vali Loss: 4.764 Vali Acc: 0.247 Test Loss: 4.764 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.0170419216156
Epoch: 3, Steps: 17 | Train Loss: 3.094 Vali Loss: 4.868 Vali Acc: 0.266 Test Loss: 4.868 Test Acc: 0.266
Validation loss decreased (-0.250887 --> -0.266111).  Saving model ...
Epoch: 4 cost time: 16.566033124923706
Epoch: 4, Steps: 17 | Train Loss: 2.335 Vali Loss: 11.657 Vali Acc: 0.243 Test Loss: 11.657 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.290342330932617
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 6.856 Vali Acc: 0.259 Test Loss: 6.856 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.304072856903076
Epoch: 6, Steps: 17 | Train Loss: 1.794 Vali Loss: 12.910 Vali Acc: 0.281 Test Loss: 12.910 Test Acc: 0.281
Validation loss decreased (-0.266111 --> -0.281240).  Saving model ...
Epoch: 7 cost time: 17.556087255477905
Epoch: 7, Steps: 17 | Train Loss: 1.817 Vali Loss: 9.309 Vali Acc: 0.262 Test Loss: 9.309 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.165087223052979
Epoch: 8, Steps: 17 | Train Loss: 1.954 Vali Loss: 14.857 Vali Acc: 0.259 Test Loss: 14.857 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.8529953956604
Epoch: 9, Steps: 17 | Train Loss: 1.910 Vali Loss: 20.424 Vali Acc: 0.266 Test Loss: 20.424 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.04896855354309
Epoch: 10, Steps: 17 | Train Loss: 2.451 Vali Loss: 21.830 Vali Acc: 0.243 Test Loss: 21.830 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.117022275924683
Epoch: 11, Steps: 17 | Train Loss: 2.559 Vali Loss: 21.840 Vali Acc: 0.232 Test Loss: 21.840 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.410712242126465
Epoch: 12, Steps: 17 | Train Loss: 1.841 Vali Loss: 19.432 Vali Acc: 0.251 Test Loss: 19.432 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.33385968208313
Epoch: 13, Steps: 17 | Train Loss: 2.572 Vali Loss: 28.605 Vali Acc: 0.243 Test Loss: 28.605 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.206963300704956
Epoch: 14, Steps: 17 | Train Loss: 2.428 Vali Loss: 25.276 Vali Acc: 0.228 Test Loss: 25.276 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.197124481201172
Epoch: 15, Steps: 17 | Train Loss: 2.530 Vali Loss: 30.522 Vali Acc: 0.213 Test Loss: 30.522 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.440004348754883
Epoch: 16, Steps: 17 | Train Loss: 1.911 Vali Loss: 35.681 Vali Acc: 0.243 Test Loss: 35.681 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.757588863372803
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 5.879 Vali Acc: 0.255 Test Loss: 5.879 Test Acc: 0.255
Validation loss decreased (inf --> -0.254694).  Saving model ...
Epoch: 2 cost time: 18.79930591583252
Epoch: 2, Steps: 17 | Train Loss: 1.854 Vali Loss: 4.786 Vali Acc: 0.278 Test Loss: 4.786 Test Acc: 0.278
Validation loss decreased (-0.254694 --> -0.277519).  Saving model ...
Epoch: 3 cost time: 14.984726905822754
Epoch: 3, Steps: 17 | Train Loss: 1.698 Vali Loss: 4.431 Vali Acc: 0.255 Test Loss: 4.431 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.367438793182373
Epoch: 4, Steps: 17 | Train Loss: 2.466 Vali Loss: 14.082 Vali Acc: 0.247 Test Loss: 14.082 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.64013385772705
Epoch: 5, Steps: 17 | Train Loss: 2.018 Vali Loss: 10.869 Vali Acc: 0.278 Test Loss: 10.869 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.23102307319641
Epoch: 6, Steps: 17 | Train Loss: 2.657 Vali Loss: 8.663 Vali Acc: 0.262 Test Loss: 8.663 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.732065439224243
Epoch: 7, Steps: 17 | Train Loss: 1.690 Vali Loss: 9.777 Vali Acc: 0.240 Test Loss: 9.777 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.08715534210205
Epoch: 8, Steps: 17 | Train Loss: 2.006 Vali Loss: 22.286 Vali Acc: 0.266 Test Loss: 22.286 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.827606201171875
Epoch: 9, Steps: 17 | Train Loss: 2.154 Vali Loss: 11.778 Vali Acc: 0.228 Test Loss: 11.778 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.180071830749512
Epoch: 10, Steps: 17 | Train Loss: 2.255 Vali Loss: 14.759 Vali Acc: 0.255 Test Loss: 14.759 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.568301677703857
Epoch: 11, Steps: 17 | Train Loss: 1.952 Vali Loss: 20.985 Vali Acc: 0.221 Test Loss: 20.985 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.915282487869263
Epoch: 12, Steps: 17 | Train Loss: 1.986 Vali Loss: 17.712 Vali Acc: 0.247 Test Loss: 17.712 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.17529582977295
Epoch: 1, Steps: 17 | Train Loss: 1.754 Vali Loss: 6.654 Vali Acc: 0.251 Test Loss: 6.654 Test Acc: 0.251
Validation loss decreased (inf --> -0.250884).  Saving model ...
Epoch: 2 cost time: 15.116134643554688
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 5.599 Vali Acc: 0.259 Test Loss: 5.599 Test Acc: 0.259
Validation loss decreased (-0.250884 --> -0.258499).  Saving model ...
Epoch: 3 cost time: 18.16461157798767
Epoch: 3, Steps: 17 | Train Loss: 1.388 Vali Loss: 5.883 Vali Acc: 0.232 Test Loss: 5.883 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.476988077163696
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 8.079 Vali Acc: 0.259 Test Loss: 8.079 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.999134302139282
Epoch: 5, Steps: 17 | Train Loss: 1.438 Vali Loss: 10.363 Vali Acc: 0.266 Test Loss: 10.363 Test Acc: 0.266
Validation loss decreased (-0.258499 --> -0.266056).  Saving model ...
Epoch: 6 cost time: 13.167261838912964
Epoch: 6, Steps: 17 | Train Loss: 3.488 Vali Loss: 16.422 Vali Acc: 0.262 Test Loss: 16.422 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.82918119430542
Epoch: 7, Steps: 17 | Train Loss: 3.344 Vali Loss: 10.157 Vali Acc: 0.247 Test Loss: 10.157 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.455273151397705
Epoch: 8, Steps: 17 | Train Loss: 4.172 Vali Loss: 12.227 Vali Acc: 0.240 Test Loss: 12.227 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.176696300506592
Epoch: 9, Steps: 17 | Train Loss: 3.293 Vali Loss: 17.364 Vali Acc: 0.224 Test Loss: 17.364 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.69335675239563
Epoch: 10, Steps: 17 | Train Loss: 2.267 Vali Loss: 28.638 Vali Acc: 0.240 Test Loss: 28.638 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.733147382736206
Epoch: 11, Steps: 17 | Train Loss: 3.872 Vali Loss: 37.249 Vali Acc: 0.240 Test Loss: 37.249 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.885186433792114
Epoch: 12, Steps: 17 | Train Loss: 2.570 Vali Loss: 30.082 Vali Acc: 0.209 Test Loss: 30.082 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.835225820541382
Epoch: 13, Steps: 17 | Train Loss: 1.567 Vali Loss: 36.421 Vali Acc: 0.251 Test Loss: 36.421 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.614552974700928
Epoch: 14, Steps: 17 | Train Loss: 2.133 Vali Loss: 34.167 Vali Acc: 0.247 Test Loss: 34.167 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 15.906115293502808
Epoch: 15, Steps: 17 | Train Loss: 2.548 Vali Loss: 35.251 Vali Acc: 0.224 Test Loss: 35.251 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.531299114227295
Epoch: 1, Steps: 17 | Train Loss: 1.732 Vali Loss: 4.609 Vali Acc: 0.251 Test Loss: 4.609 Test Acc: 0.251
Validation loss decreased (inf --> -0.250904).  Saving model ...
Epoch: 2 cost time: 16.22895884513855
Epoch: 2, Steps: 17 | Train Loss: 2.039 Vali Loss: 7.755 Vali Acc: 0.266 Test Loss: 7.755 Test Acc: 0.266
Validation loss decreased (-0.250904 --> -0.266082).  Saving model ...
Epoch: 3 cost time: 18.534860849380493
Epoch: 3, Steps: 17 | Train Loss: 2.067 Vali Loss: 6.171 Vali Acc: 0.232 Test Loss: 6.171 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.40885305404663
Epoch: 4, Steps: 17 | Train Loss: 2.091 Vali Loss: 4.932 Vali Acc: 0.259 Test Loss: 4.932 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.710413217544556
Epoch: 5, Steps: 17 | Train Loss: 2.402 Vali Loss: 10.986 Vali Acc: 0.240 Test Loss: 10.986 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.187857151031494
Epoch: 6, Steps: 17 | Train Loss: 3.059 Vali Loss: 19.791 Vali Acc: 0.262 Test Loss: 19.791 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.67083215713501
Epoch: 7, Steps: 17 | Train Loss: 3.258 Vali Loss: 14.249 Vali Acc: 0.243 Test Loss: 14.249 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.02656888961792
Epoch: 8, Steps: 17 | Train Loss: 2.266 Vali Loss: 13.710 Vali Acc: 0.217 Test Loss: 13.710 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.60343313217163
Epoch: 9, Steps: 17 | Train Loss: 1.329 Vali Loss: 15.137 Vali Acc: 0.240 Test Loss: 15.137 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.338518381118774
Epoch: 10, Steps: 17 | Train Loss: 2.210 Vali Loss: 19.348 Vali Acc: 0.281 Test Loss: 19.348 Test Acc: 0.281
Validation loss decreased (-0.266082 --> -0.281175).  Saving model ...
Epoch: 11 cost time: 11.869865417480469
Epoch: 11, Steps: 17 | Train Loss: 2.750 Vali Loss: 19.348 Vali Acc: 0.247 Test Loss: 19.348 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.78545618057251
Epoch: 12, Steps: 17 | Train Loss: 3.451 Vali Loss: 22.707 Vali Acc: 0.236 Test Loss: 22.707 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.344595909118652
Epoch: 13, Steps: 17 | Train Loss: 3.927 Vali Loss: 28.778 Vali Acc: 0.224 Test Loss: 28.778 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.631235837936401
Epoch: 14, Steps: 17 | Train Loss: 1.976 Vali Loss: 29.641 Vali Acc: 0.228 Test Loss: 29.641 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.7700936794281
Epoch: 15, Steps: 17 | Train Loss: 2.761 Vali Loss: 32.267 Vali Acc: 0.251 Test Loss: 32.267 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.73062539100647
Epoch: 16, Steps: 17 | Train Loss: 2.822 Vali Loss: 29.922 Vali Acc: 0.221 Test Loss: 29.922 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.85691738128662
Epoch: 17, Steps: 17 | Train Loss: 3.854 Vali Loss: 43.560 Vali Acc: 0.240 Test Loss: 43.560 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.235447645187378
Epoch: 18, Steps: 17 | Train Loss: 3.570 Vali Loss: 45.928 Vali Acc: 0.243 Test Loss: 45.928 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.226439952850342
Epoch: 19, Steps: 17 | Train Loss: 2.796 Vali Loss: 44.170 Vali Acc: 0.236 Test Loss: 44.170 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.228490829467773
Epoch: 20, Steps: 17 | Train Loss: 3.990 Vali Loss: 42.700 Vali Acc: 0.262 Test Loss: 42.700 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 15674372
model size : 79.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 35.5407657623291
Epoch: 1, Steps: 17 | Train Loss: 2.280 Vali Loss: 3.825 Vali Acc: 0.278 Test Loss: 3.825 Test Acc: 0.278
Validation loss decreased (inf --> -0.277528).  Saving model ...
Epoch: 2 cost time: 43.990657329559326
Epoch: 2, Steps: 17 | Train Loss: 2.983 Vali Loss: 6.340 Vali Acc: 0.255 Test Loss: 6.340 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.415444135665894
Epoch: 3, Steps: 17 | Train Loss: 3.981 Vali Loss: 4.273 Vali Acc: 0.247 Test Loss: 4.273 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.31316900253296
Epoch: 4, Steps: 17 | Train Loss: 3.503 Vali Loss: 10.666 Vali Acc: 0.278 Test Loss: 10.666 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 43.46107459068298
Epoch: 5, Steps: 17 | Train Loss: 4.225 Vali Loss: 6.250 Vali Acc: 0.289 Test Loss: 6.250 Test Acc: 0.289
Validation loss decreased (-0.277528 --> -0.288911).  Saving model ...
Epoch: 6 cost time: 37.373894691467285
Epoch: 6, Steps: 17 | Train Loss: 5.809 Vali Loss: 12.707 Vali Acc: 0.251 Test Loss: 12.707 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 45.98204708099365
Epoch: 7, Steps: 17 | Train Loss: 6.441 Vali Loss: 12.913 Vali Acc: 0.224 Test Loss: 12.913 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 44.31744337081909
Epoch: 8, Steps: 17 | Train Loss: 3.195 Vali Loss: 8.919 Vali Acc: 0.224 Test Loss: 8.919 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 38.76620650291443
Epoch: 9, Steps: 17 | Train Loss: 4.058 Vali Loss: 12.190 Vali Acc: 0.297 Test Loss: 12.190 Test Acc: 0.297
Validation loss decreased (-0.288911 --> -0.296456).  Saving model ...
Epoch: 10 cost time: 39.97122240066528
Epoch: 10, Steps: 17 | Train Loss: 3.442 Vali Loss: 14.939 Vali Acc: 0.247 Test Loss: 14.939 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 35.87288737297058
Epoch: 11, Steps: 17 | Train Loss: 3.612 Vali Loss: 15.126 Vali Acc: 0.293 Test Loss: 15.126 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 32.052250623703
Epoch: 12, Steps: 17 | Train Loss: 3.156 Vali Loss: 10.863 Vali Acc: 0.316 Test Loss: 10.863 Test Acc: 0.316
Validation loss decreased (-0.296456 --> -0.315481).  Saving model ...
Epoch: 13 cost time: 44.824771881103516
Epoch: 13, Steps: 17 | Train Loss: 3.635 Vali Loss: 13.672 Vali Acc: 0.259 Test Loss: 13.672 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 41.07534313201904
Epoch: 14, Steps: 17 | Train Loss: 2.702 Vali Loss: 14.473 Vali Acc: 0.289 Test Loss: 14.473 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 36.723161458969116
Epoch: 15, Steps: 17 | Train Loss: 3.548 Vali Loss: 22.305 Vali Acc: 0.270 Test Loss: 22.305 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 40.16531491279602
Epoch: 16, Steps: 17 | Train Loss: 3.327 Vali Loss: 14.899 Vali Acc: 0.243 Test Loss: 14.899 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 39.8819043636322
Epoch: 17, Steps: 17 | Train Loss: 2.508 Vali Loss: 17.720 Vali Acc: 0.300 Test Loss: 17.720 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 33.92662739753723
Epoch: 18, Steps: 17 | Train Loss: 2.385 Vali Loss: 24.849 Vali Acc: 0.281 Test Loss: 24.849 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 35.6168007850647
Epoch: 19, Steps: 17 | Train Loss: 2.818 Vali Loss: 22.432 Vali Acc: 0.274 Test Loss: 22.432 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 37.00475025177002
Epoch: 20, Steps: 17 | Train Loss: 2.954 Vali Loss: 18.929 Vali Acc: 0.228 Test Loss: 18.929 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 35.7818865776062
Epoch: 21, Steps: 17 | Train Loss: 3.956 Vali Loss: 26.772 Vali Acc: 0.255 Test Loss: 26.772 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 36.361350536346436
Epoch: 22, Steps: 17 | Train Loss: 2.243 Vali Loss: 23.123 Vali Acc: 0.240 Test Loss: 23.123 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 32.658458948135376
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 3.206 Vali Acc: 0.266 Test Loss: 3.206 Test Acc: 0.266
Validation loss decreased (inf --> -0.266128).  Saving model ...
Epoch: 2 cost time: 32.29755783081055
Epoch: 2, Steps: 17 | Train Loss: 3.936 Vali Loss: 4.335 Vali Acc: 0.266 Test Loss: 4.335 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.785698890686035
Epoch: 3, Steps: 17 | Train Loss: 4.389 Vali Loss: 7.056 Vali Acc: 0.251 Test Loss: 7.056 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.99219012260437
Epoch: 4, Steps: 17 | Train Loss: 3.433 Vali Loss: 7.429 Vali Acc: 0.262 Test Loss: 7.429 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 31.72144627571106
Epoch: 5, Steps: 17 | Train Loss: 3.543 Vali Loss: 10.161 Vali Acc: 0.259 Test Loss: 10.161 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 31.66894841194153
Epoch: 6, Steps: 17 | Train Loss: 3.446 Vali Loss: 12.105 Vali Acc: 0.285 Test Loss: 12.105 Test Acc: 0.285
Validation loss decreased (-0.266128 --> -0.285050).  Saving model ...
Epoch: 7 cost time: 30.92277956008911
Epoch: 7, Steps: 17 | Train Loss: 3.448 Vali Loss: 11.347 Vali Acc: 0.251 Test Loss: 11.347 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.55591869354248
Epoch: 8, Steps: 17 | Train Loss: 3.381 Vali Loss: 9.105 Vali Acc: 0.240 Test Loss: 9.105 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.20348310470581
Epoch: 9, Steps: 17 | Train Loss: 4.423 Vali Loss: 15.397 Vali Acc: 0.270 Test Loss: 15.397 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.20738196372986
Epoch: 10, Steps: 17 | Train Loss: 3.250 Vali Loss: 14.508 Vali Acc: 0.255 Test Loss: 14.508 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 28.66637873649597
Epoch: 11, Steps: 17 | Train Loss: 2.944 Vali Loss: 12.728 Vali Acc: 0.255 Test Loss: 12.728 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 30.589694261550903
Epoch: 12, Steps: 17 | Train Loss: 2.810 Vali Loss: 11.852 Vali Acc: 0.266 Test Loss: 11.852 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 33.3836088180542
Epoch: 13, Steps: 17 | Train Loss: 2.661 Vali Loss: 16.538 Vali Acc: 0.262 Test Loss: 16.538 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 30.865697383880615
Epoch: 14, Steps: 17 | Train Loss: 3.148 Vali Loss: 14.490 Vali Acc: 0.262 Test Loss: 14.490 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 31.13014030456543
Epoch: 15, Steps: 17 | Train Loss: 3.818 Vali Loss: 19.186 Vali Acc: 0.262 Test Loss: 19.186 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 29.150426626205444
Epoch: 16, Steps: 17 | Train Loss: 4.585 Vali Loss: 19.004 Vali Acc: 0.266 Test Loss: 19.004 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.61345100402832
Epoch: 1, Steps: 17 | Train Loss: 2.039 Vali Loss: 3.909 Vali Acc: 0.259 Test Loss: 3.909 Test Acc: 0.259
Validation loss decreased (inf --> -0.258516).  Saving model ...
Epoch: 2 cost time: 28.523418188095093
Epoch: 2, Steps: 17 | Train Loss: 2.769 Vali Loss: 9.200 Vali Acc: 0.262 Test Loss: 9.200 Test Acc: 0.262
Validation loss decreased (-0.258516 --> -0.262265).  Saving model ...
Epoch: 3 cost time: 24.369563102722168
Epoch: 3, Steps: 17 | Train Loss: 4.126 Vali Loss: 9.058 Vali Acc: 0.259 Test Loss: 9.058 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.582995176315308
Epoch: 4, Steps: 17 | Train Loss: 3.482 Vali Loss: 13.871 Vali Acc: 0.236 Test Loss: 13.871 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.865626096725464
Epoch: 5, Steps: 17 | Train Loss: 5.253 Vali Loss: 18.042 Vali Acc: 0.255 Test Loss: 18.042 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.172154426574707
Epoch: 6, Steps: 17 | Train Loss: 4.774 Vali Loss: 15.068 Vali Acc: 0.266 Test Loss: 15.068 Test Acc: 0.266
Validation loss decreased (-0.262265 --> -0.266009).  Saving model ...
Epoch: 7 cost time: 27.90041756629944
Epoch: 7, Steps: 17 | Train Loss: 3.264 Vali Loss: 10.894 Vali Acc: 0.262 Test Loss: 10.894 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 29.85701274871826
Epoch: 8, Steps: 17 | Train Loss: 3.611 Vali Loss: 14.317 Vali Acc: 0.232 Test Loss: 14.317 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.610485792160034
Epoch: 9, Steps: 17 | Train Loss: 3.600 Vali Loss: 17.591 Vali Acc: 0.221 Test Loss: 17.591 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.303159713745117
Epoch: 10, Steps: 17 | Train Loss: 3.599 Vali Loss: 16.927 Vali Acc: 0.236 Test Loss: 16.927 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.51970887184143
Epoch: 11, Steps: 17 | Train Loss: 2.953 Vali Loss: 14.621 Vali Acc: 0.259 Test Loss: 14.621 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 25.559569835662842
Epoch: 12, Steps: 17 | Train Loss: 3.133 Vali Loss: 23.142 Vali Acc: 0.243 Test Loss: 23.142 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 26.84334945678711
Epoch: 13, Steps: 17 | Train Loss: 5.089 Vali Loss: 20.347 Vali Acc: 0.236 Test Loss: 20.347 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 26.57933735847473
Epoch: 14, Steps: 17 | Train Loss: 3.452 Vali Loss: 20.506 Vali Acc: 0.240 Test Loss: 20.506 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.666186571121216
Epoch: 15, Steps: 17 | Train Loss: 2.104 Vali Loss: 28.065 Vali Acc: 0.243 Test Loss: 28.065 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 27.384517669677734
Epoch: 16, Steps: 17 | Train Loss: 2.607 Vali Loss: 21.873 Vali Acc: 0.243 Test Loss: 21.873 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.143892526626587
Epoch: 1, Steps: 17 | Train Loss: 1.905 Vali Loss: 2.945 Vali Acc: 0.266 Test Loss: 2.945 Test Acc: 0.266
Validation loss decreased (inf --> -0.266130).  Saving model ...
Epoch: 2 cost time: 22.85779309272766
Epoch: 2, Steps: 17 | Train Loss: 2.624 Vali Loss: 8.033 Vali Acc: 0.270 Test Loss: 8.033 Test Acc: 0.270
Validation loss decreased (-0.266130 --> -0.269882).  Saving model ...
Epoch: 3 cost time: 20.02333927154541
Epoch: 3, Steps: 17 | Train Loss: 2.549 Vali Loss: 8.154 Vali Acc: 0.240 Test Loss: 8.154 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.695337057113647
Epoch: 4, Steps: 17 | Train Loss: 2.121 Vali Loss: 10.247 Vali Acc: 0.262 Test Loss: 10.247 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.818832397460938
Epoch: 5, Steps: 17 | Train Loss: 2.848 Vali Loss: 9.336 Vali Acc: 0.308 Test Loss: 9.336 Test Acc: 0.308
Validation loss decreased (-0.269882 --> -0.307891).  Saving model ...
Epoch: 6 cost time: 24.782792568206787
Epoch: 6, Steps: 17 | Train Loss: 2.950 Vali Loss: 17.678 Vali Acc: 0.262 Test Loss: 17.678 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.694615364074707
Epoch: 7, Steps: 17 | Train Loss: 4.504 Vali Loss: 15.168 Vali Acc: 0.228 Test Loss: 15.168 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.530314683914185
Epoch: 8, Steps: 17 | Train Loss: 2.701 Vali Loss: 19.707 Vali Acc: 0.243 Test Loss: 19.707 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.23546004295349
Epoch: 9, Steps: 17 | Train Loss: 2.780 Vali Loss: 13.256 Vali Acc: 0.224 Test Loss: 13.256 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.351073265075684
Epoch: 10, Steps: 17 | Train Loss: 2.253 Vali Loss: 19.213 Vali Acc: 0.236 Test Loss: 19.213 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.290735006332397
Epoch: 11, Steps: 17 | Train Loss: 2.162 Vali Loss: 18.862 Vali Acc: 0.259 Test Loss: 18.862 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 22.96843647956848
Epoch: 12, Steps: 17 | Train Loss: 2.357 Vali Loss: 26.618 Vali Acc: 0.243 Test Loss: 26.618 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.61947798728943
Epoch: 13, Steps: 17 | Train Loss: 2.507 Vali Loss: 20.726 Vali Acc: 0.232 Test Loss: 20.726 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 22.590338945388794
Epoch: 14, Steps: 17 | Train Loss: 2.792 Vali Loss: 26.911 Vali Acc: 0.259 Test Loss: 26.911 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.733269929885864
Epoch: 15, Steps: 17 | Train Loss: 2.361 Vali Loss: 25.173 Vali Acc: 0.232 Test Loss: 25.173 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.676395893096924
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 4.496 Vali Acc: 0.243 Test Loss: 4.496 Test Acc: 0.243
Validation loss decreased (inf --> -0.243301).  Saving model ...
Epoch: 2 cost time: 17.198334455490112
Epoch: 2, Steps: 17 | Train Loss: 2.463 Vali Loss: 7.996 Vali Acc: 0.236 Test Loss: 7.996 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.434938669204712
Epoch: 3, Steps: 17 | Train Loss: 2.836 Vali Loss: 6.666 Vali Acc: 0.251 Test Loss: 6.666 Test Acc: 0.251
Validation loss decreased (-0.243301 --> -0.250884).  Saving model ...
Epoch: 4 cost time: 16.928666353225708
Epoch: 4, Steps: 17 | Train Loss: 3.336 Vali Loss: 8.798 Vali Acc: 0.247 Test Loss: 8.798 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.257636308670044
Epoch: 5, Steps: 17 | Train Loss: 3.017 Vali Loss: 7.437 Vali Acc: 0.270 Test Loss: 7.437 Test Acc: 0.270
Validation loss decreased (-0.250884 --> -0.269888).  Saving model ...
Epoch: 6 cost time: 15.561837196350098
Epoch: 6, Steps: 17 | Train Loss: 2.422 Vali Loss: 13.885 Vali Acc: 0.278 Test Loss: 13.885 Test Acc: 0.278
Validation loss decreased (-0.269888 --> -0.277428).  Saving model ...
Epoch: 7 cost time: 14.567856550216675
Epoch: 7, Steps: 17 | Train Loss: 4.452 Vali Loss: 19.903 Vali Acc: 0.266 Test Loss: 19.903 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.614394903182983
Epoch: 8, Steps: 17 | Train Loss: 2.567 Vali Loss: 16.184 Vali Acc: 0.259 Test Loss: 16.184 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.279687881469727
Epoch: 9, Steps: 17 | Train Loss: 2.402 Vali Loss: 25.326 Vali Acc: 0.270 Test Loss: 25.326 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.801775693893433
Epoch: 10, Steps: 17 | Train Loss: 1.984 Vali Loss: 22.539 Vali Acc: 0.281 Test Loss: 22.539 Test Acc: 0.281
Validation loss decreased (-0.277428 --> -0.281143).  Saving model ...
Epoch: 11 cost time: 16.81019377708435
Epoch: 11, Steps: 17 | Train Loss: 2.093 Vali Loss: 18.675 Vali Acc: 0.259 Test Loss: 18.675 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.775931119918823
Epoch: 12, Steps: 17 | Train Loss: 2.196 Vali Loss: 26.344 Vali Acc: 0.266 Test Loss: 26.344 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.242398262023926
Epoch: 13, Steps: 17 | Train Loss: 2.843 Vali Loss: 24.357 Vali Acc: 0.259 Test Loss: 24.357 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.407659530639648
Epoch: 14, Steps: 17 | Train Loss: 1.830 Vali Loss: 24.540 Vali Acc: 0.247 Test Loss: 24.540 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.525502920150757
Epoch: 15, Steps: 17 | Train Loss: 2.430 Vali Loss: 45.480 Vali Acc: 0.240 Test Loss: 45.480 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.300211668014526
Epoch: 16, Steps: 17 | Train Loss: 3.910 Vali Loss: 38.696 Vali Acc: 0.262 Test Loss: 38.696 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.672204971313477
Epoch: 17, Steps: 17 | Train Loss: 5.354 Vali Loss: 38.291 Vali Acc: 0.251 Test Loss: 38.291 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.888651371002197
Epoch: 18, Steps: 17 | Train Loss: 1.825 Vali Loss: 42.467 Vali Acc: 0.247 Test Loss: 42.467 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.78141188621521
Epoch: 19, Steps: 17 | Train Loss: 2.643 Vali Loss: 44.503 Vali Acc: 0.270 Test Loss: 44.503 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 17.326526403427124
Epoch: 20, Steps: 17 | Train Loss: 2.542 Vali Loss: 44.819 Vali Acc: 0.266 Test Loss: 44.819 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.242099523544312
Epoch: 1, Steps: 17 | Train Loss: 1.661 Vali Loss: 3.314 Vali Acc: 0.221 Test Loss: 3.314 Test Acc: 0.221
Validation loss decreased (inf --> -0.220499).  Saving model ...
Epoch: 2 cost time: 13.721155166625977
Epoch: 2, Steps: 17 | Train Loss: 2.419 Vali Loss: 5.479 Vali Acc: 0.236 Test Loss: 5.479 Test Acc: 0.236
Validation loss decreased (-0.220499 --> -0.235687).  Saving model ...
Epoch: 3 cost time: 13.497475624084473
Epoch: 3, Steps: 17 | Train Loss: 1.851 Vali Loss: 5.107 Vali Acc: 0.255 Test Loss: 5.107 Test Acc: 0.255
Validation loss decreased (-0.235687 --> -0.254702).  Saving model ...
Epoch: 4 cost time: 14.556344509124756
Epoch: 4, Steps: 17 | Train Loss: 2.342 Vali Loss: 9.519 Vali Acc: 0.274 Test Loss: 9.519 Test Acc: 0.274
Validation loss decreased (-0.254702 --> -0.273669).  Saving model ...
Epoch: 5 cost time: 15.2324378490448
Epoch: 5, Steps: 17 | Train Loss: 2.300 Vali Loss: 9.338 Vali Acc: 0.247 Test Loss: 9.338 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.204639196395874
Epoch: 6, Steps: 17 | Train Loss: 2.125 Vali Loss: 11.712 Vali Acc: 0.224 Test Loss: 11.712 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.69347858428955
Epoch: 7, Steps: 17 | Train Loss: 1.776 Vali Loss: 9.193 Vali Acc: 0.224 Test Loss: 9.193 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.61443042755127
Epoch: 8, Steps: 17 | Train Loss: 2.401 Vali Loss: 12.847 Vali Acc: 0.251 Test Loss: 12.847 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.633710622787476
Epoch: 9, Steps: 17 | Train Loss: 2.476 Vali Loss: 14.166 Vali Acc: 0.266 Test Loss: 14.166 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.578872203826904
Epoch: 10, Steps: 17 | Train Loss: 2.607 Vali Loss: 17.156 Vali Acc: 0.293 Test Loss: 17.156 Test Acc: 0.293
Validation loss decreased (-0.273669 --> -0.292604).  Saving model ...
Epoch: 11 cost time: 13.049848556518555
Epoch: 11, Steps: 17 | Train Loss: 2.401 Vali Loss: 19.828 Vali Acc: 0.251 Test Loss: 19.828 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.2190260887146
Epoch: 12, Steps: 17 | Train Loss: 1.975 Vali Loss: 16.485 Vali Acc: 0.266 Test Loss: 16.485 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.841408252716064
Epoch: 13, Steps: 17 | Train Loss: 2.327 Vali Loss: 23.972 Vali Acc: 0.240 Test Loss: 23.972 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.817720174789429
Epoch: 14, Steps: 17 | Train Loss: 1.507 Vali Loss: 30.068 Vali Acc: 0.224 Test Loss: 30.068 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.448690176010132
Epoch: 15, Steps: 17 | Train Loss: 1.691 Vali Loss: 27.439 Vali Acc: 0.270 Test Loss: 27.439 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.896314144134521
Epoch: 16, Steps: 17 | Train Loss: 1.692 Vali Loss: 27.969 Vali Acc: 0.240 Test Loss: 27.969 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.365211963653564
Epoch: 17, Steps: 17 | Train Loss: 2.406 Vali Loss: 36.967 Vali Acc: 0.247 Test Loss: 36.967 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.142483711242676
Epoch: 18, Steps: 17 | Train Loss: 2.535 Vali Loss: 42.673 Vali Acc: 0.217 Test Loss: 42.673 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.499083995819092
Epoch: 19, Steps: 17 | Train Loss: 2.940 Vali Loss: 43.829 Vali Acc: 0.236 Test Loss: 43.829 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.407685995101929
Epoch: 20, Steps: 17 | Train Loss: 2.593 Vali Loss: 47.517 Vali Acc: 0.240 Test Loss: 47.517 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.515782833099365
Epoch: 1, Steps: 17 | Train Loss: 1.680 Vali Loss: 3.031 Vali Acc: 0.281 Test Loss: 3.031 Test Acc: 0.281
Validation loss decreased (inf --> -0.281339).  Saving model ...
Epoch: 2 cost time: 13.023241758346558
Epoch: 2, Steps: 17 | Train Loss: 2.135 Vali Loss: 5.871 Vali Acc: 0.228 Test Loss: 5.871 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.188619375228882
Epoch: 3, Steps: 17 | Train Loss: 3.349 Vali Loss: 11.613 Vali Acc: 0.278 Test Loss: 11.613 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.734607219696045
Epoch: 4, Steps: 17 | Train Loss: 3.602 Vali Loss: 7.713 Vali Acc: 0.281 Test Loss: 7.713 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.406370401382446
Epoch: 5, Steps: 17 | Train Loss: 2.462 Vali Loss: 9.447 Vali Acc: 0.266 Test Loss: 9.447 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.053356647491455
Epoch: 6, Steps: 17 | Train Loss: 3.632 Vali Loss: 15.370 Vali Acc: 0.243 Test Loss: 15.370 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.937199831008911
Epoch: 7, Steps: 17 | Train Loss: 3.298 Vali Loss: 12.999 Vali Acc: 0.251 Test Loss: 12.999 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.829094648361206
Epoch: 8, Steps: 17 | Train Loss: 2.981 Vali Loss: 14.048 Vali Acc: 0.243 Test Loss: 14.048 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.57941722869873
Epoch: 9, Steps: 17 | Train Loss: 2.005 Vali Loss: 17.552 Vali Acc: 0.251 Test Loss: 17.552 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.73156476020813
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 19.857 Vali Acc: 0.251 Test Loss: 19.857 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.59103775024414
Epoch: 11, Steps: 17 | Train Loss: 1.813 Vali Loss: 19.729 Vali Acc: 0.255 Test Loss: 19.729 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.466716527938843
Epoch: 1, Steps: 17 | Train Loss: 1.617 Vali Loss: 3.519 Vali Acc: 0.259 Test Loss: 3.519 Test Acc: 0.259
Validation loss decreased (inf --> -0.258520).  Saving model ...
Epoch: 2 cost time: 13.331139087677002
Epoch: 2, Steps: 17 | Train Loss: 2.096 Vali Loss: 6.225 Vali Acc: 0.266 Test Loss: 6.225 Test Acc: 0.266
Validation loss decreased (-0.258520 --> -0.266097).  Saving model ...
Epoch: 3 cost time: 13.486287832260132
Epoch: 3, Steps: 17 | Train Loss: 1.853 Vali Loss: 9.668 Vali Acc: 0.255 Test Loss: 9.668 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.942856311798096
Epoch: 4, Steps: 17 | Train Loss: 2.474 Vali Loss: 5.240 Vali Acc: 0.274 Test Loss: 5.240 Test Acc: 0.274
Validation loss decreased (-0.266097 --> -0.273712).  Saving model ...
Epoch: 5 cost time: 12.973628282546997
Epoch: 5, Steps: 17 | Train Loss: 2.108 Vali Loss: 11.098 Vali Acc: 0.251 Test Loss: 11.098 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.336680889129639
Epoch: 6, Steps: 17 | Train Loss: 4.417 Vali Loss: 7.707 Vali Acc: 0.255 Test Loss: 7.707 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.330581188201904
Epoch: 7, Steps: 17 | Train Loss: 3.752 Vali Loss: 12.592 Vali Acc: 0.285 Test Loss: 12.592 Test Acc: 0.285
Validation loss decreased (-0.273712 --> -0.285045).  Saving model ...
Epoch: 8 cost time: 12.036243438720703
Epoch: 8, Steps: 17 | Train Loss: 2.570 Vali Loss: 17.275 Vali Acc: 0.232 Test Loss: 17.275 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.872264623641968
Epoch: 9, Steps: 17 | Train Loss: 2.270 Vali Loss: 21.176 Vali Acc: 0.274 Test Loss: 21.176 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.420369386672974
Epoch: 10, Steps: 17 | Train Loss: 2.407 Vali Loss: 24.162 Vali Acc: 0.228 Test Loss: 24.162 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.594594478607178
Epoch: 11, Steps: 17 | Train Loss: 2.316 Vali Loss: 19.733 Vali Acc: 0.236 Test Loss: 19.733 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.018688201904297
Epoch: 12, Steps: 17 | Train Loss: 2.266 Vali Loss: 28.845 Vali Acc: 0.251 Test Loss: 28.845 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.445634603500366
Epoch: 13, Steps: 17 | Train Loss: 2.399 Vali Loss: 26.249 Vali Acc: 0.213 Test Loss: 26.249 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.464337587356567
Epoch: 14, Steps: 17 | Train Loss: 2.795 Vali Loss: 20.681 Vali Acc: 0.217 Test Loss: 20.681 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.138720512390137
Epoch: 15, Steps: 17 | Train Loss: 2.575 Vali Loss: 29.257 Vali Acc: 0.247 Test Loss: 29.257 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.537156343460083
Epoch: 16, Steps: 17 | Train Loss: 1.522 Vali Loss: 29.144 Vali Acc: 0.194 Test Loss: 29.144 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.992770195007324
Epoch: 17, Steps: 17 | Train Loss: 2.029 Vali Loss: 33.764 Vali Acc: 0.213 Test Loss: 33.764 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.72947645187378
Epoch: 1, Steps: 17 | Train Loss: 1.631 Vali Loss: 4.213 Vali Acc: 0.255 Test Loss: 4.213 Test Acc: 0.255
Validation loss decreased (inf --> -0.254711).  Saving model ...
Epoch: 2 cost time: 11.609723091125488
Epoch: 2, Steps: 17 | Train Loss: 2.143 Vali Loss: 6.457 Vali Acc: 0.259 Test Loss: 6.457 Test Acc: 0.259
Validation loss decreased (-0.254711 --> -0.258491).  Saving model ...
Epoch: 3 cost time: 12.44179105758667
Epoch: 3, Steps: 17 | Train Loss: 1.909 Vali Loss: 3.131 Vali Acc: 0.297 Test Loss: 3.131 Test Acc: 0.297
Validation loss decreased (-0.258491 --> -0.296547).  Saving model ...
Epoch: 4 cost time: 12.079875946044922
Epoch: 4, Steps: 17 | Train Loss: 2.342 Vali Loss: 12.632 Vali Acc: 0.255 Test Loss: 12.632 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.747819423675537
Epoch: 5, Steps: 17 | Train Loss: 2.099 Vali Loss: 12.515 Vali Acc: 0.247 Test Loss: 12.515 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.719041347503662
Epoch: 6, Steps: 17 | Train Loss: 4.591 Vali Loss: 9.979 Vali Acc: 0.247 Test Loss: 9.979 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.034908294677734
Epoch: 7, Steps: 17 | Train Loss: 4.134 Vali Loss: 16.851 Vali Acc: 0.221 Test Loss: 16.851 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.789283037185669
Epoch: 8, Steps: 17 | Train Loss: 1.775 Vali Loss: 11.728 Vali Acc: 0.274 Test Loss: 11.728 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.006390810012817
Epoch: 9, Steps: 17 | Train Loss: 1.522 Vali Loss: 21.015 Vali Acc: 0.217 Test Loss: 21.015 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.599895715713501
Epoch: 10, Steps: 17 | Train Loss: 2.516 Vali Loss: 20.817 Vali Acc: 0.240 Test Loss: 20.817 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.870954513549805
Epoch: 11, Steps: 17 | Train Loss: 2.057 Vali Loss: 27.638 Vali Acc: 0.240 Test Loss: 27.638 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.198172092437744
Epoch: 12, Steps: 17 | Train Loss: 2.656 Vali Loss: 32.066 Vali Acc: 0.255 Test Loss: 32.066 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.944821834564209
Epoch: 13, Steps: 17 | Train Loss: 2.136 Vali Loss: 34.486 Vali Acc: 0.274 Test Loss: 34.486 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.588248491287231
Epoch: 1, Steps: 17 | Train Loss: 1.586 Vali Loss: 3.874 Vali Acc: 0.255 Test Loss: 3.874 Test Acc: 0.255
Validation loss decreased (inf --> -0.254714).  Saving model ...
Epoch: 2 cost time: 12.79801607131958
Epoch: 2, Steps: 17 | Train Loss: 2.262 Vali Loss: 12.138 Vali Acc: 0.251 Test Loss: 12.138 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.957674741744995
Epoch: 3, Steps: 17 | Train Loss: 2.396 Vali Loss: 6.990 Vali Acc: 0.259 Test Loss: 6.990 Test Acc: 0.259
Validation loss decreased (-0.254714 --> -0.258485).  Saving model ...
Epoch: 4 cost time: 12.280109405517578
Epoch: 4, Steps: 17 | Train Loss: 2.617 Vali Loss: 12.180 Vali Acc: 0.259 Test Loss: 12.180 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.491177082061768
Epoch: 5, Steps: 17 | Train Loss: 2.784 Vali Loss: 11.545 Vali Acc: 0.262 Test Loss: 11.545 Test Acc: 0.262
Validation loss decreased (-0.258485 --> -0.262242).  Saving model ...
Epoch: 6 cost time: 10.897304058074951
Epoch: 6, Steps: 17 | Train Loss: 3.360 Vali Loss: 11.331 Vali Acc: 0.259 Test Loss: 11.331 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.176004648208618
Epoch: 7, Steps: 17 | Train Loss: 2.722 Vali Loss: 14.985 Vali Acc: 0.240 Test Loss: 14.985 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.817418098449707
Epoch: 8, Steps: 17 | Train Loss: 2.618 Vali Loss: 11.283 Vali Acc: 0.236 Test Loss: 11.283 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.896339654922485
Epoch: 9, Steps: 17 | Train Loss: 3.867 Vali Loss: 21.178 Vali Acc: 0.243 Test Loss: 21.178 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.122640609741211
Epoch: 10, Steps: 17 | Train Loss: 2.203 Vali Loss: 18.741 Vali Acc: 0.247 Test Loss: 18.741 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.79736876487732
Epoch: 11, Steps: 17 | Train Loss: 1.761 Vali Loss: 21.049 Vali Acc: 0.251 Test Loss: 21.049 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.572399854660034
Epoch: 12, Steps: 17 | Train Loss: 3.007 Vali Loss: 26.139 Vali Acc: 0.259 Test Loss: 26.139 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.791396856307983
Epoch: 13, Steps: 17 | Train Loss: 1.894 Vali Loss: 26.269 Vali Acc: 0.221 Test Loss: 26.269 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.31678581237793
Epoch: 14, Steps: 17 | Train Loss: 3.084 Vali Loss: 26.021 Vali Acc: 0.213 Test Loss: 26.021 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.987356424331665
Epoch: 15, Steps: 17 | Train Loss: 3.524 Vali Loss: 40.264 Vali Acc: 0.259 Test Loss: 40.264 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 14887940
model size : 76.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 34.40773892402649
Epoch: 1, Steps: 17 | Train Loss: 2.119 Vali Loss: 4.610 Vali Acc: 0.247 Test Loss: 4.610 Test Acc: 0.247
Validation loss decreased (inf --> -0.247102).  Saving model ...
Epoch: 2 cost time: 29.931718587875366
Epoch: 2, Steps: 17 | Train Loss: 3.433 Vali Loss: 9.442 Vali Acc: 0.255 Test Loss: 9.442 Test Acc: 0.255
Validation loss decreased (-0.247102 --> -0.254658).  Saving model ...
Epoch: 3 cost time: 34.651957273483276
Epoch: 3, Steps: 17 | Train Loss: 3.568 Vali Loss: 5.032 Vali Acc: 0.262 Test Loss: 5.032 Test Acc: 0.262
Validation loss decreased (-0.254658 --> -0.262307).  Saving model ...
Epoch: 4 cost time: 33.74097013473511
Epoch: 4, Steps: 17 | Train Loss: 3.318 Vali Loss: 10.571 Vali Acc: 0.255 Test Loss: 10.571 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.872640371322632
Epoch: 5, Steps: 17 | Train Loss: 7.246 Vali Loss: 12.969 Vali Acc: 0.255 Test Loss: 12.969 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 35.160542726516724
Epoch: 6, Steps: 17 | Train Loss: 6.534 Vali Loss: 13.268 Vali Acc: 0.285 Test Loss: 13.268 Test Acc: 0.285
Validation loss decreased (-0.262307 --> -0.285038).  Saving model ...
Epoch: 7 cost time: 34.216819047927856
Epoch: 7, Steps: 17 | Train Loss: 4.682 Vali Loss: 10.706 Vali Acc: 0.240 Test Loss: 10.706 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 35.515010833740234
Epoch: 8, Steps: 17 | Train Loss: 3.594 Vali Loss: 11.650 Vali Acc: 0.243 Test Loss: 11.650 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 31.069817543029785
Epoch: 9, Steps: 17 | Train Loss: 7.065 Vali Loss: 15.026 Vali Acc: 0.224 Test Loss: 15.026 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 35.607311487197876
Epoch: 10, Steps: 17 | Train Loss: 3.371 Vali Loss: 14.319 Vali Acc: 0.259 Test Loss: 14.319 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 34.13263940811157
Epoch: 11, Steps: 17 | Train Loss: 3.281 Vali Loss: 13.659 Vali Acc: 0.262 Test Loss: 13.659 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 32.551323890686035
Epoch: 12, Steps: 17 | Train Loss: 2.833 Vali Loss: 15.414 Vali Acc: 0.224 Test Loss: 15.414 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 34.49397397041321
Epoch: 13, Steps: 17 | Train Loss: 4.376 Vali Loss: 14.336 Vali Acc: 0.255 Test Loss: 14.336 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 35.57903242111206
Epoch: 14, Steps: 17 | Train Loss: 4.268 Vali Loss: 14.742 Vali Acc: 0.247 Test Loss: 14.742 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 37.078333377838135
Epoch: 15, Steps: 17 | Train Loss: 3.309 Vali Loss: 19.846 Vali Acc: 0.243 Test Loss: 19.846 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 30.319307804107666
Epoch: 16, Steps: 17 | Train Loss: 3.063 Vali Loss: 25.804 Vali Acc: 0.232 Test Loss: 25.804 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 31.775171995162964
Epoch: 1, Steps: 17 | Train Loss: 2.105 Vali Loss: 3.456 Vali Acc: 0.293 Test Loss: 3.456 Test Acc: 0.293
Validation loss decreased (inf --> -0.292741).  Saving model ...
Epoch: 2 cost time: 29.6159405708313
Epoch: 2, Steps: 17 | Train Loss: 2.930 Vali Loss: 3.647 Vali Acc: 0.281 Test Loss: 3.647 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.400736331939697
Epoch: 3, Steps: 17 | Train Loss: 3.880 Vali Loss: 6.943 Vali Acc: 0.243 Test Loss: 6.943 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.75821876525879
Epoch: 4, Steps: 17 | Train Loss: 4.417 Vali Loss: 10.598 Vali Acc: 0.255 Test Loss: 10.598 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.888511419296265
Epoch: 5, Steps: 17 | Train Loss: 5.653 Vali Loss: 8.139 Vali Acc: 0.259 Test Loss: 8.139 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.325901746749878
Epoch: 6, Steps: 17 | Train Loss: 3.626 Vali Loss: 11.122 Vali Acc: 0.270 Test Loss: 11.122 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 30.285322427749634
Epoch: 7, Steps: 17 | Train Loss: 3.927 Vali Loss: 18.121 Vali Acc: 0.243 Test Loss: 18.121 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 29.69436240196228
Epoch: 8, Steps: 17 | Train Loss: 4.884 Vali Loss: 8.259 Vali Acc: 0.285 Test Loss: 8.259 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 30.12002658843994
Epoch: 9, Steps: 17 | Train Loss: 4.260 Vali Loss: 10.616 Vali Acc: 0.278 Test Loss: 10.616 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 26.21286392211914
Epoch: 10, Steps: 17 | Train Loss: 4.399 Vali Loss: 10.290 Vali Acc: 0.259 Test Loss: 10.290 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 30.874696969985962
Epoch: 11, Steps: 17 | Train Loss: 4.448 Vali Loss: 11.574 Vali Acc: 0.266 Test Loss: 11.574 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.095389366149902
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 5.991 Vali Acc: 0.266 Test Loss: 5.991 Test Acc: 0.266
Validation loss decreased (inf --> -0.266100).  Saving model ...
Epoch: 2 cost time: 26.62970781326294
Epoch: 2, Steps: 17 | Train Loss: 2.895 Vali Loss: 5.873 Vali Acc: 0.274 Test Loss: 5.873 Test Acc: 0.274
Validation loss decreased (-0.266100 --> -0.273706).  Saving model ...
Epoch: 3 cost time: 24.509597539901733
Epoch: 3, Steps: 17 | Train Loss: 3.220 Vali Loss: 5.351 Vali Acc: 0.266 Test Loss: 5.351 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.31380033493042
Epoch: 4, Steps: 17 | Train Loss: 3.525 Vali Loss: 10.942 Vali Acc: 0.255 Test Loss: 10.942 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.368847131729126
Epoch: 5, Steps: 17 | Train Loss: 5.363 Vali Loss: 9.274 Vali Acc: 0.278 Test Loss: 9.274 Test Acc: 0.278
Validation loss decreased (-0.273706 --> -0.277474).  Saving model ...
Epoch: 6 cost time: 26.904637813568115
Epoch: 6, Steps: 17 | Train Loss: 4.646 Vali Loss: 15.196 Vali Acc: 0.243 Test Loss: 15.196 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.78441333770752
Epoch: 7, Steps: 17 | Train Loss: 3.686 Vali Loss: 13.852 Vali Acc: 0.251 Test Loss: 13.852 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.597581148147583
Epoch: 8, Steps: 17 | Train Loss: 3.268 Vali Loss: 12.281 Vali Acc: 0.232 Test Loss: 12.281 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.76482129096985
Epoch: 9, Steps: 17 | Train Loss: 3.220 Vali Loss: 13.322 Vali Acc: 0.251 Test Loss: 13.322 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.404979944229126
Epoch: 10, Steps: 17 | Train Loss: 2.978 Vali Loss: 22.288 Vali Acc: 0.251 Test Loss: 22.288 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.730998992919922
Epoch: 11, Steps: 17 | Train Loss: 3.221 Vali Loss: 17.229 Vali Acc: 0.228 Test Loss: 17.229 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.947513103485107
Epoch: 12, Steps: 17 | Train Loss: 3.620 Vali Loss: 23.524 Vali Acc: 0.243 Test Loss: 23.524 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 22.43927502632141
Epoch: 13, Steps: 17 | Train Loss: 2.332 Vali Loss: 23.355 Vali Acc: 0.202 Test Loss: 23.355 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 22.91581892967224
Epoch: 14, Steps: 17 | Train Loss: 4.029 Vali Loss: 26.172 Vali Acc: 0.232 Test Loss: 26.172 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 24.59127378463745
Epoch: 15, Steps: 17 | Train Loss: 2.675 Vali Loss: 23.768 Vali Acc: 0.224 Test Loss: 23.768 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.207350492477417
Epoch: 1, Steps: 17 | Train Loss: 1.952 Vali Loss: 4.839 Vali Acc: 0.270 Test Loss: 4.839 Test Acc: 0.270
Validation loss decreased (inf --> -0.269914).  Saving model ...
Epoch: 2 cost time: 20.121896266937256
Epoch: 2, Steps: 17 | Train Loss: 3.118 Vali Loss: 7.547 Vali Acc: 0.236 Test Loss: 7.547 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.24229145050049
Epoch: 3, Steps: 17 | Train Loss: 3.946 Vali Loss: 12.177 Vali Acc: 0.251 Test Loss: 12.177 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.84335470199585
Epoch: 4, Steps: 17 | Train Loss: 4.925 Vali Loss: 7.574 Vali Acc: 0.270 Test Loss: 7.574 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.056305408477783
Epoch: 5, Steps: 17 | Train Loss: 3.865 Vali Loss: 11.025 Vali Acc: 0.266 Test Loss: 11.025 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.690768718719482
Epoch: 6, Steps: 17 | Train Loss: 4.055 Vali Loss: 17.114 Vali Acc: 0.293 Test Loss: 17.114 Test Acc: 0.293
Validation loss decreased (-0.269914 --> -0.292605).  Saving model ...
Epoch: 7 cost time: 20.571449041366577
Epoch: 7, Steps: 17 | Train Loss: 4.414 Vali Loss: 10.358 Vali Acc: 0.293 Test Loss: 10.358 Test Acc: 0.293
Validation loss decreased (-0.292605 --> -0.292672).  Saving model ...
Epoch: 8 cost time: 20.71624183654785
Epoch: 8, Steps: 17 | Train Loss: 2.059 Vali Loss: 11.726 Vali Acc: 0.285 Test Loss: 11.726 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.596903324127197
Epoch: 9, Steps: 17 | Train Loss: 3.301 Vali Loss: 13.705 Vali Acc: 0.262 Test Loss: 13.705 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.454917669296265
Epoch: 10, Steps: 17 | Train Loss: 2.529 Vali Loss: 15.512 Vali Acc: 0.247 Test Loss: 15.512 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.612480878829956
Epoch: 11, Steps: 17 | Train Loss: 1.879 Vali Loss: 22.462 Vali Acc: 0.251 Test Loss: 22.462 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.306716680526733
Epoch: 12, Steps: 17 | Train Loss: 1.972 Vali Loss: 25.140 Vali Acc: 0.255 Test Loss: 25.140 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.63105344772339
Epoch: 13, Steps: 17 | Train Loss: 3.053 Vali Loss: 24.226 Vali Acc: 0.236 Test Loss: 24.226 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.9736065864563
Epoch: 14, Steps: 17 | Train Loss: 3.701 Vali Loss: 28.185 Vali Acc: 0.259 Test Loss: 28.185 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.644405126571655
Epoch: 15, Steps: 17 | Train Loss: 3.058 Vali Loss: 30.899 Vali Acc: 0.270 Test Loss: 30.899 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 19.297449111938477
Epoch: 16, Steps: 17 | Train Loss: 2.157 Vali Loss: 32.785 Vali Acc: 0.240 Test Loss: 32.785 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 19.55359721183777
Epoch: 17, Steps: 17 | Train Loss: 3.489 Vali Loss: 33.234 Vali Acc: 0.259 Test Loss: 33.234 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.65208625793457
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 4.978 Vali Acc: 0.240 Test Loss: 4.978 Test Acc: 0.240
Validation loss decreased (inf --> -0.239494).  Saving model ...
Epoch: 2 cost time: 16.19351553916931
Epoch: 2, Steps: 17 | Train Loss: 2.801 Vali Loss: 8.737 Vali Acc: 0.240 Test Loss: 8.737 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.366747856140137
Epoch: 3, Steps: 17 | Train Loss: 3.356 Vali Loss: 7.047 Vali Acc: 0.224 Test Loss: 7.047 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.05533242225647
Epoch: 4, Steps: 17 | Train Loss: 4.993 Vali Loss: 8.148 Vali Acc: 0.240 Test Loss: 8.148 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.083908796310425
Epoch: 5, Steps: 17 | Train Loss: 4.076 Vali Loss: 12.260 Vali Acc: 0.281 Test Loss: 12.260 Test Acc: 0.281
Validation loss decreased (-0.239494 --> -0.281246).  Saving model ...
Epoch: 6 cost time: 15.51566219329834
Epoch: 6, Steps: 17 | Train Loss: 3.081 Vali Loss: 13.844 Vali Acc: 0.300 Test Loss: 13.844 Test Acc: 0.300
Validation loss decreased (-0.281246 --> -0.300242).  Saving model ...
Epoch: 7 cost time: 14.833229064941406
Epoch: 7, Steps: 17 | Train Loss: 2.978 Vali Loss: 15.765 Vali Acc: 0.278 Test Loss: 15.765 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.236228466033936
Epoch: 8, Steps: 17 | Train Loss: 1.909 Vali Loss: 10.480 Vali Acc: 0.232 Test Loss: 10.480 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.49925208091736
Epoch: 9, Steps: 17 | Train Loss: 3.069 Vali Loss: 15.265 Vali Acc: 0.274 Test Loss: 15.265 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.08443307876587
Epoch: 10, Steps: 17 | Train Loss: 2.937 Vali Loss: 24.812 Vali Acc: 0.262 Test Loss: 24.812 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.850052118301392
Epoch: 11, Steps: 17 | Train Loss: 3.699 Vali Loss: 28.748 Vali Acc: 0.255 Test Loss: 28.748 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.749825239181519
Epoch: 12, Steps: 17 | Train Loss: 2.324 Vali Loss: 28.450 Vali Acc: 0.281 Test Loss: 28.450 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.913097620010376
Epoch: 13, Steps: 17 | Train Loss: 2.391 Vali Loss: 25.202 Vali Acc: 0.247 Test Loss: 25.202 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.260166883468628
Epoch: 14, Steps: 17 | Train Loss: 1.425 Vali Loss: 29.457 Vali Acc: 0.247 Test Loss: 29.457 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.463986158370972
Epoch: 15, Steps: 17 | Train Loss: 2.451 Vali Loss: 39.188 Vali Acc: 0.247 Test Loss: 39.188 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.741977453231812
Epoch: 16, Steps: 17 | Train Loss: 2.460 Vali Loss: 38.420 Vali Acc: 0.262 Test Loss: 38.420 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.408000469207764
Epoch: 1, Steps: 17 | Train Loss: 1.759 Vali Loss: 4.820 Vali Acc: 0.224 Test Loss: 4.820 Test Acc: 0.224
Validation loss decreased (inf --> -0.224286).  Saving model ...
Epoch: 2 cost time: 13.821622610092163
Epoch: 2, Steps: 17 | Train Loss: 2.325 Vali Loss: 6.083 Vali Acc: 0.224 Test Loss: 6.083 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.93952465057373
Epoch: 3, Steps: 17 | Train Loss: 2.531 Vali Loss: 9.848 Vali Acc: 0.247 Test Loss: 9.848 Test Acc: 0.247
Validation loss decreased (-0.224286 --> -0.247050).  Saving model ...
Epoch: 4 cost time: 13.100086450576782
Epoch: 4, Steps: 17 | Train Loss: 3.345 Vali Loss: 7.156 Vali Acc: 0.259 Test Loss: 7.156 Test Acc: 0.259
Validation loss decreased (-0.247050 --> -0.258484).  Saving model ...
Epoch: 5 cost time: 14.675139427185059
Epoch: 5, Steps: 17 | Train Loss: 3.375 Vali Loss: 6.716 Vali Acc: 0.255 Test Loss: 6.716 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.311972618103027
Epoch: 6, Steps: 17 | Train Loss: 2.514 Vali Loss: 15.654 Vali Acc: 0.251 Test Loss: 15.654 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.712049007415771
Epoch: 7, Steps: 17 | Train Loss: 3.882 Vali Loss: 14.417 Vali Acc: 0.266 Test Loss: 14.417 Test Acc: 0.266
Validation loss decreased (-0.258484 --> -0.266016).  Saving model ...
Epoch: 8 cost time: 13.148972272872925
Epoch: 8, Steps: 17 | Train Loss: 2.555 Vali Loss: 13.681 Vali Acc: 0.243 Test Loss: 13.681 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.469906091690063
Epoch: 9, Steps: 17 | Train Loss: 3.034 Vali Loss: 18.090 Vali Acc: 0.251 Test Loss: 18.090 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.529855966567993
Epoch: 10, Steps: 17 | Train Loss: 2.725 Vali Loss: 23.325 Vali Acc: 0.251 Test Loss: 23.325 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.344247341156006
Epoch: 11, Steps: 17 | Train Loss: 2.176 Vali Loss: 26.336 Vali Acc: 0.232 Test Loss: 26.336 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.893216371536255
Epoch: 12, Steps: 17 | Train Loss: 1.547 Vali Loss: 32.126 Vali Acc: 0.262 Test Loss: 32.126 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.158224105834961
Epoch: 13, Steps: 17 | Train Loss: 3.696 Vali Loss: 30.468 Vali Acc: 0.240 Test Loss: 30.468 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.776070594787598
Epoch: 14, Steps: 17 | Train Loss: 2.433 Vali Loss: 29.524 Vali Acc: 0.247 Test Loss: 29.524 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.412734508514404
Epoch: 15, Steps: 17 | Train Loss: 2.395 Vali Loss: 34.004 Vali Acc: 0.221 Test Loss: 34.004 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.390351057052612
Epoch: 16, Steps: 17 | Train Loss: 1.892 Vali Loss: 25.646 Vali Acc: 0.221 Test Loss: 25.646 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.3148193359375
Epoch: 17, Steps: 17 | Train Loss: 2.440 Vali Loss: 35.220 Vali Acc: 0.228 Test Loss: 35.220 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.84691047668457
Epoch: 1, Steps: 17 | Train Loss: 1.639 Vali Loss: 4.001 Vali Acc: 0.243 Test Loss: 4.001 Test Acc: 0.243
Validation loss decreased (inf --> -0.243306).  Saving model ...
Epoch: 2 cost time: 13.071229934692383
Epoch: 2, Steps: 17 | Train Loss: 2.053 Vali Loss: 3.842 Vali Acc: 0.289 Test Loss: 3.842 Test Acc: 0.289
Validation loss decreased (-0.243306 --> -0.288935).  Saving model ...
Epoch: 3 cost time: 12.864815473556519
Epoch: 3, Steps: 17 | Train Loss: 2.309 Vali Loss: 7.640 Vali Acc: 0.262 Test Loss: 7.640 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.514203786849976
Epoch: 4, Steps: 17 | Train Loss: 3.483 Vali Loss: 13.416 Vali Acc: 0.270 Test Loss: 13.416 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.701762676239014
Epoch: 5, Steps: 17 | Train Loss: 2.413 Vali Loss: 8.137 Vali Acc: 0.224 Test Loss: 8.137 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.364567756652832
Epoch: 6, Steps: 17 | Train Loss: 2.031 Vali Loss: 10.757 Vali Acc: 0.240 Test Loss: 10.757 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.138421535491943
Epoch: 7, Steps: 17 | Train Loss: 3.821 Vali Loss: 16.455 Vali Acc: 0.262 Test Loss: 16.455 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.330375909805298
Epoch: 8, Steps: 17 | Train Loss: 2.046 Vali Loss: 12.435 Vali Acc: 0.259 Test Loss: 12.435 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.335976123809814
Epoch: 9, Steps: 17 | Train Loss: 2.564 Vali Loss: 17.092 Vali Acc: 0.243 Test Loss: 17.092 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.828919172286987
Epoch: 10, Steps: 17 | Train Loss: 1.383 Vali Loss: 15.915 Vali Acc: 0.243 Test Loss: 15.915 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.184492349624634
Epoch: 11, Steps: 17 | Train Loss: 2.244 Vali Loss: 21.266 Vali Acc: 0.274 Test Loss: 21.266 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.191983699798584
Epoch: 12, Steps: 17 | Train Loss: 2.822 Vali Loss: 31.687 Vali Acc: 0.255 Test Loss: 31.687 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.299813508987427
Epoch: 1, Steps: 17 | Train Loss: 1.572 Vali Loss: 4.209 Vali Acc: 0.236 Test Loss: 4.209 Test Acc: 0.236
Validation loss decreased (inf --> -0.235699).  Saving model ...
Epoch: 2 cost time: 13.528923034667969
Epoch: 2, Steps: 17 | Train Loss: 1.958 Vali Loss: 4.279 Vali Acc: 0.243 Test Loss: 4.279 Test Acc: 0.243
Validation loss decreased (-0.235699 --> -0.243303).  Saving model ...
Epoch: 3 cost time: 12.657594442367554
Epoch: 3, Steps: 17 | Train Loss: 1.811 Vali Loss: 4.919 Vali Acc: 0.266 Test Loss: 4.919 Test Acc: 0.266
Validation loss decreased (-0.243303 --> -0.266111).  Saving model ...
Epoch: 4 cost time: 12.530596733093262
Epoch: 4, Steps: 17 | Train Loss: 1.572 Vali Loss: 7.842 Vali Acc: 0.255 Test Loss: 7.842 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.90304708480835
Epoch: 5, Steps: 17 | Train Loss: 2.347 Vali Loss: 10.224 Vali Acc: 0.247 Test Loss: 10.224 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.159442901611328
Epoch: 6, Steps: 17 | Train Loss: 1.786 Vali Loss: 7.383 Vali Acc: 0.247 Test Loss: 7.383 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.570042610168457
Epoch: 7, Steps: 17 | Train Loss: 3.445 Vali Loss: 14.404 Vali Acc: 0.262 Test Loss: 14.404 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.484623670578003
Epoch: 8, Steps: 17 | Train Loss: 1.782 Vali Loss: 8.304 Vali Acc: 0.270 Test Loss: 8.304 Test Acc: 0.270
Validation loss decreased (-0.266111 --> -0.269879).  Saving model ...
Epoch: 9 cost time: 11.579747438430786
Epoch: 9, Steps: 17 | Train Loss: 2.353 Vali Loss: 13.613 Vali Acc: 0.243 Test Loss: 13.613 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.175374269485474
Epoch: 10, Steps: 17 | Train Loss: 2.475 Vali Loss: 12.228 Vali Acc: 0.270 Test Loss: 12.228 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.088505268096924
Epoch: 11, Steps: 17 | Train Loss: 2.917 Vali Loss: 15.228 Vali Acc: 0.232 Test Loss: 15.228 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.420472145080566
Epoch: 12, Steps: 17 | Train Loss: 1.831 Vali Loss: 16.501 Vali Acc: 0.251 Test Loss: 16.501 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.296095848083496
Epoch: 13, Steps: 17 | Train Loss: 2.089 Vali Loss: 21.933 Vali Acc: 0.232 Test Loss: 21.933 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.748579978942871
Epoch: 14, Steps: 17 | Train Loss: 2.244 Vali Loss: 22.785 Vali Acc: 0.213 Test Loss: 22.785 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.688036441802979
Epoch: 15, Steps: 17 | Train Loss: 2.059 Vali Loss: 27.476 Vali Acc: 0.209 Test Loss: 27.476 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.71764588356018
Epoch: 16, Steps: 17 | Train Loss: 2.585 Vali Loss: 25.342 Vali Acc: 0.270 Test Loss: 25.342 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.154075145721436
Epoch: 17, Steps: 17 | Train Loss: 1.767 Vali Loss: 33.183 Vali Acc: 0.236 Test Loss: 33.183 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.684018850326538
Epoch: 18, Steps: 17 | Train Loss: 2.105 Vali Loss: 28.589 Vali Acc: 0.255 Test Loss: 28.589 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.706868410110474
Epoch: 1, Steps: 17 | Train Loss: 1.613 Vali Loss: 4.530 Vali Acc: 0.240 Test Loss: 4.530 Test Acc: 0.240
Validation loss decreased (inf --> -0.239498).  Saving model ...
Epoch: 2 cost time: 11.899460077285767
Epoch: 2, Steps: 17 | Train Loss: 2.015 Vali Loss: 5.213 Vali Acc: 0.247 Test Loss: 5.213 Test Acc: 0.247
Validation loss decreased (-0.239498 --> -0.247096).  Saving model ...
Epoch: 3 cost time: 11.0971839427948
Epoch: 3, Steps: 17 | Train Loss: 1.864 Vali Loss: 5.658 Vali Acc: 0.266 Test Loss: 5.658 Test Acc: 0.266
Validation loss decreased (-0.247096 --> -0.266103).  Saving model ...
Epoch: 4 cost time: 11.735597133636475
Epoch: 4, Steps: 17 | Train Loss: 1.580 Vali Loss: 6.234 Vali Acc: 0.281 Test Loss: 6.234 Test Acc: 0.281
Validation loss decreased (-0.266103 --> -0.281306).  Saving model ...
Epoch: 5 cost time: 12.339470624923706
Epoch: 5, Steps: 17 | Train Loss: 2.772 Vali Loss: 13.263 Vali Acc: 0.243 Test Loss: 13.263 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.79823112487793
Epoch: 6, Steps: 17 | Train Loss: 2.005 Vali Loss: 12.054 Vali Acc: 0.251 Test Loss: 12.054 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.719508171081543
Epoch: 7, Steps: 17 | Train Loss: 3.664 Vali Loss: 17.636 Vali Acc: 0.255 Test Loss: 17.636 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.841742992401123
Epoch: 8, Steps: 17 | Train Loss: 2.093 Vali Loss: 12.423 Vali Acc: 0.240 Test Loss: 12.423 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.215425252914429
Epoch: 9, Steps: 17 | Train Loss: 1.680 Vali Loss: 21.728 Vali Acc: 0.251 Test Loss: 21.728 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.714053392410278
Epoch: 10, Steps: 17 | Train Loss: 2.132 Vali Loss: 18.481 Vali Acc: 0.243 Test Loss: 18.481 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.521387815475464
Epoch: 11, Steps: 17 | Train Loss: 2.384 Vali Loss: 21.225 Vali Acc: 0.247 Test Loss: 21.225 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.914772510528564
Epoch: 12, Steps: 17 | Train Loss: 2.235 Vali Loss: 16.460 Vali Acc: 0.262 Test Loss: 16.460 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.080090045928955
Epoch: 13, Steps: 17 | Train Loss: 3.371 Vali Loss: 28.412 Vali Acc: 0.243 Test Loss: 28.412 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.383318662643433
Epoch: 14, Steps: 17 | Train Loss: 4.523 Vali Loss: 28.470 Vali Acc: 0.270 Test Loss: 28.470 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.345781803131104
Epoch: 1, Steps: 17 | Train Loss: 1.595 Vali Loss: 3.832 Vali Acc: 0.247 Test Loss: 3.832 Test Acc: 0.247
Validation loss decreased (inf --> -0.247110).  Saving model ...
Epoch: 2 cost time: 11.449692249298096
Epoch: 2, Steps: 17 | Train Loss: 2.225 Vali Loss: 7.415 Vali Acc: 0.251 Test Loss: 7.415 Test Acc: 0.251
Validation loss decreased (-0.247110 --> -0.250876).  Saving model ...
Epoch: 3 cost time: 12.232310056686401
Epoch: 3, Steps: 17 | Train Loss: 2.543 Vali Loss: 14.141 Vali Acc: 0.251 Test Loss: 14.141 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.909893035888672
Epoch: 4, Steps: 17 | Train Loss: 2.810 Vali Loss: 3.928 Vali Acc: 0.308 Test Loss: 3.928 Test Acc: 0.308
Validation loss decreased (-0.250876 --> -0.307946).  Saving model ...
Epoch: 5 cost time: 10.569023609161377
Epoch: 5, Steps: 17 | Train Loss: 3.520 Vali Loss: 10.695 Vali Acc: 0.232 Test Loss: 10.695 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.066125392913818
Epoch: 6, Steps: 17 | Train Loss: 2.392 Vali Loss: 10.765 Vali Acc: 0.236 Test Loss: 10.765 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.435041189193726
Epoch: 7, Steps: 17 | Train Loss: 3.623 Vali Loss: 11.879 Vali Acc: 0.262 Test Loss: 11.879 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.47044587135315
Epoch: 8, Steps: 17 | Train Loss: 4.092 Vali Loss: 13.221 Vali Acc: 0.278 Test Loss: 13.221 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.135584592819214
Epoch: 9, Steps: 17 | Train Loss: 6.002 Vali Loss: 27.272 Vali Acc: 0.247 Test Loss: 27.272 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.135501146316528
Epoch: 10, Steps: 17 | Train Loss: 5.091 Vali Loss: 22.278 Vali Acc: 0.255 Test Loss: 22.278 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.770466327667236
Epoch: 11, Steps: 17 | Train Loss: 2.905 Vali Loss: 23.654 Vali Acc: 0.228 Test Loss: 23.654 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.332221508026123
Epoch: 12, Steps: 17 | Train Loss: 2.391 Vali Loss: 30.192 Vali Acc: 0.221 Test Loss: 30.192 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.038280725479126
Epoch: 13, Steps: 17 | Train Loss: 2.784 Vali Loss: 24.030 Vali Acc: 0.228 Test Loss: 24.030 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.100840330123901
Epoch: 14, Steps: 17 | Train Loss: 2.678 Vali Loss: 23.389 Vali Acc: 0.236 Test Loss: 23.389 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 14494724
model size : 74.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.528488636016846
Epoch: 1, Steps: 17 | Train Loss: 1.846 Vali Loss: 2.836 Vali Acc: 0.251 Test Loss: 2.836 Test Acc: 0.251
Validation loss decreased (inf --> -0.250922).  Saving model ...
Epoch: 2 cost time: 17.91754174232483
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 3.599 Vali Acc: 0.274 Test Loss: 3.599 Test Acc: 0.274
Validation loss decreased (-0.250922 --> -0.273728).  Saving model ...
Epoch: 3 cost time: 19.477007627487183
Epoch: 3, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.823 Vali Acc: 0.221 Test Loss: 2.823 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.660589933395386
Epoch: 4, Steps: 17 | Train Loss: 2.038 Vali Loss: 4.515 Vali Acc: 0.255 Test Loss: 4.515 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.097673654556274
Epoch: 5, Steps: 17 | Train Loss: 1.564 Vali Loss: 2.822 Vali Acc: 0.251 Test Loss: 2.822 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.8099308013916
Epoch: 6, Steps: 17 | Train Loss: 1.786 Vali Loss: 4.005 Vali Acc: 0.255 Test Loss: 4.005 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.342470169067383
Epoch: 7, Steps: 17 | Train Loss: 2.014 Vali Loss: 5.739 Vali Acc: 0.217 Test Loss: 5.739 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.647297382354736
Epoch: 8, Steps: 17 | Train Loss: 2.323 Vali Loss: 4.045 Vali Acc: 0.255 Test Loss: 4.045 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.864583492279053
Epoch: 9, Steps: 17 | Train Loss: 1.906 Vali Loss: 4.875 Vali Acc: 0.236 Test Loss: 4.875 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.35784912109375
Epoch: 10, Steps: 17 | Train Loss: 1.283 Vali Loss: 4.944 Vali Acc: 0.255 Test Loss: 4.944 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 20.503438711166382
Epoch: 11, Steps: 17 | Train Loss: 1.701 Vali Loss: 4.753 Vali Acc: 0.293 Test Loss: 4.753 Test Acc: 0.293
Validation loss decreased (-0.273728 --> -0.292728).  Saving model ...
Epoch: 12 cost time: 20.828723192214966
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 5.895 Vali Acc: 0.262 Test Loss: 5.895 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.97131371498108
Epoch: 13, Steps: 17 | Train Loss: 0.980 Vali Loss: 7.837 Vali Acc: 0.278 Test Loss: 7.837 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.73665690422058
Epoch: 14, Steps: 17 | Train Loss: 1.058 Vali Loss: 8.752 Vali Acc: 0.285 Test Loss: 8.752 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.019888162612915
Epoch: 15, Steps: 17 | Train Loss: 1.535 Vali Loss: 6.900 Vali Acc: 0.289 Test Loss: 6.900 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.648561477661133
Epoch: 16, Steps: 17 | Train Loss: 1.392 Vali Loss: 7.348 Vali Acc: 0.274 Test Loss: 7.348 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.99988627433777
Epoch: 17, Steps: 17 | Train Loss: 0.771 Vali Loss: 10.133 Vali Acc: 0.289 Test Loss: 10.133 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.55209255218506
Epoch: 18, Steps: 17 | Train Loss: 1.590 Vali Loss: 9.575 Vali Acc: 0.278 Test Loss: 9.575 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 19.130581617355347
Epoch: 19, Steps: 17 | Train Loss: 1.040 Vali Loss: 12.623 Vali Acc: 0.221 Test Loss: 12.623 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.212235927581787
Epoch: 20, Steps: 17 | Train Loss: 1.185 Vali Loss: 11.875 Vali Acc: 0.262 Test Loss: 11.875 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 17.649982690811157
Epoch: 21, Steps: 17 | Train Loss: 0.760 Vali Loss: 11.662 Vali Acc: 0.247 Test Loss: 11.662 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.072433471679688
Epoch: 1, Steps: 17 | Train Loss: 1.761 Vali Loss: 2.215 Vali Acc: 0.255 Test Loss: 2.215 Test Acc: 0.255
Validation loss decreased (inf --> -0.254731).  Saving model ...
Epoch: 2 cost time: 17.486980438232422
Epoch: 2, Steps: 17 | Train Loss: 1.786 Vali Loss: 2.824 Vali Acc: 0.255 Test Loss: 2.824 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.44866132736206
Epoch: 3, Steps: 17 | Train Loss: 1.706 Vali Loss: 3.202 Vali Acc: 0.247 Test Loss: 3.202 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.680816411972046
Epoch: 4, Steps: 17 | Train Loss: 2.152 Vali Loss: 5.269 Vali Acc: 0.274 Test Loss: 5.269 Test Acc: 0.274
Validation loss decreased (-0.254731 --> -0.273712).  Saving model ...
Epoch: 5 cost time: 17.023692846298218
Epoch: 5, Steps: 17 | Train Loss: 2.649 Vali Loss: 4.805 Vali Acc: 0.262 Test Loss: 4.805 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.345114707946777
Epoch: 6, Steps: 17 | Train Loss: 1.997 Vali Loss: 3.995 Vali Acc: 0.270 Test Loss: 3.995 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.774230480194092
Epoch: 7, Steps: 17 | Train Loss: 1.616 Vali Loss: 5.331 Vali Acc: 0.209 Test Loss: 5.331 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.451059818267822
Epoch: 8, Steps: 17 | Train Loss: 2.467 Vali Loss: 5.323 Vali Acc: 0.240 Test Loss: 5.323 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.092798709869385
Epoch: 9, Steps: 17 | Train Loss: 2.160 Vali Loss: 6.356 Vali Acc: 0.270 Test Loss: 6.356 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 16.50237011909485
Epoch: 10, Steps: 17 | Train Loss: 1.420 Vali Loss: 5.345 Vali Acc: 0.247 Test Loss: 5.345 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 18.37819480895996
Epoch: 11, Steps: 17 | Train Loss: 1.807 Vali Loss: 6.179 Vali Acc: 0.221 Test Loss: 6.179 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.0207576751709
Epoch: 12, Steps: 17 | Train Loss: 1.549 Vali Loss: 6.930 Vali Acc: 0.270 Test Loss: 6.930 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 16.50793170928955
Epoch: 13, Steps: 17 | Train Loss: 1.649 Vali Loss: 6.686 Vali Acc: 0.251 Test Loss: 6.686 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.753520250320435
Epoch: 14, Steps: 17 | Train Loss: 1.197 Vali Loss: 6.502 Vali Acc: 0.285 Test Loss: 6.502 Test Acc: 0.285
Validation loss decreased (-0.273712 --> -0.285106).  Saving model ...
Epoch: 15 cost time: 18.574890851974487
Epoch: 15, Steps: 17 | Train Loss: 1.625 Vali Loss: 8.054 Vali Acc: 0.270 Test Loss: 8.054 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.7029128074646
Epoch: 16, Steps: 17 | Train Loss: 1.916 Vali Loss: 7.381 Vali Acc: 0.259 Test Loss: 7.381 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 18.15196466445923
Epoch: 17, Steps: 17 | Train Loss: 1.106 Vali Loss: 9.161 Vali Acc: 0.285 Test Loss: 9.161 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.882209062576294
Epoch: 18, Steps: 17 | Train Loss: 1.125 Vali Loss: 8.399 Vali Acc: 0.300 Test Loss: 8.399 Test Acc: 0.300
Validation loss decreased (-0.285106 --> -0.300296).  Saving model ...
Epoch: 19 cost time: 18.110405683517456
Epoch: 19, Steps: 17 | Train Loss: 1.169 Vali Loss: 13.037 Vali Acc: 0.243 Test Loss: 13.037 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 16.185508966445923
Epoch: 20, Steps: 17 | Train Loss: 0.984 Vali Loss: 10.118 Vali Acc: 0.262 Test Loss: 10.118 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 16.780413150787354
Epoch: 21, Steps: 17 | Train Loss: 0.695 Vali Loss: 11.227 Vali Acc: 0.236 Test Loss: 11.227 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 17.362558126449585
Epoch: 22, Steps: 17 | Train Loss: 1.161 Vali Loss: 12.610 Vali Acc: 0.240 Test Loss: 12.610 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 18.08699631690979
Epoch: 23, Steps: 17 | Train Loss: 2.381 Vali Loss: 12.072 Vali Acc: 0.240 Test Loss: 12.072 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 17.37952160835266
Epoch: 24, Steps: 17 | Train Loss: 1.430 Vali Loss: 13.514 Vali Acc: 0.262 Test Loss: 13.514 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 18.068236112594604
Epoch: 25, Steps: 17 | Train Loss: 1.891 Vali Loss: 11.676 Vali Acc: 0.300 Test Loss: 11.676 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 17.468119144439697
Epoch: 26, Steps: 17 | Train Loss: 1.343 Vali Loss: 16.500 Vali Acc: 0.247 Test Loss: 16.500 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 16.509403944015503
Epoch: 27, Steps: 17 | Train Loss: 1.502 Vali Loss: 12.314 Vali Acc: 0.270 Test Loss: 12.314 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 15.947118282318115
Epoch: 28, Steps: 17 | Train Loss: 0.562 Vali Loss: 14.717 Vali Acc: 0.247 Test Loss: 14.717 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.346734285354614
Epoch: 1, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.843 Vali Acc: 0.228 Test Loss: 1.843 Test Acc: 0.228
Validation loss decreased (inf --> -0.228118).  Saving model ...
Epoch: 2 cost time: 14.164351463317871
Epoch: 2, Steps: 17 | Train Loss: 1.755 Vali Loss: 4.509 Vali Acc: 0.251 Test Loss: 4.509 Test Acc: 0.251
Validation loss decreased (-0.228118 --> -0.250905).  Saving model ...
Epoch: 3 cost time: 14.700854301452637
Epoch: 3, Steps: 17 | Train Loss: 1.560 Vali Loss: 3.913 Vali Acc: 0.266 Test Loss: 3.913 Test Acc: 0.266
Validation loss decreased (-0.250905 --> -0.266121).  Saving model ...
Epoch: 4 cost time: 14.788915872573853
Epoch: 4, Steps: 17 | Train Loss: 2.042 Vali Loss: 4.136 Vali Acc: 0.262 Test Loss: 4.136 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.24328875541687
Epoch: 5, Steps: 17 | Train Loss: 1.727 Vali Loss: 6.346 Vali Acc: 0.240 Test Loss: 6.346 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.449383020401001
Epoch: 6, Steps: 17 | Train Loss: 1.927 Vali Loss: 6.221 Vali Acc: 0.251 Test Loss: 6.221 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.955846786499023
Epoch: 7, Steps: 17 | Train Loss: 3.432 Vali Loss: 9.482 Vali Acc: 0.266 Test Loss: 9.482 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.840787410736084
Epoch: 8, Steps: 17 | Train Loss: 2.131 Vali Loss: 5.720 Vali Acc: 0.247 Test Loss: 5.720 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.09282922744751
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 5.874 Vali Acc: 0.285 Test Loss: 5.874 Test Acc: 0.285
Validation loss decreased (-0.266121 --> -0.285112).  Saving model ...
Epoch: 10 cost time: 15.099764347076416
Epoch: 10, Steps: 17 | Train Loss: 1.548 Vali Loss: 6.864 Vali Acc: 0.262 Test Loss: 6.864 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.879454135894775
Epoch: 11, Steps: 17 | Train Loss: 1.708 Vali Loss: 7.134 Vali Acc: 0.262 Test Loss: 7.134 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.422555923461914
Epoch: 12, Steps: 17 | Train Loss: 1.115 Vali Loss: 8.878 Vali Acc: 0.247 Test Loss: 8.878 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.885966777801514
Epoch: 13, Steps: 17 | Train Loss: 1.437 Vali Loss: 11.733 Vali Acc: 0.266 Test Loss: 11.733 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.303014516830444
Epoch: 14, Steps: 17 | Train Loss: 1.767 Vali Loss: 7.406 Vali Acc: 0.274 Test Loss: 7.406 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.98206377029419
Epoch: 15, Steps: 17 | Train Loss: 0.907 Vali Loss: 10.660 Vali Acc: 0.255 Test Loss: 10.660 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.126224994659424
Epoch: 16, Steps: 17 | Train Loss: 0.803 Vali Loss: 11.610 Vali Acc: 0.255 Test Loss: 11.610 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.01363754272461
Epoch: 17, Steps: 17 | Train Loss: 1.112 Vali Loss: 10.850 Vali Acc: 0.289 Test Loss: 10.850 Test Acc: 0.289
Validation loss decreased (-0.285112 --> -0.288865).  Saving model ...
Epoch: 18 cost time: 15.580902814865112
Epoch: 18, Steps: 17 | Train Loss: 0.888 Vali Loss: 13.236 Vali Acc: 0.236 Test Loss: 13.236 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.927578926086426
Epoch: 19, Steps: 17 | Train Loss: 2.060 Vali Loss: 12.574 Vali Acc: 0.228 Test Loss: 12.574 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.504134893417358
Epoch: 20, Steps: 17 | Train Loss: 1.523 Vali Loss: 14.696 Vali Acc: 0.243 Test Loss: 14.696 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 15.936134576797485
Epoch: 21, Steps: 17 | Train Loss: 0.778 Vali Loss: 10.953 Vali Acc: 0.266 Test Loss: 10.953 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 14.919268608093262
Epoch: 22, Steps: 17 | Train Loss: 1.241 Vali Loss: 15.496 Vali Acc: 0.236 Test Loss: 15.496 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 13.932565212249756
Epoch: 23, Steps: 17 | Train Loss: 0.771 Vali Loss: 18.405 Vali Acc: 0.266 Test Loss: 18.405 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 14.483962059020996
Epoch: 24, Steps: 17 | Train Loss: 0.756 Vali Loss: 15.873 Vali Acc: 0.247 Test Loss: 15.873 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.972426891326904
Epoch: 25, Steps: 17 | Train Loss: 1.142 Vali Loss: 16.389 Vali Acc: 0.228 Test Loss: 16.389 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 16.047982692718506
Epoch: 26, Steps: 17 | Train Loss: 0.891 Vali Loss: 16.990 Vali Acc: 0.270 Test Loss: 16.990 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 14.084116458892822
Epoch: 27, Steps: 17 | Train Loss: 0.943 Vali Loss: 17.965 Vali Acc: 0.262 Test Loss: 17.965 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.549076557159424
Epoch: 1, Steps: 17 | Train Loss: 1.592 Vali Loss: 2.199 Vali Acc: 0.232 Test Loss: 2.199 Test Acc: 0.232
Validation loss decreased (inf --> -0.231917).  Saving model ...
Epoch: 2 cost time: 12.342503309249878
Epoch: 2, Steps: 17 | Train Loss: 1.657 Vali Loss: 3.305 Vali Acc: 0.259 Test Loss: 3.305 Test Acc: 0.259
Validation loss decreased (-0.231917 --> -0.258522).  Saving model ...
Epoch: 3 cost time: 13.828583002090454
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 6.572 Vali Acc: 0.255 Test Loss: 6.572 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.008198022842407
Epoch: 4, Steps: 17 | Train Loss: 1.977 Vali Loss: 7.793 Vali Acc: 0.262 Test Loss: 7.793 Test Acc: 0.262
Validation loss decreased (-0.258522 --> -0.262279).  Saving model ...
Epoch: 5 cost time: 11.554906368255615
Epoch: 5, Steps: 17 | Train Loss: 1.829 Vali Loss: 7.218 Vali Acc: 0.259 Test Loss: 7.218 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.236156225204468
Epoch: 6, Steps: 17 | Train Loss: 2.551 Vali Loss: 6.821 Vali Acc: 0.262 Test Loss: 6.821 Test Acc: 0.262
Validation loss decreased (-0.262279 --> -0.262289).  Saving model ...
Epoch: 7 cost time: 12.658663272857666
Epoch: 7, Steps: 17 | Train Loss: 2.038 Vali Loss: 12.425 Vali Acc: 0.243 Test Loss: 12.425 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.456913232803345
Epoch: 8, Steps: 17 | Train Loss: 2.320 Vali Loss: 7.478 Vali Acc: 0.255 Test Loss: 7.478 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.217023611068726
Epoch: 9, Steps: 17 | Train Loss: 1.753 Vali Loss: 8.042 Vali Acc: 0.243 Test Loss: 8.042 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.387310028076172
Epoch: 10, Steps: 17 | Train Loss: 1.166 Vali Loss: 7.162 Vali Acc: 0.259 Test Loss: 7.162 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.143035888671875
Epoch: 11, Steps: 17 | Train Loss: 1.612 Vali Loss: 13.882 Vali Acc: 0.255 Test Loss: 13.882 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.707594871520996
Epoch: 12, Steps: 17 | Train Loss: 1.757 Vali Loss: 9.920 Vali Acc: 0.259 Test Loss: 9.920 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.779091358184814
Epoch: 13, Steps: 17 | Train Loss: 1.157 Vali Loss: 11.996 Vali Acc: 0.274 Test Loss: 11.996 Test Acc: 0.274
Validation loss decreased (-0.262289 --> -0.273644).  Saving model ...
Epoch: 14 cost time: 12.332551717758179
Epoch: 14, Steps: 17 | Train Loss: 1.494 Vali Loss: 15.474 Vali Acc: 0.270 Test Loss: 15.474 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.411636590957642
Epoch: 15, Steps: 17 | Train Loss: 0.852 Vali Loss: 11.845 Vali Acc: 0.270 Test Loss: 11.845 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.459045171737671
Epoch: 16, Steps: 17 | Train Loss: 0.740 Vali Loss: 13.399 Vali Acc: 0.255 Test Loss: 13.399 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.493786334991455
Epoch: 17, Steps: 17 | Train Loss: 0.813 Vali Loss: 11.948 Vali Acc: 0.240 Test Loss: 11.948 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.089084148406982
Epoch: 18, Steps: 17 | Train Loss: 1.089 Vali Loss: 13.682 Vali Acc: 0.251 Test Loss: 13.682 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.234107255935669
Epoch: 19, Steps: 17 | Train Loss: 0.977 Vali Loss: 22.066 Vali Acc: 0.266 Test Loss: 22.066 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.127607107162476
Epoch: 20, Steps: 17 | Train Loss: 0.999 Vali Loss: 12.971 Vali Acc: 0.243 Test Loss: 12.971 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.513389825820923
Epoch: 21, Steps: 17 | Train Loss: 1.000 Vali Loss: 16.815 Vali Acc: 0.232 Test Loss: 16.815 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.757270812988281
Epoch: 22, Steps: 17 | Train Loss: 0.701 Vali Loss: 18.609 Vali Acc: 0.285 Test Loss: 18.609 Test Acc: 0.285
Validation loss decreased (-0.273644 --> -0.284985).  Saving model ...
Epoch: 23 cost time: 11.336397171020508
Epoch: 23, Steps: 17 | Train Loss: 0.641 Vali Loss: 18.929 Vali Acc: 0.262 Test Loss: 18.929 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.479181051254272
Epoch: 24, Steps: 17 | Train Loss: 0.607 Vali Loss: 26.277 Vali Acc: 0.255 Test Loss: 26.277 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.32878303527832
Epoch: 25, Steps: 17 | Train Loss: 1.264 Vali Loss: 24.568 Vali Acc: 0.243 Test Loss: 24.568 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.644057512283325
Epoch: 26, Steps: 17 | Train Loss: 0.650 Vali Loss: 20.486 Vali Acc: 0.213 Test Loss: 20.486 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 13.108154058456421
Epoch: 27, Steps: 17 | Train Loss: 1.452 Vali Loss: 21.213 Vali Acc: 0.232 Test Loss: 21.213 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 13.514869213104248
Epoch: 28, Steps: 17 | Train Loss: 1.102 Vali Loss: 22.390 Vali Acc: 0.247 Test Loss: 22.390 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.960279703140259
Epoch: 29, Steps: 17 | Train Loss: 0.911 Vali Loss: 22.004 Vali Acc: 0.236 Test Loss: 22.004 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 13.992225885391235
Epoch: 30, Steps: 17 | Train Loss: 0.271 Vali Loss: 24.934 Vali Acc: 0.262 Test Loss: 24.934 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 12.626360654830933
Epoch: 31, Steps: 17 | Train Loss: 1.432 Vali Loss: 22.783 Vali Acc: 0.240 Test Loss: 22.783 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 13.131280660629272
Epoch: 32, Steps: 17 | Train Loss: 0.448 Vali Loss: 23.715 Vali Acc: 0.259 Test Loss: 23.715 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.361935138702393
Epoch: 1, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.959 Vali Acc: 0.240 Test Loss: 1.959 Test Acc: 0.240
Validation loss decreased (inf --> -0.239524).  Saving model ...
Epoch: 2 cost time: 9.809764385223389
Epoch: 2, Steps: 17 | Train Loss: 1.792 Vali Loss: 2.863 Vali Acc: 0.251 Test Loss: 2.863 Test Acc: 0.251
Validation loss decreased (-0.239524 --> -0.250922).  Saving model ...
Epoch: 3 cost time: 10.707362413406372
Epoch: 3, Steps: 17 | Train Loss: 1.984 Vali Loss: 4.969 Vali Acc: 0.240 Test Loss: 4.969 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.076137065887451
Epoch: 4, Steps: 17 | Train Loss: 2.347 Vali Loss: 4.899 Vali Acc: 0.228 Test Loss: 4.899 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.873571634292603
Epoch: 5, Steps: 17 | Train Loss: 1.823 Vali Loss: 4.699 Vali Acc: 0.266 Test Loss: 4.699 Test Acc: 0.266
Validation loss decreased (-0.250922 --> -0.266113).  Saving model ...
Epoch: 6 cost time: 11.062252044677734
Epoch: 6, Steps: 17 | Train Loss: 1.932 Vali Loss: 7.254 Vali Acc: 0.278 Test Loss: 7.254 Test Acc: 0.278
Validation loss decreased (-0.266113 --> -0.277494).  Saving model ...
Epoch: 7 cost time: 10.67823314666748
Epoch: 7, Steps: 17 | Train Loss: 2.109 Vali Loss: 9.719 Vali Acc: 0.262 Test Loss: 9.719 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.934065341949463
Epoch: 8, Steps: 17 | Train Loss: 2.355 Vali Loss: 7.265 Vali Acc: 0.262 Test Loss: 7.265 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.342392444610596
Epoch: 9, Steps: 17 | Train Loss: 1.610 Vali Loss: 10.904 Vali Acc: 0.255 Test Loss: 10.904 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.96033525466919
Epoch: 10, Steps: 17 | Train Loss: 1.364 Vali Loss: 10.637 Vali Acc: 0.259 Test Loss: 10.637 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.185822486877441
Epoch: 11, Steps: 17 | Train Loss: 1.401 Vali Loss: 13.567 Vali Acc: 0.262 Test Loss: 13.567 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.412805318832397
Epoch: 12, Steps: 17 | Train Loss: 2.126 Vali Loss: 11.174 Vali Acc: 0.251 Test Loss: 11.174 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.43579387664795
Epoch: 13, Steps: 17 | Train Loss: 1.105 Vali Loss: 13.013 Vali Acc: 0.266 Test Loss: 13.013 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.969208478927612
Epoch: 14, Steps: 17 | Train Loss: 0.954 Vali Loss: 12.196 Vali Acc: 0.255 Test Loss: 12.196 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.993624448776245
Epoch: 15, Steps: 17 | Train Loss: 1.076 Vali Loss: 17.099 Vali Acc: 0.274 Test Loss: 17.099 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.661178588867188
Epoch: 16, Steps: 17 | Train Loss: 0.971 Vali Loss: 17.459 Vali Acc: 0.293 Test Loss: 17.459 Test Acc: 0.293
Validation loss decreased (-0.277494 --> -0.292601).  Saving model ...
Epoch: 17 cost time: 11.472628355026245
Epoch: 17, Steps: 17 | Train Loss: 1.526 Vali Loss: 18.735 Vali Acc: 0.278 Test Loss: 18.735 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.75637674331665
Epoch: 18, Steps: 17 | Train Loss: 1.602 Vali Loss: 15.669 Vali Acc: 0.316 Test Loss: 15.669 Test Acc: 0.316
Validation loss decreased (-0.292601 --> -0.315433).  Saving model ...
Epoch: 19 cost time: 11.175058364868164
Epoch: 19, Steps: 17 | Train Loss: 1.988 Vali Loss: 20.681 Vali Acc: 0.278 Test Loss: 20.681 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.970869779586792
Epoch: 20, Steps: 17 | Train Loss: 1.723 Vali Loss: 19.661 Vali Acc: 0.243 Test Loss: 19.661 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.306674242019653
Epoch: 21, Steps: 17 | Train Loss: 2.100 Vali Loss: 18.932 Vali Acc: 0.278 Test Loss: 18.932 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.379458665847778
Epoch: 22, Steps: 17 | Train Loss: 1.816 Vali Loss: 17.202 Vali Acc: 0.266 Test Loss: 17.202 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.06912088394165
Epoch: 23, Steps: 17 | Train Loss: 1.600 Vali Loss: 15.674 Vali Acc: 0.262 Test Loss: 15.674 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.240732192993164
Epoch: 24, Steps: 17 | Train Loss: 0.962 Vali Loss: 21.558 Vali Acc: 0.228 Test Loss: 21.558 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.364234685897827
Epoch: 25, Steps: 17 | Train Loss: 1.520 Vali Loss: 16.780 Vali Acc: 0.251 Test Loss: 16.780 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 10.432114839553833
Epoch: 26, Steps: 17 | Train Loss: 0.858 Vali Loss: 19.636 Vali Acc: 0.259 Test Loss: 19.636 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.59670901298523
Epoch: 27, Steps: 17 | Train Loss: 1.380 Vali Loss: 18.566 Vali Acc: 0.270 Test Loss: 18.566 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.212622880935669
Epoch: 28, Steps: 17 | Train Loss: 0.485 Vali Loss: 20.974 Vali Acc: 0.266 Test Loss: 20.974 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.44342041015625
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 2.069 Vali Acc: 0.278 Test Loss: 2.069 Test Acc: 0.278
Validation loss decreased (inf --> -0.277546).  Saving model ...
Epoch: 2 cost time: 9.183018922805786
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 2.712 Vali Acc: 0.247 Test Loss: 2.712 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.55575156211853
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 3.232 Vali Acc: 0.232 Test Loss: 3.232 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.212787866592407
Epoch: 4, Steps: 17 | Train Loss: 1.862 Vali Loss: 6.485 Vali Acc: 0.262 Test Loss: 6.485 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.655977010726929
Epoch: 5, Steps: 17 | Train Loss: 1.997 Vali Loss: 7.464 Vali Acc: 0.289 Test Loss: 7.464 Test Acc: 0.289
Validation loss decreased (-0.277546 --> -0.288899).  Saving model ...
Epoch: 6 cost time: 9.504642963409424
Epoch: 6, Steps: 17 | Train Loss: 1.867 Vali Loss: 7.463 Vali Acc: 0.247 Test Loss: 7.463 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.792608976364136
Epoch: 7, Steps: 17 | Train Loss: 1.239 Vali Loss: 6.291 Vali Acc: 0.240 Test Loss: 6.291 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.41647458076477
Epoch: 8, Steps: 17 | Train Loss: 1.679 Vali Loss: 9.113 Vali Acc: 0.247 Test Loss: 9.113 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.524251937866211
Epoch: 9, Steps: 17 | Train Loss: 1.683 Vali Loss: 9.331 Vali Acc: 0.255 Test Loss: 9.331 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.563857793807983
Epoch: 10, Steps: 17 | Train Loss: 1.388 Vali Loss: 12.866 Vali Acc: 0.259 Test Loss: 12.866 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.527878999710083
Epoch: 11, Steps: 17 | Train Loss: 1.150 Vali Loss: 10.506 Vali Acc: 0.251 Test Loss: 10.506 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.669729232788086
Epoch: 12, Steps: 17 | Train Loss: 0.780 Vali Loss: 18.382 Vali Acc: 0.243 Test Loss: 18.382 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.077144145965576
Epoch: 13, Steps: 17 | Train Loss: 2.166 Vali Loss: 14.752 Vali Acc: 0.255 Test Loss: 14.752 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.384461879730225
Epoch: 14, Steps: 17 | Train Loss: 1.435 Vali Loss: 21.629 Vali Acc: 0.255 Test Loss: 21.629 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.867067813873291
Epoch: 15, Steps: 17 | Train Loss: 2.920 Vali Loss: 16.632 Vali Acc: 0.259 Test Loss: 16.632 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.17057728767395
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 2.621 Vali Acc: 0.259 Test Loss: 2.621 Test Acc: 0.259
Validation loss decreased (inf --> -0.258529).  Saving model ...
Epoch: 2 cost time: 9.529144525527954
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 3.641 Vali Acc: 0.274 Test Loss: 3.641 Test Acc: 0.274
Validation loss decreased (-0.258529 --> -0.273728).  Saving model ...
Epoch: 3 cost time: 8.843116760253906
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 3.626 Vali Acc: 0.266 Test Loss: 3.626 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.590140342712402
Epoch: 4, Steps: 17 | Train Loss: 1.516 Vali Loss: 3.799 Vali Acc: 0.247 Test Loss: 3.799 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.986680746078491
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 4.459 Vali Acc: 0.240 Test Loss: 4.459 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.27366018295288
Epoch: 6, Steps: 17 | Train Loss: 2.361 Vali Loss: 7.476 Vali Acc: 0.289 Test Loss: 7.476 Test Acc: 0.289
Validation loss decreased (-0.273728 --> -0.288899).  Saving model ...
Epoch: 7 cost time: 9.161601543426514
Epoch: 7, Steps: 17 | Train Loss: 1.631 Vali Loss: 6.567 Vali Acc: 0.270 Test Loss: 6.567 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.92551064491272
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 9.450 Vali Acc: 0.281 Test Loss: 9.450 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.993442296981812
Epoch: 9, Steps: 17 | Train Loss: 1.272 Vali Loss: 11.770 Vali Acc: 0.266 Test Loss: 11.770 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.617960691452026
Epoch: 10, Steps: 17 | Train Loss: 1.553 Vali Loss: 11.016 Vali Acc: 0.259 Test Loss: 11.016 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.339178085327148
Epoch: 11, Steps: 17 | Train Loss: 1.151 Vali Loss: 15.022 Vali Acc: 0.240 Test Loss: 15.022 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.927683591842651
Epoch: 12, Steps: 17 | Train Loss: 1.077 Vali Loss: 16.205 Vali Acc: 0.266 Test Loss: 16.205 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.439760208129883
Epoch: 13, Steps: 17 | Train Loss: 1.329 Vali Loss: 16.046 Vali Acc: 0.243 Test Loss: 16.046 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.428423166275024
Epoch: 14, Steps: 17 | Train Loss: 1.252 Vali Loss: 18.024 Vali Acc: 0.228 Test Loss: 18.024 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.385745763778687
Epoch: 15, Steps: 17 | Train Loss: 1.571 Vali Loss: 23.148 Vali Acc: 0.266 Test Loss: 23.148 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.915412187576294
Epoch: 16, Steps: 17 | Train Loss: 1.445 Vali Loss: 22.948 Vali Acc: 0.259 Test Loss: 22.948 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.27404499053955
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.688 Vali Acc: 0.289 Test Loss: 2.688 Test Acc: 0.289
Validation loss decreased (inf --> -0.288947).  Saving model ...
Epoch: 2 cost time: 8.85326862335205
Epoch: 2, Steps: 17 | Train Loss: 1.432 Vali Loss: 2.348 Vali Acc: 0.285 Test Loss: 2.348 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.569207429885864
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.847 Vali Acc: 0.266 Test Loss: 2.847 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.220816373825073
Epoch: 4, Steps: 17 | Train Loss: 1.538 Vali Loss: 4.898 Vali Acc: 0.266 Test Loss: 4.898 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.332585573196411
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 4.944 Vali Acc: 0.255 Test Loss: 4.944 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.870423078536987
Epoch: 6, Steps: 17 | Train Loss: 1.909 Vali Loss: 5.554 Vali Acc: 0.251 Test Loss: 5.554 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.85718560218811
Epoch: 7, Steps: 17 | Train Loss: 1.594 Vali Loss: 9.691 Vali Acc: 0.266 Test Loss: 9.691 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.17914342880249
Epoch: 8, Steps: 17 | Train Loss: 1.446 Vali Loss: 7.665 Vali Acc: 0.270 Test Loss: 7.665 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.792973756790161
Epoch: 9, Steps: 17 | Train Loss: 1.237 Vali Loss: 8.582 Vali Acc: 0.262 Test Loss: 8.582 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.06621789932251
Epoch: 10, Steps: 17 | Train Loss: 2.368 Vali Loss: 14.055 Vali Acc: 0.232 Test Loss: 14.055 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.717017889022827
Epoch: 11, Steps: 17 | Train Loss: 1.014 Vali Loss: 10.448 Vali Acc: 0.259 Test Loss: 10.448 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.287505865097046
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 2.944 Vali Acc: 0.285 Test Loss: 2.944 Test Acc: 0.285
Validation loss decreased (inf --> -0.285142).  Saving model ...
Epoch: 2 cost time: 8.340476274490356
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 3.729 Vali Acc: 0.259 Test Loss: 3.729 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.990252017974854
Epoch: 3, Steps: 17 | Train Loss: 1.563 Vali Loss: 4.821 Vali Acc: 0.255 Test Loss: 4.821 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.434492826461792
Epoch: 4, Steps: 17 | Train Loss: 1.761 Vali Loss: 6.161 Vali Acc: 0.247 Test Loss: 6.161 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.233505725860596
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 7.372 Vali Acc: 0.251 Test Loss: 7.372 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.697854042053223
Epoch: 6, Steps: 17 | Train Loss: 1.338 Vali Loss: 5.674 Vali Acc: 0.247 Test Loss: 5.674 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.048285245895386
Epoch: 7, Steps: 17 | Train Loss: 2.253 Vali Loss: 7.877 Vali Acc: 0.270 Test Loss: 7.877 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.365659713745117
Epoch: 8, Steps: 17 | Train Loss: 2.092 Vali Loss: 9.684 Vali Acc: 0.266 Test Loss: 9.684 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.095701694488525
Epoch: 9, Steps: 17 | Train Loss: 2.028 Vali Loss: 9.066 Vali Acc: 0.274 Test Loss: 9.066 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.859142780303955
Epoch: 10, Steps: 17 | Train Loss: 1.222 Vali Loss: 13.029 Vali Acc: 0.228 Test Loss: 13.029 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.32278299331665
Epoch: 11, Steps: 17 | Train Loss: 1.102 Vali Loss: 14.870 Vali Acc: 0.247 Test Loss: 14.870 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.716617822647095
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 2.644 Vali Acc: 0.262 Test Loss: 2.644 Test Acc: 0.262
Validation loss decreased (inf --> -0.262331).  Saving model ...
Epoch: 2 cost time: 8.38787841796875
Epoch: 2, Steps: 17 | Train Loss: 1.544 Vali Loss: 4.410 Vali Acc: 0.247 Test Loss: 4.410 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.804912090301514
Epoch: 3, Steps: 17 | Train Loss: 1.600 Vali Loss: 6.446 Vali Acc: 0.251 Test Loss: 6.446 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.912810325622559
Epoch: 4, Steps: 17 | Train Loss: 2.130 Vali Loss: 9.085 Vali Acc: 0.255 Test Loss: 9.085 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.595708847045898
Epoch: 5, Steps: 17 | Train Loss: 1.505 Vali Loss: 6.410 Vali Acc: 0.274 Test Loss: 6.410 Test Acc: 0.274
Validation loss decreased (-0.262331 --> -0.273700).  Saving model ...
Epoch: 6 cost time: 8.92530608177185
Epoch: 6, Steps: 17 | Train Loss: 1.751 Vali Loss: 8.506 Vali Acc: 0.243 Test Loss: 8.506 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.245362520217896
Epoch: 7, Steps: 17 | Train Loss: 1.483 Vali Loss: 8.496 Vali Acc: 0.255 Test Loss: 8.496 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.884910821914673
Epoch: 8, Steps: 17 | Train Loss: 2.121 Vali Loss: 8.573 Vali Acc: 0.243 Test Loss: 8.573 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.562559604644775
Epoch: 9, Steps: 17 | Train Loss: 1.229 Vali Loss: 8.872 Vali Acc: 0.236 Test Loss: 8.872 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.313499212265015
Epoch: 10, Steps: 17 | Train Loss: 1.518 Vali Loss: 16.534 Vali Acc: 0.251 Test Loss: 16.534 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.17244839668274
Epoch: 11, Steps: 17 | Train Loss: 1.516 Vali Loss: 13.973 Vali Acc: 0.270 Test Loss: 13.973 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.030035972595215
Epoch: 12, Steps: 17 | Train Loss: 2.291 Vali Loss: 19.465 Vali Acc: 0.285 Test Loss: 19.465 Test Acc: 0.285
Validation loss decreased (-0.273700 --> -0.284976).  Saving model ...
Epoch: 13 cost time: 8.555561542510986
Epoch: 13, Steps: 17 | Train Loss: 1.947 Vali Loss: 20.268 Vali Acc: 0.251 Test Loss: 20.268 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.587358951568604
Epoch: 14, Steps: 17 | Train Loss: 1.486 Vali Loss: 17.009 Vali Acc: 0.266 Test Loss: 17.009 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.83812689781189
Epoch: 15, Steps: 17 | Train Loss: 1.620 Vali Loss: 18.887 Vali Acc: 0.266 Test Loss: 18.887 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.354544401168823
Epoch: 16, Steps: 17 | Train Loss: 2.332 Vali Loss: 23.505 Vali Acc: 0.247 Test Loss: 23.505 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.799611330032349
Epoch: 17, Steps: 17 | Train Loss: 1.601 Vali Loss: 27.948 Vali Acc: 0.232 Test Loss: 27.948 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.13750410079956
Epoch: 18, Steps: 17 | Train Loss: 2.218 Vali Loss: 28.497 Vali Acc: 0.247 Test Loss: 28.497 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.485066890716553
Epoch: 19, Steps: 17 | Train Loss: 2.353 Vali Loss: 34.212 Vali Acc: 0.266 Test Loss: 34.212 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.817606449127197
Epoch: 20, Steps: 17 | Train Loss: 1.995 Vali Loss: 35.845 Vali Acc: 0.243 Test Loss: 35.845 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.871339321136475
Epoch: 21, Steps: 17 | Train Loss: 2.013 Vali Loss: 34.309 Vali Acc: 0.243 Test Loss: 34.309 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.364039659500122
Epoch: 22, Steps: 17 | Train Loss: 1.647 Vali Loss: 34.110 Vali Acc: 0.240 Test Loss: 34.110 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 7575044
model size : 38.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.41143250465393
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 3.416 Vali Acc: 0.255 Test Loss: 3.416 Test Acc: 0.255
Validation loss decreased (inf --> -0.254719).  Saving model ...
Epoch: 2 cost time: 18.276530504226685
Epoch: 2, Steps: 17 | Train Loss: 2.368 Vali Loss: 3.340 Vali Acc: 0.281 Test Loss: 3.340 Test Acc: 0.281
Validation loss decreased (-0.254719 --> -0.281335).  Saving model ...
Epoch: 3 cost time: 17.828158378601074
Epoch: 3, Steps: 17 | Train Loss: 2.479 Vali Loss: 3.527 Vali Acc: 0.243 Test Loss: 3.527 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.487503051757812
Epoch: 4, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.713 Vali Acc: 0.259 Test Loss: 2.713 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.420641660690308
Epoch: 5, Steps: 17 | Train Loss: 2.100 Vali Loss: 3.574 Vali Acc: 0.243 Test Loss: 3.574 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.320394039154053
Epoch: 6, Steps: 17 | Train Loss: 2.147 Vali Loss: 4.448 Vali Acc: 0.247 Test Loss: 4.448 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.914252281188965
Epoch: 7, Steps: 17 | Train Loss: 1.912 Vali Loss: 4.401 Vali Acc: 0.247 Test Loss: 4.401 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.510581731796265
Epoch: 8, Steps: 17 | Train Loss: 1.921 Vali Loss: 9.182 Vali Acc: 0.278 Test Loss: 9.182 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.940557718276978
Epoch: 9, Steps: 17 | Train Loss: 3.253 Vali Loss: 5.619 Vali Acc: 0.281 Test Loss: 5.619 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.144742250442505
Epoch: 10, Steps: 17 | Train Loss: 1.474 Vali Loss: 4.492 Vali Acc: 0.251 Test Loss: 4.492 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.539904594421387
Epoch: 11, Steps: 17 | Train Loss: 1.281 Vali Loss: 5.603 Vali Acc: 0.243 Test Loss: 5.603 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.923768520355225
Epoch: 12, Steps: 17 | Train Loss: 1.540 Vali Loss: 9.781 Vali Acc: 0.247 Test Loss: 9.781 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.329580783843994
Epoch: 1, Steps: 17 | Train Loss: 1.671 Vali Loss: 3.606 Vali Acc: 0.255 Test Loss: 3.606 Test Acc: 0.255
Validation loss decreased (inf --> -0.254717).  Saving model ...
Epoch: 2 cost time: 16.279560804367065
Epoch: 2, Steps: 17 | Train Loss: 2.246 Vali Loss: 2.877 Vali Acc: 0.232 Test Loss: 2.877 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.555567741394043
Epoch: 3, Steps: 17 | Train Loss: 2.010 Vali Loss: 2.568 Vali Acc: 0.240 Test Loss: 2.568 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.46333909034729
Epoch: 4, Steps: 17 | Train Loss: 1.685 Vali Loss: 3.005 Vali Acc: 0.278 Test Loss: 3.005 Test Acc: 0.278
Validation loss decreased (-0.254717 --> -0.277536).  Saving model ...
Epoch: 5 cost time: 15.155831336975098
Epoch: 5, Steps: 17 | Train Loss: 1.976 Vali Loss: 5.121 Vali Acc: 0.266 Test Loss: 5.121 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.38380193710327
Epoch: 6, Steps: 17 | Train Loss: 1.871 Vali Loss: 4.651 Vali Acc: 0.262 Test Loss: 4.651 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.17917490005493
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 6.656 Vali Acc: 0.270 Test Loss: 6.656 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.29620885848999
Epoch: 8, Steps: 17 | Train Loss: 1.695 Vali Loss: 4.410 Vali Acc: 0.240 Test Loss: 4.410 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.415332317352295
Epoch: 9, Steps: 17 | Train Loss: 1.619 Vali Loss: 5.454 Vali Acc: 0.274 Test Loss: 5.454 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.840203762054443
Epoch: 10, Steps: 17 | Train Loss: 1.564 Vali Loss: 5.368 Vali Acc: 0.259 Test Loss: 5.368 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.586257696151733
Epoch: 11, Steps: 17 | Train Loss: 1.639 Vali Loss: 5.626 Vali Acc: 0.304 Test Loss: 5.626 Test Acc: 0.304
Validation loss decreased (-0.277536 --> -0.304126).  Saving model ...
Epoch: 12 cost time: 14.712252855300903
Epoch: 12, Steps: 17 | Train Loss: 1.756 Vali Loss: 7.880 Vali Acc: 0.240 Test Loss: 7.880 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.317249059677124
Epoch: 13, Steps: 17 | Train Loss: 1.324 Vali Loss: 7.642 Vali Acc: 0.266 Test Loss: 7.642 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.146303176879883
Epoch: 14, Steps: 17 | Train Loss: 1.486 Vali Loss: 8.503 Vali Acc: 0.262 Test Loss: 8.503 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.208669900894165
Epoch: 15, Steps: 17 | Train Loss: 3.345 Vali Loss: 12.923 Vali Acc: 0.278 Test Loss: 12.923 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.015530824661255
Epoch: 16, Steps: 17 | Train Loss: 4.125 Vali Loss: 14.721 Vali Acc: 0.240 Test Loss: 14.721 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.12532615661621
Epoch: 17, Steps: 17 | Train Loss: 2.391 Vali Loss: 10.115 Vali Acc: 0.270 Test Loss: 10.115 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.39373230934143
Epoch: 18, Steps: 17 | Train Loss: 1.378 Vali Loss: 9.575 Vali Acc: 0.274 Test Loss: 9.575 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 14.77976942062378
Epoch: 19, Steps: 17 | Train Loss: 1.368 Vali Loss: 11.608 Vali Acc: 0.251 Test Loss: 11.608 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.372712850570679
Epoch: 20, Steps: 17 | Train Loss: 0.990 Vali Loss: 12.096 Vali Acc: 0.274 Test Loss: 12.096 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.542250156402588
Epoch: 21, Steps: 17 | Train Loss: 1.869 Vali Loss: 10.695 Vali Acc: 0.285 Test Loss: 10.695 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.598915338516235
Epoch: 1, Steps: 17 | Train Loss: 1.645 Vali Loss: 2.710 Vali Acc: 0.240 Test Loss: 2.710 Test Acc: 0.240
Validation loss decreased (inf --> -0.239517).  Saving model ...
Epoch: 2 cost time: 13.746079206466675
Epoch: 2, Steps: 17 | Train Loss: 2.016 Vali Loss: 4.686 Vali Acc: 0.262 Test Loss: 4.686 Test Acc: 0.262
Validation loss decreased (-0.239517 --> -0.262311).  Saving model ...
Epoch: 3 cost time: 13.911436796188354
Epoch: 3, Steps: 17 | Train Loss: 2.352 Vali Loss: 3.848 Vali Acc: 0.209 Test Loss: 3.848 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.275141954421997
Epoch: 4, Steps: 17 | Train Loss: 1.824 Vali Loss: 3.321 Vali Acc: 0.198 Test Loss: 3.321 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.019420146942139
Epoch: 5, Steps: 17 | Train Loss: 1.729 Vali Loss: 6.248 Vali Acc: 0.243 Test Loss: 6.248 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.224421977996826
Epoch: 6, Steps: 17 | Train Loss: 1.885 Vali Loss: 4.881 Vali Acc: 0.228 Test Loss: 4.881 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.976920366287231
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 9.316 Vali Acc: 0.240 Test Loss: 9.316 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.8892502784729
Epoch: 8, Steps: 17 | Train Loss: 2.081 Vali Loss: 7.635 Vali Acc: 0.228 Test Loss: 7.635 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.986013889312744
Epoch: 9, Steps: 17 | Train Loss: 1.811 Vali Loss: 8.578 Vali Acc: 0.232 Test Loss: 8.578 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.376864671707153
Epoch: 10, Steps: 17 | Train Loss: 0.917 Vali Loss: 5.991 Vali Acc: 0.266 Test Loss: 5.991 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.266100).  Saving model ...
Epoch: 11 cost time: 13.480869054794312
Epoch: 11, Steps: 17 | Train Loss: 1.194 Vali Loss: 8.517 Vali Acc: 0.259 Test Loss: 8.517 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.13795256614685
Epoch: 12, Steps: 17 | Train Loss: 1.771 Vali Loss: 11.219 Vali Acc: 0.236 Test Loss: 11.219 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.355512619018555
Epoch: 13, Steps: 17 | Train Loss: 1.846 Vali Loss: 12.776 Vali Acc: 0.251 Test Loss: 12.776 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.408724546432495
Epoch: 14, Steps: 17 | Train Loss: 1.839 Vali Loss: 14.324 Vali Acc: 0.266 Test Loss: 14.324 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.828489542007446
Epoch: 15, Steps: 17 | Train Loss: 1.680 Vali Loss: 10.332 Vali Acc: 0.278 Test Loss: 10.332 Test Acc: 0.278
Validation loss decreased (-0.266100 --> -0.277463).  Saving model ...
Epoch: 16 cost time: 13.58908748626709
Epoch: 16, Steps: 17 | Train Loss: 1.494 Vali Loss: 20.402 Vali Acc: 0.255 Test Loss: 20.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.949090957641602
Epoch: 17, Steps: 17 | Train Loss: 1.845 Vali Loss: 15.409 Vali Acc: 0.266 Test Loss: 15.409 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.085746765136719
Epoch: 18, Steps: 17 | Train Loss: 1.493 Vali Loss: 16.975 Vali Acc: 0.247 Test Loss: 16.975 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.84372878074646
Epoch: 19, Steps: 17 | Train Loss: 2.026 Vali Loss: 15.681 Vali Acc: 0.247 Test Loss: 15.681 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.656294107437134
Epoch: 20, Steps: 17 | Train Loss: 2.512 Vali Loss: 17.905 Vali Acc: 0.240 Test Loss: 17.905 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.913803577423096
Epoch: 21, Steps: 17 | Train Loss: 1.390 Vali Loss: 17.136 Vali Acc: 0.278 Test Loss: 17.136 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.522791147232056
Epoch: 22, Steps: 17 | Train Loss: 1.228 Vali Loss: 19.492 Vali Acc: 0.259 Test Loss: 19.492 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 14.769384145736694
Epoch: 23, Steps: 17 | Train Loss: 0.965 Vali Loss: 18.963 Vali Acc: 0.255 Test Loss: 18.963 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.583406209945679
Epoch: 24, Steps: 17 | Train Loss: 1.383 Vali Loss: 20.884 Vali Acc: 0.240 Test Loss: 20.884 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.74140214920044
Epoch: 25, Steps: 17 | Train Loss: 1.007 Vali Loss: 17.562 Vali Acc: 0.270 Test Loss: 17.562 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.937430620193481
Epoch: 1, Steps: 17 | Train Loss: 1.647 Vali Loss: 2.813 Vali Acc: 0.243 Test Loss: 2.813 Test Acc: 0.243
Validation loss decreased (inf --> -0.243318).  Saving model ...
Epoch: 2 cost time: 10.687294006347656
Epoch: 2, Steps: 17 | Train Loss: 1.772 Vali Loss: 3.397 Vali Acc: 0.278 Test Loss: 3.397 Test Acc: 0.278
Validation loss decreased (-0.243318 --> -0.277533).  Saving model ...
Epoch: 3 cost time: 11.200850486755371
Epoch: 3, Steps: 17 | Train Loss: 1.953 Vali Loss: 5.272 Vali Acc: 0.224 Test Loss: 5.272 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.512913227081299
Epoch: 4, Steps: 17 | Train Loss: 1.804 Vali Loss: 4.047 Vali Acc: 0.255 Test Loss: 4.047 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.949113607406616
Epoch: 5, Steps: 17 | Train Loss: 1.578 Vali Loss: 5.357 Vali Acc: 0.217 Test Loss: 5.357 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.012595415115356
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 5.523 Vali Acc: 0.255 Test Loss: 5.523 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.692763805389404
Epoch: 7, Steps: 17 | Train Loss: 1.208 Vali Loss: 7.156 Vali Acc: 0.259 Test Loss: 7.156 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.48834228515625
Epoch: 8, Steps: 17 | Train Loss: 1.165 Vali Loss: 7.172 Vali Acc: 0.255 Test Loss: 7.172 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.018759965896606
Epoch: 9, Steps: 17 | Train Loss: 1.211 Vali Loss: 7.951 Vali Acc: 0.262 Test Loss: 7.951 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.747712135314941
Epoch: 10, Steps: 17 | Train Loss: 1.151 Vali Loss: 9.291 Vali Acc: 0.270 Test Loss: 9.291 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.955542087554932
Epoch: 11, Steps: 17 | Train Loss: 0.862 Vali Loss: 11.344 Vali Acc: 0.259 Test Loss: 11.344 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.97387433052063
Epoch: 12, Steps: 17 | Train Loss: 1.057 Vali Loss: 13.412 Vali Acc: 0.251 Test Loss: 13.412 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.46837854385376
Epoch: 1, Steps: 17 | Train Loss: 1.694 Vali Loss: 2.051 Vali Acc: 0.281 Test Loss: 2.051 Test Acc: 0.281
Validation loss decreased (inf --> -0.281348).  Saving model ...
Epoch: 2 cost time: 9.804949760437012
Epoch: 2, Steps: 17 | Train Loss: 1.695 Vali Loss: 2.806 Vali Acc: 0.232 Test Loss: 2.806 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.428361415863037
Epoch: 3, Steps: 17 | Train Loss: 1.798 Vali Loss: 4.417 Vali Acc: 0.240 Test Loss: 4.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.465617895126343
Epoch: 4, Steps: 17 | Train Loss: 1.992 Vali Loss: 3.840 Vali Acc: 0.266 Test Loss: 3.840 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.924437761306763
Epoch: 5, Steps: 17 | Train Loss: 1.594 Vali Loss: 5.364 Vali Acc: 0.266 Test Loss: 5.364 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.07007360458374
Epoch: 6, Steps: 17 | Train Loss: 1.500 Vali Loss: 4.702 Vali Acc: 0.266 Test Loss: 4.702 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.153859615325928
Epoch: 7, Steps: 17 | Train Loss: 1.301 Vali Loss: 5.924 Vali Acc: 0.270 Test Loss: 5.924 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.780533790588379
Epoch: 8, Steps: 17 | Train Loss: 2.013 Vali Loss: 7.788 Vali Acc: 0.243 Test Loss: 7.788 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.646211385726929
Epoch: 9, Steps: 17 | Train Loss: 1.327 Vali Loss: 7.471 Vali Acc: 0.270 Test Loss: 7.471 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.325900554656982
Epoch: 10, Steps: 17 | Train Loss: 2.118 Vali Loss: 10.722 Vali Acc: 0.262 Test Loss: 10.722 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.409839153289795
Epoch: 11, Steps: 17 | Train Loss: 1.495 Vali Loss: 12.652 Vali Acc: 0.266 Test Loss: 12.652 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.962250709533691
Epoch: 1, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (inf --> -0.281351).  Saving model ...
Epoch: 2 cost time: 8.854003190994263
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 2.905 Vali Acc: 0.251 Test Loss: 2.905 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.991639375686646
Epoch: 3, Steps: 17 | Train Loss: 1.540 Vali Loss: 3.689 Vali Acc: 0.221 Test Loss: 3.689 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.833220720291138
Epoch: 4, Steps: 17 | Train Loss: 1.519 Vali Loss: 3.095 Vali Acc: 0.259 Test Loss: 3.095 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.176887512207031
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 7.092 Vali Acc: 0.221 Test Loss: 7.092 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.964294910430908
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 7.461 Vali Acc: 0.247 Test Loss: 7.461 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.152166366577148
Epoch: 7, Steps: 17 | Train Loss: 0.960 Vali Loss: 9.158 Vali Acc: 0.224 Test Loss: 9.158 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.719583988189697
Epoch: 8, Steps: 17 | Train Loss: 1.297 Vali Loss: 8.169 Vali Acc: 0.221 Test Loss: 8.169 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.13227653503418
Epoch: 9, Steps: 17 | Train Loss: 1.347 Vali Loss: 8.425 Vali Acc: 0.278 Test Loss: 8.425 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.866261005401611
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 10.201 Vali Acc: 0.262 Test Loss: 10.201 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.845887660980225
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 12.834 Vali Acc: 0.247 Test Loss: 12.834 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.64596152305603
Epoch: 1, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.914 Vali Acc: 0.262 Test Loss: 1.914 Test Acc: 0.262
Validation loss decreased (inf --> -0.262338).  Saving model ...
Epoch: 2 cost time: 8.179173231124878
Epoch: 2, Steps: 17 | Train Loss: 1.553 Vali Loss: 3.983 Vali Acc: 0.281 Test Loss: 3.983 Test Acc: 0.281
Validation loss decreased (-0.262338 --> -0.281329).  Saving model ...
Epoch: 3 cost time: 8.388100147247314
Epoch: 3, Steps: 17 | Train Loss: 1.639 Vali Loss: 4.323 Vali Acc: 0.232 Test Loss: 4.323 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.97222638130188
Epoch: 4, Steps: 17 | Train Loss: 1.752 Vali Loss: 4.863 Vali Acc: 0.266 Test Loss: 4.863 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.110546827316284
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 6.386 Vali Acc: 0.259 Test Loss: 6.386 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.349620580673218
Epoch: 6, Steps: 17 | Train Loss: 0.921 Vali Loss: 4.946 Vali Acc: 0.255 Test Loss: 4.946 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.306165218353271
Epoch: 7, Steps: 17 | Train Loss: 0.999 Vali Loss: 6.248 Vali Acc: 0.270 Test Loss: 6.248 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.710641860961914
Epoch: 8, Steps: 17 | Train Loss: 1.011 Vali Loss: 7.257 Vali Acc: 0.270 Test Loss: 7.257 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.816435813903809
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 6.863 Vali Acc: 0.266 Test Loss: 6.863 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.841070890426636
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 9.178 Vali Acc: 0.224 Test Loss: 9.178 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.907885313034058
Epoch: 11, Steps: 17 | Train Loss: 1.046 Vali Loss: 10.286 Vali Acc: 0.232 Test Loss: 10.286 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.927462100982666
Epoch: 12, Steps: 17 | Train Loss: 0.841 Vali Loss: 13.718 Vali Acc: 0.232 Test Loss: 13.718 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.243587493896484
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 2.249 Vali Acc: 0.232 Test Loss: 2.249 Test Acc: 0.232
Validation loss decreased (inf --> -0.231917).  Saving model ...
Epoch: 2 cost time: 8.01354193687439
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 3.858 Vali Acc: 0.262 Test Loss: 3.858 Test Acc: 0.262
Validation loss decreased (-0.231917 --> -0.262319).  Saving model ...
Epoch: 3 cost time: 8.49833369255066
Epoch: 3, Steps: 17 | Train Loss: 1.570 Vali Loss: 3.793 Vali Acc: 0.224 Test Loss: 3.793 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.785230875015259
Epoch: 4, Steps: 17 | Train Loss: 1.882 Vali Loss: 3.601 Vali Acc: 0.274 Test Loss: 3.601 Test Acc: 0.274
Validation loss decreased (-0.262319 --> -0.273728).  Saving model ...
Epoch: 5 cost time: 8.27288293838501
Epoch: 5, Steps: 17 | Train Loss: 1.579 Vali Loss: 5.353 Vali Acc: 0.262 Test Loss: 5.353 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.767302513122559
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 6.882 Vali Acc: 0.255 Test Loss: 6.882 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.989781618118286
Epoch: 7, Steps: 17 | Train Loss: 1.834 Vali Loss: 12.033 Vali Acc: 0.259 Test Loss: 12.033 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.765650510787964
Epoch: 8, Steps: 17 | Train Loss: 1.983 Vali Loss: 12.495 Vali Acc: 0.240 Test Loss: 12.495 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.646479368209839
Epoch: 9, Steps: 17 | Train Loss: 1.875 Vali Loss: 10.670 Vali Acc: 0.240 Test Loss: 10.670 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.201610803604126
Epoch: 10, Steps: 17 | Train Loss: 1.596 Vali Loss: 14.474 Vali Acc: 0.243 Test Loss: 14.474 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.106082439422607
Epoch: 11, Steps: 17 | Train Loss: 1.027 Vali Loss: 13.846 Vali Acc: 0.217 Test Loss: 13.846 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.206998825073242
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 17.903 Vali Acc: 0.251 Test Loss: 17.903 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.838101625442505
Epoch: 13, Steps: 17 | Train Loss: 1.379 Vali Loss: 13.762 Vali Acc: 0.221 Test Loss: 13.762 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.861248970031738
Epoch: 14, Steps: 17 | Train Loss: 0.977 Vali Loss: 16.912 Vali Acc: 0.213 Test Loss: 16.912 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.923859596252441
Epoch: 1, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.883 Vali Acc: 0.232 Test Loss: 1.883 Test Acc: 0.232
Validation loss decreased (inf --> -0.231920).  Saving model ...
Epoch: 2 cost time: 7.676043510437012
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 4.469 Vali Acc: 0.266 Test Loss: 4.469 Test Acc: 0.266
Validation loss decreased (-0.231920 --> -0.266115).  Saving model ...
Epoch: 3 cost time: 7.606748104095459
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 2.898 Vali Acc: 0.255 Test Loss: 2.898 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.432164669036865
Epoch: 4, Steps: 17 | Train Loss: 1.712 Vali Loss: 5.755 Vali Acc: 0.266 Test Loss: 5.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.05517315864563
Epoch: 5, Steps: 17 | Train Loss: 1.174 Vali Loss: 5.568 Vali Acc: 0.262 Test Loss: 5.568 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.646989583969116
Epoch: 6, Steps: 17 | Train Loss: 1.111 Vali Loss: 5.043 Vali Acc: 0.289 Test Loss: 5.043 Test Acc: 0.289
Validation loss decreased (-0.266115 --> -0.288923).  Saving model ...
Epoch: 7 cost time: 7.671152114868164
Epoch: 7, Steps: 17 | Train Loss: 0.944 Vali Loss: 8.534 Vali Acc: 0.266 Test Loss: 8.534 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.495160341262817
Epoch: 8, Steps: 17 | Train Loss: 0.982 Vali Loss: 7.480 Vali Acc: 0.278 Test Loss: 7.480 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.9243292808532715
Epoch: 9, Steps: 17 | Train Loss: 1.067 Vali Loss: 10.342 Vali Acc: 0.255 Test Loss: 10.342 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.457962989807129
Epoch: 10, Steps: 17 | Train Loss: 1.787 Vali Loss: 10.464 Vali Acc: 0.312 Test Loss: 10.464 Test Acc: 0.312
Validation loss decreased (-0.288923 --> -0.311682).  Saving model ...
Epoch: 11 cost time: 7.430172920227051
Epoch: 11, Steps: 17 | Train Loss: 1.181 Vali Loss: 11.663 Vali Acc: 0.259 Test Loss: 11.663 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.76166296005249
Epoch: 12, Steps: 17 | Train Loss: 0.944 Vali Loss: 16.109 Vali Acc: 0.255 Test Loss: 16.109 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.625629901885986
Epoch: 13, Steps: 17 | Train Loss: 1.294 Vali Loss: 15.064 Vali Acc: 0.247 Test Loss: 15.064 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.568740367889404
Epoch: 14, Steps: 17 | Train Loss: 1.934 Vali Loss: 25.513 Vali Acc: 0.251 Test Loss: 25.513 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.866596937179565
Epoch: 15, Steps: 17 | Train Loss: 1.867 Vali Loss: 18.753 Vali Acc: 0.255 Test Loss: 18.753 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.9274232387542725
Epoch: 16, Steps: 17 | Train Loss: 1.017 Vali Loss: 23.479 Vali Acc: 0.236 Test Loss: 23.479 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.912314414978027
Epoch: 17, Steps: 17 | Train Loss: 0.934 Vali Loss: 21.636 Vali Acc: 0.240 Test Loss: 21.636 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.155690908432007
Epoch: 18, Steps: 17 | Train Loss: 1.236 Vali Loss: 24.535 Vali Acc: 0.251 Test Loss: 24.535 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.811424016952515
Epoch: 19, Steps: 17 | Train Loss: 1.754 Vali Loss: 26.390 Vali Acc: 0.209 Test Loss: 26.390 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.218388557434082
Epoch: 20, Steps: 17 | Train Loss: 1.161 Vali Loss: 25.597 Vali Acc: 0.198 Test Loss: 25.597 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.763168096542358
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.901 Vali Acc: 0.247 Test Loss: 1.901 Test Acc: 0.247
Validation loss decreased (inf --> -0.247129).  Saving model ...
Epoch: 2 cost time: 7.877929210662842
Epoch: 2, Steps: 17 | Train Loss: 1.633 Vali Loss: 4.723 Vali Acc: 0.262 Test Loss: 4.723 Test Acc: 0.262
Validation loss decreased (-0.247129 --> -0.262310).  Saving model ...
Epoch: 3 cost time: 8.007508277893066
Epoch: 3, Steps: 17 | Train Loss: 1.704 Vali Loss: 3.634 Vali Acc: 0.251 Test Loss: 3.634 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.663765907287598
Epoch: 4, Steps: 17 | Train Loss: 1.894 Vali Loss: 6.346 Vali Acc: 0.259 Test Loss: 6.346 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.7231128215789795
Epoch: 5, Steps: 17 | Train Loss: 1.677 Vali Loss: 8.484 Vali Acc: 0.243 Test Loss: 8.484 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.659656524658203
Epoch: 6, Steps: 17 | Train Loss: 1.542 Vali Loss: 7.640 Vali Acc: 0.240 Test Loss: 7.640 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.227552652359009
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 7.044 Vali Acc: 0.251 Test Loss: 7.044 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.255643129348755
Epoch: 8, Steps: 17 | Train Loss: 1.470 Vali Loss: 10.246 Vali Acc: 0.240 Test Loss: 10.246 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.703502178192139
Epoch: 9, Steps: 17 | Train Loss: 2.367 Vali Loss: 13.504 Vali Acc: 0.259 Test Loss: 13.504 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.059202671051025
Epoch: 10, Steps: 17 | Train Loss: 2.141 Vali Loss: 10.610 Vali Acc: 0.255 Test Loss: 10.610 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.93261194229126
Epoch: 11, Steps: 17 | Train Loss: 1.192 Vali Loss: 11.659 Vali Acc: 0.281 Test Loss: 11.659 Test Acc: 0.281
Validation loss decreased (-0.262310 --> -0.281252).  Saving model ...
Epoch: 12 cost time: 7.8979504108428955
Epoch: 12, Steps: 17 | Train Loss: 1.504 Vali Loss: 15.466 Vali Acc: 0.251 Test Loss: 15.466 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.887913703918457
Epoch: 13, Steps: 17 | Train Loss: 1.526 Vali Loss: 14.807 Vali Acc: 0.259 Test Loss: 14.807 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.298192977905273
Epoch: 14, Steps: 17 | Train Loss: 1.343 Vali Loss: 22.075 Vali Acc: 0.259 Test Loss: 22.075 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.42133092880249
Epoch: 15, Steps: 17 | Train Loss: 1.436 Vali Loss: 20.683 Vali Acc: 0.251 Test Loss: 20.683 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.457753658294678
Epoch: 16, Steps: 17 | Train Loss: 2.230 Vali Loss: 27.720 Vali Acc: 0.262 Test Loss: 27.720 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.345045328140259
Epoch: 17, Steps: 17 | Train Loss: 1.737 Vali Loss: 20.708 Vali Acc: 0.236 Test Loss: 20.708 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.426929950714111
Epoch: 18, Steps: 17 | Train Loss: 1.651 Vali Loss: 26.030 Vali Acc: 0.270 Test Loss: 26.030 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.370177268981934
Epoch: 19, Steps: 17 | Train Loss: 2.414 Vali Loss: 24.689 Vali Acc: 0.274 Test Loss: 24.689 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.889535427093506
Epoch: 20, Steps: 17 | Train Loss: 2.271 Vali Loss: 28.952 Vali Acc: 0.247 Test Loss: 28.952 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.666452169418335
Epoch: 21, Steps: 17 | Train Loss: 2.487 Vali Loss: 27.798 Vali Acc: 0.285 Test Loss: 27.798 Test Acc: 0.285
Validation loss decreased (-0.281252 --> -0.284893).  Saving model ...
Epoch: 22 cost time: 7.788325071334839
Epoch: 22, Steps: 17 | Train Loss: 1.744 Vali Loss: 27.523 Vali Acc: 0.262 Test Loss: 27.523 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.7241339683532715
Epoch: 23, Steps: 17 | Train Loss: 1.796 Vali Loss: 31.566 Vali Acc: 0.255 Test Loss: 31.566 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.805587291717529
Epoch: 24, Steps: 17 | Train Loss: 1.776 Vali Loss: 37.455 Vali Acc: 0.266 Test Loss: 37.455 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.887715101242065
Epoch: 25, Steps: 17 | Train Loss: 2.212 Vali Loss: 39.608 Vali Acc: 0.297 Test Loss: 39.608 Test Acc: 0.297
Validation loss decreased (-0.284893 --> -0.296182).  Saving model ...
Epoch: 26 cost time: 7.568981885910034
Epoch: 26, Steps: 17 | Train Loss: 4.178 Vali Loss: 54.652 Vali Acc: 0.247 Test Loss: 54.652 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.825423717498779
Epoch: 27, Steps: 17 | Train Loss: 4.007 Vali Loss: 51.288 Vali Acc: 0.255 Test Loss: 51.288 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.520317316055298
Epoch: 28, Steps: 17 | Train Loss: 2.400 Vali Loss: 41.278 Vali Acc: 0.259 Test Loss: 41.278 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.215097427368164
Epoch: 29, Steps: 17 | Train Loss: 1.595 Vali Loss: 36.506 Vali Acc: 0.266 Test Loss: 36.506 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.668203115463257
Epoch: 30, Steps: 17 | Train Loss: 1.338 Vali Loss: 41.206 Vali Acc: 0.259 Test Loss: 41.206 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 7.832598686218262
Epoch: 31, Steps: 17 | Train Loss: 1.562 Vali Loss: 40.917 Vali Acc: 0.262 Test Loss: 40.917 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 8.402697324752808
Epoch: 32, Steps: 17 | Train Loss: 1.528 Vali Loss: 49.456 Vali Acc: 0.281 Test Loss: 49.456 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 8.22337007522583
Epoch: 33, Steps: 17 | Train Loss: 2.087 Vali Loss: 46.056 Vali Acc: 0.255 Test Loss: 46.056 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 7.594736099243164
Epoch: 34, Steps: 17 | Train Loss: 1.423 Vali Loss: 53.218 Vali Acc: 0.285 Test Loss: 53.218 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.997565507888794
Epoch: 35, Steps: 17 | Train Loss: 1.992 Vali Loss: 54.459 Vali Acc: 0.213 Test Loss: 54.459 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 6002180
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.27978491783142
Epoch: 1, Steps: 17 | Train Loss: 1.694 Vali Loss: 1.663 Vali Acc: 0.281 Test Loss: 1.663 Test Acc: 0.281
Validation loss decreased (inf --> -0.281352).  Saving model ...
Epoch: 2 cost time: 18.115628242492676
Epoch: 2, Steps: 17 | Train Loss: 2.079 Vali Loss: 2.673 Vali Acc: 0.274 Test Loss: 2.673 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.302690505981445
Epoch: 3, Steps: 17 | Train Loss: 1.897 Vali Loss: 4.785 Vali Acc: 0.251 Test Loss: 4.785 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.525954246520996
Epoch: 4, Steps: 17 | Train Loss: 2.443 Vali Loss: 6.801 Vali Acc: 0.270 Test Loss: 6.801 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.43982219696045
Epoch: 5, Steps: 17 | Train Loss: 2.610 Vali Loss: 5.264 Vali Acc: 0.243 Test Loss: 5.264 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.01350426673889
Epoch: 6, Steps: 17 | Train Loss: 2.015 Vali Loss: 6.508 Vali Acc: 0.281 Test Loss: 6.508 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.175025701522827
Epoch: 7, Steps: 17 | Train Loss: 2.739 Vali Loss: 4.300 Vali Acc: 0.289 Test Loss: 4.300 Test Acc: 0.289
Validation loss decreased (-0.281352 --> -0.288930).  Saving model ...
Epoch: 8 cost time: 18.26426935195923
Epoch: 8, Steps: 17 | Train Loss: 3.605 Vali Loss: 9.869 Vali Acc: 0.270 Test Loss: 9.869 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.39246916770935
Epoch: 9, Steps: 17 | Train Loss: 2.930 Vali Loss: 5.665 Vali Acc: 0.240 Test Loss: 5.665 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.498620748519897
Epoch: 10, Steps: 17 | Train Loss: 2.428 Vali Loss: 4.937 Vali Acc: 0.255 Test Loss: 4.937 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.603193759918213
Epoch: 11, Steps: 17 | Train Loss: 1.854 Vali Loss: 8.162 Vali Acc: 0.255 Test Loss: 8.162 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.808520317077637
Epoch: 12, Steps: 17 | Train Loss: 1.767 Vali Loss: 6.347 Vali Acc: 0.255 Test Loss: 6.347 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.55339765548706
Epoch: 13, Steps: 17 | Train Loss: 1.506 Vali Loss: 7.693 Vali Acc: 0.274 Test Loss: 7.693 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.72365427017212
Epoch: 14, Steps: 17 | Train Loss: 1.182 Vali Loss: 8.377 Vali Acc: 0.278 Test Loss: 8.377 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.46385645866394
Epoch: 15, Steps: 17 | Train Loss: 2.135 Vali Loss: 8.432 Vali Acc: 0.243 Test Loss: 8.432 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 15.94692873954773
Epoch: 16, Steps: 17 | Train Loss: 2.065 Vali Loss: 9.733 Vali Acc: 0.262 Test Loss: 9.733 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.973777294158936
Epoch: 17, Steps: 17 | Train Loss: 2.553 Vali Loss: 12.089 Vali Acc: 0.289 Test Loss: 12.089 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.813957452774048
Epoch: 1, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.760 Vali Acc: 0.281 Test Loss: 1.760 Test Acc: 0.281
Validation loss decreased (inf --> -0.281351).  Saving model ...
Epoch: 2 cost time: 14.900734901428223
Epoch: 2, Steps: 17 | Train Loss: 2.115 Vali Loss: 3.607 Vali Acc: 0.259 Test Loss: 3.607 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.615372896194458
Epoch: 3, Steps: 17 | Train Loss: 1.923 Vali Loss: 2.614 Vali Acc: 0.255 Test Loss: 2.614 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.669349908828735
Epoch: 4, Steps: 17 | Train Loss: 1.734 Vali Loss: 3.582 Vali Acc: 0.278 Test Loss: 3.582 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.693753480911255
Epoch: 5, Steps: 17 | Train Loss: 2.034 Vali Loss: 5.577 Vali Acc: 0.270 Test Loss: 5.577 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.639487981796265
Epoch: 6, Steps: 17 | Train Loss: 2.010 Vali Loss: 5.703 Vali Acc: 0.259 Test Loss: 5.703 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.704752683639526
Epoch: 7, Steps: 17 | Train Loss: 2.501 Vali Loss: 5.237 Vali Acc: 0.247 Test Loss: 5.237 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.135796785354614
Epoch: 8, Steps: 17 | Train Loss: 3.844 Vali Loss: 12.680 Vali Acc: 0.232 Test Loss: 12.680 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.70739459991455
Epoch: 9, Steps: 17 | Train Loss: 3.453 Vali Loss: 12.400 Vali Acc: 0.251 Test Loss: 12.400 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.574410915374756
Epoch: 10, Steps: 17 | Train Loss: 2.357 Vali Loss: 5.755 Vali Acc: 0.266 Test Loss: 5.755 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.995792388916016
Epoch: 11, Steps: 17 | Train Loss: 1.669 Vali Loss: 9.555 Vali Acc: 0.243 Test Loss: 9.555 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.143385171890259
Epoch: 1, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.987 Vali Acc: 0.259 Test Loss: 1.987 Test Acc: 0.259
Validation loss decreased (inf --> -0.258535).  Saving model ...
Epoch: 2 cost time: 13.124897956848145
Epoch: 2, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.695 Vali Acc: 0.251 Test Loss: 2.695 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.699140787124634
Epoch: 3, Steps: 17 | Train Loss: 1.802 Vali Loss: 2.961 Vali Acc: 0.217 Test Loss: 2.961 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.924360513687134
Epoch: 4, Steps: 17 | Train Loss: 1.831 Vali Loss: 4.699 Vali Acc: 0.236 Test Loss: 4.699 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.356068849563599
Epoch: 5, Steps: 17 | Train Loss: 1.802 Vali Loss: 6.108 Vali Acc: 0.259 Test Loss: 6.108 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.013984680175781
Epoch: 6, Steps: 17 | Train Loss: 1.857 Vali Loss: 6.588 Vali Acc: 0.240 Test Loss: 6.588 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.002243995666504
Epoch: 7, Steps: 17 | Train Loss: 2.172 Vali Loss: 6.471 Vali Acc: 0.232 Test Loss: 6.471 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.579111814498901
Epoch: 8, Steps: 17 | Train Loss: 1.817 Vali Loss: 6.341 Vali Acc: 0.240 Test Loss: 6.341 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.290857791900635
Epoch: 9, Steps: 17 | Train Loss: 1.812 Vali Loss: 9.264 Vali Acc: 0.255 Test Loss: 9.264 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.513262033462524
Epoch: 10, Steps: 17 | Train Loss: 1.887 Vali Loss: 8.916 Vali Acc: 0.243 Test Loss: 8.916 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.165887355804443
Epoch: 11, Steps: 17 | Train Loss: 1.348 Vali Loss: 9.297 Vali Acc: 0.224 Test Loss: 9.297 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.758069515228271
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 2.482 Vali Acc: 0.247 Test Loss: 2.482 Test Acc: 0.247
Validation loss decreased (inf --> -0.247123).  Saving model ...
Epoch: 2 cost time: 10.00290060043335
Epoch: 2, Steps: 17 | Train Loss: 1.848 Vali Loss: 3.403 Vali Acc: 0.270 Test Loss: 3.403 Test Acc: 0.270
Validation loss decreased (-0.247123 --> -0.269928).  Saving model ...
Epoch: 3 cost time: 10.808368444442749
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 3.954 Vali Acc: 0.259 Test Loss: 3.954 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.701428413391113
Epoch: 4, Steps: 17 | Train Loss: 1.797 Vali Loss: 3.636 Vali Acc: 0.285 Test Loss: 3.636 Test Acc: 0.285
Validation loss decreased (-0.269928 --> -0.285135).  Saving model ...
Epoch: 5 cost time: 10.559624671936035
Epoch: 5, Steps: 17 | Train Loss: 2.001 Vali Loss: 6.208 Vali Acc: 0.243 Test Loss: 6.208 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.479737520217896
Epoch: 6, Steps: 17 | Train Loss: 1.772 Vali Loss: 6.393 Vali Acc: 0.270 Test Loss: 6.393 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.55652117729187
Epoch: 7, Steps: 17 | Train Loss: 2.017 Vali Loss: 6.978 Vali Acc: 0.247 Test Loss: 6.978 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.027808666229248
Epoch: 8, Steps: 17 | Train Loss: 2.113 Vali Loss: 13.106 Vali Acc: 0.259 Test Loss: 13.106 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.849531412124634
Epoch: 9, Steps: 17 | Train Loss: 1.175 Vali Loss: 10.291 Vali Acc: 0.274 Test Loss: 10.291 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.285541534423828
Epoch: 10, Steps: 17 | Train Loss: 1.204 Vali Loss: 7.898 Vali Acc: 0.243 Test Loss: 7.898 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.704196214675903
Epoch: 11, Steps: 17 | Train Loss: 1.487 Vali Loss: 12.934 Vali Acc: 0.285 Test Loss: 12.934 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.948766946792603
Epoch: 12, Steps: 17 | Train Loss: 0.918 Vali Loss: 11.271 Vali Acc: 0.240 Test Loss: 11.271 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.838306903839111
Epoch: 13, Steps: 17 | Train Loss: 0.900 Vali Loss: 10.358 Vali Acc: 0.247 Test Loss: 10.358 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.472278118133545
Epoch: 14, Steps: 17 | Train Loss: 1.210 Vali Loss: 16.563 Vali Acc: 0.278 Test Loss: 16.563 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.662802696228027
Epoch: 1, Steps: 17 | Train Loss: 1.516 Vali Loss: 2.667 Vali Acc: 0.240 Test Loss: 2.667 Test Acc: 0.240
Validation loss decreased (inf --> -0.239517).  Saving model ...
Epoch: 2 cost time: 8.787983417510986
Epoch: 2, Steps: 17 | Train Loss: 1.594 Vali Loss: 3.723 Vali Acc: 0.243 Test Loss: 3.723 Test Acc: 0.243
Validation loss decreased (-0.239517 --> -0.243309).  Saving model ...
Epoch: 3 cost time: 8.750026226043701
Epoch: 3, Steps: 17 | Train Loss: 1.652 Vali Loss: 4.658 Vali Acc: 0.209 Test Loss: 4.658 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.3514404296875
Epoch: 4, Steps: 17 | Train Loss: 1.763 Vali Loss: 5.345 Vali Acc: 0.297 Test Loss: 5.345 Test Acc: 0.297
Validation loss decreased (-0.243309 --> -0.296524).  Saving model ...
Epoch: 5 cost time: 9.358614683151245
Epoch: 5, Steps: 17 | Train Loss: 1.757 Vali Loss: 6.893 Vali Acc: 0.285 Test Loss: 6.893 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.67238736152649
Epoch: 6, Steps: 17 | Train Loss: 1.838 Vali Loss: 6.364 Vali Acc: 0.274 Test Loss: 6.364 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.151505470275879
Epoch: 7, Steps: 17 | Train Loss: 1.953 Vali Loss: 8.842 Vali Acc: 0.270 Test Loss: 8.842 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.473884344100952
Epoch: 8, Steps: 17 | Train Loss: 2.162 Vali Loss: 13.337 Vali Acc: 0.259 Test Loss: 13.337 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.287596702575684
Epoch: 9, Steps: 17 | Train Loss: 1.566 Vali Loss: 11.171 Vali Acc: 0.281 Test Loss: 11.171 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.0909903049469
Epoch: 10, Steps: 17 | Train Loss: 1.859 Vali Loss: 9.280 Vali Acc: 0.270 Test Loss: 9.280 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.59863567352295
Epoch: 11, Steps: 17 | Train Loss: 1.736 Vali Loss: 13.790 Vali Acc: 0.243 Test Loss: 13.790 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.171865463256836
Epoch: 12, Steps: 17 | Train Loss: 1.058 Vali Loss: 12.741 Vali Acc: 0.255 Test Loss: 12.741 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.238898754119873
Epoch: 13, Steps: 17 | Train Loss: 2.268 Vali Loss: 13.026 Vali Acc: 0.251 Test Loss: 13.026 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.39024829864502
Epoch: 14, Steps: 17 | Train Loss: 2.469 Vali Loss: 18.334 Vali Acc: 0.247 Test Loss: 18.334 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.514472961425781
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 2.909 Vali Acc: 0.251 Test Loss: 2.909 Test Acc: 0.251
Validation loss decreased (inf --> -0.250921).  Saving model ...
Epoch: 2 cost time: 7.749875545501709
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 3.392 Vali Acc: 0.236 Test Loss: 3.392 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.147415161132812
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 3.738 Vali Acc: 0.270 Test Loss: 3.738 Test Acc: 0.270
Validation loss decreased (-0.250921 --> -0.269925).  Saving model ...
Epoch: 4 cost time: 7.979233264923096
Epoch: 4, Steps: 17 | Train Loss: 1.478 Vali Loss: 3.617 Vali Acc: 0.240 Test Loss: 3.617 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.613842964172363
Epoch: 5, Steps: 17 | Train Loss: 1.407 Vali Loss: 5.110 Vali Acc: 0.270 Test Loss: 5.110 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.31514048576355
Epoch: 6, Steps: 17 | Train Loss: 1.566 Vali Loss: 5.537 Vali Acc: 0.251 Test Loss: 5.537 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.670746564865112
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 6.255 Vali Acc: 0.270 Test Loss: 6.255 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.920731067657471
Epoch: 8, Steps: 17 | Train Loss: 2.830 Vali Loss: 16.306 Vali Acc: 0.236 Test Loss: 16.306 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.891859531402588
Epoch: 9, Steps: 17 | Train Loss: 1.766 Vali Loss: 9.166 Vali Acc: 0.243 Test Loss: 9.166 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.830138921737671
Epoch: 10, Steps: 17 | Train Loss: 1.504 Vali Loss: 8.077 Vali Acc: 0.247 Test Loss: 8.077 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.219365119934082
Epoch: 11, Steps: 17 | Train Loss: 1.311 Vali Loss: 13.712 Vali Acc: 0.236 Test Loss: 13.712 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.112953662872314
Epoch: 12, Steps: 17 | Train Loss: 1.252 Vali Loss: 10.437 Vali Acc: 0.221 Test Loss: 10.437 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.0243399143219
Epoch: 13, Steps: 17 | Train Loss: 0.756 Vali Loss: 14.970 Vali Acc: 0.262 Test Loss: 14.970 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.322278261184692
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.800 Vali Acc: 0.247 Test Loss: 2.800 Test Acc: 0.247
Validation loss decreased (inf --> -0.247120).  Saving model ...
Epoch: 2 cost time: 8.059499263763428
Epoch: 2, Steps: 17 | Train Loss: 1.616 Vali Loss: 4.004 Vali Acc: 0.262 Test Loss: 4.004 Test Acc: 0.262
Validation loss decreased (-0.247120 --> -0.262317).  Saving model ...
Epoch: 3 cost time: 7.605834245681763
Epoch: 3, Steps: 17 | Train Loss: 1.389 Vali Loss: 4.278 Vali Acc: 0.285 Test Loss: 4.278 Test Acc: 0.285
Validation loss decreased (-0.262317 --> -0.285128).  Saving model ...
Epoch: 4 cost time: 7.534324407577515
Epoch: 4, Steps: 17 | Train Loss: 1.513 Vali Loss: 5.457 Vali Acc: 0.266 Test Loss: 5.457 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.479713439941406
Epoch: 5, Steps: 17 | Train Loss: 1.515 Vali Loss: 3.762 Vali Acc: 0.259 Test Loss: 3.762 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.30606746673584
Epoch: 6, Steps: 17 | Train Loss: 1.285 Vali Loss: 5.475 Vali Acc: 0.262 Test Loss: 5.475 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.399042129516602
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 5.087 Vali Acc: 0.278 Test Loss: 5.087 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.037674188613892
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 8.748 Vali Acc: 0.266 Test Loss: 8.748 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.793320894241333
Epoch: 9, Steps: 17 | Train Loss: 0.875 Vali Loss: 7.750 Vali Acc: 0.274 Test Loss: 7.750 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.855514764785767
Epoch: 10, Steps: 17 | Train Loss: 1.138 Vali Loss: 10.429 Vali Acc: 0.255 Test Loss: 10.429 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.5438432693481445
Epoch: 11, Steps: 17 | Train Loss: 1.430 Vali Loss: 10.662 Vali Acc: 0.259 Test Loss: 10.662 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.690545082092285
Epoch: 12, Steps: 17 | Train Loss: 1.242 Vali Loss: 11.510 Vali Acc: 0.228 Test Loss: 11.510 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.715142488479614
Epoch: 13, Steps: 17 | Train Loss: 1.442 Vali Loss: 20.533 Vali Acc: 0.270 Test Loss: 20.533 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.644880533218384
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 3.002 Vali Acc: 0.251 Test Loss: 3.002 Test Acc: 0.251
Validation loss decreased (inf --> -0.250921).  Saving model ...
Epoch: 2 cost time: 7.294896364212036
Epoch: 2, Steps: 17 | Train Loss: 1.636 Vali Loss: 4.009 Vali Acc: 0.270 Test Loss: 4.009 Test Acc: 0.270
Validation loss decreased (-0.250921 --> -0.269922).  Saving model ...
Epoch: 3 cost time: 7.511749267578125
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 4.060 Vali Acc: 0.266 Test Loss: 4.060 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.6499552726745605
Epoch: 4, Steps: 17 | Train Loss: 1.470 Vali Loss: 6.010 Vali Acc: 0.240 Test Loss: 6.010 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.820429801940918
Epoch: 5, Steps: 17 | Train Loss: 1.534 Vali Loss: 4.294 Vali Acc: 0.259 Test Loss: 4.294 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.009185552597046
Epoch: 6, Steps: 17 | Train Loss: 1.510 Vali Loss: 6.502 Vali Acc: 0.251 Test Loss: 6.502 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.189741134643555
Epoch: 7, Steps: 17 | Train Loss: 1.669 Vali Loss: 5.424 Vali Acc: 0.236 Test Loss: 5.424 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.316468715667725
Epoch: 8, Steps: 17 | Train Loss: 1.916 Vali Loss: 14.581 Vali Acc: 0.251 Test Loss: 14.581 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.46503472328186
Epoch: 9, Steps: 17 | Train Loss: 1.513 Vali Loss: 9.341 Vali Acc: 0.247 Test Loss: 9.341 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.718274116516113
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 8.216 Vali Acc: 0.251 Test Loss: 8.216 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.010090112686157
Epoch: 11, Steps: 17 | Train Loss: 1.310 Vali Loss: 7.821 Vali Acc: 0.232 Test Loss: 7.821 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.06413984298706
Epoch: 12, Steps: 17 | Train Loss: 1.124 Vali Loss: 11.674 Vali Acc: 0.224 Test Loss: 11.674 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.105247974395752
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 2.893 Vali Acc: 0.240 Test Loss: 2.893 Test Acc: 0.240
Validation loss decreased (inf --> -0.239515).  Saving model ...
Epoch: 2 cost time: 7.714896202087402
Epoch: 2, Steps: 17 | Train Loss: 1.516 Vali Loss: 5.409 Vali Acc: 0.259 Test Loss: 5.409 Test Acc: 0.259
Validation loss decreased (-0.239515 --> -0.258501).  Saving model ...
Epoch: 3 cost time: 7.716498851776123
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 3.631 Vali Acc: 0.224 Test Loss: 3.631 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.5526134967803955
Epoch: 4, Steps: 17 | Train Loss: 1.550 Vali Loss: 5.165 Vali Acc: 0.232 Test Loss: 5.165 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.307592868804932
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 3.491 Vali Acc: 0.243 Test Loss: 3.491 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.243808031082153
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 4.466 Vali Acc: 0.281 Test Loss: 4.466 Test Acc: 0.281
Validation loss decreased (-0.258501 --> -0.281324).  Saving model ...
Epoch: 7 cost time: 7.702784776687622
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 6.754 Vali Acc: 0.247 Test Loss: 6.754 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.123589992523193
Epoch: 8, Steps: 17 | Train Loss: 1.655 Vali Loss: 12.173 Vali Acc: 0.247 Test Loss: 12.173 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.817014694213867
Epoch: 9, Steps: 17 | Train Loss: 1.236 Vali Loss: 11.287 Vali Acc: 0.255 Test Loss: 11.287 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.3499109745025635
Epoch: 10, Steps: 17 | Train Loss: 1.053 Vali Loss: 10.196 Vali Acc: 0.251 Test Loss: 10.196 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.611405611038208
Epoch: 11, Steps: 17 | Train Loss: 1.521 Vali Loss: 13.991 Vali Acc: 0.247 Test Loss: 13.991 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.346135377883911
Epoch: 12, Steps: 17 | Train Loss: 1.072 Vali Loss: 11.582 Vali Acc: 0.259 Test Loss: 11.582 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.948072671890259
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 15.188 Vali Acc: 0.266 Test Loss: 15.188 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.263324022293091
Epoch: 14, Steps: 17 | Train Loss: 1.713 Vali Loss: 18.083 Vali Acc: 0.243 Test Loss: 18.083 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.924932479858398
Epoch: 15, Steps: 17 | Train Loss: 2.516 Vali Loss: 22.773 Vali Acc: 0.213 Test Loss: 22.773 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.5945775508880615
Epoch: 16, Steps: 17 | Train Loss: 1.384 Vali Loss: 20.591 Vali Acc: 0.278 Test Loss: 20.591 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.023653984069824
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.586 Vali Acc: 0.205 Test Loss: 2.586 Test Acc: 0.205
Validation loss decreased (inf --> -0.205297).  Saving model ...
Epoch: 2 cost time: 7.437262296676636
Epoch: 2, Steps: 17 | Train Loss: 1.596 Vali Loss: 5.999 Vali Acc: 0.251 Test Loss: 5.999 Test Acc: 0.251
Validation loss decreased (-0.205297 --> -0.250891).  Saving model ...
Epoch: 3 cost time: 7.420253276824951
Epoch: 3, Steps: 17 | Train Loss: 1.537 Vali Loss: 4.681 Vali Acc: 0.236 Test Loss: 4.681 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.454272508621216
Epoch: 4, Steps: 17 | Train Loss: 1.867 Vali Loss: 6.884 Vali Acc: 0.236 Test Loss: 6.884 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.6588709354400635
Epoch: 5, Steps: 17 | Train Loss: 1.785 Vali Loss: 6.041 Vali Acc: 0.228 Test Loss: 6.041 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.3663859367370605
Epoch: 6, Steps: 17 | Train Loss: 2.127 Vali Loss: 9.325 Vali Acc: 0.270 Test Loss: 9.325 Test Acc: 0.270
Validation loss decreased (-0.250891 --> -0.269869).  Saving model ...
Epoch: 7 cost time: 7.329606056213379
Epoch: 7, Steps: 17 | Train Loss: 2.155 Vali Loss: 6.523 Vali Acc: 0.297 Test Loss: 6.523 Test Acc: 0.297
Validation loss decreased (-0.269869 --> -0.296513).  Saving model ...
Epoch: 8 cost time: 7.306374549865723
Epoch: 8, Steps: 17 | Train Loss: 2.817 Vali Loss: 15.851 Vali Acc: 0.262 Test Loss: 15.851 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.445800304412842
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 12.517 Vali Acc: 0.228 Test Loss: 12.517 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.474531650543213
Epoch: 10, Steps: 17 | Train Loss: 1.393 Vali Loss: 10.889 Vali Acc: 0.255 Test Loss: 10.889 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.2849626541137695
Epoch: 11, Steps: 17 | Train Loss: 1.438 Vali Loss: 12.266 Vali Acc: 0.243 Test Loss: 12.266 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.501618385314941
Epoch: 12, Steps: 17 | Train Loss: 2.667 Vali Loss: 16.025 Vali Acc: 0.255 Test Loss: 16.025 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.460662364959717
Epoch: 13, Steps: 17 | Train Loss: 2.500 Vali Loss: 20.968 Vali Acc: 0.251 Test Loss: 20.968 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.409322500228882
Epoch: 14, Steps: 17 | Train Loss: 1.445 Vali Loss: 21.969 Vali Acc: 0.243 Test Loss: 21.969 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.121709823608398
Epoch: 15, Steps: 17 | Train Loss: 2.386 Vali Loss: 23.279 Vali Acc: 0.255 Test Loss: 23.279 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.286828994750977
Epoch: 16, Steps: 17 | Train Loss: 1.471 Vali Loss: 21.096 Vali Acc: 0.270 Test Loss: 21.096 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.4138503074646
Epoch: 17, Steps: 17 | Train Loss: 2.244 Vali Loss: 25.136 Vali Acc: 0.247 Test Loss: 25.136 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 5215748
model size : 29.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 17.42298722267151
Epoch: 1, Steps: 17 | Train Loss: 1.954 Vali Loss: 4.745 Vali Acc: 0.232 Test Loss: 4.745 Test Acc: 0.232
Validation loss decreased (inf --> -0.231892).  Saving model ...
Epoch: 2 cost time: 17.562448263168335
Epoch: 2, Steps: 17 | Train Loss: 2.601 Vali Loss: 3.622 Vali Acc: 0.247 Test Loss: 3.622 Test Acc: 0.247
Validation loss decreased (-0.231892 --> -0.247112).  Saving model ...
Epoch: 3 cost time: 17.72262167930603
Epoch: 3, Steps: 17 | Train Loss: 2.174 Vali Loss: 3.712 Vali Acc: 0.243 Test Loss: 3.712 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.497297286987305
Epoch: 4, Steps: 17 | Train Loss: 2.348 Vali Loss: 3.790 Vali Acc: 0.255 Test Loss: 3.790 Test Acc: 0.255
Validation loss decreased (-0.247112 --> -0.254715).  Saving model ...
Epoch: 5 cost time: 17.78375816345215
Epoch: 5, Steps: 17 | Train Loss: 1.582 Vali Loss: 4.707 Vali Acc: 0.278 Test Loss: 4.707 Test Acc: 0.278
Validation loss decreased (-0.254715 --> -0.277519).  Saving model ...
Epoch: 6 cost time: 14.99881625175476
Epoch: 6, Steps: 17 | Train Loss: 2.830 Vali Loss: 8.248 Vali Acc: 0.240 Test Loss: 8.248 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.422045469284058
Epoch: 7, Steps: 17 | Train Loss: 3.973 Vali Loss: 9.076 Vali Acc: 0.270 Test Loss: 9.076 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.694836616516113
Epoch: 8, Steps: 17 | Train Loss: 2.001 Vali Loss: 7.113 Vali Acc: 0.266 Test Loss: 7.113 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.115633010864258
Epoch: 9, Steps: 17 | Train Loss: 2.256 Vali Loss: 8.132 Vali Acc: 0.285 Test Loss: 8.132 Test Acc: 0.285
Validation loss decreased (-0.277519 --> -0.285090).  Saving model ...
Epoch: 10 cost time: 16.44075894355774
Epoch: 10, Steps: 17 | Train Loss: 1.663 Vali Loss: 9.423 Vali Acc: 0.270 Test Loss: 9.423 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.289627075195312
Epoch: 11, Steps: 17 | Train Loss: 2.998 Vali Loss: 7.980 Vali Acc: 0.262 Test Loss: 7.980 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.539767503738403
Epoch: 12, Steps: 17 | Train Loss: 2.286 Vali Loss: 8.960 Vali Acc: 0.221 Test Loss: 8.960 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.194926023483276
Epoch: 13, Steps: 17 | Train Loss: 1.925 Vali Loss: 11.072 Vali Acc: 0.274 Test Loss: 11.072 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.850772619247437
Epoch: 14, Steps: 17 | Train Loss: 1.857 Vali Loss: 11.701 Vali Acc: 0.262 Test Loss: 11.701 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 16.675231456756592
Epoch: 15, Steps: 17 | Train Loss: 1.560 Vali Loss: 12.349 Vali Acc: 0.251 Test Loss: 12.349 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 16.479748964309692
Epoch: 16, Steps: 17 | Train Loss: 1.521 Vali Loss: 8.759 Vali Acc: 0.247 Test Loss: 8.759 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 16.608067274093628
Epoch: 17, Steps: 17 | Train Loss: 1.286 Vali Loss: 11.408 Vali Acc: 0.255 Test Loss: 11.408 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.406219244003296
Epoch: 18, Steps: 17 | Train Loss: 1.581 Vali Loss: 10.796 Vali Acc: 0.262 Test Loss: 10.796 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 17.25078320503235
Epoch: 19, Steps: 17 | Train Loss: 1.834 Vali Loss: 11.560 Vali Acc: 0.247 Test Loss: 11.560 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.628390789031982
Epoch: 1, Steps: 17 | Train Loss: 1.938 Vali Loss: 4.425 Vali Acc: 0.251 Test Loss: 4.425 Test Acc: 0.251
Validation loss decreased (inf --> -0.250906).  Saving model ...
Epoch: 2 cost time: 13.970771789550781
Epoch: 2, Steps: 17 | Train Loss: 2.510 Vali Loss: 2.658 Vali Acc: 0.293 Test Loss: 2.658 Test Acc: 0.293
Validation loss decreased (-0.250906 --> -0.292749).  Saving model ...
Epoch: 3 cost time: 14.437018871307373
Epoch: 3, Steps: 17 | Train Loss: 2.862 Vali Loss: 7.444 Vali Acc: 0.243 Test Loss: 7.444 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.537905216217041
Epoch: 4, Steps: 17 | Train Loss: 3.197 Vali Loss: 3.681 Vali Acc: 0.243 Test Loss: 3.681 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.328348159790039
Epoch: 5, Steps: 17 | Train Loss: 2.313 Vali Loss: 6.343 Vali Acc: 0.236 Test Loss: 6.343 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.677268266677856
Epoch: 6, Steps: 17 | Train Loss: 3.170 Vali Loss: 6.588 Vali Acc: 0.274 Test Loss: 6.588 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.050464391708374
Epoch: 7, Steps: 17 | Train Loss: 3.476 Vali Loss: 11.812 Vali Acc: 0.240 Test Loss: 11.812 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.264050245285034
Epoch: 8, Steps: 17 | Train Loss: 3.548 Vali Loss: 5.383 Vali Acc: 0.251 Test Loss: 5.383 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.713569641113281
Epoch: 9, Steps: 17 | Train Loss: 2.191 Vali Loss: 7.760 Vali Acc: 0.236 Test Loss: 7.760 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.554152488708496
Epoch: 10, Steps: 17 | Train Loss: 1.644 Vali Loss: 9.256 Vali Acc: 0.262 Test Loss: 9.256 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.188027381896973
Epoch: 11, Steps: 17 | Train Loss: 2.978 Vali Loss: 8.411 Vali Acc: 0.262 Test Loss: 8.411 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.360010862350464
Epoch: 12, Steps: 17 | Train Loss: 1.679 Vali Loss: 7.710 Vali Acc: 0.281 Test Loss: 7.710 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.710625410079956
Epoch: 1, Steps: 17 | Train Loss: 1.950 Vali Loss: 4.372 Vali Acc: 0.236 Test Loss: 4.372 Test Acc: 0.236
Validation loss decreased (inf --> -0.235698).  Saving model ...
Epoch: 2 cost time: 12.755522012710571
Epoch: 2, Steps: 17 | Train Loss: 2.448 Vali Loss: 3.279 Vali Acc: 0.232 Test Loss: 3.279 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.506742477416992
Epoch: 3, Steps: 17 | Train Loss: 2.400 Vali Loss: 4.474 Vali Acc: 0.232 Test Loss: 4.474 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.41253924369812
Epoch: 4, Steps: 17 | Train Loss: 2.478 Vali Loss: 3.897 Vali Acc: 0.240 Test Loss: 3.897 Test Acc: 0.240
Validation loss decreased (-0.235698 --> -0.239505).  Saving model ...
Epoch: 5 cost time: 11.996620178222656
Epoch: 5, Steps: 17 | Train Loss: 1.913 Vali Loss: 4.739 Vali Acc: 0.232 Test Loss: 4.739 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.5453782081604
Epoch: 6, Steps: 17 | Train Loss: 1.495 Vali Loss: 6.301 Vali Acc: 0.251 Test Loss: 6.301 Test Acc: 0.251
Validation loss decreased (-0.239505 --> -0.250888).  Saving model ...
Epoch: 7 cost time: 12.209677934646606
Epoch: 7, Steps: 17 | Train Loss: 1.857 Vali Loss: 9.678 Vali Acc: 0.217 Test Loss: 9.678 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.627255916595459
Epoch: 8, Steps: 17 | Train Loss: 2.130 Vali Loss: 8.590 Vali Acc: 0.255 Test Loss: 8.590 Test Acc: 0.255
Validation loss decreased (-0.250888 --> -0.254667).  Saving model ...
Epoch: 9 cost time: 10.687381744384766
Epoch: 9, Steps: 17 | Train Loss: 2.390 Vali Loss: 8.130 Vali Acc: 0.251 Test Loss: 8.130 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.619335174560547
Epoch: 10, Steps: 17 | Train Loss: 1.835 Vali Loss: 9.632 Vali Acc: 0.247 Test Loss: 9.632 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.937327861785889
Epoch: 11, Steps: 17 | Train Loss: 1.797 Vali Loss: 7.033 Vali Acc: 0.259 Test Loss: 7.033 Test Acc: 0.259
Validation loss decreased (-0.254667 --> -0.258485).  Saving model ...
Epoch: 12 cost time: 12.132876634597778
Epoch: 12, Steps: 17 | Train Loss: 1.721 Vali Loss: 10.745 Vali Acc: 0.232 Test Loss: 10.745 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.859911441802979
Epoch: 13, Steps: 17 | Train Loss: 1.776 Vali Loss: 9.762 Vali Acc: 0.240 Test Loss: 9.762 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.55630111694336
Epoch: 14, Steps: 17 | Train Loss: 1.349 Vali Loss: 13.094 Vali Acc: 0.251 Test Loss: 13.094 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.143033504486084
Epoch: 15, Steps: 17 | Train Loss: 1.323 Vali Loss: 15.198 Vali Acc: 0.240 Test Loss: 15.198 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.007248163223267
Epoch: 16, Steps: 17 | Train Loss: 1.321 Vali Loss: 11.842 Vali Acc: 0.285 Test Loss: 11.842 Test Acc: 0.285
Validation loss decreased (-0.258485 --> -0.285053).  Saving model ...
Epoch: 17 cost time: 11.408082962036133
Epoch: 17, Steps: 17 | Train Loss: 1.112 Vali Loss: 13.177 Vali Acc: 0.251 Test Loss: 13.177 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.966201066970825
Epoch: 18, Steps: 17 | Train Loss: 1.807 Vali Loss: 18.757 Vali Acc: 0.236 Test Loss: 18.757 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.73074221611023
Epoch: 19, Steps: 17 | Train Loss: 1.579 Vali Loss: 19.820 Vali Acc: 0.240 Test Loss: 19.820 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.531620740890503
Epoch: 20, Steps: 17 | Train Loss: 1.191 Vali Loss: 13.815 Vali Acc: 0.251 Test Loss: 13.815 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.862470388412476
Epoch: 21, Steps: 17 | Train Loss: 1.339 Vali Loss: 25.767 Vali Acc: 0.247 Test Loss: 25.767 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.747931718826294
Epoch: 22, Steps: 17 | Train Loss: 1.813 Vali Loss: 15.913 Vali Acc: 0.278 Test Loss: 15.913 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.141464233398438
Epoch: 23, Steps: 17 | Train Loss: 1.103 Vali Loss: 23.735 Vali Acc: 0.259 Test Loss: 23.735 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.630470991134644
Epoch: 24, Steps: 17 | Train Loss: 1.397 Vali Loss: 20.791 Vali Acc: 0.262 Test Loss: 20.791 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.93178415298462
Epoch: 25, Steps: 17 | Train Loss: 1.546 Vali Loss: 22.277 Vali Acc: 0.232 Test Loss: 22.277 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.867127656936646
Epoch: 26, Steps: 17 | Train Loss: 1.263 Vali Loss: 22.044 Vali Acc: 0.240 Test Loss: 22.044 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.221241474151611
Epoch: 1, Steps: 17 | Train Loss: 1.818 Vali Loss: 4.392 Vali Acc: 0.262 Test Loss: 4.392 Test Acc: 0.262
Validation loss decreased (inf --> -0.262313).  Saving model ...
Epoch: 2 cost time: 11.080888748168945
Epoch: 2, Steps: 17 | Train Loss: 2.475 Vali Loss: 6.210 Vali Acc: 0.243 Test Loss: 6.210 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.262938976287842
Epoch: 3, Steps: 17 | Train Loss: 2.350 Vali Loss: 5.887 Vali Acc: 0.262 Test Loss: 5.887 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.634199142456055
Epoch: 4, Steps: 17 | Train Loss: 1.634 Vali Loss: 4.255 Vali Acc: 0.221 Test Loss: 4.255 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.7572340965271
Epoch: 5, Steps: 17 | Train Loss: 1.726 Vali Loss: 8.665 Vali Acc: 0.255 Test Loss: 8.665 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.601080417633057
Epoch: 6, Steps: 17 | Train Loss: 1.770 Vali Loss: 9.703 Vali Acc: 0.278 Test Loss: 9.703 Test Acc: 0.278
Validation loss decreased (-0.262313 --> -0.277470).  Saving model ...
Epoch: 7 cost time: 11.411597967147827
Epoch: 7, Steps: 17 | Train Loss: 2.471 Vali Loss: 14.118 Vali Acc: 0.259 Test Loss: 14.118 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.348373651504517
Epoch: 8, Steps: 17 | Train Loss: 2.063 Vali Loss: 8.387 Vali Acc: 0.274 Test Loss: 8.387 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.49888801574707
Epoch: 9, Steps: 17 | Train Loss: 2.192 Vali Loss: 9.436 Vali Acc: 0.243 Test Loss: 9.436 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.492658376693726
Epoch: 10, Steps: 17 | Train Loss: 1.566 Vali Loss: 11.305 Vali Acc: 0.213 Test Loss: 11.305 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.257350444793701
Epoch: 11, Steps: 17 | Train Loss: 1.783 Vali Loss: 10.734 Vali Acc: 0.281 Test Loss: 10.734 Test Acc: 0.281
Validation loss decreased (-0.277470 --> -0.281261).  Saving model ...
Epoch: 12 cost time: 10.330236434936523
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 15.385 Vali Acc: 0.247 Test Loss: 15.385 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.061290264129639
Epoch: 13, Steps: 17 | Train Loss: 1.472 Vali Loss: 11.351 Vali Acc: 0.217 Test Loss: 11.351 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.60310673713684
Epoch: 14, Steps: 17 | Train Loss: 1.760 Vali Loss: 25.000 Vali Acc: 0.255 Test Loss: 25.000 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.503745555877686
Epoch: 15, Steps: 17 | Train Loss: 1.668 Vali Loss: 11.204 Vali Acc: 0.247 Test Loss: 11.204 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.254997253417969
Epoch: 16, Steps: 17 | Train Loss: 1.912 Vali Loss: 25.169 Vali Acc: 0.240 Test Loss: 25.169 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.13758635520935
Epoch: 17, Steps: 17 | Train Loss: 1.713 Vali Loss: 17.443 Vali Acc: 0.262 Test Loss: 17.443 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.805068254470825
Epoch: 18, Steps: 17 | Train Loss: 1.045 Vali Loss: 23.503 Vali Acc: 0.293 Test Loss: 23.503 Test Acc: 0.293
Validation loss decreased (-0.281261 --> -0.292541).  Saving model ...
Epoch: 19 cost time: 10.002806663513184
Epoch: 19, Steps: 17 | Train Loss: 0.716 Vali Loss: 21.684 Vali Acc: 0.266 Test Loss: 21.684 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.008256673812866
Epoch: 20, Steps: 17 | Train Loss: 2.437 Vali Loss: 25.487 Vali Acc: 0.293 Test Loss: 25.487 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.317922592163086
Epoch: 21, Steps: 17 | Train Loss: 0.948 Vali Loss: 18.811 Vali Acc: 0.274 Test Loss: 18.811 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.872734308242798
Epoch: 22, Steps: 17 | Train Loss: 0.825 Vali Loss: 29.863 Vali Acc: 0.259 Test Loss: 29.863 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.35763955116272
Epoch: 23, Steps: 17 | Train Loss: 1.130 Vali Loss: 21.268 Vali Acc: 0.281 Test Loss: 21.268 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.390267610549927
Epoch: 24, Steps: 17 | Train Loss: 2.239 Vali Loss: 32.950 Vali Acc: 0.251 Test Loss: 32.950 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.834716796875
Epoch: 25, Steps: 17 | Train Loss: 2.104 Vali Loss: 26.452 Vali Acc: 0.251 Test Loss: 26.452 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 10.9033203125
Epoch: 26, Steps: 17 | Train Loss: 1.415 Vali Loss: 25.443 Vali Acc: 0.285 Test Loss: 25.443 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.900577306747437
Epoch: 27, Steps: 17 | Train Loss: 1.010 Vali Loss: 38.704 Vali Acc: 0.259 Test Loss: 38.704 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.848825931549072
Epoch: 28, Steps: 17 | Train Loss: 1.271 Vali Loss: 31.670 Vali Acc: 0.289 Test Loss: 31.670 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.54384732246399
Epoch: 1, Steps: 17 | Train Loss: 1.759 Vali Loss: 4.035 Vali Acc: 0.243 Test Loss: 4.035 Test Acc: 0.243
Validation loss decreased (inf --> -0.243306).  Saving model ...
Epoch: 2 cost time: 8.110960960388184
Epoch: 2, Steps: 17 | Train Loss: 2.384 Vali Loss: 5.150 Vali Acc: 0.251 Test Loss: 5.150 Test Acc: 0.251
Validation loss decreased (-0.243306 --> -0.250899).  Saving model ...
Epoch: 3 cost time: 8.259382724761963
Epoch: 3, Steps: 17 | Train Loss: 1.902 Vali Loss: 4.857 Vali Acc: 0.251 Test Loss: 4.857 Test Acc: 0.251
Validation loss decreased (-0.250899 --> -0.250902).  Saving model ...
Epoch: 4 cost time: 8.75763988494873
Epoch: 4, Steps: 17 | Train Loss: 1.539 Vali Loss: 3.416 Vali Acc: 0.262 Test Loss: 3.416 Test Acc: 0.262
Validation loss decreased (-0.250902 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 8.499340057373047
Epoch: 5, Steps: 17 | Train Loss: 1.711 Vali Loss: 10.138 Vali Acc: 0.247 Test Loss: 10.138 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.448970794677734
Epoch: 6, Steps: 17 | Train Loss: 2.092 Vali Loss: 7.512 Vali Acc: 0.274 Test Loss: 7.512 Test Acc: 0.274
Validation loss decreased (-0.262323 --> -0.273689).  Saving model ...
Epoch: 7 cost time: 9.141488790512085
Epoch: 7, Steps: 17 | Train Loss: 2.763 Vali Loss: 9.958 Vali Acc: 0.285 Test Loss: 9.958 Test Acc: 0.285
Validation loss decreased (-0.273689 --> -0.285072).  Saving model ...
Epoch: 8 cost time: 8.765447616577148
Epoch: 8, Steps: 17 | Train Loss: 2.632 Vali Loss: 7.956 Vali Acc: 0.289 Test Loss: 7.956 Test Acc: 0.289
Validation loss decreased (-0.285072 --> -0.288894).  Saving model ...
Epoch: 9 cost time: 8.746775388717651
Epoch: 9, Steps: 17 | Train Loss: 1.594 Vali Loss: 10.639 Vali Acc: 0.259 Test Loss: 10.639 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.893463373184204
Epoch: 10, Steps: 17 | Train Loss: 2.255 Vali Loss: 13.873 Vali Acc: 0.274 Test Loss: 13.873 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.876065969467163
Epoch: 11, Steps: 17 | Train Loss: 1.265 Vali Loss: 12.223 Vali Acc: 0.270 Test Loss: 12.223 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.386850118637085
Epoch: 12, Steps: 17 | Train Loss: 1.395 Vali Loss: 13.091 Vali Acc: 0.278 Test Loss: 13.091 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.5906054973602295
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 12.756 Vali Acc: 0.236 Test Loss: 12.756 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.9950432777404785
Epoch: 14, Steps: 17 | Train Loss: 1.599 Vali Loss: 17.700 Vali Acc: 0.274 Test Loss: 17.700 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.22616720199585
Epoch: 15, Steps: 17 | Train Loss: 1.658 Vali Loss: 22.359 Vali Acc: 0.281 Test Loss: 22.359 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.931833028793335
Epoch: 16, Steps: 17 | Train Loss: 1.729 Vali Loss: 20.012 Vali Acc: 0.281 Test Loss: 20.012 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.21943473815918
Epoch: 17, Steps: 17 | Train Loss: 1.432 Vali Loss: 17.706 Vali Acc: 0.255 Test Loss: 17.706 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.703860521316528
Epoch: 18, Steps: 17 | Train Loss: 1.381 Vali Loss: 21.214 Vali Acc: 0.259 Test Loss: 21.214 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.930201530456543
Epoch: 1, Steps: 17 | Train Loss: 1.662 Vali Loss: 4.363 Vali Acc: 0.255 Test Loss: 4.363 Test Acc: 0.255
Validation loss decreased (inf --> -0.254709).  Saving model ...
Epoch: 2 cost time: 7.2260143756866455
Epoch: 2, Steps: 17 | Train Loss: 2.044 Vali Loss: 6.743 Vali Acc: 0.251 Test Loss: 6.743 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.583085775375366
Epoch: 3, Steps: 17 | Train Loss: 1.907 Vali Loss: 5.498 Vali Acc: 0.251 Test Loss: 5.498 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.948545455932617
Epoch: 4, Steps: 17 | Train Loss: 1.612 Vali Loss: 4.842 Vali Acc: 0.247 Test Loss: 4.842 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.975755214691162
Epoch: 5, Steps: 17 | Train Loss: 1.667 Vali Loss: 6.686 Vali Acc: 0.228 Test Loss: 6.686 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.914029359817505
Epoch: 6, Steps: 17 | Train Loss: 1.668 Vali Loss: 8.016 Vali Acc: 0.255 Test Loss: 8.016 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.157378673553467
Epoch: 7, Steps: 17 | Train Loss: 2.910 Vali Loss: 9.560 Vali Acc: 0.270 Test Loss: 9.560 Test Acc: 0.270
Validation loss decreased (-0.254709 --> -0.269866).  Saving model ...
Epoch: 8 cost time: 7.474668264389038
Epoch: 8, Steps: 17 | Train Loss: 2.841 Vali Loss: 9.466 Vali Acc: 0.240 Test Loss: 9.466 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.341808795928955
Epoch: 9, Steps: 17 | Train Loss: 1.403 Vali Loss: 7.099 Vali Acc: 0.240 Test Loss: 7.099 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.639168739318848
Epoch: 10, Steps: 17 | Train Loss: 1.419 Vali Loss: 8.099 Vali Acc: 0.251 Test Loss: 8.099 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.526538610458374
Epoch: 11, Steps: 17 | Train Loss: 2.004 Vali Loss: 9.924 Vali Acc: 0.262 Test Loss: 9.924 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.25611686706543
Epoch: 12, Steps: 17 | Train Loss: 1.268 Vali Loss: 10.798 Vali Acc: 0.243 Test Loss: 10.798 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.119070291519165
Epoch: 13, Steps: 17 | Train Loss: 1.350 Vali Loss: 10.257 Vali Acc: 0.274 Test Loss: 10.257 Test Acc: 0.274
Validation loss decreased (-0.269866 --> -0.273662).  Saving model ...
Epoch: 14 cost time: 7.570311784744263
Epoch: 14, Steps: 17 | Train Loss: 1.203 Vali Loss: 17.303 Vali Acc: 0.228 Test Loss: 17.303 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.8105268478393555
Epoch: 15, Steps: 17 | Train Loss: 1.238 Vali Loss: 13.658 Vali Acc: 0.247 Test Loss: 13.658 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.3885977268219
Epoch: 16, Steps: 17 | Train Loss: 1.289 Vali Loss: 16.337 Vali Acc: 0.247 Test Loss: 16.337 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.057878971099854
Epoch: 17, Steps: 17 | Train Loss: 1.217 Vali Loss: 17.035 Vali Acc: 0.262 Test Loss: 17.035 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.8007121086120605
Epoch: 18, Steps: 17 | Train Loss: 0.648 Vali Loss: 16.052 Vali Acc: 0.266 Test Loss: 16.052 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.876323461532593
Epoch: 19, Steps: 17 | Train Loss: 0.711 Vali Loss: 18.041 Vali Acc: 0.228 Test Loss: 18.041 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.185529470443726
Epoch: 20, Steps: 17 | Train Loss: 0.605 Vali Loss: 16.259 Vali Acc: 0.217 Test Loss: 16.259 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.704710245132446
Epoch: 21, Steps: 17 | Train Loss: 0.370 Vali Loss: 22.208 Vali Acc: 0.278 Test Loss: 22.208 Test Acc: 0.278
Validation loss decreased (-0.273662 --> -0.277344).  Saving model ...
Epoch: 22 cost time: 7.428481101989746
Epoch: 22, Steps: 17 | Train Loss: 1.103 Vali Loss: 25.373 Vali Acc: 0.251 Test Loss: 25.373 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.916999340057373
Epoch: 23, Steps: 17 | Train Loss: 1.375 Vali Loss: 21.926 Vali Acc: 0.243 Test Loss: 21.926 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.174571990966797
Epoch: 24, Steps: 17 | Train Loss: 0.967 Vali Loss: 33.012 Vali Acc: 0.221 Test Loss: 33.012 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.12591290473938
Epoch: 25, Steps: 17 | Train Loss: 0.747 Vali Loss: 26.004 Vali Acc: 0.266 Test Loss: 26.004 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.763150453567505
Epoch: 26, Steps: 17 | Train Loss: 1.668 Vali Loss: 33.970 Vali Acc: 0.209 Test Loss: 33.970 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.982062101364136
Epoch: 27, Steps: 17 | Train Loss: 2.597 Vali Loss: 40.378 Vali Acc: 0.217 Test Loss: 40.378 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.9458630084991455
Epoch: 28, Steps: 17 | Train Loss: 1.547 Vali Loss: 38.069 Vali Acc: 0.232 Test Loss: 38.069 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.767047882080078
Epoch: 29, Steps: 17 | Train Loss: 0.866 Vali Loss: 37.154 Vali Acc: 0.213 Test Loss: 37.154 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.872758150100708
Epoch: 30, Steps: 17 | Train Loss: 0.550 Vali Loss: 39.173 Vali Acc: 0.217 Test Loss: 39.173 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.932028770446777
Epoch: 31, Steps: 17 | Train Loss: 0.623 Vali Loss: 41.991 Vali Acc: 0.240 Test Loss: 41.991 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.47714352607727
Epoch: 1, Steps: 17 | Train Loss: 1.628 Vali Loss: 4.532 Vali Acc: 0.251 Test Loss: 4.532 Test Acc: 0.251
Validation loss decreased (inf --> -0.250905).  Saving model ...
Epoch: 2 cost time: 7.211549997329712
Epoch: 2, Steps: 17 | Train Loss: 1.889 Vali Loss: 6.023 Vali Acc: 0.247 Test Loss: 6.023 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.044167995452881
Epoch: 3, Steps: 17 | Train Loss: 1.827 Vali Loss: 4.777 Vali Acc: 0.259 Test Loss: 4.777 Test Acc: 0.259
Validation loss decreased (-0.250905 --> -0.258507).  Saving model ...
Epoch: 4 cost time: 7.779743671417236
Epoch: 4, Steps: 17 | Train Loss: 1.479 Vali Loss: 5.116 Vali Acc: 0.255 Test Loss: 5.116 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.690675497055054
Epoch: 5, Steps: 17 | Train Loss: 1.802 Vali Loss: 8.810 Vali Acc: 0.251 Test Loss: 8.810 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.751528739929199
Epoch: 6, Steps: 17 | Train Loss: 1.811 Vali Loss: 5.406 Vali Acc: 0.278 Test Loss: 5.406 Test Acc: 0.278
Validation loss decreased (-0.258507 --> -0.277512).  Saving model ...
Epoch: 7 cost time: 7.533754587173462
Epoch: 7, Steps: 17 | Train Loss: 2.483 Vali Loss: 10.683 Vali Acc: 0.259 Test Loss: 10.683 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.676478624343872
Epoch: 8, Steps: 17 | Train Loss: 1.804 Vali Loss: 8.078 Vali Acc: 0.266 Test Loss: 8.078 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.7921142578125
Epoch: 9, Steps: 17 | Train Loss: 1.215 Vali Loss: 12.340 Vali Acc: 0.259 Test Loss: 12.340 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.544351577758789
Epoch: 10, Steps: 17 | Train Loss: 1.265 Vali Loss: 9.781 Vali Acc: 0.270 Test Loss: 9.781 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.916284084320068
Epoch: 11, Steps: 17 | Train Loss: 1.146 Vali Loss: 11.155 Vali Acc: 0.243 Test Loss: 11.155 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.731915712356567
Epoch: 12, Steps: 17 | Train Loss: 1.736 Vali Loss: 14.866 Vali Acc: 0.213 Test Loss: 14.866 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.755168676376343
Epoch: 13, Steps: 17 | Train Loss: 1.638 Vali Loss: 10.807 Vali Acc: 0.217 Test Loss: 10.807 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.624656438827515
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 16.625 Vali Acc: 0.262 Test Loss: 16.625 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.240687131881714
Epoch: 15, Steps: 17 | Train Loss: 0.778 Vali Loss: 14.501 Vali Acc: 0.255 Test Loss: 14.501 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.35658597946167
Epoch: 16, Steps: 17 | Train Loss: 1.817 Vali Loss: 14.209 Vali Acc: 0.228 Test Loss: 14.209 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.504834413528442
Epoch: 1, Steps: 17 | Train Loss: 1.628 Vali Loss: 4.619 Vali Acc: 0.251 Test Loss: 4.619 Test Acc: 0.251
Validation loss decreased (inf --> -0.250904).  Saving model ...
Epoch: 2 cost time: 7.059641361236572
Epoch: 2, Steps: 17 | Train Loss: 1.871 Vali Loss: 6.192 Vali Acc: 0.251 Test Loss: 6.192 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.611359596252441
Epoch: 3, Steps: 17 | Train Loss: 1.551 Vali Loss: 5.328 Vali Acc: 0.255 Test Loss: 5.328 Test Acc: 0.255
Validation loss decreased (-0.250904 --> -0.254700).  Saving model ...
Epoch: 4 cost time: 7.433813095092773
Epoch: 4, Steps: 17 | Train Loss: 1.702 Vali Loss: 4.843 Vali Acc: 0.255 Test Loss: 4.843 Test Acc: 0.255
Validation loss decreased (-0.254700 --> -0.254704).  Saving model ...
Epoch: 5 cost time: 7.549508094787598
Epoch: 5, Steps: 17 | Train Loss: 1.579 Vali Loss: 6.499 Vali Acc: 0.236 Test Loss: 6.499 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.308460712432861
Epoch: 6, Steps: 17 | Train Loss: 1.718 Vali Loss: 7.933 Vali Acc: 0.247 Test Loss: 7.933 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.22998309135437
Epoch: 7, Steps: 17 | Train Loss: 1.686 Vali Loss: 8.147 Vali Acc: 0.251 Test Loss: 8.147 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.327637195587158
Epoch: 8, Steps: 17 | Train Loss: 1.385 Vali Loss: 7.149 Vali Acc: 0.259 Test Loss: 7.149 Test Acc: 0.259
Validation loss decreased (-0.254704 --> -0.258484).  Saving model ...
Epoch: 9 cost time: 6.88146448135376
Epoch: 9, Steps: 17 | Train Loss: 1.542 Vali Loss: 12.104 Vali Acc: 0.262 Test Loss: 12.104 Test Acc: 0.262
Validation loss decreased (-0.258484 --> -0.262236).  Saving model ...
Epoch: 10 cost time: 6.534574270248413
Epoch: 10, Steps: 17 | Train Loss: 1.368 Vali Loss: 7.265 Vali Acc: 0.255 Test Loss: 7.265 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.489630937576294
Epoch: 11, Steps: 17 | Train Loss: 1.577 Vali Loss: 10.050 Vali Acc: 0.240 Test Loss: 10.050 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.690185785293579
Epoch: 12, Steps: 17 | Train Loss: 1.768 Vali Loss: 13.500 Vali Acc: 0.236 Test Loss: 13.500 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.511176109313965
Epoch: 13, Steps: 17 | Train Loss: 1.070 Vali Loss: 11.780 Vali Acc: 0.243 Test Loss: 11.780 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.872447490692139
Epoch: 14, Steps: 17 | Train Loss: 1.435 Vali Loss: 14.842 Vali Acc: 0.209 Test Loss: 14.842 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.2919602394104
Epoch: 15, Steps: 17 | Train Loss: 1.256 Vali Loss: 14.989 Vali Acc: 0.247 Test Loss: 14.989 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.60496187210083
Epoch: 16, Steps: 17 | Train Loss: 1.252 Vali Loss: 16.981 Vali Acc: 0.259 Test Loss: 16.981 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.622760772705078
Epoch: 17, Steps: 17 | Train Loss: 1.317 Vali Loss: 19.835 Vali Acc: 0.262 Test Loss: 19.835 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.285969257354736
Epoch: 18, Steps: 17 | Train Loss: 1.243 Vali Loss: 19.205 Vali Acc: 0.236 Test Loss: 19.205 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.400986909866333
Epoch: 19, Steps: 17 | Train Loss: 0.445 Vali Loss: 19.979 Vali Acc: 0.221 Test Loss: 19.979 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.181033611297607
Epoch: 1, Steps: 17 | Train Loss: 1.622 Vali Loss: 3.920 Vali Acc: 0.251 Test Loss: 3.920 Test Acc: 0.251
Validation loss decreased (inf --> -0.250911).  Saving model ...
Epoch: 2 cost time: 6.783912897109985
Epoch: 2, Steps: 17 | Train Loss: 1.873 Vali Loss: 7.940 Vali Acc: 0.251 Test Loss: 7.940 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.3445611000061035
Epoch: 3, Steps: 17 | Train Loss: 2.052 Vali Loss: 7.379 Vali Acc: 0.255 Test Loss: 7.379 Test Acc: 0.255
Validation loss decreased (-0.250911 --> -0.254679).  Saving model ...
Epoch: 4 cost time: 6.677476644515991
Epoch: 4, Steps: 17 | Train Loss: 1.609 Vali Loss: 3.318 Vali Acc: 0.262 Test Loss: 3.318 Test Acc: 0.262
Validation loss decreased (-0.254679 --> -0.262324).  Saving model ...
Epoch: 5 cost time: 6.641822814941406
Epoch: 5, Steps: 17 | Train Loss: 2.102 Vali Loss: 9.736 Vali Acc: 0.259 Test Loss: 9.736 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.662325382232666
Epoch: 6, Steps: 17 | Train Loss: 2.201 Vali Loss: 7.949 Vali Acc: 0.262 Test Loss: 7.949 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.831595182418823
Epoch: 7, Steps: 17 | Train Loss: 1.910 Vali Loss: 8.475 Vali Acc: 0.217 Test Loss: 8.475 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.192449569702148
Epoch: 8, Steps: 17 | Train Loss: 1.652 Vali Loss: 9.109 Vali Acc: 0.240 Test Loss: 9.109 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.344423294067383
Epoch: 9, Steps: 17 | Train Loss: 1.764 Vali Loss: 11.635 Vali Acc: 0.266 Test Loss: 11.635 Test Acc: 0.266
Validation loss decreased (-0.262324 --> -0.266043).  Saving model ...
Epoch: 10 cost time: 7.267817974090576
Epoch: 10, Steps: 17 | Train Loss: 1.244 Vali Loss: 9.277 Vali Acc: 0.251 Test Loss: 9.277 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.321770668029785
Epoch: 11, Steps: 17 | Train Loss: 1.084 Vali Loss: 9.918 Vali Acc: 0.247 Test Loss: 9.918 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.4236555099487305
Epoch: 12, Steps: 17 | Train Loss: 1.807 Vali Loss: 12.722 Vali Acc: 0.232 Test Loss: 12.722 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.005112886428833
Epoch: 13, Steps: 17 | Train Loss: 0.963 Vali Loss: 17.181 Vali Acc: 0.259 Test Loss: 17.181 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.783332824707031
Epoch: 14, Steps: 17 | Train Loss: 1.416 Vali Loss: 19.935 Vali Acc: 0.247 Test Loss: 19.935 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.256017684936523
Epoch: 15, Steps: 17 | Train Loss: 1.273 Vali Loss: 14.977 Vali Acc: 0.240 Test Loss: 14.977 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.365248680114746
Epoch: 16, Steps: 17 | Train Loss: 1.527 Vali Loss: 16.858 Vali Acc: 0.278 Test Loss: 16.858 Test Acc: 0.278
Validation loss decreased (-0.266043 --> -0.277398).  Saving model ...
Epoch: 17 cost time: 7.088435649871826
Epoch: 17, Steps: 17 | Train Loss: 1.051 Vali Loss: 20.892 Vali Acc: 0.247 Test Loss: 20.892 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.626547813415527
Epoch: 18, Steps: 17 | Train Loss: 1.282 Vali Loss: 20.377 Vali Acc: 0.255 Test Loss: 20.377 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.8353590965271
Epoch: 19, Steps: 17 | Train Loss: 1.718 Vali Loss: 26.697 Vali Acc: 0.240 Test Loss: 26.697 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.7821807861328125
Epoch: 20, Steps: 17 | Train Loss: 1.220 Vali Loss: 25.417 Vali Acc: 0.236 Test Loss: 25.417 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.449819087982178
Epoch: 21, Steps: 17 | Train Loss: 1.172 Vali Loss: 30.692 Vali Acc: 0.251 Test Loss: 30.692 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.941254138946533
Epoch: 22, Steps: 17 | Train Loss: 1.193 Vali Loss: 27.348 Vali Acc: 0.232 Test Loss: 27.348 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.234904766082764
Epoch: 23, Steps: 17 | Train Loss: 1.017 Vali Loss: 27.079 Vali Acc: 0.251 Test Loss: 27.079 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.528701305389404
Epoch: 24, Steps: 17 | Train Loss: 1.593 Vali Loss: 40.179 Vali Acc: 0.243 Test Loss: 40.179 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.274082899093628
Epoch: 25, Steps: 17 | Train Loss: 1.959 Vali Loss: 40.386 Vali Acc: 0.217 Test Loss: 40.386 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.534449338912964
Epoch: 26, Steps: 17 | Train Loss: 1.323 Vali Loss: 43.149 Vali Acc: 0.228 Test Loss: 43.149 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.682668447494507
Epoch: 1, Steps: 17 | Train Loss: 1.653 Vali Loss: 3.183 Vali Acc: 0.251 Test Loss: 3.183 Test Acc: 0.251
Validation loss decreased (inf --> -0.250919).  Saving model ...
Epoch: 2 cost time: 6.996020793914795
Epoch: 2, Steps: 17 | Train Loss: 2.050 Vali Loss: 7.424 Vali Acc: 0.251 Test Loss: 7.424 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.122157573699951
Epoch: 3, Steps: 17 | Train Loss: 1.993 Vali Loss: 9.280 Vali Acc: 0.251 Test Loss: 9.280 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.954141855239868
Epoch: 4, Steps: 17 | Train Loss: 1.832 Vali Loss: 7.136 Vali Acc: 0.251 Test Loss: 7.136 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.26655650138855
Epoch: 5, Steps: 17 | Train Loss: 1.953 Vali Loss: 8.159 Vali Acc: 0.251 Test Loss: 8.159 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.063617944717407
Epoch: 6, Steps: 17 | Train Loss: 2.108 Vali Loss: 10.015 Vali Acc: 0.240 Test Loss: 10.015 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.058814525604248
Epoch: 7, Steps: 17 | Train Loss: 3.162 Vali Loss: 8.342 Vali Acc: 0.259 Test Loss: 8.342 Test Acc: 0.259
Validation loss decreased (-0.250919 --> -0.258472).  Saving model ...
Epoch: 8 cost time: 6.974774122238159
Epoch: 8, Steps: 17 | Train Loss: 1.965 Vali Loss: 8.564 Vali Acc: 0.251 Test Loss: 8.564 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.111264705657959
Epoch: 9, Steps: 17 | Train Loss: 1.900 Vali Loss: 13.233 Vali Acc: 0.247 Test Loss: 13.233 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.250247001647949
Epoch: 10, Steps: 17 | Train Loss: 1.672 Vali Loss: 9.516 Vali Acc: 0.221 Test Loss: 9.516 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.84657621383667
Epoch: 11, Steps: 17 | Train Loss: 1.999 Vali Loss: 10.412 Vali Acc: 0.247 Test Loss: 10.412 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.962062358856201
Epoch: 12, Steps: 17 | Train Loss: 2.520 Vali Loss: 12.430 Vali Acc: 0.213 Test Loss: 12.430 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.056449890136719
Epoch: 13, Steps: 17 | Train Loss: 1.230 Vali Loss: 12.232 Vali Acc: 0.251 Test Loss: 12.232 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.1692259311676025
Epoch: 14, Steps: 17 | Train Loss: 1.621 Vali Loss: 16.129 Vali Acc: 0.259 Test Loss: 16.129 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.9996747970581055
Epoch: 15, Steps: 17 | Train Loss: 1.496 Vali Loss: 15.607 Vali Acc: 0.247 Test Loss: 15.607 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.875165700912476
Epoch: 16, Steps: 17 | Train Loss: 2.128 Vali Loss: 17.252 Vali Acc: 0.228 Test Loss: 17.252 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.090958833694458
Epoch: 17, Steps: 17 | Train Loss: 1.342 Vali Loss: 19.136 Vali Acc: 0.236 Test Loss: 19.136 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 4822532
model size : 28.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.769721508026123
Epoch: 1, Steps: 17 | Train Loss: 1.956 Vali Loss: 4.296 Vali Acc: 0.262 Test Loss: 4.296 Test Acc: 0.262
Validation loss decreased (inf --> -0.262314).  Saving model ...
Epoch: 2 cost time: 15.489132165908813
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.681 Vali Acc: 0.247 Test Loss: 2.681 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.3507239818573
Epoch: 3, Steps: 17 | Train Loss: 1.947 Vali Loss: 2.808 Vali Acc: 0.262 Test Loss: 2.808 Test Acc: 0.262
Validation loss decreased (-0.262314 --> -0.262329).  Saving model ...
Epoch: 4 cost time: 17.019851207733154
Epoch: 4, Steps: 17 | Train Loss: 2.256 Vali Loss: 4.213 Vali Acc: 0.262 Test Loss: 4.213 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.770719289779663
Epoch: 5, Steps: 17 | Train Loss: 1.735 Vali Loss: 5.720 Vali Acc: 0.274 Test Loss: 5.720 Test Acc: 0.274
Validation loss decreased (-0.262329 --> -0.273707).  Saving model ...
Epoch: 6 cost time: 18.47339129447937
Epoch: 6, Steps: 17 | Train Loss: 2.922 Vali Loss: 5.174 Vali Acc: 0.247 Test Loss: 5.174 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.718234539031982
Epoch: 7, Steps: 17 | Train Loss: 2.542 Vali Loss: 6.388 Vali Acc: 0.251 Test Loss: 6.388 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.214454889297485
Epoch: 8, Steps: 17 | Train Loss: 2.258 Vali Loss: 8.596 Vali Acc: 0.259 Test Loss: 8.596 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.503174066543579
Epoch: 9, Steps: 17 | Train Loss: 3.033 Vali Loss: 8.874 Vali Acc: 0.281 Test Loss: 8.874 Test Acc: 0.281
Validation loss decreased (-0.273707 --> -0.281280).  Saving model ...
Epoch: 10 cost time: 18.157280683517456
Epoch: 10, Steps: 17 | Train Loss: 1.566 Vali Loss: 5.875 Vali Acc: 0.289 Test Loss: 5.875 Test Acc: 0.289
Validation loss decreased (-0.281280 --> -0.288915).  Saving model ...
Epoch: 11 cost time: 16.147119522094727
Epoch: 11, Steps: 17 | Train Loss: 1.370 Vali Loss: 8.463 Vali Acc: 0.262 Test Loss: 8.463 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.956623077392578
Epoch: 12, Steps: 17 | Train Loss: 2.195 Vali Loss: 9.220 Vali Acc: 0.262 Test Loss: 9.220 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.91315197944641
Epoch: 13, Steps: 17 | Train Loss: 1.386 Vali Loss: 7.842 Vali Acc: 0.285 Test Loss: 7.842 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.715358018875122
Epoch: 14, Steps: 17 | Train Loss: 2.021 Vali Loss: 8.540 Vali Acc: 0.255 Test Loss: 8.540 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.992950677871704
Epoch: 15, Steps: 17 | Train Loss: 1.791 Vali Loss: 9.314 Vali Acc: 0.243 Test Loss: 9.314 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 18.421820402145386
Epoch: 16, Steps: 17 | Train Loss: 1.533 Vali Loss: 8.749 Vali Acc: 0.285 Test Loss: 8.749 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.141900539398193
Epoch: 17, Steps: 17 | Train Loss: 2.008 Vali Loss: 12.707 Vali Acc: 0.243 Test Loss: 12.707 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.066089630126953
Epoch: 18, Steps: 17 | Train Loss: 2.501 Vali Loss: 16.472 Vali Acc: 0.278 Test Loss: 16.472 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.458274841308594
Epoch: 19, Steps: 17 | Train Loss: 1.534 Vali Loss: 13.464 Vali Acc: 0.251 Test Loss: 13.464 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 16.727550268173218
Epoch: 20, Steps: 17 | Train Loss: 1.405 Vali Loss: 12.179 Vali Acc: 0.251 Test Loss: 12.179 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.44166350364685
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 4.213 Vali Acc: 0.255 Test Loss: 4.213 Test Acc: 0.255
Validation loss decreased (inf --> -0.254711).  Saving model ...
Epoch: 2 cost time: 15.45658802986145
Epoch: 2, Steps: 17 | Train Loss: 2.349 Vali Loss: 4.553 Vali Acc: 0.240 Test Loss: 4.553 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.273966550827026
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 2.614 Vali Acc: 0.259 Test Loss: 2.614 Test Acc: 0.259
Validation loss decreased (-0.254711 --> -0.258529).  Saving model ...
Epoch: 4 cost time: 15.06246542930603
Epoch: 4, Steps: 17 | Train Loss: 1.778 Vali Loss: 3.495 Vali Acc: 0.300 Test Loss: 3.495 Test Acc: 0.300
Validation loss decreased (-0.258529 --> -0.300345).  Saving model ...
Epoch: 5 cost time: 14.338816165924072
Epoch: 5, Steps: 17 | Train Loss: 1.606 Vali Loss: 4.727 Vali Acc: 0.259 Test Loss: 4.727 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.06266736984253
Epoch: 6, Steps: 17 | Train Loss: 2.561 Vali Loss: 6.378 Vali Acc: 0.293 Test Loss: 6.378 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.917518138885498
Epoch: 7, Steps: 17 | Train Loss: 2.988 Vali Loss: 10.835 Vali Acc: 0.262 Test Loss: 10.835 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.873288631439209
Epoch: 8, Steps: 17 | Train Loss: 3.799 Vali Loss: 6.213 Vali Acc: 0.297 Test Loss: 6.213 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.013783931732178
Epoch: 9, Steps: 17 | Train Loss: 2.323 Vali Loss: 7.456 Vali Acc: 0.289 Test Loss: 7.456 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.79237174987793
Epoch: 10, Steps: 17 | Train Loss: 1.882 Vali Loss: 10.025 Vali Acc: 0.278 Test Loss: 10.025 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.509568452835083
Epoch: 11, Steps: 17 | Train Loss: 2.653 Vali Loss: 7.086 Vali Acc: 0.281 Test Loss: 7.086 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.6612229347229
Epoch: 12, Steps: 17 | Train Loss: 1.997 Vali Loss: 6.864 Vali Acc: 0.247 Test Loss: 6.864 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.689779281616211
Epoch: 13, Steps: 17 | Train Loss: 1.615 Vali Loss: 9.685 Vali Acc: 0.224 Test Loss: 9.685 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.243545055389404
Epoch: 14, Steps: 17 | Train Loss: 2.409 Vali Loss: 9.205 Vali Acc: 0.262 Test Loss: 9.205 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.940001964569092
Epoch: 1, Steps: 17 | Train Loss: 1.832 Vali Loss: 4.744 Vali Acc: 0.247 Test Loss: 4.744 Test Acc: 0.247
Validation loss decreased (inf --> -0.247101).  Saving model ...
Epoch: 2 cost time: 11.93891954421997
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.832 Vali Acc: 0.240 Test Loss: 2.832 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.026238679885864
Epoch: 3, Steps: 17 | Train Loss: 1.838 Vali Loss: 6.311 Vali Acc: 0.259 Test Loss: 6.311 Test Acc: 0.259
Validation loss decreased (-0.247101 --> -0.258492).  Saving model ...
Epoch: 4 cost time: 12.167385816574097
Epoch: 4, Steps: 17 | Train Loss: 3.029 Vali Loss: 5.980 Vali Acc: 0.255 Test Loss: 5.980 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.651885271072388
Epoch: 5, Steps: 17 | Train Loss: 2.426 Vali Loss: 5.169 Vali Acc: 0.232 Test Loss: 5.169 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.758405923843384
Epoch: 6, Steps: 17 | Train Loss: 2.533 Vali Loss: 11.012 Vali Acc: 0.247 Test Loss: 11.012 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.60693097114563
Epoch: 7, Steps: 17 | Train Loss: 3.027 Vali Loss: 7.038 Vali Acc: 0.255 Test Loss: 7.038 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.384254932403564
Epoch: 8, Steps: 17 | Train Loss: 1.913 Vali Loss: 10.435 Vali Acc: 0.255 Test Loss: 10.435 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.643625259399414
Epoch: 9, Steps: 17 | Train Loss: 2.419 Vali Loss: 8.208 Vali Acc: 0.209 Test Loss: 8.208 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.910877704620361
Epoch: 10, Steps: 17 | Train Loss: 1.441 Vali Loss: 12.588 Vali Acc: 0.243 Test Loss: 12.588 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.708862543106079
Epoch: 11, Steps: 17 | Train Loss: 1.703 Vali Loss: 9.135 Vali Acc: 0.251 Test Loss: 9.135 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.64138388633728
Epoch: 12, Steps: 17 | Train Loss: 1.989 Vali Loss: 15.309 Vali Acc: 0.266 Test Loss: 15.309 Test Acc: 0.266
Validation loss decreased (-0.258492 --> -0.266007).  Saving model ...
Epoch: 13 cost time: 12.581326484680176
Epoch: 13, Steps: 17 | Train Loss: 2.078 Vali Loss: 16.716 Vali Acc: 0.240 Test Loss: 16.716 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.782615900039673
Epoch: 14, Steps: 17 | Train Loss: 2.052 Vali Loss: 10.821 Vali Acc: 0.236 Test Loss: 10.821 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.222389698028564
Epoch: 15, Steps: 17 | Train Loss: 1.462 Vali Loss: 14.455 Vali Acc: 0.266 Test Loss: 14.455 Test Acc: 0.266
Validation loss decreased (-0.266007 --> -0.266015).  Saving model ...
Epoch: 16 cost time: 13.405625343322754
Epoch: 16, Steps: 17 | Train Loss: 2.062 Vali Loss: 17.746 Vali Acc: 0.240 Test Loss: 17.746 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.40376591682434
Epoch: 17, Steps: 17 | Train Loss: 2.386 Vali Loss: 19.440 Vali Acc: 0.278 Test Loss: 19.440 Test Acc: 0.278
Validation loss decreased (-0.266015 --> -0.277372).  Saving model ...
Epoch: 18 cost time: 11.781010866165161
Epoch: 18, Steps: 17 | Train Loss: 3.481 Vali Loss: 19.147 Vali Acc: 0.266 Test Loss: 19.147 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.541585206985474
Epoch: 19, Steps: 17 | Train Loss: 0.956 Vali Loss: 14.112 Vali Acc: 0.255 Test Loss: 14.112 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.02802586555481
Epoch: 20, Steps: 17 | Train Loss: 1.133 Vali Loss: 16.609 Vali Acc: 0.247 Test Loss: 16.609 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.89780569076538
Epoch: 21, Steps: 17 | Train Loss: 0.840 Vali Loss: 23.234 Vali Acc: 0.247 Test Loss: 23.234 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 13.96692967414856
Epoch: 22, Steps: 17 | Train Loss: 1.314 Vali Loss: 19.540 Vali Acc: 0.213 Test Loss: 19.540 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.96508240699768
Epoch: 23, Steps: 17 | Train Loss: 0.898 Vali Loss: 21.794 Vali Acc: 0.247 Test Loss: 21.794 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.481330871582031
Epoch: 24, Steps: 17 | Train Loss: 1.522 Vali Loss: 20.366 Vali Acc: 0.232 Test Loss: 20.366 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.509818315505981
Epoch: 25, Steps: 17 | Train Loss: 1.325 Vali Loss: 22.485 Vali Acc: 0.228 Test Loss: 22.485 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.850459098815918
Epoch: 26, Steps: 17 | Train Loss: 0.953 Vali Loss: 23.164 Vali Acc: 0.247 Test Loss: 23.164 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 12.005650281906128
Epoch: 27, Steps: 17 | Train Loss: 1.817 Vali Loss: 28.242 Vali Acc: 0.247 Test Loss: 28.242 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.611759901046753
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 4.746 Vali Acc: 0.247 Test Loss: 4.746 Test Acc: 0.247
Validation loss decreased (inf --> -0.247101).  Saving model ...
Epoch: 2 cost time: 10.965357303619385
Epoch: 2, Steps: 17 | Train Loss: 2.499 Vali Loss: 3.801 Vali Acc: 0.278 Test Loss: 3.801 Test Acc: 0.278
Validation loss decreased (-0.247101 --> -0.277529).  Saving model ...
Epoch: 3 cost time: 11.60048246383667
Epoch: 3, Steps: 17 | Train Loss: 2.090 Vali Loss: 6.138 Vali Acc: 0.251 Test Loss: 6.138 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.971669912338257
Epoch: 4, Steps: 17 | Train Loss: 2.408 Vali Loss: 7.257 Vali Acc: 0.247 Test Loss: 7.257 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.270650863647461
Epoch: 5, Steps: 17 | Train Loss: 1.694 Vali Loss: 7.656 Vali Acc: 0.270 Test Loss: 7.656 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.134488344192505
Epoch: 6, Steps: 17 | Train Loss: 1.812 Vali Loss: 6.850 Vali Acc: 0.270 Test Loss: 6.850 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.370877981185913
Epoch: 7, Steps: 17 | Train Loss: 2.246 Vali Loss: 11.400 Vali Acc: 0.251 Test Loss: 11.400 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.852582454681396
Epoch: 8, Steps: 17 | Train Loss: 2.866 Vali Loss: 9.025 Vali Acc: 0.289 Test Loss: 9.025 Test Acc: 0.289
Validation loss decreased (-0.277529 --> -0.288883).  Saving model ...
Epoch: 9 cost time: 10.787612676620483
Epoch: 9, Steps: 17 | Train Loss: 1.805 Vali Loss: 10.693 Vali Acc: 0.285 Test Loss: 10.693 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.029346704483032
Epoch: 10, Steps: 17 | Train Loss: 1.489 Vali Loss: 12.861 Vali Acc: 0.251 Test Loss: 12.861 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.010706186294556
Epoch: 11, Steps: 17 | Train Loss: 1.274 Vali Loss: 10.399 Vali Acc: 0.266 Test Loss: 10.399 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.32804799079895
Epoch: 12, Steps: 17 | Train Loss: 1.319 Vali Loss: 13.337 Vali Acc: 0.243 Test Loss: 13.337 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.311236143112183
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 14.689 Vali Acc: 0.243 Test Loss: 14.689 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.913969993591309
Epoch: 14, Steps: 17 | Train Loss: 1.020 Vali Loss: 15.314 Vali Acc: 0.221 Test Loss: 15.314 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.580289363861084
Epoch: 15, Steps: 17 | Train Loss: 1.251 Vali Loss: 15.317 Vali Acc: 0.262 Test Loss: 15.317 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.784505367279053
Epoch: 16, Steps: 17 | Train Loss: 2.651 Vali Loss: 21.079 Vali Acc: 0.240 Test Loss: 21.079 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.831440448760986
Epoch: 17, Steps: 17 | Train Loss: 2.636 Vali Loss: 22.204 Vali Acc: 0.266 Test Loss: 22.204 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.650226354598999
Epoch: 18, Steps: 17 | Train Loss: 1.288 Vali Loss: 19.311 Vali Acc: 0.251 Test Loss: 19.311 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.487069845199585
Epoch: 1, Steps: 17 | Train Loss: 1.678 Vali Loss: 4.793 Vali Acc: 0.255 Test Loss: 4.793 Test Acc: 0.255
Validation loss decreased (inf --> -0.254705).  Saving model ...
Epoch: 2 cost time: 8.857529878616333
Epoch: 2, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.936 Vali Acc: 0.274 Test Loss: 2.936 Test Acc: 0.274
Validation loss decreased (-0.254705 --> -0.273735).  Saving model ...
Epoch: 3 cost time: 8.78213095664978
Epoch: 3, Steps: 17 | Train Loss: 1.772 Vali Loss: 3.237 Vali Acc: 0.259 Test Loss: 3.237 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.655146837234497
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 3.963 Vali Acc: 0.236 Test Loss: 3.963 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.867963075637817
Epoch: 5, Steps: 17 | Train Loss: 2.310 Vali Loss: 7.784 Vali Acc: 0.274 Test Loss: 7.784 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.545738935470581
Epoch: 6, Steps: 17 | Train Loss: 2.261 Vali Loss: 10.409 Vali Acc: 0.262 Test Loss: 10.409 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.368923664093018
Epoch: 7, Steps: 17 | Train Loss: 2.776 Vali Loss: 9.395 Vali Acc: 0.262 Test Loss: 9.395 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.446019411087036
Epoch: 8, Steps: 17 | Train Loss: 2.140 Vali Loss: 9.723 Vali Acc: 0.289 Test Loss: 9.723 Test Acc: 0.289
Validation loss decreased (-0.273735 --> -0.288876).  Saving model ...
Epoch: 9 cost time: 8.00921893119812
Epoch: 9, Steps: 17 | Train Loss: 1.783 Vali Loss: 18.316 Vali Acc: 0.259 Test Loss: 18.316 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.8027098178863525
Epoch: 10, Steps: 17 | Train Loss: 1.453 Vali Loss: 10.231 Vali Acc: 0.255 Test Loss: 10.231 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.350464582443237
Epoch: 11, Steps: 17 | Train Loss: 1.362 Vali Loss: 11.888 Vali Acc: 0.255 Test Loss: 11.888 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.869152784347534
Epoch: 12, Steps: 17 | Train Loss: 1.508 Vali Loss: 14.124 Vali Acc: 0.278 Test Loss: 14.124 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.190975189208984
Epoch: 13, Steps: 17 | Train Loss: 0.825 Vali Loss: 12.251 Vali Acc: 0.289 Test Loss: 12.251 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.650120735168457
Epoch: 14, Steps: 17 | Train Loss: 1.047 Vali Loss: 14.949 Vali Acc: 0.281 Test Loss: 14.949 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.13687539100647
Epoch: 15, Steps: 17 | Train Loss: 0.794 Vali Loss: 22.214 Vali Acc: 0.274 Test Loss: 22.214 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.45862865447998
Epoch: 16, Steps: 17 | Train Loss: 0.826 Vali Loss: 16.756 Vali Acc: 0.274 Test Loss: 16.756 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.309205055236816
Epoch: 17, Steps: 17 | Train Loss: 0.956 Vali Loss: 18.914 Vali Acc: 0.266 Test Loss: 18.914 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.276017189025879
Epoch: 18, Steps: 17 | Train Loss: 0.647 Vali Loss: 19.636 Vali Acc: 0.300 Test Loss: 19.636 Test Acc: 0.300
Validation loss decreased (-0.288876 --> -0.300184).  Saving model ...
Epoch: 19 cost time: 7.590883493423462
Epoch: 19, Steps: 17 | Train Loss: 0.978 Vali Loss: 21.345 Vali Acc: 0.285 Test Loss: 21.345 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.355911016464233
Epoch: 20, Steps: 17 | Train Loss: 0.587 Vali Loss: 29.935 Vali Acc: 0.278 Test Loss: 29.935 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.821717739105225
Epoch: 21, Steps: 17 | Train Loss: 0.971 Vali Loss: 18.471 Vali Acc: 0.236 Test Loss: 18.471 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.72407341003418
Epoch: 22, Steps: 17 | Train Loss: 0.866 Vali Loss: 23.691 Vali Acc: 0.259 Test Loss: 23.691 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.485736608505249
Epoch: 23, Steps: 17 | Train Loss: 1.228 Vali Loss: 33.923 Vali Acc: 0.266 Test Loss: 33.923 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.597714424133301
Epoch: 24, Steps: 17 | Train Loss: 2.026 Vali Loss: 23.265 Vali Acc: 0.259 Test Loss: 23.265 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.298763036727905
Epoch: 25, Steps: 17 | Train Loss: 2.092 Vali Loss: 24.621 Vali Acc: 0.278 Test Loss: 24.621 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.310606479644775
Epoch: 26, Steps: 17 | Train Loss: 2.209 Vali Loss: 29.540 Vali Acc: 0.255 Test Loss: 29.540 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.393310546875
Epoch: 27, Steps: 17 | Train Loss: 1.415 Vali Loss: 31.996 Vali Acc: 0.274 Test Loss: 31.996 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.527410507202148
Epoch: 28, Steps: 17 | Train Loss: 0.805 Vali Loss: 30.495 Vali Acc: 0.285 Test Loss: 30.495 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.456691980361938
Epoch: 1, Steps: 17 | Train Loss: 1.692 Vali Loss: 4.760 Vali Acc: 0.251 Test Loss: 4.760 Test Acc: 0.251
Validation loss decreased (inf --> -0.250903).  Saving model ...
Epoch: 2 cost time: 7.924889087677002
Epoch: 2, Steps: 17 | Train Loss: 1.982 Vali Loss: 2.446 Vali Acc: 0.251 Test Loss: 2.446 Test Acc: 0.251
Validation loss decreased (-0.250903 --> -0.250926).  Saving model ...
Epoch: 3 cost time: 7.858819961547852
Epoch: 3, Steps: 17 | Train Loss: 1.531 Vali Loss: 3.776 Vali Acc: 0.255 Test Loss: 3.776 Test Acc: 0.255
Validation loss decreased (-0.250926 --> -0.254715).  Saving model ...
Epoch: 4 cost time: 7.880129814147949
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 4.262 Vali Acc: 0.270 Test Loss: 4.262 Test Acc: 0.270
Validation loss decreased (-0.254715 --> -0.269919).  Saving model ...
Epoch: 5 cost time: 7.9851438999176025
Epoch: 5, Steps: 17 | Train Loss: 2.294 Vali Loss: 7.318 Vali Acc: 0.262 Test Loss: 7.318 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.667719841003418
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 7.507 Vali Acc: 0.262 Test Loss: 7.507 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.534749269485474
Epoch: 7, Steps: 17 | Train Loss: 1.248 Vali Loss: 7.948 Vali Acc: 0.247 Test Loss: 7.948 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.61828351020813
Epoch: 8, Steps: 17 | Train Loss: 1.641 Vali Loss: 12.222 Vali Acc: 0.251 Test Loss: 12.222 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.345697641372681
Epoch: 9, Steps: 17 | Train Loss: 1.920 Vali Loss: 7.167 Vali Acc: 0.247 Test Loss: 7.167 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.278420686721802
Epoch: 10, Steps: 17 | Train Loss: 1.998 Vali Loss: 15.351 Vali Acc: 0.243 Test Loss: 15.351 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.095448970794678
Epoch: 11, Steps: 17 | Train Loss: 1.496 Vali Loss: 12.665 Vali Acc: 0.262 Test Loss: 12.665 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.59100866317749
Epoch: 12, Steps: 17 | Train Loss: 1.581 Vali Loss: 14.278 Vali Acc: 0.289 Test Loss: 14.278 Test Acc: 0.289
Validation loss decreased (-0.269919 --> -0.288831).  Saving model ...
Epoch: 13 cost time: 7.3202385902404785
Epoch: 13, Steps: 17 | Train Loss: 0.889 Vali Loss: 18.294 Vali Acc: 0.259 Test Loss: 18.294 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.684352874755859
Epoch: 14, Steps: 17 | Train Loss: 0.959 Vali Loss: 13.703 Vali Acc: 0.221 Test Loss: 13.703 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.910185813903809
Epoch: 15, Steps: 17 | Train Loss: 1.442 Vali Loss: 17.525 Vali Acc: 0.232 Test Loss: 17.525 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.5209572315216064
Epoch: 16, Steps: 17 | Train Loss: 1.926 Vali Loss: 18.543 Vali Acc: 0.224 Test Loss: 18.543 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.502778768539429
Epoch: 17, Steps: 17 | Train Loss: 1.482 Vali Loss: 22.886 Vali Acc: 0.255 Test Loss: 22.886 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.732660293579102
Epoch: 18, Steps: 17 | Train Loss: 1.096 Vali Loss: 23.159 Vali Acc: 0.228 Test Loss: 23.159 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.684218883514404
Epoch: 19, Steps: 17 | Train Loss: 0.597 Vali Loss: 20.327 Vali Acc: 0.224 Test Loss: 20.327 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.362918138504028
Epoch: 20, Steps: 17 | Train Loss: 0.783 Vali Loss: 35.685 Vali Acc: 0.251 Test Loss: 35.685 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.897098779678345
Epoch: 21, Steps: 17 | Train Loss: 1.395 Vali Loss: 21.583 Vali Acc: 0.243 Test Loss: 21.583 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.110405445098877
Epoch: 22, Steps: 17 | Train Loss: 1.468 Vali Loss: 29.403 Vali Acc: 0.240 Test Loss: 29.403 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.469829320907593
Epoch: 1, Steps: 17 | Train Loss: 1.592 Vali Loss: 4.592 Vali Acc: 0.255 Test Loss: 4.592 Test Acc: 0.255
Validation loss decreased (inf --> -0.254707).  Saving model ...
Epoch: 2 cost time: 6.973224401473999
Epoch: 2, Steps: 17 | Train Loss: 1.927 Vali Loss: 3.319 Vali Acc: 0.259 Test Loss: 3.319 Test Acc: 0.259
Validation loss decreased (-0.254707 --> -0.258522).  Saving model ...
Epoch: 3 cost time: 7.394275665283203
Epoch: 3, Steps: 17 | Train Loss: 1.644 Vali Loss: 7.067 Vali Acc: 0.243 Test Loss: 7.067 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.496224403381348
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 3.847 Vali Acc: 0.262 Test Loss: 3.847 Test Acc: 0.262
Validation loss decreased (-0.258522 --> -0.262319).  Saving model ...
Epoch: 5 cost time: 7.626516580581665
Epoch: 5, Steps: 17 | Train Loss: 1.488 Vali Loss: 6.178 Vali Acc: 0.270 Test Loss: 6.178 Test Acc: 0.270
Validation loss decreased (-0.262319 --> -0.269900).  Saving model ...
Epoch: 6 cost time: 7.044553518295288
Epoch: 6, Steps: 17 | Train Loss: 2.040 Vali Loss: 17.360 Vali Acc: 0.259 Test Loss: 17.360 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.2363221645355225
Epoch: 7, Steps: 17 | Train Loss: 3.107 Vali Loss: 11.194 Vali Acc: 0.274 Test Loss: 11.194 Test Acc: 0.274
Validation loss decreased (-0.269900 --> -0.273652).  Saving model ...
Epoch: 8 cost time: 7.495119094848633
Epoch: 8, Steps: 17 | Train Loss: 1.906 Vali Loss: 13.261 Vali Acc: 0.281 Test Loss: 13.261 Test Acc: 0.281
Validation loss decreased (-0.273652 --> -0.281236).  Saving model ...
Epoch: 9 cost time: 6.939428091049194
Epoch: 9, Steps: 17 | Train Loss: 2.252 Vali Loss: 12.248 Vali Acc: 0.266 Test Loss: 12.248 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.38782525062561
Epoch: 10, Steps: 17 | Train Loss: 2.603 Vali Loss: 11.546 Vali Acc: 0.255 Test Loss: 11.546 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.6247477531433105
Epoch: 11, Steps: 17 | Train Loss: 2.353 Vali Loss: 12.786 Vali Acc: 0.255 Test Loss: 12.786 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.999815940856934
Epoch: 12, Steps: 17 | Train Loss: 1.703 Vali Loss: 14.644 Vali Acc: 0.255 Test Loss: 14.644 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.602509260177612
Epoch: 13, Steps: 17 | Train Loss: 1.020 Vali Loss: 12.612 Vali Acc: 0.240 Test Loss: 12.612 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.263143062591553
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 9.912 Vali Acc: 0.240 Test Loss: 9.912 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.509008884429932
Epoch: 15, Steps: 17 | Train Loss: 1.419 Vali Loss: 14.396 Vali Acc: 0.243 Test Loss: 14.396 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.959912300109863
Epoch: 16, Steps: 17 | Train Loss: 1.390 Vali Loss: 14.789 Vali Acc: 0.266 Test Loss: 14.789 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.507266998291016
Epoch: 17, Steps: 17 | Train Loss: 2.174 Vali Loss: 25.272 Vali Acc: 0.247 Test Loss: 25.272 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.245033502578735
Epoch: 18, Steps: 17 | Train Loss: 1.401 Vali Loss: 18.304 Vali Acc: 0.240 Test Loss: 18.304 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.219454526901245
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 4.772 Vali Acc: 0.255 Test Loss: 4.772 Test Acc: 0.255
Validation loss decreased (inf --> -0.254705).  Saving model ...
Epoch: 2 cost time: 7.151067733764648
Epoch: 2, Steps: 17 | Train Loss: 1.925 Vali Loss: 3.627 Vali Acc: 0.270 Test Loss: 3.627 Test Acc: 0.270
Validation loss decreased (-0.254705 --> -0.269926).  Saving model ...
Epoch: 3 cost time: 6.939646005630493
Epoch: 3, Steps: 17 | Train Loss: 1.630 Vali Loss: 8.587 Vali Acc: 0.255 Test Loss: 8.587 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.718360662460327
Epoch: 4, Steps: 17 | Train Loss: 1.861 Vali Loss: 7.562 Vali Acc: 0.255 Test Loss: 7.562 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.740673542022705
Epoch: 5, Steps: 17 | Train Loss: 2.053 Vali Loss: 8.104 Vali Acc: 0.266 Test Loss: 8.104 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.861147165298462
Epoch: 6, Steps: 17 | Train Loss: 1.957 Vali Loss: 12.389 Vali Acc: 0.259 Test Loss: 12.389 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.101735830307007
Epoch: 7, Steps: 17 | Train Loss: 2.389 Vali Loss: 14.200 Vali Acc: 0.251 Test Loss: 14.200 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.095395088195801
Epoch: 8, Steps: 17 | Train Loss: 2.736 Vali Loss: 8.159 Vali Acc: 0.274 Test Loss: 8.159 Test Acc: 0.274
Validation loss decreased (-0.269926 --> -0.273683).  Saving model ...
Epoch: 9 cost time: 6.9782350063323975
Epoch: 9, Steps: 17 | Train Loss: 1.510 Vali Loss: 8.756 Vali Acc: 0.221 Test Loss: 8.756 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.261721611022949
Epoch: 10, Steps: 17 | Train Loss: 1.100 Vali Loss: 7.205 Vali Acc: 0.266 Test Loss: 7.205 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.472469329833984
Epoch: 11, Steps: 17 | Train Loss: 1.429 Vali Loss: 12.006 Vali Acc: 0.221 Test Loss: 12.006 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.065005302429199
Epoch: 12, Steps: 17 | Train Loss: 0.952 Vali Loss: 10.720 Vali Acc: 0.240 Test Loss: 10.720 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.8823628425598145
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 11.483 Vali Acc: 0.240 Test Loss: 11.483 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.224740743637085
Epoch: 14, Steps: 17 | Train Loss: 2.246 Vali Loss: 19.608 Vali Acc: 0.247 Test Loss: 19.608 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.5600926876068115
Epoch: 15, Steps: 17 | Train Loss: 1.860 Vali Loss: 15.599 Vali Acc: 0.243 Test Loss: 15.599 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.787909269332886
Epoch: 16, Steps: 17 | Train Loss: 2.019 Vali Loss: 20.061 Vali Acc: 0.262 Test Loss: 20.061 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.9820826053619385
Epoch: 17, Steps: 17 | Train Loss: 1.228 Vali Loss: 19.671 Vali Acc: 0.247 Test Loss: 19.671 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.061468839645386
Epoch: 18, Steps: 17 | Train Loss: 0.940 Vali Loss: 19.169 Vali Acc: 0.209 Test Loss: 19.169 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.320340871810913
Epoch: 1, Steps: 17 | Train Loss: 1.565 Vali Loss: 4.199 Vali Acc: 0.251 Test Loss: 4.199 Test Acc: 0.251
Validation loss decreased (inf --> -0.250909).  Saving model ...
Epoch: 2 cost time: 7.10078501701355
Epoch: 2, Steps: 17 | Train Loss: 1.871 Vali Loss: 3.524 Vali Acc: 0.247 Test Loss: 3.524 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.226200819015503
Epoch: 3, Steps: 17 | Train Loss: 1.509 Vali Loss: 5.654 Vali Acc: 0.255 Test Loss: 5.654 Test Acc: 0.255
Validation loss decreased (-0.250909 --> -0.254696).  Saving model ...
Epoch: 4 cost time: 7.188039541244507
Epoch: 4, Steps: 17 | Train Loss: 1.850 Vali Loss: 5.131 Vali Acc: 0.247 Test Loss: 5.131 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.08196759223938
Epoch: 5, Steps: 17 | Train Loss: 2.036 Vali Loss: 5.868 Vali Acc: 0.262 Test Loss: 5.868 Test Acc: 0.262
Validation loss decreased (-0.254696 --> -0.262299).  Saving model ...
Epoch: 6 cost time: 7.080907344818115
Epoch: 6, Steps: 17 | Train Loss: 1.948 Vali Loss: 8.802 Vali Acc: 0.278 Test Loss: 8.802 Test Acc: 0.278
Validation loss decreased (-0.262299 --> -0.277479).  Saving model ...
Epoch: 7 cost time: 7.06541895866394
Epoch: 7, Steps: 17 | Train Loss: 2.837 Vali Loss: 7.296 Vali Acc: 0.274 Test Loss: 7.296 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.251440048217773
Epoch: 8, Steps: 17 | Train Loss: 2.469 Vali Loss: 11.929 Vali Acc: 0.232 Test Loss: 11.929 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.7702624797821045
Epoch: 9, Steps: 17 | Train Loss: 1.709 Vali Loss: 10.661 Vali Acc: 0.247 Test Loss: 10.661 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.853877067565918
Epoch: 10, Steps: 17 | Train Loss: 1.537 Vali Loss: 9.036 Vali Acc: 0.266 Test Loss: 9.036 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.0831499099731445
Epoch: 11, Steps: 17 | Train Loss: 1.597 Vali Loss: 9.196 Vali Acc: 0.278 Test Loss: 9.196 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.896333932876587
Epoch: 12, Steps: 17 | Train Loss: 1.263 Vali Loss: 10.985 Vali Acc: 0.266 Test Loss: 10.985 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.7927916049957275
Epoch: 13, Steps: 17 | Train Loss: 1.566 Vali Loss: 14.632 Vali Acc: 0.217 Test Loss: 14.632 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.802433967590332
Epoch: 14, Steps: 17 | Train Loss: 1.972 Vali Loss: 17.338 Vali Acc: 0.240 Test Loss: 17.338 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.164430856704712
Epoch: 15, Steps: 17 | Train Loss: 1.528 Vali Loss: 17.162 Vali Acc: 0.259 Test Loss: 17.162 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.131513595581055
Epoch: 16, Steps: 17 | Train Loss: 2.113 Vali Loss: 19.983 Vali Acc: 0.270 Test Loss: 19.983 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.258320569992065
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 4.173 Vali Acc: 0.251 Test Loss: 4.173 Test Acc: 0.251
Validation loss decreased (inf --> -0.250909).  Saving model ...
Epoch: 2 cost time: 6.636174201965332
Epoch: 2, Steps: 17 | Train Loss: 2.053 Vali Loss: 4.846 Vali Acc: 0.251 Test Loss: 4.846 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.1035284996032715
Epoch: 3, Steps: 17 | Train Loss: 1.860 Vali Loss: 8.355 Vali Acc: 0.251 Test Loss: 8.355 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.048475503921509
Epoch: 4, Steps: 17 | Train Loss: 1.749 Vali Loss: 8.127 Vali Acc: 0.247 Test Loss: 8.127 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.412942171096802
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 4.671 Vali Acc: 0.236 Test Loss: 4.671 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.131734848022461
Epoch: 6, Steps: 17 | Train Loss: 1.805 Vali Loss: 9.306 Vali Acc: 0.270 Test Loss: 9.306 Test Acc: 0.270
Validation loss decreased (-0.250909 --> -0.269869).  Saving model ...
Epoch: 7 cost time: 7.014099597930908
Epoch: 7, Steps: 17 | Train Loss: 1.560 Vali Loss: 12.552 Vali Acc: 0.228 Test Loss: 12.552 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.994928359985352
Epoch: 8, Steps: 17 | Train Loss: 2.430 Vali Loss: 12.093 Vali Acc: 0.262 Test Loss: 12.093 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.710339307785034
Epoch: 9, Steps: 17 | Train Loss: 2.550 Vali Loss: 11.996 Vali Acc: 0.262 Test Loss: 11.996 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.2645649909973145
Epoch: 10, Steps: 17 | Train Loss: 1.460 Vali Loss: 15.278 Vali Acc: 0.251 Test Loss: 15.278 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.487282991409302
Epoch: 11, Steps: 17 | Train Loss: 1.959 Vali Loss: 9.987 Vali Acc: 0.270 Test Loss: 9.987 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.201856374740601
Epoch: 12, Steps: 17 | Train Loss: 1.475 Vali Loss: 17.248 Vali Acc: 0.243 Test Loss: 17.248 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.995379447937012
Epoch: 13, Steps: 17 | Train Loss: 1.583 Vali Loss: 16.259 Vali Acc: 0.240 Test Loss: 16.259 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.841172695159912
Epoch: 14, Steps: 17 | Train Loss: 1.852 Vali Loss: 15.747 Vali Acc: 0.217 Test Loss: 15.747 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.061935186386108
Epoch: 15, Steps: 17 | Train Loss: 2.145 Vali Loss: 14.380 Vali Acc: 0.278 Test Loss: 14.380 Test Acc: 0.278
Validation loss decreased (-0.269869 --> -0.277423).  Saving model ...
Epoch: 16 cost time: 7.121748447418213
Epoch: 16, Steps: 17 | Train Loss: 1.471 Vali Loss: 17.408 Vali Acc: 0.251 Test Loss: 17.408 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.97619104385376
Epoch: 17, Steps: 17 | Train Loss: 1.735 Vali Loss: 20.627 Vali Acc: 0.228 Test Loss: 20.627 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.893284559249878
Epoch: 18, Steps: 17 | Train Loss: 1.539 Vali Loss: 20.429 Vali Acc: 0.281 Test Loss: 20.429 Test Acc: 0.281
Validation loss decreased (-0.277423 --> -0.281165).  Saving model ...
Epoch: 19 cost time: 6.98493504524231
Epoch: 19, Steps: 17 | Train Loss: 1.928 Vali Loss: 23.155 Vali Acc: 0.251 Test Loss: 23.155 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.613443613052368
Epoch: 20, Steps: 17 | Train Loss: 2.222 Vali Loss: 25.688 Vali Acc: 0.266 Test Loss: 25.688 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.663373231887817
Epoch: 21, Steps: 17 | Train Loss: 1.751 Vali Loss: 29.878 Vali Acc: 0.278 Test Loss: 29.878 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.462690830230713
Epoch: 22, Steps: 17 | Train Loss: 1.854 Vali Loss: 28.102 Vali Acc: 0.262 Test Loss: 28.102 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.678450107574463
Epoch: 23, Steps: 17 | Train Loss: 2.145 Vali Loss: 31.065 Vali Acc: 0.243 Test Loss: 31.065 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.884389638900757
Epoch: 24, Steps: 17 | Train Loss: 2.354 Vali Loss: 24.172 Vali Acc: 0.236 Test Loss: 24.172 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.740087032318115
Epoch: 25, Steps: 17 | Train Loss: 1.827 Vali Loss: 35.877 Vali Acc: 0.262 Test Loss: 35.877 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.73753809928894
Epoch: 26, Steps: 17 | Train Loss: 1.729 Vali Loss: 37.370 Vali Acc: 0.243 Test Loss: 37.370 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.042257785797119
Epoch: 27, Steps: 17 | Train Loss: 1.564 Vali Loss: 38.387 Vali Acc: 0.247 Test Loss: 38.387 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.790893316268921
Epoch: 28, Steps: 17 | Train Loss: 1.910 Vali Loss: 40.498 Vali Acc: 0.236 Test Loss: 40.498 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4625924
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.908236980438232
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.676 Vali Acc: 0.281 Test Loss: 1.676 Test Acc: 0.281
Validation loss decreased (inf --> -0.281352).  Saving model ...
Epoch: 2 cost time: 12.253918170928955
Epoch: 2, Steps: 17 | Train Loss: 1.856 Vali Loss: 2.445 Vali Acc: 0.255 Test Loss: 2.445 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.481785774230957
Epoch: 3, Steps: 17 | Train Loss: 1.728 Vali Loss: 2.734 Vali Acc: 0.247 Test Loss: 2.734 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.003831624984741
Epoch: 4, Steps: 17 | Train Loss: 1.472 Vali Loss: 3.850 Vali Acc: 0.255 Test Loss: 3.850 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.424015998840332
Epoch: 5, Steps: 17 | Train Loss: 1.744 Vali Loss: 2.769 Vali Acc: 0.270 Test Loss: 2.769 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.100163221359253
Epoch: 6, Steps: 17 | Train Loss: 1.375 Vali Loss: 4.104 Vali Acc: 0.209 Test Loss: 4.104 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.478769540786743
Epoch: 7, Steps: 17 | Train Loss: 1.659 Vali Loss: 6.769 Vali Acc: 0.232 Test Loss: 6.769 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.604356527328491
Epoch: 8, Steps: 17 | Train Loss: 2.220 Vali Loss: 4.484 Vali Acc: 0.251 Test Loss: 4.484 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.014196395874023
Epoch: 9, Steps: 17 | Train Loss: 1.359 Vali Loss: 3.414 Vali Acc: 0.243 Test Loss: 3.414 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.893513441085815
Epoch: 10, Steps: 17 | Train Loss: 1.400 Vali Loss: 4.325 Vali Acc: 0.285 Test Loss: 4.325 Test Acc: 0.285
Validation loss decreased (-0.281352 --> -0.285128).  Saving model ...
Epoch: 11 cost time: 10.849776983261108
Epoch: 11, Steps: 17 | Train Loss: 1.904 Vali Loss: 4.867 Vali Acc: 0.259 Test Loss: 4.867 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.210998773574829
Epoch: 12, Steps: 17 | Train Loss: 1.201 Vali Loss: 5.092 Vali Acc: 0.278 Test Loss: 5.092 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.43997836112976
Epoch: 13, Steps: 17 | Train Loss: 1.295 Vali Loss: 5.904 Vali Acc: 0.247 Test Loss: 5.904 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.13552975654602
Epoch: 14, Steps: 17 | Train Loss: 1.287 Vali Loss: 4.680 Vali Acc: 0.266 Test Loss: 4.680 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.176618099212646
Epoch: 15, Steps: 17 | Train Loss: 0.778 Vali Loss: 4.744 Vali Acc: 0.259 Test Loss: 4.744 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.17666506767273
Epoch: 16, Steps: 17 | Train Loss: 0.645 Vali Loss: 5.205 Vali Acc: 0.247 Test Loss: 5.205 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.996282577514648
Epoch: 17, Steps: 17 | Train Loss: 0.541 Vali Loss: 6.868 Vali Acc: 0.221 Test Loss: 6.868 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.848306894302368
Epoch: 18, Steps: 17 | Train Loss: 0.770 Vali Loss: 7.183 Vali Acc: 0.270 Test Loss: 7.183 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.996121406555176
Epoch: 19, Steps: 17 | Train Loss: 1.073 Vali Loss: 7.852 Vali Acc: 0.274 Test Loss: 7.852 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.691763162612915
Epoch: 20, Steps: 17 | Train Loss: 1.111 Vali Loss: 7.141 Vali Acc: 0.232 Test Loss: 7.141 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.310101985931396
Epoch: 1, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.714 Vali Acc: 0.259 Test Loss: 1.714 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 10.48660659790039
Epoch: 2, Steps: 17 | Train Loss: 1.887 Vali Loss: 2.625 Vali Acc: 0.240 Test Loss: 2.625 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.706963777542114
Epoch: 3, Steps: 17 | Train Loss: 1.702 Vali Loss: 2.058 Vali Acc: 0.228 Test Loss: 2.058 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.718994379043579
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 2.841 Vali Acc: 0.289 Test Loss: 2.841 Test Acc: 0.289
Validation loss decreased (-0.258538 --> -0.288945).  Saving model ...
Epoch: 5 cost time: 10.2234365940094
Epoch: 5, Steps: 17 | Train Loss: 1.614 Vali Loss: 3.069 Vali Acc: 0.270 Test Loss: 3.069 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.826150178909302
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 3.766 Vali Acc: 0.209 Test Loss: 3.766 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.078040599822998
Epoch: 7, Steps: 17 | Train Loss: 1.905 Vali Loss: 5.289 Vali Acc: 0.202 Test Loss: 5.289 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.7662672996521
Epoch: 8, Steps: 17 | Train Loss: 1.549 Vali Loss: 4.492 Vali Acc: 0.236 Test Loss: 4.492 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.208264350891113
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 3.404 Vali Acc: 0.262 Test Loss: 3.404 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.50962781906128
Epoch: 10, Steps: 17 | Train Loss: 1.110 Vali Loss: 3.532 Vali Acc: 0.278 Test Loss: 3.532 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.7215416431427
Epoch: 11, Steps: 17 | Train Loss: 1.072 Vali Loss: 3.799 Vali Acc: 0.262 Test Loss: 3.799 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.889636516571045
Epoch: 12, Steps: 17 | Train Loss: 0.987 Vali Loss: 5.533 Vali Acc: 0.262 Test Loss: 5.533 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.067583799362183
Epoch: 13, Steps: 17 | Train Loss: 1.080 Vali Loss: 5.212 Vali Acc: 0.232 Test Loss: 5.212 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.478588342666626
Epoch: 14, Steps: 17 | Train Loss: 0.864 Vali Loss: 4.077 Vali Acc: 0.262 Test Loss: 4.077 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.181251525878906
Epoch: 1, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.661 Vali Acc: 0.205 Test Loss: 1.661 Test Acc: 0.205
Validation loss decreased (inf --> -0.205307).  Saving model ...
Epoch: 2 cost time: 9.22060513496399
Epoch: 2, Steps: 17 | Train Loss: 1.750 Vali Loss: 2.532 Vali Acc: 0.270 Test Loss: 2.532 Test Acc: 0.270
Validation loss decreased (-0.205307 --> -0.269937).  Saving model ...
Epoch: 3 cost time: 8.721860647201538
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 3.102 Vali Acc: 0.232 Test Loss: 3.102 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.448652982711792
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 2.972 Vali Acc: 0.232 Test Loss: 2.972 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.77671766281128
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 3.777 Vali Acc: 0.247 Test Loss: 3.777 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.645867347717285
Epoch: 6, Steps: 17 | Train Loss: 1.312 Vali Loss: 5.737 Vali Acc: 0.209 Test Loss: 5.737 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.825196504592896
Epoch: 7, Steps: 17 | Train Loss: 1.454 Vali Loss: 6.197 Vali Acc: 0.232 Test Loss: 6.197 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.152963161468506
Epoch: 8, Steps: 17 | Train Loss: 1.621 Vali Loss: 6.056 Vali Acc: 0.251 Test Loss: 6.056 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.40032410621643
Epoch: 9, Steps: 17 | Train Loss: 1.274 Vali Loss: 5.156 Vali Acc: 0.255 Test Loss: 5.156 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.821504354476929
Epoch: 10, Steps: 17 | Train Loss: 0.859 Vali Loss: 5.338 Vali Acc: 0.209 Test Loss: 5.338 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.034852743148804
Epoch: 11, Steps: 17 | Train Loss: 0.923 Vali Loss: 7.497 Vali Acc: 0.247 Test Loss: 7.497 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.272241592407227
Epoch: 12, Steps: 17 | Train Loss: 0.918 Vali Loss: 5.946 Vali Acc: 0.266 Test Loss: 5.946 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.3871591091156
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.646 Vali Acc: 0.259 Test Loss: 1.646 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 7.663611650466919
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 2.034 Vali Acc: 0.247 Test Loss: 2.034 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.61064600944519
Epoch: 3, Steps: 17 | Train Loss: 1.563 Vali Loss: 3.154 Vali Acc: 0.243 Test Loss: 3.154 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.056080341339111
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 2.805 Vali Acc: 0.251 Test Loss: 2.805 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.18843698501587
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 3.969 Vali Acc: 0.247 Test Loss: 3.969 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.434356927871704
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 5.699 Vali Acc: 0.266 Test Loss: 5.699 Test Acc: 0.266
Validation loss decreased (-0.258539 --> -0.266103).  Saving model ...
Epoch: 7 cost time: 8.429930686950684
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 7.265 Vali Acc: 0.270 Test Loss: 7.265 Test Acc: 0.270
Validation loss decreased (-0.266103 --> -0.269889).  Saving model ...
Epoch: 8 cost time: 8.113020896911621
Epoch: 8, Steps: 17 | Train Loss: 1.396 Vali Loss: 4.247 Vali Acc: 0.274 Test Loss: 4.247 Test Acc: 0.274
Validation loss decreased (-0.269889 --> -0.273722).  Saving model ...
Epoch: 9 cost time: 8.481219053268433
Epoch: 9, Steps: 17 | Train Loss: 0.753 Vali Loss: 4.849 Vali Acc: 0.266 Test Loss: 4.849 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.551818370819092
Epoch: 10, Steps: 17 | Train Loss: 1.077 Vali Loss: 6.775 Vali Acc: 0.259 Test Loss: 6.775 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.4563939571380615
Epoch: 11, Steps: 17 | Train Loss: 1.511 Vali Loss: 5.563 Vali Acc: 0.251 Test Loss: 5.563 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.671602249145508
Epoch: 12, Steps: 17 | Train Loss: 0.824 Vali Loss: 6.011 Vali Acc: 0.232 Test Loss: 6.011 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.039191484451294
Epoch: 13, Steps: 17 | Train Loss: 0.971 Vali Loss: 9.724 Vali Acc: 0.259 Test Loss: 9.724 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.7233381271362305
Epoch: 14, Steps: 17 | Train Loss: 0.634 Vali Loss: 7.115 Vali Acc: 0.281 Test Loss: 7.115 Test Acc: 0.281
Validation loss decreased (-0.273722 --> -0.281298).  Saving model ...
Epoch: 15 cost time: 8.170635223388672
Epoch: 15, Steps: 17 | Train Loss: 0.407 Vali Loss: 8.644 Vali Acc: 0.243 Test Loss: 8.644 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.23235273361206
Epoch: 16, Steps: 17 | Train Loss: 0.571 Vali Loss: 9.979 Vali Acc: 0.270 Test Loss: 9.979 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.714082717895508
Epoch: 17, Steps: 17 | Train Loss: 0.556 Vali Loss: 10.470 Vali Acc: 0.259 Test Loss: 10.470 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.255799531936646
Epoch: 18, Steps: 17 | Train Loss: 0.549 Vali Loss: 10.457 Vali Acc: 0.274 Test Loss: 10.457 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.467689037322998
Epoch: 19, Steps: 17 | Train Loss: 0.677 Vali Loss: 11.356 Vali Acc: 0.255 Test Loss: 11.356 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.71505331993103
Epoch: 20, Steps: 17 | Train Loss: 0.819 Vali Loss: 10.878 Vali Acc: 0.236 Test Loss: 10.878 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.336079835891724
Epoch: 21, Steps: 17 | Train Loss: 1.212 Vali Loss: 11.451 Vali Acc: 0.293 Test Loss: 11.451 Test Acc: 0.293
Validation loss decreased (-0.281298 --> -0.292661).  Saving model ...
Epoch: 22 cost time: 7.787257432937622
Epoch: 22, Steps: 17 | Train Loss: 0.747 Vali Loss: 9.987 Vali Acc: 0.266 Test Loss: 9.987 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.144628763198853
Epoch: 23, Steps: 17 | Train Loss: 0.582 Vali Loss: 13.354 Vali Acc: 0.247 Test Loss: 13.354 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.855844259262085
Epoch: 24, Steps: 17 | Train Loss: 0.907 Vali Loss: 12.517 Vali Acc: 0.243 Test Loss: 12.517 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.05598783493042
Epoch: 25, Steps: 17 | Train Loss: 1.107 Vali Loss: 14.331 Vali Acc: 0.266 Test Loss: 14.331 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.192342758178711
Epoch: 26, Steps: 17 | Train Loss: 0.389 Vali Loss: 12.680 Vali Acc: 0.247 Test Loss: 12.680 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 8.52856183052063
Epoch: 27, Steps: 17 | Train Loss: 0.480 Vali Loss: 14.029 Vali Acc: 0.232 Test Loss: 14.029 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 8.402605056762695
Epoch: 28, Steps: 17 | Train Loss: 0.307 Vali Loss: 14.465 Vali Acc: 0.247 Test Loss: 14.465 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.114612579345703
Epoch: 29, Steps: 17 | Train Loss: 0.193 Vali Loss: 15.938 Vali Acc: 0.247 Test Loss: 15.938 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.1969313621521
Epoch: 30, Steps: 17 | Train Loss: 0.628 Vali Loss: 16.484 Vali Acc: 0.278 Test Loss: 16.484 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 8.374062299728394
Epoch: 31, Steps: 17 | Train Loss: 0.625 Vali Loss: 20.273 Vali Acc: 0.255 Test Loss: 20.273 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.784531593322754
Epoch: 1, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.979 Vali Acc: 0.262 Test Loss: 1.979 Test Acc: 0.262
Validation loss decreased (inf --> -0.262338).  Saving model ...
Epoch: 2 cost time: 6.659838676452637
Epoch: 2, Steps: 17 | Train Loss: 1.634 Vali Loss: 2.034 Vali Acc: 0.221 Test Loss: 2.034 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.801062345504761
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.446 Vali Acc: 0.274 Test Loss: 2.446 Test Acc: 0.274
Validation loss decreased (-0.262338 --> -0.273740).  Saving model ...
Epoch: 4 cost time: 6.8064868450164795
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.817 Vali Acc: 0.274 Test Loss: 2.817 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.9790589809417725
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 3.696 Vali Acc: 0.266 Test Loss: 3.696 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.04655122756958
Epoch: 6, Steps: 17 | Train Loss: 1.182 Vali Loss: 6.388 Vali Acc: 0.278 Test Loss: 6.388 Test Acc: 0.278
Validation loss decreased (-0.273740 --> -0.277503).  Saving model ...
Epoch: 7 cost time: 6.89548659324646
Epoch: 7, Steps: 17 | Train Loss: 1.095 Vali Loss: 8.462 Vali Acc: 0.285 Test Loss: 8.462 Test Acc: 0.285
Validation loss decreased (-0.277503 --> -0.285086).  Saving model ...
Epoch: 8 cost time: 6.6747801303863525
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 6.592 Vali Acc: 0.270 Test Loss: 6.592 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.07613468170166
Epoch: 9, Steps: 17 | Train Loss: 0.755 Vali Loss: 8.247 Vali Acc: 0.270 Test Loss: 8.247 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.202119827270508
Epoch: 10, Steps: 17 | Train Loss: 1.110 Vali Loss: 6.460 Vali Acc: 0.270 Test Loss: 6.460 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.285233497619629
Epoch: 11, Steps: 17 | Train Loss: 1.147 Vali Loss: 10.189 Vali Acc: 0.297 Test Loss: 10.189 Test Acc: 0.297
Validation loss decreased (-0.285086 --> -0.296476).  Saving model ...
Epoch: 12 cost time: 6.923238515853882
Epoch: 12, Steps: 17 | Train Loss: 0.576 Vali Loss: 7.861 Vali Acc: 0.251 Test Loss: 7.861 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.409069061279297
Epoch: 13, Steps: 17 | Train Loss: 0.640 Vali Loss: 8.530 Vali Acc: 0.243 Test Loss: 8.530 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.804661273956299
Epoch: 14, Steps: 17 | Train Loss: 0.730 Vali Loss: 9.135 Vali Acc: 0.259 Test Loss: 9.135 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.779653787612915
Epoch: 15, Steps: 17 | Train Loss: 0.775 Vali Loss: 10.700 Vali Acc: 0.266 Test Loss: 10.700 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.831206560134888
Epoch: 16, Steps: 17 | Train Loss: 0.507 Vali Loss: 11.529 Vali Acc: 0.278 Test Loss: 11.529 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.038341283798218
Epoch: 17, Steps: 17 | Train Loss: 0.759 Vali Loss: 11.369 Vali Acc: 0.297 Test Loss: 11.369 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.354779005050659
Epoch: 18, Steps: 17 | Train Loss: 1.540 Vali Loss: 11.300 Vali Acc: 0.278 Test Loss: 11.300 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.195941925048828
Epoch: 19, Steps: 17 | Train Loss: 0.930 Vali Loss: 12.460 Vali Acc: 0.270 Test Loss: 12.460 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.081166744232178
Epoch: 20, Steps: 17 | Train Loss: 0.537 Vali Loss: 9.763 Vali Acc: 0.274 Test Loss: 9.763 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.2608373165130615
Epoch: 21, Steps: 17 | Train Loss: 0.713 Vali Loss: 15.969 Vali Acc: 0.308 Test Loss: 15.969 Test Acc: 0.308
Validation loss decreased (-0.296476 --> -0.307825).  Saving model ...
Epoch: 22 cost time: 7.335443735122681
Epoch: 22, Steps: 17 | Train Loss: 1.147 Vali Loss: 14.581 Vali Acc: 0.259 Test Loss: 14.581 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.716713905334473
Epoch: 23, Steps: 17 | Train Loss: 0.811 Vali Loss: 16.503 Vali Acc: 0.285 Test Loss: 16.503 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.942204713821411
Epoch: 24, Steps: 17 | Train Loss: 0.536 Vali Loss: 17.448 Vali Acc: 0.247 Test Loss: 17.448 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.121829032897949
Epoch: 25, Steps: 17 | Train Loss: 0.760 Vali Loss: 15.515 Vali Acc: 0.278 Test Loss: 15.515 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.126689195632935
Epoch: 26, Steps: 17 | Train Loss: 0.399 Vali Loss: 14.645 Vali Acc: 0.255 Test Loss: 14.645 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.71062970161438
Epoch: 27, Steps: 17 | Train Loss: 0.355 Vali Loss: 17.675 Vali Acc: 0.247 Test Loss: 17.675 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.335229873657227
Epoch: 28, Steps: 17 | Train Loss: 0.546 Vali Loss: 18.280 Vali Acc: 0.308 Test Loss: 18.280 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.754179954528809
Epoch: 29, Steps: 17 | Train Loss: 0.543 Vali Loss: 18.979 Vali Acc: 0.251 Test Loss: 18.979 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.831719160079956
Epoch: 30, Steps: 17 | Train Loss: 0.765 Vali Loss: 21.721 Vali Acc: 0.247 Test Loss: 21.721 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.758025407791138
Epoch: 31, Steps: 17 | Train Loss: 0.698 Vali Loss: 18.848 Vali Acc: 0.255 Test Loss: 18.848 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.721628904342651
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 2.026 Vali Acc: 0.240 Test Loss: 2.026 Test Acc: 0.240
Validation loss decreased (inf --> -0.239523).  Saving model ...
Epoch: 2 cost time: 6.599302530288696
Epoch: 2, Steps: 17 | Train Loss: 1.557 Vali Loss: 2.013 Vali Acc: 0.251 Test Loss: 2.013 Test Acc: 0.251
Validation loss decreased (-0.239523 --> -0.250930).  Saving model ...
Epoch: 3 cost time: 6.2941670417785645
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.312 Vali Acc: 0.247 Test Loss: 2.312 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.49824857711792
Epoch: 4, Steps: 17 | Train Loss: 1.231 Vali Loss: 3.663 Vali Acc: 0.243 Test Loss: 3.663 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.999523162841797
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 3.701 Vali Acc: 0.285 Test Loss: 3.701 Test Acc: 0.285
Validation loss decreased (-0.250930 --> -0.285134).  Saving model ...
Epoch: 6 cost time: 6.7407896518707275
Epoch: 6, Steps: 17 | Train Loss: 1.079 Vali Loss: 4.789 Vali Acc: 0.243 Test Loss: 4.789 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.844267129898071
Epoch: 7, Steps: 17 | Train Loss: 1.136 Vali Loss: 5.862 Vali Acc: 0.278 Test Loss: 5.862 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.844287395477295
Epoch: 8, Steps: 17 | Train Loss: 1.034 Vali Loss: 5.766 Vali Acc: 0.251 Test Loss: 5.766 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.534163475036621
Epoch: 9, Steps: 17 | Train Loss: 0.661 Vali Loss: 5.378 Vali Acc: 0.228 Test Loss: 5.378 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.853934049606323
Epoch: 10, Steps: 17 | Train Loss: 0.669 Vali Loss: 5.967 Vali Acc: 0.236 Test Loss: 5.967 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.788717746734619
Epoch: 11, Steps: 17 | Train Loss: 0.528 Vali Loss: 7.795 Vali Acc: 0.240 Test Loss: 7.795 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.246761083602905
Epoch: 12, Steps: 17 | Train Loss: 0.609 Vali Loss: 6.772 Vali Acc: 0.247 Test Loss: 6.772 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.917332887649536
Epoch: 13, Steps: 17 | Train Loss: 0.618 Vali Loss: 8.946 Vali Acc: 0.259 Test Loss: 8.946 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.802769660949707
Epoch: 14, Steps: 17 | Train Loss: 0.608 Vali Loss: 8.151 Vali Acc: 0.262 Test Loss: 8.151 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.839435338973999
Epoch: 15, Steps: 17 | Train Loss: 0.681 Vali Loss: 12.436 Vali Acc: 0.266 Test Loss: 12.436 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.140939474105835
Epoch: 1, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.859 Vali Acc: 0.270 Test Loss: 1.859 Test Acc: 0.270
Validation loss decreased (inf --> -0.269943).  Saving model ...
Epoch: 2 cost time: 6.792423725128174
Epoch: 2, Steps: 17 | Train Loss: 1.577 Vali Loss: 2.240 Vali Acc: 0.281 Test Loss: 2.240 Test Acc: 0.281
Validation loss decreased (-0.269943 --> -0.281346).  Saving model ...
Epoch: 3 cost time: 6.675707578659058
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 3.040 Vali Acc: 0.274 Test Loss: 3.040 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.189113140106201
Epoch: 4, Steps: 17 | Train Loss: 1.336 Vali Loss: 2.344 Vali Acc: 0.240 Test Loss: 2.344 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.437675476074219
Epoch: 5, Steps: 17 | Train Loss: 1.139 Vali Loss: 3.474 Vali Acc: 0.274 Test Loss: 3.474 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.907634496688843
Epoch: 6, Steps: 17 | Train Loss: 1.068 Vali Loss: 4.657 Vali Acc: 0.262 Test Loss: 4.657 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.429559707641602
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 7.105 Vali Acc: 0.289 Test Loss: 7.105 Test Acc: 0.289
Validation loss decreased (-0.281346 --> -0.288902).  Saving model ...
Epoch: 8 cost time: 6.347985744476318
Epoch: 8, Steps: 17 | Train Loss: 1.231 Vali Loss: 5.665 Vali Acc: 0.289 Test Loss: 5.665 Test Acc: 0.289
Validation loss decreased (-0.288902 --> -0.288917).  Saving model ...
Epoch: 9 cost time: 6.341453552246094
Epoch: 9, Steps: 17 | Train Loss: 0.692 Vali Loss: 5.112 Vali Acc: 0.255 Test Loss: 5.112 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.572970151901245
Epoch: 10, Steps: 17 | Train Loss: 0.775 Vali Loss: 5.116 Vali Acc: 0.251 Test Loss: 5.116 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.777588605880737
Epoch: 11, Steps: 17 | Train Loss: 0.739 Vali Loss: 7.818 Vali Acc: 0.266 Test Loss: 7.818 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.450646162033081
Epoch: 12, Steps: 17 | Train Loss: 0.647 Vali Loss: 6.314 Vali Acc: 0.285 Test Loss: 6.314 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.1995275020599365
Epoch: 13, Steps: 17 | Train Loss: 0.632 Vali Loss: 8.290 Vali Acc: 0.259 Test Loss: 8.290 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.996897459030151
Epoch: 14, Steps: 17 | Train Loss: 1.551 Vali Loss: 7.906 Vali Acc: 0.259 Test Loss: 7.906 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.628351926803589
Epoch: 15, Steps: 17 | Train Loss: 0.717 Vali Loss: 13.008 Vali Acc: 0.266 Test Loss: 13.008 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.589345932006836
Epoch: 16, Steps: 17 | Train Loss: 0.654 Vali Loss: 10.432 Vali Acc: 0.278 Test Loss: 10.432 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.479202508926392
Epoch: 17, Steps: 17 | Train Loss: 1.022 Vali Loss: 11.710 Vali Acc: 0.297 Test Loss: 11.710 Test Acc: 0.297
Validation loss decreased (-0.288917 --> -0.296461).  Saving model ...
Epoch: 18 cost time: 6.097485780715942
Epoch: 18, Steps: 17 | Train Loss: 0.887 Vali Loss: 13.098 Vali Acc: 0.236 Test Loss: 13.098 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.548547744750977
Epoch: 19, Steps: 17 | Train Loss: 0.592 Vali Loss: 13.836 Vali Acc: 0.262 Test Loss: 13.836 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.362163066864014
Epoch: 20, Steps: 17 | Train Loss: 0.886 Vali Loss: 16.248 Vali Acc: 0.255 Test Loss: 16.248 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.463214874267578
Epoch: 21, Steps: 17 | Train Loss: 0.993 Vali Loss: 15.471 Vali Acc: 0.217 Test Loss: 15.471 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.567376375198364
Epoch: 22, Steps: 17 | Train Loss: 0.906 Vali Loss: 16.409 Vali Acc: 0.255 Test Loss: 16.409 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.554629325866699
Epoch: 23, Steps: 17 | Train Loss: 0.492 Vali Loss: 13.299 Vali Acc: 0.255 Test Loss: 13.299 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.7738447189331055
Epoch: 24, Steps: 17 | Train Loss: 0.650 Vali Loss: 15.021 Vali Acc: 0.224 Test Loss: 15.021 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.777731418609619
Epoch: 25, Steps: 17 | Train Loss: 0.892 Vali Loss: 15.548 Vali Acc: 0.259 Test Loss: 15.548 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.430454254150391
Epoch: 26, Steps: 17 | Train Loss: 1.075 Vali Loss: 17.640 Vali Acc: 0.243 Test Loss: 17.640 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.870664596557617
Epoch: 27, Steps: 17 | Train Loss: 0.919 Vali Loss: 16.251 Vali Acc: 0.251 Test Loss: 16.251 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.486828088760376
Epoch: 1, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.252 Vali Acc: 0.251 Test Loss: 2.252 Test Acc: 0.251
Validation loss decreased (inf --> -0.250928).  Saving model ...
Epoch: 2 cost time: 6.400891542434692
Epoch: 2, Steps: 17 | Train Loss: 1.555 Vali Loss: 2.526 Vali Acc: 0.266 Test Loss: 2.526 Test Acc: 0.266
Validation loss decreased (-0.250928 --> -0.266134).  Saving model ...
Epoch: 3 cost time: 6.177982330322266
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.601 Vali Acc: 0.247 Test Loss: 2.601 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.219501733779907
Epoch: 4, Steps: 17 | Train Loss: 1.276 Vali Loss: 3.148 Vali Acc: 0.255 Test Loss: 3.148 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.405217409133911
Epoch: 5, Steps: 17 | Train Loss: 1.222 Vali Loss: 3.497 Vali Acc: 0.270 Test Loss: 3.497 Test Acc: 0.270
Validation loss decreased (-0.266134 --> -0.269927).  Saving model ...
Epoch: 6 cost time: 6.119979381561279
Epoch: 6, Steps: 17 | Train Loss: 1.273 Vali Loss: 3.914 Vali Acc: 0.266 Test Loss: 3.914 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.852905750274658
Epoch: 7, Steps: 17 | Train Loss: 1.479 Vali Loss: 7.527 Vali Acc: 0.262 Test Loss: 7.527 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.816355228424072
Epoch: 8, Steps: 17 | Train Loss: 1.475 Vali Loss: 4.900 Vali Acc: 0.255 Test Loss: 4.900 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.923488140106201
Epoch: 9, Steps: 17 | Train Loss: 0.963 Vali Loss: 4.430 Vali Acc: 0.262 Test Loss: 4.430 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.985687971115112
Epoch: 10, Steps: 17 | Train Loss: 1.206 Vali Loss: 4.764 Vali Acc: 0.285 Test Loss: 4.764 Test Acc: 0.285
Validation loss decreased (-0.269927 --> -0.285123).  Saving model ...
Epoch: 11 cost time: 6.4288177490234375
Epoch: 11, Steps: 17 | Train Loss: 1.169 Vali Loss: 7.335 Vali Acc: 0.285 Test Loss: 7.335 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.399679183959961
Epoch: 12, Steps: 17 | Train Loss: 0.984 Vali Loss: 7.708 Vali Acc: 0.289 Test Loss: 7.708 Test Acc: 0.289
Validation loss decreased (-0.285123 --> -0.288896).  Saving model ...
Epoch: 13 cost time: 6.528496503829956
Epoch: 13, Steps: 17 | Train Loss: 0.844 Vali Loss: 6.563 Vali Acc: 0.259 Test Loss: 6.563 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.265492916107178
Epoch: 14, Steps: 17 | Train Loss: 1.264 Vali Loss: 10.866 Vali Acc: 0.243 Test Loss: 10.866 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.45077919960022
Epoch: 15, Steps: 17 | Train Loss: 0.811 Vali Loss: 13.672 Vali Acc: 0.274 Test Loss: 13.672 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.219999551773071
Epoch: 16, Steps: 17 | Train Loss: 0.933 Vali Loss: 9.230 Vali Acc: 0.243 Test Loss: 9.230 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.095808744430542
Epoch: 17, Steps: 17 | Train Loss: 1.057 Vali Loss: 10.742 Vali Acc: 0.240 Test Loss: 10.742 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.36246919631958
Epoch: 18, Steps: 17 | Train Loss: 0.700 Vali Loss: 13.726 Vali Acc: 0.236 Test Loss: 13.726 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.3557350635528564
Epoch: 19, Steps: 17 | Train Loss: 0.706 Vali Loss: 14.665 Vali Acc: 0.243 Test Loss: 14.665 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.427731513977051
Epoch: 20, Steps: 17 | Train Loss: 0.978 Vali Loss: 12.493 Vali Acc: 0.228 Test Loss: 12.493 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.042335033416748
Epoch: 21, Steps: 17 | Train Loss: 1.008 Vali Loss: 14.693 Vali Acc: 0.270 Test Loss: 14.693 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.8584489822387695
Epoch: 22, Steps: 17 | Train Loss: 0.887 Vali Loss: 17.313 Vali Acc: 0.259 Test Loss: 17.313 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.706949234008789
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 2.126 Vali Acc: 0.255 Test Loss: 2.126 Test Acc: 0.255
Validation loss decreased (inf --> -0.254732).  Saving model ...
Epoch: 2 cost time: 5.99252462387085
Epoch: 2, Steps: 17 | Train Loss: 1.613 Vali Loss: 3.033 Vali Acc: 0.259 Test Loss: 3.033 Test Acc: 0.259
Validation loss decreased (-0.254732 --> -0.258525).  Saving model ...
Epoch: 3 cost time: 6.274137735366821
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 3.795 Vali Acc: 0.251 Test Loss: 3.795 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.179281949996948
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 3.066 Vali Acc: 0.240 Test Loss: 3.066 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.146690845489502
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 3.459 Vali Acc: 0.274 Test Loss: 3.459 Test Acc: 0.274
Validation loss decreased (-0.258525 --> -0.273730).  Saving model ...
Epoch: 6 cost time: 6.073332071304321
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 4.966 Vali Acc: 0.278 Test Loss: 4.966 Test Acc: 0.278
Validation loss decreased (-0.273730 --> -0.277517).  Saving model ...
Epoch: 7 cost time: 6.21806001663208
Epoch: 7, Steps: 17 | Train Loss: 1.285 Vali Loss: 6.847 Vali Acc: 0.259 Test Loss: 6.847 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.229866027832031
Epoch: 8, Steps: 17 | Train Loss: 1.118 Vali Loss: 6.289 Vali Acc: 0.232 Test Loss: 6.289 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.286752700805664
Epoch: 9, Steps: 17 | Train Loss: 0.987 Vali Loss: 5.546 Vali Acc: 0.270 Test Loss: 5.546 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.55031681060791
Epoch: 10, Steps: 17 | Train Loss: 1.195 Vali Loss: 7.700 Vali Acc: 0.255 Test Loss: 7.700 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.693247556686401
Epoch: 11, Steps: 17 | Train Loss: 1.440 Vali Loss: 11.974 Vali Acc: 0.274 Test Loss: 11.974 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.457939386367798
Epoch: 12, Steps: 17 | Train Loss: 1.135 Vali Loss: 7.934 Vali Acc: 0.285 Test Loss: 7.934 Test Acc: 0.285
Validation loss decreased (-0.277517 --> -0.285092).  Saving model ...
Epoch: 13 cost time: 6.0007030963897705
Epoch: 13, Steps: 17 | Train Loss: 0.856 Vali Loss: 8.450 Vali Acc: 0.270 Test Loss: 8.450 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.104238510131836
Epoch: 14, Steps: 17 | Train Loss: 0.669 Vali Loss: 13.414 Vali Acc: 0.262 Test Loss: 13.414 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.085586309432983
Epoch: 15, Steps: 17 | Train Loss: 0.852 Vali Loss: 14.654 Vali Acc: 0.251 Test Loss: 14.654 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.153057098388672
Epoch: 16, Steps: 17 | Train Loss: 0.997 Vali Loss: 11.055 Vali Acc: 0.278 Test Loss: 11.055 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.095070838928223
Epoch: 17, Steps: 17 | Train Loss: 0.970 Vali Loss: 9.600 Vali Acc: 0.274 Test Loss: 9.600 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.205450057983398
Epoch: 18, Steps: 17 | Train Loss: 0.877 Vali Loss: 10.459 Vali Acc: 0.251 Test Loss: 10.459 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.179876089096069
Epoch: 19, Steps: 17 | Train Loss: 1.103 Vali Loss: 11.439 Vali Acc: 0.255 Test Loss: 11.439 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.496231555938721
Epoch: 20, Steps: 17 | Train Loss: 0.653 Vali Loss: 16.502 Vali Acc: 0.236 Test Loss: 16.502 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.900205135345459
Epoch: 21, Steps: 17 | Train Loss: 1.035 Vali Loss: 15.091 Vali Acc: 0.232 Test Loss: 15.091 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.8941590785980225
Epoch: 22, Steps: 17 | Train Loss: 1.114 Vali Loss: 15.594 Vali Acc: 0.236 Test Loss: 15.594 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.847955226898193
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 2.137 Vali Acc: 0.251 Test Loss: 2.137 Test Acc: 0.251
Validation loss decreased (inf --> -0.250929).  Saving model ...
Epoch: 2 cost time: 6.534597396850586
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 3.064 Vali Acc: 0.266 Test Loss: 3.064 Test Acc: 0.266
Validation loss decreased (-0.250929 --> -0.266129).  Saving model ...
Epoch: 3 cost time: 6.142386198043823
Epoch: 3, Steps: 17 | Train Loss: 1.478 Vali Loss: 4.390 Vali Acc: 0.251 Test Loss: 4.390 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.406336784362793
Epoch: 4, Steps: 17 | Train Loss: 1.496 Vali Loss: 4.094 Vali Acc: 0.243 Test Loss: 4.094 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.27709436416626
Epoch: 5, Steps: 17 | Train Loss: 1.508 Vali Loss: 4.137 Vali Acc: 0.236 Test Loss: 4.137 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.770556688308716
Epoch: 6, Steps: 17 | Train Loss: 1.623 Vali Loss: 7.107 Vali Acc: 0.255 Test Loss: 7.107 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.708948135375977
Epoch: 7, Steps: 17 | Train Loss: 1.825 Vali Loss: 8.883 Vali Acc: 0.259 Test Loss: 8.883 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.775750160217285
Epoch: 8, Steps: 17 | Train Loss: 1.880 Vali Loss: 7.496 Vali Acc: 0.270 Test Loss: 7.496 Test Acc: 0.270
Validation loss decreased (-0.266129 --> -0.269887).  Saving model ...
Epoch: 9 cost time: 6.718415975570679
Epoch: 9, Steps: 17 | Train Loss: 1.645 Vali Loss: 9.065 Vali Acc: 0.259 Test Loss: 9.065 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.170021057128906
Epoch: 10, Steps: 17 | Train Loss: 1.172 Vali Loss: 6.793 Vali Acc: 0.251 Test Loss: 6.793 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.143656969070435
Epoch: 11, Steps: 17 | Train Loss: 1.715 Vali Loss: 5.493 Vali Acc: 0.255 Test Loss: 5.493 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.283053874969482
Epoch: 12, Steps: 17 | Train Loss: 1.562 Vali Loss: 8.201 Vali Acc: 0.247 Test Loss: 8.201 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.001980543136597
Epoch: 13, Steps: 17 | Train Loss: 0.988 Vali Loss: 9.207 Vali Acc: 0.251 Test Loss: 9.207 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.719887018203735
Epoch: 14, Steps: 17 | Train Loss: 1.374 Vali Loss: 12.395 Vali Acc: 0.266 Test Loss: 12.395 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.6691436767578125
Epoch: 15, Steps: 17 | Train Loss: 1.325 Vali Loss: 14.607 Vali Acc: 0.247 Test Loss: 14.607 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.310680389404297
Epoch: 16, Steps: 17 | Train Loss: 1.608 Vali Loss: 12.062 Vali Acc: 0.270 Test Loss: 12.062 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.618770599365234
Epoch: 17, Steps: 17 | Train Loss: 1.182 Vali Loss: 13.090 Vali Acc: 0.247 Test Loss: 13.090 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.539811372756958
Epoch: 18, Steps: 17 | Train Loss: 1.330 Vali Loss: 12.868 Vali Acc: 0.232 Test Loss: 12.868 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3132164
model size : 16.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.604300260543823
Epoch: 1, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.835 Vali Acc: 0.266 Test Loss: 1.835 Test Acc: 0.266
Validation loss decreased (inf --> -0.266141).  Saving model ...
Epoch: 2 cost time: 9.162302732467651
Epoch: 2, Steps: 17 | Train Loss: 1.628 Vali Loss: 2.279 Vali Acc: 0.224 Test Loss: 2.279 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.022887706756592
Epoch: 3, Steps: 17 | Train Loss: 1.829 Vali Loss: 2.044 Vali Acc: 0.251 Test Loss: 2.044 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.941851615905762
Epoch: 4, Steps: 17 | Train Loss: 1.573 Vali Loss: 2.384 Vali Acc: 0.278 Test Loss: 2.384 Test Acc: 0.278
Validation loss decreased (-0.266141 --> -0.277543).  Saving model ...
Epoch: 5 cost time: 10.341077327728271
Epoch: 5, Steps: 17 | Train Loss: 1.633 Vali Loss: 2.536 Vali Acc: 0.255 Test Loss: 2.536 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.263054132461548
Epoch: 6, Steps: 17 | Train Loss: 1.180 Vali Loss: 3.631 Vali Acc: 0.278 Test Loss: 3.631 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.4695143699646
Epoch: 7, Steps: 17 | Train Loss: 1.434 Vali Loss: 4.022 Vali Acc: 0.285 Test Loss: 4.022 Test Acc: 0.285
Validation loss decreased (-0.277543 --> -0.285131).  Saving model ...
Epoch: 8 cost time: 10.324252128601074
Epoch: 8, Steps: 17 | Train Loss: 1.473 Vali Loss: 3.962 Vali Acc: 0.259 Test Loss: 3.962 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.189795970916748
Epoch: 9, Steps: 17 | Train Loss: 1.644 Vali Loss: 3.791 Vali Acc: 0.289 Test Loss: 3.791 Test Acc: 0.289
Validation loss decreased (-0.285131 --> -0.288935).  Saving model ...
Epoch: 10 cost time: 10.405307292938232
Epoch: 10, Steps: 17 | Train Loss: 1.095 Vali Loss: 4.032 Vali Acc: 0.255 Test Loss: 4.032 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.43753433227539
Epoch: 11, Steps: 17 | Train Loss: 1.333 Vali Loss: 5.806 Vali Acc: 0.255 Test Loss: 5.806 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.92173457145691
Epoch: 12, Steps: 17 | Train Loss: 1.226 Vali Loss: 4.399 Vali Acc: 0.240 Test Loss: 4.399 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.929605484008789
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 4.855 Vali Acc: 0.251 Test Loss: 4.855 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.48765754699707
Epoch: 14, Steps: 17 | Train Loss: 1.105 Vali Loss: 4.702 Vali Acc: 0.255 Test Loss: 4.702 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.390366315841675
Epoch: 15, Steps: 17 | Train Loss: 0.661 Vali Loss: 4.864 Vali Acc: 0.297 Test Loss: 4.864 Test Acc: 0.297
Validation loss decreased (-0.288935 --> -0.296529).  Saving model ...
Epoch: 16 cost time: 10.586182594299316
Epoch: 16, Steps: 17 | Train Loss: 0.752 Vali Loss: 5.841 Vali Acc: 0.259 Test Loss: 5.841 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.113975763320923
Epoch: 17, Steps: 17 | Train Loss: 0.639 Vali Loss: 6.003 Vali Acc: 0.259 Test Loss: 6.003 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.140305995941162
Epoch: 18, Steps: 17 | Train Loss: 0.688 Vali Loss: 5.925 Vali Acc: 0.240 Test Loss: 5.925 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.833675384521484
Epoch: 19, Steps: 17 | Train Loss: 0.731 Vali Loss: 5.528 Vali Acc: 0.293 Test Loss: 5.528 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.55515193939209
Epoch: 20, Steps: 17 | Train Loss: 0.474 Vali Loss: 7.418 Vali Acc: 0.289 Test Loss: 7.418 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.800262689590454
Epoch: 21, Steps: 17 | Train Loss: 0.883 Vali Loss: 7.975 Vali Acc: 0.232 Test Loss: 7.975 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.02612853050232
Epoch: 22, Steps: 17 | Train Loss: 0.625 Vali Loss: 7.615 Vali Acc: 0.289 Test Loss: 7.615 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.245384454727173
Epoch: 23, Steps: 17 | Train Loss: 0.416 Vali Loss: 7.786 Vali Acc: 0.255 Test Loss: 7.786 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.775430917739868
Epoch: 24, Steps: 17 | Train Loss: 0.530 Vali Loss: 8.635 Vali Acc: 0.255 Test Loss: 8.635 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.809026718139648
Epoch: 25, Steps: 17 | Train Loss: 0.845 Vali Loss: 9.088 Vali Acc: 0.251 Test Loss: 9.088 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.867753744125366
Epoch: 1, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
Validation loss decreased (inf --> -0.243328).  Saving model ...
Epoch: 2 cost time: 9.450303077697754
Epoch: 2, Steps: 17 | Train Loss: 1.633 Vali Loss: 2.118 Vali Acc: 0.221 Test Loss: 2.118 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.173976182937622
Epoch: 3, Steps: 17 | Train Loss: 1.681 Vali Loss: 2.595 Vali Acc: 0.255 Test Loss: 2.595 Test Acc: 0.255
Validation loss decreased (-0.243328 --> -0.254727).  Saving model ...
Epoch: 4 cost time: 8.53115701675415
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.977 Vali Acc: 0.281 Test Loss: 1.977 Test Acc: 0.281
Validation loss decreased (-0.254727 --> -0.281349).  Saving model ...
Epoch: 5 cost time: 9.141687870025635
Epoch: 5, Steps: 17 | Train Loss: 1.274 Vali Loss: 2.602 Vali Acc: 0.243 Test Loss: 2.602 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.64970850944519
Epoch: 6, Steps: 17 | Train Loss: 1.261 Vali Loss: 4.710 Vali Acc: 0.270 Test Loss: 4.710 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.395486116409302
Epoch: 7, Steps: 17 | Train Loss: 1.548 Vali Loss: 4.647 Vali Acc: 0.247 Test Loss: 4.647 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.277363538742065
Epoch: 8, Steps: 17 | Train Loss: 1.439 Vali Loss: 3.579 Vali Acc: 0.259 Test Loss: 3.579 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.797487020492554
Epoch: 9, Steps: 17 | Train Loss: 1.521 Vali Loss: 3.401 Vali Acc: 0.247 Test Loss: 3.401 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.353963613510132
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 5.489 Vali Acc: 0.262 Test Loss: 5.489 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.744205951690674
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 4.126 Vali Acc: 0.236 Test Loss: 4.126 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.990827083587646
Epoch: 12, Steps: 17 | Train Loss: 0.926 Vali Loss: 5.084 Vali Acc: 0.289 Test Loss: 5.084 Test Acc: 0.289
Validation loss decreased (-0.281349 --> -0.288923).  Saving model ...
Epoch: 13 cost time: 9.38449239730835
Epoch: 13, Steps: 17 | Train Loss: 0.931 Vali Loss: 4.441 Vali Acc: 0.236 Test Loss: 4.441 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.45107889175415
Epoch: 14, Steps: 17 | Train Loss: 1.409 Vali Loss: 5.822 Vali Acc: 0.266 Test Loss: 5.822 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.13188099861145
Epoch: 15, Steps: 17 | Train Loss: 1.345 Vali Loss: 7.525 Vali Acc: 0.259 Test Loss: 7.525 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.798654556274414
Epoch: 16, Steps: 17 | Train Loss: 0.825 Vali Loss: 6.183 Vali Acc: 0.266 Test Loss: 6.183 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.997598886489868
Epoch: 17, Steps: 17 | Train Loss: 0.936 Vali Loss: 8.542 Vali Acc: 0.262 Test Loss: 8.542 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.599707841873169
Epoch: 18, Steps: 17 | Train Loss: 0.798 Vali Loss: 6.429 Vali Acc: 0.221 Test Loss: 6.429 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.454240798950195
Epoch: 19, Steps: 17 | Train Loss: 0.899 Vali Loss: 6.913 Vali Acc: 0.228 Test Loss: 6.913 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.821352481842041
Epoch: 20, Steps: 17 | Train Loss: 0.880 Vali Loss: 7.193 Vali Acc: 0.259 Test Loss: 7.193 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.047268152236938
Epoch: 21, Steps: 17 | Train Loss: 0.511 Vali Loss: 7.168 Vali Acc: 0.236 Test Loss: 7.168 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.549838304519653
Epoch: 22, Steps: 17 | Train Loss: 1.088 Vali Loss: 9.750 Vali Acc: 0.270 Test Loss: 9.750 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.855067491531372
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.051 Vali Acc: 0.251 Test Loss: 2.051 Test Acc: 0.251
Validation loss decreased (inf --> -0.250930).  Saving model ...
Epoch: 2 cost time: 7.684890985488892
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 2.451 Vali Acc: 0.243 Test Loss: 2.451 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.771225214004517
Epoch: 3, Steps: 17 | Train Loss: 1.572 Vali Loss: 2.930 Vali Acc: 0.232 Test Loss: 2.930 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.942298889160156
Epoch: 4, Steps: 17 | Train Loss: 1.448 Vali Loss: 2.402 Vali Acc: 0.247 Test Loss: 2.402 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.251683712005615
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 3.527 Vali Acc: 0.217 Test Loss: 3.527 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.356844425201416
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 3.524 Vali Acc: 0.209 Test Loss: 3.524 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.419289112091064
Epoch: 7, Steps: 17 | Train Loss: 1.234 Vali Loss: 4.997 Vali Acc: 0.262 Test Loss: 4.997 Test Acc: 0.262
Validation loss decreased (-0.250930 --> -0.262307).  Saving model ...
Epoch: 8 cost time: 8.4838285446167
Epoch: 8, Steps: 17 | Train Loss: 1.513 Vali Loss: 3.818 Vali Acc: 0.289 Test Loss: 3.818 Test Acc: 0.289
Validation loss decreased (-0.262307 --> -0.288935).  Saving model ...
Epoch: 9 cost time: 8.150956630706787
Epoch: 9, Steps: 17 | Train Loss: 1.760 Vali Loss: 9.384 Vali Acc: 0.251 Test Loss: 9.384 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.475364923477173
Epoch: 10, Steps: 17 | Train Loss: 1.140 Vali Loss: 7.288 Vali Acc: 0.255 Test Loss: 7.288 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.535101890563965
Epoch: 11, Steps: 17 | Train Loss: 1.092 Vali Loss: 6.059 Vali Acc: 0.232 Test Loss: 6.059 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.027847051620483
Epoch: 12, Steps: 17 | Train Loss: 0.989 Vali Loss: 6.613 Vali Acc: 0.221 Test Loss: 6.613 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.77824592590332
Epoch: 13, Steps: 17 | Train Loss: 1.052 Vali Loss: 6.081 Vali Acc: 0.228 Test Loss: 6.081 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.661051988601685
Epoch: 14, Steps: 17 | Train Loss: 1.355 Vali Loss: 6.445 Vali Acc: 0.236 Test Loss: 6.445 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.987871885299683
Epoch: 15, Steps: 17 | Train Loss: 0.757 Vali Loss: 6.950 Vali Acc: 0.236 Test Loss: 6.950 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.423872232437134
Epoch: 16, Steps: 17 | Train Loss: 0.959 Vali Loss: 8.249 Vali Acc: 0.251 Test Loss: 8.249 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.248906373977661
Epoch: 17, Steps: 17 | Train Loss: 0.655 Vali Loss: 10.693 Vali Acc: 0.255 Test Loss: 10.693 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.5935959815979
Epoch: 18, Steps: 17 | Train Loss: 0.646 Vali Loss: 11.874 Vali Acc: 0.255 Test Loss: 11.874 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.648546695709229
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 2.162 Vali Acc: 0.278 Test Loss: 2.162 Test Acc: 0.278
Validation loss decreased (inf --> -0.277545).  Saving model ...
Epoch: 2 cost time: 7.627931594848633
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 2.630 Vali Acc: 0.274 Test Loss: 2.630 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.616940975189209
Epoch: 3, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.983 Vali Acc: 0.224 Test Loss: 2.983 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.15618371963501
Epoch: 4, Steps: 17 | Train Loss: 1.234 Vali Loss: 2.827 Vali Acc: 0.224 Test Loss: 2.827 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.845579624176025
Epoch: 5, Steps: 17 | Train Loss: 1.159 Vali Loss: 4.387 Vali Acc: 0.251 Test Loss: 4.387 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.840419292449951
Epoch: 6, Steps: 17 | Train Loss: 1.236 Vali Loss: 4.478 Vali Acc: 0.270 Test Loss: 4.478 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.321743488311768
Epoch: 7, Steps: 17 | Train Loss: 1.134 Vali Loss: 4.043 Vali Acc: 0.247 Test Loss: 4.043 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.609489679336548
Epoch: 8, Steps: 17 | Train Loss: 1.028 Vali Loss: 5.216 Vali Acc: 0.251 Test Loss: 5.216 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.984998941421509
Epoch: 9, Steps: 17 | Train Loss: 1.494 Vali Loss: 9.935 Vali Acc: 0.262 Test Loss: 9.935 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.387701034545898
Epoch: 10, Steps: 17 | Train Loss: 1.234 Vali Loss: 7.599 Vali Acc: 0.266 Test Loss: 7.599 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.233924865722656
Epoch: 11, Steps: 17 | Train Loss: 1.367 Vali Loss: 6.747 Vali Acc: 0.232 Test Loss: 6.747 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.867199897766113
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.966 Vali Acc: 0.251 Test Loss: 1.966 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 6.845823526382446
Epoch: 2, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.104 Vali Acc: 0.247 Test Loss: 2.104 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.345792531967163
Epoch: 3, Steps: 17 | Train Loss: 1.473 Vali Loss: 3.249 Vali Acc: 0.243 Test Loss: 3.249 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.4460608959198
Epoch: 4, Steps: 17 | Train Loss: 1.243 Vali Loss: 3.516 Vali Acc: 0.281 Test Loss: 3.516 Test Acc: 0.281
Validation loss decreased (-0.250931 --> -0.281334).  Saving model ...
Epoch: 5 cost time: 6.672762155532837
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 4.544 Vali Acc: 0.266 Test Loss: 4.544 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.931229829788208
Epoch: 6, Steps: 17 | Train Loss: 1.024 Vali Loss: 3.924 Vali Acc: 0.221 Test Loss: 3.924 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.87512993812561
Epoch: 7, Steps: 17 | Train Loss: 0.907 Vali Loss: 5.962 Vali Acc: 0.274 Test Loss: 5.962 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.8973777294158936
Epoch: 8, Steps: 17 | Train Loss: 1.268 Vali Loss: 4.806 Vali Acc: 0.266 Test Loss: 4.806 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.625064134597778
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 10.818 Vali Acc: 0.274 Test Loss: 10.818 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.445490598678589
Epoch: 10, Steps: 17 | Train Loss: 0.868 Vali Loss: 5.988 Vali Acc: 0.251 Test Loss: 5.988 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.4943931102752686
Epoch: 11, Steps: 17 | Train Loss: 0.642 Vali Loss: 6.220 Vali Acc: 0.285 Test Loss: 6.220 Test Acc: 0.285
Validation loss decreased (-0.281334 --> -0.285109).  Saving model ...
Epoch: 12 cost time: 6.795826435089111
Epoch: 12, Steps: 17 | Train Loss: 0.638 Vali Loss: 7.312 Vali Acc: 0.255 Test Loss: 7.312 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.816739320755005
Epoch: 13, Steps: 17 | Train Loss: 0.580 Vali Loss: 12.535 Vali Acc: 0.278 Test Loss: 12.535 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.909247398376465
Epoch: 14, Steps: 17 | Train Loss: 0.843 Vali Loss: 8.163 Vali Acc: 0.262 Test Loss: 8.163 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.761735439300537
Epoch: 15, Steps: 17 | Train Loss: 0.750 Vali Loss: 12.814 Vali Acc: 0.270 Test Loss: 12.814 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.4107091426849365
Epoch: 16, Steps: 17 | Train Loss: 1.049 Vali Loss: 12.564 Vali Acc: 0.243 Test Loss: 12.564 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.66520094871521
Epoch: 17, Steps: 17 | Train Loss: 0.783 Vali Loss: 9.050 Vali Acc: 0.255 Test Loss: 9.050 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.7328040599823
Epoch: 18, Steps: 17 | Train Loss: 0.421 Vali Loss: 11.764 Vali Acc: 0.289 Test Loss: 11.764 Test Acc: 0.289
Validation loss decreased (-0.285109 --> -0.288856).  Saving model ...
Epoch: 19 cost time: 7.042855262756348
Epoch: 19, Steps: 17 | Train Loss: 0.603 Vali Loss: 13.120 Vali Acc: 0.281 Test Loss: 13.120 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.361201763153076
Epoch: 20, Steps: 17 | Train Loss: 0.702 Vali Loss: 12.115 Vali Acc: 0.338 Test Loss: 12.115 Test Acc: 0.338
Validation loss decreased (-0.288856 --> -0.338282).  Saving model ...
Epoch: 21 cost time: 6.752325773239136
Epoch: 21, Steps: 17 | Train Loss: 0.795 Vali Loss: 12.679 Vali Acc: 0.243 Test Loss: 12.679 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.4139533042907715
Epoch: 22, Steps: 17 | Train Loss: 0.510 Vali Loss: 14.138 Vali Acc: 0.293 Test Loss: 14.138 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.331853151321411
Epoch: 23, Steps: 17 | Train Loss: 0.306 Vali Loss: 14.893 Vali Acc: 0.319 Test Loss: 14.893 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.436735391616821
Epoch: 24, Steps: 17 | Train Loss: 0.799 Vali Loss: 18.276 Vali Acc: 0.293 Test Loss: 18.276 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.415700435638428
Epoch: 25, Steps: 17 | Train Loss: 0.784 Vali Loss: 16.783 Vali Acc: 0.289 Test Loss: 16.783 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.4529869556427
Epoch: 26, Steps: 17 | Train Loss: 0.538 Vali Loss: 15.189 Vali Acc: 0.255 Test Loss: 15.189 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.7385711669921875
Epoch: 27, Steps: 17 | Train Loss: 0.363 Vali Loss: 19.576 Vali Acc: 0.270 Test Loss: 19.576 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.490076065063477
Epoch: 28, Steps: 17 | Train Loss: 1.001 Vali Loss: 18.263 Vali Acc: 0.259 Test Loss: 18.263 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.434231758117676
Epoch: 29, Steps: 17 | Train Loss: 0.626 Vali Loss: 20.380 Vali Acc: 0.228 Test Loss: 20.380 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.46355938911438
Epoch: 30, Steps: 17 | Train Loss: 0.686 Vali Loss: 19.263 Vali Acc: 0.274 Test Loss: 19.263 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.5902228355407715
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.024 Vali Acc: 0.236 Test Loss: 2.024 Test Acc: 0.236
Validation loss decreased (inf --> -0.235721).  Saving model ...
Epoch: 2 cost time: 6.415629863739014
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 2.782 Vali Acc: 0.266 Test Loss: 2.782 Test Acc: 0.266
Validation loss decreased (-0.235721 --> -0.266132).  Saving model ...
Epoch: 3 cost time: 6.539417028427124
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 3.155 Vali Acc: 0.251 Test Loss: 3.155 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.68433952331543
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 2.764 Vali Acc: 0.228 Test Loss: 2.764 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.163006067276001
Epoch: 5, Steps: 17 | Train Loss: 1.240 Vali Loss: 3.875 Vali Acc: 0.247 Test Loss: 3.875 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.345158338546753
Epoch: 6, Steps: 17 | Train Loss: 0.926 Vali Loss: 4.036 Vali Acc: 0.262 Test Loss: 4.036 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.1671953201293945
Epoch: 7, Steps: 17 | Train Loss: 0.907 Vali Loss: 5.343 Vali Acc: 0.243 Test Loss: 5.343 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.326333522796631
Epoch: 8, Steps: 17 | Train Loss: 0.977 Vali Loss: 4.373 Vali Acc: 0.236 Test Loss: 4.373 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.306872844696045
Epoch: 9, Steps: 17 | Train Loss: 0.992 Vali Loss: 6.008 Vali Acc: 0.243 Test Loss: 6.008 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.142894744873047
Epoch: 10, Steps: 17 | Train Loss: 0.666 Vali Loss: 6.490 Vali Acc: 0.259 Test Loss: 6.490 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.29968523979187
Epoch: 11, Steps: 17 | Train Loss: 0.871 Vali Loss: 6.370 Vali Acc: 0.247 Test Loss: 6.370 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.919752836227417
Epoch: 12, Steps: 17 | Train Loss: 0.578 Vali Loss: 6.779 Vali Acc: 0.236 Test Loss: 6.779 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.912029027938843
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.875 Vali Acc: 0.262 Test Loss: 1.875 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 6.189216375350952
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 2.909 Vali Acc: 0.270 Test Loss: 2.909 Test Acc: 0.270
Validation loss decreased (-0.262339 --> -0.269933).  Saving model ...
Epoch: 3 cost time: 6.2766687870025635
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 3.676 Vali Acc: 0.251 Test Loss: 3.676 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.943562984466553
Epoch: 4, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.729 Vali Acc: 0.247 Test Loss: 2.729 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.065236806869507
Epoch: 5, Steps: 17 | Train Loss: 1.183 Vali Loss: 4.871 Vali Acc: 0.270 Test Loss: 4.871 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.020147800445557
Epoch: 6, Steps: 17 | Train Loss: 1.157 Vali Loss: 3.621 Vali Acc: 0.243 Test Loss: 3.621 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.371682643890381
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 4.512 Vali Acc: 0.270 Test Loss: 4.512 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.361640930175781
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 3.909 Vali Acc: 0.274 Test Loss: 3.909 Test Acc: 0.274
Validation loss decreased (-0.269933 --> -0.273725).  Saving model ...
Epoch: 9 cost time: 6.7669594287872314
Epoch: 9, Steps: 17 | Train Loss: 1.641 Vali Loss: 6.515 Vali Acc: 0.281 Test Loss: 6.515 Test Acc: 0.281
Validation loss decreased (-0.273725 --> -0.281304).  Saving model ...
Epoch: 10 cost time: 6.835368633270264
Epoch: 10, Steps: 17 | Train Loss: 0.788 Vali Loss: 4.963 Vali Acc: 0.266 Test Loss: 4.963 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.297259330749512
Epoch: 11, Steps: 17 | Train Loss: 0.641 Vali Loss: 5.223 Vali Acc: 0.251 Test Loss: 5.223 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.0223915576934814
Epoch: 12, Steps: 17 | Train Loss: 0.669 Vali Loss: 5.713 Vali Acc: 0.251 Test Loss: 5.713 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.9174723625183105
Epoch: 13, Steps: 17 | Train Loss: 0.774 Vali Loss: 6.813 Vali Acc: 0.270 Test Loss: 6.813 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.639218330383301
Epoch: 14, Steps: 17 | Train Loss: 0.638 Vali Loss: 6.859 Vali Acc: 0.251 Test Loss: 6.859 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.242271661758423
Epoch: 15, Steps: 17 | Train Loss: 0.417 Vali Loss: 9.174 Vali Acc: 0.247 Test Loss: 9.174 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.265275239944458
Epoch: 16, Steps: 17 | Train Loss: 0.716 Vali Loss: 9.826 Vali Acc: 0.251 Test Loss: 9.826 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.377334117889404
Epoch: 17, Steps: 17 | Train Loss: 0.724 Vali Loss: 10.878 Vali Acc: 0.255 Test Loss: 10.878 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.085595369338989
Epoch: 18, Steps: 17 | Train Loss: 0.448 Vali Loss: 10.199 Vali Acc: 0.255 Test Loss: 10.199 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.104900598526001
Epoch: 19, Steps: 17 | Train Loss: 1.085 Vali Loss: 12.351 Vali Acc: 0.251 Test Loss: 12.351 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.70460319519043
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.858 Vali Acc: 0.262 Test Loss: 1.858 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 6.242115020751953
Epoch: 2, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.848 Vali Acc: 0.247 Test Loss: 2.848 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.380508899688721
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 3.958 Vali Acc: 0.240 Test Loss: 3.958 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.717852354049683
Epoch: 4, Steps: 17 | Train Loss: 1.214 Vali Loss: 2.528 Vali Acc: 0.247 Test Loss: 2.528 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.448677062988281
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 4.413 Vali Acc: 0.274 Test Loss: 4.413 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273720).  Saving model ...
Epoch: 6 cost time: 6.283848762512207
Epoch: 6, Steps: 17 | Train Loss: 1.115 Vali Loss: 4.822 Vali Acc: 0.266 Test Loss: 4.822 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.416180610656738
Epoch: 7, Steps: 17 | Train Loss: 1.126 Vali Loss: 5.710 Vali Acc: 0.262 Test Loss: 5.710 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.300865173339844
Epoch: 8, Steps: 17 | Train Loss: 1.546 Vali Loss: 4.047 Vali Acc: 0.262 Test Loss: 4.047 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.3626322746276855
Epoch: 9, Steps: 17 | Train Loss: 1.689 Vali Loss: 7.362 Vali Acc: 0.251 Test Loss: 7.362 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.127965927124023
Epoch: 10, Steps: 17 | Train Loss: 0.865 Vali Loss: 4.923 Vali Acc: 0.266 Test Loss: 4.923 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.31606125831604
Epoch: 11, Steps: 17 | Train Loss: 0.852 Vali Loss: 5.153 Vali Acc: 0.289 Test Loss: 5.153 Test Acc: 0.289
Validation loss decreased (-0.273720 --> -0.288922).  Saving model ...
Epoch: 12 cost time: 6.111770391464233
Epoch: 12, Steps: 17 | Train Loss: 1.014 Vali Loss: 5.991 Vali Acc: 0.266 Test Loss: 5.991 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.473880290985107
Epoch: 13, Steps: 17 | Train Loss: 0.612 Vali Loss: 6.760 Vali Acc: 0.251 Test Loss: 6.760 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.708443880081177
Epoch: 14, Steps: 17 | Train Loss: 0.686 Vali Loss: 6.847 Vali Acc: 0.224 Test Loss: 6.847 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.031847715377808
Epoch: 15, Steps: 17 | Train Loss: 0.512 Vali Loss: 7.139 Vali Acc: 0.262 Test Loss: 7.139 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.889689207077026
Epoch: 16, Steps: 17 | Train Loss: 0.475 Vali Loss: 8.755 Vali Acc: 0.243 Test Loss: 8.755 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.9205381870269775
Epoch: 17, Steps: 17 | Train Loss: 0.764 Vali Loss: 11.714 Vali Acc: 0.247 Test Loss: 11.714 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.059962511062622
Epoch: 18, Steps: 17 | Train Loss: 0.864 Vali Loss: 11.319 Vali Acc: 0.232 Test Loss: 11.319 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.28827977180481
Epoch: 19, Steps: 17 | Train Loss: 0.776 Vali Loss: 13.076 Vali Acc: 0.240 Test Loss: 13.076 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.343920946121216
Epoch: 20, Steps: 17 | Train Loss: 1.159 Vali Loss: 16.586 Vali Acc: 0.224 Test Loss: 16.586 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.277662754058838
Epoch: 21, Steps: 17 | Train Loss: 0.552 Vali Loss: 14.417 Vali Acc: 0.236 Test Loss: 14.417 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.152398109436035
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.773 Vali Acc: 0.255 Test Loss: 1.773 Test Acc: 0.255
Validation loss decreased (inf --> -0.254735).  Saving model ...
Epoch: 2 cost time: 5.8200554847717285
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 3.384 Vali Acc: 0.251 Test Loss: 3.384 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.062526702880859
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 4.284 Vali Acc: 0.243 Test Loss: 4.284 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.1791675090789795
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 2.747 Vali Acc: 0.240 Test Loss: 2.747 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.5977463722229
Epoch: 5, Steps: 17 | Train Loss: 1.434 Vali Loss: 4.949 Vali Acc: 0.262 Test Loss: 4.949 Test Acc: 0.262
Validation loss decreased (-0.254735 --> -0.262308).  Saving model ...
Epoch: 6 cost time: 6.413529872894287
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 3.987 Vali Acc: 0.251 Test Loss: 3.987 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.1837756633758545
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 4.585 Vali Acc: 0.285 Test Loss: 4.585 Test Acc: 0.285
Validation loss decreased (-0.262308 --> -0.285125).  Saving model ...
Epoch: 8 cost time: 6.324843168258667
Epoch: 8, Steps: 17 | Train Loss: 1.346 Vali Loss: 4.362 Vali Acc: 0.285 Test Loss: 4.362 Test Acc: 0.285
Validation loss decreased (-0.285125 --> -0.285127).  Saving model ...
Epoch: 9 cost time: 6.250516176223755
Epoch: 9, Steps: 17 | Train Loss: 1.695 Vali Loss: 11.380 Vali Acc: 0.262 Test Loss: 11.380 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.505116701126099
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 8.832 Vali Acc: 0.281 Test Loss: 8.832 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.436608076095581
Epoch: 11, Steps: 17 | Train Loss: 0.768 Vali Loss: 7.230 Vali Acc: 0.255 Test Loss: 7.230 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.484296083450317
Epoch: 12, Steps: 17 | Train Loss: 0.903 Vali Loss: 6.989 Vali Acc: 0.270 Test Loss: 6.989 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.291797399520874
Epoch: 13, Steps: 17 | Train Loss: 0.806 Vali Loss: 7.575 Vali Acc: 0.297 Test Loss: 7.575 Test Acc: 0.297
Validation loss decreased (-0.285127 --> -0.296502).  Saving model ...
Epoch: 14 cost time: 6.2983222007751465
Epoch: 14, Steps: 17 | Train Loss: 0.950 Vali Loss: 8.354 Vali Acc: 0.270 Test Loss: 8.354 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.932852029800415
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 14.337 Vali Acc: 0.240 Test Loss: 14.337 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.045251846313477
Epoch: 16, Steps: 17 | Train Loss: 1.141 Vali Loss: 13.954 Vali Acc: 0.262 Test Loss: 13.954 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.219337701797485
Epoch: 17, Steps: 17 | Train Loss: 0.895 Vali Loss: 15.038 Vali Acc: 0.247 Test Loss: 15.038 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.927581787109375
Epoch: 18, Steps: 17 | Train Loss: 1.183 Vali Loss: 12.485 Vali Acc: 0.240 Test Loss: 12.485 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.213658332824707
Epoch: 19, Steps: 17 | Train Loss: 1.059 Vali Loss: 14.824 Vali Acc: 0.255 Test Loss: 14.824 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.96654200553894
Epoch: 20, Steps: 17 | Train Loss: 0.729 Vali Loss: 16.134 Vali Acc: 0.262 Test Loss: 16.134 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.9628236293792725
Epoch: 21, Steps: 17 | Train Loss: 0.971 Vali Loss: 17.142 Vali Acc: 0.278 Test Loss: 17.142 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.933863401412964
Epoch: 22, Steps: 17 | Train Loss: 1.345 Vali Loss: 17.854 Vali Acc: 0.255 Test Loss: 17.854 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.3806140422821045
Epoch: 23, Steps: 17 | Train Loss: 1.190 Vali Loss: 16.008 Vali Acc: 0.240 Test Loss: 16.008 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.319189786911011
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.051 Vali Acc: 0.251 Test Loss: 2.051 Test Acc: 0.251
Validation loss decreased (inf --> -0.250930).  Saving model ...
Epoch: 2 cost time: 5.79892373085022
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 3.686 Vali Acc: 0.251 Test Loss: 3.686 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.717844009399414
Epoch: 3, Steps: 17 | Train Loss: 1.511 Vali Loss: 5.015 Vali Acc: 0.236 Test Loss: 5.015 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.80001974105835
Epoch: 4, Steps: 17 | Train Loss: 1.484 Vali Loss: 4.225 Vali Acc: 0.255 Test Loss: 4.225 Test Acc: 0.255
Validation loss decreased (-0.250930 --> -0.254711).  Saving model ...
Epoch: 5 cost time: 5.6654579639434814
Epoch: 5, Steps: 17 | Train Loss: 1.774 Vali Loss: 5.972 Vali Acc: 0.255 Test Loss: 5.972 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7054009437561035
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 6.014 Vali Acc: 0.243 Test Loss: 6.014 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.981775999069214
Epoch: 7, Steps: 17 | Train Loss: 1.419 Vali Loss: 5.764 Vali Acc: 0.247 Test Loss: 5.764 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.069503307342529
Epoch: 8, Steps: 17 | Train Loss: 1.664 Vali Loss: 4.805 Vali Acc: 0.266 Test Loss: 4.805 Test Acc: 0.266
Validation loss decreased (-0.254711 --> -0.266112).  Saving model ...
Epoch: 9 cost time: 5.868245601654053
Epoch: 9, Steps: 17 | Train Loss: 1.570 Vali Loss: 8.858 Vali Acc: 0.270 Test Loss: 8.858 Test Acc: 0.270
Validation loss decreased (-0.266112 --> -0.269873).  Saving model ...
Epoch: 10 cost time: 5.741865396499634
Epoch: 10, Steps: 17 | Train Loss: 1.255 Vali Loss: 10.490 Vali Acc: 0.259 Test Loss: 10.490 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.6978864669799805
Epoch: 11, Steps: 17 | Train Loss: 1.144 Vali Loss: 7.651 Vali Acc: 0.270 Test Loss: 7.651 Test Acc: 0.270
Validation loss decreased (-0.269873 --> -0.269885).  Saving model ...
Epoch: 12 cost time: 5.668612241744995
Epoch: 12, Steps: 17 | Train Loss: 1.383 Vali Loss: 7.689 Vali Acc: 0.255 Test Loss: 7.689 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.577563047409058
Epoch: 13, Steps: 17 | Train Loss: 1.364 Vali Loss: 7.421 Vali Acc: 0.259 Test Loss: 7.421 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.75846529006958
Epoch: 14, Steps: 17 | Train Loss: 1.505 Vali Loss: 9.912 Vali Acc: 0.224 Test Loss: 9.912 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.064563512802124
Epoch: 15, Steps: 17 | Train Loss: 1.252 Vali Loss: 14.221 Vali Acc: 0.243 Test Loss: 14.221 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.9895594120025635
Epoch: 16, Steps: 17 | Train Loss: 1.245 Vali Loss: 15.784 Vali Acc: 0.270 Test Loss: 15.784 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.751903533935547
Epoch: 17, Steps: 17 | Train Loss: 1.458 Vali Loss: 14.378 Vali Acc: 0.266 Test Loss: 14.378 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.944060802459717
Epoch: 18, Steps: 17 | Train Loss: 1.117 Vali Loss: 12.885 Vali Acc: 0.270 Test Loss: 12.885 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.695493221282959
Epoch: 19, Steps: 17 | Train Loss: 1.458 Vali Loss: 15.543 Vali Acc: 0.243 Test Loss: 15.543 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.866466522216797
Epoch: 20, Steps: 17 | Train Loss: 1.581 Vali Loss: 14.406 Vali Acc: 0.270 Test Loss: 14.406 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.19879674911499
Epoch: 21, Steps: 17 | Train Loss: 1.782 Vali Loss: 21.174 Vali Acc: 0.251 Test Loss: 21.174 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 2345732
model size : 13.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.804654836654663
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.216 Vali Acc: 0.240 Test Loss: 2.216 Test Acc: 0.240
Validation loss decreased (inf --> -0.239522).  Saving model ...
Epoch: 2 cost time: 10.721391439437866
Epoch: 2, Steps: 17 | Train Loss: 1.717 Vali Loss: 2.025 Vali Acc: 0.285 Test Loss: 2.025 Test Acc: 0.285
Validation loss decreased (-0.239522 --> -0.285151).  Saving model ...
Epoch: 3 cost time: 10.598373413085938
Epoch: 3, Steps: 17 | Train Loss: 1.524 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.306293725967407
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 2.458 Vali Acc: 0.293 Test Loss: 2.458 Test Acc: 0.293
Validation loss decreased (-0.285151 --> -0.292751).  Saving model ...
Epoch: 5 cost time: 10.813556671142578
Epoch: 5, Steps: 17 | Train Loss: 1.715 Vali Loss: 2.423 Vali Acc: 0.240 Test Loss: 2.423 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.634933233261108
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.770 Vali Acc: 0.262 Test Loss: 2.770 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.059094905853271
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 4.166 Vali Acc: 0.259 Test Loss: 4.166 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.87727665901184
Epoch: 8, Steps: 17 | Train Loss: 1.539 Vali Loss: 4.142 Vali Acc: 0.266 Test Loss: 4.142 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.73070478439331
Epoch: 9, Steps: 17 | Train Loss: 1.238 Vali Loss: 4.415 Vali Acc: 0.236 Test Loss: 4.415 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.47755479812622
Epoch: 10, Steps: 17 | Train Loss: 1.572 Vali Loss: 4.576 Vali Acc: 0.285 Test Loss: 4.576 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.183926820755005
Epoch: 11, Steps: 17 | Train Loss: 1.028 Vali Loss: 4.795 Vali Acc: 0.240 Test Loss: 4.795 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.645373821258545
Epoch: 12, Steps: 17 | Train Loss: 1.099 Vali Loss: 4.192 Vali Acc: 0.251 Test Loss: 4.192 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.893803834915161
Epoch: 13, Steps: 17 | Train Loss: 0.951 Vali Loss: 4.556 Vali Acc: 0.266 Test Loss: 4.556 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.218981266021729
Epoch: 14, Steps: 17 | Train Loss: 1.454 Vali Loss: 7.459 Vali Acc: 0.278 Test Loss: 7.459 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.46486210823059
Epoch: 1, Steps: 17 | Train Loss: 1.642 Vali Loss: 2.301 Vali Acc: 0.243 Test Loss: 2.301 Test Acc: 0.243
Validation loss decreased (inf --> -0.243323).  Saving model ...
Epoch: 2 cost time: 9.15160083770752
Epoch: 2, Steps: 17 | Train Loss: 1.715 Vali Loss: 2.106 Vali Acc: 0.266 Test Loss: 2.106 Test Acc: 0.266
Validation loss decreased (-0.243323 --> -0.266139).  Saving model ...
Epoch: 3 cost time: 8.43252682685852
Epoch: 3, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.952 Vali Acc: 0.289 Test Loss: 1.952 Test Acc: 0.289
Validation loss decreased (-0.266139 --> -0.288954).  Saving model ...
Epoch: 4 cost time: 8.94967007637024
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.160 Vali Acc: 0.270 Test Loss: 2.160 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.77657151222229
Epoch: 5, Steps: 17 | Train Loss: 1.619 Vali Loss: 2.364 Vali Acc: 0.247 Test Loss: 2.364 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.870620489120483
Epoch: 6, Steps: 17 | Train Loss: 1.644 Vali Loss: 4.136 Vali Acc: 0.240 Test Loss: 4.136 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.769416570663452
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 4.379 Vali Acc: 0.240 Test Loss: 4.379 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.274589776992798
Epoch: 8, Steps: 17 | Train Loss: 1.397 Vali Loss: 4.828 Vali Acc: 0.274 Test Loss: 4.828 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.104008197784424
Epoch: 9, Steps: 17 | Train Loss: 1.065 Vali Loss: 5.213 Vali Acc: 0.251 Test Loss: 5.213 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.296568155288696
Epoch: 10, Steps: 17 | Train Loss: 1.549 Vali Loss: 5.383 Vali Acc: 0.255 Test Loss: 5.383 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.32720947265625
Epoch: 11, Steps: 17 | Train Loss: 0.916 Vali Loss: 5.517 Vali Acc: 0.262 Test Loss: 5.517 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.562731504440308
Epoch: 12, Steps: 17 | Train Loss: 0.814 Vali Loss: 6.112 Vali Acc: 0.266 Test Loss: 6.112 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.79456901550293
Epoch: 13, Steps: 17 | Train Loss: 0.832 Vali Loss: 4.985 Vali Acc: 0.247 Test Loss: 4.985 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.052173137664795
Epoch: 1, Steps: 17 | Train Loss: 1.553 Vali Loss: 2.313 Vali Acc: 0.251 Test Loss: 2.313 Test Acc: 0.251
Validation loss decreased (inf --> -0.250927).  Saving model ...
Epoch: 2 cost time: 7.050781965255737
Epoch: 2, Steps: 17 | Train Loss: 1.683 Vali Loss: 2.025 Vali Acc: 0.232 Test Loss: 2.025 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.291515350341797
Epoch: 3, Steps: 17 | Train Loss: 1.517 Vali Loss: 2.539 Vali Acc: 0.236 Test Loss: 2.539 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.810139179229736
Epoch: 4, Steps: 17 | Train Loss: 1.227 Vali Loss: 3.166 Vali Acc: 0.281 Test Loss: 3.166 Test Acc: 0.281
Validation loss decreased (-0.250927 --> -0.281337).  Saving model ...
Epoch: 5 cost time: 7.872769117355347
Epoch: 5, Steps: 17 | Train Loss: 1.692 Vali Loss: 2.851 Vali Acc: 0.266 Test Loss: 2.851 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.783889293670654
Epoch: 6, Steps: 17 | Train Loss: 1.593 Vali Loss: 4.988 Vali Acc: 0.221 Test Loss: 4.988 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.706047058105469
Epoch: 7, Steps: 17 | Train Loss: 1.670 Vali Loss: 4.788 Vali Acc: 0.228 Test Loss: 4.788 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.143792152404785
Epoch: 8, Steps: 17 | Train Loss: 1.774 Vali Loss: 9.679 Vali Acc: 0.259 Test Loss: 9.679 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.53706955909729
Epoch: 9, Steps: 17 | Train Loss: 1.872 Vali Loss: 4.326 Vali Acc: 0.255 Test Loss: 4.326 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.40775990486145
Epoch: 10, Steps: 17 | Train Loss: 1.169 Vali Loss: 6.566 Vali Acc: 0.262 Test Loss: 6.566 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.171722173690796
Epoch: 11, Steps: 17 | Train Loss: 0.899 Vali Loss: 5.805 Vali Acc: 0.243 Test Loss: 5.805 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.29197359085083
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 6.338 Vali Acc: 0.270 Test Loss: 6.338 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.693612337112427
Epoch: 13, Steps: 17 | Train Loss: 0.956 Vali Loss: 9.494 Vali Acc: 0.247 Test Loss: 9.494 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.4535040855407715
Epoch: 14, Steps: 17 | Train Loss: 1.115 Vali Loss: 6.478 Vali Acc: 0.266 Test Loss: 6.478 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.48164701461792
Epoch: 1, Steps: 17 | Train Loss: 1.553 Vali Loss: 2.425 Vali Acc: 0.213 Test Loss: 2.425 Test Acc: 0.213
Validation loss decreased (inf --> -0.212904).  Saving model ...
Epoch: 2 cost time: 7.389889717102051
Epoch: 2, Steps: 17 | Train Loss: 1.580 Vali Loss: 2.155 Vali Acc: 0.236 Test Loss: 2.155 Test Acc: 0.236
Validation loss decreased (-0.212904 --> -0.235720).  Saving model ...
Epoch: 3 cost time: 6.678427457809448
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 3.642 Vali Acc: 0.232 Test Loss: 3.642 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.001617193222046
Epoch: 4, Steps: 17 | Train Loss: 1.205 Vali Loss: 2.980 Vali Acc: 0.255 Test Loss: 2.980 Test Acc: 0.255
Validation loss decreased (-0.235720 --> -0.254723).  Saving model ...
Epoch: 5 cost time: 7.27328896522522
Epoch: 5, Steps: 17 | Train Loss: 1.259 Vali Loss: 3.208 Vali Acc: 0.247 Test Loss: 3.208 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.85967230796814
Epoch: 6, Steps: 17 | Train Loss: 1.174 Vali Loss: 4.476 Vali Acc: 0.262 Test Loss: 4.476 Test Acc: 0.262
Validation loss decreased (-0.254723 --> -0.262313).  Saving model ...
Epoch: 7 cost time: 6.727265357971191
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 5.939 Vali Acc: 0.243 Test Loss: 5.939 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.967067718505859
Epoch: 8, Steps: 17 | Train Loss: 1.103 Vali Loss: 7.020 Vali Acc: 0.251 Test Loss: 7.020 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.013618469238281
Epoch: 9, Steps: 17 | Train Loss: 1.179 Vali Loss: 5.686 Vali Acc: 0.262 Test Loss: 5.686 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.551229000091553
Epoch: 10, Steps: 17 | Train Loss: 0.801 Vali Loss: 6.727 Vali Acc: 0.259 Test Loss: 6.727 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.437192440032959
Epoch: 11, Steps: 17 | Train Loss: 0.813 Vali Loss: 7.461 Vali Acc: 0.255 Test Loss: 7.461 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.661196947097778
Epoch: 12, Steps: 17 | Train Loss: 0.859 Vali Loss: 7.323 Vali Acc: 0.274 Test Loss: 7.323 Test Acc: 0.274
Validation loss decreased (-0.262313 --> -0.273691).  Saving model ...
Epoch: 13 cost time: 6.864625453948975
Epoch: 13, Steps: 17 | Train Loss: 1.057 Vali Loss: 7.841 Vali Acc: 0.262 Test Loss: 7.841 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.8260111808776855
Epoch: 14, Steps: 17 | Train Loss: 1.082 Vali Loss: 10.058 Vali Acc: 0.281 Test Loss: 10.058 Test Acc: 0.281
Validation loss decreased (-0.273691 --> -0.281268).  Saving model ...
Epoch: 15 cost time: 6.507540225982666
Epoch: 15, Steps: 17 | Train Loss: 0.498 Vali Loss: 9.289 Vali Acc: 0.232 Test Loss: 9.289 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.953389644622803
Epoch: 16, Steps: 17 | Train Loss: 0.589 Vali Loss: 10.219 Vali Acc: 0.278 Test Loss: 10.219 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.895818710327148
Epoch: 17, Steps: 17 | Train Loss: 0.751 Vali Loss: 9.284 Vali Acc: 0.274 Test Loss: 9.284 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.700099945068359
Epoch: 18, Steps: 17 | Train Loss: 0.727 Vali Loss: 13.115 Vali Acc: 0.255 Test Loss: 13.115 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.810476303100586
Epoch: 19, Steps: 17 | Train Loss: 0.518 Vali Loss: 15.957 Vali Acc: 0.251 Test Loss: 15.957 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.07483434677124
Epoch: 20, Steps: 17 | Train Loss: 0.739 Vali Loss: 12.698 Vali Acc: 0.255 Test Loss: 12.698 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.314147710800171
Epoch: 21, Steps: 17 | Train Loss: 0.639 Vali Loss: 13.788 Vali Acc: 0.221 Test Loss: 13.788 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.701687812805176
Epoch: 22, Steps: 17 | Train Loss: 0.588 Vali Loss: 16.043 Vali Acc: 0.243 Test Loss: 16.043 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.932332277297974
Epoch: 23, Steps: 17 | Train Loss: 0.474 Vali Loss: 11.717 Vali Acc: 0.259 Test Loss: 11.717 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.336084604263306
Epoch: 24, Steps: 17 | Train Loss: 1.014 Vali Loss: 20.048 Vali Acc: 0.259 Test Loss: 20.048 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.797591209411621
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 2.432 Vali Acc: 0.247 Test Loss: 2.432 Test Acc: 0.247
Validation loss decreased (inf --> -0.247124).  Saving model ...
Epoch: 2 cost time: 6.467554807662964
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.945 Vali Acc: 0.278 Test Loss: 1.945 Test Acc: 0.278
Validation loss decreased (-0.247124 --> -0.277547).  Saving model ...
Epoch: 3 cost time: 6.017611503601074
Epoch: 3, Steps: 17 | Train Loss: 1.403 Vali Loss: 3.695 Vali Acc: 0.266 Test Loss: 3.695 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.346630096435547
Epoch: 4, Steps: 17 | Train Loss: 1.247 Vali Loss: 3.348 Vali Acc: 0.251 Test Loss: 3.348 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.158167600631714
Epoch: 5, Steps: 17 | Train Loss: 1.250 Vali Loss: 3.153 Vali Acc: 0.262 Test Loss: 3.153 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.891198635101318
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 4.854 Vali Acc: 0.278 Test Loss: 4.854 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.245179891586304
Epoch: 7, Steps: 17 | Train Loss: 1.490 Vali Loss: 7.316 Vali Acc: 0.259 Test Loss: 7.316 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.459838628768921
Epoch: 8, Steps: 17 | Train Loss: 1.489 Vali Loss: 4.938 Vali Acc: 0.270 Test Loss: 4.938 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.203222036361694
Epoch: 9, Steps: 17 | Train Loss: 1.393 Vali Loss: 7.366 Vali Acc: 0.289 Test Loss: 7.366 Test Acc: 0.289
Validation loss decreased (-0.277547 --> -0.288900).  Saving model ...
Epoch: 10 cost time: 6.19863224029541
Epoch: 10, Steps: 17 | Train Loss: 1.465 Vali Loss: 5.736 Vali Acc: 0.289 Test Loss: 5.736 Test Acc: 0.289
Validation loss decreased (-0.288900 --> -0.288916).  Saving model ...
Epoch: 11 cost time: 5.960455894470215
Epoch: 11, Steps: 17 | Train Loss: 1.250 Vali Loss: 12.591 Vali Acc: 0.266 Test Loss: 12.591 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.0448126792907715
Epoch: 12, Steps: 17 | Train Loss: 0.806 Vali Loss: 12.936 Vali Acc: 0.285 Test Loss: 12.936 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.1988303661346436
Epoch: 13, Steps: 17 | Train Loss: 0.768 Vali Loss: 10.231 Vali Acc: 0.297 Test Loss: 10.231 Test Acc: 0.297
Validation loss decreased (-0.288916 --> -0.296476).  Saving model ...
Epoch: 14 cost time: 6.063508749008179
Epoch: 14, Steps: 17 | Train Loss: 1.058 Vali Loss: 12.089 Vali Acc: 0.316 Test Loss: 12.089 Test Acc: 0.316
Validation loss decreased (-0.296476 --> -0.315468).  Saving model ...
Epoch: 15 cost time: 6.16594123840332
Epoch: 15, Steps: 17 | Train Loss: 0.704 Vali Loss: 11.268 Vali Acc: 0.266 Test Loss: 11.268 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.263818025588989
Epoch: 16, Steps: 17 | Train Loss: 0.573 Vali Loss: 11.524 Vali Acc: 0.270 Test Loss: 11.524 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.954103946685791
Epoch: 17, Steps: 17 | Train Loss: 0.454 Vali Loss: 12.259 Vali Acc: 0.289 Test Loss: 12.259 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.768711805343628
Epoch: 18, Steps: 17 | Train Loss: 0.613 Vali Loss: 9.760 Vali Acc: 0.270 Test Loss: 9.760 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.338748216629028
Epoch: 19, Steps: 17 | Train Loss: 1.046 Vali Loss: 12.090 Vali Acc: 0.270 Test Loss: 12.090 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.912501096725464
Epoch: 20, Steps: 17 | Train Loss: 0.972 Vali Loss: 16.051 Vali Acc: 0.255 Test Loss: 16.051 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.288530111312866
Epoch: 21, Steps: 17 | Train Loss: 1.574 Vali Loss: 13.982 Vali Acc: 0.278 Test Loss: 13.982 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.2766711711883545
Epoch: 22, Steps: 17 | Train Loss: 0.653 Vali Loss: 12.711 Vali Acc: 0.255 Test Loss: 12.711 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.140328884124756
Epoch: 23, Steps: 17 | Train Loss: 0.424 Vali Loss: 14.073 Vali Acc: 0.323 Test Loss: 14.073 Test Acc: 0.323
Validation loss decreased (-0.315468 --> -0.323053).  Saving model ...
Epoch: 24 cost time: 6.386200904846191
Epoch: 24, Steps: 17 | Train Loss: 0.654 Vali Loss: 18.688 Vali Acc: 0.278 Test Loss: 18.688 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.218280553817749
Epoch: 25, Steps: 17 | Train Loss: 0.759 Vali Loss: 18.598 Vali Acc: 0.274 Test Loss: 18.598 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.278085708618164
Epoch: 26, Steps: 17 | Train Loss: 0.527 Vali Loss: 17.456 Vali Acc: 0.247 Test Loss: 17.456 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.383546590805054
Epoch: 27, Steps: 17 | Train Loss: 0.606 Vali Loss: 16.238 Vali Acc: 0.262 Test Loss: 16.238 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.2951579093933105
Epoch: 28, Steps: 17 | Train Loss: 0.217 Vali Loss: 19.051 Vali Acc: 0.274 Test Loss: 19.051 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.273053407669067
Epoch: 29, Steps: 17 | Train Loss: 0.471 Vali Loss: 20.515 Vali Acc: 0.297 Test Loss: 20.515 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.883923053741455
Epoch: 30, Steps: 17 | Train Loss: 0.490 Vali Loss: 19.290 Vali Acc: 0.281 Test Loss: 19.290 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.146528005599976
Epoch: 31, Steps: 17 | Train Loss: 0.666 Vali Loss: 17.988 Vali Acc: 0.281 Test Loss: 17.988 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.744354009628296
Epoch: 32, Steps: 17 | Train Loss: 0.612 Vali Loss: 19.933 Vali Acc: 0.285 Test Loss: 19.933 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.598966360092163
Epoch: 33, Steps: 17 | Train Loss: 0.615 Vali Loss: 24.394 Vali Acc: 0.266 Test Loss: 24.394 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.382762432098389
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 2.349 Vali Acc: 0.255 Test Loss: 2.349 Test Acc: 0.255
Validation loss decreased (inf --> -0.254729).  Saving model ...
Epoch: 2 cost time: 6.028948068618774
Epoch: 2, Steps: 17 | Train Loss: 1.551 Vali Loss: 2.314 Vali Acc: 0.274 Test Loss: 2.314 Test Acc: 0.274
Validation loss decreased (-0.254729 --> -0.273741).  Saving model ...
Epoch: 3 cost time: 5.82526421546936
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 4.227 Vali Acc: 0.266 Test Loss: 4.227 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.9017767906188965
Epoch: 4, Steps: 17 | Train Loss: 1.366 Vali Loss: 2.785 Vali Acc: 0.270 Test Loss: 2.785 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.711696624755859
Epoch: 5, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.900 Vali Acc: 0.262 Test Loss: 2.900 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.606639385223389
Epoch: 6, Steps: 17 | Train Loss: 1.329 Vali Loss: 5.611 Vali Acc: 0.293 Test Loss: 5.611 Test Acc: 0.293
Validation loss decreased (-0.273741 --> -0.292720).  Saving model ...
Epoch: 7 cost time: 5.608956575393677
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 4.972 Vali Acc: 0.243 Test Loss: 4.972 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.281111240386963
Epoch: 8, Steps: 17 | Train Loss: 1.054 Vali Loss: 6.755 Vali Acc: 0.247 Test Loss: 6.755 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.140878438949585
Epoch: 9, Steps: 17 | Train Loss: 0.933 Vali Loss: 5.957 Vali Acc: 0.251 Test Loss: 5.957 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.0329508781433105
Epoch: 10, Steps: 17 | Train Loss: 0.703 Vali Loss: 6.004 Vali Acc: 0.270 Test Loss: 6.004 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.125592470169067
Epoch: 11, Steps: 17 | Train Loss: 0.694 Vali Loss: 5.150 Vali Acc: 0.224 Test Loss: 5.150 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.821105718612671
Epoch: 12, Steps: 17 | Train Loss: 0.628 Vali Loss: 7.200 Vali Acc: 0.243 Test Loss: 7.200 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.873156309127808
Epoch: 13, Steps: 17 | Train Loss: 0.559 Vali Loss: 9.730 Vali Acc: 0.281 Test Loss: 9.730 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.816457986831665
Epoch: 14, Steps: 17 | Train Loss: 1.024 Vali Loss: 8.828 Vali Acc: 0.262 Test Loss: 8.828 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.764854907989502
Epoch: 15, Steps: 17 | Train Loss: 0.596 Vali Loss: 9.515 Vali Acc: 0.240 Test Loss: 9.515 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.751402854919434
Epoch: 16, Steps: 17 | Train Loss: 0.680 Vali Loss: 10.829 Vali Acc: 0.262 Test Loss: 10.829 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.0779287815094
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 2.530 Vali Acc: 0.243 Test Loss: 2.530 Test Acc: 0.243
Validation loss decreased (inf --> -0.243321).  Saving model ...
Epoch: 2 cost time: 5.845049142837524
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 2.490 Vali Acc: 0.274 Test Loss: 2.490 Test Acc: 0.274
Validation loss decreased (-0.243321 --> -0.273739).  Saving model ...
Epoch: 3 cost time: 6.383257865905762
Epoch: 3, Steps: 17 | Train Loss: 1.290 Vali Loss: 3.175 Vali Acc: 0.289 Test Loss: 3.175 Test Acc: 0.289
Validation loss decreased (-0.273739 --> -0.288942).  Saving model ...
Epoch: 4 cost time: 6.151691913604736
Epoch: 4, Steps: 17 | Train Loss: 1.186 Vali Loss: 3.191 Vali Acc: 0.281 Test Loss: 3.191 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.370770215988159
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 2.825 Vali Acc: 0.281 Test Loss: 2.825 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.627403259277344
Epoch: 6, Steps: 17 | Train Loss: 1.166 Vali Loss: 3.858 Vali Acc: 0.255 Test Loss: 3.858 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.238680124282837
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 4.563 Vali Acc: 0.266 Test Loss: 4.563 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.157386779785156
Epoch: 8, Steps: 17 | Train Loss: 0.947 Vali Loss: 6.728 Vali Acc: 0.281 Test Loss: 6.728 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.005122900009155
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 4.702 Vali Acc: 0.278 Test Loss: 4.702 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.992038249969482
Epoch: 10, Steps: 17 | Train Loss: 0.910 Vali Loss: 6.461 Vali Acc: 0.278 Test Loss: 6.461 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.2156195640563965
Epoch: 11, Steps: 17 | Train Loss: 0.745 Vali Loss: 5.472 Vali Acc: 0.255 Test Loss: 5.472 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.3281590938568115
Epoch: 12, Steps: 17 | Train Loss: 0.562 Vali Loss: 7.377 Vali Acc: 0.281 Test Loss: 7.377 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.415360689163208
Epoch: 13, Steps: 17 | Train Loss: 0.798 Vali Loss: 8.239 Vali Acc: 0.259 Test Loss: 8.239 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.94272518157959
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.796 Vali Acc: 0.262 Test Loss: 2.796 Test Acc: 0.262
Validation loss decreased (inf --> -0.262329).  Saving model ...
Epoch: 2 cost time: 5.60827112197876
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 2.709 Vali Acc: 0.266 Test Loss: 2.709 Test Acc: 0.266
Validation loss decreased (-0.262329 --> -0.266133).  Saving model ...
Epoch: 3 cost time: 5.414734363555908
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 4.028 Vali Acc: 0.243 Test Loss: 4.028 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.614398002624512
Epoch: 4, Steps: 17 | Train Loss: 1.207 Vali Loss: 2.561 Vali Acc: 0.247 Test Loss: 2.561 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.0501134395599365
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 3.359 Vali Acc: 0.228 Test Loss: 3.359 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.2254414558410645
Epoch: 6, Steps: 17 | Train Loss: 1.201 Vali Loss: 3.880 Vali Acc: 0.247 Test Loss: 3.880 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.966765403747559
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 5.478 Vali Acc: 0.270 Test Loss: 5.478 Test Acc: 0.270
Validation loss decreased (-0.266133 --> -0.269907).  Saving model ...
Epoch: 8 cost time: 5.513866901397705
Epoch: 8, Steps: 17 | Train Loss: 1.471 Vali Loss: 5.045 Vali Acc: 0.262 Test Loss: 5.045 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.604294776916504
Epoch: 9, Steps: 17 | Train Loss: 0.995 Vali Loss: 3.823 Vali Acc: 0.247 Test Loss: 3.823 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.343622207641602
Epoch: 10, Steps: 17 | Train Loss: 0.819 Vali Loss: 5.090 Vali Acc: 0.251 Test Loss: 5.090 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.248528242111206
Epoch: 11, Steps: 17 | Train Loss: 0.956 Vali Loss: 6.651 Vali Acc: 0.240 Test Loss: 6.651 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.890270948410034
Epoch: 12, Steps: 17 | Train Loss: 0.940 Vali Loss: 6.822 Vali Acc: 0.281 Test Loss: 6.822 Test Acc: 0.281
Validation loss decreased (-0.269907 --> -0.281301).  Saving model ...
Epoch: 13 cost time: 6.0451366901397705
Epoch: 13, Steps: 17 | Train Loss: 0.827 Vali Loss: 9.174 Vali Acc: 0.259 Test Loss: 9.174 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.93117356300354
Epoch: 14, Steps: 17 | Train Loss: 1.772 Vali Loss: 7.434 Vali Acc: 0.240 Test Loss: 7.434 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.250757217407227
Epoch: 15, Steps: 17 | Train Loss: 1.599 Vali Loss: 9.306 Vali Acc: 0.221 Test Loss: 9.306 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.186487436294556
Epoch: 16, Steps: 17 | Train Loss: 0.661 Vali Loss: 9.798 Vali Acc: 0.274 Test Loss: 9.798 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.139223337173462
Epoch: 17, Steps: 17 | Train Loss: 0.546 Vali Loss: 10.178 Vali Acc: 0.240 Test Loss: 10.178 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.718895196914673
Epoch: 18, Steps: 17 | Train Loss: 0.935 Vali Loss: 10.995 Vali Acc: 0.281 Test Loss: 10.995 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.432528972625732
Epoch: 19, Steps: 17 | Train Loss: 1.420 Vali Loss: 12.150 Vali Acc: 0.262 Test Loss: 12.150 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.66732120513916
Epoch: 20, Steps: 17 | Train Loss: 0.695 Vali Loss: 11.061 Vali Acc: 0.224 Test Loss: 11.061 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.660722255706787
Epoch: 21, Steps: 17 | Train Loss: 0.729 Vali Loss: 11.308 Vali Acc: 0.232 Test Loss: 11.308 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.708319902420044
Epoch: 22, Steps: 17 | Train Loss: 1.071 Vali Loss: 13.223 Vali Acc: 0.243 Test Loss: 13.223 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.942323446273804
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 2.535 Vali Acc: 0.262 Test Loss: 2.535 Test Acc: 0.262
Validation loss decreased (inf --> -0.262332).  Saving model ...
Epoch: 2 cost time: 5.521722078323364
Epoch: 2, Steps: 17 | Train Loss: 1.557 Vali Loss: 3.034 Vali Acc: 0.266 Test Loss: 3.034 Test Acc: 0.266
Validation loss decreased (-0.262332 --> -0.266129).  Saving model ...
Epoch: 3 cost time: 5.942865371704102
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 4.799 Vali Acc: 0.243 Test Loss: 4.799 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.982810020446777
Epoch: 4, Steps: 17 | Train Loss: 1.241 Vali Loss: 3.750 Vali Acc: 0.255 Test Loss: 3.750 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.920870065689087
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 3.205 Vali Acc: 0.232 Test Loss: 3.205 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.102682590484619
Epoch: 6, Steps: 17 | Train Loss: 1.301 Vali Loss: 3.981 Vali Acc: 0.270 Test Loss: 3.981 Test Acc: 0.270
Validation loss decreased (-0.266129 --> -0.269922).  Saving model ...
Epoch: 7 cost time: 5.734678030014038
Epoch: 7, Steps: 17 | Train Loss: 1.767 Vali Loss: 4.673 Vali Acc: 0.297 Test Loss: 4.673 Test Acc: 0.297
Validation loss decreased (-0.269922 --> -0.296531).  Saving model ...
Epoch: 8 cost time: 5.517728805541992
Epoch: 8, Steps: 17 | Train Loss: 1.955 Vali Loss: 8.551 Vali Acc: 0.255 Test Loss: 8.551 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.492120742797852
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 4.762 Vali Acc: 0.255 Test Loss: 4.762 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.8493428230285645
Epoch: 10, Steps: 17 | Train Loss: 0.884 Vali Loss: 6.048 Vali Acc: 0.270 Test Loss: 6.048 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.925272464752197
Epoch: 11, Steps: 17 | Train Loss: 1.387 Vali Loss: 9.660 Vali Acc: 0.247 Test Loss: 9.660 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.800374746322632
Epoch: 12, Steps: 17 | Train Loss: 0.992 Vali Loss: 7.988 Vali Acc: 0.281 Test Loss: 7.988 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.0658135414123535
Epoch: 13, Steps: 17 | Train Loss: 1.005 Vali Loss: 8.757 Vali Acc: 0.228 Test Loss: 8.757 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.843096017837524
Epoch: 14, Steps: 17 | Train Loss: 1.505 Vali Loss: 8.653 Vali Acc: 0.243 Test Loss: 8.653 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.581168174743652
Epoch: 15, Steps: 17 | Train Loss: 1.146 Vali Loss: 10.659 Vali Acc: 0.240 Test Loss: 10.659 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.4448065757751465
Epoch: 16, Steps: 17 | Train Loss: 0.881 Vali Loss: 9.527 Vali Acc: 0.297 Test Loss: 9.527 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.643136501312256
Epoch: 17, Steps: 17 | Train Loss: 1.147 Vali Loss: 14.431 Vali Acc: 0.236 Test Loss: 14.431 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.263827323913574
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 2.492 Vali Acc: 0.240 Test Loss: 2.492 Test Acc: 0.240
Validation loss decreased (inf --> -0.239519).  Saving model ...
Epoch: 2 cost time: 5.556991815567017
Epoch: 2, Steps: 17 | Train Loss: 1.610 Vali Loss: 3.352 Vali Acc: 0.205 Test Loss: 3.352 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.411799907684326
Epoch: 3, Steps: 17 | Train Loss: 1.544 Vali Loss: 6.442 Vali Acc: 0.247 Test Loss: 6.442 Test Acc: 0.247
Validation loss decreased (-0.239519 --> -0.247084).  Saving model ...
Epoch: 4 cost time: 5.5032994747161865
Epoch: 4, Steps: 17 | Train Loss: 1.447 Vali Loss: 5.176 Vali Acc: 0.255 Test Loss: 5.176 Test Acc: 0.255
Validation loss decreased (-0.247084 --> -0.254701).  Saving model ...
Epoch: 5 cost time: 5.514263868331909
Epoch: 5, Steps: 17 | Train Loss: 1.533 Vali Loss: 5.058 Vali Acc: 0.221 Test Loss: 5.058 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.842166423797607
Epoch: 6, Steps: 17 | Train Loss: 1.604 Vali Loss: 5.601 Vali Acc: 0.270 Test Loss: 5.601 Test Acc: 0.270
Validation loss decreased (-0.254701 --> -0.269906).  Saving model ...
Epoch: 7 cost time: 5.809080600738525
Epoch: 7, Steps: 17 | Train Loss: 1.817 Vali Loss: 4.600 Vali Acc: 0.262 Test Loss: 4.600 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.756862640380859
Epoch: 8, Steps: 17 | Train Loss: 1.620 Vali Loss: 6.921 Vali Acc: 0.251 Test Loss: 6.921 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.669787645339966
Epoch: 9, Steps: 17 | Train Loss: 1.534 Vali Loss: 5.785 Vali Acc: 0.278 Test Loss: 5.785 Test Acc: 0.278
Validation loss decreased (-0.269906 --> -0.277509).  Saving model ...
Epoch: 10 cost time: 5.570722818374634
Epoch: 10, Steps: 17 | Train Loss: 1.568 Vali Loss: 5.431 Vali Acc: 0.262 Test Loss: 5.431 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.597131967544556
Epoch: 11, Steps: 17 | Train Loss: 1.568 Vali Loss: 6.415 Vali Acc: 0.300 Test Loss: 6.415 Test Acc: 0.300
Validation loss decreased (-0.277509 --> -0.300316).  Saving model ...
Epoch: 12 cost time: 5.649007558822632
Epoch: 12, Steps: 17 | Train Loss: 1.238 Vali Loss: 8.659 Vali Acc: 0.236 Test Loss: 8.659 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.858875036239624
Epoch: 13, Steps: 17 | Train Loss: 1.161 Vali Loss: 7.244 Vali Acc: 0.243 Test Loss: 7.244 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.941716194152832
Epoch: 14, Steps: 17 | Train Loss: 1.817 Vali Loss: 9.832 Vali Acc: 0.285 Test Loss: 9.832 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.7395570278167725
Epoch: 15, Steps: 17 | Train Loss: 1.205 Vali Loss: 10.521 Vali Acc: 0.236 Test Loss: 10.521 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.851076602935791
Epoch: 16, Steps: 17 | Train Loss: 1.026 Vali Loss: 10.038 Vali Acc: 0.278 Test Loss: 10.038 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.543050289154053
Epoch: 17, Steps: 17 | Train Loss: 0.933 Vali Loss: 10.904 Vali Acc: 0.259 Test Loss: 10.904 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.59466290473938
Epoch: 18, Steps: 17 | Train Loss: 1.096 Vali Loss: 12.325 Vali Acc: 0.281 Test Loss: 12.325 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.716094493865967
Epoch: 19, Steps: 17 | Train Loss: 1.044 Vali Loss: 13.170 Vali Acc: 0.259 Test Loss: 13.170 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.862955093383789
Epoch: 20, Steps: 17 | Train Loss: 1.196 Vali Loss: 15.178 Vali Acc: 0.247 Test Loss: 15.178 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.977041482925415
Epoch: 21, Steps: 17 | Train Loss: 1.460 Vali Loss: 13.782 Vali Acc: 0.247 Test Loss: 13.782 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 1952516
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.013812780380249
Epoch: 1, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
Validation loss decreased (inf --> -0.239527).  Saving model ...
Epoch: 2 cost time: 10.424188375473022
Epoch: 2, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.809 Vali Acc: 0.259 Test Loss: 1.809 Test Acc: 0.259
Validation loss decreased (-0.239527 --> -0.258537).  Saving model ...
Epoch: 3 cost time: 10.195389032363892
Epoch: 3, Steps: 17 | Train Loss: 2.107 Vali Loss: 3.046 Vali Acc: 0.243 Test Loss: 3.046 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.1041259765625
Epoch: 4, Steps: 17 | Train Loss: 1.731 Vali Loss: 2.785 Vali Acc: 0.274 Test Loss: 2.785 Test Acc: 0.274
Validation loss decreased (-0.258537 --> -0.273736).  Saving model ...
Epoch: 5 cost time: 9.421599388122559
Epoch: 5, Steps: 17 | Train Loss: 1.788 Vali Loss: 3.383 Vali Acc: 0.274 Test Loss: 3.383 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.440718173980713
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 3.075 Vali Acc: 0.262 Test Loss: 3.075 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.998656034469604
Epoch: 7, Steps: 17 | Train Loss: 1.431 Vali Loss: 2.859 Vali Acc: 0.297 Test Loss: 2.859 Test Acc: 0.297
Validation loss decreased (-0.273736 --> -0.296549).  Saving model ...
Epoch: 8 cost time: 10.25155258178711
Epoch: 8, Steps: 17 | Train Loss: 1.387 Vali Loss: 5.532 Vali Acc: 0.270 Test Loss: 5.532 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.740267753601074
Epoch: 9, Steps: 17 | Train Loss: 0.981 Vali Loss: 3.459 Vali Acc: 0.285 Test Loss: 3.459 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.481778383255005
Epoch: 10, Steps: 17 | Train Loss: 1.084 Vali Loss: 4.808 Vali Acc: 0.262 Test Loss: 4.808 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.82290267944336
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 3.923 Vali Acc: 0.243 Test Loss: 3.923 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.453102827072144
Epoch: 12, Steps: 17 | Train Loss: 0.966 Vali Loss: 5.621 Vali Acc: 0.281 Test Loss: 5.621 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.395442724227905
Epoch: 13, Steps: 17 | Train Loss: 1.450 Vali Loss: 6.035 Vali Acc: 0.274 Test Loss: 6.035 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.483088970184326
Epoch: 14, Steps: 17 | Train Loss: 1.260 Vali Loss: 10.204 Vali Acc: 0.259 Test Loss: 10.204 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.332271575927734
Epoch: 15, Steps: 17 | Train Loss: 1.894 Vali Loss: 6.109 Vali Acc: 0.236 Test Loss: 6.109 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.219499349594116
Epoch: 16, Steps: 17 | Train Loss: 0.951 Vali Loss: 8.804 Vali Acc: 0.278 Test Loss: 8.804 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.820693731307983
Epoch: 17, Steps: 17 | Train Loss: 0.943 Vali Loss: 7.772 Vali Acc: 0.247 Test Loss: 7.772 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.966432094573975
Epoch: 1, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.882 Vali Acc: 0.236 Test Loss: 1.882 Test Acc: 0.236
Validation loss decreased (inf --> -0.235723).  Saving model ...
Epoch: 2 cost time: 9.196022272109985
Epoch: 2, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.777 Vali Acc: 0.270 Test Loss: 1.777 Test Acc: 0.270
Validation loss decreased (-0.235723 --> -0.269944).  Saving model ...
Epoch: 3 cost time: 9.575632333755493
Epoch: 3, Steps: 17 | Train Loss: 2.211 Vali Loss: 3.461 Vali Acc: 0.243 Test Loss: 3.461 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.844821214675903
Epoch: 4, Steps: 17 | Train Loss: 1.750 Vali Loss: 2.760 Vali Acc: 0.262 Test Loss: 2.760 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.136586904525757
Epoch: 5, Steps: 17 | Train Loss: 1.673 Vali Loss: 3.557 Vali Acc: 0.240 Test Loss: 3.557 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.2709379196167
Epoch: 6, Steps: 17 | Train Loss: 2.238 Vali Loss: 4.122 Vali Acc: 0.202 Test Loss: 4.122 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.862940788269043
Epoch: 7, Steps: 17 | Train Loss: 1.522 Vali Loss: 3.748 Vali Acc: 0.251 Test Loss: 3.748 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.620649576187134
Epoch: 8, Steps: 17 | Train Loss: 1.363 Vali Loss: 4.307 Vali Acc: 0.240 Test Loss: 4.307 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.301865816116333
Epoch: 9, Steps: 17 | Train Loss: 1.060 Vali Loss: 4.800 Vali Acc: 0.266 Test Loss: 4.800 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.619902849197388
Epoch: 10, Steps: 17 | Train Loss: 1.206 Vali Loss: 4.848 Vali Acc: 0.251 Test Loss: 4.848 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.022709369659424
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 4.742 Vali Acc: 0.255 Test Loss: 4.742 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.932643413543701
Epoch: 12, Steps: 17 | Train Loss: 1.096 Vali Loss: 7.046 Vali Acc: 0.259 Test Loss: 7.046 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.442935943603516
Epoch: 1, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.570 Vali Acc: 0.224 Test Loss: 1.570 Test Acc: 0.224
Validation loss decreased (inf --> -0.224319).  Saving model ...
Epoch: 2 cost time: 7.76520848274231
Epoch: 2, Steps: 17 | Train Loss: 1.587 Vali Loss: 2.002 Vali Acc: 0.221 Test Loss: 2.002 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.725341081619263
Epoch: 3, Steps: 17 | Train Loss: 2.147 Vali Loss: 3.244 Vali Acc: 0.228 Test Loss: 3.244 Test Acc: 0.228
Validation loss decreased (-0.224319 --> -0.228104).  Saving model ...
Epoch: 4 cost time: 7.274574518203735
Epoch: 4, Steps: 17 | Train Loss: 1.794 Vali Loss: 2.493 Vali Acc: 0.266 Test Loss: 2.493 Test Acc: 0.266
Validation loss decreased (-0.228104 --> -0.266135).  Saving model ...
Epoch: 5 cost time: 7.3040125370025635
Epoch: 5, Steps: 17 | Train Loss: 1.346 Vali Loss: 3.183 Vali Acc: 0.236 Test Loss: 3.183 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.324847221374512
Epoch: 6, Steps: 17 | Train Loss: 1.295 Vali Loss: 3.126 Vali Acc: 0.251 Test Loss: 3.126 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.38542628288269
Epoch: 7, Steps: 17 | Train Loss: 1.487 Vali Loss: 4.780 Vali Acc: 0.232 Test Loss: 4.780 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.208704471588135
Epoch: 8, Steps: 17 | Train Loss: 1.111 Vali Loss: 6.655 Vali Acc: 0.259 Test Loss: 6.655 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.614194631576538
Epoch: 9, Steps: 17 | Train Loss: 0.929 Vali Loss: 5.998 Vali Acc: 0.255 Test Loss: 5.998 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.16138744354248
Epoch: 10, Steps: 17 | Train Loss: 0.836 Vali Loss: 5.424 Vali Acc: 0.247 Test Loss: 5.424 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.007298231124878
Epoch: 11, Steps: 17 | Train Loss: 1.285 Vali Loss: 5.131 Vali Acc: 0.255 Test Loss: 5.131 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.716692924499512
Epoch: 12, Steps: 17 | Train Loss: 1.315 Vali Loss: 12.706 Vali Acc: 0.247 Test Loss: 12.706 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.021669387817383
Epoch: 13, Steps: 17 | Train Loss: 1.961 Vali Loss: 7.864 Vali Acc: 0.255 Test Loss: 7.864 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.893697261810303
Epoch: 14, Steps: 17 | Train Loss: 1.638 Vali Loss: 7.350 Vali Acc: 0.251 Test Loss: 7.350 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.704334497451782
Epoch: 1, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.765 Vali Acc: 0.232 Test Loss: 1.765 Test Acc: 0.232
Validation loss decreased (inf --> -0.231922).  Saving model ...
Epoch: 2 cost time: 6.4751136302948
Epoch: 2, Steps: 17 | Train Loss: 1.728 Vali Loss: 2.698 Vali Acc: 0.274 Test Loss: 2.698 Test Acc: 0.274
Validation loss decreased (-0.231922 --> -0.273737).  Saving model ...
Epoch: 3 cost time: 6.416834831237793
Epoch: 3, Steps: 17 | Train Loss: 1.799 Vali Loss: 3.219 Vali Acc: 0.243 Test Loss: 3.219 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.48687219619751
Epoch: 4, Steps: 17 | Train Loss: 1.490 Vali Loss: 3.269 Vali Acc: 0.213 Test Loss: 3.269 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.482501983642578
Epoch: 5, Steps: 17 | Train Loss: 1.490 Vali Loss: 4.571 Vali Acc: 0.240 Test Loss: 4.571 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.921117782592773
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 3.985 Vali Acc: 0.240 Test Loss: 3.985 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.801899433135986
Epoch: 7, Steps: 17 | Train Loss: 1.189 Vali Loss: 4.278 Vali Acc: 0.255 Test Loss: 4.278 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.579060792922974
Epoch: 8, Steps: 17 | Train Loss: 1.014 Vali Loss: 5.511 Vali Acc: 0.259 Test Loss: 5.511 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.8247740268707275
Epoch: 9, Steps: 17 | Train Loss: 0.655 Vali Loss: 5.811 Vali Acc: 0.243 Test Loss: 5.811 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.211182117462158
Epoch: 10, Steps: 17 | Train Loss: 0.971 Vali Loss: 7.251 Vali Acc: 0.278 Test Loss: 7.251 Test Acc: 0.278
Validation loss decreased (-0.273737 --> -0.277494).  Saving model ...
Epoch: 11 cost time: 6.77170205116272
Epoch: 11, Steps: 17 | Train Loss: 1.410 Vali Loss: 5.483 Vali Acc: 0.259 Test Loss: 5.483 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.685174465179443
Epoch: 12, Steps: 17 | Train Loss: 1.528 Vali Loss: 11.744 Vali Acc: 0.262 Test Loss: 11.744 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.735604286193848
Epoch: 13, Steps: 17 | Train Loss: 1.201 Vali Loss: 7.053 Vali Acc: 0.262 Test Loss: 7.053 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.160943269729614
Epoch: 14, Steps: 17 | Train Loss: 0.736 Vali Loss: 8.184 Vali Acc: 0.270 Test Loss: 8.184 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.802386283874512
Epoch: 15, Steps: 17 | Train Loss: 0.918 Vali Loss: 9.507 Vali Acc: 0.262 Test Loss: 9.507 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.014361619949341
Epoch: 16, Steps: 17 | Train Loss: 1.256 Vali Loss: 9.818 Vali Acc: 0.251 Test Loss: 9.818 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.7569591999053955
Epoch: 17, Steps: 17 | Train Loss: 1.420 Vali Loss: 15.558 Vali Acc: 0.228 Test Loss: 15.558 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.672502040863037
Epoch: 18, Steps: 17 | Train Loss: 1.222 Vali Loss: 10.420 Vali Acc: 0.243 Test Loss: 10.420 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.605543375015259
Epoch: 19, Steps: 17 | Train Loss: 1.444 Vali Loss: 10.427 Vali Acc: 0.232 Test Loss: 10.427 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.499805927276611
Epoch: 20, Steps: 17 | Train Loss: 0.927 Vali Loss: 16.205 Vali Acc: 0.274 Test Loss: 16.205 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.824449062347412
Epoch: 1, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
Validation loss decreased (inf --> -0.262341).  Saving model ...
Epoch: 2 cost time: 6.299758434295654
Epoch: 2, Steps: 17 | Train Loss: 1.551 Vali Loss: 2.486 Vali Acc: 0.285 Test Loss: 2.486 Test Acc: 0.285
Validation loss decreased (-0.262341 --> -0.285146).  Saving model ...
Epoch: 3 cost time: 6.324984073638916
Epoch: 3, Steps: 17 | Train Loss: 1.611 Vali Loss: 2.840 Vali Acc: 0.262 Test Loss: 2.840 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.998058080673218
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 2.771 Vali Acc: 0.251 Test Loss: 2.771 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.106611251831055
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 5.297 Vali Acc: 0.262 Test Loss: 5.297 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.712342023849487
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 3.839 Vali Acc: 0.259 Test Loss: 3.839 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.148380994796753
Epoch: 7, Steps: 17 | Train Loss: 1.029 Vali Loss: 4.959 Vali Acc: 0.300 Test Loss: 4.959 Test Acc: 0.300
Validation loss decreased (-0.285146 --> -0.300331).  Saving model ...
Epoch: 8 cost time: 6.378159761428833
Epoch: 8, Steps: 17 | Train Loss: 0.788 Vali Loss: 5.976 Vali Acc: 0.281 Test Loss: 5.976 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.881584644317627
Epoch: 9, Steps: 17 | Train Loss: 0.735 Vali Loss: 7.970 Vali Acc: 0.274 Test Loss: 7.970 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.9377148151397705
Epoch: 10, Steps: 17 | Train Loss: 1.157 Vali Loss: 7.037 Vali Acc: 0.300 Test Loss: 7.037 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.74878191947937
Epoch: 11, Steps: 17 | Train Loss: 1.595 Vali Loss: 6.319 Vali Acc: 0.289 Test Loss: 6.319 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.4046337604522705
Epoch: 12, Steps: 17 | Train Loss: 0.970 Vali Loss: 11.663 Vali Acc: 0.274 Test Loss: 11.663 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.0729334354400635
Epoch: 13, Steps: 17 | Train Loss: 0.940 Vali Loss: 6.761 Vali Acc: 0.259 Test Loss: 6.761 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.107311487197876
Epoch: 14, Steps: 17 | Train Loss: 1.157 Vali Loss: 9.642 Vali Acc: 0.259 Test Loss: 9.642 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.822660446166992
Epoch: 15, Steps: 17 | Train Loss: 1.048 Vali Loss: 9.263 Vali Acc: 0.304 Test Loss: 9.263 Test Acc: 0.304
Validation loss decreased (-0.300331 --> -0.304090).  Saving model ...
Epoch: 16 cost time: 6.038252353668213
Epoch: 16, Steps: 17 | Train Loss: 1.189 Vali Loss: 12.321 Vali Acc: 0.266 Test Loss: 12.321 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.205418586730957
Epoch: 17, Steps: 17 | Train Loss: 0.842 Vali Loss: 12.824 Vali Acc: 0.259 Test Loss: 12.824 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.231492042541504
Epoch: 18, Steps: 17 | Train Loss: 0.662 Vali Loss: 11.913 Vali Acc: 0.270 Test Loss: 11.913 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.347196817398071
Epoch: 19, Steps: 17 | Train Loss: 0.667 Vali Loss: 11.906 Vali Acc: 0.270 Test Loss: 11.906 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.41181206703186
Epoch: 20, Steps: 17 | Train Loss: 0.576 Vali Loss: 12.962 Vali Acc: 0.274 Test Loss: 12.962 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.427837610244751
Epoch: 21, Steps: 17 | Train Loss: 0.652 Vali Loss: 12.203 Vali Acc: 0.289 Test Loss: 12.203 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.202401161193848
Epoch: 22, Steps: 17 | Train Loss: 0.674 Vali Loss: 12.735 Vali Acc: 0.247 Test Loss: 12.735 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.057823181152344
Epoch: 23, Steps: 17 | Train Loss: 1.152 Vali Loss: 15.206 Vali Acc: 0.270 Test Loss: 15.206 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.137285470962524
Epoch: 24, Steps: 17 | Train Loss: 0.405 Vali Loss: 15.651 Vali Acc: 0.251 Test Loss: 15.651 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.812805891036987
Epoch: 25, Steps: 17 | Train Loss: 0.475 Vali Loss: 13.049 Vali Acc: 0.266 Test Loss: 13.049 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.801398277282715
Epoch: 1, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.545 Vali Acc: 0.274 Test Loss: 1.545 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 5.805044174194336
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 2.644 Vali Acc: 0.236 Test Loss: 2.644 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.195166349411011
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 2.691 Vali Acc: 0.274 Test Loss: 2.691 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.498813152313232
Epoch: 4, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.617 Vali Acc: 0.281 Test Loss: 2.617 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281343).  Saving model ...
Epoch: 5 cost time: 6.150331735610962
Epoch: 5, Steps: 17 | Train Loss: 1.351 Vali Loss: 4.544 Vali Acc: 0.243 Test Loss: 4.544 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.936722993850708
Epoch: 6, Steps: 17 | Train Loss: 1.326 Vali Loss: 3.670 Vali Acc: 0.262 Test Loss: 3.670 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0469911098480225
Epoch: 7, Steps: 17 | Train Loss: 0.966 Vali Loss: 4.321 Vali Acc: 0.285 Test Loss: 4.321 Test Acc: 0.285
Validation loss decreased (-0.281343 --> -0.285128).  Saving model ...
Epoch: 8 cost time: 5.832263946533203
Epoch: 8, Steps: 17 | Train Loss: 0.872 Vali Loss: 5.069 Vali Acc: 0.251 Test Loss: 5.069 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.08216404914856
Epoch: 9, Steps: 17 | Train Loss: 0.694 Vali Loss: 5.586 Vali Acc: 0.232 Test Loss: 5.586 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.904806852340698
Epoch: 10, Steps: 17 | Train Loss: 0.764 Vali Loss: 6.446 Vali Acc: 0.228 Test Loss: 6.446 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.246770620346069
Epoch: 11, Steps: 17 | Train Loss: 0.978 Vali Loss: 6.140 Vali Acc: 0.228 Test Loss: 6.140 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.58486008644104
Epoch: 12, Steps: 17 | Train Loss: 1.015 Vali Loss: 7.464 Vali Acc: 0.243 Test Loss: 7.464 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.6573567390441895
Epoch: 13, Steps: 17 | Train Loss: 0.620 Vali Loss: 7.286 Vali Acc: 0.209 Test Loss: 7.286 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.96663236618042
Epoch: 14, Steps: 17 | Train Loss: 0.510 Vali Loss: 8.884 Vali Acc: 0.217 Test Loss: 8.884 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.741340637207031
Epoch: 15, Steps: 17 | Train Loss: 0.525 Vali Loss: 8.842 Vali Acc: 0.262 Test Loss: 8.842 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.960845470428467
Epoch: 16, Steps: 17 | Train Loss: 0.441 Vali Loss: 9.483 Vali Acc: 0.224 Test Loss: 9.483 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.311445236206055
Epoch: 17, Steps: 17 | Train Loss: 0.771 Vali Loss: 15.064 Vali Acc: 0.236 Test Loss: 15.064 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.590376853942871
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 5.551162004470825
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 3.069 Vali Acc: 0.274 Test Loss: 3.069 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273734).  Saving model ...
Epoch: 3 cost time: 5.440134525299072
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 2.903 Vali Acc: 0.262 Test Loss: 2.903 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.467917442321777
Epoch: 4, Steps: 17 | Train Loss: 1.503 Vali Loss: 2.536 Vali Acc: 0.259 Test Loss: 2.536 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.786052942276001
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 4.789 Vali Acc: 0.259 Test Loss: 4.789 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.989861726760864
Epoch: 6, Steps: 17 | Train Loss: 1.462 Vali Loss: 4.699 Vali Acc: 0.224 Test Loss: 4.699 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.432697534561157
Epoch: 7, Steps: 17 | Train Loss: 1.049 Vali Loss: 5.163 Vali Acc: 0.278 Test Loss: 5.163 Test Acc: 0.278
Validation loss decreased (-0.273734 --> -0.277515).  Saving model ...
Epoch: 8 cost time: 5.965529680252075
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 6.490 Vali Acc: 0.278 Test Loss: 6.490 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.8777077198028564
Epoch: 9, Steps: 17 | Train Loss: 1.055 Vali Loss: 4.761 Vali Acc: 0.236 Test Loss: 4.761 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.886280536651611
Epoch: 10, Steps: 17 | Train Loss: 1.004 Vali Loss: 5.384 Vali Acc: 0.243 Test Loss: 5.384 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.448343515396118
Epoch: 11, Steps: 17 | Train Loss: 1.054 Vali Loss: 4.576 Vali Acc: 0.236 Test Loss: 4.576 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.67645001411438
Epoch: 12, Steps: 17 | Train Loss: 1.065 Vali Loss: 6.086 Vali Acc: 0.259 Test Loss: 6.086 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.667008399963379
Epoch: 13, Steps: 17 | Train Loss: 1.000 Vali Loss: 6.759 Vali Acc: 0.262 Test Loss: 6.759 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.461145401000977
Epoch: 14, Steps: 17 | Train Loss: 0.595 Vali Loss: 6.211 Vali Acc: 0.236 Test Loss: 6.211 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.32044243812561
Epoch: 15, Steps: 17 | Train Loss: 0.706 Vali Loss: 7.434 Vali Acc: 0.255 Test Loss: 7.434 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.149580717086792
Epoch: 16, Steps: 17 | Train Loss: 0.876 Vali Loss: 9.163 Vali Acc: 0.255 Test Loss: 9.163 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.390163898468018
Epoch: 17, Steps: 17 | Train Loss: 0.608 Vali Loss: 11.845 Vali Acc: 0.247 Test Loss: 11.845 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.577616930007935
Epoch: 1, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.500 Vali Acc: 0.251 Test Loss: 1.500 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 5.997744560241699
Epoch: 2, Steps: 17 | Train Loss: 1.516 Vali Loss: 2.976 Vali Acc: 0.236 Test Loss: 2.976 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.715683698654175
Epoch: 3, Steps: 17 | Train Loss: 1.624 Vali Loss: 3.087 Vali Acc: 0.259 Test Loss: 3.087 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258524).  Saving model ...
Epoch: 4 cost time: 5.482264041900635
Epoch: 4, Steps: 17 | Train Loss: 1.539 Vali Loss: 2.944 Vali Acc: 0.259 Test Loss: 2.944 Test Acc: 0.259
Validation loss decreased (-0.258524 --> -0.258526).  Saving model ...
Epoch: 5 cost time: 5.170048713684082
Epoch: 5, Steps: 17 | Train Loss: 1.187 Vali Loss: 3.389 Vali Acc: 0.259 Test Loss: 3.389 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.721681118011475
Epoch: 6, Steps: 17 | Train Loss: 1.256 Vali Loss: 4.991 Vali Acc: 0.255 Test Loss: 4.991 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0738525390625
Epoch: 7, Steps: 17 | Train Loss: 1.073 Vali Loss: 4.066 Vali Acc: 0.270 Test Loss: 4.066 Test Acc: 0.270
Validation loss decreased (-0.258526 --> -0.269921).  Saving model ...
Epoch: 8 cost time: 6.088430881500244
Epoch: 8, Steps: 17 | Train Loss: 1.200 Vali Loss: 6.604 Vali Acc: 0.262 Test Loss: 6.604 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.080687999725342
Epoch: 9, Steps: 17 | Train Loss: 1.011 Vali Loss: 4.508 Vali Acc: 0.262 Test Loss: 4.508 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.863677740097046
Epoch: 10, Steps: 17 | Train Loss: 1.053 Vali Loss: 5.265 Vali Acc: 0.240 Test Loss: 5.265 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.801773548126221
Epoch: 11, Steps: 17 | Train Loss: 1.564 Vali Loss: 5.411 Vali Acc: 0.262 Test Loss: 5.411 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.125870227813721
Epoch: 12, Steps: 17 | Train Loss: 1.308 Vali Loss: 5.726 Vali Acc: 0.251 Test Loss: 5.726 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.800538063049316
Epoch: 13, Steps: 17 | Train Loss: 0.869 Vali Loss: 5.825 Vali Acc: 0.259 Test Loss: 5.825 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.261523008346558
Epoch: 14, Steps: 17 | Train Loss: 0.576 Vali Loss: 7.445 Vali Acc: 0.247 Test Loss: 7.445 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.388250827789307
Epoch: 15, Steps: 17 | Train Loss: 0.829 Vali Loss: 9.971 Vali Acc: 0.255 Test Loss: 9.971 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.6818530559539795
Epoch: 16, Steps: 17 | Train Loss: 1.251 Vali Loss: 8.511 Vali Acc: 0.228 Test Loss: 8.511 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.71793270111084
Epoch: 17, Steps: 17 | Train Loss: 0.557 Vali Loss: 11.518 Vali Acc: 0.259 Test Loss: 11.518 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.9233317375183105
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.506 Vali Acc: 0.228 Test Loss: 1.506 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 5.935567617416382
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 3.318 Vali Acc: 0.240 Test Loss: 3.318 Test Acc: 0.240
Validation loss decreased (-0.228122 --> -0.239511).  Saving model ...
Epoch: 3 cost time: 6.16097092628479
Epoch: 3, Steps: 17 | Train Loss: 1.654 Vali Loss: 4.023 Vali Acc: 0.259 Test Loss: 4.023 Test Acc: 0.259
Validation loss decreased (-0.239511 --> -0.258515).  Saving model ...
Epoch: 4 cost time: 6.5851523876190186
Epoch: 4, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.678 Vali Acc: 0.202 Test Loss: 2.678 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.878942966461182
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 4.129 Vali Acc: 0.259 Test Loss: 4.129 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.298689365386963
Epoch: 6, Steps: 17 | Train Loss: 1.485 Vali Loss: 6.665 Vali Acc: 0.259 Test Loss: 6.665 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.820343255996704
Epoch: 7, Steps: 17 | Train Loss: 1.137 Vali Loss: 5.787 Vali Acc: 0.251 Test Loss: 5.787 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.126600027084351
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 5.647 Vali Acc: 0.278 Test Loss: 5.647 Test Acc: 0.278
Validation loss decreased (-0.258515 --> -0.277510).  Saving model ...
Epoch: 9 cost time: 6.266172647476196
Epoch: 9, Steps: 17 | Train Loss: 1.003 Vali Loss: 6.205 Vali Acc: 0.274 Test Loss: 6.205 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.126438617706299
Epoch: 10, Steps: 17 | Train Loss: 1.133 Vali Loss: 8.203 Vali Acc: 0.259 Test Loss: 8.203 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.839970111846924
Epoch: 11, Steps: 17 | Train Loss: 1.082 Vali Loss: 6.349 Vali Acc: 0.236 Test Loss: 6.349 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.5961754322052
Epoch: 12, Steps: 17 | Train Loss: 1.314 Vali Loss: 9.951 Vali Acc: 0.259 Test Loss: 9.951 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.207620620727539
Epoch: 13, Steps: 17 | Train Loss: 1.007 Vali Loss: 9.134 Vali Acc: 0.270 Test Loss: 9.134 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.1913902759552
Epoch: 14, Steps: 17 | Train Loss: 0.733 Vali Loss: 10.766 Vali Acc: 0.274 Test Loss: 10.766 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.046737432479858
Epoch: 15, Steps: 17 | Train Loss: 1.021 Vali Loss: 9.071 Vali Acc: 0.259 Test Loss: 9.071 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.358850002288818
Epoch: 16, Steps: 17 | Train Loss: 1.119 Vali Loss: 13.107 Vali Acc: 0.262 Test Loss: 13.107 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.821296691894531
Epoch: 17, Steps: 17 | Train Loss: 0.663 Vali Loss: 12.451 Vali Acc: 0.251 Test Loss: 12.451 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.0537731647491455
Epoch: 18, Steps: 17 | Train Loss: 0.756 Vali Loss: 11.098 Vali Acc: 0.281 Test Loss: 11.098 Test Acc: 0.281
Validation loss decreased (-0.277510 --> -0.281258).  Saving model ...
Epoch: 19 cost time: 5.490500211715698
Epoch: 19, Steps: 17 | Train Loss: 0.763 Vali Loss: 12.560 Vali Acc: 0.240 Test Loss: 12.560 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.727243423461914
Epoch: 20, Steps: 17 | Train Loss: 0.853 Vali Loss: 21.348 Vali Acc: 0.259 Test Loss: 21.348 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.692748069763184
Epoch: 21, Steps: 17 | Train Loss: 1.436 Vali Loss: 15.250 Vali Acc: 0.255 Test Loss: 15.250 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.315401554107666
Epoch: 22, Steps: 17 | Train Loss: 1.175 Vali Loss: 16.835 Vali Acc: 0.247 Test Loss: 16.835 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.398272752761841
Epoch: 23, Steps: 17 | Train Loss: 0.789 Vali Loss: 15.806 Vali Acc: 0.217 Test Loss: 15.806 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.909123659133911
Epoch: 24, Steps: 17 | Train Loss: 1.036 Vali Loss: 19.096 Vali Acc: 0.236 Test Loss: 19.096 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.131271123886108
Epoch: 25, Steps: 17 | Train Loss: 0.778 Vali Loss: 18.761 Vali Acc: 0.236 Test Loss: 18.761 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.742305278778076
Epoch: 26, Steps: 17 | Train Loss: 0.702 Vali Loss: 18.131 Vali Acc: 0.259 Test Loss: 18.131 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.554125785827637
Epoch: 27, Steps: 17 | Train Loss: 0.490 Vali Loss: 21.109 Vali Acc: 0.243 Test Loss: 21.109 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.834001302719116
Epoch: 28, Steps: 17 | Train Loss: 0.760 Vali Loss: 17.018 Vali Acc: 0.259 Test Loss: 17.018 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.160409450531006
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 6.236656904220581
Epoch: 2, Steps: 17 | Train Loss: 1.632 Vali Loss: 3.246 Vali Acc: 0.247 Test Loss: 3.246 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.984295606613159
Epoch: 3, Steps: 17 | Train Loss: 1.775 Vali Loss: 4.542 Vali Acc: 0.259 Test Loss: 4.542 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.017559766769409
Epoch: 4, Steps: 17 | Train Loss: 1.733 Vali Loss: 3.862 Vali Acc: 0.224 Test Loss: 3.862 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.8447394371032715
Epoch: 5, Steps: 17 | Train Loss: 1.515 Vali Loss: 5.819 Vali Acc: 0.255 Test Loss: 5.819 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.256373405456543
Epoch: 6, Steps: 17 | Train Loss: 1.743 Vali Loss: 7.661 Vali Acc: 0.259 Test Loss: 7.661 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.303734540939331
Epoch: 7, Steps: 17 | Train Loss: 1.318 Vali Loss: 5.989 Vali Acc: 0.274 Test Loss: 5.989 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273704).  Saving model ...
Epoch: 8 cost time: 6.25293493270874
Epoch: 8, Steps: 17 | Train Loss: 1.206 Vali Loss: 5.795 Vali Acc: 0.270 Test Loss: 5.795 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.291309833526611
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 5.142 Vali Acc: 0.278 Test Loss: 5.142 Test Acc: 0.278
Validation loss decreased (-0.273704 --> -0.277515).  Saving model ...
Epoch: 10 cost time: 5.663917541503906
Epoch: 10, Steps: 17 | Train Loss: 1.596 Vali Loss: 6.695 Vali Acc: 0.270 Test Loss: 6.695 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.5723960399627686
Epoch: 11, Steps: 17 | Train Loss: 1.460 Vali Loss: 7.091 Vali Acc: 0.251 Test Loss: 7.091 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.594001293182373
Epoch: 12, Steps: 17 | Train Loss: 1.732 Vali Loss: 8.878 Vali Acc: 0.240 Test Loss: 8.878 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.0740966796875
Epoch: 13, Steps: 17 | Train Loss: 1.389 Vali Loss: 8.801 Vali Acc: 0.259 Test Loss: 8.801 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.140363931655884
Epoch: 14, Steps: 17 | Train Loss: 1.400 Vali Loss: 9.171 Vali Acc: 0.228 Test Loss: 9.171 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.029810667037964
Epoch: 15, Steps: 17 | Train Loss: 1.565 Vali Loss: 7.415 Vali Acc: 0.266 Test Loss: 7.415 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.817237377166748
Epoch: 16, Steps: 17 | Train Loss: 2.088 Vali Loss: 11.498 Vali Acc: 0.259 Test Loss: 11.498 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.725138425827026
Epoch: 17, Steps: 17 | Train Loss: 1.007 Vali Loss: 9.557 Vali Acc: 0.247 Test Loss: 9.557 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.5277605056762695
Epoch: 18, Steps: 17 | Train Loss: 1.079 Vali Loss: 8.698 Vali Acc: 0.255 Test Loss: 8.698 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.313879489898682
Epoch: 19, Steps: 17 | Train Loss: 0.928 Vali Loss: 9.643 Vali Acc: 0.278 Test Loss: 9.643 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1755908
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.534960269927979
Epoch: 1, Steps: 17 | Train Loss: 1.546 Vali Loss: 2.327 Vali Acc: 0.270 Test Loss: 2.327 Test Acc: 0.270
Validation loss decreased (inf --> -0.269939).  Saving model ...
Epoch: 2 cost time: 10.933557748794556
Epoch: 2, Steps: 17 | Train Loss: 1.683 Vali Loss: 2.150 Vali Acc: 0.259 Test Loss: 2.150 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.90192437171936
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 2.152 Vali Acc: 0.266 Test Loss: 2.152 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.138623476028442
Epoch: 4, Steps: 17 | Train Loss: 1.722 Vali Loss: 2.339 Vali Acc: 0.243 Test Loss: 2.339 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.896590948104858
Epoch: 5, Steps: 17 | Train Loss: 2.174 Vali Loss: 4.268 Vali Acc: 0.262 Test Loss: 4.268 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.992239713668823
Epoch: 6, Steps: 17 | Train Loss: 1.726 Vali Loss: 3.010 Vali Acc: 0.255 Test Loss: 3.010 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.99329686164856
Epoch: 7, Steps: 17 | Train Loss: 1.566 Vali Loss: 3.385 Vali Acc: 0.262 Test Loss: 3.385 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.616896629333496
Epoch: 8, Steps: 17 | Train Loss: 1.950 Vali Loss: 4.284 Vali Acc: 0.251 Test Loss: 4.284 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.913950204849243
Epoch: 9, Steps: 17 | Train Loss: 1.608 Vali Loss: 5.259 Vali Acc: 0.217 Test Loss: 5.259 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.870514631271362
Epoch: 10, Steps: 17 | Train Loss: 1.851 Vali Loss: 9.318 Vali Acc: 0.251 Test Loss: 9.318 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.155275344848633
Epoch: 11, Steps: 17 | Train Loss: 2.540 Vali Loss: 5.816 Vali Acc: 0.236 Test Loss: 5.816 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.547648906707764
Epoch: 1, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.471 Vali Acc: 0.251 Test Loss: 2.471 Test Acc: 0.251
Validation loss decreased (inf --> -0.250926).  Saving model ...
Epoch: 2 cost time: 8.28927993774414
Epoch: 2, Steps: 17 | Train Loss: 1.694 Vali Loss: 2.056 Vali Acc: 0.262 Test Loss: 2.056 Test Acc: 0.262
Validation loss decreased (-0.250926 --> -0.262337).  Saving model ...
Epoch: 3 cost time: 8.374119997024536
Epoch: 3, Steps: 17 | Train Loss: 1.921 Vali Loss: 3.430 Vali Acc: 0.247 Test Loss: 3.430 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.897712230682373
Epoch: 4, Steps: 17 | Train Loss: 2.498 Vali Loss: 3.770 Vali Acc: 0.270 Test Loss: 3.770 Test Acc: 0.270
Validation loss decreased (-0.262337 --> -0.269924).  Saving model ...
Epoch: 5 cost time: 8.71270489692688
Epoch: 5, Steps: 17 | Train Loss: 2.355 Vali Loss: 3.674 Vali Acc: 0.274 Test Loss: 3.674 Test Acc: 0.274
Validation loss decreased (-0.269924 --> -0.273728).  Saving model ...
Epoch: 6 cost time: 8.58959412574768
Epoch: 6, Steps: 17 | Train Loss: 1.709 Vali Loss: 3.462 Vali Acc: 0.240 Test Loss: 3.462 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.19447374343872
Epoch: 7, Steps: 17 | Train Loss: 1.906 Vali Loss: 6.343 Vali Acc: 0.251 Test Loss: 6.343 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.47651195526123
Epoch: 8, Steps: 17 | Train Loss: 1.667 Vali Loss: 6.880 Vali Acc: 0.285 Test Loss: 6.880 Test Acc: 0.285
Validation loss decreased (-0.273728 --> -0.285102).  Saving model ...
Epoch: 9 cost time: 8.866111755371094
Epoch: 9, Steps: 17 | Train Loss: 2.807 Vali Loss: 7.274 Vali Acc: 0.274 Test Loss: 7.274 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.12186050415039
Epoch: 10, Steps: 17 | Train Loss: 2.594 Vali Loss: 4.253 Vali Acc: 0.259 Test Loss: 4.253 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.601850032806396
Epoch: 11, Steps: 17 | Train Loss: 1.491 Vali Loss: 4.315 Vali Acc: 0.281 Test Loss: 4.315 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.362444639205933
Epoch: 12, Steps: 17 | Train Loss: 1.449 Vali Loss: 5.365 Vali Acc: 0.297 Test Loss: 5.365 Test Acc: 0.297
Validation loss decreased (-0.285102 --> -0.296524).  Saving model ...
Epoch: 13 cost time: 8.578084945678711
Epoch: 13, Steps: 17 | Train Loss: 0.990 Vali Loss: 5.911 Vali Acc: 0.278 Test Loss: 5.911 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.36678147315979
Epoch: 14, Steps: 17 | Train Loss: 1.298 Vali Loss: 6.073 Vali Acc: 0.209 Test Loss: 6.073 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.701860427856445
Epoch: 15, Steps: 17 | Train Loss: 1.857 Vali Loss: 6.682 Vali Acc: 0.281 Test Loss: 6.682 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.337788581848145
Epoch: 16, Steps: 17 | Train Loss: 1.348 Vali Loss: 6.068 Vali Acc: 0.240 Test Loss: 6.068 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.794415712356567
Epoch: 17, Steps: 17 | Train Loss: 1.012 Vali Loss: 11.768 Vali Acc: 0.251 Test Loss: 11.768 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.506190776824951
Epoch: 18, Steps: 17 | Train Loss: 1.520 Vali Loss: 7.704 Vali Acc: 0.247 Test Loss: 7.704 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.737125158309937
Epoch: 19, Steps: 17 | Train Loss: 1.945 Vali Loss: 11.368 Vali Acc: 0.262 Test Loss: 11.368 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.74091911315918
Epoch: 20, Steps: 17 | Train Loss: 1.248 Vali Loss: 7.982 Vali Acc: 0.262 Test Loss: 7.982 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.405526161193848
Epoch: 21, Steps: 17 | Train Loss: 1.356 Vali Loss: 10.787 Vali Acc: 0.243 Test Loss: 10.787 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.4297456741333
Epoch: 22, Steps: 17 | Train Loss: 1.213 Vali Loss: 9.382 Vali Acc: 0.247 Test Loss: 9.382 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.374481678009033
Epoch: 1, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.238 Vali Acc: 0.259 Test Loss: 2.238 Test Acc: 0.259
Validation loss decreased (inf --> -0.258533).  Saving model ...
Epoch: 2 cost time: 6.91999888420105
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 2.128 Vali Acc: 0.255 Test Loss: 2.128 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.235785007476807
Epoch: 3, Steps: 17 | Train Loss: 1.877 Vali Loss: 2.661 Vali Acc: 0.255 Test Loss: 2.661 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.408328533172607
Epoch: 4, Steps: 17 | Train Loss: 2.025 Vali Loss: 4.244 Vali Acc: 0.243 Test Loss: 4.244 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.3647027015686035
Epoch: 5, Steps: 17 | Train Loss: 2.515 Vali Loss: 4.524 Vali Acc: 0.232 Test Loss: 4.524 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.150769233703613
Epoch: 6, Steps: 17 | Train Loss: 1.803 Vali Loss: 4.531 Vali Acc: 0.236 Test Loss: 4.531 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.783610820770264
Epoch: 7, Steps: 17 | Train Loss: 1.633 Vali Loss: 4.207 Vali Acc: 0.221 Test Loss: 4.207 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.369117021560669
Epoch: 8, Steps: 17 | Train Loss: 1.253 Vali Loss: 5.317 Vali Acc: 0.293 Test Loss: 5.317 Test Acc: 0.293
Validation loss decreased (-0.258533 --> -0.292722).  Saving model ...
Epoch: 9 cost time: 7.384717702865601
Epoch: 9, Steps: 17 | Train Loss: 1.403 Vali Loss: 6.493 Vali Acc: 0.236 Test Loss: 6.493 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.263884782791138
Epoch: 10, Steps: 17 | Train Loss: 1.643 Vali Loss: 5.367 Vali Acc: 0.255 Test Loss: 5.367 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.428648948669434
Epoch: 11, Steps: 17 | Train Loss: 1.201 Vali Loss: 6.967 Vali Acc: 0.224 Test Loss: 6.967 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.720651149749756
Epoch: 12, Steps: 17 | Train Loss: 1.050 Vali Loss: 7.459 Vali Acc: 0.240 Test Loss: 7.459 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.384308099746704
Epoch: 13, Steps: 17 | Train Loss: 0.932 Vali Loss: 5.962 Vali Acc: 0.221 Test Loss: 5.962 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.013468980789185
Epoch: 14, Steps: 17 | Train Loss: 1.093 Vali Loss: 8.376 Vali Acc: 0.247 Test Loss: 8.376 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.422569513320923
Epoch: 15, Steps: 17 | Train Loss: 1.125 Vali Loss: 7.974 Vali Acc: 0.251 Test Loss: 7.974 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.811957836151123
Epoch: 16, Steps: 17 | Train Loss: 1.526 Vali Loss: 7.551 Vali Acc: 0.251 Test Loss: 7.551 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.2562572956085205
Epoch: 17, Steps: 17 | Train Loss: 0.730 Vali Loss: 10.385 Vali Acc: 0.259 Test Loss: 10.385 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.731496334075928
Epoch: 18, Steps: 17 | Train Loss: 0.719 Vali Loss: 9.910 Vali Acc: 0.262 Test Loss: 9.910 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.11444616317749
Epoch: 1, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.961 Vali Acc: 0.281 Test Loss: 1.961 Test Acc: 0.281
Validation loss decreased (inf --> -0.281349).  Saving model ...
Epoch: 2 cost time: 6.553760528564453
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 2.004 Vali Acc: 0.224 Test Loss: 2.004 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.592588186264038
Epoch: 3, Steps: 17 | Train Loss: 1.793 Vali Loss: 2.869 Vali Acc: 0.209 Test Loss: 2.869 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.081328392028809
Epoch: 4, Steps: 17 | Train Loss: 1.698 Vali Loss: 4.627 Vali Acc: 0.255 Test Loss: 4.627 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.5662736892700195
Epoch: 5, Steps: 17 | Train Loss: 2.544 Vali Loss: 8.085 Vali Acc: 0.247 Test Loss: 8.085 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.909001588821411
Epoch: 6, Steps: 17 | Train Loss: 1.654 Vali Loss: 3.781 Vali Acc: 0.255 Test Loss: 3.781 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.666343688964844
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 4.746 Vali Acc: 0.259 Test Loss: 4.746 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.552853107452393
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 7.539 Vali Acc: 0.243 Test Loss: 7.539 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.56050443649292
Epoch: 9, Steps: 17 | Train Loss: 1.071 Vali Loss: 5.630 Vali Acc: 0.270 Test Loss: 5.630 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.28948712348938
Epoch: 10, Steps: 17 | Train Loss: 1.153 Vali Loss: 7.785 Vali Acc: 0.266 Test Loss: 7.785 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.480689287185669
Epoch: 11, Steps: 17 | Train Loss: 0.875 Vali Loss: 6.330 Vali Acc: 0.224 Test Loss: 6.330 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.341909170150757
Epoch: 1, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.844 Vali Acc: 0.266 Test Loss: 1.844 Test Acc: 0.266
Validation loss decreased (inf --> -0.266141).  Saving model ...
Epoch: 2 cost time: 6.045564413070679
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 2.235 Vali Acc: 0.243 Test Loss: 2.235 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.973163843154907
Epoch: 3, Steps: 17 | Train Loss: 1.740 Vali Loss: 2.864 Vali Acc: 0.262 Test Loss: 2.864 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.005227088928223
Epoch: 4, Steps: 17 | Train Loss: 1.848 Vali Loss: 3.083 Vali Acc: 0.255 Test Loss: 3.083 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.991545915603638
Epoch: 5, Steps: 17 | Train Loss: 1.927 Vali Loss: 4.999 Vali Acc: 0.259 Test Loss: 4.999 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.329319477081299
Epoch: 6, Steps: 17 | Train Loss: 1.516 Vali Loss: 3.967 Vali Acc: 0.221 Test Loss: 3.967 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.205843448638916
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 4.148 Vali Acc: 0.281 Test Loss: 4.148 Test Acc: 0.281
Validation loss decreased (-0.266141 --> -0.281327).  Saving model ...
Epoch: 8 cost time: 6.616347074508667
Epoch: 8, Steps: 17 | Train Loss: 0.975 Vali Loss: 7.058 Vali Acc: 0.281 Test Loss: 7.058 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.882170677185059
Epoch: 9, Steps: 17 | Train Loss: 0.994 Vali Loss: 5.681 Vali Acc: 0.270 Test Loss: 5.681 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.43947434425354
Epoch: 10, Steps: 17 | Train Loss: 1.110 Vali Loss: 4.821 Vali Acc: 0.255 Test Loss: 4.821 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.32894229888916
Epoch: 11, Steps: 17 | Train Loss: 0.718 Vali Loss: 6.910 Vali Acc: 0.289 Test Loss: 6.910 Test Acc: 0.289
Validation loss decreased (-0.281327 --> -0.288904).  Saving model ...
Epoch: 12 cost time: 6.25262713432312
Epoch: 12, Steps: 17 | Train Loss: 1.040 Vali Loss: 8.429 Vali Acc: 0.285 Test Loss: 8.429 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.010944128036499
Epoch: 13, Steps: 17 | Train Loss: 0.724 Vali Loss: 7.514 Vali Acc: 0.278 Test Loss: 7.514 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.838010549545288
Epoch: 14, Steps: 17 | Train Loss: 0.529 Vali Loss: 8.670 Vali Acc: 0.304 Test Loss: 8.670 Test Acc: 0.304
Validation loss decreased (-0.288904 --> -0.304096).  Saving model ...
Epoch: 15 cost time: 5.599787950515747
Epoch: 15, Steps: 17 | Train Loss: 0.900 Vali Loss: 10.534 Vali Acc: 0.270 Test Loss: 10.534 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.995022296905518
Epoch: 16, Steps: 17 | Train Loss: 1.148 Vali Loss: 10.814 Vali Acc: 0.262 Test Loss: 10.814 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.064938068389893
Epoch: 17, Steps: 17 | Train Loss: 0.836 Vali Loss: 9.240 Vali Acc: 0.270 Test Loss: 9.240 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.190068244934082
Epoch: 18, Steps: 17 | Train Loss: 0.496 Vali Loss: 10.990 Vali Acc: 0.270 Test Loss: 10.990 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.306939601898193
Epoch: 19, Steps: 17 | Train Loss: 0.750 Vali Loss: 13.138 Vali Acc: 0.293 Test Loss: 13.138 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.195845365524292
Epoch: 20, Steps: 17 | Train Loss: 0.644 Vali Loss: 10.401 Vali Acc: 0.255 Test Loss: 10.401 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.148022651672363
Epoch: 21, Steps: 17 | Train Loss: 0.934 Vali Loss: 13.491 Vali Acc: 0.289 Test Loss: 13.491 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.728087663650513
Epoch: 22, Steps: 17 | Train Loss: 0.379 Vali Loss: 18.320 Vali Acc: 0.274 Test Loss: 18.320 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.813546180725098
Epoch: 23, Steps: 17 | Train Loss: 0.491 Vali Loss: 12.479 Vali Acc: 0.289 Test Loss: 12.479 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.12279200553894
Epoch: 24, Steps: 17 | Train Loss: 0.509 Vali Loss: 15.501 Vali Acc: 0.289 Test Loss: 15.501 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.684308052062988
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 2.010 Vali Acc: 0.262 Test Loss: 2.010 Test Acc: 0.262
Validation loss decreased (inf --> -0.262337).  Saving model ...
Epoch: 2 cost time: 5.634377717971802
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 2.149 Vali Acc: 0.240 Test Loss: 2.149 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7219462394714355
Epoch: 3, Steps: 17 | Train Loss: 1.678 Vali Loss: 3.283 Vali Acc: 0.270 Test Loss: 3.283 Test Acc: 0.270
Validation loss decreased (-0.262337 --> -0.269929).  Saving model ...
Epoch: 4 cost time: 5.689545392990112
Epoch: 4, Steps: 17 | Train Loss: 1.823 Vali Loss: 2.659 Vali Acc: 0.255 Test Loss: 2.659 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.163451194763184
Epoch: 5, Steps: 17 | Train Loss: 2.019 Vali Loss: 3.692 Vali Acc: 0.255 Test Loss: 3.692 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.761130094528198
Epoch: 6, Steps: 17 | Train Loss: 1.176 Vali Loss: 3.336 Vali Acc: 0.240 Test Loss: 3.336 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.799421072006226
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 5.145 Vali Acc: 0.262 Test Loss: 5.145 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.959506034851074
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 6.505 Vali Acc: 0.281 Test Loss: 6.505 Test Acc: 0.281
Validation loss decreased (-0.269929 --> -0.281304).  Saving model ...
Epoch: 9 cost time: 5.653515577316284
Epoch: 9, Steps: 17 | Train Loss: 1.213 Vali Loss: 5.489 Vali Acc: 0.259 Test Loss: 5.489 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.162111043930054
Epoch: 10, Steps: 17 | Train Loss: 1.252 Vali Loss: 5.171 Vali Acc: 0.262 Test Loss: 5.171 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.942165374755859
Epoch: 11, Steps: 17 | Train Loss: 0.999 Vali Loss: 5.149 Vali Acc: 0.247 Test Loss: 5.149 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.1402106285095215
Epoch: 12, Steps: 17 | Train Loss: 0.641 Vali Loss: 8.408 Vali Acc: 0.262 Test Loss: 8.408 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.56383204460144
Epoch: 13, Steps: 17 | Train Loss: 0.757 Vali Loss: 10.008 Vali Acc: 0.259 Test Loss: 10.008 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.122469186782837
Epoch: 14, Steps: 17 | Train Loss: 0.714 Vali Loss: 7.718 Vali Acc: 0.232 Test Loss: 7.718 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.738279342651367
Epoch: 15, Steps: 17 | Train Loss: 0.500 Vali Loss: 8.512 Vali Acc: 0.247 Test Loss: 8.512 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.618199348449707
Epoch: 16, Steps: 17 | Train Loss: 0.890 Vali Loss: 11.778 Vali Acc: 0.232 Test Loss: 11.778 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.778654336929321
Epoch: 17, Steps: 17 | Train Loss: 0.938 Vali Loss: 11.110 Vali Acc: 0.247 Test Loss: 11.110 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.1779656410217285
Epoch: 18, Steps: 17 | Train Loss: 0.773 Vali Loss: 10.593 Vali Acc: 0.232 Test Loss: 10.593 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.4897942543029785
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.855 Vali Acc: 0.240 Test Loss: 1.855 Test Acc: 0.240
Validation loss decreased (inf --> -0.239525).  Saving model ...
Epoch: 2 cost time: 5.891657829284668
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 2.230 Vali Acc: 0.236 Test Loss: 2.230 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8846516609191895
Epoch: 3, Steps: 17 | Train Loss: 1.685 Vali Loss: 3.451 Vali Acc: 0.247 Test Loss: 3.451 Test Acc: 0.247
Validation loss decreased (-0.239525 --> -0.247114).  Saving model ...
Epoch: 4 cost time: 5.617629051208496
Epoch: 4, Steps: 17 | Train Loss: 1.466 Vali Loss: 2.294 Vali Acc: 0.259 Test Loss: 2.294 Test Acc: 0.259
Validation loss decreased (-0.247114 --> -0.258532).  Saving model ...
Epoch: 5 cost time: 5.840702533721924
Epoch: 5, Steps: 17 | Train Loss: 1.864 Vali Loss: 5.931 Vali Acc: 0.266 Test Loss: 5.931 Test Acc: 0.266
Validation loss decreased (-0.258532 --> -0.266100).  Saving model ...
Epoch: 6 cost time: 5.907406806945801
Epoch: 6, Steps: 17 | Train Loss: 1.266 Vali Loss: 3.835 Vali Acc: 0.240 Test Loss: 3.835 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.996107816696167
Epoch: 7, Steps: 17 | Train Loss: 1.013 Vali Loss: 3.760 Vali Acc: 0.278 Test Loss: 3.760 Test Acc: 0.278
Validation loss decreased (-0.266100 --> -0.277529).  Saving model ...
Epoch: 8 cost time: 6.067266941070557
Epoch: 8, Steps: 17 | Train Loss: 1.094 Vali Loss: 6.423 Vali Acc: 0.251 Test Loss: 6.423 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.566547870635986
Epoch: 9, Steps: 17 | Train Loss: 1.038 Vali Loss: 6.905 Vali Acc: 0.247 Test Loss: 6.905 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.283398628234863
Epoch: 10, Steps: 17 | Train Loss: 1.396 Vali Loss: 4.796 Vali Acc: 0.289 Test Loss: 4.796 Test Acc: 0.289
Validation loss decreased (-0.277529 --> -0.288925).  Saving model ...
Epoch: 11 cost time: 5.203510999679565
Epoch: 11, Steps: 17 | Train Loss: 1.074 Vali Loss: 6.396 Vali Acc: 0.236 Test Loss: 6.396 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.668204069137573
Epoch: 12, Steps: 17 | Train Loss: 0.791 Vali Loss: 6.117 Vali Acc: 0.278 Test Loss: 6.117 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.0534515380859375
Epoch: 13, Steps: 17 | Train Loss: 0.829 Vali Loss: 6.828 Vali Acc: 0.259 Test Loss: 6.828 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.2285661697387695
Epoch: 14, Steps: 17 | Train Loss: 0.969 Vali Loss: 9.739 Vali Acc: 0.274 Test Loss: 9.739 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.092866659164429
Epoch: 15, Steps: 17 | Train Loss: 0.765 Vali Loss: 9.388 Vali Acc: 0.224 Test Loss: 9.388 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.755028247833252
Epoch: 16, Steps: 17 | Train Loss: 0.611 Vali Loss: 9.576 Vali Acc: 0.274 Test Loss: 9.576 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.634176731109619
Epoch: 17, Steps: 17 | Train Loss: 0.664 Vali Loss: 10.311 Vali Acc: 0.251 Test Loss: 10.311 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.747369050979614
Epoch: 18, Steps: 17 | Train Loss: 0.512 Vali Loss: 12.025 Vali Acc: 0.255 Test Loss: 12.025 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.888557434082031
Epoch: 19, Steps: 17 | Train Loss: 0.539 Vali Loss: 12.892 Vali Acc: 0.278 Test Loss: 12.892 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.27107048034668
Epoch: 20, Steps: 17 | Train Loss: 0.599 Vali Loss: 11.225 Vali Acc: 0.251 Test Loss: 11.225 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.604135274887085
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 2.081 Vali Acc: 0.255 Test Loss: 2.081 Test Acc: 0.255
Validation loss decreased (inf --> -0.254732).  Saving model ...
Epoch: 2 cost time: 5.275622129440308
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 2.341 Vali Acc: 0.278 Test Loss: 2.341 Test Acc: 0.278
Validation loss decreased (-0.254732 --> -0.277543).  Saving model ...
Epoch: 3 cost time: 5.7198262214660645
Epoch: 3, Steps: 17 | Train Loss: 1.727 Vali Loss: 3.389 Vali Acc: 0.251 Test Loss: 3.389 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.329266548156738
Epoch: 4, Steps: 17 | Train Loss: 1.731 Vali Loss: 2.422 Vali Acc: 0.293 Test Loss: 2.422 Test Acc: 0.293
Validation loss decreased (-0.277543 --> -0.292751).  Saving model ...
Epoch: 5 cost time: 5.795907497406006
Epoch: 5, Steps: 17 | Train Loss: 2.013 Vali Loss: 6.040 Vali Acc: 0.251 Test Loss: 6.040 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.242572784423828
Epoch: 6, Steps: 17 | Train Loss: 1.327 Vali Loss: 2.864 Vali Acc: 0.262 Test Loss: 2.864 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.901759386062622
Epoch: 7, Steps: 17 | Train Loss: 1.057 Vali Loss: 3.381 Vali Acc: 0.243 Test Loss: 3.381 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.026464223861694
Epoch: 8, Steps: 17 | Train Loss: 1.110 Vali Loss: 4.923 Vali Acc: 0.251 Test Loss: 4.923 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.784470319747925
Epoch: 9, Steps: 17 | Train Loss: 1.207 Vali Loss: 5.606 Vali Acc: 0.240 Test Loss: 5.606 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.724589586257935
Epoch: 10, Steps: 17 | Train Loss: 1.532 Vali Loss: 4.413 Vali Acc: 0.270 Test Loss: 4.413 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.801964998245239
Epoch: 11, Steps: 17 | Train Loss: 1.182 Vali Loss: 4.948 Vali Acc: 0.251 Test Loss: 4.948 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.275074005126953
Epoch: 12, Steps: 17 | Train Loss: 0.882 Vali Loss: 6.258 Vali Acc: 0.266 Test Loss: 6.258 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.447993040084839
Epoch: 13, Steps: 17 | Train Loss: 1.022 Vali Loss: 6.770 Vali Acc: 0.228 Test Loss: 6.770 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.366199254989624
Epoch: 14, Steps: 17 | Train Loss: 0.806 Vali Loss: 7.656 Vali Acc: 0.262 Test Loss: 7.656 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.8014092445373535
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.978 Vali Acc: 0.251 Test Loss: 1.978 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 5.4619386196136475
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 2.568 Vali Acc: 0.243 Test Loss: 2.568 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.407811880111694
Epoch: 3, Steps: 17 | Train Loss: 1.787 Vali Loss: 3.254 Vali Acc: 0.247 Test Loss: 3.254 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.024632453918457
Epoch: 4, Steps: 17 | Train Loss: 1.747 Vali Loss: 2.589 Vali Acc: 0.262 Test Loss: 2.589 Test Acc: 0.262
Validation loss decreased (-0.250931 --> -0.262332).  Saving model ...
Epoch: 5 cost time: 5.817716121673584
Epoch: 5, Steps: 17 | Train Loss: 2.078 Vali Loss: 7.439 Vali Acc: 0.247 Test Loss: 7.439 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.843519687652588
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 3.952 Vali Acc: 0.259 Test Loss: 3.952 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.830167770385742
Epoch: 7, Steps: 17 | Train Loss: 1.143 Vali Loss: 4.069 Vali Acc: 0.262 Test Loss: 4.069 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.560506343841553
Epoch: 8, Steps: 17 | Train Loss: 1.202 Vali Loss: 4.707 Vali Acc: 0.247 Test Loss: 4.707 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.56935977935791
Epoch: 9, Steps: 17 | Train Loss: 1.298 Vali Loss: 6.187 Vali Acc: 0.243 Test Loss: 6.187 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.628617763519287
Epoch: 10, Steps: 17 | Train Loss: 1.616 Vali Loss: 6.484 Vali Acc: 0.251 Test Loss: 6.484 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.087485074996948
Epoch: 11, Steps: 17 | Train Loss: 1.234 Vali Loss: 6.564 Vali Acc: 0.281 Test Loss: 6.564 Test Acc: 0.281
Validation loss decreased (-0.262332 --> -0.281303).  Saving model ...
Epoch: 12 cost time: 5.949813604354858
Epoch: 12, Steps: 17 | Train Loss: 1.018 Vali Loss: 7.636 Vali Acc: 0.266 Test Loss: 7.636 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.291077375411987
Epoch: 13, Steps: 17 | Train Loss: 0.977 Vali Loss: 8.847 Vali Acc: 0.243 Test Loss: 8.847 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.821521282196045
Epoch: 14, Steps: 17 | Train Loss: 0.955 Vali Loss: 10.600 Vali Acc: 0.270 Test Loss: 10.600 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.406952619552612
Epoch: 15, Steps: 17 | Train Loss: 0.875 Vali Loss: 7.382 Vali Acc: 0.262 Test Loss: 7.382 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.530099153518677
Epoch: 16, Steps: 17 | Train Loss: 0.867 Vali Loss: 8.813 Vali Acc: 0.232 Test Loss: 8.813 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.650489330291748
Epoch: 17, Steps: 17 | Train Loss: 0.841 Vali Loss: 9.407 Vali Acc: 0.247 Test Loss: 9.407 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.091089725494385
Epoch: 18, Steps: 17 | Train Loss: 0.792 Vali Loss: 10.730 Vali Acc: 0.255 Test Loss: 10.730 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.274914503097534
Epoch: 19, Steps: 17 | Train Loss: 0.814 Vali Loss: 11.809 Vali Acc: 0.255 Test Loss: 11.809 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.4765636920928955
Epoch: 20, Steps: 17 | Train Loss: 0.941 Vali Loss: 11.352 Vali Acc: 0.255 Test Loss: 11.352 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.257158517837524
Epoch: 21, Steps: 17 | Train Loss: 0.929 Vali Loss: 15.252 Vali Acc: 0.259 Test Loss: 15.252 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.249690294265747
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.699 Vali Acc: 0.251 Test Loss: 1.699 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 5.679629564285278
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 2.524 Vali Acc: 0.247 Test Loss: 2.524 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.825499057769775
Epoch: 3, Steps: 17 | Train Loss: 1.899 Vali Loss: 3.846 Vali Acc: 0.232 Test Loss: 3.846 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.135701417922974
Epoch: 4, Steps: 17 | Train Loss: 1.923 Vali Loss: 3.220 Vali Acc: 0.228 Test Loss: 3.220 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.060725450515747
Epoch: 5, Steps: 17 | Train Loss: 2.401 Vali Loss: 8.352 Vali Acc: 0.251 Test Loss: 8.352 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.934805631637573
Epoch: 6, Steps: 17 | Train Loss: 1.597 Vali Loss: 5.148 Vali Acc: 0.240 Test Loss: 5.148 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.44914698600769
Epoch: 7, Steps: 17 | Train Loss: 1.355 Vali Loss: 5.868 Vali Acc: 0.243 Test Loss: 5.868 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.5885233879089355
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 5.425 Vali Acc: 0.255 Test Loss: 5.425 Test Acc: 0.255
Validation loss decreased (-0.250934 --> -0.254699).  Saving model ...
Epoch: 9 cost time: 5.513508558273315
Epoch: 9, Steps: 17 | Train Loss: 1.568 Vali Loss: 8.244 Vali Acc: 0.262 Test Loss: 8.244 Test Acc: 0.262
Validation loss decreased (-0.254699 --> -0.262275).  Saving model ...
Epoch: 10 cost time: 5.790713548660278
Epoch: 10, Steps: 17 | Train Loss: 2.200 Vali Loss: 6.994 Vali Acc: 0.251 Test Loss: 6.994 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.962968587875366
Epoch: 11, Steps: 17 | Train Loss: 1.608 Vali Loss: 6.443 Vali Acc: 0.266 Test Loss: 6.443 Test Acc: 0.266
Validation loss decreased (-0.262275 --> -0.266095).  Saving model ...
Epoch: 12 cost time: 5.836241006851196
Epoch: 12, Steps: 17 | Train Loss: 1.206 Vali Loss: 6.603 Vali Acc: 0.262 Test Loss: 6.603 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.971639633178711
Epoch: 13, Steps: 17 | Train Loss: 1.284 Vali Loss: 5.128 Vali Acc: 0.274 Test Loss: 5.128 Test Acc: 0.274
Validation loss decreased (-0.266095 --> -0.273713).  Saving model ...
Epoch: 14 cost time: 5.545067548751831
Epoch: 14, Steps: 17 | Train Loss: 1.278 Vali Loss: 7.783 Vali Acc: 0.232 Test Loss: 7.783 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.92936110496521
Epoch: 15, Steps: 17 | Train Loss: 1.225 Vali Loss: 7.144 Vali Acc: 0.266 Test Loss: 7.144 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.707720041275024
Epoch: 16, Steps: 17 | Train Loss: 1.840 Vali Loss: 12.066 Vali Acc: 0.232 Test Loss: 12.066 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.119287729263306
Epoch: 17, Steps: 17 | Train Loss: 1.256 Vali Loss: 11.248 Vali Acc: 0.221 Test Loss: 11.248 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.216992378234863
Epoch: 18, Steps: 17 | Train Loss: 1.233 Vali Loss: 9.866 Vali Acc: 0.221 Test Loss: 9.866 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.9082560539245605
Epoch: 19, Steps: 17 | Train Loss: 1.170 Vali Loss: 12.681 Vali Acc: 0.240 Test Loss: 12.681 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.108315706253052
Epoch: 20, Steps: 17 | Train Loss: 1.127 Vali Loss: 14.220 Vali Acc: 0.236 Test Loss: 14.220 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.531440734863281
Epoch: 21, Steps: 17 | Train Loss: 1.202 Vali Loss: 14.396 Vali Acc: 0.266 Test Loss: 14.396 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.934891939163208
Epoch: 22, Steps: 17 | Train Loss: 1.254 Vali Loss: 15.675 Vali Acc: 0.266 Test Loss: 15.675 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.592635631561279
Epoch: 23, Steps: 17 | Train Loss: 1.181 Vali Loss: 15.208 Vali Acc: 0.255 Test Loss: 15.208 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1657604
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.115497827529907
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.750 Vali Acc: 0.247 Test Loss: 1.750 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 7.272115468978882
Epoch: 2, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.884 Vali Acc: 0.255 Test Loss: 1.884 Test Acc: 0.255
Validation loss decreased (-0.247131 --> -0.254734).  Saving model ...
Epoch: 3 cost time: 7.6752026081085205
Epoch: 3, Steps: 17 | Train Loss: 1.578 Vali Loss: 2.424 Vali Acc: 0.251 Test Loss: 2.424 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.721476078033447
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.811 Vali Acc: 0.270 Test Loss: 1.811 Test Acc: 0.270
Validation loss decreased (-0.254734 --> -0.269944).  Saving model ...
Epoch: 5 cost time: 7.348790407180786
Epoch: 5, Steps: 17 | Train Loss: 1.377 Vali Loss: 2.851 Vali Acc: 0.266 Test Loss: 2.851 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.494615316390991
Epoch: 6, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.740 Vali Acc: 0.293 Test Loss: 2.740 Test Acc: 0.293
Validation loss decreased (-0.269944 --> -0.292748).  Saving model ...
Epoch: 7 cost time: 8.217077016830444
Epoch: 7, Steps: 17 | Train Loss: 1.254 Vali Loss: 3.192 Vali Acc: 0.274 Test Loss: 3.192 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.051152229309082
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 3.760 Vali Acc: 0.224 Test Loss: 3.760 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.7581260204315186
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 2.507 Vali Acc: 0.259 Test Loss: 2.507 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.756191730499268
Epoch: 10, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.766 Vali Acc: 0.240 Test Loss: 2.766 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.232659816741943
Epoch: 11, Steps: 17 | Train Loss: 0.763 Vali Loss: 3.539 Vali Acc: 0.232 Test Loss: 3.539 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.9641454219818115
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 3.633 Vali Acc: 0.300 Test Loss: 3.633 Test Acc: 0.300
Validation loss decreased (-0.292748 --> -0.300344).  Saving model ...
Epoch: 13 cost time: 7.898221969604492
Epoch: 13, Steps: 17 | Train Loss: 0.728 Vali Loss: 3.445 Vali Acc: 0.255 Test Loss: 3.445 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.939650535583496
Epoch: 14, Steps: 17 | Train Loss: 0.636 Vali Loss: 3.849 Vali Acc: 0.259 Test Loss: 3.849 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.700577259063721
Epoch: 15, Steps: 17 | Train Loss: 0.746 Vali Loss: 4.152 Vali Acc: 0.281 Test Loss: 4.152 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.639401435852051
Epoch: 16, Steps: 17 | Train Loss: 0.647 Vali Loss: 4.532 Vali Acc: 0.247 Test Loss: 4.532 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.410788536071777
Epoch: 17, Steps: 17 | Train Loss: 0.466 Vali Loss: 3.985 Vali Acc: 0.251 Test Loss: 3.985 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.16820764541626
Epoch: 18, Steps: 17 | Train Loss: 0.400 Vali Loss: 4.729 Vali Acc: 0.243 Test Loss: 4.729 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.035605192184448
Epoch: 19, Steps: 17 | Train Loss: 0.533 Vali Loss: 4.577 Vali Acc: 0.247 Test Loss: 4.577 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.877914667129517
Epoch: 20, Steps: 17 | Train Loss: 0.611 Vali Loss: 4.863 Vali Acc: 0.285 Test Loss: 4.863 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.048030138015747
Epoch: 21, Steps: 17 | Train Loss: 0.493 Vali Loss: 4.701 Vali Acc: 0.259 Test Loss: 4.701 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.993696451187134
Epoch: 22, Steps: 17 | Train Loss: 0.320 Vali Loss: 5.201 Vali Acc: 0.297 Test Loss: 5.201 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.992861270904541
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.770 Vali Acc: 0.247 Test Loss: 1.770 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 7.2402520179748535
Epoch: 2, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.895 Vali Acc: 0.259 Test Loss: 1.895 Test Acc: 0.259
Validation loss decreased (-0.247131 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 6.972203254699707
Epoch: 3, Steps: 17 | Train Loss: 1.569 Vali Loss: 2.324 Vali Acc: 0.232 Test Loss: 2.324 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.025196552276611
Epoch: 4, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.931 Vali Acc: 0.247 Test Loss: 1.931 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.639597415924072
Epoch: 5, Steps: 17 | Train Loss: 1.394 Vali Loss: 2.962 Vali Acc: 0.232 Test Loss: 2.962 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.5964601039886475
Epoch: 6, Steps: 17 | Train Loss: 1.183 Vali Loss: 2.852 Vali Acc: 0.266 Test Loss: 2.852 Test Acc: 0.266
Validation loss decreased (-0.258536 --> -0.266131).  Saving model ...
Epoch: 7 cost time: 7.039839267730713
Epoch: 7, Steps: 17 | Train Loss: 1.277 Vali Loss: 3.153 Vali Acc: 0.289 Test Loss: 3.153 Test Acc: 0.289
Validation loss decreased (-0.266131 --> -0.288942).  Saving model ...
Epoch: 8 cost time: 6.8317952156066895
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 3.374 Vali Acc: 0.255 Test Loss: 3.374 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.324386358261108
Epoch: 9, Steps: 17 | Train Loss: 1.285 Vali Loss: 2.317 Vali Acc: 0.270 Test Loss: 2.317 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.661564111709595
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 2.785 Vali Acc: 0.262 Test Loss: 2.785 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.943023920059204
Epoch: 11, Steps: 17 | Train Loss: 0.772 Vali Loss: 3.169 Vali Acc: 0.236 Test Loss: 3.169 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.018679857254028
Epoch: 12, Steps: 17 | Train Loss: 0.770 Vali Loss: 3.642 Vali Acc: 0.247 Test Loss: 3.642 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.612781524658203
Epoch: 13, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.403 Vali Acc: 0.278 Test Loss: 3.403 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.870596408843994
Epoch: 14, Steps: 17 | Train Loss: 0.526 Vali Loss: 4.058 Vali Acc: 0.217 Test Loss: 4.058 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.212968826293945
Epoch: 15, Steps: 17 | Train Loss: 0.548 Vali Loss: 4.498 Vali Acc: 0.255 Test Loss: 4.498 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.458287954330444
Epoch: 16, Steps: 17 | Train Loss: 0.637 Vali Loss: 4.628 Vali Acc: 0.255 Test Loss: 4.628 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.313679456710815
Epoch: 17, Steps: 17 | Train Loss: 0.554 Vali Loss: 5.369 Vali Acc: 0.259 Test Loss: 5.369 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.334981918334961
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
Validation loss decreased (inf --> -0.243329).  Saving model ...
Epoch: 2 cost time: 7.225880861282349
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.958 Vali Acc: 0.270 Test Loss: 1.958 Test Acc: 0.270
Validation loss decreased (-0.243329 --> -0.269942).  Saving model ...
Epoch: 3 cost time: 6.529379844665527
Epoch: 3, Steps: 17 | Train Loss: 1.509 Vali Loss: 2.535 Vali Acc: 0.266 Test Loss: 2.535 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.65613055229187
Epoch: 4, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.899 Vali Acc: 0.262 Test Loss: 1.899 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.810885190963745
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 3.114 Vali Acc: 0.232 Test Loss: 3.114 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.684061050415039
Epoch: 6, Steps: 17 | Train Loss: 1.168 Vali Loss: 3.288 Vali Acc: 0.251 Test Loss: 3.288 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.01441764831543
Epoch: 7, Steps: 17 | Train Loss: 1.114 Vali Loss: 3.493 Vali Acc: 0.266 Test Loss: 3.493 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.107577323913574
Epoch: 8, Steps: 17 | Train Loss: 0.939 Vali Loss: 3.578 Vali Acc: 0.202 Test Loss: 3.578 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.932977914810181
Epoch: 9, Steps: 17 | Train Loss: 0.885 Vali Loss: 3.009 Vali Acc: 0.259 Test Loss: 3.009 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.936346769332886
Epoch: 10, Steps: 17 | Train Loss: 0.963 Vali Loss: 4.303 Vali Acc: 0.251 Test Loss: 4.303 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.056186676025391
Epoch: 11, Steps: 17 | Train Loss: 1.029 Vali Loss: 3.083 Vali Acc: 0.270 Test Loss: 3.083 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.793411731719971
Epoch: 12, Steps: 17 | Train Loss: 0.703 Vali Loss: 3.867 Vali Acc: 0.232 Test Loss: 3.867 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.4563210010528564
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.608 Vali Acc: 0.236 Test Loss: 1.608 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 5.952508926391602
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.940 Vali Acc: 0.221 Test Loss: 1.940 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.764767408370972
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 2.391 Vali Acc: 0.247 Test Loss: 2.391 Test Acc: 0.247
Validation loss decreased (-0.235725 --> -0.247124).  Saving model ...
Epoch: 4 cost time: 6.021436929702759
Epoch: 4, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.494 Vali Acc: 0.217 Test Loss: 2.494 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8738672733306885
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 3.929 Vali Acc: 0.270 Test Loss: 3.929 Test Acc: 0.270
Validation loss decreased (-0.247124 --> -0.269923).  Saving model ...
Epoch: 6 cost time: 6.294381618499756
Epoch: 6, Steps: 17 | Train Loss: 1.067 Vali Loss: 3.397 Vali Acc: 0.240 Test Loss: 3.397 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.053566932678223
Epoch: 7, Steps: 17 | Train Loss: 0.947 Vali Loss: 3.806 Vali Acc: 0.240 Test Loss: 3.806 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.233128786087036
Epoch: 8, Steps: 17 | Train Loss: 0.918 Vali Loss: 4.045 Vali Acc: 0.224 Test Loss: 4.045 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.19754433631897
Epoch: 9, Steps: 17 | Train Loss: 0.828 Vali Loss: 3.223 Vali Acc: 0.240 Test Loss: 3.223 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.924330472946167
Epoch: 10, Steps: 17 | Train Loss: 0.842 Vali Loss: 6.010 Vali Acc: 0.251 Test Loss: 6.010 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.148042678833008
Epoch: 11, Steps: 17 | Train Loss: 0.863 Vali Loss: 4.321 Vali Acc: 0.217 Test Loss: 4.321 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.316179513931274
Epoch: 12, Steps: 17 | Train Loss: 0.678 Vali Loss: 5.708 Vali Acc: 0.251 Test Loss: 5.708 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.288462400436401
Epoch: 13, Steps: 17 | Train Loss: 0.576 Vali Loss: 4.562 Vali Acc: 0.202 Test Loss: 4.562 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.228025436401367
Epoch: 14, Steps: 17 | Train Loss: 0.665 Vali Loss: 6.858 Vali Acc: 0.228 Test Loss: 6.858 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.330588102340698
Epoch: 15, Steps: 17 | Train Loss: 0.420 Vali Loss: 7.534 Vali Acc: 0.251 Test Loss: 7.534 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.288581371307373
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.460 Vali Acc: 0.289 Test Loss: 1.460 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 6.279932260513306
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.789 Vali Acc: 0.228 Test Loss: 1.789 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.985270738601685
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 2.070 Vali Acc: 0.278 Test Loss: 2.070 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.014826774597168
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 2.411 Vali Acc: 0.259 Test Loss: 2.411 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.33025336265564
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 3.017 Vali Acc: 0.240 Test Loss: 3.017 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.819955587387085
Epoch: 6, Steps: 17 | Train Loss: 0.972 Vali Loss: 3.769 Vali Acc: 0.262 Test Loss: 3.769 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.018945217132568
Epoch: 7, Steps: 17 | Train Loss: 1.035 Vali Loss: 3.734 Vali Acc: 0.266 Test Loss: 3.734 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.868163585662842
Epoch: 8, Steps: 17 | Train Loss: 0.878 Vali Loss: 3.844 Vali Acc: 0.278 Test Loss: 3.844 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.529897212982178
Epoch: 9, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.909 Vali Acc: 0.274 Test Loss: 3.909 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.29246973991394
Epoch: 10, Steps: 17 | Train Loss: 0.651 Vali Loss: 6.059 Vali Acc: 0.262 Test Loss: 6.059 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.329607963562012
Epoch: 11, Steps: 17 | Train Loss: 0.688 Vali Loss: 4.059 Vali Acc: 0.251 Test Loss: 4.059 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.718878746032715
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.503 Vali Acc: 0.243 Test Loss: 1.503 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 5.692135572433472
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.857 Vali Acc: 0.232 Test Loss: 1.857 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.552193880081177
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 2.175 Vali Acc: 0.240 Test Loss: 2.175 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.326159477233887
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 2.689 Vali Acc: 0.297 Test Loss: 2.689 Test Acc: 0.297
Validation loss decreased (-0.243331 --> -0.296551).  Saving model ...
Epoch: 5 cost time: 6.011627435684204
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 3.094 Vali Acc: 0.217 Test Loss: 3.094 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.876769542694092
Epoch: 6, Steps: 17 | Train Loss: 1.050 Vali Loss: 3.230 Vali Acc: 0.232 Test Loss: 3.230 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.781415700912476
Epoch: 7, Steps: 17 | Train Loss: 0.987 Vali Loss: 3.666 Vali Acc: 0.274 Test Loss: 3.666 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.653122663497925
Epoch: 8, Steps: 17 | Train Loss: 1.064 Vali Loss: 3.661 Vali Acc: 0.262 Test Loss: 3.661 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.4910242557525635
Epoch: 9, Steps: 17 | Train Loss: 0.726 Vali Loss: 3.562 Vali Acc: 0.243 Test Loss: 3.562 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.830263137817383
Epoch: 10, Steps: 17 | Train Loss: 0.584 Vali Loss: 4.395 Vali Acc: 0.240 Test Loss: 4.395 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.319942951202393
Epoch: 11, Steps: 17 | Train Loss: 0.601 Vali Loss: 4.627 Vali Acc: 0.232 Test Loss: 4.627 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.993985176086426
Epoch: 12, Steps: 17 | Train Loss: 0.748 Vali Loss: 4.708 Vali Acc: 0.247 Test Loss: 4.708 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.140995264053345
Epoch: 13, Steps: 17 | Train Loss: 0.455 Vali Loss: 5.269 Vali Acc: 0.270 Test Loss: 5.269 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.703012466430664
Epoch: 14, Steps: 17 | Train Loss: 0.334 Vali Loss: 7.181 Vali Acc: 0.232 Test Loss: 7.181 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.296962022781372
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.482 Vali Acc: 0.274 Test Loss: 1.482 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 6.478590488433838
Epoch: 2, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.945 Vali Acc: 0.251 Test Loss: 1.945 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.3045876026153564
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 2.985 Vali Acc: 0.251 Test Loss: 2.985 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.4769392013549805
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 2.946 Vali Acc: 0.278 Test Loss: 2.946 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277537).  Saving model ...
Epoch: 5 cost time: 6.099818706512451
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 4.037 Vali Acc: 0.262 Test Loss: 4.037 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.518482685089111
Epoch: 6, Steps: 17 | Train Loss: 1.145 Vali Loss: 4.435 Vali Acc: 0.259 Test Loss: 4.435 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.208151340484619
Epoch: 7, Steps: 17 | Train Loss: 1.112 Vali Loss: 3.744 Vali Acc: 0.270 Test Loss: 3.744 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.263117551803589
Epoch: 8, Steps: 17 | Train Loss: 0.999 Vali Loss: 4.452 Vali Acc: 0.255 Test Loss: 4.452 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.384687662124634
Epoch: 9, Steps: 17 | Train Loss: 0.951 Vali Loss: 3.627 Vali Acc: 0.255 Test Loss: 3.627 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.873042106628418
Epoch: 10, Steps: 17 | Train Loss: 0.674 Vali Loss: 5.695 Vali Acc: 0.255 Test Loss: 5.695 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.653854846954346
Epoch: 11, Steps: 17 | Train Loss: 1.015 Vali Loss: 3.850 Vali Acc: 0.255 Test Loss: 3.850 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.800929069519043
Epoch: 12, Steps: 17 | Train Loss: 0.624 Vali Loss: 5.985 Vali Acc: 0.255 Test Loss: 5.985 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.383072137832642
Epoch: 13, Steps: 17 | Train Loss: 0.674 Vali Loss: 4.503 Vali Acc: 0.266 Test Loss: 4.503 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.434662580490112
Epoch: 14, Steps: 17 | Train Loss: 0.910 Vali Loss: 6.959 Vali Acc: 0.262 Test Loss: 6.959 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.479965448379517
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 5.7228477001190186
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.934 Vali Acc: 0.255 Test Loss: 1.934 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.567961931228638
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 2.986 Vali Acc: 0.259 Test Loss: 2.986 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.674915790557861
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 3.189 Vali Acc: 0.270 Test Loss: 3.189 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269930).  Saving model ...
Epoch: 5 cost time: 6.06413722038269
Epoch: 5, Steps: 17 | Train Loss: 1.329 Vali Loss: 4.300 Vali Acc: 0.259 Test Loss: 4.300 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.263422012329102
Epoch: 6, Steps: 17 | Train Loss: 1.211 Vali Loss: 4.250 Vali Acc: 0.259 Test Loss: 4.250 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.109986305236816
Epoch: 7, Steps: 17 | Train Loss: 1.160 Vali Loss: 3.903 Vali Acc: 0.255 Test Loss: 3.903 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.296921014785767
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 4.655 Vali Acc: 0.251 Test Loss: 4.655 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.788191556930542
Epoch: 9, Steps: 17 | Train Loss: 1.024 Vali Loss: 4.039 Vali Acc: 0.274 Test Loss: 4.039 Test Acc: 0.274
Validation loss decreased (-0.269930 --> -0.273724).  Saving model ...
Epoch: 10 cost time: 5.641977310180664
Epoch: 10, Steps: 17 | Train Loss: 0.766 Vali Loss: 5.520 Vali Acc: 0.266 Test Loss: 5.520 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.556710958480835
Epoch: 11, Steps: 17 | Train Loss: 0.839 Vali Loss: 3.934 Vali Acc: 0.266 Test Loss: 3.934 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.7859416007995605
Epoch: 12, Steps: 17 | Train Loss: 0.746 Vali Loss: 4.458 Vali Acc: 0.289 Test Loss: 4.458 Test Acc: 0.289
Validation loss decreased (-0.273724 --> -0.288929).  Saving model ...
Epoch: 13 cost time: 6.2547972202301025
Epoch: 13, Steps: 17 | Train Loss: 0.724 Vali Loss: 4.699 Vali Acc: 0.285 Test Loss: 4.699 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.331847190856934
Epoch: 14, Steps: 17 | Train Loss: 0.555 Vali Loss: 6.640 Vali Acc: 0.232 Test Loss: 6.640 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.917774200439453
Epoch: 15, Steps: 17 | Train Loss: 0.699 Vali Loss: 5.081 Vali Acc: 0.247 Test Loss: 5.081 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.967183828353882
Epoch: 16, Steps: 17 | Train Loss: 0.478 Vali Loss: 6.015 Vali Acc: 0.228 Test Loss: 6.015 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.913651943206787
Epoch: 17, Steps: 17 | Train Loss: 0.619 Vali Loss: 7.674 Vali Acc: 0.243 Test Loss: 7.674 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.029736280441284
Epoch: 18, Steps: 17 | Train Loss: 0.832 Vali Loss: 6.934 Vali Acc: 0.236 Test Loss: 6.934 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.493204593658447
Epoch: 19, Steps: 17 | Train Loss: 0.516 Vali Loss: 8.147 Vali Acc: 0.228 Test Loss: 8.147 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.6139116287231445
Epoch: 20, Steps: 17 | Train Loss: 0.525 Vali Loss: 7.370 Vali Acc: 0.240 Test Loss: 7.370 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.198416471481323
Epoch: 21, Steps: 17 | Train Loss: 0.613 Vali Loss: 10.297 Vali Acc: 0.221 Test Loss: 10.297 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.920499324798584
Epoch: 22, Steps: 17 | Train Loss: 0.392 Vali Loss: 8.651 Vali Acc: 0.228 Test Loss: 8.651 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.250863075256348
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.499 Vali Acc: 0.247 Test Loss: 1.499 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 5.805682420730591
Epoch: 2, Steps: 17 | Train Loss: 1.467 Vali Loss: 2.058 Vali Acc: 0.240 Test Loss: 2.058 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.097611427307129
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 3.221 Vali Acc: 0.259 Test Loss: 3.221 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258523).  Saving model ...
Epoch: 4 cost time: 5.926168441772461
Epoch: 4, Steps: 17 | Train Loss: 1.507 Vali Loss: 3.412 Vali Acc: 0.232 Test Loss: 3.412 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.694612979888916
Epoch: 5, Steps: 17 | Train Loss: 1.353 Vali Loss: 3.959 Vali Acc: 0.259 Test Loss: 3.959 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.54413914680481
Epoch: 6, Steps: 17 | Train Loss: 1.200 Vali Loss: 4.327 Vali Acc: 0.236 Test Loss: 4.327 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.228084325790405
Epoch: 7, Steps: 17 | Train Loss: 1.245 Vali Loss: 5.046 Vali Acc: 0.247 Test Loss: 5.046 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.555753946304321
Epoch: 8, Steps: 17 | Train Loss: 1.349 Vali Loss: 4.108 Vali Acc: 0.232 Test Loss: 4.108 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.743767499923706
Epoch: 9, Steps: 17 | Train Loss: 1.200 Vali Loss: 5.177 Vali Acc: 0.266 Test Loss: 5.177 Test Acc: 0.266
Validation loss decreased (-0.258523 --> -0.266108).  Saving model ...
Epoch: 10 cost time: 6.032301187515259
Epoch: 10, Steps: 17 | Train Loss: 0.957 Vali Loss: 6.499 Vali Acc: 0.262 Test Loss: 6.499 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.967488527297974
Epoch: 11, Steps: 17 | Train Loss: 1.207 Vali Loss: 4.191 Vali Acc: 0.251 Test Loss: 4.191 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.950791358947754
Epoch: 12, Steps: 17 | Train Loss: 0.839 Vali Loss: 7.446 Vali Acc: 0.262 Test Loss: 7.446 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.971380710601807
Epoch: 13, Steps: 17 | Train Loss: 0.923 Vali Loss: 4.989 Vali Acc: 0.262 Test Loss: 4.989 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.828454494476318
Epoch: 14, Steps: 17 | Train Loss: 0.867 Vali Loss: 8.650 Vali Acc: 0.240 Test Loss: 8.650 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.7833709716796875
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 6.497 Vali Acc: 0.270 Test Loss: 6.497 Test Acc: 0.270
Validation loss decreased (-0.266108 --> -0.269897).  Saving model ...
Epoch: 16 cost time: 5.841550350189209
Epoch: 16, Steps: 17 | Train Loss: 0.668 Vali Loss: 8.105 Vali Acc: 0.243 Test Loss: 8.105 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.204773902893066
Epoch: 17, Steps: 17 | Train Loss: 0.825 Vali Loss: 8.824 Vali Acc: 0.240 Test Loss: 8.824 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.083514451980591
Epoch: 18, Steps: 17 | Train Loss: 0.855 Vali Loss: 8.685 Vali Acc: 0.262 Test Loss: 8.685 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.27767276763916
Epoch: 19, Steps: 17 | Train Loss: 0.658 Vali Loss: 9.746 Vali Acc: 0.243 Test Loss: 9.746 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.853136301040649
Epoch: 20, Steps: 17 | Train Loss: 0.676 Vali Loss: 8.910 Vali Acc: 0.247 Test Loss: 8.910 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.729426145553589
Epoch: 21, Steps: 17 | Train Loss: 0.884 Vali Loss: 9.971 Vali Acc: 0.251 Test Loss: 9.971 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.330939769744873
Epoch: 22, Steps: 17 | Train Loss: 0.810 Vali Loss: 12.504 Vali Acc: 0.247 Test Loss: 12.504 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.3949480056762695
Epoch: 23, Steps: 17 | Train Loss: 0.961 Vali Loss: 9.683 Vali Acc: 0.255 Test Loss: 9.683 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.8813440799713135
Epoch: 24, Steps: 17 | Train Loss: 0.513 Vali Loss: 10.645 Vali Acc: 0.278 Test Loss: 10.645 Test Acc: 0.278
Validation loss decreased (-0.269897 --> -0.277460).  Saving model ...
Epoch: 25 cost time: 5.508898496627808
Epoch: 25, Steps: 17 | Train Loss: 0.539 Vali Loss: 12.408 Vali Acc: 0.236 Test Loss: 12.408 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.578726768493652
Epoch: 26, Steps: 17 | Train Loss: 0.678 Vali Loss: 10.783 Vali Acc: 0.228 Test Loss: 10.783 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.62769627571106
Epoch: 27, Steps: 17 | Train Loss: 0.648 Vali Loss: 13.751 Vali Acc: 0.243 Test Loss: 13.751 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.204845905303955
Epoch: 28, Steps: 17 | Train Loss: 0.527 Vali Loss: 13.114 Vali Acc: 0.243 Test Loss: 13.114 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.149176120758057
Epoch: 29, Steps: 17 | Train Loss: 0.424 Vali Loss: 15.924 Vali Acc: 0.232 Test Loss: 15.924 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.253828048706055
Epoch: 30, Steps: 17 | Train Loss: 0.621 Vali Loss: 11.582 Vali Acc: 0.274 Test Loss: 11.582 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.161020040512085
Epoch: 31, Steps: 17 | Train Loss: 0.740 Vali Loss: 13.919 Vali Acc: 0.262 Test Loss: 13.919 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.487055540084839
Epoch: 32, Steps: 17 | Train Loss: 0.586 Vali Loss: 11.663 Vali Acc: 0.274 Test Loss: 11.663 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.5111165046691895
Epoch: 33, Steps: 17 | Train Loss: 0.807 Vali Loss: 16.787 Vali Acc: 0.232 Test Loss: 16.787 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.8103108406066895
Epoch: 34, Steps: 17 | Train Loss: 0.566 Vali Loss: 14.975 Vali Acc: 0.255 Test Loss: 14.975 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.389507293701172
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.533 Vali Acc: 0.255 Test Loss: 1.533 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 6.169882535934448
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 2.076 Vali Acc: 0.251 Test Loss: 2.076 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9817163944244385
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 3.421 Vali Acc: 0.251 Test Loss: 3.421 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.201067924499512
Epoch: 4, Steps: 17 | Train Loss: 1.620 Vali Loss: 3.832 Vali Acc: 0.228 Test Loss: 3.832 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.995370388031006
Epoch: 5, Steps: 17 | Train Loss: 1.501 Vali Loss: 5.107 Vali Acc: 0.251 Test Loss: 5.107 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.052825689315796
Epoch: 6, Steps: 17 | Train Loss: 1.493 Vali Loss: 4.629 Vali Acc: 0.236 Test Loss: 4.629 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.10995078086853
Epoch: 7, Steps: 17 | Train Loss: 1.491 Vali Loss: 4.624 Vali Acc: 0.247 Test Loss: 4.624 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.388000249862671
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 5.003 Vali Acc: 0.240 Test Loss: 5.003 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.233839750289917
Epoch: 9, Steps: 17 | Train Loss: 1.479 Vali Loss: 5.019 Vali Acc: 0.247 Test Loss: 5.019 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.682994842529297
Epoch: 10, Steps: 17 | Train Loss: 1.164 Vali Loss: 7.090 Vali Acc: 0.255 Test Loss: 7.090 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.730867624282837
Epoch: 11, Steps: 17 | Train Loss: 1.264 Vali Loss: 3.863 Vali Acc: 0.209 Test Loss: 3.863 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.25475285171102663
model parameter : 1402244
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.333457469940186
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.434 Vali Acc: 0.289 Test Loss: 1.434 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 7.012447357177734
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.699 Vali Acc: 0.293 Test Loss: 1.699 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292759).  Saving model ...
Epoch: 3 cost time: 7.364744186401367
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.880 Vali Acc: 0.247 Test Loss: 1.880 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.142471075057983
Epoch: 4, Steps: 17 | Train Loss: 1.374 Vali Loss: 2.347 Vali Acc: 0.251 Test Loss: 2.347 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.569991588592529
Epoch: 5, Steps: 17 | Train Loss: 1.364 Vali Loss: 2.632 Vali Acc: 0.259 Test Loss: 2.632 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.193922996520996
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.992 Vali Acc: 0.251 Test Loss: 1.992 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.339735746383667
Epoch: 7, Steps: 17 | Train Loss: 1.404 Vali Loss: 2.596 Vali Acc: 0.270 Test Loss: 2.596 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.284151315689087
Epoch: 8, Steps: 17 | Train Loss: 1.097 Vali Loss: 2.790 Vali Acc: 0.236 Test Loss: 2.790 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.057725429534912
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.928 Vali Acc: 0.274 Test Loss: 2.928 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.313983917236328
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 3.643 Vali Acc: 0.266 Test Loss: 3.643 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.264485120773315
Epoch: 11, Steps: 17 | Train Loss: 1.121 Vali Loss: 4.097 Vali Acc: 0.274 Test Loss: 4.097 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.101543188095093
Epoch: 12, Steps: 17 | Train Loss: 1.076 Vali Loss: 4.035 Vali Acc: 0.232 Test Loss: 4.035 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.771939039230347
Epoch: 1, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.428 Vali Acc: 0.278 Test Loss: 1.428 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 6.482563257217407
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.697 Vali Acc: 0.285 Test Loss: 1.697 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285154).  Saving model ...
Epoch: 3 cost time: 6.419803142547607
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.792 Vali Acc: 0.259 Test Loss: 1.792 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.485943078994751
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 2.297 Vali Acc: 0.262 Test Loss: 2.297 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.688261270523071
Epoch: 5, Steps: 17 | Train Loss: 1.293 Vali Loss: 2.296 Vali Acc: 0.259 Test Loss: 2.296 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.908301830291748
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 2.266 Vali Acc: 0.259 Test Loss: 2.266 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.780902862548828
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.540 Vali Acc: 0.259 Test Loss: 2.540 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.864987850189209
Epoch: 8, Steps: 17 | Train Loss: 1.114 Vali Loss: 2.358 Vali Acc: 0.247 Test Loss: 2.358 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.709091663360596
Epoch: 9, Steps: 17 | Train Loss: 1.074 Vali Loss: 3.388 Vali Acc: 0.232 Test Loss: 3.388 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.479359149932861
Epoch: 10, Steps: 17 | Train Loss: 1.060 Vali Loss: 3.564 Vali Acc: 0.262 Test Loss: 3.564 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.603184461593628
Epoch: 11, Steps: 17 | Train Loss: 0.940 Vali Loss: 4.421 Vali Acc: 0.278 Test Loss: 4.421 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.786022186279297
Epoch: 12, Steps: 17 | Train Loss: 0.808 Vali Loss: 5.734 Vali Acc: 0.247 Test Loss: 5.734 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.324618577957153
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.466 Vali Acc: 0.259 Test Loss: 1.466 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 5.542705535888672
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.988 Vali Acc: 0.266 Test Loss: 1.988 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266140).  Saving model ...
Epoch: 3 cost time: 6.00510573387146
Epoch: 3, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.775 Vali Acc: 0.194 Test Loss: 1.775 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.263139724731445
Epoch: 4, Steps: 17 | Train Loss: 1.237 Vali Loss: 2.135 Vali Acc: 0.240 Test Loss: 2.135 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.415128707885742
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 2.665 Vali Acc: 0.243 Test Loss: 2.665 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.469422340393066
Epoch: 6, Steps: 17 | Train Loss: 1.220 Vali Loss: 2.327 Vali Acc: 0.266 Test Loss: 2.327 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.301180362701416
Epoch: 7, Steps: 17 | Train Loss: 1.278 Vali Loss: 3.700 Vali Acc: 0.255 Test Loss: 3.700 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.40747594833374
Epoch: 8, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.969 Vali Acc: 0.224 Test Loss: 2.969 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.485343933105469
Epoch: 9, Steps: 17 | Train Loss: 0.848 Vali Loss: 3.775 Vali Acc: 0.236 Test Loss: 3.775 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.483084440231323
Epoch: 10, Steps: 17 | Train Loss: 0.945 Vali Loss: 4.823 Vali Acc: 0.259 Test Loss: 4.823 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.394641399383545
Epoch: 11, Steps: 17 | Train Loss: 0.788 Vali Loss: 4.762 Vali Acc: 0.240 Test Loss: 4.762 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.505753755569458
Epoch: 12, Steps: 17 | Train Loss: 0.844 Vali Loss: 4.982 Vali Acc: 0.255 Test Loss: 4.982 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.217811107635498
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.577 Vali Acc: 0.251 Test Loss: 1.577 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 5.668606996536255
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 2.006 Vali Acc: 0.247 Test Loss: 2.006 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.486834287643433
Epoch: 3, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.954 Vali Acc: 0.251 Test Loss: 1.954 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.095778942108154
Epoch: 4, Steps: 17 | Train Loss: 1.159 Vali Loss: 2.229 Vali Acc: 0.262 Test Loss: 2.229 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262335).  Saving model ...
Epoch: 5 cost time: 6.032906532287598
Epoch: 5, Steps: 17 | Train Loss: 1.097 Vali Loss: 2.291 Vali Acc: 0.243 Test Loss: 2.291 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.242792367935181
Epoch: 6, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.613 Vali Acc: 0.259 Test Loss: 2.613 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.116445541381836
Epoch: 7, Steps: 17 | Train Loss: 1.081 Vali Loss: 4.550 Vali Acc: 0.270 Test Loss: 4.550 Test Acc: 0.270
Validation loss decreased (-0.262335 --> -0.269916).  Saving model ...
Epoch: 8 cost time: 6.214939117431641
Epoch: 8, Steps: 17 | Train Loss: 1.045 Vali Loss: 3.460 Vali Acc: 0.240 Test Loss: 3.460 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.392784118652344
Epoch: 9, Steps: 17 | Train Loss: 0.842 Vali Loss: 5.552 Vali Acc: 0.240 Test Loss: 5.552 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.215703725814819
Epoch: 10, Steps: 17 | Train Loss: 0.979 Vali Loss: 4.639 Vali Acc: 0.259 Test Loss: 4.639 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.353149652481079
Epoch: 11, Steps: 17 | Train Loss: 0.663 Vali Loss: 6.487 Vali Acc: 0.247 Test Loss: 6.487 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.2833662033081055
Epoch: 12, Steps: 17 | Train Loss: 0.866 Vali Loss: 4.623 Vali Acc: 0.255 Test Loss: 4.623 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.3792078495025635
Epoch: 13, Steps: 17 | Train Loss: 0.401 Vali Loss: 7.817 Vali Acc: 0.243 Test Loss: 7.817 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.973039150238037
Epoch: 14, Steps: 17 | Train Loss: 0.549 Vali Loss: 5.659 Vali Acc: 0.247 Test Loss: 5.659 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.906542539596558
Epoch: 15, Steps: 17 | Train Loss: 0.428 Vali Loss: 7.311 Vali Acc: 0.243 Test Loss: 7.311 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.922976732254028
Epoch: 16, Steps: 17 | Train Loss: 0.573 Vali Loss: 7.306 Vali Acc: 0.274 Test Loss: 7.306 Test Acc: 0.274
Validation loss decreased (-0.269916 --> -0.273691).  Saving model ...
Epoch: 17 cost time: 6.397778749465942
Epoch: 17, Steps: 17 | Train Loss: 0.611 Vali Loss: 5.977 Vali Acc: 0.278 Test Loss: 5.977 Test Acc: 0.278
Validation loss decreased (-0.273691 --> -0.277507).  Saving model ...
Epoch: 18 cost time: 6.384490013122559
Epoch: 18, Steps: 17 | Train Loss: 0.401 Vali Loss: 7.236 Vali Acc: 0.221 Test Loss: 7.236 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.972592830657959
Epoch: 19, Steps: 17 | Train Loss: 0.208 Vali Loss: 8.295 Vali Acc: 0.247 Test Loss: 8.295 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.7560813426971436
Epoch: 20, Steps: 17 | Train Loss: 0.251 Vali Loss: 6.971 Vali Acc: 0.255 Test Loss: 6.971 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.707285404205322
Epoch: 21, Steps: 17 | Train Loss: 0.270 Vali Loss: 8.543 Vali Acc: 0.274 Test Loss: 8.543 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.2624123096466064
Epoch: 22, Steps: 17 | Train Loss: 0.210 Vali Loss: 10.268 Vali Acc: 0.266 Test Loss: 10.268 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.850709915161133
Epoch: 23, Steps: 17 | Train Loss: 0.408 Vali Loss: 8.706 Vali Acc: 0.270 Test Loss: 8.706 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.766205072402954
Epoch: 24, Steps: 17 | Train Loss: 0.793 Vali Loss: 8.863 Vali Acc: 0.285 Test Loss: 8.863 Test Acc: 0.285
Validation loss decreased (-0.277507 --> -0.285082).  Saving model ...
Epoch: 25 cost time: 6.720417022705078
Epoch: 25, Steps: 17 | Train Loss: 0.437 Vali Loss: 9.506 Vali Acc: 0.259 Test Loss: 9.506 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.550703763961792
Epoch: 26, Steps: 17 | Train Loss: 0.188 Vali Loss: 13.215 Vali Acc: 0.251 Test Loss: 13.215 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.174370765686035
Epoch: 27, Steps: 17 | Train Loss: 0.273 Vali Loss: 9.896 Vali Acc: 0.274 Test Loss: 9.896 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.197157621383667
Epoch: 28, Steps: 17 | Train Loss: 0.488 Vali Loss: 11.525 Vali Acc: 0.228 Test Loss: 11.525 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.14785099029541
Epoch: 29, Steps: 17 | Train Loss: 0.520 Vali Loss: 12.813 Vali Acc: 0.224 Test Loss: 12.813 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.566302537918091
Epoch: 30, Steps: 17 | Train Loss: 0.218 Vali Loss: 10.508 Vali Acc: 0.243 Test Loss: 10.508 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.330415725708008
Epoch: 31, Steps: 17 | Train Loss: 0.260 Vali Loss: 11.866 Vali Acc: 0.255 Test Loss: 11.866 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.081523180007935
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 12.256 Vali Acc: 0.262 Test Loss: 12.256 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.996402263641357
Epoch: 33, Steps: 17 | Train Loss: 0.420 Vali Loss: 11.146 Vali Acc: 0.262 Test Loss: 11.146 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.155481576919556
Epoch: 34, Steps: 17 | Train Loss: 0.099 Vali Loss: 9.878 Vali Acc: 0.281 Test Loss: 9.878 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.456405162811279
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.638 Vali Acc: 0.243 Test Loss: 1.638 Test Acc: 0.243
Validation loss decreased (inf --> -0.243330).  Saving model ...
Epoch: 2 cost time: 6.328681707382202
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.989 Vali Acc: 0.259 Test Loss: 1.989 Test Acc: 0.259
Validation loss decreased (-0.243330 --> -0.258535).  Saving model ...
Epoch: 3 cost time: 6.302518129348755
Epoch: 3, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.732 Vali Acc: 0.228 Test Loss: 1.732 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.490243196487427
Epoch: 4, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.561 Vali Acc: 0.270 Test Loss: 2.561 Test Acc: 0.270
Validation loss decreased (-0.258535 --> -0.269936).  Saving model ...
Epoch: 5 cost time: 6.022552251815796
Epoch: 5, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.245 Vali Acc: 0.270 Test Loss: 2.245 Test Acc: 0.270
Validation loss decreased (-0.269936 --> -0.269940).  Saving model ...
Epoch: 6 cost time: 6.067087411880493
Epoch: 6, Steps: 17 | Train Loss: 1.065 Vali Loss: 2.735 Vali Acc: 0.259 Test Loss: 2.735 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.9376060962677
Epoch: 7, Steps: 17 | Train Loss: 1.031 Vali Loss: 4.228 Vali Acc: 0.289 Test Loss: 4.228 Test Acc: 0.289
Validation loss decreased (-0.269940 --> -0.288931).  Saving model ...
Epoch: 8 cost time: 6.546754598617554
Epoch: 8, Steps: 17 | Train Loss: 0.852 Vali Loss: 4.803 Vali Acc: 0.270 Test Loss: 4.803 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.282252788543701
Epoch: 9, Steps: 17 | Train Loss: 0.689 Vali Loss: 4.530 Vali Acc: 0.266 Test Loss: 4.530 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.629539966583252
Epoch: 10, Steps: 17 | Train Loss: 0.681 Vali Loss: 4.502 Vali Acc: 0.289 Test Loss: 4.502 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.2141523361206055
Epoch: 11, Steps: 17 | Train Loss: 0.540 Vali Loss: 5.767 Vali Acc: 0.255 Test Loss: 5.767 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.188279628753662
Epoch: 12, Steps: 17 | Train Loss: 0.718 Vali Loss: 5.597 Vali Acc: 0.266 Test Loss: 5.597 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.2723236083984375
Epoch: 13, Steps: 17 | Train Loss: 0.454 Vali Loss: 6.417 Vali Acc: 0.274 Test Loss: 6.417 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.000698089599609
Epoch: 14, Steps: 17 | Train Loss: 0.322 Vali Loss: 5.808 Vali Acc: 0.251 Test Loss: 5.808 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.117338418960571
Epoch: 15, Steps: 17 | Train Loss: 0.351 Vali Loss: 6.749 Vali Acc: 0.293 Test Loss: 6.749 Test Acc: 0.293
Validation loss decreased (-0.288931 --> -0.292708).  Saving model ...
Epoch: 16 cost time: 7.17743706703186
Epoch: 16, Steps: 17 | Train Loss: 0.459 Vali Loss: 6.229 Vali Acc: 0.289 Test Loss: 6.229 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.962788343429565
Epoch: 17, Steps: 17 | Train Loss: 0.309 Vali Loss: 7.245 Vali Acc: 0.259 Test Loss: 7.245 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.2926344871521
Epoch: 18, Steps: 17 | Train Loss: 0.436 Vali Loss: 8.488 Vali Acc: 0.266 Test Loss: 8.488 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.201313734054565
Epoch: 19, Steps: 17 | Train Loss: 0.423 Vali Loss: 6.909 Vali Acc: 0.247 Test Loss: 6.909 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.030384063720703
Epoch: 20, Steps: 17 | Train Loss: 0.377 Vali Loss: 7.981 Vali Acc: 0.293 Test Loss: 7.981 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.605830192565918
Epoch: 21, Steps: 17 | Train Loss: 0.463 Vali Loss: 10.205 Vali Acc: 0.278 Test Loss: 10.205 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.442462921142578
Epoch: 22, Steps: 17 | Train Loss: 0.350 Vali Loss: 9.341 Vali Acc: 0.262 Test Loss: 9.341 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.586477041244507
Epoch: 23, Steps: 17 | Train Loss: 0.265 Vali Loss: 9.011 Vali Acc: 0.243 Test Loss: 9.011 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.10986876487732
Epoch: 24, Steps: 17 | Train Loss: 0.216 Vali Loss: 10.107 Vali Acc: 0.266 Test Loss: 10.107 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.510953426361084
Epoch: 25, Steps: 17 | Train Loss: 0.434 Vali Loss: 9.491 Vali Acc: 0.259 Test Loss: 9.491 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.554295301437378
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.532 Vali Acc: 0.278 Test Loss: 1.532 Test Acc: 0.278
Validation loss decreased (inf --> -0.277551).  Saving model ...
Epoch: 2 cost time: 9.935930252075195
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.921 Vali Acc: 0.240 Test Loss: 1.921 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.460171937942505
Epoch: 3, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.993 Vali Acc: 0.243 Test Loss: 1.993 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.580957174301147
Epoch: 4, Steps: 17 | Train Loss: 1.202 Vali Loss: 2.379 Vali Acc: 0.251 Test Loss: 2.379 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.067183256149292
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 2.379 Vali Acc: 0.278 Test Loss: 2.379 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.841666221618652
Epoch: 6, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.375 Vali Acc: 0.255 Test Loss: 2.375 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.579312086105347
Epoch: 7, Steps: 17 | Train Loss: 1.058 Vali Loss: 4.228 Vali Acc: 0.240 Test Loss: 4.228 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.176008939743042
Epoch: 8, Steps: 17 | Train Loss: 0.894 Vali Loss: 3.333 Vali Acc: 0.285 Test Loss: 3.333 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285138).  Saving model ...
Epoch: 9 cost time: 8.297246932983398
Epoch: 9, Steps: 17 | Train Loss: 0.745 Vali Loss: 4.913 Vali Acc: 0.262 Test Loss: 4.913 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.426956653594971
Epoch: 10, Steps: 17 | Train Loss: 0.742 Vali Loss: 4.072 Vali Acc: 0.243 Test Loss: 4.072 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.300679445266724
Epoch: 11, Steps: 17 | Train Loss: 0.669 Vali Loss: 5.163 Vali Acc: 0.247 Test Loss: 5.163 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.898820161819458
Epoch: 12, Steps: 17 | Train Loss: 0.554 Vali Loss: 4.997 Vali Acc: 0.259 Test Loss: 4.997 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.773269653320312
Epoch: 13, Steps: 17 | Train Loss: 0.635 Vali Loss: 4.876 Vali Acc: 0.236 Test Loss: 4.876 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.387717485427856
Epoch: 14, Steps: 17 | Train Loss: 0.424 Vali Loss: 5.055 Vali Acc: 0.255 Test Loss: 5.055 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.05603289604187
Epoch: 15, Steps: 17 | Train Loss: 0.478 Vali Loss: 5.850 Vali Acc: 0.217 Test Loss: 5.850 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.164868116378784
Epoch: 16, Steps: 17 | Train Loss: 0.386 Vali Loss: 6.239 Vali Acc: 0.236 Test Loss: 6.239 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.5353524684906
Epoch: 17, Steps: 17 | Train Loss: 0.296 Vali Loss: 5.968 Vali Acc: 0.221 Test Loss: 5.968 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.686739206314087
Epoch: 18, Steps: 17 | Train Loss: 0.304 Vali Loss: 7.001 Vali Acc: 0.228 Test Loss: 7.001 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.148852109909058
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.491 Vali Acc: 0.289 Test Loss: 1.491 Test Acc: 0.289
Validation loss decreased (inf --> -0.288958).  Saving model ...
Epoch: 2 cost time: 8.17239785194397
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.980 Vali Acc: 0.304 Test Loss: 1.980 Test Acc: 0.304
Validation loss decreased (-0.288958 --> -0.304163).  Saving model ...
Epoch: 3 cost time: 8.33081579208374
Epoch: 3, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.110 Vali Acc: 0.285 Test Loss: 2.110 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.612961053848267
Epoch: 4, Steps: 17 | Train Loss: 1.227 Vali Loss: 2.215 Vali Acc: 0.259 Test Loss: 2.215 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.171980142593384
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.181358575820923
Epoch: 6, Steps: 17 | Train Loss: 1.217 Vali Loss: 2.308 Vali Acc: 0.262 Test Loss: 2.308 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.898003816604614
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 5.509 Vali Acc: 0.262 Test Loss: 5.509 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.975136756896973
Epoch: 8, Steps: 17 | Train Loss: 1.063 Vali Loss: 2.868 Vali Acc: 0.274 Test Loss: 2.868 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.13666844367981
Epoch: 9, Steps: 17 | Train Loss: 0.799 Vali Loss: 4.178 Vali Acc: 0.289 Test Loss: 4.178 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.50554370880127
Epoch: 10, Steps: 17 | Train Loss: 0.827 Vali Loss: 3.733 Vali Acc: 0.270 Test Loss: 3.733 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.563006401062012
Epoch: 11, Steps: 17 | Train Loss: 0.767 Vali Loss: 5.521 Vali Acc: 0.266 Test Loss: 5.521 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.851309061050415
Epoch: 12, Steps: 17 | Train Loss: 0.871 Vali Loss: 4.049 Vali Acc: 0.289 Test Loss: 4.049 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.134466409683228
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.550 Vali Acc: 0.270 Test Loss: 1.550 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 9.045581579208374
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 2.085 Vali Acc: 0.266 Test Loss: 2.085 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.768336534500122
Epoch: 3, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.285 Vali Acc: 0.259 Test Loss: 2.285 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.370931148529053
Epoch: 4, Steps: 17 | Train Loss: 1.272 Vali Loss: 2.939 Vali Acc: 0.262 Test Loss: 2.939 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.71523666381836
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 2.866 Vali Acc: 0.232 Test Loss: 2.866 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.573104619979858
Epoch: 6, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.216 Vali Acc: 0.251 Test Loss: 2.216 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.79298710823059
Epoch: 7, Steps: 17 | Train Loss: 1.216 Vali Loss: 4.950 Vali Acc: 0.262 Test Loss: 4.950 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.255376815795898
Epoch: 8, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.868 Vali Acc: 0.274 Test Loss: 2.868 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273736).  Saving model ...
Epoch: 9 cost time: 9.155123472213745
Epoch: 9, Steps: 17 | Train Loss: 0.978 Vali Loss: 4.607 Vali Acc: 0.240 Test Loss: 4.607 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.836332082748413
Epoch: 10, Steps: 17 | Train Loss: 1.060 Vali Loss: 4.138 Vali Acc: 0.243 Test Loss: 4.138 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.579933881759644
Epoch: 11, Steps: 17 | Train Loss: 0.964 Vali Loss: 6.487 Vali Acc: 0.255 Test Loss: 6.487 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.526330947875977
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 5.243 Vali Acc: 0.255 Test Loss: 5.243 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.076667308807373
Epoch: 13, Steps: 17 | Train Loss: 0.735 Vali Loss: 6.336 Vali Acc: 0.266 Test Loss: 6.336 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.737356185913086
Epoch: 14, Steps: 17 | Train Loss: 0.633 Vali Loss: 6.399 Vali Acc: 0.255 Test Loss: 6.399 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.964236497879028
Epoch: 15, Steps: 17 | Train Loss: 0.691 Vali Loss: 5.698 Vali Acc: 0.278 Test Loss: 5.698 Test Acc: 0.278
Validation loss decreased (-0.273736 --> -0.277510).  Saving model ...
Epoch: 16 cost time: 8.172983169555664
Epoch: 16, Steps: 17 | Train Loss: 0.516 Vali Loss: 7.137 Vali Acc: 0.247 Test Loss: 7.137 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.812946796417236
Epoch: 17, Steps: 17 | Train Loss: 0.597 Vali Loss: 6.420 Vali Acc: 0.259 Test Loss: 6.420 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.377224683761597
Epoch: 18, Steps: 17 | Train Loss: 0.562 Vali Loss: 6.455 Vali Acc: 0.266 Test Loss: 6.455 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.173245429992676
Epoch: 19, Steps: 17 | Train Loss: 0.475 Vali Loss: 6.371 Vali Acc: 0.274 Test Loss: 6.371 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.234960794448853
Epoch: 20, Steps: 17 | Train Loss: 0.548 Vali Loss: 7.972 Vali Acc: 0.251 Test Loss: 7.972 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.095211744308472
Epoch: 21, Steps: 17 | Train Loss: 0.837 Vali Loss: 7.894 Vali Acc: 0.236 Test Loss: 7.894 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.212742328643799
Epoch: 22, Steps: 17 | Train Loss: 0.448 Vali Loss: 10.117 Vali Acc: 0.255 Test Loss: 10.117 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.301734685897827
Epoch: 23, Steps: 17 | Train Loss: 0.732 Vali Loss: 8.880 Vali Acc: 0.247 Test Loss: 8.880 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.822210788726807
Epoch: 24, Steps: 17 | Train Loss: 0.513 Vali Loss: 11.721 Vali Acc: 0.232 Test Loss: 11.721 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.221336841583252
Epoch: 25, Steps: 17 | Train Loss: 0.500 Vali Loss: 8.933 Vali Acc: 0.240 Test Loss: 8.933 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.603953123092651
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 8.306382656097412
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 2.121 Vali Acc: 0.266 Test Loss: 2.121 Test Acc: 0.266
Validation loss decreased (-0.247133 --> -0.266138).  Saving model ...
Epoch: 3 cost time: 9.076655626296997
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 2.667 Vali Acc: 0.251 Test Loss: 2.667 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.498573780059814
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 2.711 Vali Acc: 0.251 Test Loss: 2.711 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.985577821731567
Epoch: 5, Steps: 17 | Train Loss: 1.338 Vali Loss: 3.157 Vali Acc: 0.251 Test Loss: 3.157 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.43388319015503
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 2.802 Vali Acc: 0.247 Test Loss: 2.802 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.440231323242188
Epoch: 7, Steps: 17 | Train Loss: 1.331 Vali Loss: 5.567 Vali Acc: 0.247 Test Loss: 5.567 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.834733724594116
Epoch: 8, Steps: 17 | Train Loss: 1.143 Vali Loss: 2.917 Vali Acc: 0.243 Test Loss: 2.917 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.260600566864014
Epoch: 9, Steps: 17 | Train Loss: 1.052 Vali Loss: 4.747 Vali Acc: 0.228 Test Loss: 4.747 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.299249172210693
Epoch: 10, Steps: 17 | Train Loss: 1.073 Vali Loss: 5.874 Vali Acc: 0.240 Test Loss: 5.874 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.947338104248047
Epoch: 11, Steps: 17 | Train Loss: 1.079 Vali Loss: 6.328 Vali Acc: 0.243 Test Loss: 6.328 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.026191711425781
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 5.203 Vali Acc: 0.251 Test Loss: 5.203 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.381442785263062
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.565 Vali Acc: 0.251 Test Loss: 1.565 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 8.823339939117432
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 2.105 Vali Acc: 0.228 Test Loss: 2.105 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.12910532951355
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 2.784 Vali Acc: 0.247 Test Loss: 2.784 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.138854026794434
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 3.127 Vali Acc: 0.247 Test Loss: 3.127 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.816434860229492
Epoch: 5, Steps: 17 | Train Loss: 1.486 Vali Loss: 3.812 Vali Acc: 0.274 Test Loss: 3.812 Test Acc: 0.274
Validation loss decreased (-0.250935 --> -0.273726).  Saving model ...
Epoch: 6 cost time: 8.204460620880127
Epoch: 6, Steps: 17 | Train Loss: 1.411 Vali Loss: 3.164 Vali Acc: 0.266 Test Loss: 3.164 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.037793636322021
Epoch: 7, Steps: 17 | Train Loss: 1.572 Vali Loss: 6.158 Vali Acc: 0.247 Test Loss: 6.158 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.074236869812012
Epoch: 8, Steps: 17 | Train Loss: 1.391 Vali Loss: 3.461 Vali Acc: 0.232 Test Loss: 3.461 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.585278749465942
Epoch: 9, Steps: 17 | Train Loss: 1.362 Vali Loss: 4.730 Vali Acc: 0.240 Test Loss: 4.730 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.220525741577148
Epoch: 10, Steps: 17 | Train Loss: 1.272 Vali Loss: 5.395 Vali Acc: 0.262 Test Loss: 5.395 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.784535646438599
Epoch: 11, Steps: 17 | Train Loss: 1.358 Vali Loss: 5.636 Vali Acc: 0.262 Test Loss: 5.636 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.226382970809937
Epoch: 12, Steps: 17 | Train Loss: 1.217 Vali Loss: 6.216 Vali Acc: 0.251 Test Loss: 6.216 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.976033926010132
Epoch: 13, Steps: 17 | Train Loss: 1.350 Vali Loss: 6.873 Vali Acc: 0.259 Test Loss: 6.873 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.714139699935913
Epoch: 14, Steps: 17 | Train Loss: 0.982 Vali Loss: 6.500 Vali Acc: 0.251 Test Loss: 6.500 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.40398097038269
Epoch: 15, Steps: 17 | Train Loss: 0.981 Vali Loss: 6.274 Vali Acc: 0.255 Test Loss: 6.274 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1009028
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.194190263748169
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.432 Vali Acc: 0.278 Test Loss: 1.432 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 12.933799505233765
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 2.159 Vali Acc: 0.247 Test Loss: 2.159 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.386152982711792
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.908 Vali Acc: 0.259 Test Loss: 1.908 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.1497642993927
Epoch: 4, Steps: 17 | Train Loss: 1.472 Vali Loss: 2.901 Vali Acc: 0.274 Test Loss: 2.901 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.91199016571045
Epoch: 5, Steps: 17 | Train Loss: 1.628 Vali Loss: 2.142 Vali Acc: 0.266 Test Loss: 2.142 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.951189517974854
Epoch: 6, Steps: 17 | Train Loss: 1.212 Vali Loss: 2.838 Vali Acc: 0.228 Test Loss: 2.838 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.00917911529541
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 3.230 Vali Acc: 0.266 Test Loss: 3.230 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.623477220535278
Epoch: 8, Steps: 17 | Train Loss: 1.431 Vali Loss: 2.569 Vali Acc: 0.247 Test Loss: 2.569 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.74533224105835
Epoch: 9, Steps: 17 | Train Loss: 1.060 Vali Loss: 3.058 Vali Acc: 0.285 Test Loss: 3.058 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285141).  Saving model ...
Epoch: 10 cost time: 13.081190347671509
Epoch: 10, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.803 Vali Acc: 0.281 Test Loss: 2.803 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.357455968856812
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 3.987 Vali Acc: 0.266 Test Loss: 3.987 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.156016826629639
Epoch: 12, Steps: 17 | Train Loss: 0.893 Vali Loss: 4.790 Vali Acc: 0.243 Test Loss: 4.790 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.747849225997925
Epoch: 13, Steps: 17 | Train Loss: 1.146 Vali Loss: 3.875 Vali Acc: 0.255 Test Loss: 3.875 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.562560319900513
Epoch: 14, Steps: 17 | Train Loss: 0.994 Vali Loss: 4.278 Vali Acc: 0.224 Test Loss: 4.278 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.12576150894165
Epoch: 15, Steps: 17 | Train Loss: 0.840 Vali Loss: 3.675 Vali Acc: 0.274 Test Loss: 3.675 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.408397436141968
Epoch: 16, Steps: 17 | Train Loss: 0.854 Vali Loss: 5.056 Vali Acc: 0.240 Test Loss: 5.056 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.570544242858887
Epoch: 17, Steps: 17 | Train Loss: 1.093 Vali Loss: 5.187 Vali Acc: 0.236 Test Loss: 5.187 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.908920526504517
Epoch: 18, Steps: 17 | Train Loss: 0.779 Vali Loss: 4.436 Vali Acc: 0.262 Test Loss: 4.436 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.07062029838562
Epoch: 19, Steps: 17 | Train Loss: 0.418 Vali Loss: 5.372 Vali Acc: 0.240 Test Loss: 5.372 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.969444751739502
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 12.623194217681885
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 2.195 Vali Acc: 0.232 Test Loss: 2.195 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.530870914459229
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 2.007 Vali Acc: 0.240 Test Loss: 2.007 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.587109327316284
Epoch: 4, Steps: 17 | Train Loss: 1.510 Vali Loss: 2.757 Vali Acc: 0.247 Test Loss: 2.757 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.137747764587402
Epoch: 5, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.935 Vali Acc: 0.262 Test Loss: 1.935 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262338).  Saving model ...
Epoch: 6 cost time: 12.458091974258423
Epoch: 6, Steps: 17 | Train Loss: 1.116 Vali Loss: 2.305 Vali Acc: 0.266 Test Loss: 2.305 Test Acc: 0.266
Validation loss decreased (-0.262338 --> -0.266137).  Saving model ...
Epoch: 7 cost time: 11.959958553314209
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 2.840 Vali Acc: 0.262 Test Loss: 2.840 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.85328221321106
Epoch: 8, Steps: 17 | Train Loss: 1.343 Vali Loss: 3.525 Vali Acc: 0.281 Test Loss: 3.525 Test Acc: 0.281
Validation loss decreased (-0.266137 --> -0.281334).  Saving model ...
Epoch: 9 cost time: 12.571831226348877
Epoch: 9, Steps: 17 | Train Loss: 1.173 Vali Loss: 2.629 Vali Acc: 0.262 Test Loss: 2.629 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.421213150024414
Epoch: 10, Steps: 17 | Train Loss: 0.909 Vali Loss: 3.531 Vali Acc: 0.266 Test Loss: 3.531 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.066206216812134
Epoch: 11, Steps: 17 | Train Loss: 1.093 Vali Loss: 3.551 Vali Acc: 0.259 Test Loss: 3.551 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.885551452636719
Epoch: 12, Steps: 17 | Train Loss: 1.161 Vali Loss: 3.940 Vali Acc: 0.270 Test Loss: 3.940 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.169080018997192
Epoch: 13, Steps: 17 | Train Loss: 0.901 Vali Loss: 3.528 Vali Acc: 0.270 Test Loss: 3.528 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.887627601623535
Epoch: 14, Steps: 17 | Train Loss: 0.638 Vali Loss: 5.157 Vali Acc: 0.270 Test Loss: 5.157 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.466481685638428
Epoch: 15, Steps: 17 | Train Loss: 0.617 Vali Loss: 4.479 Vali Acc: 0.240 Test Loss: 4.479 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.072676658630371
Epoch: 16, Steps: 17 | Train Loss: 0.604 Vali Loss: 4.516 Vali Acc: 0.247 Test Loss: 4.516 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.87702226638794
Epoch: 17, Steps: 17 | Train Loss: 0.716 Vali Loss: 5.206 Vali Acc: 0.255 Test Loss: 5.206 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.07220983505249
Epoch: 18, Steps: 17 | Train Loss: 0.701 Vali Loss: 4.830 Vali Acc: 0.243 Test Loss: 4.830 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.981731653213501
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.507 Vali Acc: 0.228 Test Loss: 1.507 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 10.853362321853638
Epoch: 2, Steps: 17 | Train Loss: 1.412 Vali Loss: 2.355 Vali Acc: 0.232 Test Loss: 2.355 Test Acc: 0.232
Validation loss decreased (-0.228122 --> -0.231916).  Saving model ...
Epoch: 3 cost time: 10.16239619255066
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 2.242 Vali Acc: 0.221 Test Loss: 2.242 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.694584131240845
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 2.928 Vali Acc: 0.255 Test Loss: 2.928 Test Acc: 0.255
Validation loss decreased (-0.231916 --> -0.254724).  Saving model ...
Epoch: 5 cost time: 11.208234071731567
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 2.281 Vali Acc: 0.217 Test Loss: 2.281 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.382203817367554
Epoch: 6, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.493 Vali Acc: 0.262 Test Loss: 2.493 Test Acc: 0.262
Validation loss decreased (-0.254724 --> -0.262332).  Saving model ...
Epoch: 7 cost time: 11.178258180618286
Epoch: 7, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.779 Vali Acc: 0.251 Test Loss: 2.779 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.43946647644043
Epoch: 8, Steps: 17 | Train Loss: 0.979 Vali Loss: 2.943 Vali Acc: 0.243 Test Loss: 2.943 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.133322477340698
Epoch: 9, Steps: 17 | Train Loss: 0.811 Vali Loss: 3.584 Vali Acc: 0.240 Test Loss: 3.584 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.027870655059814
Epoch: 10, Steps: 17 | Train Loss: 0.816 Vali Loss: 3.668 Vali Acc: 0.240 Test Loss: 3.668 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.909716844558716
Epoch: 11, Steps: 17 | Train Loss: 0.652 Vali Loss: 3.925 Vali Acc: 0.247 Test Loss: 3.925 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.933631420135498
Epoch: 12, Steps: 17 | Train Loss: 0.710 Vali Loss: 5.003 Vali Acc: 0.240 Test Loss: 5.003 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.483347177505493
Epoch: 13, Steps: 17 | Train Loss: 0.772 Vali Loss: 6.428 Vali Acc: 0.274 Test Loss: 6.428 Test Acc: 0.274
Validation loss decreased (-0.262332 --> -0.273700).  Saving model ...
Epoch: 14 cost time: 10.557476043701172
Epoch: 14, Steps: 17 | Train Loss: 0.979 Vali Loss: 6.485 Vali Acc: 0.236 Test Loss: 6.485 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.737180948257446
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 5.176 Vali Acc: 0.236 Test Loss: 5.176 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.796504735946655
Epoch: 16, Steps: 17 | Train Loss: 0.521 Vali Loss: 7.059 Vali Acc: 0.243 Test Loss: 7.059 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.375646352767944
Epoch: 17, Steps: 17 | Train Loss: 0.958 Vali Loss: 8.252 Vali Acc: 0.247 Test Loss: 8.252 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.351521968841553
Epoch: 18, Steps: 17 | Train Loss: 0.652 Vali Loss: 6.797 Vali Acc: 0.240 Test Loss: 6.797 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.611090421676636
Epoch: 19, Steps: 17 | Train Loss: 0.371 Vali Loss: 6.626 Vali Acc: 0.240 Test Loss: 6.626 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.228707551956177
Epoch: 20, Steps: 17 | Train Loss: 0.421 Vali Loss: 7.367 Vali Acc: 0.240 Test Loss: 7.367 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.757153272628784
Epoch: 21, Steps: 17 | Train Loss: 0.524 Vali Loss: 6.877 Vali Acc: 0.255 Test Loss: 6.877 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.05894660949707
Epoch: 22, Steps: 17 | Train Loss: 0.466 Vali Loss: 7.285 Vali Acc: 0.266 Test Loss: 7.285 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.138713836669922
Epoch: 23, Steps: 17 | Train Loss: 0.415 Vali Loss: 10.144 Vali Acc: 0.243 Test Loss: 10.144 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.486965417861938
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.704 Vali Acc: 0.228 Test Loss: 1.704 Test Acc: 0.228
Validation loss decreased (inf --> -0.228120).  Saving model ...
Epoch: 2 cost time: 10.540247440338135
Epoch: 2, Steps: 17 | Train Loss: 1.404 Vali Loss: 2.185 Vali Acc: 0.240 Test Loss: 2.185 Test Acc: 0.240
Validation loss decreased (-0.228120 --> -0.239522).  Saving model ...
Epoch: 3 cost time: 11.259952783584595
Epoch: 3, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.916 Vali Acc: 0.240 Test Loss: 2.916 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.333765029907227
Epoch: 4, Steps: 17 | Train Loss: 1.487 Vali Loss: 3.044 Vali Acc: 0.262 Test Loss: 3.044 Test Acc: 0.262
Validation loss decreased (-0.239522 --> -0.262327).  Saving model ...
Epoch: 5 cost time: 10.698280096054077
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 2.673 Vali Acc: 0.247 Test Loss: 2.673 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.056824445724487
Epoch: 6, Steps: 17 | Train Loss: 1.033 Vali Loss: 3.143 Vali Acc: 0.274 Test Loss: 3.143 Test Acc: 0.274
Validation loss decreased (-0.262327 --> -0.273733).  Saving model ...
Epoch: 7 cost time: 10.208309888839722
Epoch: 7, Steps: 17 | Train Loss: 1.079 Vali Loss: 4.008 Vali Acc: 0.274 Test Loss: 4.008 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.246611595153809
Epoch: 8, Steps: 17 | Train Loss: 1.035 Vali Loss: 3.370 Vali Acc: 0.232 Test Loss: 3.370 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.677363157272339
Epoch: 9, Steps: 17 | Train Loss: 0.960 Vali Loss: 4.770 Vali Acc: 0.240 Test Loss: 4.770 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.856647729873657
Epoch: 10, Steps: 17 | Train Loss: 1.089 Vali Loss: 4.184 Vali Acc: 0.228 Test Loss: 4.184 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.286576986312866
Epoch: 11, Steps: 17 | Train Loss: 0.690 Vali Loss: 5.967 Vali Acc: 0.266 Test Loss: 5.967 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.89710021018982
Epoch: 12, Steps: 17 | Train Loss: 0.603 Vali Loss: 5.654 Vali Acc: 0.243 Test Loss: 5.654 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.694592714309692
Epoch: 13, Steps: 17 | Train Loss: 0.552 Vali Loss: 4.971 Vali Acc: 0.221 Test Loss: 4.971 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.366277694702148
Epoch: 14, Steps: 17 | Train Loss: 0.655 Vali Loss: 7.703 Vali Acc: 0.228 Test Loss: 7.703 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.385193347930908
Epoch: 15, Steps: 17 | Train Loss: 0.564 Vali Loss: 7.370 Vali Acc: 0.259 Test Loss: 7.370 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.248543977737427
Epoch: 16, Steps: 17 | Train Loss: 0.709 Vali Loss: 8.681 Vali Acc: 0.251 Test Loss: 8.681 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.485161542892456
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.664 Vali Acc: 0.274 Test Loss: 1.664 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 9.852560043334961
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 2.160 Vali Acc: 0.240 Test Loss: 2.160 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.71162486076355
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 2.571 Vali Acc: 0.278 Test Loss: 2.571 Test Acc: 0.278
Validation loss decreased (-0.273748 --> -0.277541).  Saving model ...
Epoch: 4 cost time: 11.88946795463562
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 2.254 Vali Acc: 0.240 Test Loss: 2.254 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.899361610412598
Epoch: 5, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.585 Vali Acc: 0.251 Test Loss: 2.585 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.989609479904175
Epoch: 6, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.731 Vali Acc: 0.274 Test Loss: 2.731 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.554015398025513
Epoch: 7, Steps: 17 | Train Loss: 1.052 Vali Loss: 4.069 Vali Acc: 0.281 Test Loss: 4.069 Test Acc: 0.281
Validation loss decreased (-0.277541 --> -0.281328).  Saving model ...
Epoch: 8 cost time: 11.264945030212402
Epoch: 8, Steps: 17 | Train Loss: 0.905 Vali Loss: 3.415 Vali Acc: 0.281 Test Loss: 3.415 Test Acc: 0.281
Validation loss decreased (-0.281328 --> -0.281335).  Saving model ...
Epoch: 9 cost time: 10.764358043670654
Epoch: 9, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.395 Vali Acc: 0.221 Test Loss: 3.395 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.090378761291504
Epoch: 10, Steps: 17 | Train Loss: 0.754 Vali Loss: 4.955 Vali Acc: 0.270 Test Loss: 4.955 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.550076961517334
Epoch: 11, Steps: 17 | Train Loss: 0.617 Vali Loss: 5.589 Vali Acc: 0.270 Test Loss: 5.589 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.071190357208252
Epoch: 12, Steps: 17 | Train Loss: 0.440 Vali Loss: 6.179 Vali Acc: 0.274 Test Loss: 6.179 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.4300856590271
Epoch: 13, Steps: 17 | Train Loss: 0.640 Vali Loss: 5.907 Vali Acc: 0.281 Test Loss: 5.907 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.374185562133789
Epoch: 14, Steps: 17 | Train Loss: 0.648 Vali Loss: 8.279 Vali Acc: 0.259 Test Loss: 8.279 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.316734313964844
Epoch: 15, Steps: 17 | Train Loss: 0.459 Vali Loss: 5.796 Vali Acc: 0.251 Test Loss: 5.796 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.58005690574646
Epoch: 16, Steps: 17 | Train Loss: 0.433 Vali Loss: 8.073 Vali Acc: 0.270 Test Loss: 8.073 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.409939289093018
Epoch: 17, Steps: 17 | Train Loss: 0.482 Vali Loss: 8.138 Vali Acc: 0.281 Test Loss: 8.138 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.798364400863647
Epoch: 18, Steps: 17 | Train Loss: 0.367 Vali Loss: 8.500 Vali Acc: 0.285 Test Loss: 8.500 Test Acc: 0.285
Validation loss decreased (-0.281335 --> -0.285086).  Saving model ...
Epoch: 19 cost time: 11.474927425384521
Epoch: 19, Steps: 17 | Train Loss: 0.528 Vali Loss: 10.437 Vali Acc: 0.259 Test Loss: 10.437 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.819344520568848
Epoch: 20, Steps: 17 | Train Loss: 0.826 Vali Loss: 11.754 Vali Acc: 0.289 Test Loss: 11.754 Test Acc: 0.289
Validation loss decreased (-0.285086 --> -0.288856).  Saving model ...
Epoch: 21 cost time: 11.611350297927856
Epoch: 21, Steps: 17 | Train Loss: 0.805 Vali Loss: 8.956 Vali Acc: 0.259 Test Loss: 8.956 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.213050842285156
Epoch: 22, Steps: 17 | Train Loss: 0.354 Vali Loss: 9.610 Vali Acc: 0.262 Test Loss: 9.610 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.821079730987549
Epoch: 23, Steps: 17 | Train Loss: 0.258 Vali Loss: 9.363 Vali Acc: 0.266 Test Loss: 9.363 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.43129849433899
Epoch: 24, Steps: 17 | Train Loss: 0.202 Vali Loss: 8.314 Vali Acc: 0.247 Test Loss: 8.314 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.444036722183228
Epoch: 25, Steps: 17 | Train Loss: 0.241 Vali Loss: 13.743 Vali Acc: 0.255 Test Loss: 13.743 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.890692949295044
Epoch: 26, Steps: 17 | Train Loss: 0.514 Vali Loss: 9.617 Vali Acc: 0.224 Test Loss: 9.617 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.539851903915405
Epoch: 27, Steps: 17 | Train Loss: 0.194 Vali Loss: 10.530 Vali Acc: 0.251 Test Loss: 10.530 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.744178295135498
Epoch: 28, Steps: 17 | Train Loss: 0.280 Vali Loss: 9.963 Vali Acc: 0.300 Test Loss: 9.963 Test Acc: 0.300
Validation loss decreased (-0.288856 --> -0.300281).  Saving model ...
Epoch: 29 cost time: 11.128327369689941
Epoch: 29, Steps: 17 | Train Loss: 0.380 Vali Loss: 9.980 Vali Acc: 0.278 Test Loss: 9.980 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.768259286880493
Epoch: 30, Steps: 17 | Train Loss: 0.280 Vali Loss: 11.739 Vali Acc: 0.255 Test Loss: 11.739 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 10.715057373046875
Epoch: 31, Steps: 17 | Train Loss: 0.374 Vali Loss: 15.132 Vali Acc: 0.240 Test Loss: 15.132 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 9.802535057067871
Epoch: 32, Steps: 17 | Train Loss: 0.542 Vali Loss: 14.486 Vali Acc: 0.247 Test Loss: 14.486 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 9.681119203567505
Epoch: 33, Steps: 17 | Train Loss: 0.370 Vali Loss: 12.886 Vali Acc: 0.243 Test Loss: 12.886 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 9.72036099433899
Epoch: 34, Steps: 17 | Train Loss: 0.267 Vali Loss: 14.724 Vali Acc: 0.274 Test Loss: 14.724 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 9.34346055984497
Epoch: 35, Steps: 17 | Train Loss: 0.236 Vali Loss: 12.976 Vali Acc: 0.278 Test Loss: 12.976 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 9.907723665237427
Epoch: 36, Steps: 17 | Train Loss: 0.138 Vali Loss: 12.030 Vali Acc: 0.240 Test Loss: 12.030 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 10.66808795928955
Epoch: 37, Steps: 17 | Train Loss: 0.115 Vali Loss: 14.572 Vali Acc: 0.232 Test Loss: 14.572 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 10.788028955459595
Epoch: 38, Steps: 17 | Train Loss: 0.059 Vali Loss: 14.261 Vali Acc: 0.259 Test Loss: 14.261 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.280982971191406
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.688 Vali Acc: 0.251 Test Loss: 1.688 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 10.974556684494019
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 2.347 Vali Acc: 0.240 Test Loss: 2.347 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.580677270889282
Epoch: 3, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.716 Vali Acc: 0.262 Test Loss: 2.716 Test Acc: 0.262
Validation loss decreased (-0.250934 --> -0.262330).  Saving model ...
Epoch: 4 cost time: 11.004114627838135
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.672 Vali Acc: 0.251 Test Loss: 2.672 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.45865249633789
Epoch: 5, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.614 Vali Acc: 0.255 Test Loss: 2.614 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.831950664520264
Epoch: 6, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.612 Vali Acc: 0.259 Test Loss: 2.612 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.776058435440063
Epoch: 7, Steps: 17 | Train Loss: 1.027 Vali Loss: 4.158 Vali Acc: 0.255 Test Loss: 4.158 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.666497945785522
Epoch: 8, Steps: 17 | Train Loss: 0.937 Vali Loss: 3.551 Vali Acc: 0.255 Test Loss: 3.551 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.173577785491943
Epoch: 9, Steps: 17 | Train Loss: 0.789 Vali Loss: 3.118 Vali Acc: 0.236 Test Loss: 3.118 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.378645896911621
Epoch: 10, Steps: 17 | Train Loss: 0.649 Vali Loss: 4.929 Vali Acc: 0.247 Test Loss: 4.929 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.841921329498291
Epoch: 11, Steps: 17 | Train Loss: 0.667 Vali Loss: 4.806 Vali Acc: 0.255 Test Loss: 4.806 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.893983125686646
Epoch: 12, Steps: 17 | Train Loss: 0.568 Vali Loss: 5.325 Vali Acc: 0.259 Test Loss: 5.325 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.124824285507202
Epoch: 13, Steps: 17 | Train Loss: 0.495 Vali Loss: 4.542 Vali Acc: 0.236 Test Loss: 4.542 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.436472654342651
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.620 Vali Acc: 0.281 Test Loss: 1.620 Test Acc: 0.281
Validation loss decreased (inf --> -0.281353).  Saving model ...
Epoch: 2 cost time: 9.72867465019226
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 2.641 Vali Acc: 0.270 Test Loss: 2.641 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.563147783279419
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 2.969 Vali Acc: 0.270 Test Loss: 2.969 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.439148426055908
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 2.788 Vali Acc: 0.266 Test Loss: 2.788 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.980215311050415
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 3.021 Vali Acc: 0.278 Test Loss: 3.021 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.44157075881958
Epoch: 6, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.693 Vali Acc: 0.270 Test Loss: 2.693 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.615310907363892
Epoch: 7, Steps: 17 | Train Loss: 1.168 Vali Loss: 3.228 Vali Acc: 0.259 Test Loss: 3.228 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.671845197677612
Epoch: 8, Steps: 17 | Train Loss: 1.057 Vali Loss: 3.405 Vali Acc: 0.270 Test Loss: 3.405 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.556054830551147
Epoch: 9, Steps: 17 | Train Loss: 0.927 Vali Loss: 3.040 Vali Acc: 0.247 Test Loss: 3.040 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.089148998260498
Epoch: 10, Steps: 17 | Train Loss: 0.836 Vali Loss: 3.267 Vali Acc: 0.285 Test Loss: 3.267 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285138).  Saving model ...
Epoch: 11 cost time: 11.741019248962402
Epoch: 11, Steps: 17 | Train Loss: 0.706 Vali Loss: 5.385 Vali Acc: 0.266 Test Loss: 5.385 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.387285470962524
Epoch: 12, Steps: 17 | Train Loss: 0.759 Vali Loss: 5.015 Vali Acc: 0.251 Test Loss: 5.015 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.3353910446167
Epoch: 13, Steps: 17 | Train Loss: 0.692 Vali Loss: 4.260 Vali Acc: 0.278 Test Loss: 4.260 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.488685607910156
Epoch: 14, Steps: 17 | Train Loss: 0.705 Vali Loss: 7.764 Vali Acc: 0.266 Test Loss: 7.764 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.600780725479126
Epoch: 15, Steps: 17 | Train Loss: 0.728 Vali Loss: 5.781 Vali Acc: 0.270 Test Loss: 5.781 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.063206672668457
Epoch: 16, Steps: 17 | Train Loss: 0.590 Vali Loss: 6.650 Vali Acc: 0.274 Test Loss: 6.650 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.758033037185669
Epoch: 17, Steps: 17 | Train Loss: 0.509 Vali Loss: 7.631 Vali Acc: 0.285 Test Loss: 7.631 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.03514814376831
Epoch: 18, Steps: 17 | Train Loss: 0.453 Vali Loss: 6.862 Vali Acc: 0.251 Test Loss: 6.862 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.643465280532837
Epoch: 19, Steps: 17 | Train Loss: 0.362 Vali Loss: 7.459 Vali Acc: 0.251 Test Loss: 7.459 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.653715372085571
Epoch: 20, Steps: 17 | Train Loss: 0.326 Vali Loss: 7.884 Vali Acc: 0.232 Test Loss: 7.884 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.835779428482056
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.659 Vali Acc: 0.270 Test Loss: 1.659 Test Acc: 0.270
Validation loss decreased (inf --> -0.269945).  Saving model ...
Epoch: 2 cost time: 8.797402143478394
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 2.728 Vali Acc: 0.262 Test Loss: 2.728 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.893300533294678
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 2.942 Vali Acc: 0.262 Test Loss: 2.942 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.62724757194519
Epoch: 4, Steps: 17 | Train Loss: 1.383 Vali Loss: 2.905 Vali Acc: 0.247 Test Loss: 2.905 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.955419778823853
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 3.071 Vali Acc: 0.270 Test Loss: 3.071 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.621561050415039
Epoch: 6, Steps: 17 | Train Loss: 1.197 Vali Loss: 3.613 Vali Acc: 0.247 Test Loss: 3.613 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.09146761894226
Epoch: 7, Steps: 17 | Train Loss: 1.160 Vali Loss: 3.956 Vali Acc: 0.255 Test Loss: 3.956 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.128334760665894
Epoch: 8, Steps: 17 | Train Loss: 1.276 Vali Loss: 3.282 Vali Acc: 0.270 Test Loss: 3.282 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.351389408111572
Epoch: 9, Steps: 17 | Train Loss: 1.055 Vali Loss: 3.790 Vali Acc: 0.240 Test Loss: 3.790 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.00143814086914
Epoch: 10, Steps: 17 | Train Loss: 0.963 Vali Loss: 3.876 Vali Acc: 0.232 Test Loss: 3.876 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.64246416091919
Epoch: 11, Steps: 17 | Train Loss: 0.796 Vali Loss: 4.993 Vali Acc: 0.247 Test Loss: 4.993 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.404472351074219
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.940 Vali Acc: 0.255 Test Loss: 1.940 Test Acc: 0.255
Validation loss decreased (inf --> -0.254733).  Saving model ...
Epoch: 2 cost time: 10.847543954849243
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 3.224 Vali Acc: 0.251 Test Loss: 3.224 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.320276260375977
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 3.901 Vali Acc: 0.255 Test Loss: 3.901 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.948319673538208
Epoch: 4, Steps: 17 | Train Loss: 1.481 Vali Loss: 3.374 Vali Acc: 0.240 Test Loss: 3.374 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.41726040840149
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 3.975 Vali Acc: 0.259 Test Loss: 3.975 Test Acc: 0.259
Validation loss decreased (-0.254733 --> -0.258515).  Saving model ...
Epoch: 6 cost time: 10.88023567199707
Epoch: 6, Steps: 17 | Train Loss: 1.263 Vali Loss: 3.621 Vali Acc: 0.259 Test Loss: 3.621 Test Acc: 0.259
Validation loss decreased (-0.258515 --> -0.258519).  Saving model ...
Epoch: 7 cost time: 9.64560317993164
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 4.338 Vali Acc: 0.262 Test Loss: 4.338 Test Acc: 0.262
Validation loss decreased (-0.258519 --> -0.262314).  Saving model ...
Epoch: 8 cost time: 10.889291524887085
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 3.595 Vali Acc: 0.228 Test Loss: 3.595 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.957619905471802
Epoch: 9, Steps: 17 | Train Loss: 1.093 Vali Loss: 3.655 Vali Acc: 0.262 Test Loss: 3.655 Test Acc: 0.262
Validation loss decreased (-0.262314 --> -0.262321).  Saving model ...
Epoch: 10 cost time: 9.539948463439941
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 4.840 Vali Acc: 0.251 Test Loss: 4.840 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.671383619308472
Epoch: 11, Steps: 17 | Train Loss: 0.857 Vali Loss: 6.204 Vali Acc: 0.270 Test Loss: 6.204 Test Acc: 0.270
Validation loss decreased (-0.262321 --> -0.269900).  Saving model ...
Epoch: 12 cost time: 10.927453994750977
Epoch: 12, Steps: 17 | Train Loss: 0.895 Vali Loss: 5.295 Vali Acc: 0.262 Test Loss: 5.295 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.207579135894775
Epoch: 13, Steps: 17 | Train Loss: 0.865 Vali Loss: 5.441 Vali Acc: 0.251 Test Loss: 5.441 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.445424318313599
Epoch: 14, Steps: 17 | Train Loss: 0.772 Vali Loss: 7.639 Vali Acc: 0.243 Test Loss: 7.639 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.59260630607605
Epoch: 15, Steps: 17 | Train Loss: 0.766 Vali Loss: 9.327 Vali Acc: 0.270 Test Loss: 9.327 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.774226188659668
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 7.217 Vali Acc: 0.240 Test Loss: 7.217 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.895830631256104
Epoch: 17, Steps: 17 | Train Loss: 0.741 Vali Loss: 7.666 Vali Acc: 0.240 Test Loss: 7.666 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.805388450622559
Epoch: 18, Steps: 17 | Train Loss: 0.720 Vali Loss: 7.022 Vali Acc: 0.259 Test Loss: 7.022 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.220465660095215
Epoch: 19, Steps: 17 | Train Loss: 0.527 Vali Loss: 11.116 Vali Acc: 0.255 Test Loss: 11.116 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.81184434890747
Epoch: 20, Steps: 17 | Train Loss: 0.597 Vali Loss: 7.439 Vali Acc: 0.255 Test Loss: 7.439 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.391879558563232
Epoch: 21, Steps: 17 | Train Loss: 0.564 Vali Loss: 9.942 Vali Acc: 0.236 Test Loss: 9.942 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.008485794067383
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 10.540421962738037
Epoch: 2, Steps: 17 | Train Loss: 1.529 Vali Loss: 3.085 Vali Acc: 0.251 Test Loss: 3.085 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.442383527755737
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 4.079 Vali Acc: 0.251 Test Loss: 4.079 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.194430589675903
Epoch: 4, Steps: 17 | Train Loss: 1.580 Vali Loss: 3.975 Vali Acc: 0.255 Test Loss: 3.975 Test Acc: 0.255
Validation loss decreased (-0.250934 --> -0.254713).  Saving model ...
Epoch: 5 cost time: 10.680891990661621
Epoch: 5, Steps: 17 | Train Loss: 1.499 Vali Loss: 4.376 Vali Acc: 0.251 Test Loss: 4.376 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.966996908187866
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 4.316 Vali Acc: 0.240 Test Loss: 4.316 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.07213044166565
Epoch: 7, Steps: 17 | Train Loss: 1.434 Vali Loss: 5.346 Vali Acc: 0.255 Test Loss: 5.346 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.270828485488892
Epoch: 8, Steps: 17 | Train Loss: 1.384 Vali Loss: 4.966 Vali Acc: 0.243 Test Loss: 4.966 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.972001075744629
Epoch: 9, Steps: 17 | Train Loss: 1.291 Vali Loss: 4.565 Vali Acc: 0.251 Test Loss: 4.565 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.193253755569458
Epoch: 10, Steps: 17 | Train Loss: 1.295 Vali Loss: 5.757 Vali Acc: 0.255 Test Loss: 5.757 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.050541639328003
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 6.658 Vali Acc: 0.243 Test Loss: 6.658 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.979431629180908
Epoch: 12, Steps: 17 | Train Loss: 1.113 Vali Loss: 6.451 Vali Acc: 0.236 Test Loss: 6.451 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.266613245010376
Epoch: 13, Steps: 17 | Train Loss: 1.159 Vali Loss: 4.468 Vali Acc: 0.259 Test Loss: 4.468 Test Acc: 0.259
Validation loss decreased (-0.254713 --> -0.258510).  Saving model ...
Epoch: 14 cost time: 10.117653131484985
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 7.324 Vali Acc: 0.240 Test Loss: 7.324 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.617218017578125
Epoch: 15, Steps: 17 | Train Loss: 1.086 Vali Loss: 6.054 Vali Acc: 0.205 Test Loss: 6.054 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.650902271270752
Epoch: 16, Steps: 17 | Train Loss: 1.087 Vali Loss: 6.425 Vali Acc: 0.240 Test Loss: 6.425 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.768378496170044
Epoch: 17, Steps: 17 | Train Loss: 0.795 Vali Loss: 6.109 Vali Acc: 0.240 Test Loss: 6.109 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.259896278381348
Epoch: 18, Steps: 17 | Train Loss: 0.999 Vali Loss: 6.616 Vali Acc: 0.243 Test Loss: 6.616 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.21274209022522
Epoch: 19, Steps: 17 | Train Loss: 0.930 Vali Loss: 9.054 Vali Acc: 0.232 Test Loss: 9.054 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.061415195465088
Epoch: 20, Steps: 17 | Train Loss: 1.034 Vali Loss: 6.725 Vali Acc: 0.259 Test Loss: 6.725 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.826346635818481
Epoch: 21, Steps: 17 | Train Loss: 0.861 Vali Loss: 10.465 Vali Acc: 0.243 Test Loss: 10.465 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.716635942459106
Epoch: 22, Steps: 17 | Train Loss: 0.852 Vali Loss: 7.995 Vali Acc: 0.228 Test Loss: 7.995 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.24129843711853
Epoch: 23, Steps: 17 | Train Loss: 0.766 Vali Loss: 7.782 Vali Acc: 0.262 Test Loss: 7.782 Test Acc: 0.262
Validation loss decreased (-0.258510 --> -0.262280).  Saving model ...
Epoch: 24 cost time: 10.072213649749756
Epoch: 24, Steps: 17 | Train Loss: 0.812 Vali Loss: 8.533 Vali Acc: 0.251 Test Loss: 8.533 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.357185125350952
Epoch: 25, Steps: 17 | Train Loss: 0.823 Vali Loss: 11.136 Vali Acc: 0.262 Test Loss: 11.136 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.951714515686035
Epoch: 26, Steps: 17 | Train Loss: 0.648 Vali Loss: 9.469 Vali Acc: 0.240 Test Loss: 9.469 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.513830661773682
Epoch: 27, Steps: 17 | Train Loss: 0.987 Vali Loss: 10.463 Vali Acc: 0.251 Test Loss: 10.463 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 10.840341567993164
Epoch: 28, Steps: 17 | Train Loss: 0.607 Vali Loss: 9.027 Vali Acc: 0.243 Test Loss: 9.027 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.250421524047852
Epoch: 29, Steps: 17 | Train Loss: 0.799 Vali Loss: 10.741 Vali Acc: 0.262 Test Loss: 10.741 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 9.859521865844727
Epoch: 30, Steps: 17 | Train Loss: 0.849 Vali Loss: 11.911 Vali Acc: 0.240 Test Loss: 11.911 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 10.645694255828857
Epoch: 31, Steps: 17 | Train Loss: 0.576 Vali Loss: 13.506 Vali Acc: 0.255 Test Loss: 13.506 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 10.24113416671753
Epoch: 32, Steps: 17 | Train Loss: 0.902 Vali Loss: 12.039 Vali Acc: 0.221 Test Loss: 12.039 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 9.881784915924072
Epoch: 33, Steps: 17 | Train Loss: 0.655 Vali Loss: 13.959 Vali Acc: 0.221 Test Loss: 13.959 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 812420
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.189709663391113
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (inf --> -0.300366).  Saving model ...
Epoch: 2 cost time: 12.658765077590942
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.725 Vali Acc: 0.274 Test Loss: 1.725 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.416832447052002
Epoch: 3, Steps: 17 | Train Loss: 1.587 Vali Loss: 2.422 Vali Acc: 0.266 Test Loss: 2.422 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.622857570648193
Epoch: 4, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.950 Vali Acc: 0.274 Test Loss: 1.950 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.469610691070557
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.920 Vali Acc: 0.255 Test Loss: 1.920 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.885039806365967
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 2.148 Vali Acc: 0.217 Test Loss: 2.148 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.111171007156372
Epoch: 7, Steps: 17 | Train Loss: 1.181 Vali Loss: 2.826 Vali Acc: 0.232 Test Loss: 2.826 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.386008024215698
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 3.023 Vali Acc: 0.217 Test Loss: 3.023 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.164539813995361
Epoch: 9, Steps: 17 | Train Loss: 1.019 Vali Loss: 2.998 Vali Acc: 0.274 Test Loss: 2.998 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.071530818939209
Epoch: 10, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.783 Vali Acc: 0.262 Test Loss: 2.783 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.939852952957153
Epoch: 11, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.809 Vali Acc: 0.247 Test Loss: 2.809 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.179878950119019
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 12.95093560218811
Epoch: 2, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.671 Vali Acc: 0.281 Test Loss: 1.671 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281352).  Saving model ...
Epoch: 3 cost time: 11.670725345611572
Epoch: 3, Steps: 17 | Train Loss: 1.642 Vali Loss: 2.474 Vali Acc: 0.259 Test Loss: 2.474 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.843728303909302
Epoch: 4, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.878 Vali Acc: 0.278 Test Loss: 1.878 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.170281648635864
Epoch: 5, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.796 Vali Acc: 0.293 Test Loss: 1.796 Test Acc: 0.293
Validation loss decreased (-0.281352 --> -0.292758).  Saving model ...
Epoch: 6 cost time: 10.678159952163696
Epoch: 6, Steps: 17 | Train Loss: 1.238 Vali Loss: 2.160 Vali Acc: 0.274 Test Loss: 2.160 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.420877933502197
Epoch: 7, Steps: 17 | Train Loss: 1.188 Vali Loss: 3.020 Vali Acc: 0.236 Test Loss: 3.020 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.354951620101929
Epoch: 8, Steps: 17 | Train Loss: 1.081 Vali Loss: 3.099 Vali Acc: 0.221 Test Loss: 3.099 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.603307962417603
Epoch: 9, Steps: 17 | Train Loss: 0.999 Vali Loss: 2.980 Vali Acc: 0.274 Test Loss: 2.980 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.986453533172607
Epoch: 10, Steps: 17 | Train Loss: 1.055 Vali Loss: 3.099 Vali Acc: 0.255 Test Loss: 3.099 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.242569923400879
Epoch: 11, Steps: 17 | Train Loss: 0.830 Vali Loss: 3.350 Vali Acc: 0.251 Test Loss: 3.350 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.64695119857788
Epoch: 12, Steps: 17 | Train Loss: 1.063 Vali Loss: 3.193 Vali Acc: 0.274 Test Loss: 3.193 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.22711706161499
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 3.580 Vali Acc: 0.266 Test Loss: 3.580 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.838290214538574
Epoch: 14, Steps: 17 | Train Loss: 0.996 Vali Loss: 4.248 Vali Acc: 0.281 Test Loss: 4.248 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.372498035430908
Epoch: 15, Steps: 17 | Train Loss: 0.855 Vali Loss: 4.625 Vali Acc: 0.259 Test Loss: 4.625 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.553900718688965
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.508 Vali Acc: 0.236 Test Loss: 1.508 Test Acc: 0.236
Validation loss decreased (inf --> -0.235726).  Saving model ...
Epoch: 2 cost time: 11.632831335067749
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.891 Vali Acc: 0.259 Test Loss: 1.891 Test Acc: 0.259
Validation loss decreased (-0.235726 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 12.036400556564331
Epoch: 3, Steps: 17 | Train Loss: 1.506 Vali Loss: 2.466 Vali Acc: 0.262 Test Loss: 2.466 Test Acc: 0.262
Validation loss decreased (-0.258536 --> -0.262333).  Saving model ...
Epoch: 4 cost time: 11.37703537940979
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.084 Vali Acc: 0.266 Test Loss: 2.084 Test Acc: 0.266
Validation loss decreased (-0.262333 --> -0.266139).  Saving model ...
Epoch: 5 cost time: 11.175546169281006
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 2.164 Vali Acc: 0.251 Test Loss: 2.164 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.32693600654602
Epoch: 6, Steps: 17 | Train Loss: 1.188 Vali Loss: 2.766 Vali Acc: 0.209 Test Loss: 2.766 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.242414474487305
Epoch: 7, Steps: 17 | Train Loss: 1.076 Vali Loss: 3.218 Vali Acc: 0.247 Test Loss: 3.218 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.830527067184448
Epoch: 8, Steps: 17 | Train Loss: 1.032 Vali Loss: 3.132 Vali Acc: 0.232 Test Loss: 3.132 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.941936731338501
Epoch: 9, Steps: 17 | Train Loss: 0.881 Vali Loss: 5.452 Vali Acc: 0.243 Test Loss: 5.452 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.553049802780151
Epoch: 10, Steps: 17 | Train Loss: 0.909 Vali Loss: 3.662 Vali Acc: 0.224 Test Loss: 3.662 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.909021615982056
Epoch: 11, Steps: 17 | Train Loss: 0.693 Vali Loss: 4.171 Vali Acc: 0.247 Test Loss: 4.171 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.821016311645508
Epoch: 12, Steps: 17 | Train Loss: 0.949 Vali Loss: 5.622 Vali Acc: 0.236 Test Loss: 5.622 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.957868576049805
Epoch: 13, Steps: 17 | Train Loss: 1.120 Vali Loss: 4.252 Vali Acc: 0.240 Test Loss: 4.252 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.984716176986694
Epoch: 14, Steps: 17 | Train Loss: 0.942 Vali Loss: 6.327 Vali Acc: 0.251 Test Loss: 6.327 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.997899293899536
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.624 Vali Acc: 0.236 Test Loss: 1.624 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 10.429470777511597
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.833 Vali Acc: 0.255 Test Loss: 1.833 Test Acc: 0.255
Validation loss decreased (-0.235725 --> -0.254735).  Saving model ...
Epoch: 3 cost time: 11.233004570007324
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 2.555 Vali Acc: 0.259 Test Loss: 2.555 Test Acc: 0.259
Validation loss decreased (-0.254735 --> -0.258530).  Saving model ...
Epoch: 4 cost time: 11.710336685180664
Epoch: 4, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.991 Vali Acc: 0.232 Test Loss: 1.991 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.232359409332275
Epoch: 5, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.197 Vali Acc: 0.236 Test Loss: 2.197 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.308140516281128
Epoch: 6, Steps: 17 | Train Loss: 1.188 Vali Loss: 5.021 Vali Acc: 0.247 Test Loss: 5.021 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.855886220932007
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 2.867 Vali Acc: 0.255 Test Loss: 2.867 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.071406126022339
Epoch: 8, Steps: 17 | Train Loss: 0.968 Vali Loss: 4.398 Vali Acc: 0.240 Test Loss: 4.398 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.805386304855347
Epoch: 9, Steps: 17 | Train Loss: 0.826 Vali Loss: 5.359 Vali Acc: 0.247 Test Loss: 5.359 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.183265686035156
Epoch: 10, Steps: 17 | Train Loss: 0.711 Vali Loss: 4.852 Vali Acc: 0.243 Test Loss: 4.852 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.425801753997803
Epoch: 11, Steps: 17 | Train Loss: 0.626 Vali Loss: 5.717 Vali Acc: 0.243 Test Loss: 5.717 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.938451528549194
Epoch: 12, Steps: 17 | Train Loss: 0.672 Vali Loss: 5.065 Vali Acc: 0.232 Test Loss: 5.065 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.191681146621704
Epoch: 13, Steps: 17 | Train Loss: 0.657 Vali Loss: 4.489 Vali Acc: 0.247 Test Loss: 4.489 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.784737825393677
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 8.820361852645874
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.674 Vali Acc: 0.266 Test Loss: 1.674 Test Acc: 0.266
Validation loss decreased (-0.239528 --> -0.266143).  Saving model ...
Epoch: 3 cost time: 8.386796474456787
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 2.453 Vali Acc: 0.251 Test Loss: 2.453 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.403766632080078
Epoch: 4, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.974 Vali Acc: 0.266 Test Loss: 1.974 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.542555570602417
Epoch: 5, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.481 Vali Acc: 0.266 Test Loss: 2.481 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.286551713943481
Epoch: 6, Steps: 17 | Train Loss: 1.175 Vali Loss: 4.105 Vali Acc: 0.255 Test Loss: 4.105 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.686729669570923
Epoch: 7, Steps: 17 | Train Loss: 1.041 Vali Loss: 3.350 Vali Acc: 0.243 Test Loss: 3.350 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.107266902923584
Epoch: 8, Steps: 17 | Train Loss: 0.823 Vali Loss: 4.686 Vali Acc: 0.281 Test Loss: 4.686 Test Acc: 0.281
Validation loss decreased (-0.266143 --> -0.281322).  Saving model ...
Epoch: 9 cost time: 8.496507167816162
Epoch: 9, Steps: 17 | Train Loss: 0.826 Vali Loss: 4.688 Vali Acc: 0.262 Test Loss: 4.688 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.56433367729187
Epoch: 10, Steps: 17 | Train Loss: 0.666 Vali Loss: 4.099 Vali Acc: 0.266 Test Loss: 4.099 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.568825960159302
Epoch: 11, Steps: 17 | Train Loss: 0.717 Vali Loss: 5.186 Vali Acc: 0.274 Test Loss: 5.186 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.728363275527954
Epoch: 12, Steps: 17 | Train Loss: 0.837 Vali Loss: 4.828 Vali Acc: 0.270 Test Loss: 4.828 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.52187180519104
Epoch: 13, Steps: 17 | Train Loss: 0.763 Vali Loss: 5.645 Vali Acc: 0.255 Test Loss: 5.645 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.383723020553589
Epoch: 14, Steps: 17 | Train Loss: 0.531 Vali Loss: 5.185 Vali Acc: 0.259 Test Loss: 5.185 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.101086616516113
Epoch: 15, Steps: 17 | Train Loss: 0.440 Vali Loss: 5.881 Vali Acc: 0.266 Test Loss: 5.881 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.96082615852356
Epoch: 16, Steps: 17 | Train Loss: 0.364 Vali Loss: 6.353 Vali Acc: 0.243 Test Loss: 6.353 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.984287023544312
Epoch: 17, Steps: 17 | Train Loss: 0.611 Vali Loss: 7.310 Vali Acc: 0.247 Test Loss: 7.310 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.158341407775879
Epoch: 18, Steps: 17 | Train Loss: 0.353 Vali Loss: 9.253 Vali Acc: 0.270 Test Loss: 9.253 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.664620399475098
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.572 Vali Acc: 0.228 Test Loss: 1.572 Test Acc: 0.228
Validation loss decreased (inf --> -0.228121).  Saving model ...
Epoch: 2 cost time: 10.787275552749634
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.807 Vali Acc: 0.289 Test Loss: 1.807 Test Acc: 0.289
Validation loss decreased (-0.228121 --> -0.288955).  Saving model ...
Epoch: 3 cost time: 10.469493389129639
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 2.185 Vali Acc: 0.255 Test Loss: 2.185 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.909042358398438
Epoch: 4, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.975 Vali Acc: 0.300 Test Loss: 1.975 Test Acc: 0.300
Validation loss decreased (-0.288955 --> -0.300360).  Saving model ...
Epoch: 5 cost time: 11.096911430358887
Epoch: 5, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.943 Vali Acc: 0.251 Test Loss: 1.943 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.270997762680054
Epoch: 6, Steps: 17 | Train Loss: 1.174 Vali Loss: 3.024 Vali Acc: 0.255 Test Loss: 3.024 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.033782005310059
Epoch: 7, Steps: 17 | Train Loss: 1.034 Vali Loss: 3.096 Vali Acc: 0.240 Test Loss: 3.096 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.266955137252808
Epoch: 8, Steps: 17 | Train Loss: 0.914 Vali Loss: 3.944 Vali Acc: 0.285 Test Loss: 3.944 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.40762996673584
Epoch: 9, Steps: 17 | Train Loss: 0.907 Vali Loss: 4.502 Vali Acc: 0.243 Test Loss: 4.502 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.629384756088257
Epoch: 10, Steps: 17 | Train Loss: 0.910 Vali Loss: 4.452 Vali Acc: 0.236 Test Loss: 4.452 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.794032096862793
Epoch: 11, Steps: 17 | Train Loss: 0.727 Vali Loss: 5.744 Vali Acc: 0.259 Test Loss: 5.744 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.34753942489624
Epoch: 12, Steps: 17 | Train Loss: 0.762 Vali Loss: 4.348 Vali Acc: 0.259 Test Loss: 4.348 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.280250310897827
Epoch: 13, Steps: 17 | Train Loss: 0.755 Vali Loss: 3.963 Vali Acc: 0.232 Test Loss: 3.963 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.504233121871948
Epoch: 14, Steps: 17 | Train Loss: 0.614 Vali Loss: 6.704 Vali Acc: 0.262 Test Loss: 6.704 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.70860743522644
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 10.356643676757812
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.939 Vali Acc: 0.266 Test Loss: 1.939 Test Acc: 0.266
Validation loss decreased (-0.239528 --> -0.266140).  Saving model ...
Epoch: 3 cost time: 8.621791362762451
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 2.866 Vali Acc: 0.274 Test Loss: 2.866 Test Acc: 0.274
Validation loss decreased (-0.266140 --> -0.273736).  Saving model ...
Epoch: 4 cost time: 8.63051986694336
Epoch: 4, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.975 Vali Acc: 0.251 Test Loss: 1.975 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.388392210006714
Epoch: 5, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.056 Vali Acc: 0.281 Test Loss: 2.056 Test Acc: 0.281
Validation loss decreased (-0.273736 --> -0.281348).  Saving model ...
Epoch: 6 cost time: 9.300999164581299
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 3.486 Vali Acc: 0.278 Test Loss: 3.486 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.379403591156006
Epoch: 7, Steps: 17 | Train Loss: 1.138 Vali Loss: 3.218 Vali Acc: 0.262 Test Loss: 3.218 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.14551305770874
Epoch: 8, Steps: 17 | Train Loss: 0.978 Vali Loss: 3.731 Vali Acc: 0.270 Test Loss: 3.731 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.449051141738892
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 4.299 Vali Acc: 0.262 Test Loss: 4.299 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.717717170715332
Epoch: 10, Steps: 17 | Train Loss: 1.046 Vali Loss: 4.620 Vali Acc: 0.278 Test Loss: 4.620 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.453912734985352
Epoch: 11, Steps: 17 | Train Loss: 0.814 Vali Loss: 4.276 Vali Acc: 0.266 Test Loss: 4.276 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.166611194610596
Epoch: 12, Steps: 17 | Train Loss: 0.810 Vali Loss: 4.618 Vali Acc: 0.266 Test Loss: 4.618 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.705260992050171
Epoch: 13, Steps: 17 | Train Loss: 0.856 Vali Loss: 3.688 Vali Acc: 0.293 Test Loss: 3.688 Test Acc: 0.293
Validation loss decreased (-0.281348 --> -0.292739).  Saving model ...
Epoch: 14 cost time: 10.27863073348999
Epoch: 14, Steps: 17 | Train Loss: 0.631 Vali Loss: 4.870 Vali Acc: 0.274 Test Loss: 4.870 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.117581367492676
Epoch: 15, Steps: 17 | Train Loss: 0.555 Vali Loss: 4.794 Vali Acc: 0.281 Test Loss: 4.794 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.08190393447876
Epoch: 16, Steps: 17 | Train Loss: 0.482 Vali Loss: 4.666 Vali Acc: 0.255 Test Loss: 4.666 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.180667638778687
Epoch: 17, Steps: 17 | Train Loss: 0.621 Vali Loss: 4.735 Vali Acc: 0.266 Test Loss: 4.735 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.954882144927979
Epoch: 18, Steps: 17 | Train Loss: 0.644 Vali Loss: 6.607 Vali Acc: 0.266 Test Loss: 6.607 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.716631650924683
Epoch: 19, Steps: 17 | Train Loss: 0.710 Vali Loss: 6.701 Vali Acc: 0.278 Test Loss: 6.701 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.01973843574524
Epoch: 20, Steps: 17 | Train Loss: 0.492 Vali Loss: 7.541 Vali Acc: 0.251 Test Loss: 7.541 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.037915229797363
Epoch: 21, Steps: 17 | Train Loss: 0.390 Vali Loss: 6.516 Vali Acc: 0.262 Test Loss: 6.516 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.902961730957031
Epoch: 22, Steps: 17 | Train Loss: 0.555 Vali Loss: 8.309 Vali Acc: 0.251 Test Loss: 8.309 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.658367395401001
Epoch: 23, Steps: 17 | Train Loss: 0.424 Vali Loss: 8.457 Vali Acc: 0.224 Test Loss: 8.457 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.283398389816284
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.556 Vali Acc: 0.247 Test Loss: 1.556 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 10.426160335540771
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 2.142 Vali Acc: 0.247 Test Loss: 2.142 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.61270785331726
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.715 Vali Acc: 0.251 Test Loss: 2.715 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250923).  Saving model ...
Epoch: 4 cost time: 10.794148206710815
Epoch: 4, Steps: 17 | Train Loss: 1.280 Vali Loss: 2.123 Vali Acc: 0.247 Test Loss: 2.123 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.341753721237183
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 2.245 Vali Acc: 0.266 Test Loss: 2.245 Test Acc: 0.266
Validation loss decreased (-0.250923 --> -0.266137).  Saving model ...
Epoch: 6 cost time: 10.299176931381226
Epoch: 6, Steps: 17 | Train Loss: 1.259 Vali Loss: 3.283 Vali Acc: 0.262 Test Loss: 3.283 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.801136016845703
Epoch: 7, Steps: 17 | Train Loss: 1.186 Vali Loss: 3.007 Vali Acc: 0.289 Test Loss: 3.007 Test Acc: 0.289
Validation loss decreased (-0.266137 --> -0.288943).  Saving model ...
Epoch: 8 cost time: 9.682351112365723
Epoch: 8, Steps: 17 | Train Loss: 1.090 Vali Loss: 3.888 Vali Acc: 0.251 Test Loss: 3.888 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.556973218917847
Epoch: 9, Steps: 17 | Train Loss: 0.955 Vali Loss: 4.120 Vali Acc: 0.243 Test Loss: 4.120 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.180080890655518
Epoch: 10, Steps: 17 | Train Loss: 1.044 Vali Loss: 4.109 Vali Acc: 0.255 Test Loss: 4.109 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.055680990219116
Epoch: 11, Steps: 17 | Train Loss: 0.909 Vali Loss: 4.515 Vali Acc: 0.251 Test Loss: 4.515 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.335283279418945
Epoch: 12, Steps: 17 | Train Loss: 1.127 Vali Loss: 4.367 Vali Acc: 0.255 Test Loss: 4.367 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.083288431167603
Epoch: 13, Steps: 17 | Train Loss: 1.069 Vali Loss: 3.729 Vali Acc: 0.281 Test Loss: 3.729 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.57249903678894
Epoch: 14, Steps: 17 | Train Loss: 0.903 Vali Loss: 5.807 Vali Acc: 0.266 Test Loss: 5.807 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.419503211975098
Epoch: 15, Steps: 17 | Train Loss: 0.844 Vali Loss: 5.055 Vali Acc: 0.278 Test Loss: 5.055 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.330328226089478
Epoch: 16, Steps: 17 | Train Loss: 0.897 Vali Loss: 6.499 Vali Acc: 0.251 Test Loss: 6.499 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.391583442687988
Epoch: 17, Steps: 17 | Train Loss: 1.324 Vali Loss: 5.900 Vali Acc: 0.274 Test Loss: 5.900 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.62881875038147
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.595 Vali Acc: 0.247 Test Loss: 1.595 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 8.675929307937622
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 2.300 Vali Acc: 0.205 Test Loss: 2.300 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.728463411331177
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 3.209 Vali Acc: 0.224 Test Loss: 3.209 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.436009407043457
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 2.977 Vali Acc: 0.247 Test Loss: 2.977 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.752082586288452
Epoch: 5, Steps: 17 | Train Loss: 1.262 Vali Loss: 2.480 Vali Acc: 0.224 Test Loss: 2.480 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.62742805480957
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 3.988 Vali Acc: 0.251 Test Loss: 3.988 Test Acc: 0.251
Validation loss decreased (-0.247132 --> -0.250911).  Saving model ...
Epoch: 7 cost time: 8.841979503631592
Epoch: 7, Steps: 17 | Train Loss: 1.346 Vali Loss: 4.069 Vali Acc: 0.259 Test Loss: 4.069 Test Acc: 0.259
Validation loss decreased (-0.250911 --> -0.258514).  Saving model ...
Epoch: 8 cost time: 8.326648712158203
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 4.753 Vali Acc: 0.259 Test Loss: 4.753 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.53937554359436
Epoch: 9, Steps: 17 | Train Loss: 1.172 Vali Loss: 4.471 Vali Acc: 0.266 Test Loss: 4.471 Test Acc: 0.266
Validation loss decreased (-0.258514 --> -0.266115).  Saving model ...
Epoch: 10 cost time: 9.485256671905518
Epoch: 10, Steps: 17 | Train Loss: 1.176 Vali Loss: 5.354 Vali Acc: 0.243 Test Loss: 5.354 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.557764291763306
Epoch: 11, Steps: 17 | Train Loss: 0.921 Vali Loss: 5.450 Vali Acc: 0.266 Test Loss: 5.450 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.389037609100342
Epoch: 12, Steps: 17 | Train Loss: 0.997 Vali Loss: 4.036 Vali Acc: 0.270 Test Loss: 4.036 Test Acc: 0.270
Validation loss decreased (-0.266115 --> -0.269922).  Saving model ...
Epoch: 13 cost time: 9.180472373962402
Epoch: 13, Steps: 17 | Train Loss: 1.052 Vali Loss: 5.111 Vali Acc: 0.281 Test Loss: 5.111 Test Acc: 0.281
Validation loss decreased (-0.269922 --> -0.281318).  Saving model ...
Epoch: 14 cost time: 8.957248449325562
Epoch: 14, Steps: 17 | Train Loss: 0.812 Vali Loss: 6.733 Vali Acc: 0.251 Test Loss: 6.733 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.203173160552979
Epoch: 15, Steps: 17 | Train Loss: 0.806 Vali Loss: 7.001 Vali Acc: 0.270 Test Loss: 7.001 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.894502639770508
Epoch: 16, Steps: 17 | Train Loss: 0.644 Vali Loss: 7.299 Vali Acc: 0.270 Test Loss: 7.299 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.028396368026733
Epoch: 17, Steps: 17 | Train Loss: 0.789 Vali Loss: 7.062 Vali Acc: 0.270 Test Loss: 7.062 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.051867246627808
Epoch: 18, Steps: 17 | Train Loss: 0.827 Vali Loss: 8.626 Vali Acc: 0.247 Test Loss: 8.626 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.530693769454956
Epoch: 19, Steps: 17 | Train Loss: 0.890 Vali Loss: 7.572 Vali Acc: 0.266 Test Loss: 7.572 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.227136850357056
Epoch: 20, Steps: 17 | Train Loss: 0.829 Vali Loss: 8.875 Vali Acc: 0.266 Test Loss: 8.875 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.120092630386353
Epoch: 21, Steps: 17 | Train Loss: 0.530 Vali Loss: 8.626 Vali Acc: 0.274 Test Loss: 8.626 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.447182416915894
Epoch: 22, Steps: 17 | Train Loss: 0.715 Vali Loss: 8.034 Vali Acc: 0.304 Test Loss: 8.034 Test Acc: 0.304
Validation loss decreased (-0.281318 --> -0.304102).  Saving model ...
Epoch: 23 cost time: 10.180283308029175
Epoch: 23, Steps: 17 | Train Loss: 0.955 Vali Loss: 12.458 Vali Acc: 0.247 Test Loss: 12.458 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.49434494972229
Epoch: 24, Steps: 17 | Train Loss: 0.743 Vali Loss: 9.813 Vali Acc: 0.243 Test Loss: 9.813 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.07941722869873
Epoch: 25, Steps: 17 | Train Loss: 0.647 Vali Loss: 9.759 Vali Acc: 0.247 Test Loss: 9.759 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.201353311538696
Epoch: 26, Steps: 17 | Train Loss: 0.419 Vali Loss: 9.767 Vali Acc: 0.243 Test Loss: 9.767 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.545437812805176
Epoch: 27, Steps: 17 | Train Loss: 0.429 Vali Loss: 11.774 Vali Acc: 0.228 Test Loss: 11.774 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.532270193099976
Epoch: 28, Steps: 17 | Train Loss: 0.485 Vali Loss: 14.013 Vali Acc: 0.228 Test Loss: 14.013 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.283931970596313
Epoch: 29, Steps: 17 | Train Loss: 0.428 Vali Loss: 10.907 Vali Acc: 0.247 Test Loss: 10.907 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.016544580459595
Epoch: 30, Steps: 17 | Train Loss: 0.818 Vali Loss: 14.179 Vali Acc: 0.240 Test Loss: 14.179 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 9.782074689865112
Epoch: 31, Steps: 17 | Train Loss: 0.911 Vali Loss: 16.930 Vali Acc: 0.266 Test Loss: 16.930 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.415141344070435
Epoch: 32, Steps: 17 | Train Loss: 0.417 Vali Loss: 14.794 Vali Acc: 0.247 Test Loss: 14.794 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.594892740249634
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.501 Vali Acc: 0.209 Test Loss: 1.501 Test Acc: 0.209
Validation loss decreased (inf --> -0.209110).  Saving model ...
Epoch: 2 cost time: 9.708705425262451
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 2.207 Vali Acc: 0.240 Test Loss: 2.207 Test Acc: 0.240
Validation loss decreased (-0.209110 --> -0.239522).  Saving model ...
Epoch: 3 cost time: 10.40466833114624
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 3.243 Vali Acc: 0.236 Test Loss: 3.243 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.984066724777222
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 3.444 Vali Acc: 0.236 Test Loss: 3.444 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.844103336334229
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 3.115 Vali Acc: 0.221 Test Loss: 3.115 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.450631380081177
Epoch: 6, Steps: 17 | Train Loss: 1.507 Vali Loss: 5.351 Vali Acc: 0.251 Test Loss: 5.351 Test Acc: 0.251
Validation loss decreased (-0.239522 --> -0.250897).  Saving model ...
Epoch: 7 cost time: 10.170620679855347
Epoch: 7, Steps: 17 | Train Loss: 1.548 Vali Loss: 5.481 Vali Acc: 0.251 Test Loss: 5.481 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.085772514343262
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 6.011 Vali Acc: 0.247 Test Loss: 6.011 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.158480644226074
Epoch: 9, Steps: 17 | Train Loss: 1.336 Vali Loss: 5.454 Vali Acc: 0.251 Test Loss: 5.454 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.029690265655518
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 5.467 Vali Acc: 0.255 Test Loss: 5.467 Test Acc: 0.255
Validation loss decreased (-0.250897 --> -0.254698).  Saving model ...
Epoch: 11 cost time: 9.241089344024658
Epoch: 11, Steps: 17 | Train Loss: 1.275 Vali Loss: 5.568 Vali Acc: 0.247 Test Loss: 5.568 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.915668487548828
Epoch: 12, Steps: 17 | Train Loss: 1.223 Vali Loss: 5.221 Vali Acc: 0.247 Test Loss: 5.221 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.657387256622314
Epoch: 13, Steps: 17 | Train Loss: 1.284 Vali Loss: 4.400 Vali Acc: 0.270 Test Loss: 4.400 Test Acc: 0.270
Validation loss decreased (-0.254698 --> -0.269918).  Saving model ...
Epoch: 14 cost time: 8.629036664962769
Epoch: 14, Steps: 17 | Train Loss: 1.226 Vali Loss: 7.999 Vali Acc: 0.266 Test Loss: 7.999 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.21269965171814
Epoch: 15, Steps: 17 | Train Loss: 1.188 Vali Loss: 7.858 Vali Acc: 0.266 Test Loss: 7.858 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.886653900146484
Epoch: 16, Steps: 17 | Train Loss: 0.917 Vali Loss: 6.969 Vali Acc: 0.255 Test Loss: 6.969 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.050096035003662
Epoch: 17, Steps: 17 | Train Loss: 1.030 Vali Loss: 6.543 Vali Acc: 0.293 Test Loss: 6.543 Test Acc: 0.293
Validation loss decreased (-0.269918 --> -0.292710).  Saving model ...
Epoch: 18 cost time: 8.491432189941406
Epoch: 18, Steps: 17 | Train Loss: 1.194 Vali Loss: 8.762 Vali Acc: 0.289 Test Loss: 8.762 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.319756984710693
Epoch: 19, Steps: 17 | Train Loss: 1.184 Vali Loss: 6.397 Vali Acc: 0.236 Test Loss: 6.397 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.665220022201538
Epoch: 20, Steps: 17 | Train Loss: 1.016 Vali Loss: 7.751 Vali Acc: 0.240 Test Loss: 7.751 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.069681406021118
Epoch: 21, Steps: 17 | Train Loss: 0.976 Vali Loss: 8.775 Vali Acc: 0.274 Test Loss: 8.775 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.482857704162598
Epoch: 22, Steps: 17 | Train Loss: 1.077 Vali Loss: 9.497 Vali Acc: 0.243 Test Loss: 9.497 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.648722410202026
Epoch: 23, Steps: 17 | Train Loss: 0.887 Vali Loss: 9.520 Vali Acc: 0.247 Test Loss: 9.520 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.933779001235962
Epoch: 24, Steps: 17 | Train Loss: 0.813 Vali Loss: 9.924 Vali Acc: 0.247 Test Loss: 9.924 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.57174825668335
Epoch: 25, Steps: 17 | Train Loss: 0.949 Vali Loss: 9.336 Vali Acc: 0.243 Test Loss: 9.336 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.65336012840271
Epoch: 26, Steps: 17 | Train Loss: 0.517 Vali Loss: 11.657 Vali Acc: 0.259 Test Loss: 11.657 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.257410526275635
Epoch: 27, Steps: 17 | Train Loss: 0.639 Vali Loss: 11.250 Vali Acc: 0.270 Test Loss: 11.250 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 714116
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.03673005104065
Epoch: 1, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.838 Vali Acc: 0.247 Test Loss: 1.838 Test Acc: 0.247
Validation loss decreased (inf --> -0.247130).  Saving model ...
Epoch: 2 cost time: 12.10504674911499
Epoch: 2, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.736 Vali Acc: 0.278 Test Loss: 1.736 Test Acc: 0.278
Validation loss decreased (-0.247130 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 11.279380321502686
Epoch: 3, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.981 Vali Acc: 0.232 Test Loss: 1.981 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.388521671295166
Epoch: 4, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.838 Vali Acc: 0.259 Test Loss: 1.838 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.543017387390137
Epoch: 5, Steps: 17 | Train Loss: 1.434 Vali Loss: 2.141 Vali Acc: 0.251 Test Loss: 2.141 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.692164421081543
Epoch: 6, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.138 Vali Acc: 0.259 Test Loss: 2.138 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.65501594543457
Epoch: 7, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.938 Vali Acc: 0.270 Test Loss: 2.938 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.61066198348999
Epoch: 8, Steps: 17 | Train Loss: 1.237 Vali Loss: 2.733 Vali Acc: 0.232 Test Loss: 2.733 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.89629340171814
Epoch: 9, Steps: 17 | Train Loss: 1.054 Vali Loss: 2.759 Vali Acc: 0.281 Test Loss: 2.759 Test Acc: 0.281
Validation loss decreased (-0.277549 --> -0.281341).  Saving model ...
Epoch: 10 cost time: 11.353398561477661
Epoch: 10, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.541 Vali Acc: 0.240 Test Loss: 2.541 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.343408107757568
Epoch: 11, Steps: 17 | Train Loss: 0.805 Vali Loss: 3.229 Vali Acc: 0.221 Test Loss: 3.229 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.24891209602356
Epoch: 12, Steps: 17 | Train Loss: 1.446 Vali Loss: 3.054 Vali Acc: 0.281 Test Loss: 3.054 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.706812858581543
Epoch: 13, Steps: 17 | Train Loss: 0.761 Vali Loss: 3.447 Vali Acc: 0.270 Test Loss: 3.447 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.264778852462769
Epoch: 14, Steps: 17 | Train Loss: 0.687 Vali Loss: 3.522 Vali Acc: 0.259 Test Loss: 3.522 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.142486095428467
Epoch: 15, Steps: 17 | Train Loss: 0.693 Vali Loss: 3.506 Vali Acc: 0.232 Test Loss: 3.506 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.566442012786865
Epoch: 16, Steps: 17 | Train Loss: 0.900 Vali Loss: 5.541 Vali Acc: 0.266 Test Loss: 5.541 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.551576375961304
Epoch: 17, Steps: 17 | Train Loss: 0.773 Vali Loss: 4.655 Vali Acc: 0.228 Test Loss: 4.655 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.524458646774292
Epoch: 18, Steps: 17 | Train Loss: 0.728 Vali Loss: 5.632 Vali Acc: 0.228 Test Loss: 5.632 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.033704042434692
Epoch: 19, Steps: 17 | Train Loss: 0.839 Vali Loss: 6.091 Vali Acc: 0.251 Test Loss: 6.091 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.851885557174683
Epoch: 1, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.928 Vali Acc: 0.247 Test Loss: 1.928 Test Acc: 0.247
Validation loss decreased (inf --> -0.247129).  Saving model ...
Epoch: 2 cost time: 11.0595223903656
Epoch: 2, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.760 Vali Acc: 0.266 Test Loss: 1.760 Test Acc: 0.266
Validation loss decreased (-0.247129 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 11.061692714691162
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.868 Vali Acc: 0.205 Test Loss: 1.868 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.873335361480713
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.747 Vali Acc: 0.316 Test Loss: 1.747 Test Acc: 0.316
Validation loss decreased (-0.266142 --> -0.315572).  Saving model ...
Epoch: 5 cost time: 10.64832067489624
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.898 Vali Acc: 0.270 Test Loss: 1.898 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.695063829421997
Epoch: 6, Steps: 17 | Train Loss: 1.152 Vali Loss: 2.313 Vali Acc: 0.259 Test Loss: 2.313 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.223484992980957
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.636 Vali Acc: 0.255 Test Loss: 2.636 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.660086154937744
Epoch: 8, Steps: 17 | Train Loss: 1.236 Vali Loss: 2.513 Vali Acc: 0.243 Test Loss: 2.513 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.349260330200195
Epoch: 9, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.447 Vali Acc: 0.251 Test Loss: 2.447 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.181039094924927
Epoch: 10, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.842 Vali Acc: 0.270 Test Loss: 2.842 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.363495826721191
Epoch: 11, Steps: 17 | Train Loss: 1.033 Vali Loss: 3.851 Vali Acc: 0.255 Test Loss: 3.851 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.89730453491211
Epoch: 12, Steps: 17 | Train Loss: 0.982 Vali Loss: 4.017 Vali Acc: 0.270 Test Loss: 4.017 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.25458312034607
Epoch: 13, Steps: 17 | Train Loss: 0.826 Vali Loss: 3.347 Vali Acc: 0.259 Test Loss: 3.347 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.239561080932617
Epoch: 14, Steps: 17 | Train Loss: 0.877 Vali Loss: 5.056 Vali Acc: 0.270 Test Loss: 5.056 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.2462477684021
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.818 Vali Acc: 0.243 Test Loss: 1.818 Test Acc: 0.243
Validation loss decreased (inf --> -0.243328).  Saving model ...
Epoch: 2 cost time: 10.796957015991211
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.760 Vali Acc: 0.247 Test Loss: 1.760 Test Acc: 0.247
Validation loss decreased (-0.243328 --> -0.247131).  Saving model ...
Epoch: 3 cost time: 10.99995231628418
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.873 Vali Acc: 0.217 Test Loss: 1.873 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.625483512878418
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.070 Vali Acc: 0.270 Test Loss: 2.070 Test Acc: 0.270
Validation loss decreased (-0.247131 --> -0.269941).  Saving model ...
Epoch: 5 cost time: 12.217559099197388
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.434 Vali Acc: 0.236 Test Loss: 2.434 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.379802227020264
Epoch: 6, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.555 Vali Acc: 0.202 Test Loss: 2.555 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.532006740570068
Epoch: 7, Steps: 17 | Train Loss: 1.000 Vali Loss: 3.050 Vali Acc: 0.240 Test Loss: 3.050 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.03585934638977
Epoch: 8, Steps: 17 | Train Loss: 1.104 Vali Loss: 2.922 Vali Acc: 0.224 Test Loss: 2.922 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.128825664520264
Epoch: 9, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.757 Vali Acc: 0.240 Test Loss: 2.757 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.56780195236206
Epoch: 10, Steps: 17 | Train Loss: 0.876 Vali Loss: 3.166 Vali Acc: 0.240 Test Loss: 3.166 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.84907841682434
Epoch: 11, Steps: 17 | Train Loss: 0.715 Vali Loss: 3.688 Vali Acc: 0.221 Test Loss: 3.688 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.521111965179443
Epoch: 12, Steps: 17 | Train Loss: 0.958 Vali Loss: 4.706 Vali Acc: 0.228 Test Loss: 4.706 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.607444286346436
Epoch: 13, Steps: 17 | Train Loss: 0.825 Vali Loss: 4.249 Vali Acc: 0.232 Test Loss: 4.249 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.510395526885986
Epoch: 14, Steps: 17 | Train Loss: 0.694 Vali Loss: 5.731 Vali Acc: 0.221 Test Loss: 5.731 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.61893606185913
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.681 Vali Acc: 0.255 Test Loss: 1.681 Test Acc: 0.255
Validation loss decreased (inf --> -0.254736).  Saving model ...
Epoch: 2 cost time: 11.497914791107178
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.739 Vali Acc: 0.213 Test Loss: 1.739 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.712050676345825
Epoch: 3, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.859 Vali Acc: 0.255 Test Loss: 1.859 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.030455350875854
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 2.129 Vali Acc: 0.224 Test Loss: 2.129 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.464478969573975
Epoch: 5, Steps: 17 | Train Loss: 1.300 Vali Loss: 2.724 Vali Acc: 0.262 Test Loss: 2.724 Test Acc: 0.262
Validation loss decreased (-0.254736 --> -0.262330).  Saving model ...
Epoch: 6 cost time: 11.023910522460938
Epoch: 6, Steps: 17 | Train Loss: 1.190 Vali Loss: 2.772 Vali Acc: 0.262 Test Loss: 2.772 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.909570217132568
Epoch: 7, Steps: 17 | Train Loss: 1.068 Vali Loss: 4.500 Vali Acc: 0.255 Test Loss: 4.500 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.38617753982544
Epoch: 8, Steps: 17 | Train Loss: 1.153 Vali Loss: 2.816 Vali Acc: 0.243 Test Loss: 2.816 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.47844648361206
Epoch: 9, Steps: 17 | Train Loss: 0.970 Vali Loss: 4.141 Vali Acc: 0.262 Test Loss: 4.141 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.388213157653809
Epoch: 10, Steps: 17 | Train Loss: 0.873 Vali Loss: 5.227 Vali Acc: 0.270 Test Loss: 5.227 Test Acc: 0.270
Validation loss decreased (-0.262330 --> -0.269910).  Saving model ...
Epoch: 11 cost time: 9.74411654472351
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 4.432 Vali Acc: 0.251 Test Loss: 4.432 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.721680879592896
Epoch: 12, Steps: 17 | Train Loss: 0.940 Vali Loss: 4.692 Vali Acc: 0.259 Test Loss: 4.692 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.490521430969238
Epoch: 13, Steps: 17 | Train Loss: 0.654 Vali Loss: 5.831 Vali Acc: 0.259 Test Loss: 5.831 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.923771142959595
Epoch: 14, Steps: 17 | Train Loss: 0.643 Vali Loss: 6.599 Vali Acc: 0.251 Test Loss: 6.599 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.131833791732788
Epoch: 15, Steps: 17 | Train Loss: 0.544 Vali Loss: 5.318 Vali Acc: 0.266 Test Loss: 5.318 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.672490358352661
Epoch: 16, Steps: 17 | Train Loss: 0.640 Vali Loss: 5.687 Vali Acc: 0.270 Test Loss: 5.687 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.52238392829895
Epoch: 17, Steps: 17 | Train Loss: 0.482 Vali Loss: 6.222 Vali Acc: 0.262 Test Loss: 6.222 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.902937650680542
Epoch: 18, Steps: 17 | Train Loss: 0.538 Vali Loss: 7.664 Vali Acc: 0.251 Test Loss: 7.664 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.074635982513428
Epoch: 19, Steps: 17 | Train Loss: 0.999 Vali Loss: 8.203 Vali Acc: 0.274 Test Loss: 8.203 Test Acc: 0.274
Validation loss decreased (-0.269910 --> -0.273682).  Saving model ...
Epoch: 20 cost time: 9.860292911529541
Epoch: 20, Steps: 17 | Train Loss: 0.524 Vali Loss: 5.843 Vali Acc: 0.228 Test Loss: 5.843 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.321653127670288
Epoch: 21, Steps: 17 | Train Loss: 0.454 Vali Loss: 8.449 Vali Acc: 0.262 Test Loss: 8.449 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.33581018447876
Epoch: 22, Steps: 17 | Train Loss: 0.414 Vali Loss: 7.284 Vali Acc: 0.255 Test Loss: 7.284 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.60259199142456
Epoch: 23, Steps: 17 | Train Loss: 0.469 Vali Loss: 10.152 Vali Acc: 0.274 Test Loss: 10.152 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.374600648880005
Epoch: 24, Steps: 17 | Train Loss: 0.392 Vali Loss: 11.135 Vali Acc: 0.255 Test Loss: 11.135 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.398405313491821
Epoch: 25, Steps: 17 | Train Loss: 0.658 Vali Loss: 8.060 Vali Acc: 0.228 Test Loss: 8.060 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.45429539680481
Epoch: 26, Steps: 17 | Train Loss: 0.408 Vali Loss: 8.469 Vali Acc: 0.255 Test Loss: 8.469 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.169505596160889
Epoch: 27, Steps: 17 | Train Loss: 0.271 Vali Loss: 10.258 Vali Acc: 0.259 Test Loss: 10.258 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.573354005813599
Epoch: 28, Steps: 17 | Train Loss: 0.324 Vali Loss: 9.077 Vali Acc: 0.255 Test Loss: 9.077 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.147785186767578
Epoch: 29, Steps: 17 | Train Loss: 0.273 Vali Loss: 11.110 Vali Acc: 0.278 Test Loss: 11.110 Test Acc: 0.278
Validation loss decreased (-0.273682 --> -0.277455).  Saving model ...
Epoch: 30 cost time: 10.277455806732178
Epoch: 30, Steps: 17 | Train Loss: 0.448 Vali Loss: 10.583 Vali Acc: 0.247 Test Loss: 10.583 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 9.600558757781982
Epoch: 31, Steps: 17 | Train Loss: 0.235 Vali Loss: 12.232 Vali Acc: 0.259 Test Loss: 12.232 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 9.400381326675415
Epoch: 32, Steps: 17 | Train Loss: 0.137 Vali Loss: 11.221 Vali Acc: 0.247 Test Loss: 11.221 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 10.210241079330444
Epoch: 33, Steps: 17 | Train Loss: 0.353 Vali Loss: 11.899 Vali Acc: 0.240 Test Loss: 11.899 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 8.867377281188965
Epoch: 34, Steps: 17 | Train Loss: 0.341 Vali Loss: 12.204 Vali Acc: 0.259 Test Loss: 12.204 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 10.162144660949707
Epoch: 35, Steps: 17 | Train Loss: 0.108 Vali Loss: 15.819 Vali Acc: 0.278 Test Loss: 15.819 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 9.430454969406128
Epoch: 36, Steps: 17 | Train Loss: 0.099 Vali Loss: 15.625 Vali Acc: 0.281 Test Loss: 15.625 Test Acc: 0.281
Validation loss decreased (-0.277455 --> -0.281213).  Saving model ...
Epoch: 37 cost time: 9.874277353286743
Epoch: 37, Steps: 17 | Train Loss: 0.239 Vali Loss: 15.002 Vali Acc: 0.243 Test Loss: 15.002 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 10.601780891418457
Epoch: 38, Steps: 17 | Train Loss: 0.114 Vali Loss: 13.722 Vali Acc: 0.251 Test Loss: 13.722 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 9.844761371612549
Epoch: 39, Steps: 17 | Train Loss: 0.197 Vali Loss: 12.691 Vali Acc: 0.224 Test Loss: 12.691 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 10.578066349029541
Epoch: 40, Steps: 17 | Train Loss: 0.149 Vali Loss: 15.147 Vali Acc: 0.262 Test Loss: 15.147 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 9.353288650512695
Epoch: 41, Steps: 17 | Train Loss: 0.074 Vali Loss: 17.249 Vali Acc: 0.255 Test Loss: 17.249 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 9.307903528213501
Epoch: 42, Steps: 17 | Train Loss: 0.184 Vali Loss: 16.691 Vali Acc: 0.240 Test Loss: 16.691 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 9.213179588317871
Epoch: 43, Steps: 17 | Train Loss: 0.156 Vali Loss: 15.802 Vali Acc: 0.236 Test Loss: 15.802 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 9.65383791923523
Epoch: 44, Steps: 17 | Train Loss: 0.295 Vali Loss: 15.164 Vali Acc: 0.262 Test Loss: 15.164 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 10.424558401107788
Epoch: 45, Steps: 17 | Train Loss: 0.174 Vali Loss: 18.618 Vali Acc: 0.255 Test Loss: 18.618 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 10.381783485412598
Epoch: 46, Steps: 17 | Train Loss: 0.150 Vali Loss: 18.126 Vali Acc: 0.259 Test Loss: 18.126 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.300163507461548
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.475 Vali Acc: 0.251 Test Loss: 1.475 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 10.863566875457764
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.551056385040283
Epoch: 3, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.833 Vali Acc: 0.251 Test Loss: 1.833 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.665249824523926
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 2.335 Vali Acc: 0.213 Test Loss: 2.335 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.484222173690796
Epoch: 5, Steps: 17 | Train Loss: 1.193 Vali Loss: 2.276 Vali Acc: 0.266 Test Loss: 2.276 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266137).  Saving model ...
Epoch: 6 cost time: 9.656963109970093
Epoch: 6, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.795 Vali Acc: 0.262 Test Loss: 2.795 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.362226724624634
Epoch: 7, Steps: 17 | Train Loss: 1.034 Vali Loss: 3.312 Vali Acc: 0.266 Test Loss: 3.312 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.081659078598022
Epoch: 8, Steps: 17 | Train Loss: 1.002 Vali Loss: 3.566 Vali Acc: 0.262 Test Loss: 3.566 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.839119672775269
Epoch: 9, Steps: 17 | Train Loss: 0.849 Vali Loss: 3.101 Vali Acc: 0.300 Test Loss: 3.101 Test Acc: 0.300
Validation loss decreased (-0.266137 --> -0.300349).  Saving model ...
Epoch: 10 cost time: 9.26735234260559
Epoch: 10, Steps: 17 | Train Loss: 0.866 Vali Loss: 4.013 Vali Acc: 0.251 Test Loss: 4.013 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.28249216079712
Epoch: 11, Steps: 17 | Train Loss: 0.705 Vali Loss: 4.391 Vali Acc: 0.270 Test Loss: 4.391 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.674386978149414
Epoch: 12, Steps: 17 | Train Loss: 0.659 Vali Loss: 4.814 Vali Acc: 0.266 Test Loss: 4.814 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.865682363510132
Epoch: 13, Steps: 17 | Train Loss: 0.570 Vali Loss: 6.291 Vali Acc: 0.289 Test Loss: 6.291 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.917827844619751
Epoch: 14, Steps: 17 | Train Loss: 0.599 Vali Loss: 5.525 Vali Acc: 0.278 Test Loss: 5.525 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.407466650009155
Epoch: 15, Steps: 17 | Train Loss: 0.438 Vali Loss: 4.996 Vali Acc: 0.289 Test Loss: 4.996 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.053815126419067
Epoch: 16, Steps: 17 | Train Loss: 0.542 Vali Loss: 5.537 Vali Acc: 0.259 Test Loss: 5.537 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.857611417770386
Epoch: 17, Steps: 17 | Train Loss: 0.423 Vali Loss: 7.489 Vali Acc: 0.270 Test Loss: 7.489 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.98194408416748
Epoch: 18, Steps: 17 | Train Loss: 0.298 Vali Loss: 6.060 Vali Acc: 0.274 Test Loss: 6.060 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.171739101409912
Epoch: 19, Steps: 17 | Train Loss: 0.442 Vali Loss: 8.308 Vali Acc: 0.285 Test Loss: 8.308 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.876797437667847
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.505 Vali Acc: 0.270 Test Loss: 1.505 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 9.578741550445557
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.662 Vali Acc: 0.232 Test Loss: 1.662 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.643232345581055
Epoch: 3, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.842 Vali Acc: 0.236 Test Loss: 1.842 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.144381284713745
Epoch: 4, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.230 Vali Acc: 0.259 Test Loss: 2.230 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.973893880844116
Epoch: 5, Steps: 17 | Train Loss: 1.161 Vali Loss: 2.049 Vali Acc: 0.243 Test Loss: 2.049 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.088381052017212
Epoch: 6, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.895 Vali Acc: 0.236 Test Loss: 2.895 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.61859655380249
Epoch: 7, Steps: 17 | Train Loss: 1.081 Vali Loss: 3.687 Vali Acc: 0.255 Test Loss: 3.687 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.482064485549927
Epoch: 8, Steps: 17 | Train Loss: 1.097 Vali Loss: 2.739 Vali Acc: 0.236 Test Loss: 2.739 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.222240447998047
Epoch: 9, Steps: 17 | Train Loss: 0.925 Vali Loss: 3.136 Vali Acc: 0.236 Test Loss: 3.136 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.179758310317993
Epoch: 10, Steps: 17 | Train Loss: 0.940 Vali Loss: 3.254 Vali Acc: 0.255 Test Loss: 3.254 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.676898956298828
Epoch: 11, Steps: 17 | Train Loss: 0.719 Vali Loss: 4.157 Vali Acc: 0.232 Test Loss: 4.157 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.662392377853394
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.454 Vali Acc: 0.289 Test Loss: 1.454 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 8.95257043838501
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.599 Vali Acc: 0.278 Test Loss: 1.599 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.599409341812134
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.767 Vali Acc: 0.285 Test Loss: 1.767 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.738736867904663
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 2.428 Vali Acc: 0.251 Test Loss: 2.428 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.805136680603027
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 2.312 Vali Acc: 0.266 Test Loss: 2.312 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.761457920074463
Epoch: 6, Steps: 17 | Train Loss: 1.166 Vali Loss: 3.331 Vali Acc: 0.259 Test Loss: 3.331 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.156888008117676
Epoch: 7, Steps: 17 | Train Loss: 1.175 Vali Loss: 4.105 Vali Acc: 0.247 Test Loss: 4.105 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.07084059715271
Epoch: 8, Steps: 17 | Train Loss: 1.157 Vali Loss: 3.869 Vali Acc: 0.270 Test Loss: 3.869 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.676399946212769
Epoch: 9, Steps: 17 | Train Loss: 1.037 Vali Loss: 3.064 Vali Acc: 0.247 Test Loss: 3.064 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.736873149871826
Epoch: 10, Steps: 17 | Train Loss: 1.090 Vali Loss: 3.450 Vali Acc: 0.270 Test Loss: 3.450 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.606856107711792
Epoch: 11, Steps: 17 | Train Loss: 0.903 Vali Loss: 4.054 Vali Acc: 0.285 Test Loss: 4.054 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.312367916107178
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 8.558165311813354
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.766 Vali Acc: 0.278 Test Loss: 1.766 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 9.301242113113403
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.868 Vali Acc: 0.281 Test Loss: 1.868 Test Acc: 0.281
Validation loss decreased (-0.277549 --> -0.281350).  Saving model ...
Epoch: 4 cost time: 8.815996885299683
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 2.856 Vali Acc: 0.266 Test Loss: 2.856 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.253781080245972
Epoch: 5, Steps: 17 | Train Loss: 1.189 Vali Loss: 2.556 Vali Acc: 0.274 Test Loss: 2.556 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.149258613586426
Epoch: 6, Steps: 17 | Train Loss: 1.146 Vali Loss: 2.821 Vali Acc: 0.259 Test Loss: 2.821 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.504894971847534
Epoch: 7, Steps: 17 | Train Loss: 1.185 Vali Loss: 4.300 Vali Acc: 0.243 Test Loss: 4.300 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.322039365768433
Epoch: 8, Steps: 17 | Train Loss: 1.193 Vali Loss: 3.068 Vali Acc: 0.247 Test Loss: 3.068 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.294194221496582
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 3.132 Vali Acc: 0.289 Test Loss: 3.132 Test Acc: 0.289
Validation loss decreased (-0.281350 --> -0.288942).  Saving model ...
Epoch: 10 cost time: 9.595897436141968
Epoch: 10, Steps: 17 | Train Loss: 1.049 Vali Loss: 3.170 Vali Acc: 0.251 Test Loss: 3.170 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.872243642807007
Epoch: 11, Steps: 17 | Train Loss: 0.918 Vali Loss: 3.597 Vali Acc: 0.270 Test Loss: 3.597 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.516388654708862
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 4.828 Vali Acc: 0.274 Test Loss: 4.828 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.460669755935669
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 3.874 Vali Acc: 0.274 Test Loss: 3.874 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.704384803771973
Epoch: 14, Steps: 17 | Train Loss: 0.961 Vali Loss: 5.164 Vali Acc: 0.255 Test Loss: 5.164 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.549216747283936
Epoch: 15, Steps: 17 | Train Loss: 0.700 Vali Loss: 4.124 Vali Acc: 0.278 Test Loss: 4.124 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.769739151000977
Epoch: 16, Steps: 17 | Train Loss: 0.877 Vali Loss: 5.148 Vali Acc: 0.247 Test Loss: 5.148 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.635539531707764
Epoch: 17, Steps: 17 | Train Loss: 0.950 Vali Loss: 6.612 Vali Acc: 0.270 Test Loss: 6.612 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.975720167160034
Epoch: 18, Steps: 17 | Train Loss: 0.641 Vali Loss: 7.252 Vali Acc: 0.259 Test Loss: 7.252 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.781179904937744
Epoch: 19, Steps: 17 | Train Loss: 0.837 Vali Loss: 6.410 Vali Acc: 0.251 Test Loss: 6.410 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.397269487380981
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.461 Vali Acc: 0.285 Test Loss: 1.461 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 9.33947491645813
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.857 Vali Acc: 0.224 Test Loss: 1.857 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.248641967773438
Epoch: 3, Steps: 17 | Train Loss: 1.544 Vali Loss: 2.063 Vali Acc: 0.232 Test Loss: 2.063 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.679541110992432
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 3.062 Vali Acc: 0.243 Test Loss: 3.062 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.13476037979126
Epoch: 5, Steps: 17 | Train Loss: 1.286 Vali Loss: 3.008 Vali Acc: 0.251 Test Loss: 3.008 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.970256090164185
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 3.296 Vali Acc: 0.240 Test Loss: 3.296 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.781692743301392
Epoch: 7, Steps: 17 | Train Loss: 1.260 Vali Loss: 4.142 Vali Acc: 0.259 Test Loss: 4.142 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.829710721969604
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 2.970 Vali Acc: 0.247 Test Loss: 2.970 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.70083999633789
Epoch: 9, Steps: 17 | Train Loss: 1.194 Vali Loss: 3.640 Vali Acc: 0.255 Test Loss: 3.640 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.77330756187439
Epoch: 10, Steps: 17 | Train Loss: 1.152 Vali Loss: 4.047 Vali Acc: 0.259 Test Loss: 4.047 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.82469129562378
Epoch: 11, Steps: 17 | Train Loss: 1.005 Vali Loss: 4.414 Vali Acc: 0.262 Test Loss: 4.414 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.342208623886108
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 12.26113772392273
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 2.005 Vali Acc: 0.243 Test Loss: 2.005 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.35831880569458
Epoch: 3, Steps: 17 | Train Loss: 1.604 Vali Loss: 2.254 Vali Acc: 0.232 Test Loss: 2.254 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.48482894897461
Epoch: 4, Steps: 17 | Train Loss: 1.400 Vali Loss: 3.522 Vali Acc: 0.255 Test Loss: 3.522 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.45765209197998
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 3.952 Vali Acc: 0.262 Test Loss: 3.952 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.8833909034729
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 4.024 Vali Acc: 0.243 Test Loss: 4.024 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.14559268951416
Epoch: 7, Steps: 17 | Train Loss: 1.471 Vali Loss: 5.011 Vali Acc: 0.247 Test Loss: 5.011 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.496623039245605
Epoch: 8, Steps: 17 | Train Loss: 1.535 Vali Loss: 4.265 Vali Acc: 0.247 Test Loss: 4.265 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.606233596801758
Epoch: 9, Steps: 17 | Train Loss: 1.521 Vali Loss: 4.167 Vali Acc: 0.255 Test Loss: 4.167 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.00221061706543
Epoch: 10, Steps: 17 | Train Loss: 1.505 Vali Loss: 4.687 Vali Acc: 0.217 Test Loss: 4.687 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.116198539733887
Epoch: 11, Steps: 17 | Train Loss: 1.259 Vali Loss: 4.553 Vali Acc: 0.236 Test Loss: 4.553 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 664964
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.808900833129883
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.513 Vali Acc: 0.232 Test Loss: 1.513 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 9.966933250427246
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.706 Vali Acc: 0.262 Test Loss: 1.706 Test Acc: 0.262
Validation loss decreased (-0.231924 --> -0.262340).  Saving model ...
Epoch: 3 cost time: 9.797411441802979
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
Validation loss decreased (-0.262340 --> -0.281352).  Saving model ...
Epoch: 4 cost time: 10.300176620483398
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.582 Vali Acc: 0.270 Test Loss: 1.582 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.021904230117798
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 2.929 Vali Acc: 0.232 Test Loss: 2.929 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.463407516479492
Epoch: 6, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.807 Vali Acc: 0.293 Test Loss: 1.807 Test Acc: 0.293
Validation loss decreased (-0.281352 --> -0.292758).  Saving model ...
Epoch: 7 cost time: 11.49031138420105
Epoch: 7, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.770 Vali Acc: 0.247 Test Loss: 1.770 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.870488166809082
Epoch: 8, Steps: 17 | Train Loss: 1.158 Vali Loss: 2.101 Vali Acc: 0.217 Test Loss: 2.101 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.31249475479126
Epoch: 9, Steps: 17 | Train Loss: 1.319 Vali Loss: 2.665 Vali Acc: 0.240 Test Loss: 2.665 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.771732091903687
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 2.060 Vali Acc: 0.270 Test Loss: 2.060 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.624632358551025
Epoch: 11, Steps: 17 | Train Loss: 0.978 Vali Loss: 2.128 Vali Acc: 0.270 Test Loss: 2.128 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.769222497940063
Epoch: 12, Steps: 17 | Train Loss: 0.802 Vali Loss: 2.167 Vali Acc: 0.270 Test Loss: 2.167 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.3523690700531
Epoch: 13, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.462 Vali Acc: 0.278 Test Loss: 2.462 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.947593450546265
Epoch: 14, Steps: 17 | Train Loss: 0.643 Vali Loss: 2.632 Vali Acc: 0.278 Test Loss: 2.632 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.159665584564209
Epoch: 15, Steps: 17 | Train Loss: 0.606 Vali Loss: 2.654 Vali Acc: 0.270 Test Loss: 2.654 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.091299057006836
Epoch: 16, Steps: 17 | Train Loss: 0.500 Vali Loss: 2.751 Vali Acc: 0.255 Test Loss: 2.751 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.047683000564575
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.523 Vali Acc: 0.232 Test Loss: 1.523 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 10.41703176498413
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.709 Vali Acc: 0.274 Test Loss: 1.709 Test Acc: 0.274
Validation loss decreased (-0.231924 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 11.446314096450806
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.588 Vali Acc: 0.262 Test Loss: 1.588 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.53983187675476
Epoch: 4, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.570 Vali Acc: 0.285 Test Loss: 1.570 Test Acc: 0.285
Validation loss decreased (-0.273747 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 11.188105583190918
Epoch: 5, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.913 Vali Acc: 0.221 Test Loss: 2.913 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.738355159759521
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.700 Vali Acc: 0.285 Test Loss: 1.700 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.681286096572876
Epoch: 7, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.701 Vali Acc: 0.266 Test Loss: 1.701 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.202499628067017
Epoch: 8, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.041 Vali Acc: 0.243 Test Loss: 2.041 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.739786863327026
Epoch: 9, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.436 Vali Acc: 0.266 Test Loss: 2.436 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.336002826690674
Epoch: 10, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.150 Vali Acc: 0.240 Test Loss: 2.150 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.66178297996521
Epoch: 11, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.064 Vali Acc: 0.232 Test Loss: 2.064 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.855865478515625
Epoch: 12, Steps: 17 | Train Loss: 0.746 Vali Loss: 2.149 Vali Acc: 0.255 Test Loss: 2.149 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.405302047729492
Epoch: 13, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.570 Vali Acc: 0.251 Test Loss: 2.570 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.02262806892395
Epoch: 14, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.806 Vali Acc: 0.285 Test Loss: 2.806 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.063256978988647
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.539 Vali Acc: 0.255 Test Loss: 1.539 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 12.182739734649658
Epoch: 2, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.593 Vali Acc: 0.209 Test Loss: 1.593 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.437157392501831
Epoch: 3, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.663 Vali Acc: 0.278 Test Loss: 1.663 Test Acc: 0.278
Validation loss decreased (-0.254737 --> -0.277550).  Saving model ...
Epoch: 4 cost time: 12.269226312637329
Epoch: 4, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.632 Vali Acc: 0.266 Test Loss: 1.632 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.604414701461792
Epoch: 5, Steps: 17 | Train Loss: 1.092 Vali Loss: 2.903 Vali Acc: 0.224 Test Loss: 2.903 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.799213171005249
Epoch: 6, Steps: 17 | Train Loss: 1.352 Vali Loss: 2.178 Vali Acc: 0.236 Test Loss: 2.178 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.725155115127563
Epoch: 7, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.117 Vali Acc: 0.255 Test Loss: 2.117 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.332335710525513
Epoch: 8, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.215 Vali Acc: 0.232 Test Loss: 2.215 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.933643341064453
Epoch: 9, Steps: 17 | Train Loss: 1.211 Vali Loss: 3.444 Vali Acc: 0.236 Test Loss: 3.444 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.117218255996704
Epoch: 10, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.484 Vali Acc: 0.251 Test Loss: 2.484 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.127570629119873
Epoch: 11, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.828 Vali Acc: 0.243 Test Loss: 2.828 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.799028635025024
Epoch: 12, Steps: 17 | Train Loss: 0.609 Vali Loss: 2.630 Vali Acc: 0.266 Test Loss: 2.630 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.233291387557983
Epoch: 13, Steps: 17 | Train Loss: 0.619 Vali Loss: 3.009 Vali Acc: 0.224 Test Loss: 3.009 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.959549188613892
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.536 Vali Acc: 0.228 Test Loss: 1.536 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 10.63161826133728
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.846 Vali Acc: 0.247 Test Loss: 1.846 Test Acc: 0.247
Validation loss decreased (-0.228122 --> -0.247130).  Saving model ...
Epoch: 3 cost time: 10.130614757537842
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.900 Vali Acc: 0.266 Test Loss: 1.900 Test Acc: 0.266
Validation loss decreased (-0.247130 --> -0.266141).  Saving model ...
Epoch: 4 cost time: 10.1283860206604
Epoch: 4, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.769 Vali Acc: 0.259 Test Loss: 1.769 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.351418256759644
Epoch: 5, Steps: 17 | Train Loss: 1.019 Vali Loss: 3.120 Vali Acc: 0.240 Test Loss: 3.120 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.88456130027771
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.728 Vali Acc: 0.251 Test Loss: 2.728 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.394841194152832
Epoch: 7, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.484 Vali Acc: 0.266 Test Loss: 2.484 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.487823963165283
Epoch: 8, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.499 Vali Acc: 0.259 Test Loss: 2.499 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.368826866149902
Epoch: 9, Steps: 17 | Train Loss: 1.140 Vali Loss: 3.193 Vali Acc: 0.255 Test Loss: 3.193 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.771424770355225
Epoch: 10, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.880 Vali Acc: 0.240 Test Loss: 2.880 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.86631441116333
Epoch: 11, Steps: 17 | Train Loss: 0.625 Vali Loss: 2.811 Vali Acc: 0.251 Test Loss: 2.811 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.398119449615479
Epoch: 12, Steps: 17 | Train Loss: 0.548 Vali Loss: 2.927 Vali Acc: 0.243 Test Loss: 2.927 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.324825286865234
Epoch: 13, Steps: 17 | Train Loss: 0.483 Vali Loss: 4.548 Vali Acc: 0.243 Test Loss: 4.548 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.03658652305603
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.452 Vali Acc: 0.270 Test Loss: 1.452 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 9.3765389919281
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.753 Vali Acc: 0.266 Test Loss: 1.753 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.936200380325317
Epoch: 3, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.939 Vali Acc: 0.243 Test Loss: 1.939 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.874295949935913
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.789 Vali Acc: 0.243 Test Loss: 1.789 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.998155117034912
Epoch: 5, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.684 Vali Acc: 0.251 Test Loss: 2.684 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.335783958435059
Epoch: 6, Steps: 17 | Train Loss: 1.263 Vali Loss: 2.330 Vali Acc: 0.266 Test Loss: 2.330 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.383324384689331
Epoch: 7, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.465 Vali Acc: 0.270 Test Loss: 2.465 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.055794954299927
Epoch: 8, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.339 Vali Acc: 0.274 Test Loss: 2.339 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273741).  Saving model ...
Epoch: 9 cost time: 9.340503454208374
Epoch: 9, Steps: 17 | Train Loss: 1.017 Vali Loss: 3.639 Vali Acc: 0.289 Test Loss: 3.639 Test Acc: 0.289
Validation loss decreased (-0.273741 --> -0.288937).  Saving model ...
Epoch: 10 cost time: 9.88657546043396
Epoch: 10, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.866 Vali Acc: 0.262 Test Loss: 2.866 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.41780710220337
Epoch: 11, Steps: 17 | Train Loss: 0.627 Vali Loss: 2.877 Vali Acc: 0.278 Test Loss: 2.877 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.778334379196167
Epoch: 12, Steps: 17 | Train Loss: 0.485 Vali Loss: 2.952 Vali Acc: 0.285 Test Loss: 2.952 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.274005889892578
Epoch: 13, Steps: 17 | Train Loss: 0.535 Vali Loss: 3.039 Vali Acc: 0.278 Test Loss: 3.039 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.284214973449707
Epoch: 14, Steps: 17 | Train Loss: 0.508 Vali Loss: 4.148 Vali Acc: 0.293 Test Loss: 4.148 Test Acc: 0.293
Validation loss decreased (-0.288937 --> -0.292734).  Saving model ...
Epoch: 15 cost time: 9.415135860443115
Epoch: 15, Steps: 17 | Train Loss: 0.312 Vali Loss: 3.957 Vali Acc: 0.266 Test Loss: 3.957 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.182441711425781
Epoch: 16, Steps: 17 | Train Loss: 0.324 Vali Loss: 3.682 Vali Acc: 0.266 Test Loss: 3.682 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.621458053588867
Epoch: 17, Steps: 17 | Train Loss: 0.244 Vali Loss: 4.476 Vali Acc: 0.270 Test Loss: 4.476 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.358269691467285
Epoch: 18, Steps: 17 | Train Loss: 0.293 Vali Loss: 4.853 Vali Acc: 0.259 Test Loss: 4.853 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.419028282165527
Epoch: 19, Steps: 17 | Train Loss: 0.239 Vali Loss: 4.367 Vali Acc: 0.262 Test Loss: 4.367 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.506522417068481
Epoch: 20, Steps: 17 | Train Loss: 0.195 Vali Loss: 4.875 Vali Acc: 0.278 Test Loss: 4.875 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.578154563903809
Epoch: 21, Steps: 17 | Train Loss: 0.222 Vali Loss: 5.249 Vali Acc: 0.281 Test Loss: 5.249 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.616222143173218
Epoch: 22, Steps: 17 | Train Loss: 0.234 Vali Loss: 5.874 Vali Acc: 0.274 Test Loss: 5.874 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.666130065917969
Epoch: 23, Steps: 17 | Train Loss: 0.188 Vali Loss: 6.646 Vali Acc: 0.281 Test Loss: 6.646 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.55907392501831
Epoch: 24, Steps: 17 | Train Loss: 0.203 Vali Loss: 5.525 Vali Acc: 0.297 Test Loss: 5.525 Test Acc: 0.297
Validation loss decreased (-0.292734 --> -0.296523).  Saving model ...
Epoch: 25 cost time: 9.711286306381226
Epoch: 25, Steps: 17 | Train Loss: 0.125 Vali Loss: 6.020 Vali Acc: 0.289 Test Loss: 6.020 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.165642738342285
Epoch: 26, Steps: 17 | Train Loss: 0.136 Vali Loss: 6.144 Vali Acc: 0.259 Test Loss: 6.144 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.544578790664673
Epoch: 27, Steps: 17 | Train Loss: 0.102 Vali Loss: 6.264 Vali Acc: 0.262 Test Loss: 6.264 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.225375175476074
Epoch: 28, Steps: 17 | Train Loss: 0.150 Vali Loss: 6.308 Vali Acc: 0.270 Test Loss: 6.308 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.179469108581543
Epoch: 29, Steps: 17 | Train Loss: 0.120 Vali Loss: 6.229 Vali Acc: 0.255 Test Loss: 6.229 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.312004327774048
Epoch: 30, Steps: 17 | Train Loss: 0.164 Vali Loss: 7.007 Vali Acc: 0.297 Test Loss: 7.007 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.109241724014282
Epoch: 31, Steps: 17 | Train Loss: 0.118 Vali Loss: 7.552 Vali Acc: 0.255 Test Loss: 7.552 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 8.827076196670532
Epoch: 32, Steps: 17 | Train Loss: 0.338 Vali Loss: 9.854 Vali Acc: 0.293 Test Loss: 9.854 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.36302638053894
Epoch: 33, Steps: 17 | Train Loss: 0.252 Vali Loss: 8.734 Vali Acc: 0.297 Test Loss: 8.734 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 8.913697242736816
Epoch: 34, Steps: 17 | Train Loss: 0.117 Vali Loss: 8.101 Vali Acc: 0.285 Test Loss: 8.101 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.983880043029785
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (inf --> -0.304169).  Saving model ...
Epoch: 2 cost time: 9.682591199874878
Epoch: 2, Steps: 17 | Train Loss: 1.369 Vali Loss: 2.005 Vali Acc: 0.247 Test Loss: 2.005 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.52712869644165
Epoch: 3, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.175 Vali Acc: 0.255 Test Loss: 2.175 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.599836111068726
Epoch: 4, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.722 Vali Acc: 0.251 Test Loss: 1.722 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.84457516670227
Epoch: 5, Steps: 17 | Train Loss: 1.123 Vali Loss: 2.703 Vali Acc: 0.281 Test Loss: 2.703 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.901934385299683
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 2.473 Vali Acc: 0.281 Test Loss: 2.473 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.031853437423706
Epoch: 7, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.522 Vali Acc: 0.251 Test Loss: 2.522 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.864072799682617
Epoch: 8, Steps: 17 | Train Loss: 1.032 Vali Loss: 2.203 Vali Acc: 0.281 Test Loss: 2.203 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.798012495040894
Epoch: 9, Steps: 17 | Train Loss: 1.109 Vali Loss: 3.476 Vali Acc: 0.293 Test Loss: 3.476 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.577915668487549
Epoch: 10, Steps: 17 | Train Loss: 1.097 Vali Loss: 3.290 Vali Acc: 0.262 Test Loss: 3.290 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.230557203292847
Epoch: 11, Steps: 17 | Train Loss: 0.683 Vali Loss: 3.067 Vali Acc: 0.251 Test Loss: 3.067 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.00363802909851
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 11.765509605407715
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.860 Vali Acc: 0.270 Test Loss: 1.860 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.947518587112427
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 2.199 Vali Acc: 0.262 Test Loss: 2.199 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.081766843795776
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.788 Vali Acc: 0.259 Test Loss: 1.788 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.689464092254639
Epoch: 5, Steps: 17 | Train Loss: 1.215 Vali Loss: 2.629 Vali Acc: 0.228 Test Loss: 2.629 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.135270833969116
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 2.362 Vali Acc: 0.251 Test Loss: 2.362 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.679131269454956
Epoch: 7, Steps: 17 | Train Loss: 1.096 Vali Loss: 2.281 Vali Acc: 0.255 Test Loss: 2.281 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.343443393707275
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 2.270 Vali Acc: 0.270 Test Loss: 2.270 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.981124877929688
Epoch: 9, Steps: 17 | Train Loss: 1.282 Vali Loss: 3.178 Vali Acc: 0.262 Test Loss: 3.178 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.342248678207397
Epoch: 10, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.667 Vali Acc: 0.266 Test Loss: 2.667 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.191232919692993
Epoch: 11, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.840 Vali Acc: 0.266 Test Loss: 2.840 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.69766354560852
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 9.031682968139648
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 2.072 Vali Acc: 0.255 Test Loss: 2.072 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.441215991973877
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.496 Vali Acc: 0.259 Test Loss: 2.496 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.84877347946167
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.840 Vali Acc: 0.266 Test Loss: 1.840 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.51591444015503
Epoch: 5, Steps: 17 | Train Loss: 1.235 Vali Loss: 2.832 Vali Acc: 0.236 Test Loss: 2.832 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.0960373878479
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 2.631 Vali Acc: 0.259 Test Loss: 2.631 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.914223432540894
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.357 Vali Acc: 0.289 Test Loss: 2.357 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.416208505630493
Epoch: 8, Steps: 17 | Train Loss: 1.190 Vali Loss: 2.446 Vali Acc: 0.266 Test Loss: 2.446 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.475755453109741
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 3.306 Vali Acc: 0.255 Test Loss: 3.306 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.172024488449097
Epoch: 10, Steps: 17 | Train Loss: 1.199 Vali Loss: 3.006 Vali Acc: 0.266 Test Loss: 3.006 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.507498502731323
Epoch: 11, Steps: 17 | Train Loss: 0.911 Vali Loss: 3.048 Vali Acc: 0.270 Test Loss: 3.048 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.217045307159424
Epoch: 1, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.476 Vali Acc: 0.259 Test Loss: 1.476 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 11.696279525756836
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 2.293 Vali Acc: 0.251 Test Loss: 2.293 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.552687644958496
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 2.650 Vali Acc: 0.251 Test Loss: 2.650 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.945496320724487
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 2.162 Vali Acc: 0.247 Test Loss: 2.162 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.265223503112793
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 3.004 Vali Acc: 0.247 Test Loss: 3.004 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.827939987182617
Epoch: 6, Steps: 17 | Train Loss: 1.449 Vali Loss: 2.660 Vali Acc: 0.236 Test Loss: 2.660 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.731447458267212
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 2.862 Vali Acc: 0.270 Test Loss: 2.862 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269933).  Saving model ...
Epoch: 8 cost time: 9.79801082611084
Epoch: 8, Steps: 17 | Train Loss: 1.226 Vali Loss: 2.784 Vali Acc: 0.278 Test Loss: 2.784 Test Acc: 0.278
Validation loss decreased (-0.269933 --> -0.277539).  Saving model ...
Epoch: 9 cost time: 9.705677032470703
Epoch: 9, Steps: 17 | Train Loss: 1.522 Vali Loss: 3.095 Vali Acc: 0.236 Test Loss: 3.095 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.928361654281616
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 2.899 Vali Acc: 0.255 Test Loss: 2.899 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.914113998413086
Epoch: 11, Steps: 17 | Train Loss: 0.987 Vali Loss: 3.001 Vali Acc: 0.236 Test Loss: 3.001 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.746292114257812
Epoch: 12, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.943 Vali Acc: 0.262 Test Loss: 2.943 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.412988662719727
Epoch: 13, Steps: 17 | Train Loss: 0.938 Vali Loss: 3.346 Vali Acc: 0.240 Test Loss: 3.346 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.949638843536377
Epoch: 14, Steps: 17 | Train Loss: 0.899 Vali Loss: 3.561 Vali Acc: 0.251 Test Loss: 3.561 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.761726140975952
Epoch: 15, Steps: 17 | Train Loss: 0.797 Vali Loss: 4.091 Vali Acc: 0.224 Test Loss: 4.091 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.227211952209473
Epoch: 16, Steps: 17 | Train Loss: 0.879 Vali Loss: 4.248 Vali Acc: 0.255 Test Loss: 4.248 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.700193643569946
Epoch: 17, Steps: 17 | Train Loss: 0.740 Vali Loss: 3.927 Vali Acc: 0.251 Test Loss: 3.927 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.412269592285156
Epoch: 18, Steps: 17 | Train Loss: 0.732 Vali Loss: 4.458 Vali Acc: 0.262 Test Loss: 4.458 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.232718706130981
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.439 Vali Acc: 0.266 Test Loss: 1.439 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 10.71147084236145
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.912 Vali Acc: 0.251 Test Loss: 1.912 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.145567417144775
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 2.302 Vali Acc: 0.251 Test Loss: 2.302 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.092620134353638
Epoch: 4, Steps: 17 | Train Loss: 1.518 Vali Loss: 2.112 Vali Acc: 0.251 Test Loss: 2.112 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.184901475906372
Epoch: 5, Steps: 17 | Train Loss: 1.374 Vali Loss: 2.491 Vali Acc: 0.251 Test Loss: 2.491 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.915635585784912
Epoch: 6, Steps: 17 | Train Loss: 1.523 Vali Loss: 2.175 Vali Acc: 0.232 Test Loss: 2.175 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.791420459747314
Epoch: 7, Steps: 17 | Train Loss: 1.401 Vali Loss: 2.378 Vali Acc: 0.255 Test Loss: 2.378 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.098192691802979
Epoch: 8, Steps: 17 | Train Loss: 1.411 Vali Loss: 2.356 Vali Acc: 0.255 Test Loss: 2.356 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.854171514511108
Epoch: 9, Steps: 17 | Train Loss: 1.678 Vali Loss: 2.543 Vali Acc: 0.255 Test Loss: 2.543 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.76125717163086
Epoch: 10, Steps: 17 | Train Loss: 1.366 Vali Loss: 2.455 Vali Acc: 0.232 Test Loss: 2.455 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.978906154632568
Epoch: 11, Steps: 17 | Train Loss: 1.272 Vali Loss: 2.787 Vali Acc: 0.240 Test Loss: 2.787 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 660164
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.748169183731079
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.495 Vali Acc: 0.285 Test Loss: 1.495 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 9.739742994308472
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.517 Vali Acc: 0.255 Test Loss: 1.517 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.954009294509888
Epoch: 3, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.590 Vali Acc: 0.259 Test Loss: 1.590 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.852514028549194
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.876 Vali Acc: 0.243 Test Loss: 1.876 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.330688953399658
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.389 Vali Acc: 0.221 Test Loss: 2.389 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.869716882705688
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.45493197441101
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.973 Vali Acc: 0.262 Test Loss: 1.973 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.762166976928711
Epoch: 8, Steps: 17 | Train Loss: 1.079 Vali Loss: 2.030 Vali Acc: 0.243 Test Loss: 2.030 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.475069284439087
Epoch: 9, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.921 Vali Acc: 0.255 Test Loss: 1.921 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.13626503944397
Epoch: 10, Steps: 17 | Train Loss: 1.040 Vali Loss: 2.698 Vali Acc: 0.228 Test Loss: 2.698 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.36322569847107
Epoch: 11, Steps: 17 | Train Loss: 1.102 Vali Loss: 2.711 Vali Acc: 0.247 Test Loss: 2.711 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.270403385162354
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.480 Vali Acc: 0.278 Test Loss: 1.480 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 12.33303952217102
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.513 Vali Acc: 0.278 Test Loss: 1.513 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.129688501358032
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.583 Vali Acc: 0.274 Test Loss: 1.583 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.501071453094482
Epoch: 4, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.840 Vali Acc: 0.251 Test Loss: 1.840 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.456489562988281
Epoch: 5, Steps: 17 | Train Loss: 1.472 Vali Loss: 2.260 Vali Acc: 0.224 Test Loss: 2.260 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.087725400924683
Epoch: 6, Steps: 17 | Train Loss: 1.293 Vali Loss: 2.174 Vali Acc: 0.259 Test Loss: 2.174 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.364264011383057
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 2.049 Vali Acc: 0.243 Test Loss: 2.049 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.78613829612732
Epoch: 8, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.972 Vali Acc: 0.240 Test Loss: 1.972 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.326135873794556
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 2.009 Vali Acc: 0.247 Test Loss: 2.009 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.322847843170166
Epoch: 10, Steps: 17 | Train Loss: 0.984 Vali Loss: 2.979 Vali Acc: 0.255 Test Loss: 2.979 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.880476951599121
Epoch: 11, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.532 Vali Acc: 0.213 Test Loss: 2.532 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.485517263412476
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.487 Vali Acc: 0.243 Test Loss: 1.487 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 9.2740638256073
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.591 Vali Acc: 0.247 Test Loss: 1.591 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247132).  Saving model ...
Epoch: 3 cost time: 9.95575761795044
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.205035209655762
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.722 Vali Acc: 0.217 Test Loss: 1.722 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.791317224502563
Epoch: 5, Steps: 17 | Train Loss: 1.350 Vali Loss: 2.118 Vali Acc: 0.213 Test Loss: 2.118 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.269985675811768
Epoch: 6, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.284 Vali Acc: 0.236 Test Loss: 2.284 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.816894769668579
Epoch: 7, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.293 Vali Acc: 0.247 Test Loss: 2.293 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.440109968185425
Epoch: 8, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.358 Vali Acc: 0.243 Test Loss: 2.358 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.269341230392456
Epoch: 9, Steps: 17 | Train Loss: 1.022 Vali Loss: 2.361 Vali Acc: 0.232 Test Loss: 2.361 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.608606576919556
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.990 Vali Acc: 0.228 Test Loss: 2.990 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.432937145233154
Epoch: 11, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.936 Vali Acc: 0.251 Test Loss: 2.936 Test Acc: 0.251
Validation loss decreased (-0.247132 --> -0.250921).  Saving model ...
Epoch: 12 cost time: 9.411795377731323
Epoch: 12, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.957 Vali Acc: 0.228 Test Loss: 2.957 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.378505945205688
Epoch: 13, Steps: 17 | Train Loss: 0.728 Vali Loss: 3.059 Vali Acc: 0.247 Test Loss: 3.059 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.683879852294922
Epoch: 14, Steps: 17 | Train Loss: 0.602 Vali Loss: 3.400 Vali Acc: 0.243 Test Loss: 3.400 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.691391706466675
Epoch: 15, Steps: 17 | Train Loss: 0.588 Vali Loss: 3.158 Vali Acc: 0.240 Test Loss: 3.158 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.068868160247803
Epoch: 16, Steps: 17 | Train Loss: 0.445 Vali Loss: 3.289 Vali Acc: 0.224 Test Loss: 3.289 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.640941381454468
Epoch: 17, Steps: 17 | Train Loss: 0.451 Vali Loss: 4.237 Vali Acc: 0.259 Test Loss: 4.237 Test Acc: 0.259
Validation loss decreased (-0.250921 --> -0.258513).  Saving model ...
Epoch: 18 cost time: 9.981667280197144
Epoch: 18, Steps: 17 | Train Loss: 0.350 Vali Loss: 5.005 Vali Acc: 0.247 Test Loss: 5.005 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.792114973068237
Epoch: 19, Steps: 17 | Train Loss: 0.390 Vali Loss: 3.837 Vali Acc: 0.243 Test Loss: 3.837 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.023336172103882
Epoch: 20, Steps: 17 | Train Loss: 0.320 Vali Loss: 4.325 Vali Acc: 0.247 Test Loss: 4.325 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.641607284545898
Epoch: 21, Steps: 17 | Train Loss: 0.413 Vali Loss: 4.624 Vali Acc: 0.274 Test Loss: 4.624 Test Acc: 0.274
Validation loss decreased (-0.258513 --> -0.273718).  Saving model ...
Epoch: 22 cost time: 10.004860162734985
Epoch: 22, Steps: 17 | Train Loss: 0.486 Vali Loss: 4.745 Vali Acc: 0.274 Test Loss: 4.745 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.366496086120605
Epoch: 23, Steps: 17 | Train Loss: 0.221 Vali Loss: 4.757 Vali Acc: 0.224 Test Loss: 4.757 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.100091457366943
Epoch: 24, Steps: 17 | Train Loss: 0.164 Vali Loss: 5.049 Vali Acc: 0.293 Test Loss: 5.049 Test Acc: 0.293
Validation loss decreased (-0.273718 --> -0.292725).  Saving model ...
Epoch: 25 cost time: 9.095239162445068
Epoch: 25, Steps: 17 | Train Loss: 0.286 Vali Loss: 5.751 Vali Acc: 0.266 Test Loss: 5.751 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.08267879486084
Epoch: 26, Steps: 17 | Train Loss: 0.348 Vali Loss: 5.341 Vali Acc: 0.259 Test Loss: 5.341 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.193095445632935
Epoch: 27, Steps: 17 | Train Loss: 0.147 Vali Loss: 6.758 Vali Acc: 0.259 Test Loss: 6.758 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 10.036564826965332
Epoch: 28, Steps: 17 | Train Loss: 0.199 Vali Loss: 5.282 Vali Acc: 0.285 Test Loss: 5.282 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.799538373947144
Epoch: 29, Steps: 17 | Train Loss: 0.274 Vali Loss: 5.793 Vali Acc: 0.255 Test Loss: 5.793 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.027028560638428
Epoch: 30, Steps: 17 | Train Loss: 0.280 Vali Loss: 6.718 Vali Acc: 0.259 Test Loss: 6.718 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 9.773137092590332
Epoch: 31, Steps: 17 | Train Loss: 0.099 Vali Loss: 6.540 Vali Acc: 0.240 Test Loss: 6.540 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 10.168302774429321
Epoch: 32, Steps: 17 | Train Loss: 0.113 Vali Loss: 7.224 Vali Acc: 0.243 Test Loss: 7.224 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 10.102139949798584
Epoch: 33, Steps: 17 | Train Loss: 0.160 Vali Loss: 7.636 Vali Acc: 0.266 Test Loss: 7.636 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.1972975730896
Epoch: 34, Steps: 17 | Train Loss: 0.056 Vali Loss: 6.192 Vali Acc: 0.247 Test Loss: 6.192 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.244396686553955
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.542 Vali Acc: 0.262 Test Loss: 1.542 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 8.971770286560059
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.569 Vali Acc: 0.278 Test Loss: 1.569 Test Acc: 0.278
Validation loss decreased (-0.262342 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 9.531414985656738
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.650 Vali Acc: 0.236 Test Loss: 1.650 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.05349850654602
Epoch: 4, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.859 Vali Acc: 0.262 Test Loss: 1.859 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.468814611434937
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 2.196 Vali Acc: 0.274 Test Loss: 2.196 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.331965208053589
Epoch: 6, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.833 Vali Acc: 0.270 Test Loss: 2.833 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.84572434425354
Epoch: 7, Steps: 17 | Train Loss: 1.032 Vali Loss: 3.375 Vali Acc: 0.259 Test Loss: 3.375 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.926584005355835
Epoch: 8, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.656 Vali Acc: 0.251 Test Loss: 2.656 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.756798028945923
Epoch: 9, Steps: 17 | Train Loss: 0.974 Vali Loss: 3.118 Vali Acc: 0.262 Test Loss: 3.118 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.566289186477661
Epoch: 10, Steps: 17 | Train Loss: 0.836 Vali Loss: 3.981 Vali Acc: 0.262 Test Loss: 3.981 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.538946866989136
Epoch: 11, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.964 Vali Acc: 0.278 Test Loss: 2.964 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.151617288589478
Epoch: 12, Steps: 17 | Train Loss: 0.637 Vali Loss: 4.387 Vali Acc: 0.247 Test Loss: 4.387 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.116916179656982
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.504 Vali Acc: 0.266 Test Loss: 1.504 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 8.869887828826904
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.594 Vali Acc: 0.251 Test Loss: 1.594 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.663668632507324
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.780 Vali Acc: 0.262 Test Loss: 1.780 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.074779510498047
Epoch: 4, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.795 Vali Acc: 0.266 Test Loss: 1.795 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.89255142211914
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 2.136 Vali Acc: 0.285 Test Loss: 2.136 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285150).  Saving model ...
Epoch: 6 cost time: 9.253188610076904
Epoch: 6, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.305 Vali Acc: 0.274 Test Loss: 2.305 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.174237251281738
Epoch: 7, Steps: 17 | Train Loss: 0.988 Vali Loss: 3.109 Vali Acc: 0.262 Test Loss: 3.109 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.900546073913574
Epoch: 8, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.332 Vali Acc: 0.236 Test Loss: 2.332 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.958828926086426
Epoch: 9, Steps: 17 | Train Loss: 0.902 Vali Loss: 2.583 Vali Acc: 0.274 Test Loss: 2.583 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.801615238189697
Epoch: 10, Steps: 17 | Train Loss: 0.817 Vali Loss: 3.190 Vali Acc: 0.266 Test Loss: 3.190 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.933818340301514
Epoch: 11, Steps: 17 | Train Loss: 0.744 Vali Loss: 3.546 Vali Acc: 0.266 Test Loss: 3.546 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.34280252456665
Epoch: 12, Steps: 17 | Train Loss: 0.660 Vali Loss: 3.830 Vali Acc: 0.259 Test Loss: 3.830 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.939871788024902
Epoch: 13, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.817 Vali Acc: 0.304 Test Loss: 3.817 Test Acc: 0.304
Validation loss decreased (-0.285150 --> -0.304144).  Saving model ...
Epoch: 14 cost time: 8.980094194412231
Epoch: 14, Steps: 17 | Train Loss: 0.443 Vali Loss: 4.186 Vali Acc: 0.270 Test Loss: 4.186 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.451861381530762
Epoch: 15, Steps: 17 | Train Loss: 0.362 Vali Loss: 3.942 Vali Acc: 0.278 Test Loss: 3.942 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.021452188491821
Epoch: 16, Steps: 17 | Train Loss: 0.375 Vali Loss: 4.171 Vali Acc: 0.293 Test Loss: 4.171 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.341837167739868
Epoch: 17, Steps: 17 | Train Loss: 0.345 Vali Loss: 4.494 Vali Acc: 0.285 Test Loss: 4.494 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.69106411933899
Epoch: 18, Steps: 17 | Train Loss: 0.314 Vali Loss: 4.268 Vali Acc: 0.293 Test Loss: 4.268 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.921606302261353
Epoch: 19, Steps: 17 | Train Loss: 0.277 Vali Loss: 5.225 Vali Acc: 0.285 Test Loss: 5.225 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.060624837875366
Epoch: 20, Steps: 17 | Train Loss: 0.313 Vali Loss: 4.342 Vali Acc: 0.274 Test Loss: 4.342 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.341595649719238
Epoch: 21, Steps: 17 | Train Loss: 0.219 Vali Loss: 5.562 Vali Acc: 0.289 Test Loss: 5.562 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.130860090255737
Epoch: 22, Steps: 17 | Train Loss: 0.227 Vali Loss: 5.025 Vali Acc: 0.281 Test Loss: 5.025 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.847594738006592
Epoch: 23, Steps: 17 | Train Loss: 0.216 Vali Loss: 4.919 Vali Acc: 0.281 Test Loss: 4.919 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.596949338912964
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.485 Vali Acc: 0.285 Test Loss: 1.485 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 10.830211162567139
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.618 Vali Acc: 0.251 Test Loss: 1.618 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.68913459777832
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.673 Vali Acc: 0.259 Test Loss: 1.673 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.939139127731323
Epoch: 4, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.823 Vali Acc: 0.255 Test Loss: 1.823 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.734691619873047
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 2.173 Vali Acc: 0.293 Test Loss: 2.173 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292754).  Saving model ...
Epoch: 6 cost time: 11.474693775177002
Epoch: 6, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.173 Vali Acc: 0.259 Test Loss: 2.173 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.420417547225952
Epoch: 7, Steps: 17 | Train Loss: 1.043 Vali Loss: 3.734 Vali Acc: 0.255 Test Loss: 3.734 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.446266889572144
Epoch: 8, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.160 Vali Acc: 0.270 Test Loss: 2.160 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.945361137390137
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.787 Vali Acc: 0.243 Test Loss: 2.787 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.442265748977661
Epoch: 10, Steps: 17 | Train Loss: 0.858 Vali Loss: 3.254 Vali Acc: 0.274 Test Loss: 3.254 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.316038846969604
Epoch: 11, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.096 Vali Acc: 0.293 Test Loss: 3.096 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.074828386306763
Epoch: 12, Steps: 17 | Train Loss: 0.704 Vali Loss: 3.276 Vali Acc: 0.255 Test Loss: 3.276 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.914564847946167
Epoch: 13, Steps: 17 | Train Loss: 0.618 Vali Loss: 3.387 Vali Acc: 0.285 Test Loss: 3.387 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.254555940628052
Epoch: 14, Steps: 17 | Train Loss: 0.585 Vali Loss: 3.713 Vali Acc: 0.262 Test Loss: 3.713 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.512430906295776
Epoch: 15, Steps: 17 | Train Loss: 0.416 Vali Loss: 3.649 Vali Acc: 0.270 Test Loss: 3.649 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.232698678970337
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.471 Vali Acc: 0.247 Test Loss: 1.471 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 9.225087881088257
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.596 Vali Acc: 0.247 Test Loss: 1.596 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.319308996200562
Epoch: 3, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.684 Vali Acc: 0.278 Test Loss: 1.684 Test Acc: 0.278
Validation loss decreased (-0.247134 --> -0.277550).  Saving model ...
Epoch: 4 cost time: 8.627997636795044
Epoch: 4, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.880 Vali Acc: 0.293 Test Loss: 1.880 Test Acc: 0.293
Validation loss decreased (-0.277550 --> -0.292757).  Saving model ...
Epoch: 5 cost time: 8.085130453109741
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 2.377 Vali Acc: 0.243 Test Loss: 2.377 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.392616987228394
Epoch: 6, Steps: 17 | Train Loss: 1.175 Vali Loss: 2.321 Vali Acc: 0.278 Test Loss: 2.321 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.478990316390991
Epoch: 7, Steps: 17 | Train Loss: 1.132 Vali Loss: 3.313 Vali Acc: 0.270 Test Loss: 3.313 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.28424596786499
Epoch: 8, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.999 Vali Acc: 0.274 Test Loss: 1.999 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.20722222328186
Epoch: 9, Steps: 17 | Train Loss: 1.148 Vali Loss: 2.824 Vali Acc: 0.255 Test Loss: 2.824 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.311677694320679
Epoch: 10, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.830 Vali Acc: 0.278 Test Loss: 2.830 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.567370414733887
Epoch: 11, Steps: 17 | Train Loss: 0.941 Vali Loss: 3.322 Vali Acc: 0.266 Test Loss: 3.322 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.623946905136108
Epoch: 12, Steps: 17 | Train Loss: 0.882 Vali Loss: 3.513 Vali Acc: 0.236 Test Loss: 3.513 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.549744367599487
Epoch: 13, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.964 Vali Acc: 0.259 Test Loss: 2.964 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.412179470062256
Epoch: 14, Steps: 17 | Train Loss: 0.728 Vali Loss: 4.676 Vali Acc: 0.266 Test Loss: 4.676 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.228374481201172
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 9.65607500076294
Epoch: 2, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.125179767608643
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.830 Vali Acc: 0.266 Test Loss: 1.830 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266141).  Saving model ...
Epoch: 4 cost time: 8.474775552749634
Epoch: 4, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.947 Vali Acc: 0.259 Test Loss: 1.947 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.133400678634644
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 2.604 Vali Acc: 0.247 Test Loss: 2.604 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.806776523590088
Epoch: 6, Steps: 17 | Train Loss: 1.225 Vali Loss: 2.435 Vali Acc: 0.270 Test Loss: 2.435 Test Acc: 0.270
Validation loss decreased (-0.266141 --> -0.269938).  Saving model ...
Epoch: 7 cost time: 9.304160594940186
Epoch: 7, Steps: 17 | Train Loss: 1.190 Vali Loss: 3.228 Vali Acc: 0.259 Test Loss: 3.228 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.173516988754272
Epoch: 8, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.963 Vali Acc: 0.281 Test Loss: 1.963 Test Acc: 0.281
Validation loss decreased (-0.269938 --> -0.281349).  Saving model ...
Epoch: 9 cost time: 9.175411224365234
Epoch: 9, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.175 Vali Acc: 0.255 Test Loss: 2.175 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.240527391433716
Epoch: 10, Steps: 17 | Train Loss: 1.012 Vali Loss: 3.122 Vali Acc: 0.228 Test Loss: 3.122 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.190940618515015
Epoch: 11, Steps: 17 | Train Loss: 0.935 Vali Loss: 3.078 Vali Acc: 0.243 Test Loss: 3.078 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.624905824661255
Epoch: 12, Steps: 17 | Train Loss: 0.924 Vali Loss: 3.279 Vali Acc: 0.247 Test Loss: 3.279 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.714802980422974
Epoch: 13, Steps: 17 | Train Loss: 0.821 Vali Loss: 3.133 Vali Acc: 0.266 Test Loss: 3.133 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.66830325126648
Epoch: 14, Steps: 17 | Train Loss: 0.834 Vali Loss: 3.609 Vali Acc: 0.251 Test Loss: 3.609 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.450422286987305
Epoch: 15, Steps: 17 | Train Loss: 0.750 Vali Loss: 3.126 Vali Acc: 0.259 Test Loss: 3.126 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.428110122680664
Epoch: 16, Steps: 17 | Train Loss: 0.679 Vali Loss: 3.344 Vali Acc: 0.236 Test Loss: 3.344 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.570129632949829
Epoch: 17, Steps: 17 | Train Loss: 0.591 Vali Loss: 3.997 Vali Acc: 0.262 Test Loss: 3.997 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.266977548599243
Epoch: 18, Steps: 17 | Train Loss: 0.755 Vali Loss: 3.762 Vali Acc: 0.266 Test Loss: 3.762 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.56400990486145
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.489 Vali Acc: 0.289 Test Loss: 1.489 Test Acc: 0.289
Validation loss decreased (inf --> -0.288958).  Saving model ...
Epoch: 2 cost time: 7.2850706577301025
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.640 Vali Acc: 0.243 Test Loss: 1.640 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.515857219696045
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.785 Vali Acc: 0.262 Test Loss: 1.785 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.296365976333618
Epoch: 4, Steps: 17 | Train Loss: 1.406 Vali Loss: 2.137 Vali Acc: 0.240 Test Loss: 2.137 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.434204816818237
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 2.608 Vali Acc: 0.240 Test Loss: 2.608 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.611342906951904
Epoch: 6, Steps: 17 | Train Loss: 1.296 Vali Loss: 2.656 Vali Acc: 0.243 Test Loss: 2.656 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.757595062255859
Epoch: 7, Steps: 17 | Train Loss: 1.261 Vali Loss: 3.932 Vali Acc: 0.247 Test Loss: 3.932 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.825582027435303
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.333 Vali Acc: 0.270 Test Loss: 2.333 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.345036506652832
Epoch: 9, Steps: 17 | Train Loss: 1.208 Vali Loss: 2.461 Vali Acc: 0.259 Test Loss: 2.461 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.156581163406372
Epoch: 10, Steps: 17 | Train Loss: 1.089 Vali Loss: 3.699 Vali Acc: 0.259 Test Loss: 3.699 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.758200645446777
Epoch: 11, Steps: 17 | Train Loss: 1.133 Vali Loss: 3.568 Vali Acc: 0.202 Test Loss: 3.568 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.49295687675476
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 6.977905750274658
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.496 Vali Acc: 0.228 Test Loss: 1.496 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.933964729309082
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.630 Vali Acc: 0.259 Test Loss: 1.630 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258539).  Saving model ...
Epoch: 4 cost time: 7.809032678604126
Epoch: 4, Steps: 17 | Train Loss: 1.462 Vali Loss: 2.061 Vali Acc: 0.251 Test Loss: 2.061 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.1683032512664795
Epoch: 5, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.458 Vali Acc: 0.228 Test Loss: 2.458 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.244967699050903
Epoch: 6, Steps: 17 | Train Loss: 1.391 Vali Loss: 2.408 Vali Acc: 0.209 Test Loss: 2.408 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.806767463684082
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 3.886 Vali Acc: 0.251 Test Loss: 3.886 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.186578512191772
Epoch: 8, Steps: 17 | Train Loss: 1.326 Vali Loss: 2.361 Vali Acc: 0.247 Test Loss: 2.361 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.302640914916992
Epoch: 9, Steps: 17 | Train Loss: 1.433 Vali Loss: 2.476 Vali Acc: 0.266 Test Loss: 2.476 Test Acc: 0.266
Validation loss decreased (-0.258539 --> -0.266135).  Saving model ...
Epoch: 10 cost time: 7.9723193645477295
Epoch: 10, Steps: 17 | Train Loss: 1.376 Vali Loss: 3.227 Vali Acc: 0.213 Test Loss: 3.227 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.621364116668701
Epoch: 11, Steps: 17 | Train Loss: 1.335 Vali Loss: 3.181 Vali Acc: 0.228 Test Loss: 3.181 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.180763244628906
Epoch: 12, Steps: 17 | Train Loss: 1.251 Vali Loss: 3.368 Vali Acc: 0.262 Test Loss: 3.368 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.425808191299438
Epoch: 13, Steps: 17 | Train Loss: 1.299 Vali Loss: 3.193 Vali Acc: 0.243 Test Loss: 3.193 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.450910806655884
Epoch: 14, Steps: 17 | Train Loss: 1.188 Vali Loss: 3.766 Vali Acc: 0.255 Test Loss: 3.766 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.638221979141235
Epoch: 15, Steps: 17 | Train Loss: 1.091 Vali Loss: 3.368 Vali Acc: 0.243 Test Loss: 3.368 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.941219329833984
Epoch: 16, Steps: 17 | Train Loss: 0.986 Vali Loss: 3.522 Vali Acc: 0.259 Test Loss: 3.522 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.058729410171509
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 4.041 Vali Acc: 0.240 Test Loss: 4.041 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.774893283843994
Epoch: 18, Steps: 17 | Train Loss: 1.041 Vali Loss: 3.925 Vali Acc: 0.251 Test Loss: 3.925 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.840977668762207
Epoch: 19, Steps: 17 | Train Loss: 1.291 Vali Loss: 6.213 Vali Acc: 0.221 Test Loss: 6.213 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 463556
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.263241291046143
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.532 Vali Acc: 0.262 Test Loss: 1.532 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 9.67382001876831
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.471 Vali Acc: 0.259 Test Loss: 1.471 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.64581847190857
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.934 Vali Acc: 0.262 Test Loss: 1.934 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.369792461395264
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.745 Vali Acc: 0.278 Test Loss: 1.745 Test Acc: 0.278
Validation loss decreased (-0.262342 --> -0.277549).  Saving model ...
Epoch: 5 cost time: 8.66141152381897
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 2.268 Vali Acc: 0.251 Test Loss: 2.268 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.87282657623291
Epoch: 6, Steps: 17 | Train Loss: 1.295 Vali Loss: 2.023 Vali Acc: 0.285 Test Loss: 2.023 Test Acc: 0.285
Validation loss decreased (-0.277549 --> -0.285151).  Saving model ...
Epoch: 7 cost time: 9.011702299118042
Epoch: 7, Steps: 17 | Train Loss: 1.306 Vali Loss: 2.259 Vali Acc: 0.300 Test Loss: 2.259 Test Acc: 0.300
Validation loss decreased (-0.285151 --> -0.300358).  Saving model ...
Epoch: 8 cost time: 9.60391902923584
Epoch: 8, Steps: 17 | Train Loss: 1.224 Vali Loss: 2.143 Vali Acc: 0.266 Test Loss: 2.143 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.742307662963867
Epoch: 9, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.398 Vali Acc: 0.247 Test Loss: 2.398 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.280417680740356
Epoch: 10, Steps: 17 | Train Loss: 0.999 Vali Loss: 2.198 Vali Acc: 0.243 Test Loss: 2.198 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.573690176010132
Epoch: 11, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.081 Vali Acc: 0.270 Test Loss: 2.081 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.743468523025513
Epoch: 12, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.676 Vali Acc: 0.259 Test Loss: 2.676 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.144300937652588
Epoch: 13, Steps: 17 | Train Loss: 0.899 Vali Loss: 2.637 Vali Acc: 0.240 Test Loss: 2.637 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.962758541107178
Epoch: 14, Steps: 17 | Train Loss: 0.847 Vali Loss: 3.790 Vali Acc: 0.262 Test Loss: 3.790 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.607478141784668
Epoch: 15, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.703 Vali Acc: 0.266 Test Loss: 2.703 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.361032485961914
Epoch: 16, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.749 Vali Acc: 0.304 Test Loss: 2.749 Test Acc: 0.304
Validation loss decreased (-0.300358 --> -0.304155).  Saving model ...
Epoch: 17 cost time: 9.0203537940979
Epoch: 17, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.978 Vali Acc: 0.278 Test Loss: 2.978 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.160497426986694
Epoch: 18, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.844 Vali Acc: 0.308 Test Loss: 2.844 Test Acc: 0.308
Validation loss decreased (-0.304155 --> -0.307956).  Saving model ...
Epoch: 19 cost time: 9.609761476516724
Epoch: 19, Steps: 17 | Train Loss: 0.490 Vali Loss: 3.254 Vali Acc: 0.270 Test Loss: 3.254 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.999159812927246
Epoch: 20, Steps: 17 | Train Loss: 0.590 Vali Loss: 3.293 Vali Acc: 0.278 Test Loss: 3.293 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.284019231796265
Epoch: 21, Steps: 17 | Train Loss: 0.423 Vali Loss: 3.507 Vali Acc: 0.312 Test Loss: 3.507 Test Acc: 0.312
Validation loss decreased (-0.307956 --> -0.311752).  Saving model ...
Epoch: 22 cost time: 9.203226089477539
Epoch: 22, Steps: 17 | Train Loss: 0.366 Vali Loss: 3.908 Vali Acc: 0.274 Test Loss: 3.908 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.28361439704895
Epoch: 23, Steps: 17 | Train Loss: 0.375 Vali Loss: 4.186 Vali Acc: 0.262 Test Loss: 4.186 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.621326208114624
Epoch: 24, Steps: 17 | Train Loss: 0.354 Vali Loss: 3.658 Vali Acc: 0.259 Test Loss: 3.658 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.79751968383789
Epoch: 25, Steps: 17 | Train Loss: 0.374 Vali Loss: 4.092 Vali Acc: 0.270 Test Loss: 4.092 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.481766700744629
Epoch: 26, Steps: 17 | Train Loss: 0.565 Vali Loss: 3.881 Vali Acc: 0.270 Test Loss: 3.881 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 10.280063390731812
Epoch: 27, Steps: 17 | Train Loss: 0.228 Vali Loss: 4.786 Vali Acc: 0.289 Test Loss: 4.786 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.563858032226562
Epoch: 28, Steps: 17 | Train Loss: 0.135 Vali Loss: 4.771 Vali Acc: 0.293 Test Loss: 4.771 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.99895429611206
Epoch: 29, Steps: 17 | Train Loss: 0.257 Vali Loss: 4.907 Vali Acc: 0.274 Test Loss: 4.907 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.239815711975098
Epoch: 30, Steps: 17 | Train Loss: 0.350 Vali Loss: 5.627 Vali Acc: 0.270 Test Loss: 5.627 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 8.37319540977478
Epoch: 31, Steps: 17 | Train Loss: 0.446 Vali Loss: 5.616 Vali Acc: 0.274 Test Loss: 5.616 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.571994066238403
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.533 Vali Acc: 0.278 Test Loss: 1.533 Test Acc: 0.278
Validation loss decreased (inf --> -0.277551).  Saving model ...
Epoch: 2 cost time: 8.780897617340088
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.461 Vali Acc: 0.278 Test Loss: 1.461 Test Acc: 0.278
Validation loss decreased (-0.277551 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 8.56096601486206
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.945 Vali Acc: 0.247 Test Loss: 1.945 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.119677782058716
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.692 Vali Acc: 0.278 Test Loss: 1.692 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.55640721321106
Epoch: 5, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.124 Vali Acc: 0.259 Test Loss: 2.124 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.443928956985474
Epoch: 6, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.924 Vali Acc: 0.281 Test Loss: 1.924 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281350).  Saving model ...
Epoch: 7 cost time: 8.175165176391602
Epoch: 7, Steps: 17 | Train Loss: 1.310 Vali Loss: 2.175 Vali Acc: 0.259 Test Loss: 2.175 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.616915702819824
Epoch: 8, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.927 Vali Acc: 0.247 Test Loss: 1.927 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.982256650924683
Epoch: 9, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.440 Vali Acc: 0.281 Test Loss: 2.440 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.634884357452393
Epoch: 10, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.397 Vali Acc: 0.293 Test Loss: 2.397 Test Acc: 0.293
Validation loss decreased (-0.281350 --> -0.292752).  Saving model ...
Epoch: 11 cost time: 7.87256646156311
Epoch: 11, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.173 Vali Acc: 0.243 Test Loss: 2.173 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.282967805862427
Epoch: 12, Steps: 17 | Train Loss: 0.923 Vali Loss: 2.444 Vali Acc: 0.270 Test Loss: 2.444 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.106127262115479
Epoch: 13, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.893 Vali Acc: 0.236 Test Loss: 2.893 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.487192153930664
Epoch: 14, Steps: 17 | Train Loss: 0.802 Vali Loss: 2.985 Vali Acc: 0.251 Test Loss: 2.985 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.384098291397095
Epoch: 15, Steps: 17 | Train Loss: 0.655 Vali Loss: 3.434 Vali Acc: 0.270 Test Loss: 3.434 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.40424108505249
Epoch: 16, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.613 Vali Acc: 0.262 Test Loss: 2.613 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.655569791793823
Epoch: 17, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.808 Vali Acc: 0.262 Test Loss: 2.808 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.459535360336304
Epoch: 18, Steps: 17 | Train Loss: 0.657 Vali Loss: 3.000 Vali Acc: 0.285 Test Loss: 3.000 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.505456686019897
Epoch: 19, Steps: 17 | Train Loss: 0.775 Vali Loss: 6.134 Vali Acc: 0.251 Test Loss: 6.134 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.537421703338623
Epoch: 20, Steps: 17 | Train Loss: 0.846 Vali Loss: 3.277 Vali Acc: 0.278 Test Loss: 3.277 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.730154037475586
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.609 Vali Acc: 0.232 Test Loss: 1.609 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 7.7609193325042725
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.605 Vali Acc: 0.236 Test Loss: 1.605 Test Acc: 0.236
Validation loss decreased (-0.231923 --> -0.235725).  Saving model ...
Epoch: 3 cost time: 8.332305192947388
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 2.096 Vali Acc: 0.240 Test Loss: 2.096 Test Acc: 0.240
Validation loss decreased (-0.235725 --> -0.239523).  Saving model ...
Epoch: 4 cost time: 8.119864463806152
Epoch: 4, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.776 Vali Acc: 0.255 Test Loss: 1.776 Test Acc: 0.255
Validation loss decreased (-0.239523 --> -0.254735).  Saving model ...
Epoch: 5 cost time: 8.724043607711792
Epoch: 5, Steps: 17 | Train Loss: 1.201 Vali Loss: 2.120 Vali Acc: 0.243 Test Loss: 2.120 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.659450769424438
Epoch: 6, Steps: 17 | Train Loss: 1.088 Vali Loss: 2.012 Vali Acc: 0.270 Test Loss: 2.012 Test Acc: 0.270
Validation loss decreased (-0.254735 --> -0.269942).  Saving model ...
Epoch: 7 cost time: 8.42154574394226
Epoch: 7, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.540 Vali Acc: 0.228 Test Loss: 2.540 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.190500974655151
Epoch: 8, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.160 Vali Acc: 0.236 Test Loss: 2.160 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.553742170333862
Epoch: 9, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.553 Vali Acc: 0.228 Test Loss: 2.553 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.606950998306274
Epoch: 10, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.525 Vali Acc: 0.259 Test Loss: 2.525 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.9107346534729
Epoch: 11, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.888 Vali Acc: 0.232 Test Loss: 2.888 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.264350652694702
Epoch: 12, Steps: 17 | Train Loss: 0.813 Vali Loss: 3.209 Vali Acc: 0.228 Test Loss: 3.209 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.564286231994629
Epoch: 13, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.666 Vali Acc: 0.259 Test Loss: 2.666 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.743776559829712
Epoch: 14, Steps: 17 | Train Loss: 0.711 Vali Loss: 4.810 Vali Acc: 0.266 Test Loss: 4.810 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.914518594741821
Epoch: 15, Steps: 17 | Train Loss: 0.658 Vali Loss: 3.133 Vali Acc: 0.259 Test Loss: 3.133 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.775318145751953
Epoch: 16, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.076 Vali Acc: 0.255 Test Loss: 3.076 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.184006452560425
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.658 Vali Acc: 0.236 Test Loss: 1.658 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 7.334264039993286
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.704 Vali Acc: 0.240 Test Loss: 1.704 Test Acc: 0.240
Validation loss decreased (-0.235725 --> -0.239527).  Saving model ...
Epoch: 3 cost time: 7.866378307342529
Epoch: 3, Steps: 17 | Train Loss: 1.326 Vali Loss: 2.234 Vali Acc: 0.251 Test Loss: 2.234 Test Acc: 0.251
Validation loss decreased (-0.239527 --> -0.250928).  Saving model ...
Epoch: 4 cost time: 7.77477502822876
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.747 Vali Acc: 0.240 Test Loss: 1.747 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.7751288414001465
Epoch: 5, Steps: 17 | Train Loss: 1.161 Vali Loss: 2.439 Vali Acc: 0.255 Test Loss: 2.439 Test Acc: 0.255
Validation loss decreased (-0.250928 --> -0.254728).  Saving model ...
Epoch: 6 cost time: 8.049790382385254
Epoch: 6, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.026 Vali Acc: 0.240 Test Loss: 2.026 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.955480575561523
Epoch: 7, Steps: 17 | Train Loss: 1.017 Vali Loss: 3.253 Vali Acc: 0.259 Test Loss: 3.253 Test Acc: 0.259
Validation loss decreased (-0.254728 --> -0.258523).  Saving model ...
Epoch: 8 cost time: 7.92933988571167
Epoch: 8, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.807 Vali Acc: 0.221 Test Loss: 2.807 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.901656627655029
Epoch: 9, Steps: 17 | Train Loss: 0.831 Vali Loss: 3.187 Vali Acc: 0.232 Test Loss: 3.187 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.911726713180542
Epoch: 10, Steps: 17 | Train Loss: 0.768 Vali Loss: 3.015 Vali Acc: 0.240 Test Loss: 3.015 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.139753818511963
Epoch: 11, Steps: 17 | Train Loss: 0.783 Vali Loss: 3.174 Vali Acc: 0.243 Test Loss: 3.174 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.926453590393066
Epoch: 12, Steps: 17 | Train Loss: 0.646 Vali Loss: 3.987 Vali Acc: 0.251 Test Loss: 3.987 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.229483366012573
Epoch: 13, Steps: 17 | Train Loss: 0.762 Vali Loss: 3.295 Vali Acc: 0.274 Test Loss: 3.295 Test Acc: 0.274
Validation loss decreased (-0.258523 --> -0.273731).  Saving model ...
Epoch: 14 cost time: 7.95419979095459
Epoch: 14, Steps: 17 | Train Loss: 0.667 Vali Loss: 4.787 Vali Acc: 0.228 Test Loss: 4.787 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.560461521148682
Epoch: 15, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.449 Vali Acc: 0.228 Test Loss: 3.449 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.237911462783813
Epoch: 16, Steps: 17 | Train Loss: 0.359 Vali Loss: 4.658 Vali Acc: 0.236 Test Loss: 4.658 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.7267749309539795
Epoch: 17, Steps: 17 | Train Loss: 0.484 Vali Loss: 4.006 Vali Acc: 0.266 Test Loss: 4.006 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.094370603561401
Epoch: 18, Steps: 17 | Train Loss: 0.362 Vali Loss: 3.966 Vali Acc: 0.232 Test Loss: 3.966 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.7408127784729
Epoch: 19, Steps: 17 | Train Loss: 0.485 Vali Loss: 7.925 Vali Acc: 0.255 Test Loss: 7.925 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.315021276473999
Epoch: 20, Steps: 17 | Train Loss: 0.467 Vali Loss: 4.734 Vali Acc: 0.262 Test Loss: 4.734 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.914820194244385
Epoch: 21, Steps: 17 | Train Loss: 0.360 Vali Loss: 5.562 Vali Acc: 0.289 Test Loss: 5.562 Test Acc: 0.289
Validation loss decreased (-0.273731 --> -0.288918).  Saving model ...
Epoch: 22 cost time: 7.727882146835327
Epoch: 22, Steps: 17 | Train Loss: 0.228 Vali Loss: 6.243 Vali Acc: 0.243 Test Loss: 6.243 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.171913146972656
Epoch: 23, Steps: 17 | Train Loss: 0.249 Vali Loss: 6.386 Vali Acc: 0.270 Test Loss: 6.386 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.350771188735962
Epoch: 24, Steps: 17 | Train Loss: 0.299 Vali Loss: 5.253 Vali Acc: 0.255 Test Loss: 5.253 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.304472208023071
Epoch: 25, Steps: 17 | Train Loss: 0.382 Vali Loss: 6.746 Vali Acc: 0.285 Test Loss: 6.746 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.772349119186401
Epoch: 26, Steps: 17 | Train Loss: 0.211 Vali Loss: 6.515 Vali Acc: 0.281 Test Loss: 6.515 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.198142051696777
Epoch: 27, Steps: 17 | Train Loss: 0.233 Vali Loss: 6.927 Vali Acc: 0.285 Test Loss: 6.927 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.065242528915405
Epoch: 28, Steps: 17 | Train Loss: 0.262 Vali Loss: 6.564 Vali Acc: 0.262 Test Loss: 6.564 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.228001356124878
Epoch: 29, Steps: 17 | Train Loss: 0.192 Vali Loss: 8.295 Vali Acc: 0.243 Test Loss: 8.295 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.399276971817017
Epoch: 30, Steps: 17 | Train Loss: 0.207 Vali Loss: 7.423 Vali Acc: 0.293 Test Loss: 7.423 Test Acc: 0.293
Validation loss decreased (-0.288918 --> -0.292701).  Saving model ...
Epoch: 31 cost time: 7.455590009689331
Epoch: 31, Steps: 17 | Train Loss: 0.100 Vali Loss: 7.787 Vali Acc: 0.236 Test Loss: 7.787 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.6783154010772705
Epoch: 32, Steps: 17 | Train Loss: 0.044 Vali Loss: 9.535 Vali Acc: 0.285 Test Loss: 9.535 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.659318208694458
Epoch: 33, Steps: 17 | Train Loss: 0.133 Vali Loss: 9.559 Vali Acc: 0.274 Test Loss: 9.559 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 7.3692522048950195
Epoch: 34, Steps: 17 | Train Loss: 0.260 Vali Loss: 8.308 Vali Acc: 0.274 Test Loss: 8.308 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.315424680709839
Epoch: 35, Steps: 17 | Train Loss: 0.128 Vali Loss: 9.831 Vali Acc: 0.278 Test Loss: 9.831 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 7.366204738616943
Epoch: 36, Steps: 17 | Train Loss: 0.136 Vali Loss: 8.179 Vali Acc: 0.270 Test Loss: 8.179 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 7.502127408981323
Epoch: 37, Steps: 17 | Train Loss: 0.109 Vali Loss: 8.410 Vali Acc: 0.255 Test Loss: 8.410 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 7.476312160491943
Epoch: 38, Steps: 17 | Train Loss: 0.090 Vali Loss: 8.491 Vali Acc: 0.240 Test Loss: 8.491 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 7.639880180358887
Epoch: 39, Steps: 17 | Train Loss: 0.133 Vali Loss: 8.939 Vali Acc: 0.255 Test Loss: 8.939 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 7.686070680618286
Epoch: 40, Steps: 17 | Train Loss: 0.079 Vali Loss: 9.059 Vali Acc: 0.270 Test Loss: 9.059 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.318922758102417
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.542 Vali Acc: 0.255 Test Loss: 1.542 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 7.0456156730651855
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.699 Vali Acc: 0.251 Test Loss: 1.699 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.608852863311768
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 2.400 Vali Acc: 0.251 Test Loss: 2.400 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.312435626983643
Epoch: 4, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.845 Vali Acc: 0.243 Test Loss: 1.845 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.2358129024505615
Epoch: 5, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.344 Vali Acc: 0.247 Test Loss: 2.344 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.067209005355835
Epoch: 6, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.285 Vali Acc: 0.224 Test Loss: 2.285 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.7566657066345215
Epoch: 7, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.432 Vali Acc: 0.270 Test Loss: 2.432 Test Acc: 0.270
Validation loss decreased (-0.254737 --> -0.269938).  Saving model ...
Epoch: 8 cost time: 6.660853385925293
Epoch: 8, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.254 Vali Acc: 0.262 Test Loss: 2.254 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.20560097694397
Epoch: 9, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.822 Vali Acc: 0.259 Test Loss: 2.822 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.6505162715911865
Epoch: 10, Steps: 17 | Train Loss: 0.742 Vali Loss: 3.052 Vali Acc: 0.274 Test Loss: 3.052 Test Acc: 0.274
Validation loss decreased (-0.269938 --> -0.273734).  Saving model ...
Epoch: 11 cost time: 6.812044858932495
Epoch: 11, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.796 Vali Acc: 0.259 Test Loss: 2.796 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.794243574142456
Epoch: 12, Steps: 17 | Train Loss: 0.673 Vali Loss: 3.172 Vali Acc: 0.289 Test Loss: 3.172 Test Acc: 0.289
Validation loss decreased (-0.273734 --> -0.288942).  Saving model ...
Epoch: 13 cost time: 6.881819009780884
Epoch: 13, Steps: 17 | Train Loss: 0.616 Vali Loss: 3.087 Vali Acc: 0.240 Test Loss: 3.087 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.717356204986572
Epoch: 14, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.645 Vali Acc: 0.278 Test Loss: 3.645 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.30434513092041
Epoch: 15, Steps: 17 | Train Loss: 0.498 Vali Loss: 3.758 Vali Acc: 0.281 Test Loss: 3.758 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.580373287200928
Epoch: 16, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.498 Vali Acc: 0.304 Test Loss: 3.498 Test Acc: 0.304
Validation loss decreased (-0.288942 --> -0.304148).  Saving model ...
Epoch: 17 cost time: 6.280090570449829
Epoch: 17, Steps: 17 | Train Loss: 0.372 Vali Loss: 3.876 Vali Acc: 0.281 Test Loss: 3.876 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.6560585498809814
Epoch: 18, Steps: 17 | Train Loss: 0.317 Vali Loss: 3.934 Vali Acc: 0.270 Test Loss: 3.934 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.930051565170288
Epoch: 19, Steps: 17 | Train Loss: 0.378 Vali Loss: 4.648 Vali Acc: 0.247 Test Loss: 4.648 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.8387227058410645
Epoch: 20, Steps: 17 | Train Loss: 0.321 Vali Loss: 4.856 Vali Acc: 0.293 Test Loss: 4.856 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.8065714836120605
Epoch: 21, Steps: 17 | Train Loss: 0.221 Vali Loss: 5.099 Vali Acc: 0.285 Test Loss: 5.099 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.474056959152222
Epoch: 22, Steps: 17 | Train Loss: 0.152 Vali Loss: 5.270 Vali Acc: 0.293 Test Loss: 5.270 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.224953651428223
Epoch: 23, Steps: 17 | Train Loss: 0.245 Vali Loss: 5.584 Vali Acc: 0.278 Test Loss: 5.584 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.153508424758911
Epoch: 24, Steps: 17 | Train Loss: 0.206 Vali Loss: 6.265 Vali Acc: 0.262 Test Loss: 6.265 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.03790807723999
Epoch: 25, Steps: 17 | Train Loss: 0.195 Vali Loss: 6.284 Vali Acc: 0.281 Test Loss: 6.284 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.418866395950317
Epoch: 26, Steps: 17 | Train Loss: 0.230 Vali Loss: 6.087 Vali Acc: 0.262 Test Loss: 6.087 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.967343091964722
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 6.411053419113159
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.709 Vali Acc: 0.297 Test Loss: 1.709 Test Acc: 0.297
Validation loss decreased (-0.239528 --> -0.296561).  Saving model ...
Epoch: 3 cost time: 6.201645135879517
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 2.199 Vali Acc: 0.255 Test Loss: 2.199 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.075916051864624
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.736 Vali Acc: 0.236 Test Loss: 1.736 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.571889877319336
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 2.318 Vali Acc: 0.236 Test Loss: 2.318 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.19812536239624
Epoch: 6, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.005 Vali Acc: 0.300 Test Loss: 2.005 Test Acc: 0.300
Validation loss decreased (-0.296561 --> -0.300360).  Saving model ...
Epoch: 7 cost time: 6.419265270233154
Epoch: 7, Steps: 17 | Train Loss: 1.129 Vali Loss: 2.623 Vali Acc: 0.247 Test Loss: 2.623 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.81019139289856
Epoch: 8, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.131 Vali Acc: 0.285 Test Loss: 2.131 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.551008701324463
Epoch: 9, Steps: 17 | Train Loss: 1.002 Vali Loss: 2.635 Vali Acc: 0.224 Test Loss: 2.635 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.306116819381714
Epoch: 10, Steps: 17 | Train Loss: 0.851 Vali Loss: 3.000 Vali Acc: 0.247 Test Loss: 3.000 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.518643856048584
Epoch: 11, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.831 Vali Acc: 0.285 Test Loss: 2.831 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.563830137252808
Epoch: 12, Steps: 17 | Train Loss: 0.729 Vali Loss: 3.134 Vali Acc: 0.266 Test Loss: 3.134 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.853240489959717
Epoch: 13, Steps: 17 | Train Loss: 0.745 Vali Loss: 3.224 Vali Acc: 0.270 Test Loss: 3.224 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.540207624435425
Epoch: 14, Steps: 17 | Train Loss: 0.629 Vali Loss: 4.584 Vali Acc: 0.262 Test Loss: 4.584 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.459482669830322
Epoch: 15, Steps: 17 | Train Loss: 0.611 Vali Loss: 3.812 Vali Acc: 0.255 Test Loss: 3.812 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.4235310554504395
Epoch: 16, Steps: 17 | Train Loss: 0.435 Vali Loss: 3.615 Vali Acc: 0.285 Test Loss: 3.615 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.156897068023682
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 6.4527997970581055
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.671 Vali Acc: 0.259 Test Loss: 1.671 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258538).  Saving model ...
Epoch: 3 cost time: 6.693180799484253
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 2.173 Vali Acc: 0.270 Test Loss: 2.173 Test Acc: 0.270
Validation loss decreased (-0.258538 --> -0.269940).  Saving model ...
Epoch: 4 cost time: 6.959723234176636
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.760 Vali Acc: 0.297 Test Loss: 1.760 Test Acc: 0.297
Validation loss decreased (-0.269940 --> -0.296560).  Saving model ...
Epoch: 5 cost time: 6.728274345397949
Epoch: 5, Steps: 17 | Train Loss: 1.284 Vali Loss: 2.276 Vali Acc: 0.278 Test Loss: 2.276 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.7750084400177
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.816 Vali Acc: 0.289 Test Loss: 1.816 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.187775373458862
Epoch: 7, Steps: 17 | Train Loss: 1.211 Vali Loss: 2.461 Vali Acc: 0.262 Test Loss: 2.461 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.364042043685913
Epoch: 8, Steps: 17 | Train Loss: 1.083 Vali Loss: 2.225 Vali Acc: 0.270 Test Loss: 2.225 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.13086462020874
Epoch: 9, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.756 Vali Acc: 0.274 Test Loss: 2.756 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.207730770111084
Epoch: 10, Steps: 17 | Train Loss: 0.982 Vali Loss: 2.693 Vali Acc: 0.270 Test Loss: 2.693 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.4550392627716064
Epoch: 11, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.941 Vali Acc: 0.259 Test Loss: 2.941 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.210482120513916
Epoch: 12, Steps: 17 | Train Loss: 0.934 Vali Loss: 3.163 Vali Acc: 0.243 Test Loss: 3.163 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.179492712020874
Epoch: 13, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.917 Vali Acc: 0.240 Test Loss: 2.917 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.550980567932129
Epoch: 14, Steps: 17 | Train Loss: 0.981 Vali Loss: 3.570 Vali Acc: 0.243 Test Loss: 3.570 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.216234683990479
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 6.355376243591309
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.700 Vali Acc: 0.262 Test Loss: 1.700 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.550559043884277
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 2.380 Vali Acc: 0.255 Test Loss: 2.380 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.3820860385894775
Epoch: 4, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.850 Vali Acc: 0.251 Test Loss: 1.850 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.232491731643677
Epoch: 5, Steps: 17 | Train Loss: 1.262 Vali Loss: 2.189 Vali Acc: 0.266 Test Loss: 2.189 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.885866165161133
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 2.089 Vali Acc: 0.247 Test Loss: 2.089 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.1209187507629395
Epoch: 7, Steps: 17 | Train Loss: 1.238 Vali Loss: 2.368 Vali Acc: 0.266 Test Loss: 2.368 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.122151136398315
Epoch: 8, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.556 Vali Acc: 0.266 Test Loss: 2.556 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.966367483139038
Epoch: 9, Steps: 17 | Train Loss: 0.990 Vali Loss: 3.132 Vali Acc: 0.278 Test Loss: 3.132 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277535).  Saving model ...
Epoch: 10 cost time: 6.811375141143799
Epoch: 10, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.381 Vali Acc: 0.251 Test Loss: 2.381 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.967486143112183
Epoch: 11, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.914 Vali Acc: 0.259 Test Loss: 2.914 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.145418882369995
Epoch: 12, Steps: 17 | Train Loss: 1.058 Vali Loss: 3.230 Vali Acc: 0.266 Test Loss: 3.230 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.3356382846832275
Epoch: 13, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.626 Vali Acc: 0.289 Test Loss: 2.626 Test Acc: 0.289
Validation loss decreased (-0.277535 --> -0.288947).  Saving model ...
Epoch: 14 cost time: 6.3232362270355225
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 3.912 Vali Acc: 0.274 Test Loss: 3.912 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.972494840621948
Epoch: 15, Steps: 17 | Train Loss: 0.876 Vali Loss: 3.361 Vali Acc: 0.251 Test Loss: 3.361 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.387571573257446
Epoch: 16, Steps: 17 | Train Loss: 0.814 Vali Loss: 3.216 Vali Acc: 0.278 Test Loss: 3.216 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.392644643783569
Epoch: 17, Steps: 17 | Train Loss: 0.767 Vali Loss: 4.155 Vali Acc: 0.262 Test Loss: 4.155 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.984243869781494
Epoch: 18, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.406 Vali Acc: 0.293 Test Loss: 3.406 Test Acc: 0.293
Validation loss decreased (-0.288947 --> -0.292742).  Saving model ...
Epoch: 19 cost time: 6.036720037460327
Epoch: 19, Steps: 17 | Train Loss: 0.619 Vali Loss: 4.732 Vali Acc: 0.266 Test Loss: 4.732 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.337148189544678
Epoch: 20, Steps: 17 | Train Loss: 0.542 Vali Loss: 4.330 Vali Acc: 0.274 Test Loss: 4.330 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.218916893005371
Epoch: 21, Steps: 17 | Train Loss: 0.548 Vali Loss: 4.992 Vali Acc: 0.259 Test Loss: 4.992 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.093772888183594
Epoch: 22, Steps: 17 | Train Loss: 0.584 Vali Loss: 4.936 Vali Acc: 0.243 Test Loss: 4.936 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.484942197799683
Epoch: 23, Steps: 17 | Train Loss: 0.368 Vali Loss: 4.514 Vali Acc: 0.255 Test Loss: 4.514 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.268378496170044
Epoch: 24, Steps: 17 | Train Loss: 0.439 Vali Loss: 4.771 Vali Acc: 0.289 Test Loss: 4.771 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.548022508621216
Epoch: 25, Steps: 17 | Train Loss: 0.467 Vali Loss: 5.897 Vali Acc: 0.259 Test Loss: 5.897 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.992427825927734
Epoch: 26, Steps: 17 | Train Loss: 0.338 Vali Loss: 5.392 Vali Acc: 0.259 Test Loss: 5.392 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.362267971038818
Epoch: 27, Steps: 17 | Train Loss: 0.381 Vali Loss: 6.677 Vali Acc: 0.240 Test Loss: 6.677 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.494360446929932
Epoch: 28, Steps: 17 | Train Loss: 0.353 Vali Loss: 6.938 Vali Acc: 0.217 Test Loss: 6.938 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.343181371688843
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.474 Vali Acc: 0.255 Test Loss: 1.474 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 6.660060882568359
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.712 Vali Acc: 0.255 Test Loss: 1.712 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.150735855102539
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 2.558 Vali Acc: 0.251 Test Loss: 2.558 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.048171281814575
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 2.217 Vali Acc: 0.262 Test Loss: 2.217 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262335).  Saving model ...
Epoch: 5 cost time: 6.727005958557129
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 3.029 Vali Acc: 0.259 Test Loss: 3.029 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.881485939025879
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 2.377 Vali Acc: 0.236 Test Loss: 2.377 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.0726845264434814
Epoch: 7, Steps: 17 | Train Loss: 1.302 Vali Loss: 2.757 Vali Acc: 0.251 Test Loss: 2.757 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.243192911148071
Epoch: 8, Steps: 17 | Train Loss: 1.179 Vali Loss: 2.597 Vali Acc: 0.224 Test Loss: 2.597 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.343426465988159
Epoch: 9, Steps: 17 | Train Loss: 1.139 Vali Loss: 3.561 Vali Acc: 0.247 Test Loss: 3.561 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.727717399597168
Epoch: 10, Steps: 17 | Train Loss: 1.172 Vali Loss: 2.912 Vali Acc: 0.255 Test Loss: 2.912 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.465362310409546
Epoch: 11, Steps: 17 | Train Loss: 1.021 Vali Loss: 3.250 Vali Acc: 0.255 Test Loss: 3.250 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.501524448394775
Epoch: 12, Steps: 17 | Train Loss: 1.064 Vali Loss: 3.360 Vali Acc: 0.224 Test Loss: 3.360 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.125563859939575
Epoch: 13, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.804 Vali Acc: 0.274 Test Loss: 2.804 Test Acc: 0.274
Validation loss decreased (-0.262335 --> -0.273736).  Saving model ...
Epoch: 14 cost time: 7.006129741668701
Epoch: 14, Steps: 17 | Train Loss: 0.973 Vali Loss: 4.238 Vali Acc: 0.251 Test Loss: 4.238 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.839887619018555
Epoch: 15, Steps: 17 | Train Loss: 0.908 Vali Loss: 3.382 Vali Acc: 0.259 Test Loss: 3.382 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.264869928359985
Epoch: 16, Steps: 17 | Train Loss: 0.749 Vali Loss: 3.615 Vali Acc: 0.281 Test Loss: 3.615 Test Acc: 0.281
Validation loss decreased (-0.273736 --> -0.281333).  Saving model ...
Epoch: 17 cost time: 6.8605406284332275
Epoch: 17, Steps: 17 | Train Loss: 0.732 Vali Loss: 3.793 Vali Acc: 0.281 Test Loss: 3.793 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.958895444869995
Epoch: 18, Steps: 17 | Train Loss: 0.685 Vali Loss: 4.726 Vali Acc: 0.259 Test Loss: 4.726 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.9280314445495605
Epoch: 19, Steps: 17 | Train Loss: 0.726 Vali Loss: 5.324 Vali Acc: 0.255 Test Loss: 5.324 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.089936971664429
Epoch: 20, Steps: 17 | Train Loss: 0.691 Vali Loss: 4.380 Vali Acc: 0.281 Test Loss: 4.380 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.3708815574646
Epoch: 21, Steps: 17 | Train Loss: 0.662 Vali Loss: 5.988 Vali Acc: 0.270 Test Loss: 5.988 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.060156583786011
Epoch: 22, Steps: 17 | Train Loss: 0.772 Vali Loss: 6.988 Vali Acc: 0.266 Test Loss: 6.988 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.7272257804870605
Epoch: 23, Steps: 17 | Train Loss: 0.609 Vali Loss: 5.735 Vali Acc: 0.232 Test Loss: 5.735 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.2928221225738525
Epoch: 24, Steps: 17 | Train Loss: 0.548 Vali Loss: 5.422 Vali Acc: 0.278 Test Loss: 5.422 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.674367904663086
Epoch: 25, Steps: 17 | Train Loss: 0.678 Vali Loss: 5.612 Vali Acc: 0.247 Test Loss: 5.612 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.919739007949829
Epoch: 26, Steps: 17 | Train Loss: 0.518 Vali Loss: 7.317 Vali Acc: 0.255 Test Loss: 7.317 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.192473888397217
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.420 Vali Acc: 0.281 Test Loss: 1.420 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 7.1137025356292725
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.548 Vali Acc: 0.274 Test Loss: 1.548 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6162331104278564
Epoch: 3, Steps: 17 | Train Loss: 1.477 Vali Loss: 2.160 Vali Acc: 0.251 Test Loss: 2.160 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.305030345916748
Epoch: 4, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.957 Vali Acc: 0.251 Test Loss: 1.957 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.022134065628052
Epoch: 5, Steps: 17 | Train Loss: 1.456 Vali Loss: 2.582 Vali Acc: 0.240 Test Loss: 2.582 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.825685739517212
Epoch: 6, Steps: 17 | Train Loss: 1.430 Vali Loss: 2.250 Vali Acc: 0.262 Test Loss: 2.250 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.098846673965454
Epoch: 7, Steps: 17 | Train Loss: 1.397 Vali Loss: 2.540 Vali Acc: 0.240 Test Loss: 2.540 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.0493388175964355
Epoch: 8, Steps: 17 | Train Loss: 1.310 Vali Loss: 2.496 Vali Acc: 0.228 Test Loss: 2.496 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.935550928115845
Epoch: 9, Steps: 17 | Train Loss: 1.329 Vali Loss: 2.955 Vali Acc: 0.224 Test Loss: 2.955 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.502483606338501
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 2.524 Vali Acc: 0.262 Test Loss: 2.524 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.834933757781982
Epoch: 11, Steps: 17 | Train Loss: 1.193 Vali Loss: 2.405 Vali Acc: 0.266 Test Loss: 2.405 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 365252
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.14272928237915
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.729 Vali Acc: 0.251 Test Loss: 1.729 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 8.810816287994385
Epoch: 2, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.794 Vali Acc: 0.278 Test Loss: 1.794 Test Acc: 0.278
Validation loss decreased (-0.250933 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 8.447413206100464
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.658 Vali Acc: 0.266 Test Loss: 1.658 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.315774202346802
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.836 Vali Acc: 0.251 Test Loss: 1.836 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.866304636001587
Epoch: 5, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.926 Vali Acc: 0.240 Test Loss: 1.926 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.638272047042847
Epoch: 6, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.834 Vali Acc: 0.278 Test Loss: 1.834 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.292158842086792
Epoch: 7, Steps: 17 | Train Loss: 1.253 Vali Loss: 2.534 Vali Acc: 0.232 Test Loss: 2.534 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.14435887336731
Epoch: 8, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.995 Vali Acc: 0.251 Test Loss: 1.995 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.365591049194336
Epoch: 9, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.031 Vali Acc: 0.255 Test Loss: 2.031 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.714091300964355
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.397 Vali Acc: 0.255 Test Loss: 2.397 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.615931749343872
Epoch: 11, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.732 Vali Acc: 0.270 Test Loss: 2.732 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.08637809753418
Epoch: 12, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.214 Vali Acc: 0.266 Test Loss: 2.214 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.273729085922241
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.719 Vali Acc: 0.251 Test Loss: 1.719 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 7.621598720550537
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.801 Vali Acc: 0.270 Test Loss: 1.801 Test Acc: 0.270
Validation loss decreased (-0.250933 --> -0.269944).  Saving model ...
Epoch: 3 cost time: 7.543049335479736
Epoch: 3, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.695 Vali Acc: 0.262 Test Loss: 1.695 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.61203145980835
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.719 Vali Acc: 0.270 Test Loss: 1.719 Test Acc: 0.270
Validation loss decreased (-0.269944 --> -0.269945).  Saving model ...
Epoch: 5 cost time: 8.36977505683899
Epoch: 5, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.930 Vali Acc: 0.243 Test Loss: 1.930 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.37091326713562
Epoch: 6, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.786 Vali Acc: 0.221 Test Loss: 1.786 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.28016185760498
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 2.480 Vali Acc: 0.224 Test Loss: 2.480 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.361195802688599
Epoch: 8, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.864 Vali Acc: 0.236 Test Loss: 1.864 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.656208515167236
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.953 Vali Acc: 0.240 Test Loss: 1.953 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.979672908782959
Epoch: 10, Steps: 17 | Train Loss: 0.945 Vali Loss: 2.331 Vali Acc: 0.293 Test Loss: 2.331 Test Acc: 0.293
Validation loss decreased (-0.269945 --> -0.292752).  Saving model ...
Epoch: 11 cost time: 7.351076126098633
Epoch: 11, Steps: 17 | Train Loss: 0.859 Vali Loss: 2.492 Vali Acc: 0.255 Test Loss: 2.492 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.537182569503784
Epoch: 12, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.223 Vali Acc: 0.247 Test Loss: 2.223 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.894697189331055
Epoch: 13, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.490 Vali Acc: 0.262 Test Loss: 2.490 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.413010120391846
Epoch: 14, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.742 Vali Acc: 0.224 Test Loss: 2.742 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.930536985397339
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.017 Vali Acc: 0.270 Test Loss: 3.017 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.8647191524505615
Epoch: 16, Steps: 17 | Train Loss: 0.742 Vali Loss: 3.228 Vali Acc: 0.266 Test Loss: 3.228 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.638366937637329
Epoch: 17, Steps: 17 | Train Loss: 0.707 Vali Loss: 3.530 Vali Acc: 0.232 Test Loss: 3.530 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.848793029785156
Epoch: 18, Steps: 17 | Train Loss: 0.610 Vali Loss: 4.043 Vali Acc: 0.262 Test Loss: 4.043 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.812904119491577
Epoch: 19, Steps: 17 | Train Loss: 0.600 Vali Loss: 3.549 Vali Acc: 0.232 Test Loss: 3.549 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.584655046463013
Epoch: 20, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.612 Vali Acc: 0.228 Test Loss: 3.612 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.151695489883423
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.736 Vali Acc: 0.247 Test Loss: 1.736 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 6.65468430519104
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.795 Vali Acc: 0.232 Test Loss: 1.795 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.849209785461426
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.797 Vali Acc: 0.224 Test Loss: 1.797 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.46271538734436
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.869 Vali Acc: 0.278 Test Loss: 1.869 Test Acc: 0.278
Validation loss decreased (-0.247131 --> -0.277548).  Saving model ...
Epoch: 5 cost time: 6.646865606307983
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.831 Vali Acc: 0.262 Test Loss: 1.831 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.542284250259399
Epoch: 6, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.917 Vali Acc: 0.209 Test Loss: 1.917 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.281616449356079
Epoch: 7, Steps: 17 | Train Loss: 1.084 Vali Loss: 2.598 Vali Acc: 0.232 Test Loss: 2.598 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.77522611618042
Epoch: 8, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.176 Vali Acc: 0.221 Test Loss: 2.176 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.98478364944458
Epoch: 9, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.206 Vali Acc: 0.221 Test Loss: 2.206 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.674829721450806
Epoch: 10, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.476 Vali Acc: 0.213 Test Loss: 2.476 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.61298394203186
Epoch: 11, Steps: 17 | Train Loss: 0.760 Vali Loss: 3.363 Vali Acc: 0.247 Test Loss: 3.363 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.911064624786377
Epoch: 12, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.666 Vali Acc: 0.236 Test Loss: 2.666 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.700417995452881
Epoch: 13, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.975 Vali Acc: 0.243 Test Loss: 2.975 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.581376552581787
Epoch: 14, Steps: 17 | Train Loss: 0.585 Vali Loss: 3.492 Vali Acc: 0.240 Test Loss: 3.492 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.437754154205322
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.798 Vali Acc: 0.232 Test Loss: 1.798 Test Acc: 0.232
Validation loss decreased (inf --> -0.231921).  Saving model ...
Epoch: 2 cost time: 6.824967861175537
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.833 Vali Acc: 0.259 Test Loss: 1.833 Test Acc: 0.259
Validation loss decreased (-0.231921 --> -0.258537).  Saving model ...
Epoch: 3 cost time: 6.861496925354004
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.881 Vali Acc: 0.236 Test Loss: 1.881 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.473108530044556
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 2.066 Vali Acc: 0.243 Test Loss: 2.066 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.737764596939087
Epoch: 5, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.988 Vali Acc: 0.217 Test Loss: 1.988 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.83462381362915
Epoch: 6, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.285 Vali Acc: 0.243 Test Loss: 2.285 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.914304256439209
Epoch: 7, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.966 Vali Acc: 0.259 Test Loss: 2.966 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.790589332580566
Epoch: 8, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.385 Vali Acc: 0.202 Test Loss: 2.385 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.872156858444214
Epoch: 9, Steps: 17 | Train Loss: 0.782 Vali Loss: 3.091 Vali Acc: 0.247 Test Loss: 3.091 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.495833396911621
Epoch: 10, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.776 Vali Acc: 0.270 Test Loss: 2.776 Test Acc: 0.270
Validation loss decreased (-0.258537 --> -0.269934).  Saving model ...
Epoch: 11 cost time: 6.290875196456909
Epoch: 11, Steps: 17 | Train Loss: 0.673 Vali Loss: 4.200 Vali Acc: 0.247 Test Loss: 4.200 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.61493444442749
Epoch: 12, Steps: 17 | Train Loss: 0.751 Vali Loss: 3.014 Vali Acc: 0.259 Test Loss: 3.014 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.660191059112549
Epoch: 13, Steps: 17 | Train Loss: 0.554 Vali Loss: 4.170 Vali Acc: 0.243 Test Loss: 4.170 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.8340795040130615
Epoch: 14, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.738 Vali Acc: 0.236 Test Loss: 3.738 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.526432275772095
Epoch: 15, Steps: 17 | Train Loss: 0.497 Vali Loss: 4.075 Vali Acc: 0.247 Test Loss: 4.075 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.4812912940979
Epoch: 16, Steps: 17 | Train Loss: 0.434 Vali Loss: 4.649 Vali Acc: 0.224 Test Loss: 4.649 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.719884634017944
Epoch: 17, Steps: 17 | Train Loss: 0.408 Vali Loss: 4.270 Vali Acc: 0.274 Test Loss: 4.270 Test Acc: 0.274
Validation loss decreased (-0.269934 --> -0.273722).  Saving model ...
Epoch: 18 cost time: 6.365885972976685
Epoch: 18, Steps: 17 | Train Loss: 0.473 Vali Loss: 4.787 Vali Acc: 0.281 Test Loss: 4.787 Test Acc: 0.281
Validation loss decreased (-0.273722 --> -0.281321).  Saving model ...
Epoch: 19 cost time: 6.575592994689941
Epoch: 19, Steps: 17 | Train Loss: 0.302 Vali Loss: 5.192 Vali Acc: 0.251 Test Loss: 5.192 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.434823036193848
Epoch: 20, Steps: 17 | Train Loss: 0.356 Vali Loss: 5.210 Vali Acc: 0.255 Test Loss: 5.210 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.127195358276367
Epoch: 21, Steps: 17 | Train Loss: 0.297 Vali Loss: 4.485 Vali Acc: 0.266 Test Loss: 4.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.630402565002441
Epoch: 22, Steps: 17 | Train Loss: 0.204 Vali Loss: 5.428 Vali Acc: 0.266 Test Loss: 5.428 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.3047709465026855
Epoch: 23, Steps: 17 | Train Loss: 0.265 Vali Loss: 5.091 Vali Acc: 0.262 Test Loss: 5.091 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.093330144882202
Epoch: 24, Steps: 17 | Train Loss: 0.164 Vali Loss: 6.578 Vali Acc: 0.266 Test Loss: 6.578 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.310352563858032
Epoch: 25, Steps: 17 | Train Loss: 0.176 Vali Loss: 5.794 Vali Acc: 0.281 Test Loss: 5.794 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.419033527374268
Epoch: 26, Steps: 17 | Train Loss: 0.260 Vali Loss: 6.058 Vali Acc: 0.297 Test Loss: 6.058 Test Acc: 0.297
Validation loss decreased (-0.281321 --> -0.296517).  Saving model ...
Epoch: 27 cost time: 6.3502490520477295
Epoch: 27, Steps: 17 | Train Loss: 0.163 Vali Loss: 6.061 Vali Acc: 0.266 Test Loss: 6.061 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.660558462142944
Epoch: 28, Steps: 17 | Train Loss: 0.104 Vali Loss: 6.844 Vali Acc: 0.247 Test Loss: 6.844 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.153130054473877
Epoch: 29, Steps: 17 | Train Loss: 0.154 Vali Loss: 7.214 Vali Acc: 0.281 Test Loss: 7.214 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.671056509017944
Epoch: 30, Steps: 17 | Train Loss: 0.134 Vali Loss: 6.222 Vali Acc: 0.255 Test Loss: 6.222 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.3507630825042725
Epoch: 31, Steps: 17 | Train Loss: 0.136 Vali Loss: 6.616 Vali Acc: 0.243 Test Loss: 6.616 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.840965986251831
Epoch: 32, Steps: 17 | Train Loss: 0.102 Vali Loss: 7.478 Vali Acc: 0.247 Test Loss: 7.478 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 7.273289203643799
Epoch: 33, Steps: 17 | Train Loss: 0.146 Vali Loss: 8.905 Vali Acc: 0.278 Test Loss: 8.905 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.941514015197754
Epoch: 34, Steps: 17 | Train Loss: 0.125 Vali Loss: 6.760 Vali Acc: 0.259 Test Loss: 6.760 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.259661674499512
Epoch: 35, Steps: 17 | Train Loss: 0.099 Vali Loss: 6.906 Vali Acc: 0.240 Test Loss: 6.906 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.175126791000366
Epoch: 36, Steps: 17 | Train Loss: 0.081 Vali Loss: 9.131 Vali Acc: 0.274 Test Loss: 9.131 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.726476430892944
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.642 Vali Acc: 0.259 Test Loss: 1.642 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 6.173458576202393
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.652 Vali Acc: 0.281 Test Loss: 1.652 Test Acc: 0.281
Validation loss decreased (-0.258539 --> -0.281352).  Saving model ...
Epoch: 3 cost time: 5.990520238876343
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.685 Vali Acc: 0.300 Test Loss: 1.685 Test Acc: 0.300
Validation loss decreased (-0.281352 --> -0.300363).  Saving model ...
Epoch: 4 cost time: 6.404315233230591
Epoch: 4, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.053 Vali Acc: 0.221 Test Loss: 2.053 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.387689828872681
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.766 Vali Acc: 0.236 Test Loss: 1.766 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.290451288223267
Epoch: 6, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.974 Vali Acc: 0.281 Test Loss: 1.974 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.440731763839722
Epoch: 7, Steps: 17 | Train Loss: 1.045 Vali Loss: 2.654 Vali Acc: 0.281 Test Loss: 2.654 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.194638013839722
Epoch: 8, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.304 Vali Acc: 0.274 Test Loss: 2.304 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.939982652664185
Epoch: 9, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.178 Vali Acc: 0.251 Test Loss: 2.178 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.276052474975586
Epoch: 10, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.405 Vali Acc: 0.270 Test Loss: 2.405 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.780501365661621
Epoch: 11, Steps: 17 | Train Loss: 0.689 Vali Loss: 3.067 Vali Acc: 0.266 Test Loss: 3.067 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.671450853347778
Epoch: 12, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.805 Vali Acc: 0.285 Test Loss: 2.805 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.729747533798218
Epoch: 13, Steps: 17 | Train Loss: 0.513 Vali Loss: 2.892 Vali Acc: 0.259 Test Loss: 2.892 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.572767496109009
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.754 Vali Acc: 0.251 Test Loss: 1.754 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 6.737385272979736
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.873 Vali Acc: 0.259 Test Loss: 1.873 Test Acc: 0.259
Validation loss decreased (-0.250933 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 6.934344053268433
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.839 Vali Acc: 0.243 Test Loss: 1.839 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.07227349281311
Epoch: 4, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.034 Vali Acc: 0.240 Test Loss: 2.034 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.337379455566406
Epoch: 5, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.841 Vali Acc: 0.255 Test Loss: 1.841 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.745021343231201
Epoch: 6, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.883 Vali Acc: 0.274 Test Loss: 1.883 Test Acc: 0.274
Validation loss decreased (-0.258536 --> -0.273745).  Saving model ...
Epoch: 7 cost time: 6.97132420539856
Epoch: 7, Steps: 17 | Train Loss: 1.157 Vali Loss: 2.739 Vali Acc: 0.293 Test Loss: 2.739 Test Acc: 0.293
Validation loss decreased (-0.273745 --> -0.292748).  Saving model ...
Epoch: 8 cost time: 6.721583604812622
Epoch: 8, Steps: 17 | Train Loss: 0.994 Vali Loss: 2.501 Vali Acc: 0.247 Test Loss: 2.501 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.316505432128906
Epoch: 9, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.422 Vali Acc: 0.259 Test Loss: 2.422 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.196118116378784
Epoch: 10, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.758 Vali Acc: 0.270 Test Loss: 2.758 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.597724199295044
Epoch: 11, Steps: 17 | Train Loss: 0.740 Vali Loss: 2.900 Vali Acc: 0.259 Test Loss: 2.900 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.73789119720459
Epoch: 12, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.711 Vali Acc: 0.243 Test Loss: 2.711 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.162344455718994
Epoch: 13, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.898 Vali Acc: 0.274 Test Loss: 2.898 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.7617104053497314
Epoch: 14, Steps: 17 | Train Loss: 0.567 Vali Loss: 3.582 Vali Acc: 0.259 Test Loss: 3.582 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.147926092147827
Epoch: 15, Steps: 17 | Train Loss: 0.553 Vali Loss: 3.415 Vali Acc: 0.228 Test Loss: 3.415 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.009718418121338
Epoch: 16, Steps: 17 | Train Loss: 0.694 Vali Loss: 4.606 Vali Acc: 0.251 Test Loss: 4.606 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.335892915725708
Epoch: 17, Steps: 17 | Train Loss: 0.532 Vali Loss: 4.102 Vali Acc: 0.243 Test Loss: 4.102 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.667582273483276
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.662 Vali Acc: 0.251 Test Loss: 1.662 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 6.4888081550598145
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.818 Vali Acc: 0.247 Test Loss: 1.818 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.754866361618042
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.827 Vali Acc: 0.266 Test Loss: 1.827 Test Acc: 0.266
Validation loss decreased (-0.250934 --> -0.266141).  Saving model ...
Epoch: 4 cost time: 7.19832181930542
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.907 Vali Acc: 0.270 Test Loss: 1.907 Test Acc: 0.270
Validation loss decreased (-0.266141 --> -0.269943).  Saving model ...
Epoch: 5 cost time: 6.363773345947266
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.723 Vali Acc: 0.251 Test Loss: 1.723 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.577427387237549
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.967 Vali Acc: 0.281 Test Loss: 1.967 Test Acc: 0.281
Validation loss decreased (-0.269943 --> -0.281349).  Saving model ...
Epoch: 7 cost time: 5.94302225112915
Epoch: 7, Steps: 17 | Train Loss: 1.230 Vali Loss: 2.731 Vali Acc: 0.266 Test Loss: 2.731 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.863438606262207
Epoch: 8, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.205 Vali Acc: 0.274 Test Loss: 2.205 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.490176200866699
Epoch: 9, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.481 Vali Acc: 0.243 Test Loss: 2.481 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.867950916290283
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.705 Vali Acc: 0.240 Test Loss: 2.705 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.888914108276367
Epoch: 11, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.946 Vali Acc: 0.259 Test Loss: 2.946 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.020820617675781
Epoch: 12, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.619 Vali Acc: 0.240 Test Loss: 2.619 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.29912543296814
Epoch: 13, Steps: 17 | Train Loss: 0.683 Vali Loss: 2.622 Vali Acc: 0.262 Test Loss: 2.622 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.862892389297485
Epoch: 14, Steps: 17 | Train Loss: 0.719 Vali Loss: 3.482 Vali Acc: 0.266 Test Loss: 3.482 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.916521310806274
Epoch: 15, Steps: 17 | Train Loss: 0.635 Vali Loss: 3.425 Vali Acc: 0.232 Test Loss: 3.425 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.101197004318237
Epoch: 16, Steps: 17 | Train Loss: 0.765 Vali Loss: 4.704 Vali Acc: 0.270 Test Loss: 4.704 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.464940071105957
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.667 Vali Acc: 0.255 Test Loss: 1.667 Test Acc: 0.255
Validation loss decreased (inf --> -0.254736).  Saving model ...
Epoch: 2 cost time: 7.7304651737213135
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.756 Vali Acc: 0.255 Test Loss: 1.756 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.387526988983154
Epoch: 3, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.787 Vali Acc: 0.274 Test Loss: 1.787 Test Acc: 0.274
Validation loss decreased (-0.254736 --> -0.273746).  Saving model ...
Epoch: 4 cost time: 6.318997144699097
Epoch: 4, Steps: 17 | Train Loss: 1.316 Vali Loss: 2.034 Vali Acc: 0.270 Test Loss: 2.034 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.301148414611816
Epoch: 5, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.809 Vali Acc: 0.274 Test Loss: 1.809 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.328133821487427
Epoch: 6, Steps: 17 | Train Loss: 1.211 Vali Loss: 2.221 Vali Acc: 0.251 Test Loss: 2.221 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.3901848793029785
Epoch: 7, Steps: 17 | Train Loss: 1.265 Vali Loss: 3.195 Vali Acc: 0.251 Test Loss: 3.195 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.19962215423584
Epoch: 8, Steps: 17 | Train Loss: 1.172 Vali Loss: 2.170 Vali Acc: 0.285 Test Loss: 2.170 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285149).  Saving model ...
Epoch: 9 cost time: 6.980756759643555
Epoch: 9, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.139 Vali Acc: 0.270 Test Loss: 2.139 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.450809001922607
Epoch: 10, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.505 Vali Acc: 0.240 Test Loss: 2.505 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.625957727432251
Epoch: 11, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.733 Vali Acc: 0.270 Test Loss: 2.733 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.473434925079346
Epoch: 12, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.543 Vali Acc: 0.270 Test Loss: 2.543 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.112295150756836
Epoch: 13, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.688 Vali Acc: 0.304 Test Loss: 2.688 Test Acc: 0.304
Validation loss decreased (-0.285149 --> -0.304156).  Saving model ...
Epoch: 14 cost time: 6.751544237136841
Epoch: 14, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.933 Vali Acc: 0.266 Test Loss: 2.933 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.598560094833374
Epoch: 15, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.869 Vali Acc: 0.266 Test Loss: 2.869 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.679747104644775
Epoch: 16, Steps: 17 | Train Loss: 0.969 Vali Loss: 5.016 Vali Acc: 0.266 Test Loss: 5.016 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.487841844558716
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 3.569 Vali Acc: 0.262 Test Loss: 3.569 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.1330437660217285
Epoch: 18, Steps: 17 | Train Loss: 0.741 Vali Loss: 5.648 Vali Acc: 0.266 Test Loss: 5.648 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.568295478820801
Epoch: 19, Steps: 17 | Train Loss: 0.592 Vali Loss: 3.662 Vali Acc: 0.266 Test Loss: 3.662 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.019623517990112
Epoch: 20, Steps: 17 | Train Loss: 0.641 Vali Loss: 4.676 Vali Acc: 0.262 Test Loss: 4.676 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.795412540435791
Epoch: 21, Steps: 17 | Train Loss: 0.628 Vali Loss: 4.000 Vali Acc: 0.278 Test Loss: 4.000 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.295454263687134
Epoch: 22, Steps: 17 | Train Loss: 0.391 Vali Loss: 4.871 Vali Acc: 0.243 Test Loss: 4.871 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.058209419250488
Epoch: 23, Steps: 17 | Train Loss: 0.462 Vali Loss: 4.834 Vali Acc: 0.270 Test Loss: 4.834 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.60934567451477
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
Validation loss decreased (inf --> -0.243330).  Saving model ...
Epoch: 2 cost time: 7.022729158401489
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.805 Vali Acc: 0.262 Test Loss: 1.805 Test Acc: 0.262
Validation loss decreased (-0.243330 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 7.318321466445923
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 2.029 Vali Acc: 0.255 Test Loss: 2.029 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.979844093322754
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.183 Vali Acc: 0.251 Test Loss: 2.183 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.2571470737457275
Epoch: 5, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.979 Vali Acc: 0.224 Test Loss: 1.979 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.160904407501221
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 2.290 Vali Acc: 0.255 Test Loss: 2.290 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.103339195251465
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.999 Vali Acc: 0.240 Test Loss: 2.999 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.6993725299835205
Epoch: 8, Steps: 17 | Train Loss: 1.268 Vali Loss: 2.476 Vali Acc: 0.221 Test Loss: 2.476 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.795044898986816
Epoch: 9, Steps: 17 | Train Loss: 1.111 Vali Loss: 2.709 Vali Acc: 0.217 Test Loss: 2.709 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.5429017543792725
Epoch: 10, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.647 Vali Acc: 0.251 Test Loss: 2.647 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.325732946395874
Epoch: 11, Steps: 17 | Train Loss: 0.995 Vali Loss: 3.037 Vali Acc: 0.228 Test Loss: 3.037 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.127027988433838
Epoch: 12, Steps: 17 | Train Loss: 0.978 Vali Loss: 3.093 Vali Acc: 0.228 Test Loss: 3.093 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.964355230331421
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.565 Vali Acc: 0.232 Test Loss: 1.565 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 6.762743949890137
Epoch: 2, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.688 Vali Acc: 0.247 Test Loss: 1.688 Test Acc: 0.247
Validation loss decreased (-0.231924 --> -0.247131).  Saving model ...
Epoch: 3 cost time: 6.348606586456299
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.936 Vali Acc: 0.255 Test Loss: 1.936 Test Acc: 0.255
Validation loss decreased (-0.247131 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 6.380056858062744
Epoch: 4, Steps: 17 | Train Loss: 1.400 Vali Loss: 2.115 Vali Acc: 0.251 Test Loss: 2.115 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.107734203338623
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 2.036 Vali Acc: 0.255 Test Loss: 2.036 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.814036130905151
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 2.393 Vali Acc: 0.243 Test Loss: 2.393 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.296748399734497
Epoch: 7, Steps: 17 | Train Loss: 1.473 Vali Loss: 3.023 Vali Acc: 0.236 Test Loss: 3.023 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.8721747398376465
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 2.452 Vali Acc: 0.224 Test Loss: 2.452 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.384610891342163
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.734 Vali Acc: 0.247 Test Loss: 2.734 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.005252122879028
Epoch: 10, Steps: 17 | Train Loss: 1.254 Vali Loss: 2.565 Vali Acc: 0.259 Test Loss: 2.565 Test Acc: 0.259
Validation loss decreased (-0.254733 --> -0.258529).  Saving model ...
Epoch: 11 cost time: 6.4062042236328125
Epoch: 11, Steps: 17 | Train Loss: 1.198 Vali Loss: 3.172 Vali Acc: 0.262 Test Loss: 3.172 Test Acc: 0.262
Validation loss decreased (-0.258529 --> -0.262326).  Saving model ...
Epoch: 12 cost time: 6.276759624481201
Epoch: 12, Steps: 17 | Train Loss: 1.213 Vali Loss: 3.033 Vali Acc: 0.228 Test Loss: 3.033 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.624281406402588
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.725 Vali Acc: 0.274 Test Loss: 2.725 Test Acc: 0.274
Validation loss decreased (-0.262326 --> -0.273737).  Saving model ...
Epoch: 14 cost time: 6.0847814083099365
Epoch: 14, Steps: 17 | Train Loss: 1.152 Vali Loss: 3.344 Vali Acc: 0.266 Test Loss: 3.344 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.98539924621582
Epoch: 15, Steps: 17 | Train Loss: 1.064 Vali Loss: 3.087 Vali Acc: 0.243 Test Loss: 3.087 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.743279218673706
Epoch: 16, Steps: 17 | Train Loss: 1.238 Vali Loss: 4.388 Vali Acc: 0.247 Test Loss: 4.388 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.071245908737183
Epoch: 17, Steps: 17 | Train Loss: 1.193 Vali Loss: 4.138 Vali Acc: 0.266 Test Loss: 4.138 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.600277423858643
Epoch: 18, Steps: 17 | Train Loss: 1.065 Vali Loss: 4.661 Vali Acc: 0.255 Test Loss: 4.661 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.278465032577515
Epoch: 19, Steps: 17 | Train Loss: 0.956 Vali Loss: 3.728 Vali Acc: 0.228 Test Loss: 3.728 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.9444580078125
Epoch: 20, Steps: 17 | Train Loss: 0.863 Vali Loss: 4.355 Vali Acc: 0.259 Test Loss: 4.355 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.2724223136901855
Epoch: 21, Steps: 17 | Train Loss: 0.909 Vali Loss: 4.380 Vali Acc: 0.240 Test Loss: 4.380 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.2816619873046875
Epoch: 22, Steps: 17 | Train Loss: 0.733 Vali Loss: 4.075 Vali Acc: 0.255 Test Loss: 4.075 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.748936414718628
Epoch: 23, Steps: 17 | Train Loss: 0.870 Vali Loss: 4.441 Vali Acc: 0.262 Test Loss: 4.441 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 316100
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         876                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.503060340881348
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.424 Vali Acc: 0.278 Test Loss: 1.424 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 7.221470832824707
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.232835054397583
Epoch: 3, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.776 Vali Acc: 0.281 Test Loss: 1.776 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281351).  Saving model ...
Epoch: 4 cost time: 7.78126335144043
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.611 Vali Acc: 0.251 Test Loss: 1.611 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.02222728729248
Epoch: 5, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.745 Vali Acc: 0.255 Test Loss: 1.745 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.190960168838501
Epoch: 6, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.804 Vali Acc: 0.270 Test Loss: 1.804 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.769231081008911
Epoch: 7, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.764 Vali Acc: 0.278 Test Loss: 1.764 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.475002765655518
Epoch: 8, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.966 Vali Acc: 0.251 Test Loss: 1.966 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.266166925430298
Epoch: 9, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.610 Vali Acc: 0.270 Test Loss: 2.610 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.393514633178711
Epoch: 10, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.497 Vali Acc: 0.236 Test Loss: 2.497 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.877260684967041
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 2.053 Vali Acc: 0.266 Test Loss: 2.053 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.8425092697143555
Epoch: 12, Steps: 17 | Train Loss: 0.852 Vali Loss: 2.743 Vali Acc: 0.300 Test Loss: 2.743 Test Acc: 0.300
Validation loss decreased (-0.281351 --> -0.300353).  Saving model ...
Epoch: 13 cost time: 8.112165689468384
Epoch: 13, Steps: 17 | Train Loss: 0.898 Vali Loss: 3.262 Vali Acc: 0.270 Test Loss: 3.262 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.955918073654175
Epoch: 14, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.473 Vali Acc: 0.293 Test Loss: 2.473 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.649456262588501
Epoch: 15, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.604 Vali Acc: 0.259 Test Loss: 2.604 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.448945045471191
Epoch: 16, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.986 Vali Acc: 0.278 Test Loss: 2.986 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.1207520961761475
Epoch: 17, Steps: 17 | Train Loss: 0.725 Vali Loss: 3.250 Vali Acc: 0.278 Test Loss: 3.250 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.583086967468262
Epoch: 18, Steps: 17 | Train Loss: 0.592 Vali Loss: 3.209 Vali Acc: 0.262 Test Loss: 3.209 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.9030725955963135
Epoch: 19, Steps: 17 | Train Loss: 0.613 Vali Loss: 3.034 Vali Acc: 0.262 Test Loss: 3.034 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.06716775894165
Epoch: 20, Steps: 17 | Train Loss: 0.541 Vali Loss: 3.214 Vali Acc: 0.270 Test Loss: 3.214 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.608778715133667
Epoch: 21, Steps: 17 | Train Loss: 0.647 Vali Loss: 3.255 Vali Acc: 0.266 Test Loss: 3.255 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.710852146148682
Epoch: 22, Steps: 17 | Train Loss: 0.691 Vali Loss: 4.007 Vali Acc: 0.266 Test Loss: 4.007 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         701                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma701_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.748887300491333
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.413 Vali Acc: 0.293 Test Loss: 1.413 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 7.577577114105225
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.675 Vali Acc: 0.266 Test Loss: 1.675 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.416704416275024
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.752 Vali Acc: 0.274 Test Loss: 1.752 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.071783542633057
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.593 Vali Acc: 0.251 Test Loss: 1.593 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.321289539337158
Epoch: 5, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.695 Vali Acc: 0.232 Test Loss: 1.695 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.959862947463989
Epoch: 6, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.941 Vali Acc: 0.247 Test Loss: 1.941 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.120460510253906
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.773 Vali Acc: 0.259 Test Loss: 1.773 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.892469167709351
Epoch: 8, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.090842962265015
Epoch: 9, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.323 Vali Acc: 0.255 Test Loss: 2.323 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.982820749282837
Epoch: 10, Steps: 17 | Train Loss: 0.982 Vali Loss: 2.367 Vali Acc: 0.243 Test Loss: 2.367 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.967016935348511
Epoch: 11, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.091 Vali Acc: 0.251 Test Loss: 2.091 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma701_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         526                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma526_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.953621864318848
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.471 Vali Acc: 0.236 Test Loss: 1.471 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 6.755280494689941
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.688 Vali Acc: 0.236 Test Loss: 1.688 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.912485122680664
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.901 Vali Acc: 0.255 Test Loss: 1.901 Test Acc: 0.255
Validation loss decreased (-0.235727 --> -0.254734).  Saving model ...
Epoch: 4 cost time: 7.001197576522827
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.779 Vali Acc: 0.232 Test Loss: 1.779 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.694211721420288
Epoch: 5, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.891 Vali Acc: 0.240 Test Loss: 1.891 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.284314155578613
Epoch: 6, Steps: 17 | Train Loss: 1.093 Vali Loss: 2.124 Vali Acc: 0.213 Test Loss: 2.124 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.012988567352295
Epoch: 7, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.047 Vali Acc: 0.221 Test Loss: 2.047 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.746729135513306
Epoch: 8, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.081 Vali Acc: 0.251 Test Loss: 2.081 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.890644073486328
Epoch: 9, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.495 Vali Acc: 0.228 Test Loss: 2.495 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.949024677276611
Epoch: 10, Steps: 17 | Train Loss: 0.766 Vali Loss: 2.424 Vali Acc: 0.209 Test Loss: 2.424 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.2354724407196045
Epoch: 11, Steps: 17 | Train Loss: 0.859 Vali Loss: 2.641 Vali Acc: 0.251 Test Loss: 2.641 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.359348773956299
Epoch: 12, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.795 Vali Acc: 0.247 Test Loss: 2.795 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.410660028457642
Epoch: 13, Steps: 17 | Train Loss: 0.706 Vali Loss: 4.821 Vali Acc: 0.259 Test Loss: 4.821 Test Acc: 0.259
Validation loss decreased (-0.254734 --> -0.258507).  Saving model ...
Epoch: 14 cost time: 5.968196153640747
Epoch: 14, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.812 Vali Acc: 0.255 Test Loss: 2.812 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.170122385025024
Epoch: 15, Steps: 17 | Train Loss: 0.828 Vali Loss: 3.274 Vali Acc: 0.247 Test Loss: 3.274 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.019218683242798
Epoch: 16, Steps: 17 | Train Loss: 0.516 Vali Loss: 3.349 Vali Acc: 0.243 Test Loss: 3.349 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.1407434940338135
Epoch: 17, Steps: 17 | Train Loss: 0.630 Vali Loss: 5.572 Vali Acc: 0.247 Test Loss: 5.572 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.913227319717407
Epoch: 18, Steps: 17 | Train Loss: 0.798 Vali Loss: 3.802 Vali Acc: 0.209 Test Loss: 3.802 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.700597763061523
Epoch: 19, Steps: 17 | Train Loss: 0.443 Vali Loss: 4.118 Vali Acc: 0.243 Test Loss: 4.118 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.182871341705322
Epoch: 20, Steps: 17 | Train Loss: 0.402 Vali Loss: 4.687 Vali Acc: 0.213 Test Loss: 4.687 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.68681001663208
Epoch: 21, Steps: 17 | Train Loss: 0.500 Vali Loss: 4.544 Vali Acc: 0.228 Test Loss: 4.544 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.911728143692017
Epoch: 22, Steps: 17 | Train Loss: 0.429 Vali Loss: 5.855 Vali Acc: 0.236 Test Loss: 5.855 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.46549129486084
Epoch: 23, Steps: 17 | Train Loss: 0.904 Vali Loss: 5.452 Vali Acc: 0.224 Test Loss: 5.452 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma526_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         351                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.869627952575684
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 7.0618414878845215
Epoch: 2, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.779 Vali Acc: 0.251 Test Loss: 1.779 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250933).  Saving model ...
Epoch: 3 cost time: 6.622293472290039
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.715174198150635
Epoch: 4, Steps: 17 | Train Loss: 1.222 Vali Loss: 2.144 Vali Acc: 0.259 Test Loss: 2.144 Test Acc: 0.259
Validation loss decreased (-0.250933 --> -0.258534).  Saving model ...
Epoch: 5 cost time: 6.299747705459595
Epoch: 5, Steps: 17 | Train Loss: 1.163 Vali Loss: 2.117 Vali Acc: 0.255 Test Loss: 2.117 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.351715326309204
Epoch: 6, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.223 Vali Acc: 0.251 Test Loss: 2.223 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.3499391078948975
Epoch: 7, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.512 Vali Acc: 0.236 Test Loss: 2.512 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.308481216430664
Epoch: 8, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.439 Vali Acc: 0.240 Test Loss: 2.439 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.089317321777344
Epoch: 9, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.890 Vali Acc: 0.266 Test Loss: 2.890 Test Acc: 0.266
Validation loss decreased (-0.258534 --> -0.266131).  Saving model ...
Epoch: 10 cost time: 6.2267467975616455
Epoch: 10, Steps: 17 | Train Loss: 0.761 Vali Loss: 2.797 Vali Acc: 0.251 Test Loss: 2.797 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.325663328170776
Epoch: 11, Steps: 17 | Train Loss: 0.812 Vali Loss: 3.386 Vali Acc: 0.243 Test Loss: 3.386 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.709696054458618
Epoch: 12, Steps: 17 | Train Loss: 0.742 Vali Loss: 3.066 Vali Acc: 0.243 Test Loss: 3.066 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.920079708099365
Epoch: 13, Steps: 17 | Train Loss: 0.627 Vali Loss: 4.884 Vali Acc: 0.262 Test Loss: 4.884 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.811642169952393
Epoch: 14, Steps: 17 | Train Loss: 0.751 Vali Loss: 3.336 Vali Acc: 0.262 Test Loss: 3.336 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.7186119556427
Epoch: 15, Steps: 17 | Train Loss: 0.727 Vali Loss: 3.353 Vali Acc: 0.247 Test Loss: 3.353 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.790040731430054
Epoch: 16, Steps: 17 | Train Loss: 0.455 Vali Loss: 3.803 Vali Acc: 0.259 Test Loss: 3.803 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.5106611251831055
Epoch: 17, Steps: 17 | Train Loss: 0.568 Vali Loss: 5.460 Vali Acc: 0.255 Test Loss: 5.460 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.346719264984131
Epoch: 18, Steps: 17 | Train Loss: 0.529 Vali Loss: 4.228 Vali Acc: 0.255 Test Loss: 4.228 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.177241325378418
Epoch: 19, Steps: 17 | Train Loss: 0.480 Vali Loss: 4.160 Vali Acc: 0.217 Test Loss: 4.160 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         176                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.20079493522644
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.414 Vali Acc: 0.285 Test Loss: 1.414 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 6.069243669509888
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.712 Vali Acc: 0.262 Test Loss: 1.712 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.7637038230896
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.608 Vali Acc: 0.270 Test Loss: 1.608 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.37215781211853
Epoch: 4, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.771 Vali Acc: 0.255 Test Loss: 1.771 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.104199647903442
Epoch: 5, Steps: 17 | Train Loss: 1.143 Vali Loss: 2.024 Vali Acc: 0.251 Test Loss: 2.024 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.350170612335205
Epoch: 6, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.036 Vali Acc: 0.270 Test Loss: 2.036 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.91779351234436
Epoch: 7, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.338 Vali Acc: 0.266 Test Loss: 2.338 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.368610858917236
Epoch: 8, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.178 Vali Acc: 0.274 Test Loss: 2.178 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.11187744140625
Epoch: 9, Steps: 17 | Train Loss: 0.831 Vali Loss: 2.448 Vali Acc: 0.259 Test Loss: 2.448 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.027412414550781
Epoch: 10, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.657 Vali Acc: 0.259 Test Loss: 2.657 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.619932413101196
Epoch: 11, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.814 Vali Acc: 0.274 Test Loss: 2.814 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         88                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.9476542472839355
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.441 Vali Acc: 0.232 Test Loss: 1.441 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 6.05846381187439
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.586 Vali Acc: 0.262 Test Loss: 1.586 Test Acc: 0.262
Validation loss decreased (-0.231925 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 6.76497745513916
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.752 Vali Acc: 0.259 Test Loss: 1.752 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.599829196929932
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 2.065 Vali Acc: 0.255 Test Loss: 2.065 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.459492921829224
Epoch: 5, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.202 Vali Acc: 0.243 Test Loss: 2.202 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.21355676651001
Epoch: 6, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.037 Vali Acc: 0.262 Test Loss: 2.037 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.044493198394775
Epoch: 7, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.230 Vali Acc: 0.247 Test Loss: 2.230 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.398325443267822
Epoch: 8, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.446 Vali Acc: 0.293 Test Loss: 2.446 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292751).  Saving model ...
Epoch: 9 cost time: 6.262319803237915
Epoch: 9, Steps: 17 | Train Loss: 0.939 Vali Loss: 2.449 Vali Acc: 0.247 Test Loss: 2.449 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.348737716674805
Epoch: 10, Steps: 17 | Train Loss: 0.852 Vali Loss: 2.647 Vali Acc: 0.262 Test Loss: 2.647 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.550666809082031
Epoch: 11, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.531 Vali Acc: 0.274 Test Loss: 2.531 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.537614822387695
Epoch: 12, Steps: 17 | Train Loss: 0.817 Vali Loss: 3.063 Vali Acc: 0.274 Test Loss: 3.063 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.473408937454224
Epoch: 13, Steps: 17 | Train Loss: 0.867 Vali Loss: 3.119 Vali Acc: 0.266 Test Loss: 3.119 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.963891983032227
Epoch: 14, Steps: 17 | Train Loss: 0.672 Vali Loss: 3.061 Vali Acc: 0.255 Test Loss: 3.061 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.13503098487854
Epoch: 15, Steps: 17 | Train Loss: 0.700 Vali Loss: 3.312 Vali Acc: 0.281 Test Loss: 3.312 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.100959300994873
Epoch: 16, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.306 Vali Acc: 0.278 Test Loss: 3.306 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.683000087738037
Epoch: 17, Steps: 17 | Train Loss: 0.750 Vali Loss: 3.411 Vali Acc: 0.270 Test Loss: 3.411 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.878019332885742
Epoch: 18, Steps: 17 | Train Loss: 0.520 Vali Loss: 4.240 Vali Acc: 0.240 Test Loss: 4.240 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         53                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.675707817077637
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.458 Vali Acc: 0.202 Test Loss: 1.458 Test Acc: 0.202
Validation loss decreased (inf --> -0.201506).  Saving model ...
Epoch: 2 cost time: 6.155850172042847
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.568 Vali Acc: 0.274 Test Loss: 1.568 Test Acc: 0.274
Validation loss decreased (-0.201506 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 7.057573556900024
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.740 Vali Acc: 0.289 Test Loss: 1.740 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 6.685824394226074
Epoch: 4, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.069 Vali Acc: 0.274 Test Loss: 2.069 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.735508918762207
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 2.124 Vali Acc: 0.262 Test Loss: 2.124 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.518190383911133
Epoch: 6, Steps: 17 | Train Loss: 1.189 Vali Loss: 2.262 Vali Acc: 0.281 Test Loss: 2.262 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.646198749542236
Epoch: 7, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.363 Vali Acc: 0.278 Test Loss: 2.363 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.032425165176392
Epoch: 8, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.411 Vali Acc: 0.281 Test Loss: 2.411 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.813175916671753
Epoch: 9, Steps: 17 | Train Loss: 1.029 Vali Loss: 2.251 Vali Acc: 0.243 Test Loss: 2.251 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.45829963684082
Epoch: 10, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.950 Vali Acc: 0.281 Test Loss: 2.950 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.308643817901611
Epoch: 11, Steps: 17 | Train Loss: 1.083 Vali Loss: 2.587 Vali Acc: 0.270 Test Loss: 2.587 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.590992450714111
Epoch: 12, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.441 Vali Acc: 0.259 Test Loss: 2.441 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.81953501701355
Epoch: 13, Steps: 17 | Train Loss: 0.894 Vali Loss: 3.100 Vali Acc: 0.281 Test Loss: 3.100 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         36                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.203544616699219
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.507 Vali Acc: 0.221 Test Loss: 1.507 Test Acc: 0.221
Validation loss decreased (inf --> -0.220517).  Saving model ...
Epoch: 2 cost time: 5.707814931869507
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.688 Vali Acc: 0.266 Test Loss: 1.688 Test Acc: 0.266
Validation loss decreased (-0.220517 --> -0.266143).  Saving model ...
Epoch: 3 cost time: 5.443324327468872
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.790 Vali Acc: 0.255 Test Loss: 1.790 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.052783250808716
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.267 Vali Acc: 0.274 Test Loss: 2.267 Test Acc: 0.274
Validation loss decreased (-0.266143 --> -0.273742).  Saving model ...
Epoch: 5 cost time: 5.672197103500366
Epoch: 5, Steps: 17 | Train Loss: 1.237 Vali Loss: 2.094 Vali Acc: 0.243 Test Loss: 2.094 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.987094402313232
Epoch: 6, Steps: 17 | Train Loss: 1.186 Vali Loss: 2.140 Vali Acc: 0.266 Test Loss: 2.140 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.11403489112854
Epoch: 7, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.222 Vali Acc: 0.262 Test Loss: 2.222 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.326611518859863
Epoch: 8, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.518 Vali Acc: 0.274 Test Loss: 2.518 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.902750492095947
Epoch: 9, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.938 Vali Acc: 0.251 Test Loss: 1.938 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.661014080047607
Epoch: 10, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.961 Vali Acc: 0.262 Test Loss: 2.961 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.771508693695068
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 2.454 Vali Acc: 0.266 Test Loss: 2.454 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.89276909828186
Epoch: 12, Steps: 17 | Train Loss: 0.990 Vali Loss: 2.502 Vali Acc: 0.255 Test Loss: 2.502 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.949693441390991
Epoch: 13, Steps: 17 | Train Loss: 1.057 Vali Loss: 3.027 Vali Acc: 0.262 Test Loss: 3.027 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.227035284042358
Epoch: 14, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.774 Vali Acc: 0.255 Test Loss: 2.774 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.0549476146698
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.515 Vali Acc: 0.266 Test Loss: 1.515 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 6.291682243347168
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.717 Vali Acc: 0.274 Test Loss: 1.717 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 6.5764319896698
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.933 Vali Acc: 0.262 Test Loss: 1.933 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.681943893432617
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 2.352 Vali Acc: 0.266 Test Loss: 2.352 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.19541072845459
Epoch: 5, Steps: 17 | Train Loss: 1.302 Vali Loss: 2.386 Vali Acc: 0.251 Test Loss: 2.386 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.9939727783203125
Epoch: 6, Steps: 17 | Train Loss: 1.289 Vali Loss: 2.611 Vali Acc: 0.259 Test Loss: 2.611 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.2504918575286865
Epoch: 7, Steps: 17 | Train Loss: 1.259 Vali Loss: 2.837 Vali Acc: 0.259 Test Loss: 2.837 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.412560939788818
Epoch: 8, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.671 Vali Acc: 0.255 Test Loss: 2.671 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.773159027099609
Epoch: 9, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.396 Vali Acc: 0.247 Test Loss: 2.396 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.756729602813721
Epoch: 10, Steps: 17 | Train Loss: 1.176 Vali Loss: 3.084 Vali Acc: 0.255 Test Loss: 3.084 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.217961311340332
Epoch: 11, Steps: 17 | Train Loss: 1.190 Vali Loss: 2.879 Vali Acc: 0.240 Test Loss: 2.879 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.634514331817627
Epoch: 12, Steps: 17 | Train Loss: 1.125 Vali Loss: 2.516 Vali Acc: 0.247 Test Loss: 2.516 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 291524
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
fourier enhanced block used!
modes=32, index=[16, 61, 62, 111, 130, 187, 201, 215, 237, 260, 353, 358, 381, 449, 476, 478, 494, 508, 564, 569, 617, 633, 643, 653, 688, 695, 725, 726, 736, 814, 851, 869]
fourier enhanced block used!
modes=32, index=[13, 15, 27, 31, 32, 59, 89, 92, 101, 138, 166, 175, 184, 198, 207, 217, 249, 262, 268, 269, 277, 290, 331, 352, 371, 375, 376, 378, 380, 385, 408, 415]
 fourier enhanced cross attention used!
modes_q=32, index_q=[31, 37, 40, 48, 53, 89, 108, 117, 120, 121, 160, 188, 211, 216, 217, 229, 243, 262, 271, 286, 293, 309, 316, 330, 348, 369, 371, 397, 406, 408, 418, 426]
modes_kv=32, index_kv=[22, 26, 27, 32, 35, 60, 160, 178, 197, 213, 214, 258, 300, 341, 362, 408, 441, 442, 460, 508, 514, 521, 579, 593, 625, 628, 649, 694, 723, 788, 828, 845]
>>>>>>>start training : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.866592884063721
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.498 Vali Acc: 0.262 Test Loss: 1.498 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 6.02306604385376
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.527 Vali Acc: 0.240 Test Loss: 1.527 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.6776111125946045
Epoch: 3, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.794 Vali Acc: 0.259 Test Loss: 1.794 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.847398042678833
Epoch: 4, Steps: 17 | Train Loss: 1.472 Vali Loss: 2.238 Vali Acc: 0.262 Test Loss: 2.238 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.929674386978149
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 2.301 Vali Acc: 0.251 Test Loss: 2.301 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.215063571929932
Epoch: 6, Steps: 17 | Train Loss: 1.352 Vali Loss: 2.374 Vali Acc: 0.255 Test Loss: 2.374 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.603276252746582
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.493 Vali Acc: 0.232 Test Loss: 2.493 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.672789812088013
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 2.371 Vali Acc: 0.217 Test Loss: 2.371 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.45420241355896
Epoch: 9, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.266 Vali Acc: 0.224 Test Loss: 2.266 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.2232441902160645
Epoch: 10, Steps: 17 | Train Loss: 1.326 Vali Loss: 3.056 Vali Acc: 0.236 Test Loss: 3.056 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.655333518981934
Epoch: 11, Steps: 17 | Train Loss: 1.400 Vali Loss: 2.608 Vali Acc: 0.209 Test Loss: 2.608 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_FEDformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 291524
model size : 2.36MB
