Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.477410078048706
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.308457612991333
Epoch: 2, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1634113788604736
Epoch: 3, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1588923931121826
Epoch: 4, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2634773254394531
Epoch: 5, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0526936054229736
Epoch: 6, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2854063510894775
Epoch: 7, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1920511722564697
Epoch: 8, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.361 Vali Acc: 0.267 Test Loss: 1.361 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8121070861816406
Epoch: 9, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.585 Vali Acc: 0.333 Test Loss: 1.585 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2532877922058105
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.851 Vali Acc: 0.333 Test Loss: 1.851 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1098864078521729
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.127 Vali Acc: 0.333 Test Loss: 2.127 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.729422092437744
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3298285007476807
Epoch: 2, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3871567249298096
Epoch: 3, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.1100075244903564
Epoch: 4, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.202484369277954
Epoch: 5, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0722010135650635
Epoch: 6, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0693576335906982
Epoch: 7, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1087820529937744
Epoch: 8, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.022796869277954
Epoch: 9, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.527 Vali Acc: 0.400 Test Loss: 1.527 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.111557960510254
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.796 Vali Acc: 0.400 Test Loss: 1.796 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2551231384277344
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.076 Vali Acc: 0.400 Test Loss: 2.076 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3481860160827637
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.360 Vali Acc: 0.400 Test Loss: 2.360 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3730804920196533
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.400 Test Loss: 2.641 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7212066650390625
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.090890884399414
Epoch: 2, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1432952880859375
Epoch: 3, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2733104228973389
Epoch: 4, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1834526062011719
Epoch: 5, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.10667085647583
Epoch: 6, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9890692234039307
Epoch: 7, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0736398696899414
Epoch: 8, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.352 Vali Acc: 0.333 Test Loss: 1.352 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1218500137329102
Epoch: 9, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.537 Vali Acc: 0.400 Test Loss: 1.537 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0730831623077393
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.780 Vali Acc: 0.333 Test Loss: 1.780 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.055037021636963
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.049 Vali Acc: 0.333 Test Loss: 2.049 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1262872219085693
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8326098918914795
Epoch: 2, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9206061363220215
Epoch: 3, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0543427467346191
Epoch: 4, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0666217803955078
Epoch: 5, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0913872718811035
Epoch: 6, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0898339748382568
Epoch: 7, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.10774564743042
Epoch: 8, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9265494346618652
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.409 Vali Acc: 0.333 Test Loss: 1.409 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2427995204925537
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.600 Vali Acc: 0.400 Test Loss: 1.600 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1784863471984863
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.825 Vali Acc: 0.400 Test Loss: 1.825 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.034332036972046
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.400 Test Loss: 2.067 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1281373500823975
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.400 Test Loss: 2.313 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0193676948547363
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.333 Test Loss: 2.557 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9994990825653076
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.796 Vali Acc: 0.333 Test Loss: 2.796 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0870325565338135
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.027 Vali Acc: 0.400 Test Loss: 3.027 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0850932598114014
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.400 Test Loss: 3.248 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2561824321746826
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9682557582855225
Epoch: 2, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.1440410614013672
Epoch: 3, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.10475754737854
Epoch: 4, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9799866676330566
Epoch: 5, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9573593139648438
Epoch: 6, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.322 Vali Acc: 0.133 Test Loss: 1.322 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8911857604980469
Epoch: 7, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.550 Vali Acc: 0.200 Test Loss: 1.550 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8726134300231934
Epoch: 8, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.821 Vali Acc: 0.200 Test Loss: 1.821 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0298712253570557
Epoch: 9, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.153 Vali Acc: 0.267 Test Loss: 2.153 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9671170711517334
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.497 Vali Acc: 0.200 Test Loss: 2.497 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0297608375549316
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.847 Vali Acc: 0.200 Test Loss: 2.847 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.097449541091919
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.196 Vali Acc: 0.200 Test Loss: 3.196 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5217161178588867
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.0738887786865234
Epoch: 2, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.741722583770752
Epoch: 3, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.809283971786499
Epoch: 4, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6914124488830566
Epoch: 5, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7428188323974609
Epoch: 6, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6999986171722412
Epoch: 7, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.340 Vali Acc: 0.133 Test Loss: 1.340 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8401286602020264
Epoch: 8, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.448 Vali Acc: 0.200 Test Loss: 1.448 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7603423595428467
Epoch: 9, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.625 Vali Acc: 0.200 Test Loss: 1.625 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9673717021942139
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.845 Vali Acc: 0.200 Test Loss: 1.845 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9479289054870605
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.081 Vali Acc: 0.200 Test Loss: 2.081 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9228541851043701
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.325 Vali Acc: 0.200 Test Loss: 2.325 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5208868980407715
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8910419940948486
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8673622608184814
Epoch: 3, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9022994041442871
Epoch: 4, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9207589626312256
Epoch: 5, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9357173442840576
Epoch: 6, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9846010208129883
Epoch: 7, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0737102031707764
Epoch: 8, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.034416913986206
Epoch: 9, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.241 Vali Acc: 0.533 Test Loss: 1.241 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 10 cost time: 0.9228150844573975
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.314 Vali Acc: 0.667 Test Loss: 1.314 Test Acc: 0.667
Validation loss decreased (-0.533321 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.7647876739501953
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.600 Test Loss: 1.403 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8908178806304932
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.600 Test Loss: 1.503 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6947576999664307
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.600 Test Loss: 1.609 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9155511856079102
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.600 Test Loss: 1.718 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8999385833740234
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.600 Test Loss: 1.828 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8104956150054932
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.600 Test Loss: 1.936 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9015467166900635
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.043 Vali Acc: 0.600 Test Loss: 2.043 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.747948169708252
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.600 Test Loss: 2.146 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0391454696655273
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.245 Vali Acc: 0.600 Test Loss: 2.245 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0273842811584473
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.600 Test Loss: 2.340 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3585731983184814
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9311635494232178
Epoch: 2, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8737270832061768
Epoch: 3, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.9083430767059326
Epoch: 4, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9492177963256836
Epoch: 5, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0265822410583496
Epoch: 6, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9510188102722168
Epoch: 7, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8792681694030762
Epoch: 8, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.927905797958374
Epoch: 9, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0372064113616943
Epoch: 10, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.448 Vali Acc: 0.333 Test Loss: 1.448 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7483737468719482
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.581 Vali Acc: 0.333 Test Loss: 1.581 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0068097114562988
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.333 Test Loss: 1.723 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0709187984466553
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.333 Test Loss: 1.871 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8984925746917725
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.333 Test Loss: 2.020 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.518782138824463
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.0999891757965088
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 1.0276455879211426
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.000915765762329
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.090494155883789
Epoch: 5, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8440780639648438
Epoch: 6, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9608678817749023
Epoch: 7, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.9747800827026367
Epoch: 8, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9666638374328613
Epoch: 9, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.267 Vali Acc: 0.467 Test Loss: 1.267 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9540677070617676
Epoch: 10, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.285 Vali Acc: 0.467 Test Loss: 1.285 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9497635364532471
Epoch: 11, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9789073467254639
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.495 Vali Acc: 0.467 Test Loss: 1.495 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.991218090057373
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.642 Vali Acc: 0.533 Test Loss: 1.642 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533317).  Saving model ...
Epoch: 14 cost time: 1.0380859375
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.790 Vali Acc: 0.533 Test Loss: 1.790 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0869171619415283
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.533 Test Loss: 1.938 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0548923015594482
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.087 Vali Acc: 0.533 Test Loss: 2.087 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8931624889373779
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.467 Test Loss: 2.234 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.999068021774292
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.378 Vali Acc: 0.467 Test Loss: 2.378 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9776437282562256
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.518 Vali Acc: 0.467 Test Loss: 2.518 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0008213520050049
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.652 Vali Acc: 0.467 Test Loss: 2.652 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9216277599334717
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.780 Vali Acc: 0.467 Test Loss: 2.780 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8090100288391113
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.903 Vali Acc: 0.400 Test Loss: 2.903 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7933127880096436
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.018 Vali Acc: 0.400 Test Loss: 3.018 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.59849214553833
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.991084098815918
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.9977254867553711
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.999171257019043
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.067798137664795
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.005145788192749
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.246 Vali Acc: 0.200 Test Loss: 1.246 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0248780250549316
Epoch: 7, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9021775722503662
Epoch: 8, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0196380615234375
Epoch: 9, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8952779769897461
Epoch: 10, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.362 Vali Acc: 0.200 Test Loss: 1.362 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0785374641418457
Epoch: 11, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.433 Vali Acc: 0.200 Test Loss: 1.433 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9948339462280273
Epoch: 12, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9841797351837158
Epoch: 13, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.514 Vali Acc: 0.267 Test Loss: 1.514 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 17788419
model size : 87.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.174964189529419
Epoch: 1, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8468434810638428
Epoch: 2, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8200788497924805
Epoch: 3, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4565961360931396
Epoch: 4, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0257434844970703
Epoch: 5, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0780816078186035
Epoch: 6, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1651010513305664
Epoch: 7, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.0337390899658203
Epoch: 8, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0466842651367188
Epoch: 9, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.687 Vali Acc: 0.400 Test Loss: 1.687 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3969731330871582
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.823 Vali Acc: 0.333 Test Loss: 1.823 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3744733333587646
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.971 Vali Acc: 0.333 Test Loss: 1.971 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3825798034667969
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.134 Vali Acc: 0.333 Test Loss: 2.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2697820663452148
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.306 Vali Acc: 0.200 Test Loss: 2.306 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9880969524383545
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.200 Test Loss: 2.481 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1435418128967285
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.655 Vali Acc: 0.200 Test Loss: 2.655 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1685528755187988
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.200 Test Loss: 2.828 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.208998203277588
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.996 Vali Acc: 0.200 Test Loss: 2.996 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.465909481048584
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.092780351638794
Epoch: 2, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9200639724731445
Epoch: 3, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1436612606048584
Epoch: 4, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.289198875427246
Epoch: 5, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1356959342956543
Epoch: 6, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.137394905090332
Epoch: 7, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.086467981338501
Epoch: 8, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.479 Vali Acc: 0.400 Test Loss: 1.479 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1464018821716309
Epoch: 9, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0566685199737549
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.771 Vali Acc: 0.400 Test Loss: 1.771 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.138540506362915
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.931 Vali Acc: 0.333 Test Loss: 1.931 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1616723537445068
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.109 Vali Acc: 0.267 Test Loss: 2.109 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.314385175704956
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.267 Test Loss: 2.297 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0718638896942139
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.267 Test Loss: 2.488 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2890956401824951
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.267 Test Loss: 2.677 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5720601081848145
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1434340476989746
Epoch: 2, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1718835830688477
Epoch: 3, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0244653224945068
Epoch: 4, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9401929378509521
Epoch: 5, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1150836944580078
Epoch: 6, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0780017375946045
Epoch: 7, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.9148855209350586
Epoch: 8, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0696501731872559
Epoch: 9, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.580 Vali Acc: 0.400 Test Loss: 1.580 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1854076385498047
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.744 Vali Acc: 0.400 Test Loss: 1.744 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1064481735229492
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.945 Vali Acc: 0.333 Test Loss: 1.945 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.207003116607666
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.168 Vali Acc: 0.333 Test Loss: 2.168 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.250518798828125
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.333 Test Loss: 2.400 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0224945545196533
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.633 Vali Acc: 0.333 Test Loss: 2.633 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9942734241485596
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.862 Vali Acc: 0.333 Test Loss: 2.862 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0975706577301025
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.084 Vali Acc: 0.333 Test Loss: 3.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2173614501953125
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.298 Vali Acc: 0.333 Test Loss: 3.298 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5523643493652344
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0077440738677979
Epoch: 2, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1303813457489014
Epoch: 3, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.03395676612854
Epoch: 4, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.010929822921753
Epoch: 5, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0520682334899902
Epoch: 6, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.0812227725982666
Epoch: 7, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9555716514587402
Epoch: 8, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0044817924499512
Epoch: 9, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0783987045288086
Epoch: 10, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.610 Vali Acc: 0.467 Test Loss: 1.610 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1296415328979492
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.467 Test Loss: 1.778 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8421761989593506
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.400 Test Loss: 1.960 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.971186637878418
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.400 Test Loss: 2.149 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.949897050857544
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.400 Test Loss: 2.340 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8599903583526611
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.333 Test Loss: 2.528 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0544626712799072
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.712 Vali Acc: 0.333 Test Loss: 2.712 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.037827253341675
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7055776119232178
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.81972336769104
Epoch: 3, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7466874122619629
Epoch: 4, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9959273338317871
Epoch: 5, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.078216552734375
Epoch: 6, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.360 Vali Acc: 0.267 Test Loss: 1.360 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9766514301300049
Epoch: 7, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.548 Vali Acc: 0.267 Test Loss: 1.548 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9213695526123047
Epoch: 8, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.806 Vali Acc: 0.267 Test Loss: 1.806 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8761916160583496
Epoch: 9, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.181 Vali Acc: 0.333 Test Loss: 2.181 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9229104518890381
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.600 Vali Acc: 0.267 Test Loss: 2.600 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9863085746765137
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.025 Vali Acc: 0.267 Test Loss: 3.025 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4287617206573486
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.727452278137207
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9837772846221924
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7572314739227295
Epoch: 4, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9228816032409668
Epoch: 5, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9975399971008301
Epoch: 6, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8775365352630615
Epoch: 7, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8759701251983643
Epoch: 8, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.459 Vali Acc: 0.333 Test Loss: 1.459 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9297754764556885
Epoch: 9, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.695 Vali Acc: 0.267 Test Loss: 1.695 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9408650398254395
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.957 Vali Acc: 0.267 Test Loss: 1.957 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8358948230743408
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.237 Vali Acc: 0.267 Test Loss: 2.237 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.555633783340454
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9022705554962158
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8914375305175781
Epoch: 3, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9350278377532959
Epoch: 4, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.803189754486084
Epoch: 5, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7763969898223877
Epoch: 6, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.9355556964874268
Epoch: 7, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9179449081420898
Epoch: 8, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8461158275604248
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.892357587814331
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.521 Vali Acc: 0.333 Test Loss: 1.521 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9951114654541016
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.333 Test Loss: 1.706 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9468140602111816
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.333 Test Loss: 1.896 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.930671215057373
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.333 Test Loss: 2.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0298423767089844
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.278 Vali Acc: 0.333 Test Loss: 2.278 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8686220645904541
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.333 Test Loss: 2.463 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9157595634460449
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.642 Vali Acc: 0.333 Test Loss: 2.642 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.50260329246521
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9754645824432373
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8850412368774414
Epoch: 3, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9585912227630615
Epoch: 4, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9568877220153809
Epoch: 5, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7923469543457031
Epoch: 6, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9308731555938721
Epoch: 7, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8688528537750244
Epoch: 8, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8157246112823486
Epoch: 9, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8949358463287354
Epoch: 10, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8770849704742432
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.538 Vali Acc: 0.400 Test Loss: 1.538 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8708269596099854
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.687 Vali Acc: 0.400 Test Loss: 1.687 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0510022640228271
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.400 Test Loss: 1.833 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.00020170211792
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.400 Test Loss: 1.978 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8874187469482422
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.400 Test Loss: 2.122 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8970043659210205
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.400 Test Loss: 2.263 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.558432102203369
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9375565052032471
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.044849157333374
Epoch: 3, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.9014379978179932
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8721621036529541
Epoch: 5, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.923382043838501
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9975121021270752
Epoch: 7, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9952006340026855
Epoch: 8, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.8519763946533203
Epoch: 9, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8115565776824951
Epoch: 10, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.310 Vali Acc: 0.467 Test Loss: 1.310 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.924468994140625
Epoch: 11, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.482 Vali Acc: 0.467 Test Loss: 1.482 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8137688636779785
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.646 Vali Acc: 0.467 Test Loss: 1.646 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7820210456848145
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.784 Vali Acc: 0.467 Test Loss: 1.784 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9377729892730713
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.893 Vali Acc: 0.467 Test Loss: 1.893 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8347647190093994
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.997 Vali Acc: 0.467 Test Loss: 1.997 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9031546115875244
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.467 Test Loss: 2.099 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8807611465454102
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.202 Vali Acc: 0.467 Test Loss: 2.202 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.759507417678833
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.467 Test Loss: 2.303 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.391796588897705
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9197945594787598
Epoch: 2, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9737467765808105
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.925955057144165
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9443309307098389
Epoch: 5, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8028879165649414
Epoch: 6, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9548745155334473
Epoch: 7, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9211275577545166
Epoch: 8, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9346439838409424
Epoch: 9, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.685208797454834
Epoch: 10, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.286 Vali Acc: 0.200 Test Loss: 1.286 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7750375270843506
Epoch: 11, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7715315818786621
Epoch: 12, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.410 Vali Acc: 0.200 Test Loss: 1.410 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8354146480560303
Epoch: 13, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.542 Vali Acc: 0.133 Test Loss: 1.542 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7808136940002441
Epoch: 14, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.577 Vali Acc: 0.133 Test Loss: 1.577 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 14642691
model size : 75.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4201669692993164
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.1291725635528564
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2980544567108154
Epoch: 3, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.138291597366333
Epoch: 4, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8575987815856934
Epoch: 5, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.866847038269043
Epoch: 6, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2961595058441162
Epoch: 7, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.279299259185791
Epoch: 8, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.233128547668457
Epoch: 9, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.497 Vali Acc: 0.333 Test Loss: 1.497 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9745528697967529
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.785 Vali Acc: 0.333 Test Loss: 1.785 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1873438358306885
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7587554454803467
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.2217974662780762
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1444041728973389
Epoch: 3, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0907678604125977
Epoch: 4, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.060286045074463
Epoch: 5, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1702752113342285
Epoch: 6, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0758302211761475
Epoch: 7, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.998894453048706
Epoch: 8, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9674990177154541
Epoch: 9, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0980675220489502
Epoch: 10, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.721 Vali Acc: 0.400 Test Loss: 1.721 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1733078956604004
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.037 Vali Acc: 0.400 Test Loss: 2.037 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7048990726470947
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.920982837677002
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.03708815574646
Epoch: 3, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1559360027313232
Epoch: 4, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9905338287353516
Epoch: 5, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.083592176437378
Epoch: 6, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1618108749389648
Epoch: 7, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0866801738739014
Epoch: 8, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0230975151062012
Epoch: 9, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.442 Vali Acc: 0.333 Test Loss: 1.442 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.140324354171753
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.664 Vali Acc: 0.400 Test Loss: 1.664 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0725083351135254
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.938 Vali Acc: 0.400 Test Loss: 1.938 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4673705101013184
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.8011243343353271
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9847652912139893
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.0049798488616943
Epoch: 4, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0151424407958984
Epoch: 5, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9004344940185547
Epoch: 6, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9005606174468994
Epoch: 7, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0551719665527344
Epoch: 8, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9099216461181641
Epoch: 9, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.350 Vali Acc: 0.467 Test Loss: 1.350 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9116766452789307
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.585 Vali Acc: 0.400 Test Loss: 1.585 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9465203285217285
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.843 Vali Acc: 0.400 Test Loss: 1.843 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.877155065536499
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.107 Vali Acc: 0.400 Test Loss: 2.107 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1417860984802246
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.374 Vali Acc: 0.400 Test Loss: 2.374 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.228656768798828
Epoch: 1, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7729485034942627
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7068839073181152
Epoch: 3, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8860530853271484
Epoch: 4, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0289721488952637
Epoch: 5, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7984421253204346
Epoch: 6, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.284 Vali Acc: 0.133 Test Loss: 1.284 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8703103065490723
Epoch: 7, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.468 Vali Acc: 0.133 Test Loss: 1.468 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9332563877105713
Epoch: 8, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.721 Vali Acc: 0.200 Test Loss: 1.721 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9096353054046631
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 2.038 Vali Acc: 0.133 Test Loss: 2.038 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9857501983642578
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.392 Vali Acc: 0.200 Test Loss: 2.392 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0224778652191162
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.761 Vali Acc: 0.200 Test Loss: 2.761 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0736083984375
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8282804489135742
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6494340896606445
Epoch: 3, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8360044956207275
Epoch: 4, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.93320631980896
Epoch: 5, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9177956581115723
Epoch: 6, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9832067489624023
Epoch: 7, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.413 Vali Acc: 0.200 Test Loss: 1.413 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8311192989349365
Epoch: 8, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.565 Vali Acc: 0.267 Test Loss: 1.565 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8751733303070068
Epoch: 9, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.755 Vali Acc: 0.267 Test Loss: 1.755 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8455219268798828
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.969 Vali Acc: 0.267 Test Loss: 1.969 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9024436473846436
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.193 Vali Acc: 0.267 Test Loss: 2.193 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8412115573883057
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.267 Test Loss: 2.419 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8303425312042236
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.645 Vali Acc: 0.267 Test Loss: 2.645 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6722846031188965
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.867 Vali Acc: 0.267 Test Loss: 2.867 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1089043617248535
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6780824661254883
Epoch: 2, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.797044038772583
Epoch: 3, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8080883026123047
Epoch: 4, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.82696533203125
Epoch: 5, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8709080219268799
Epoch: 6, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7890329360961914
Epoch: 7, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.9115350246429443
Epoch: 8, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8802006244659424
Epoch: 9, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7813510894775391
Epoch: 10, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.346 Vali Acc: 0.467 Test Loss: 1.346 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8766040802001953
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599986).  Saving model ...
Epoch: 12 cost time: 0.8408534526824951
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.600 Test Loss: 1.519 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8383946418762207
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.600 Test Loss: 1.616 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8540246486663818
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.600 Test Loss: 1.715 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8984978199005127
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.600 Test Loss: 1.815 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.877758264541626
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.600 Test Loss: 1.914 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8730967044830322
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.600 Test Loss: 2.012 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8644700050354004
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.600 Test Loss: 2.106 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7022922039031982
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.600 Test Loss: 2.197 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8798027038574219
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.600 Test Loss: 2.284 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6136863231658936
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.600 Test Loss: 2.367 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5112972259521484
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7258844375610352
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8298354148864746
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9278256893157959
Epoch: 4, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0122029781341553
Epoch: 5, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9410970211029053
Epoch: 6, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.8958923816680908
Epoch: 7, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9116559028625488
Epoch: 8, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7123968601226807
Epoch: 9, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9914255142211914
Epoch: 10, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.472 Vali Acc: 0.333 Test Loss: 1.472 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8102130889892578
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.669 Vali Acc: 0.400 Test Loss: 1.669 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8326914310455322
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.857 Vali Acc: 0.400 Test Loss: 1.857 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8478524684906006
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.400 Test Loss: 2.041 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9222345352172852
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.400 Test Loss: 2.221 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.758049488067627
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.400 Test Loss: 2.396 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8127303123474121
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.400 Test Loss: 2.565 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.292703866958618
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7987136840820312
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7951056957244873
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.877025842666626
Epoch: 4, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9102895259857178
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9166343212127686
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9314675331115723
Epoch: 7, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8608834743499756
Epoch: 8, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8101668357849121
Epoch: 9, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7427024841308594
Epoch: 10, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7877554893493652
Epoch: 11, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9188845157623291
Epoch: 12, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.507 Vali Acc: 0.400 Test Loss: 1.507 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.924705982208252
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.660 Vali Acc: 0.533 Test Loss: 1.660 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4239251613616943
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7656354904174805
Epoch: 2, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7887518405914307
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7846264839172363
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7994859218597412
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8272287845611572
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8871152400970459
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7725355625152588
Epoch: 8, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8463819026947021
Epoch: 9, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8406870365142822
Epoch: 10, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.314 Vali Acc: 0.133 Test Loss: 1.314 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7985751628875732
Epoch: 11, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.346 Vali Acc: 0.200 Test Loss: 1.346 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.979710578918457
Epoch: 12, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.374 Vali Acc: 0.333 Test Loss: 1.374 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9325563907623291
Epoch: 13, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.415 Vali Acc: 0.467 Test Loss: 1.415 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 14 cost time: 0.8862366676330566
Epoch: 14, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8456361293792725
Epoch: 15, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.547 Vali Acc: 0.467 Test Loss: 1.547 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8311333656311035
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.615 Vali Acc: 0.467 Test Loss: 1.615 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7938120365142822
Epoch: 17, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.702 Vali Acc: 0.267 Test Loss: 1.702 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7450227737426758
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.804 Vali Acc: 0.267 Test Loss: 1.804 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8483476638793945
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.923 Vali Acc: 0.267 Test Loss: 1.923 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8718609809875488
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.063 Vali Acc: 0.267 Test Loss: 2.063 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8983819484710693
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.213 Vali Acc: 0.267 Test Loss: 2.213 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8000268936157227
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.200 Test Loss: 2.366 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8698935508728027
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.514 Vali Acc: 0.200 Test Loss: 2.514 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 13069827
model size : 69.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5740623474121094
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.1830534934997559
Epoch: 2, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2516851425170898
Epoch: 3, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 1.0364813804626465
Epoch: 4, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8491024971008301
Epoch: 5, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8753259181976318
Epoch: 6, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0094711780548096
Epoch: 7, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.952343225479126
Epoch: 8, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7985472679138184
Epoch: 9, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.477 Vali Acc: 0.333 Test Loss: 1.477 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1419353485107422
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.656 Vali Acc: 0.333 Test Loss: 1.656 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2450149059295654
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.847 Vali Acc: 0.333 Test Loss: 1.847 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4285862445831299
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.046 Vali Acc: 0.333 Test Loss: 2.046 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1867709159851074
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.246 Vali Acc: 0.333 Test Loss: 2.246 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.67883563041687
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9166460037231445
Epoch: 2, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2114124298095703
Epoch: 3, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1220531463623047
Epoch: 4, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1341402530670166
Epoch: 5, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.1501550674438477
Epoch: 6, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1071150302886963
Epoch: 7, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.901531457901001
Epoch: 8, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.272 Vali Acc: 0.400 Test Loss: 1.272 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0817303657531738
Epoch: 9, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.435 Vali Acc: 0.333 Test Loss: 1.435 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.20404052734375
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.631 Vali Acc: 0.400 Test Loss: 1.631 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9501035213470459
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.838 Vali Acc: 0.400 Test Loss: 1.838 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.052534818649292
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.051 Vali Acc: 0.400 Test Loss: 2.051 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.851630449295044
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.400 Test Loss: 2.264 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1976425647735596
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.400 Test Loss: 2.474 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2911005020141602
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.400 Test Loss: 2.679 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7436511516571045
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0434002876281738
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.03049635887146
Epoch: 3, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.819861650466919
Epoch: 4, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9308896064758301
Epoch: 5, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9577696323394775
Epoch: 6, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7194943428039551
Epoch: 7, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8894951343536377
Epoch: 8, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9415290355682373
Epoch: 9, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1850152015686035
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.653 Vali Acc: 0.400 Test Loss: 1.653 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0604357719421387
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.400 Test Loss: 1.851 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2534263134002686
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.9459872245788574
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.7484171390533447
Epoch: 3, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7344770431518555
Epoch: 4, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9847731590270996
Epoch: 5, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9566771984100342
Epoch: 6, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8441925048828125
Epoch: 7, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8244154453277588
Epoch: 8, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7828619480133057
Epoch: 9, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8819265365600586
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0223653316497803
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.467 Test Loss: 1.595 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8832302093505859
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.467 Test Loss: 1.757 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9931144714355469
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.467 Test Loss: 1.924 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8230373859405518
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.467 Test Loss: 2.091 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.161588430404663
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7670505046844482
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9327554702758789
Epoch: 3, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8914370536804199
Epoch: 4, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9269170761108398
Epoch: 5, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7386293411254883
Epoch: 6, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9138851165771484
Epoch: 7, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.458 Vali Acc: 0.133 Test Loss: 1.458 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7339487075805664
Epoch: 8, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.717 Vali Acc: 0.133 Test Loss: 1.717 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0482144355773926
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 2.035 Vali Acc: 0.133 Test Loss: 2.035 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9127731323242188
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.377 Vali Acc: 0.133 Test Loss: 2.377 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0310912132263184
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.728 Vali Acc: 0.133 Test Loss: 2.728 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9904887676239014
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9275753498077393
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8301661014556885
Epoch: 3, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7383778095245361
Epoch: 4, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6898367404937744
Epoch: 5, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9550766944885254
Epoch: 6, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8857882022857666
Epoch: 7, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.364 Vali Acc: 0.200 Test Loss: 1.364 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8401527404785156
Epoch: 8, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.459 Vali Acc: 0.267 Test Loss: 1.459 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7304291725158691
Epoch: 9, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.612 Vali Acc: 0.267 Test Loss: 1.612 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8985488414764404
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.801 Vali Acc: 0.267 Test Loss: 1.801 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8967289924621582
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.267 Test Loss: 2.005 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9538531303405762
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.214 Vali Acc: 0.267 Test Loss: 2.214 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.250966787338257
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8305888175964355
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7973687648773193
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.711663007736206
Epoch: 4, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6974925994873047
Epoch: 5, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8549652099609375
Epoch: 6, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8579838275909424
Epoch: 7, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8850815296173096
Epoch: 8, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8267350196838379
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.235 Vali Acc: 0.533 Test Loss: 1.235 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533321).  Saving model ...
Epoch: 10 cost time: 0.8225836753845215
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.322 Vali Acc: 0.533 Test Loss: 1.322 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8893952369689941
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.414 Vali Acc: 0.600 Test Loss: 1.414 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599986).  Saving model ...
Epoch: 12 cost time: 0.8947889804840088
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.600 Test Loss: 1.513 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9078443050384521
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.600 Test Loss: 1.616 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7077937126159668
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.600 Test Loss: 1.721 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8407433032989502
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.600 Test Loss: 1.824 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8459658622741699
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.600 Test Loss: 1.926 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9037954807281494
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.600 Test Loss: 2.025 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8388514518737793
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.600 Test Loss: 2.120 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9518547058105469
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.212 Vali Acc: 0.600 Test Loss: 2.212 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9120392799377441
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.299 Vali Acc: 0.600 Test Loss: 2.299 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8160297870635986
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.382 Vali Acc: 0.600 Test Loss: 2.382 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.095369338989258
Epoch: 1, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7747678756713867
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7948319911956787
Epoch: 3, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8794305324554443
Epoch: 4, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7409029006958008
Epoch: 5, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6709368228912354
Epoch: 6, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8037917613983154
Epoch: 7, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8005621433258057
Epoch: 8, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7057855129241943
Epoch: 9, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.311 Vali Acc: 0.467 Test Loss: 1.311 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8374781608581543
Epoch: 10, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7713708877563477
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.445 Vali Acc: 0.333 Test Loss: 1.445 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8873472213745117
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.333 Test Loss: 1.524 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8046786785125732
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.333 Test Loss: 1.618 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.896369218826294
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.333 Test Loss: 1.719 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.706693172454834
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.333 Test Loss: 1.823 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7320585250854492
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.333 Test Loss: 1.926 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2167112827301025
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9312422275543213
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.898308515548706
Epoch: 3, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8887667655944824
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9107162952423096
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9069817066192627
Epoch: 6, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.950385332107544
Epoch: 7, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.9159822463989258
Epoch: 8, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8770687580108643
Epoch: 9, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.244 Vali Acc: 0.533 Test Loss: 1.244 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7810003757476807
Epoch: 10, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8879306316375732
Epoch: 11, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.431 Vali Acc: 0.467 Test Loss: 1.431 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9183504581451416
Epoch: 12, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.475 Vali Acc: 0.467 Test Loss: 1.475 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.813838005065918
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.528 Vali Acc: 0.400 Test Loss: 1.528 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8967058658599854
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.629 Vali Acc: 0.467 Test Loss: 1.629 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9001762866973877
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.533 Test Loss: 1.760 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8602807521820068
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.899 Vali Acc: 0.467 Test Loss: 1.899 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9216196537017822
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.467 Test Loss: 2.033 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2952699661254883
Epoch: 1, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7015864849090576
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7751314640045166
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8054819107055664
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7352719306945801
Epoch: 5, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.718376636505127
Epoch: 6, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6399908065795898
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6363863945007324
Epoch: 8, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6415054798126221
Epoch: 9, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6559057235717773
Epoch: 10, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7480742931365967
Epoch: 11, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.291 Vali Acc: 0.333 Test Loss: 1.291 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12283395
model size : 66.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5961110591888428
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.954077959060669
Epoch: 2, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7612206935882568
Epoch: 3, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.091792106628418
Epoch: 4, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.0074329376220703
Epoch: 5, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9854235649108887
Epoch: 6, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9664008617401123
Epoch: 7, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.349 Vali Acc: 0.200 Test Loss: 1.349 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9916844367980957
Epoch: 8, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 1.0230426788330078
Epoch: 9, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.767 Vali Acc: 0.400 Test Loss: 1.767 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1045808792114258
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.853 Vali Acc: 0.333 Test Loss: 1.853 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2840983867645264
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.001 Vali Acc: 0.200 Test Loss: 2.001 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0737025737762451
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.178 Vali Acc: 0.200 Test Loss: 2.178 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0400984287261963
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.200 Test Loss: 2.371 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2802271842956543
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.569 Vali Acc: 0.200 Test Loss: 2.569 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8528649806976318
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.766 Vali Acc: 0.200 Test Loss: 2.766 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0599615573883057
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.960 Vali Acc: 0.200 Test Loss: 2.960 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2596135139465332
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.149 Vali Acc: 0.200 Test Loss: 3.149 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3138971328735352
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.330 Vali Acc: 0.200 Test Loss: 3.330 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.414445400238037
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9612553119659424
Epoch: 2, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9305450916290283
Epoch: 3, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.067945957183838
Epoch: 4, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0685644149780273
Epoch: 5, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9403877258300781
Epoch: 6, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.028580904006958
Epoch: 7, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9942500591278076
Epoch: 8, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.580 Vali Acc: 0.400 Test Loss: 1.580 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 1.033862829208374
Epoch: 9, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.728 Vali Acc: 0.400 Test Loss: 1.728 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0969209671020508
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.786 Vali Acc: 0.400 Test Loss: 1.786 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0826091766357422
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.267 Test Loss: 1.884 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0426280498504639
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.012 Vali Acc: 0.267 Test Loss: 2.012 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.085256576538086
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.267 Test Loss: 2.157 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9528651237487793
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.267 Test Loss: 2.312 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0383775234222412
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.267 Test Loss: 2.469 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3218045234680176
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.626 Vali Acc: 0.267 Test Loss: 2.626 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1396713256835938
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.780 Vali Acc: 0.267 Test Loss: 2.780 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0016298294067383
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.267 Test Loss: 2.930 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.100700855255127
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7483367919921875
Epoch: 2, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7266244888305664
Epoch: 3, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8345403671264648
Epoch: 4, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8009624481201172
Epoch: 5, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8614184856414795
Epoch: 6, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.199 Vali Acc: 0.133 Test Loss: 1.199 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8412599563598633
Epoch: 7, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9450616836547852
Epoch: 8, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.554 Vali Acc: 0.333 Test Loss: 1.554 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0125470161437988
Epoch: 9, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.710 Vali Acc: 0.333 Test Loss: 1.710 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8892614841461182
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.797 Vali Acc: 0.400 Test Loss: 1.797 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0118622779846191
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.924 Vali Acc: 0.400 Test Loss: 1.924 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.385178804397583
Epoch: 1, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7270441055297852
Epoch: 2, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0149874687194824
Epoch: 3, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9928379058837891
Epoch: 4, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.9955859184265137
Epoch: 5, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.009092092514038
Epoch: 6, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0838406085968018
Epoch: 7, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8984947204589844
Epoch: 8, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7956540584564209
Epoch: 9, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.538 Vali Acc: 0.333 Test Loss: 1.538 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8113405704498291
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.633 Vali Acc: 0.333 Test Loss: 1.633 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9070332050323486
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.333 Test Loss: 1.794 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.91233229637146
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.267 Test Loss: 1.994 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7955310344696045
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.216 Vali Acc: 0.267 Test Loss: 2.216 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8182759284973145
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.446 Vali Acc: 0.267 Test Loss: 2.446 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8057317733764648
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.267 Test Loss: 2.677 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.229139566421509
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8182833194732666
Epoch: 2, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.224 Vali Acc: 0.133 Test Loss: 1.224 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8991341590881348
Epoch: 3, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.8768761157989502
Epoch: 4, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0656993389129639
Epoch: 5, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.277 Vali Acc: 0.200 Test Loss: 1.277 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7438123226165771
Epoch: 6, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8698921203613281
Epoch: 7, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.821540355682373
Epoch: 8, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.923 Vali Acc: 0.267 Test Loss: 1.923 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8866841793060303
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 2.251 Vali Acc: 0.267 Test Loss: 2.251 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9369909763336182
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.578 Vali Acc: 0.267 Test Loss: 2.578 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0611135959625244
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.903 Vali Acc: 0.267 Test Loss: 2.903 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7474861145019531
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.200 Test Loss: 3.225 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8313298225402832
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.542 Vali Acc: 0.200 Test Loss: 3.542 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4538228511810303
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.840848445892334
Epoch: 2, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7717485427856445
Epoch: 3, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8995063304901123
Epoch: 4, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7043404579162598
Epoch: 5, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0011322498321533
Epoch: 6, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8980615139007568
Epoch: 7, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.279 Vali Acc: 0.200 Test Loss: 1.279 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9187982082366943
Epoch: 8, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.558 Vali Acc: 0.267 Test Loss: 1.558 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8939592838287354
Epoch: 9, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.795 Vali Acc: 0.267 Test Loss: 1.795 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.788865327835083
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.974 Vali Acc: 0.267 Test Loss: 1.974 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9390730857849121
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.148 Vali Acc: 0.267 Test Loss: 2.148 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2169852256774902
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9020178318023682
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8902158737182617
Epoch: 3, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9790892601013184
Epoch: 4, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7423355579376221
Epoch: 5, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8114967346191406
Epoch: 6, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.7455201148986816
Epoch: 7, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 0.8316233158111572
Epoch: 8, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8379547595977783
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.491 Vali Acc: 0.267 Test Loss: 1.491 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8603549003601074
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.680 Vali Acc: 0.267 Test Loss: 1.680 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7082128524780273
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.267 Test Loss: 1.859 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7231042385101318
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.032 Vali Acc: 0.333 Test Loss: 2.032 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8033626079559326
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.400 Test Loss: 2.204 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7369098663330078
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.374 Vali Acc: 0.400 Test Loss: 2.374 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8795506954193115
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.400 Test Loss: 2.540 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7370483875274658
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.333 Test Loss: 2.702 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7305347919464111
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.333 Test Loss: 2.858 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3891751766204834
Epoch: 1, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7791283130645752
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8370320796966553
Epoch: 3, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.688748836517334
Epoch: 4, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7378966808319092
Epoch: 5, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8834042549133301
Epoch: 6, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9877736568450928
Epoch: 7, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7312188148498535
Epoch: 8, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8127102851867676
Epoch: 9, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6730945110321045
Epoch: 10, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.446 Vali Acc: 0.400 Test Loss: 1.446 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.970470666885376
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.567 Vali Acc: 0.400 Test Loss: 1.567 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7947888374328613
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.400 Test Loss: 1.693 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.864959716796875
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.400 Test Loss: 1.823 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7486860752105713
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.400 Test Loss: 1.956 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8519186973571777
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.400 Test Loss: 2.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6742823123931885
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.400 Test Loss: 2.223 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3227765560150146
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8825647830963135
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6834781169891357
Epoch: 3, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9018559455871582
Epoch: 4, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9056332111358643
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8589386940002441
Epoch: 6, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8642587661743164
Epoch: 7, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.8879408836364746
Epoch: 8, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8974332809448242
Epoch: 9, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.243 Vali Acc: 0.467 Test Loss: 1.243 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8537571430206299
Epoch: 10, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.326 Vali Acc: 0.533 Test Loss: 1.326 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533320).  Saving model ...
Epoch: 11 cost time: 0.8056917190551758
Epoch: 11, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.464 Vali Acc: 0.533 Test Loss: 1.464 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6700525283813477
Epoch: 12, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.646 Vali Acc: 0.467 Test Loss: 1.646 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6886734962463379
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.791 Vali Acc: 0.533 Test Loss: 1.791 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8137617111206055
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.892 Vali Acc: 0.533 Test Loss: 1.892 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9824702739715576
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.964 Vali Acc: 0.533 Test Loss: 1.964 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8501238822937012
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.467 Test Loss: 2.026 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8021161556243896
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.533 Test Loss: 2.090 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.800391674041748
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.533 Test Loss: 2.158 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.704902172088623
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.533 Test Loss: 2.227 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8418951034545898
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.533 Test Loss: 2.297 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.324113130569458
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.893179178237915
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8576157093048096
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9299187660217285
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9069900512695312
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9892673492431641
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.999121904373169
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7947266101837158
Epoch: 8, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8671975135803223
Epoch: 9, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9376921653747559
Epoch: 10, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9624931812286377
Epoch: 11, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8698866367340088
Epoch: 12, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11890179
model size : 64.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4471435546875
Epoch: 1, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8771295547485352
Epoch: 2, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8909556865692139
Epoch: 3, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6687228679656982
Epoch: 4, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7498922348022461
Epoch: 5, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7088723182678223
Epoch: 6, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8884017467498779
Epoch: 7, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.277 Vali Acc: 0.333 Test Loss: 1.277 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8216300010681152
Epoch: 8, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7259061336517334
Epoch: 9, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.402 Vali Acc: 0.267 Test Loss: 1.402 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.834674596786499
Epoch: 10, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.549 Vali Acc: 0.333 Test Loss: 1.549 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7937815189361572
Epoch: 11, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.694 Vali Acc: 0.333 Test Loss: 1.694 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9599599838256836
Epoch: 1, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.9375371932983398
Epoch: 2, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8863043785095215
Epoch: 3, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8769581317901611
Epoch: 4, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9728779792785645
Epoch: 5, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.8394098281860352
Epoch: 6, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6289525032043457
Epoch: 7, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7722597122192383
Epoch: 8, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7453877925872803
Epoch: 9, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7690563201904297
Epoch: 10, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.483 Vali Acc: 0.400 Test Loss: 1.483 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.6742720603942871
Epoch: 11, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.612 Vali Acc: 0.333 Test Loss: 1.612 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6960732936859131
Epoch: 12, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.731 Vali Acc: 0.267 Test Loss: 1.731 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7510082721710205
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.848 Vali Acc: 0.267 Test Loss: 1.848 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7284667491912842
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.963 Vali Acc: 0.267 Test Loss: 1.963 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8454797267913818
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.074 Vali Acc: 0.267 Test Loss: 2.074 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8330824375152588
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.267 Test Loss: 2.183 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8567936420440674
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.289 Vali Acc: 0.267 Test Loss: 2.289 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6855995655059814
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.267 Test Loss: 2.390 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.935614824295044
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.487 Vali Acc: 0.267 Test Loss: 2.487 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7501857280731201
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.580 Vali Acc: 0.267 Test Loss: 2.580 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9960217475891113
Epoch: 1, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7502720355987549
Epoch: 2, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8121778964996338
Epoch: 3, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.875863790512085
Epoch: 4, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6921157836914062
Epoch: 5, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8278095722198486
Epoch: 6, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7008135318756104
Epoch: 7, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8566281795501709
Epoch: 8, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9926872253417969
Epoch: 9, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.381 Vali Acc: 0.333 Test Loss: 1.381 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8553593158721924
Epoch: 10, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.508 Vali Acc: 0.400 Test Loss: 1.508 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.7796308994293213
Epoch: 11, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.624 Vali Acc: 0.333 Test Loss: 1.624 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7388608455657959
Epoch: 12, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.745 Vali Acc: 0.333 Test Loss: 1.745 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7911787033081055
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.872 Vali Acc: 0.333 Test Loss: 1.872 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7787559032440186
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.999 Vali Acc: 0.333 Test Loss: 1.999 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8061003684997559
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.122 Vali Acc: 0.333 Test Loss: 2.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8140840530395508
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.333 Test Loss: 2.242 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7143831253051758
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.333 Test Loss: 2.358 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8240468502044678
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.333 Test Loss: 2.470 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8022255897521973
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.333 Test Loss: 2.575 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6566948890686035
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.676 Vali Acc: 0.333 Test Loss: 2.676 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.28419828414917
Epoch: 1, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.8109650611877441
Epoch: 2, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7822363376617432
Epoch: 3, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.7318310737609863
Epoch: 4, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6736502647399902
Epoch: 5, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7558944225311279
Epoch: 6, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.8041043281555176
Epoch: 7, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7203404903411865
Epoch: 8, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.8290016651153564
Epoch: 9, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.60434889793396
Epoch: 10, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7569019794464111
Epoch: 11, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.460 Vali Acc: 0.400 Test Loss: 1.460 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6662576198577881
Epoch: 12, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.593 Vali Acc: 0.267 Test Loss: 1.593 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7487730979919434
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.737 Vali Acc: 0.267 Test Loss: 1.737 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7396481037139893
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.882 Vali Acc: 0.267 Test Loss: 1.882 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7335209846496582
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.267 Test Loss: 2.024 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6271004676818848
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.162 Vali Acc: 0.267 Test Loss: 2.162 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.715224027633667
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.295 Vali Acc: 0.267 Test Loss: 2.295 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7225916385650635
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.423 Vali Acc: 0.267 Test Loss: 2.423 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9062907695770264
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7489321231842041
Epoch: 2, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7624280452728271
Epoch: 3, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.279 Vali Acc: 0.200 Test Loss: 1.279 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6726441383361816
Epoch: 4, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7202887535095215
Epoch: 5, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.665231466293335
Epoch: 6, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.367 Vali Acc: 0.133 Test Loss: 1.367 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7224042415618896
Epoch: 7, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.458 Vali Acc: 0.200 Test Loss: 1.458 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7468769550323486
Epoch: 8, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.582 Vali Acc: 0.200 Test Loss: 1.582 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7567780017852783
Epoch: 9, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.742 Vali Acc: 0.200 Test Loss: 1.742 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7582471370697021
Epoch: 10, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.931 Vali Acc: 0.200 Test Loss: 1.931 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7121658325195312
Epoch: 11, Steps: 1 | Train Loss: 0.014 Vali Loss: 2.122 Vali Acc: 0.200 Test Loss: 2.122 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0730233192443848
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6687936782836914
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.592350959777832
Epoch: 3, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5449352264404297
Epoch: 4, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7289354801177979
Epoch: 5, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7069616317749023
Epoch: 6, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7063980102539062
Epoch: 7, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7040562629699707
Epoch: 8, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6969771385192871
Epoch: 9, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.382 Vali Acc: 0.333 Test Loss: 1.382 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7575194835662842
Epoch: 10, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.501 Vali Acc: 0.333 Test Loss: 1.501 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6754271984100342
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.584 Vali Acc: 0.267 Test Loss: 1.584 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7018852233886719
Epoch: 12, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.668 Vali Acc: 0.267 Test Loss: 1.668 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1043078899383545
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6694250106811523
Epoch: 2, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6703932285308838
Epoch: 3, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6849539279937744
Epoch: 4, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7371273040771484
Epoch: 5, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6513943672180176
Epoch: 6, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6054244041442871
Epoch: 7, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.6337311267852783
Epoch: 8, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.6742813587188721
Epoch: 9, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.7072055339813232
Epoch: 10, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.290 Vali Acc: 0.467 Test Loss: 1.290 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6964197158813477
Epoch: 11, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.351 Vali Acc: 0.533 Test Loss: 1.351 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 0.7074470520019531
Epoch: 12, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.408 Vali Acc: 0.533 Test Loss: 1.408 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7846393585205078
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.469 Vali Acc: 0.467 Test Loss: 1.469 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7515099048614502
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.467 Test Loss: 1.533 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7946131229400635
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.467 Test Loss: 1.600 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7412724494934082
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.467 Test Loss: 1.668 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8227665424346924
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.467 Test Loss: 1.736 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6889030933380127
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.467 Test Loss: 1.803 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7483439445495605
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.467 Test Loss: 1.869 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7012004852294922
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.467 Test Loss: 1.933 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.730004072189331
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.467 Test Loss: 1.994 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.159893274307251
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8198533058166504
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.718461275100708
Epoch: 3, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7535371780395508
Epoch: 4, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7650806903839111
Epoch: 5, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6836910247802734
Epoch: 6, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.7667930126190186
Epoch: 7, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6769552230834961
Epoch: 8, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6893134117126465
Epoch: 9, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7097392082214355
Epoch: 10, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6994459629058838
Epoch: 11, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.224 Vali Acc: 0.467 Test Loss: 1.224 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 12 cost time: 0.6938190460205078
Epoch: 12, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.348 Vali Acc: 0.467 Test Loss: 1.348 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7399764060974121
Epoch: 13, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.462 Vali Acc: 0.400 Test Loss: 1.462 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7861521244049072
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.555 Vali Acc: 0.400 Test Loss: 1.555 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7633318901062012
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.640 Vali Acc: 0.400 Test Loss: 1.640 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7409234046936035
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.400 Test Loss: 1.718 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7311041355133057
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.467 Test Loss: 1.794 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7116801738739014
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.467 Test Loss: 1.866 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7229645252227783
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.935 Vali Acc: 0.467 Test Loss: 1.935 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6963684558868408
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.467 Test Loss: 2.001 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8258240222930908
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.467 Test Loss: 2.064 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2165677547454834
Epoch: 1, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6902055740356445
Epoch: 2, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7028326988220215
Epoch: 3, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6628375053405762
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7509355545043945
Epoch: 5, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6702241897583008
Epoch: 6, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7285823822021484
Epoch: 7, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7622640132904053
Epoch: 8, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7829217910766602
Epoch: 9, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7167749404907227
Epoch: 10, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6346759796142578
Epoch: 11, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.692054033279419
Epoch: 12, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.7054905891418457
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6864275932312012
Epoch: 14, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6756024360656738
Epoch: 15, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.433 Vali Acc: 0.600 Test Loss: 1.433 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6310222148895264
Epoch: 16, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.530 Vali Acc: 0.600 Test Loss: 1.530 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6545412540435791
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.614 Vali Acc: 0.600 Test Loss: 1.614 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6747798919677734
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.692 Vali Acc: 0.533 Test Loss: 1.692 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7258963584899902
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.766 Vali Acc: 0.533 Test Loss: 1.766 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7162847518920898
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.467 Test Loss: 1.839 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7378749847412109
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.467 Test Loss: 1.908 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6931595802307129
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.467 Test Loss: 1.973 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1235909461975098
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6450996398925781
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.7657148838043213
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7769098281860352
Epoch: 4, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7110006809234619
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.708012580871582
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7321465015411377
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.614138126373291
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6782417297363281
Epoch: 9, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.642981767654419
Epoch: 10, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7352595329284668
Epoch: 11, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7618472576141357
Epoch: 12, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6272771
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8798778057098389
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7354395389556885
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8359827995300293
Epoch: 3, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.9653410911560059
Epoch: 4, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7744417190551758
Epoch: 5, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.8866055011749268
Epoch: 6, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7604937553405762
Epoch: 7, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.892634391784668
Epoch: 8, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.80368971824646
Epoch: 9, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7928690910339355
Epoch: 10, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.427 Vali Acc: 0.333 Test Loss: 1.427 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7654993534088135
Epoch: 11, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.527 Vali Acc: 0.267 Test Loss: 1.527 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7784898281097412
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.641 Vali Acc: 0.267 Test Loss: 1.641 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.839475154876709
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.750 Vali Acc: 0.267 Test Loss: 1.750 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9149143695831299
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.856 Vali Acc: 0.267 Test Loss: 1.856 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.882460355758667
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.267 Test Loss: 1.960 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2028703689575195
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8178906440734863
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7762670516967773
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7078266143798828
Epoch: 4, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8093960285186768
Epoch: 5, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7318234443664551
Epoch: 6, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8205511569976807
Epoch: 7, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6900146007537842
Epoch: 8, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7632579803466797
Epoch: 9, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9055819511413574
Epoch: 10, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7327709197998047
Epoch: 11, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.464 Vali Acc: 0.333 Test Loss: 1.464 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8348696231842041
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.593 Vali Acc: 0.333 Test Loss: 1.593 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9213182926177979
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7830686569213867
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8428206443786621
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8444859981536865
Epoch: 4, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7824468612670898
Epoch: 5, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8967180252075195
Epoch: 6, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7098953723907471
Epoch: 7, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.856748104095459
Epoch: 8, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.827660083770752
Epoch: 9, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8572061061859131
Epoch: 10, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.363 Vali Acc: 0.333 Test Loss: 1.363 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6968116760253906
Epoch: 11, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.489 Vali Acc: 0.333 Test Loss: 1.489 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7364418506622314
Epoch: 12, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.645 Vali Acc: 0.333 Test Loss: 1.645 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8104367256164551
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.796 Vali Acc: 0.400 Test Loss: 1.796 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0666379928588867
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7975683212280273
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.8131074905395508
Epoch: 3, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7560436725616455
Epoch: 4, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7838950157165527
Epoch: 5, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.8088054656982422
Epoch: 6, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.7081806659698486
Epoch: 7, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.167 Vali Acc: 0.533 Test Loss: 1.167 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6870143413543701
Epoch: 8, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7658414840698242
Epoch: 9, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7075953483581543
Epoch: 10, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8122904300689697
Epoch: 11, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8112034797668457
Epoch: 12, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.527 Vali Acc: 0.400 Test Loss: 1.527 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7691771984100342
Epoch: 13, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.661 Vali Acc: 0.333 Test Loss: 1.661 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7587172985076904
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.333 Test Loss: 1.796 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8471782207489014
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.930 Vali Acc: 0.333 Test Loss: 1.930 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7393372058868408
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.060 Vali Acc: 0.333 Test Loss: 2.060 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1738317012786865
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.698481559753418
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7828292846679688
Epoch: 3, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7871565818786621
Epoch: 4, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7869734764099121
Epoch: 5, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8329381942749023
Epoch: 6, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.235 Vali Acc: 0.133 Test Loss: 1.235 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6879472732543945
Epoch: 7, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.696277379989624
Epoch: 8, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7518539428710938
Epoch: 9, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.556 Vali Acc: 0.200 Test Loss: 1.556 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7199931144714355
Epoch: 10, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.728 Vali Acc: 0.200 Test Loss: 1.728 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7913913726806641
Epoch: 11, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.918 Vali Acc: 0.200 Test Loss: 1.918 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0839855670928955
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6805880069732666
Epoch: 2, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.698096752166748
Epoch: 3, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6872069835662842
Epoch: 4, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5630989074707031
Epoch: 5, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6463406085968018
Epoch: 6, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7011361122131348
Epoch: 7, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6779115200042725
Epoch: 8, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6330184936523438
Epoch: 9, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.370 Vali Acc: 0.267 Test Loss: 1.370 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6280009746551514
Epoch: 10, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.473 Vali Acc: 0.267 Test Loss: 1.473 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6022043228149414
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.585 Vali Acc: 0.267 Test Loss: 1.585 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5616195201873779
Epoch: 12, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.709 Vali Acc: 0.267 Test Loss: 1.709 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.623314619064331
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.837 Vali Acc: 0.267 Test Loss: 1.837 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6312847137451172
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.200 Test Loss: 1.965 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5800127983093262
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.267 Test Loss: 2.092 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8221442699432373
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.7194199562072754
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6848948001861572
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.7027499675750732
Epoch: 4, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.69832444190979
Epoch: 5, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.6662204265594482
Epoch: 6, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.7517552375793457
Epoch: 7, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6829936504364014
Epoch: 8, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.5951745510101318
Epoch: 9, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6324381828308105
Epoch: 10, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7121076583862305
Epoch: 11, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6518416404724121
Epoch: 12, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6572649478912354
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.370 Vali Acc: 0.533 Test Loss: 1.370 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7191133499145508
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.533 Test Loss: 1.436 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7219023704528809
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.533 Test Loss: 1.504 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7457969188690186
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.533 Test Loss: 1.571 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7725644111633301
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.700535774230957
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.533 Test Loss: 1.702 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2568860054016113
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7014975547790527
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7551467418670654
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7251572608947754
Epoch: 4, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6925663948059082
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7853376865386963
Epoch: 6, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7234771251678467
Epoch: 7, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6999349594116211
Epoch: 8, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7996270656585693
Epoch: 9, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7440338134765625
Epoch: 10, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.687706470489502
Epoch: 11, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6618998050689697
Epoch: 12, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.236 Vali Acc: 0.467 Test Loss: 1.236 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7250940799713135
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.341 Vali Acc: 0.467 Test Loss: 1.341 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6611196994781494
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.452 Vali Acc: 0.467 Test Loss: 1.452 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.650799036026001
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.566 Vali Acc: 0.467 Test Loss: 1.566 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6796305179595947
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.400 Test Loss: 1.675 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6740152835845947
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.826366662979126
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6201989650726318
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6260840892791748
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7235066890716553
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.7542247772216797
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7091274261474609
Epoch: 6, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6405949592590332
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6670215129852295
Epoch: 8, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6328916549682617
Epoch: 9, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6600892543792725
Epoch: 10, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5924158096313477
Epoch: 11, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.224 Vali Acc: 0.467 Test Loss: 1.224 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 12 cost time: 0.7079973220825195
Epoch: 12, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.253 Vali Acc: 0.533 Test Loss: 1.253 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 13 cost time: 0.7480127811431885
Epoch: 13, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7524893283843994
Epoch: 14, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.327 Vali Acc: 0.333 Test Loss: 1.327 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.700110673904419
Epoch: 15, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6142027378082275
Epoch: 16, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.453 Vali Acc: 0.467 Test Loss: 1.453 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6128923892974854
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.553 Vali Acc: 0.467 Test Loss: 1.553 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7034087181091309
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.660 Vali Acc: 0.467 Test Loss: 1.660 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.827448844909668
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.758 Vali Acc: 0.467 Test Loss: 1.758 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7680861949920654
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.846 Vali Acc: 0.467 Test Loss: 1.846 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7600440979003906
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.467 Test Loss: 1.928 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7073538303375244
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.006 Vali Acc: 0.467 Test Loss: 2.006 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.940882921218872
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5869896411895752
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6543197631835938
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6204690933227539
Epoch: 4, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8132474422454834
Epoch: 5, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6899945735931396
Epoch: 6, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6835806369781494
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6961081027984619
Epoch: 8, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6803910732269287
Epoch: 9, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7020137310028076
Epoch: 10, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7512772083282471
Epoch: 11, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4699907
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9855620861053467
Epoch: 1, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7625787258148193
Epoch: 2, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7526373863220215
Epoch: 3, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8102297782897949
Epoch: 4, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7505166530609131
Epoch: 5, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6744527816772461
Epoch: 6, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.825981855392456
Epoch: 7, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7669451236724854
Epoch: 8, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8066425323486328
Epoch: 9, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7089736461639404
Epoch: 10, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7032861709594727
Epoch: 11, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.443 Vali Acc: 0.333 Test Loss: 1.443 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.060675859451294
Epoch: 1, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.7874114513397217
Epoch: 2, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7735409736633301
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7387759685516357
Epoch: 4, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7465198040008545
Epoch: 5, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7298529148101807
Epoch: 6, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7111725807189941
Epoch: 7, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.7931277751922607
Epoch: 8, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7657413482666016
Epoch: 9, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8320701122283936
Epoch: 10, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8689272403717041
Epoch: 11, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8465671539306641
Epoch: 12, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.562 Vali Acc: 0.467 Test Loss: 1.562 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9155917167663574
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.718 Vali Acc: 0.400 Test Loss: 1.718 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8364076614379883
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.863 Vali Acc: 0.333 Test Loss: 1.863 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8593826293945312
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.333 Test Loss: 2.002 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8621556758880615
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.134 Vali Acc: 0.333 Test Loss: 2.134 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8291893005371094
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.333 Test Loss: 2.260 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4456801414489746
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.876044750213623
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8253481388092041
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7705004215240479
Epoch: 4, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7673652172088623
Epoch: 5, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7767608165740967
Epoch: 6, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7475779056549072
Epoch: 7, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7694411277770996
Epoch: 8, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7613451480865479
Epoch: 9, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7612025737762451
Epoch: 10, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.769026517868042
Epoch: 11, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8229434490203857
Epoch: 12, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.759739875793457
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.400 Test Loss: 1.687 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7331645488739014
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.816 Vali Acc: 0.400 Test Loss: 1.816 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7538390159606934
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.333 Test Loss: 1.943 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7546889781951904
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.066 Vali Acc: 0.333 Test Loss: 2.066 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8285200595855713
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 0.976 Vali Acc: 0.400 Test Loss: 0.976 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.6713066101074219
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.399990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.7450711727142334
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6677684783935547
Epoch: 4, Steps: 1 | Train Loss: 0.868 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.705284833908081
Epoch: 5, Steps: 1 | Train Loss: 0.722 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7540850639343262
Epoch: 6, Steps: 1 | Train Loss: 0.668 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6987957954406738
Epoch: 7, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7595643997192383
Epoch: 8, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6814508438110352
Epoch: 9, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7693181037902832
Epoch: 10, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7020609378814697
Epoch: 11, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6381807327270508
Epoch: 12, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.203457832336426
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7359161376953125
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7311215400695801
Epoch: 3, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6449942588806152
Epoch: 4, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7060680389404297
Epoch: 5, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6735246181488037
Epoch: 6, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7453038692474365
Epoch: 7, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7782888412475586
Epoch: 8, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8217535018920898
Epoch: 9, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.527 Vali Acc: 0.267 Test Loss: 1.527 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7636170387268066
Epoch: 10, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.700 Vali Acc: 0.267 Test Loss: 1.700 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7234501838684082
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.894 Vali Acc: 0.200 Test Loss: 1.894 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0644378662109375
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6440703868865967
Epoch: 2, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6828665733337402
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6639463901519775
Epoch: 4, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7148733139038086
Epoch: 5, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7184689044952393
Epoch: 6, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7184786796569824
Epoch: 7, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6680908203125
Epoch: 8, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.254 Vali Acc: 0.133 Test Loss: 1.254 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6540896892547607
Epoch: 9, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.359 Vali Acc: 0.133 Test Loss: 1.359 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6424460411071777
Epoch: 10, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.462 Vali Acc: 0.200 Test Loss: 1.462 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6335353851318359
Epoch: 11, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.573 Vali Acc: 0.200 Test Loss: 1.573 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6579217910766602
Epoch: 12, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.267 Test Loss: 1.687 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0760390758514404
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6480007171630859
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6188316345214844
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.68222975730896
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6617376804351807
Epoch: 5, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7809064388275146
Epoch: 6, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.762944221496582
Epoch: 7, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7263247966766357
Epoch: 8, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.7457561492919922
Epoch: 9, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.69022536277771
Epoch: 10, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6867289543151855
Epoch: 11, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7792260646820068
Epoch: 12, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.369 Vali Acc: 0.467 Test Loss: 1.369 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7294952869415283
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.424 Vali Acc: 0.467 Test Loss: 1.424 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.779649019241333
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.483 Vali Acc: 0.467 Test Loss: 1.483 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7327249050140381
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.533 Test Loss: 1.543 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 0.7536671161651611
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.533 Test Loss: 1.604 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7326045036315918
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.533 Test Loss: 1.665 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7093534469604492
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.533 Test Loss: 1.725 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7173261642456055
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.533 Test Loss: 1.784 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6437585353851318
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.533 Test Loss: 1.840 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6497201919555664
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.533 Test Loss: 1.895 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6694188117980957
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.533 Test Loss: 1.947 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7132277488708496
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.533 Test Loss: 1.997 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7044703960418701
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.533 Test Loss: 2.045 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7037484645843506
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.533 Test Loss: 2.089 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8716533184051514
Epoch: 1, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6362454891204834
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6299605369567871
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6994202136993408
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6574909687042236
Epoch: 5, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6802072525024414
Epoch: 6, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7026450634002686
Epoch: 7, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6993050575256348
Epoch: 8, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7509920597076416
Epoch: 9, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7387893199920654
Epoch: 10, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.7029337882995605
Epoch: 11, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6659414768218994
Epoch: 12, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.268 Vali Acc: 0.467 Test Loss: 1.268 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6894307136535645
Epoch: 13, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.635352611541748
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.393 Vali Acc: 0.400 Test Loss: 1.393 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6445624828338623
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.467 Vali Acc: 0.333 Test Loss: 1.467 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.632575273513794
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.544 Vali Acc: 0.333 Test Loss: 1.544 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6490552425384521
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.333 Test Loss: 1.621 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6189835071563721
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.333 Test Loss: 1.699 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6490261554718018
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.333 Test Loss: 1.775 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7206218242645264
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.333 Test Loss: 1.849 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0024778842926025
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7150721549987793
Epoch: 2, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6824483871459961
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.789780855178833
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7381811141967773
Epoch: 5, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7677137851715088
Epoch: 6, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7466311454772949
Epoch: 7, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7224235534667969
Epoch: 8, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7574257850646973
Epoch: 9, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6839349269866943
Epoch: 10, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.190 Vali Acc: 0.533 Test Loss: 1.190 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533321).  Saving model ...
Epoch: 11 cost time: 0.6672191619873047
Epoch: 11, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.245 Vali Acc: 0.533 Test Loss: 1.245 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8115260601043701
Epoch: 12, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7816705703735352
Epoch: 13, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.770256757736206
Epoch: 14, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.432 Vali Acc: 0.400 Test Loss: 1.432 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7412254810333252
Epoch: 15, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.423 Vali Acc: 0.467 Test Loss: 1.423 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7093985080718994
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.455 Vali Acc: 0.467 Test Loss: 1.455 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.711052417755127
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.520 Vali Acc: 0.467 Test Loss: 1.520 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7254965305328369
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.602 Vali Acc: 0.533 Test Loss: 1.602 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7308039665222168
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.467 Test Loss: 1.689 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7341253757476807
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.776 Vali Acc: 0.467 Test Loss: 1.776 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.839505672454834
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6874172687530518
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7512784004211426
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6310858726501465
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7176687717437744
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7395656108856201
Epoch: 6, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6948316097259521
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7007961273193359
Epoch: 8, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6383857727050781
Epoch: 9, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7073559761047363
Epoch: 10, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7450826168060303
Epoch: 11, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3913475
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2537918090820312
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8164699077606201
Epoch: 2, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6893773078918457
Epoch: 3, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7521688938140869
Epoch: 4, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7928423881530762
Epoch: 5, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8121929168701172
Epoch: 6, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7057352066040039
Epoch: 7, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7937836647033691
Epoch: 8, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7334072589874268
Epoch: 9, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7919821739196777
Epoch: 10, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.430 Vali Acc: 0.333 Test Loss: 1.430 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8165268898010254
Epoch: 11, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.519 Vali Acc: 0.333 Test Loss: 1.519 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.217343330383301
Epoch: 1, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6955173015594482
Epoch: 2, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.793196439743042
Epoch: 3, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7730104923248291
Epoch: 4, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7827713489532471
Epoch: 5, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7956020832061768
Epoch: 6, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8141059875488281
Epoch: 7, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7794632911682129
Epoch: 8, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8401353359222412
Epoch: 9, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7741446495056152
Epoch: 10, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.422 Vali Acc: 0.333 Test Loss: 1.422 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7811639308929443
Epoch: 11, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.511 Vali Acc: 0.333 Test Loss: 1.511 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7943673133850098
Epoch: 12, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.593 Vali Acc: 0.333 Test Loss: 1.593 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8655126094818115
Epoch: 13, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.690 Vali Acc: 0.400 Test Loss: 1.690 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8083245754241943
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.792 Vali Acc: 0.333 Test Loss: 1.792 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7196526527404785
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.898 Vali Acc: 0.333 Test Loss: 1.898 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6757192611694336
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.004 Vali Acc: 0.333 Test Loss: 2.004 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1241774559020996
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6983857154846191
Epoch: 2, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6995820999145508
Epoch: 3, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6941919326782227
Epoch: 4, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8004021644592285
Epoch: 5, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7117617130279541
Epoch: 6, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6804358959197998
Epoch: 7, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.7499773502349854
Epoch: 8, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.723508358001709
Epoch: 9, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7479197978973389
Epoch: 10, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.66265869140625
Epoch: 11, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.427 Vali Acc: 0.400 Test Loss: 1.427 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7975044250488281
Epoch: 12, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.514 Vali Acc: 0.400 Test Loss: 1.514 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7113053798675537
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.619 Vali Acc: 0.400 Test Loss: 1.619 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7399799823760986
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.729 Vali Acc: 0.400 Test Loss: 1.729 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7249996662139893
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.400 Test Loss: 1.841 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8004262447357178
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.400 Test Loss: 1.952 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6820774078369141
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.400 Test Loss: 2.061 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2844486236572266
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6718161106109619
Epoch: 2, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6698930263519287
Epoch: 3, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7161962985992432
Epoch: 4, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7609429359436035
Epoch: 5, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7599313259124756
Epoch: 6, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6884782314300537
Epoch: 7, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7477762699127197
Epoch: 8, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6593301296234131
Epoch: 9, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6465272903442383
Epoch: 10, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7134556770324707
Epoch: 11, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2861340045928955
Epoch: 1, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6390211582183838
Epoch: 2, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6652209758758545
Epoch: 3, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.662982702255249
Epoch: 4, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6674463748931885
Epoch: 5, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6575183868408203
Epoch: 6, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.6699428558349609
Epoch: 7, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6297125816345215
Epoch: 8, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.461 Vali Acc: 0.333 Test Loss: 1.461 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6372911930084229
Epoch: 9, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.602 Vali Acc: 0.267 Test Loss: 1.602 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.714651346206665
Epoch: 10, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.800 Vali Acc: 0.267 Test Loss: 1.800 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6527800559997559
Epoch: 11, Steps: 1 | Train Loss: 0.019 Vali Loss: 2.035 Vali Acc: 0.267 Test Loss: 2.035 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7081506252288818
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 2.275 Vali Acc: 0.333 Test Loss: 2.275 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6987714767456055
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.502 Vali Acc: 0.333 Test Loss: 2.502 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6360299587249756
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.716 Vali Acc: 0.333 Test Loss: 2.716 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6809167861938477
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.921 Vali Acc: 0.267 Test Loss: 2.921 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.620690107345581
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.116 Vali Acc: 0.267 Test Loss: 3.116 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9721555709838867
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5751781463623047
Epoch: 2, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.614614725112915
Epoch: 3, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7167408466339111
Epoch: 4, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6619606018066406
Epoch: 5, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6013681888580322
Epoch: 6, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.757685661315918
Epoch: 7, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.296 Vali Acc: 0.200 Test Loss: 1.296 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7326653003692627
Epoch: 8, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7003591060638428
Epoch: 9, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.441 Vali Acc: 0.200 Test Loss: 1.441 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6743941307067871
Epoch: 10, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.597 Vali Acc: 0.200 Test Loss: 1.597 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7236027717590332
Epoch: 11, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.777 Vali Acc: 0.133 Test Loss: 1.777 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.924881935119629
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7517580986022949
Epoch: 2, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7742860317230225
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7114865779876709
Epoch: 4, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7439851760864258
Epoch: 5, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7423858642578125
Epoch: 6, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6804149150848389
Epoch: 7, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7779250144958496
Epoch: 8, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.7675960063934326
Epoch: 9, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7164039611816406
Epoch: 10, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7474265098571777
Epoch: 11, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.319 Vali Acc: 0.333 Test Loss: 1.319 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7456963062286377
Epoch: 12, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7797341346740723
Epoch: 13, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.451 Vali Acc: 0.400 Test Loss: 1.451 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8008866310119629
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.467 Test Loss: 1.520 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.680626392364502
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.467 Test Loss: 1.590 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7813775539398193
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.467 Test Loss: 1.659 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6474945545196533
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.467 Test Loss: 1.728 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7359557151794434
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.467 Test Loss: 1.795 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7496919631958008
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5775899887084961
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6531345844268799
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6317756175994873
Epoch: 4, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6222133636474609
Epoch: 5, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.675898551940918
Epoch: 6, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6502413749694824
Epoch: 7, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6936080455780029
Epoch: 8, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7259876728057861
Epoch: 9, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6656246185302734
Epoch: 10, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.6343436241149902
Epoch: 11, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6023879051208496
Epoch: 12, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7080509662628174
Epoch: 13, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.369 Vali Acc: 0.333 Test Loss: 1.369 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6260459423065186
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.427 Vali Acc: 0.333 Test Loss: 1.427 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6115925312042236
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6216599941253662
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.333 Test Loss: 1.557 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8206884860992432
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.333 Test Loss: 1.624 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7027158737182617
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7654263973236084
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.333 Test Loss: 1.757 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7099099159240723
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.333 Test Loss: 1.822 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0007400512695312
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7219595909118652
Epoch: 2, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6820366382598877
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.744027853012085
Epoch: 4, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6481988430023193
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.682830810546875
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6632041931152344
Epoch: 7, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7478442192077637
Epoch: 8, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6435849666595459
Epoch: 9, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6361696720123291
Epoch: 10, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7105650901794434
Epoch: 11, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6812968254089355
Epoch: 12, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9537756443023682
Epoch: 1, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6166138648986816
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6019580364227295
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6445522308349609
Epoch: 4, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6365182399749756
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6590273380279541
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6375148296356201
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5758767127990723
Epoch: 8, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6485593318939209
Epoch: 9, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6024260520935059
Epoch: 10, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5656664371490479
Epoch: 11, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5831480026245117
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5979630947113037
Epoch: 13, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6901051998138428
Epoch: 14, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3520259
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.264193534851074
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7223467826843262
Epoch: 2, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6941549777984619
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.8329477310180664
Epoch: 4, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.764101505279541
Epoch: 5, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6974318027496338
Epoch: 6, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8757343292236328
Epoch: 7, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.841423511505127
Epoch: 8, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7649896144866943
Epoch: 9, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8235387802124023
Epoch: 10, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.821976900100708
Epoch: 11, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.481 Vali Acc: 0.333 Test Loss: 1.481 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7594943046569824
Epoch: 12, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.551 Vali Acc: 0.333 Test Loss: 1.551 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7833395004272461
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.627 Vali Acc: 0.267 Test Loss: 1.627 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9527506828308105
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6637022495269775
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7432196140289307
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7993040084838867
Epoch: 4, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7669403553009033
Epoch: 5, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7869927883148193
Epoch: 6, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8316693305969238
Epoch: 7, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8691458702087402
Epoch: 8, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.83221435546875
Epoch: 9, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8314023017883301
Epoch: 10, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.425 Vali Acc: 0.333 Test Loss: 1.425 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7648651599884033
Epoch: 11, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.523 Vali Acc: 0.333 Test Loss: 1.523 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.743776798248291
Epoch: 12, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.610 Vali Acc: 0.333 Test Loss: 1.610 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6884236335754395
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.692 Vali Acc: 0.267 Test Loss: 1.692 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.952866554260254
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7584917545318604
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7039363384246826
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7851748466491699
Epoch: 4, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.681541919708252
Epoch: 5, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7410428524017334
Epoch: 6, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8046379089355469
Epoch: 7, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7208693027496338
Epoch: 8, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6282503604888916
Epoch: 9, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6644868850708008
Epoch: 10, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6809177398681641
Epoch: 11, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.467 Vali Acc: 0.400 Test Loss: 1.467 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7368185520172119
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.546 Vali Acc: 0.333 Test Loss: 1.546 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6658976078033447
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.619 Vali Acc: 0.333 Test Loss: 1.619 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9362914562225342
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5984668731689453
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.696772575378418
Epoch: 3, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.625476598739624
Epoch: 4, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.645707368850708
Epoch: 5, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7269885540008545
Epoch: 6, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7393443584442139
Epoch: 7, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6811604499816895
Epoch: 8, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6418304443359375
Epoch: 9, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6596970558166504
Epoch: 10, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7187032699584961
Epoch: 11, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6611731052398682
Epoch: 12, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.671828031539917
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.398 Vali Acc: 0.333 Test Loss: 1.398 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6799600124359131
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6397805213928223
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.267 Test Loss: 1.586 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.685295581817627
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.267 Test Loss: 1.692 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9447391033172607
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6289567947387695
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7227163314819336
Epoch: 3, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6828393936157227
Epoch: 4, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6439905166625977
Epoch: 5, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7512316703796387
Epoch: 6, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7092716693878174
Epoch: 7, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.330 Vali Acc: 0.200 Test Loss: 1.330 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7435276508331299
Epoch: 8, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.435 Vali Acc: 0.200 Test Loss: 1.435 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7080247402191162
Epoch: 9, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.573 Vali Acc: 0.200 Test Loss: 1.573 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6896309852600098
Epoch: 10, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.748 Vali Acc: 0.200 Test Loss: 1.748 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6895639896392822
Epoch: 11, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.946 Vali Acc: 0.200 Test Loss: 1.946 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6928629875183105
Epoch: 12, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.148 Vali Acc: 0.200 Test Loss: 2.148 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7244181632995605
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.345 Vali Acc: 0.200 Test Loss: 2.345 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9981658458709717
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6149191856384277
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.679703950881958
Epoch: 3, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6810126304626465
Epoch: 4, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6876301765441895
Epoch: 5, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.610196590423584
Epoch: 6, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.7043840885162354
Epoch: 7, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6737568378448486
Epoch: 8, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6353497505187988
Epoch: 9, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.387 Vali Acc: 0.267 Test Loss: 1.387 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6729013919830322
Epoch: 10, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.515 Vali Acc: 0.133 Test Loss: 1.515 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6639723777770996
Epoch: 11, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.658 Vali Acc: 0.133 Test Loss: 1.658 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7438230514526367
Epoch: 12, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.791 Vali Acc: 0.133 Test Loss: 1.791 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.65584397315979
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.916 Vali Acc: 0.133 Test Loss: 1.916 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6490130424499512
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.034 Vali Acc: 0.133 Test Loss: 2.034 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7065558433532715
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.148 Vali Acc: 0.133 Test Loss: 2.148 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6971132755279541
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.133 Test Loss: 2.259 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1378071308135986
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.732332706451416
Epoch: 2, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8095033168792725
Epoch: 3, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7217307090759277
Epoch: 4, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8445017337799072
Epoch: 5, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8350176811218262
Epoch: 6, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.765695333480835
Epoch: 7, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.745293140411377
Epoch: 8, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.679344654083252
Epoch: 9, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8125717639923096
Epoch: 10, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6781957149505615
Epoch: 11, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.8336317539215088
Epoch: 12, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7704577445983887
Epoch: 13, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.444 Vali Acc: 0.400 Test Loss: 1.444 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7271244525909424
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.502 Vali Acc: 0.400 Test Loss: 1.502 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.650524377822876
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7613315582275391
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.400 Test Loss: 1.624 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7281210422515869
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.400 Test Loss: 1.686 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7682511806488037
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.400 Test Loss: 1.748 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7359368801116943
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.400 Test Loss: 1.809 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7147650718688965
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.400 Test Loss: 1.868 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6065478324890137
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.400 Test Loss: 1.926 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8304862976074219
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.760500431060791
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.6702446937561035
Epoch: 3, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.6797864437103271
Epoch: 4, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6469943523406982
Epoch: 5, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6180870532989502
Epoch: 6, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6368837356567383
Epoch: 7, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5697746276855469
Epoch: 8, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6811563968658447
Epoch: 9, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7297334671020508
Epoch: 10, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6193499565124512
Epoch: 11, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.246 Vali Acc: 0.467 Test Loss: 1.246 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.648066520690918
Epoch: 12, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.324 Vali Acc: 0.467 Test Loss: 1.324 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6195547580718994
Epoch: 13, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.420 Vali Acc: 0.333 Test Loss: 1.420 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.821568489074707
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6326014995574951
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6762261390686035
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7002971172332764
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7369909286499023
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7342853546142578
Epoch: 6, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7173757553100586
Epoch: 7, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7037911415100098
Epoch: 8, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6934123039245605
Epoch: 9, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6647429466247559
Epoch: 10, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6834321022033691
Epoch: 11, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3351197242736816
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6998200416564941
Epoch: 2, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6847376823425293
Epoch: 3, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7171621322631836
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6276226043701172
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6440999507904053
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6551339626312256
Epoch: 7, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6450130939483643
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6844723224639893
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6341037750244141
Epoch: 10, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.286 Vali Acc: 0.267 Test Loss: 1.286 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6448347568511963
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.282 Vali Acc: 0.200 Test Loss: 1.282 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5917143821716309
Epoch: 12, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6140952110290527
Epoch: 13, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.598902702331543
Epoch: 14, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.395 Vali Acc: 0.133 Test Loss: 1.395 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6134614944458008
Epoch: 15, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.407 Vali Acc: 0.133 Test Loss: 1.407 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3323651
model size : 22.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0695176124572754
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.185 Vali Acc: 0.067 Test Loss: 1.185 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.6518251895904541
Epoch: 2, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.187 Vali Acc: 0.067 Test Loss: 1.187 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6971466541290283
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.6772909164428711
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.6576731204986572
Epoch: 5, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.689324140548706
Epoch: 6, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7365727424621582
Epoch: 7, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7825162410736084
Epoch: 8, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7379677295684814
Epoch: 9, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.727783203125
Epoch: 10, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6924951076507568
Epoch: 11, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7567710876464844
Epoch: 12, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.369 Vali Acc: 0.333 Test Loss: 1.369 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7395193576812744
Epoch: 13, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.431 Vali Acc: 0.267 Test Loss: 1.431 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6685233116149902
Epoch: 14, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.501 Vali Acc: 0.200 Test Loss: 1.501 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7254953384399414
Epoch: 15, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.566 Vali Acc: 0.200 Test Loss: 1.566 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6336252689361572
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.633 Vali Acc: 0.200 Test Loss: 1.633 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6713299751281738
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.700 Vali Acc: 0.200 Test Loss: 1.700 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6888000965118408
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.767 Vali Acc: 0.267 Test Loss: 1.767 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7106420993804932
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.834 Vali Acc: 0.267 Test Loss: 1.834 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.912787675857544
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.214 Vali Acc: 0.067 Test Loss: 1.214 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.628392219543457
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
Validation loss decreased (-0.066655 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.652371883392334
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7396676540374756
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7229578495025635
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.7164852619171143
Epoch: 6, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.235 Vali Acc: 0.133 Test Loss: 1.235 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6837201118469238
Epoch: 7, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.242 Vali Acc: 0.133 Test Loss: 1.242 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7020633220672607
Epoch: 8, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6686697006225586
Epoch: 9, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7506051063537598
Epoch: 10, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7713162899017334
Epoch: 11, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.370 Vali Acc: 0.267 Test Loss: 1.370 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7264058589935303
Epoch: 12, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.408 Vali Acc: 0.267 Test Loss: 1.408 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7760422229766846
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.467 Vali Acc: 0.267 Test Loss: 1.467 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7037229537963867
Epoch: 14, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.527 Vali Acc: 0.333 Test Loss: 1.527 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333318).  Saving model ...
Epoch: 15 cost time: 0.687272310256958
Epoch: 15, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.585 Vali Acc: 0.333 Test Loss: 1.585 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.753493070602417
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7186489105224609
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.715 Vali Acc: 0.333 Test Loss: 1.715 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6634271144866943
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.782 Vali Acc: 0.333 Test Loss: 1.782 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6151382923126221
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.850 Vali Acc: 0.333 Test Loss: 1.850 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6888763904571533
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.917 Vali Acc: 0.267 Test Loss: 1.917 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6943697929382324
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.983 Vali Acc: 0.267 Test Loss: 1.983 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6915459632873535
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.047 Vali Acc: 0.267 Test Loss: 2.047 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7111916542053223
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.333 Test Loss: 2.108 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7325389385223389
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.333 Test Loss: 2.166 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.065359592437744
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.697838544845581
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7220485210418701
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7049233913421631
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7677528858184814
Epoch: 5, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7134706974029541
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7778198719024658
Epoch: 7, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7209067344665527
Epoch: 8, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.69167160987854
Epoch: 9, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.6952555179595947
Epoch: 10, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6998519897460938
Epoch: 11, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7135860919952393
Epoch: 12, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6804945468902588
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.390 Vali Acc: 0.333 Test Loss: 1.390 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7614650726318359
Epoch: 14, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6680586338043213
Epoch: 15, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.483 Vali Acc: 0.333 Test Loss: 1.483 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.722341775894165
Epoch: 16, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.531 Vali Acc: 0.333 Test Loss: 1.531 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7294151782989502
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.581 Vali Acc: 0.333 Test Loss: 1.581 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7328784465789795
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.632 Vali Acc: 0.333 Test Loss: 1.632 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.757462739944458
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.333 Test Loss: 1.684 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.120110034942627
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.248 Vali Acc: 0.067 Test Loss: 1.248 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.6932625770568848
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.246 Vali Acc: 0.067 Test Loss: 1.246 Test Acc: 0.067
Validation loss decreased (-0.066654 --> -0.066654).  Saving model ...
Epoch: 3 cost time: 0.7016925811767578
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.7386980056762695
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7652132511138916
Epoch: 5, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7322056293487549
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.7039132118225098
Epoch: 7, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7713079452514648
Epoch: 8, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7440383434295654
Epoch: 9, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.6771459579467773
Epoch: 10, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8461670875549316
Epoch: 11, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7315115928649902
Epoch: 12, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.363 Vali Acc: 0.333 Test Loss: 1.363 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6677262783050537
Epoch: 13, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.411 Vali Acc: 0.333 Test Loss: 1.411 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6405627727508545
Epoch: 14, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.464 Vali Acc: 0.333 Test Loss: 1.464 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7150764465332031
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.512 Vali Acc: 0.333 Test Loss: 1.512 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6424641609191895
Epoch: 16, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.569 Vali Acc: 0.400 Test Loss: 1.569 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399984).  Saving model ...
Epoch: 17 cost time: 0.7071413993835449
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.629 Vali Acc: 0.400 Test Loss: 1.629 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.657968282699585
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.333 Test Loss: 1.690 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7212154865264893
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.754 Vali Acc: 0.333 Test Loss: 1.754 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6465749740600586
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.333 Test Loss: 1.816 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6593050956726074
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.333 Test Loss: 1.876 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6768167018890381
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.333 Test Loss: 1.935 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6781373023986816
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.333 Test Loss: 1.991 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6289117336273193
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.044 Vali Acc: 0.333 Test Loss: 2.044 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6169183254241943
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.333 Test Loss: 2.095 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6377134323120117
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.143 Vali Acc: 0.333 Test Loss: 2.143 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.056309938430786
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5949387550354004
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6260340213775635
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6440374851226807
Epoch: 4, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6779372692108154
Epoch: 5, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6710724830627441
Epoch: 6, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.639258623123169
Epoch: 7, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6601476669311523
Epoch: 8, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.340 Vali Acc: 0.133 Test Loss: 1.340 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6598443984985352
Epoch: 9, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.401 Vali Acc: 0.133 Test Loss: 1.401 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6051440238952637
Epoch: 10, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.474 Vali Acc: 0.133 Test Loss: 1.474 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6716263294219971
Epoch: 11, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.560 Vali Acc: 0.133 Test Loss: 1.560 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.117177963256836
Epoch: 1, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.686046838760376
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6954545974731445
Epoch: 3, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6994872093200684
Epoch: 4, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7160251140594482
Epoch: 5, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6866731643676758
Epoch: 6, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.713834285736084
Epoch: 7, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.288 Vali Acc: 0.133 Test Loss: 1.288 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7645940780639648
Epoch: 8, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.317 Vali Acc: 0.133 Test Loss: 1.317 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7170934677124023
Epoch: 9, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.349 Vali Acc: 0.200 Test Loss: 1.349 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7272903919219971
Epoch: 10, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.389 Vali Acc: 0.200 Test Loss: 1.389 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7298924922943115
Epoch: 11, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.436 Vali Acc: 0.200 Test Loss: 1.436 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.04256534576416
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6058189868927002
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7084474563598633
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7201871871948242
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6991348266601562
Epoch: 5, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.664273738861084
Epoch: 6, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6381425857543945
Epoch: 7, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.6185688972473145
Epoch: 8, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.6571624279022217
Epoch: 9, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.7268192768096924
Epoch: 10, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6491599082946777
Epoch: 11, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6440298557281494
Epoch: 12, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.6832654476165771
Epoch: 13, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.686722993850708
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7039322853088379
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6876060962677002
Epoch: 16, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 17 cost time: 0.681279182434082
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.275 Vali Acc: 0.533 Test Loss: 1.275 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 18 cost time: 0.667125940322876
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.297 Vali Acc: 0.533 Test Loss: 1.297 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6181252002716064
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.320 Vali Acc: 0.533 Test Loss: 1.320 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6603827476501465
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.533 Test Loss: 1.343 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.665513277053833
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.600 Test Loss: 1.366 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.5892858505249023
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.600 Test Loss: 1.390 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7257287502288818
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.600 Test Loss: 1.412 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6338469982147217
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6259725093841553
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.600 Test Loss: 1.456 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6571962833404541
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.600 Test Loss: 1.477 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6491286754608154
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.600 Test Loss: 1.497 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.691720724105835
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.600 Test Loss: 1.516 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.680283784866333
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.600 Test Loss: 1.534 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6169102191925049
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.600 Test Loss: 1.551 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6429369449615479
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.600 Test Loss: 1.567 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.160454511642456
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.163 Vali Acc: 0.067 Test Loss: 1.163 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.6517574787139893
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.066655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6330618858337402
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.711590051651001
Epoch: 4, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6595902442932129
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6531193256378174
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6427192687988281
Epoch: 7, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6926174163818359
Epoch: 8, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7253603935241699
Epoch: 9, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7407145500183105
Epoch: 10, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7041194438934326
Epoch: 11, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8004839420318604
Epoch: 12, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6685187816619873
Epoch: 13, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6656346321105957
Epoch: 14, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6261720657348633
Epoch: 15, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6592996120452881
Epoch: 16, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6052665710449219
Epoch: 17, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6470832824707031
Epoch: 18, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6516525745391846
Epoch: 19, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6285638809204102
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.440 Vali Acc: 0.333 Test Loss: 1.440 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8993339538574219
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.174 Vali Acc: 0.133 Test Loss: 1.174 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6432263851165771
Epoch: 2, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5930216312408447
Epoch: 3, Steps: 1 | Train Loss: 1.295 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6777896881103516
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6426489353179932
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.661402702331543
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5905869007110596
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6070230007171631
Epoch: 8, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.6269099712371826
Epoch: 9, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6272938251495361
Epoch: 10, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6829442977905273
Epoch: 11, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7518022060394287
Epoch: 12, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6809029579162598
Epoch: 13, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6896085739135742
Epoch: 14, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6902337074279785
Epoch: 15, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6719844341278076
Epoch: 16, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.305 Vali Acc: 0.467 Test Loss: 1.305 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6532273292541504
Epoch: 17, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.353 Vali Acc: 0.600 Test Loss: 1.353 Test Acc: 0.600
Validation loss decreased (-0.466655 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 0.6388802528381348
Epoch: 18, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.407 Vali Acc: 0.533 Test Loss: 1.407 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6379475593566895
Epoch: 19, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6210098266601562
Epoch: 20, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.492 Vali Acc: 0.600 Test Loss: 1.492 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6236798763275146
Epoch: 21, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.534 Vali Acc: 0.533 Test Loss: 1.534 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.653031587600708
Epoch: 22, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.578 Vali Acc: 0.533 Test Loss: 1.578 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6595172882080078
Epoch: 23, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.625 Vali Acc: 0.533 Test Loss: 1.625 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6234526634216309
Epoch: 24, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.675 Vali Acc: 0.467 Test Loss: 1.675 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6886374950408936
Epoch: 25, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.727 Vali Acc: 0.467 Test Loss: 1.727 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6980056762695312
Epoch: 26, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.467 Test Loss: 1.776 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7098431587219238
Epoch: 27, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.823 Vali Acc: 0.400 Test Loss: 1.823 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.843639612197876
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6545999050140381
Epoch: 2, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6745424270629883
Epoch: 3, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6482322216033936
Epoch: 4, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6538612842559814
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7219865322113037
Epoch: 6, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.640777587890625
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.659088134765625
Epoch: 8, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6609914302825928
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6631102561950684
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6424481868743896
Epoch: 11, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2481027
model size : 14.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1821305751800537
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6834244728088379
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7450532913208008
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7732019424438477
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.718041181564331
Epoch: 5, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7795944213867188
Epoch: 6, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6979820728302002
Epoch: 7, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7527072429656982
Epoch: 8, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7956395149230957
Epoch: 9, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8377945423126221
Epoch: 10, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6696434020996094
Epoch: 11, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.782881498336792
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6820836067199707
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6403238773345947
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6925644874572754
Epoch: 4, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6483767032623291
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6391839981079102
Epoch: 6, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6357479095458984
Epoch: 7, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6153850555419922
Epoch: 8, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6934406757354736
Epoch: 9, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6133227348327637
Epoch: 10, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6997122764587402
Epoch: 11, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.6553134918212891
Epoch: 12, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6596002578735352
Epoch: 13, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.382 Vali Acc: 0.400 Test Loss: 1.382 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6677238941192627
Epoch: 14, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.441 Vali Acc: 0.267 Test Loss: 1.441 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6689116954803467
Epoch: 15, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.517 Vali Acc: 0.267 Test Loss: 1.517 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6565878391265869
Epoch: 16, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.589 Vali Acc: 0.333 Test Loss: 1.589 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5928688049316406
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.652 Vali Acc: 0.333 Test Loss: 1.652 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6651701927185059
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.710 Vali Acc: 0.333 Test Loss: 1.710 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6419343948364258
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.764 Vali Acc: 0.333 Test Loss: 1.764 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.606867790222168
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.817 Vali Acc: 0.400 Test Loss: 1.817 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6475234031677246
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.333 Test Loss: 1.869 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.885265827178955
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6843514442443848
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6528944969177246
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7023389339447021
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7210860252380371
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7216742038726807
Epoch: 6, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.7387948036193848
Epoch: 7, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6889474391937256
Epoch: 8, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7126822471618652
Epoch: 9, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6719286441802979
Epoch: 10, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7013251781463623
Epoch: 11, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6824493408203125
Epoch: 12, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.340 Vali Acc: 0.333 Test Loss: 1.340 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7132413387298584
Epoch: 13, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7122726440429688
Epoch: 14, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.453 Vali Acc: 0.333 Test Loss: 1.453 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6793162822723389
Epoch: 15, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.521 Vali Acc: 0.333 Test Loss: 1.521 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7343606948852539
Epoch: 16, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.584 Vali Acc: 0.333 Test Loss: 1.584 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0170488357543945
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6397275924682617
Epoch: 2, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6993238925933838
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6625750064849854
Epoch: 4, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6635429859161377
Epoch: 5, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7273547649383545
Epoch: 6, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6513042449951172
Epoch: 7, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6403167247772217
Epoch: 8, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6341743469238281
Epoch: 9, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6372087001800537
Epoch: 10, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6290156841278076
Epoch: 11, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.905297040939331
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6508245468139648
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6042358875274658
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.6562790870666504
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6366627216339111
Epoch: 5, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.675797700881958
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.6664032936096191
Epoch: 7, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7694437503814697
Epoch: 8, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7074999809265137
Epoch: 9, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.401 Vali Acc: 0.133 Test Loss: 1.401 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7063796520233154
Epoch: 10, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.475 Vali Acc: 0.133 Test Loss: 1.475 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6732761859893799
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.559 Vali Acc: 0.133 Test Loss: 1.559 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6774005889892578
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.656 Vali Acc: 0.133 Test Loss: 1.656 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.670161247253418
Epoch: 13, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.767 Vali Acc: 0.133 Test Loss: 1.767 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7877411842346191
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.883 Vali Acc: 0.133 Test Loss: 1.883 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7403414249420166
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 2.000 Vali Acc: 0.200 Test Loss: 2.000 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6841354370117188
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.116 Vali Acc: 0.200 Test Loss: 2.116 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.003575563430786
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5327537059783936
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6333141326904297
Epoch: 3, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.6023802757263184
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5963103771209717
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5847499370574951
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6098597049713135
Epoch: 7, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6380813121795654
Epoch: 8, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.129 Vali Acc: 0.133 Test Loss: 1.129 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6279177665710449
Epoch: 9, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6995434761047363
Epoch: 10, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6831269264221191
Epoch: 11, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6253232955932617
Epoch: 12, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6383695602416992
Epoch: 13, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.341 Vali Acc: 0.133 Test Loss: 1.341 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6643049716949463
Epoch: 14, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.374 Vali Acc: 0.133 Test Loss: 1.374 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.849031686782837
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6345949172973633
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.126 Vali Acc: 0.133 Test Loss: 1.126 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.559274435043335
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.5278830528259277
Epoch: 4, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6043481826782227
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5898466110229492
Epoch: 6, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6031854152679443
Epoch: 7, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6081109046936035
Epoch: 8, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6682827472686768
Epoch: 9, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6329751014709473
Epoch: 10, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6530487537384033
Epoch: 11, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6304957866668701
Epoch: 12, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6535971164703369
Epoch: 13, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.195 Vali Acc: 0.467 Test Loss: 1.195 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.638495922088623
Epoch: 14, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6065928936004639
Epoch: 15, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.244 Vali Acc: 0.467 Test Loss: 1.244 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6307892799377441
Epoch: 16, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6965339183807373
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.281 Vali Acc: 0.467 Test Loss: 1.281 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5836482048034668
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.303 Vali Acc: 0.467 Test Loss: 1.303 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5937392711639404
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.326 Vali Acc: 0.533 Test Loss: 1.326 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533320).  Saving model ...
Epoch: 20 cost time: 0.6428792476654053
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.533 Test Loss: 1.351 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6378028392791748
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.533 Test Loss: 1.376 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7013723850250244
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.533 Test Loss: 1.401 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6535854339599609
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.533 Test Loss: 1.426 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.663104772567749
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.533 Test Loss: 1.450 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6379992961883545
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.533 Test Loss: 1.473 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6279184818267822
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.533 Test Loss: 1.495 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.631004810333252
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.533 Test Loss: 1.516 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6815404891967773
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.533 Test Loss: 1.536 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6944665908813477
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.467 Test Loss: 1.555 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1034274101257324
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6368353366851807
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6274807453155518
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6155824661254883
Epoch: 4, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6179442405700684
Epoch: 5, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6471700668334961
Epoch: 6, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7317073345184326
Epoch: 7, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.7199759483337402
Epoch: 8, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7286567687988281
Epoch: 9, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6943874359130859
Epoch: 10, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7025387287139893
Epoch: 11, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6008789539337158
Epoch: 12, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.629258394241333
Epoch: 13, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6297626495361328
Epoch: 14, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6281793117523193
Epoch: 15, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6469542980194092
Epoch: 16, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.650848388671875
Epoch: 17, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6419515609741211
Epoch: 18, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9615800380706787
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5714747905731201
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5963706970214844
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5762555599212646
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6057798862457275
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6115753650665283
Epoch: 6, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6208224296569824
Epoch: 7, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5970237255096436
Epoch: 8, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6173040866851807
Epoch: 9, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5929229259490967
Epoch: 10, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5570266246795654
Epoch: 11, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6502857208251953
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.6107978820800781
Epoch: 13, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5697646141052246
Epoch: 14, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6521210670471191
Epoch: 15, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.210 Vali Acc: 0.533 Test Loss: 1.210 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5438094139099121
Epoch: 16, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.226 Vali Acc: 0.533 Test Loss: 1.226 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6920180320739746
Epoch: 17, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.244 Vali Acc: 0.533 Test Loss: 1.244 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.589000940322876
Epoch: 18, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.274 Vali Acc: 0.533 Test Loss: 1.274 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5979771614074707
Epoch: 19, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.289 Vali Acc: 0.467 Test Loss: 1.289 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6107544898986816
Epoch: 20, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.304 Vali Acc: 0.533 Test Loss: 1.304 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.699653148651123
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.557924747467041
Epoch: 22, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.379 Vali Acc: 0.400 Test Loss: 1.379 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.059166193008423
Epoch: 1, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6149404048919678
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.7104275226593018
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.647172212600708
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6252548694610596
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.643639087677002
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6545286178588867
Epoch: 7, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.648106575012207
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6170096397399902
Epoch: 9, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6640305519104004
Epoch: 10, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6912963390350342
Epoch: 11, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.769644021987915
Epoch: 12, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8263068199157715
Epoch: 13, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7031617164611816
Epoch: 14, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.325 Vali Acc: 0.200 Test Loss: 1.325 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7019624710083008
Epoch: 15, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.345 Vali Acc: 0.267 Test Loss: 1.345 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1694595
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3129208087921143
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6715583801269531
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.739255428314209
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6575779914855957
Epoch: 4, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5928049087524414
Epoch: 5, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6696658134460449
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.7116029262542725
Epoch: 7, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6330883502960205
Epoch: 8, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6597774028778076
Epoch: 9, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6658978462219238
Epoch: 10, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6715726852416992
Epoch: 11, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.366 Vali Acc: 0.267 Test Loss: 1.366 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6273491382598877
Epoch: 12, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.398 Vali Acc: 0.267 Test Loss: 1.398 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6752345561981201
Epoch: 13, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.432 Vali Acc: 0.267 Test Loss: 1.432 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6639423370361328
Epoch: 14, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.479 Vali Acc: 0.267 Test Loss: 1.479 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6959493160247803
Epoch: 15, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.541 Vali Acc: 0.267 Test Loss: 1.541 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7183365821838379
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.622 Vali Acc: 0.267 Test Loss: 1.622 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0666756629943848
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7228984832763672
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6475141048431396
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7880702018737793
Epoch: 4, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6694808006286621
Epoch: 5, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7369654178619385
Epoch: 6, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7293002605438232
Epoch: 7, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.6980087757110596
Epoch: 8, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6692037582397461
Epoch: 9, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7339906692504883
Epoch: 10, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.324 Vali Acc: 0.267 Test Loss: 1.324 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.616584062576294
Epoch: 11, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.358 Vali Acc: 0.267 Test Loss: 1.358 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7707316875457764
Epoch: 12, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.400 Vali Acc: 0.333 Test Loss: 1.400 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6651566028594971
Epoch: 13, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6553800106048584
Epoch: 14, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.479 Vali Acc: 0.267 Test Loss: 1.479 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.717308759689331
Epoch: 15, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.532 Vali Acc: 0.267 Test Loss: 1.532 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6736578941345215
Epoch: 16, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.601 Vali Acc: 0.267 Test Loss: 1.601 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6705985069274902
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.672 Vali Acc: 0.267 Test Loss: 1.672 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1722970008850098
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.210 Vali Acc: 0.133 Test Loss: 1.210 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6554315090179443
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.215 Vali Acc: 0.133 Test Loss: 1.215 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.675234317779541
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.222 Vali Acc: 0.133 Test Loss: 1.222 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6589155197143555
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.6637799739837646
Epoch: 5, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6290662288665771
Epoch: 6, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7014479637145996
Epoch: 7, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6829214096069336
Epoch: 8, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7494561672210693
Epoch: 9, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7357378005981445
Epoch: 10, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7198781967163086
Epoch: 11, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.326 Vali Acc: 0.200 Test Loss: 1.326 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6255862712860107
Epoch: 12, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.359 Vali Acc: 0.200 Test Loss: 1.359 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6335718631744385
Epoch: 13, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333319).  Saving model ...
Epoch: 14 cost time: 0.676323413848877
Epoch: 14, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6024696826934814
Epoch: 15, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
Validation loss decreased (-0.333319 --> -0.399985).  Saving model ...
Epoch: 16 cost time: 0.6139647960662842
Epoch: 16, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.560 Vali Acc: 0.400 Test Loss: 1.560 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5962693691253662
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.629 Vali Acc: 0.333 Test Loss: 1.629 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6044704914093018
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.701 Vali Acc: 0.333 Test Loss: 1.701 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6223230361938477
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6570618152618408
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.838 Vali Acc: 0.333 Test Loss: 1.838 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7119348049163818
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.902 Vali Acc: 0.333 Test Loss: 1.902 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7120490074157715
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.962 Vali Acc: 0.333 Test Loss: 1.962 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6394867897033691
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.333 Test Loss: 2.019 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.637321949005127
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.333 Test Loss: 2.072 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6287667751312256
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.123 Vali Acc: 0.333 Test Loss: 2.123 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.839784860610962
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6451888084411621
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6297988891601562
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6889722347259521
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6816873550415039
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.229 Vali Acc: 0.133 Test Loss: 1.229 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6414902210235596
Epoch: 6, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.754401683807373
Epoch: 7, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6804296970367432
Epoch: 8, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7322158813476562
Epoch: 9, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7373156547546387
Epoch: 10, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8280518054962158
Epoch: 11, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.7337641716003418
Epoch: 12, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6984822750091553
Epoch: 13, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.764268159866333
Epoch: 14, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.387 Vali Acc: 0.333 Test Loss: 1.387 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7460517883300781
Epoch: 15, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.444 Vali Acc: 0.267 Test Loss: 1.444 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7156341075897217
Epoch: 16, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.515 Vali Acc: 0.333 Test Loss: 1.515 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7159595489501953
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.589 Vali Acc: 0.267 Test Loss: 1.589 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7078468799591064
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.665 Vali Acc: 0.267 Test Loss: 1.665 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7934927940368652
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.750903844833374
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.267 Test Loss: 1.808 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7645382881164551
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.267 Test Loss: 1.873 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0509414672851562
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7433609962463379
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.204 Vali Acc: 0.133 Test Loss: 1.204 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7430689334869385
Epoch: 3, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.213 Vali Acc: 0.133 Test Loss: 1.213 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6932933330535889
Epoch: 4, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.223 Vali Acc: 0.067 Test Loss: 1.223 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7413277626037598
Epoch: 5, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6474990844726562
Epoch: 6, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.6650567054748535
Epoch: 7, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.304 Vali Acc: 0.200 Test Loss: 1.304 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7208549976348877
Epoch: 8, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6381428241729736
Epoch: 9, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6948122978210449
Epoch: 10, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.484 Vali Acc: 0.200 Test Loss: 1.484 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.646357536315918
Epoch: 11, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.554 Vali Acc: 0.200 Test Loss: 1.554 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6773264408111572
Epoch: 12, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6705265045166016
Epoch: 13, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.741 Vali Acc: 0.200 Test Loss: 1.741 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6569459438323975
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.848 Vali Acc: 0.200 Test Loss: 1.848 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7162120342254639
Epoch: 15, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.959 Vali Acc: 0.200 Test Loss: 1.959 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6995384693145752
Epoch: 16, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.072 Vali Acc: 0.200 Test Loss: 2.072 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.965256690979004
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5911924839019775
Epoch: 2, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6122422218322754
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.200 Vali Acc: 0.133 Test Loss: 1.200 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7190132141113281
Epoch: 4, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.206 Vali Acc: 0.067 Test Loss: 1.206 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6579558849334717
Epoch: 5, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.213 Vali Acc: 0.133 Test Loss: 1.213 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6663947105407715
Epoch: 6, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6649949550628662
Epoch: 7, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6385605335235596
Epoch: 8, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6001060009002686
Epoch: 9, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.283 Vali Acc: 0.133 Test Loss: 1.283 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5902364253997803
Epoch: 10, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.311 Vali Acc: 0.133 Test Loss: 1.311 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6020359992980957
Epoch: 11, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.355 Vali Acc: 0.133 Test Loss: 1.355 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0067033767700195
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7562754154205322
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7626256942749023
Epoch: 3, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.704953670501709
Epoch: 4, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.653031587600708
Epoch: 5, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6783411502838135
Epoch: 6, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6612331867218018
Epoch: 7, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.6526641845703125
Epoch: 8, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.6721258163452148
Epoch: 9, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.6712572574615479
Epoch: 10, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
Validation loss decreased (-0.466655 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.6250455379486084
Epoch: 11, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6334547996520996
Epoch: 12, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.223 Vali Acc: 0.533 Test Loss: 1.223 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7080996036529541
Epoch: 13, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.249 Vali Acc: 0.533 Test Loss: 1.249 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.669428825378418
Epoch: 14, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7027440071105957
Epoch: 15, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6655023097991943
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.334 Vali Acc: 0.467 Test Loss: 1.334 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6796793937683105
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.371 Vali Acc: 0.400 Test Loss: 1.371 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.643263578414917
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6574573516845703
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7051889896392822
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.489 Vali Acc: 0.400 Test Loss: 1.489 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9753341674804688
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5906727313995361
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6182746887207031
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.6658029556274414
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6422476768493652
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7013561725616455
Epoch: 6, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6532926559448242
Epoch: 7, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6750881671905518
Epoch: 8, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6691594123840332
Epoch: 9, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6995890140533447
Epoch: 10, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6491794586181641
Epoch: 11, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.678184986114502
Epoch: 12, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6245174407958984
Epoch: 13, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1011602878570557
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7009401321411133
Epoch: 2, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7258179187774658
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6133253574371338
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5907013416290283
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6044089794158936
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6828792095184326
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.6694328784942627
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5862970352172852
Epoch: 9, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7078409194946289
Epoch: 10, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7380123138427734
Epoch: 11, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7037985324859619
Epoch: 12, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7226910591125488
Epoch: 13, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6560125350952148
Epoch: 14, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7016880512237549
Epoch: 15, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6686110496520996
Epoch: 16, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.250 Vali Acc: 0.467 Test Loss: 1.250 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7230427265167236
Epoch: 17, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.284 Vali Acc: 0.533 Test Loss: 1.284 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2096259593963623
Epoch: 1, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7164912223815918
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7070703506469727
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7031195163726807
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7730133533477783
Epoch: 5, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7035152912139893
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7462897300720215
Epoch: 7, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7644903659820557
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6667230129241943
Epoch: 9, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7140657901763916
Epoch: 10, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6533281803131104
Epoch: 11, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7098371982574463
Epoch: 12, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6433811187744141
Epoch: 13, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5768160820007324
Epoch: 14, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1301379
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.952622652053833
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6424520015716553
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6222503185272217
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.651369571685791
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6785488128662109
Epoch: 5, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6719832420349121
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6418144702911377
Epoch: 7, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7155342102050781
Epoch: 8, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7204880714416504
Epoch: 9, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7023165225982666
Epoch: 10, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7009835243225098
Epoch: 11, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6636626720428467
Epoch: 12, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6345832347869873
Epoch: 13, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1508629322052
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7598862648010254
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.798168420791626
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7002902030944824
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8212366104125977
Epoch: 5, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7162086963653564
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6955735683441162
Epoch: 7, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7563722133636475
Epoch: 8, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7028248310089111
Epoch: 9, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7126333713531494
Epoch: 10, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7352344989776611
Epoch: 11, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7709314823150635
Epoch: 12, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.286 Vali Acc: 0.467 Test Loss: 1.286 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.748621940612793
Epoch: 13, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.186479330062866
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6995034217834473
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.738532304763794
Epoch: 3, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.628922700881958
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6752662658691406
Epoch: 5, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6813552379608154
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6786611080169678
Epoch: 7, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6882836818695068
Epoch: 8, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6013741493225098
Epoch: 9, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8103623390197754
Epoch: 10, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7409892082214355
Epoch: 11, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.704291820526123
Epoch: 12, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7030167579650879
Epoch: 13, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1242735385894775
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6900544166564941
Epoch: 2, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7328782081604004
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7034578323364258
Epoch: 4, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.649806022644043
Epoch: 5, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6742591857910156
Epoch: 6, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7044289112091064
Epoch: 7, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6524786949157715
Epoch: 8, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6058001518249512
Epoch: 9, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6716930866241455
Epoch: 10, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6325774192810059
Epoch: 11, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6564817428588867
Epoch: 12, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6715142726898193
Epoch: 13, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.105638265609741
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7679805755615234
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7013731002807617
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7940773963928223
Epoch: 4, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7191014289855957
Epoch: 5, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7537240982055664
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7573955059051514
Epoch: 7, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7272918224334717
Epoch: 8, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6991069316864014
Epoch: 9, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7072591781616211
Epoch: 10, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.395 Vali Acc: 0.267 Test Loss: 1.395 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8697993755340576
Epoch: 11, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.475 Vali Acc: 0.267 Test Loss: 1.475 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6581482887268066
Epoch: 12, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.564 Vali Acc: 0.333 Test Loss: 1.564 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6675434112548828
Epoch: 13, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.677 Vali Acc: 0.267 Test Loss: 1.677 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.006763458251953
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5779669284820557
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.666865348815918
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6209909915924072
Epoch: 4, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6641459465026855
Epoch: 5, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6717917919158936
Epoch: 6, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.7014944553375244
Epoch: 7, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6362552642822266
Epoch: 8, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.729949951171875
Epoch: 9, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.665215015411377
Epoch: 10, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6666476726531982
Epoch: 11, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.332 Vali Acc: 0.267 Test Loss: 1.332 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6283864974975586
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7309021949768066
Epoch: 13, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.408 Vali Acc: 0.267 Test Loss: 1.408 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6426265239715576
Epoch: 14, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.446 Vali Acc: 0.333 Test Loss: 1.446 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6881184577941895
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7431807518005371
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.542 Vali Acc: 0.400 Test Loss: 1.542 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8918342590332031
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6457924842834473
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.664729118347168
Epoch: 3, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8838531970977783
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7750992774963379
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7644431591033936
Epoch: 6, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.8136105537414551
Epoch: 7, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7035181522369385
Epoch: 8, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6894373893737793
Epoch: 9, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8009865283966064
Epoch: 10, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7266397476196289
Epoch: 11, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7520723342895508
Epoch: 12, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7734668254852295
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7457740306854248
Epoch: 14, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8594710826873779
Epoch: 15, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.753669261932373
Epoch: 16, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.149 Vali Acc: 0.667 Test Loss: 1.149 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.712986946105957
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.171 Vali Acc: 0.667 Test Loss: 1.171 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8017673492431641
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7030172348022461
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.221 Vali Acc: 0.667 Test Loss: 1.221 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7550222873687744
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6973855495452881
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7004170417785645
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7145962715148926
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7307078838348389
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.600 Test Loss: 1.349 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7814698219299316
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7871088981628418
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.600 Test Loss: 1.395 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9306299686431885
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6272106170654297
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6090209484100342
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6186912059783936
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.6262128353118896
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.590322732925415
Epoch: 6, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5650646686553955
Epoch: 7, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5785753726959229
Epoch: 8, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.5941987037658691
Epoch: 9, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5589008331298828
Epoch: 10, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5587213039398193
Epoch: 11, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6426126956939697
Epoch: 12, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5918240547180176
Epoch: 13, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.609304666519165
Epoch: 14, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6042349338531494
Epoch: 15, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.608557939529419
Epoch: 16, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6340148448944092
Epoch: 17, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6556825637817383
Epoch: 18, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7677600383758545
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5979084968566895
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6136817932128906
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.620689868927002
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6129438877105713
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.6200363636016846
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6471126079559326
Epoch: 7, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6153433322906494
Epoch: 8, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6101164817810059
Epoch: 9, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.6311545372009277
Epoch: 10, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5969741344451904
Epoch: 11, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6780567169189453
Epoch: 12, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6829602718353271
Epoch: 13, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7128973007202148
Epoch: 14, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6648681163787842
Epoch: 15, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6851470470428467
Epoch: 16, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6952817440032959
Epoch: 17, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.342 Vali Acc: 0.467 Test Loss: 1.342 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466653).  Saving model ...
Epoch: 18 cost time: 0.6787021160125732
Epoch: 18, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.373 Vali Acc: 0.533 Test Loss: 1.373 Test Acc: 0.533
Validation loss decreased (-0.466653 --> -0.533320).  Saving model ...
Epoch: 19 cost time: 0.660548210144043
Epoch: 19, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.414 Vali Acc: 0.467 Test Loss: 1.414 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6629993915557861
Epoch: 20, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.479 Vali Acc: 0.467 Test Loss: 1.479 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7049963474273682
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.556 Vali Acc: 0.400 Test Loss: 1.556 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6479947566986084
Epoch: 22, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.630 Vali Acc: 0.333 Test Loss: 1.630 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6584985256195068
Epoch: 23, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.690 Vali Acc: 0.333 Test Loss: 1.690 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.668567419052124
Epoch: 24, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.744 Vali Acc: 0.333 Test Loss: 1.744 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6947348117828369
Epoch: 25, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.787 Vali Acc: 0.400 Test Loss: 1.787 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6555829048156738
Epoch: 26, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.824 Vali Acc: 0.467 Test Loss: 1.824 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.696718692779541
Epoch: 27, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.857 Vali Acc: 0.467 Test Loss: 1.857 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6944999694824219
Epoch: 28, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.887 Vali Acc: 0.467 Test Loss: 1.887 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.12044095993042
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6443250179290771
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6873490810394287
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.602229118347168
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6224758625030518
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.661595344543457
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7436037063598633
Epoch: 7, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.672722339630127
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5894138813018799
Epoch: 9, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.134 Vali Acc: 0.133 Test Loss: 1.134 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6434547901153564
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7198412418365479
Epoch: 11, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1104771
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.910454511642456
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6103301048278809
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6484651565551758
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6614177227020264
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7196071147918701
Epoch: 5, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6640233993530273
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6436450481414795
Epoch: 7, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6154346466064453
Epoch: 8, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6220242977142334
Epoch: 9, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6336925029754639
Epoch: 10, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6543214321136475
Epoch: 11, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6405515670776367
Epoch: 12, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.386 Vali Acc: 0.267 Test Loss: 1.386 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6285545825958252
Epoch: 13, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.419 Vali Acc: 0.267 Test Loss: 1.419 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6697814464569092
Epoch: 14, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.447 Vali Acc: 0.267 Test Loss: 1.447 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.991532325744629
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6527302265167236
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6606738567352295
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7174348831176758
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6926875114440918
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6530311107635498
Epoch: 6, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6954424381256104
Epoch: 7, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7248122692108154
Epoch: 8, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6591637134552002
Epoch: 9, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6341793537139893
Epoch: 10, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6322286128997803
Epoch: 11, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6802289485931396
Epoch: 12, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7778058052062988
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6055812835693359
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7259387969970703
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.670642614364624
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6024830341339111
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5895583629608154
Epoch: 6, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5933871269226074
Epoch: 7, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6673884391784668
Epoch: 8, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5751221179962158
Epoch: 9, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5909860134124756
Epoch: 10, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6512525081634521
Epoch: 11, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5855388641357422
Epoch: 12, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6233501434326172
Epoch: 13, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0384521484375
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6358072757720947
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6049191951751709
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6653721332550049
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6328914165496826
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6986081600189209
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6922457218170166
Epoch: 7, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6685447692871094
Epoch: 8, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7461526393890381
Epoch: 9, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9085888862609863
Epoch: 10, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8192732334136963
Epoch: 11, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7399249076843262
Epoch: 12, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6837372779846191
Epoch: 13, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.654717206954956
Epoch: 14, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7229852676391602
Epoch: 15, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6912479400634766
Epoch: 16, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.314 Vali Acc: 0.333 Test Loss: 1.314 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0949156284332275
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.247 Vali Acc: 0.067 Test Loss: 1.247 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.6660957336425781
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.246 Vali Acc: 0.000 Test Loss: 1.246 Test Acc: 0.000
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6732795238494873
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.252 Vali Acc: 0.133 Test Loss: 1.252 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.6505506038665771
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.6697587966918945
Epoch: 5, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7351608276367188
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.298 Vali Acc: 0.133 Test Loss: 1.298 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7349603176116943
Epoch: 7, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.335 Vali Acc: 0.200 Test Loss: 1.335 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7069978713989258
Epoch: 8, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.385 Vali Acc: 0.133 Test Loss: 1.385 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.690788745880127
Epoch: 9, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.447 Vali Acc: 0.133 Test Loss: 1.447 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6244688034057617
Epoch: 10, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.523 Vali Acc: 0.133 Test Loss: 1.523 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5999360084533691
Epoch: 11, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.623 Vali Acc: 0.200 Test Loss: 1.623 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6119496822357178
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.728 Vali Acc: 0.200 Test Loss: 1.728 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6335749626159668
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.840 Vali Acc: 0.200 Test Loss: 1.840 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6404075622558594
Epoch: 14, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.949 Vali Acc: 0.200 Test Loss: 1.949 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.09611177444458
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.055 Vali Acc: 0.667 Test Loss: 1.055 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.6588091850280762
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.052 Vali Acc: 0.667 Test Loss: 1.052 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.715813159942627
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5705130100250244
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5805790424346924
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6281349658966064
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7304830551147461
Epoch: 7, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6574857234954834
Epoch: 8, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7026214599609375
Epoch: 9, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7324604988098145
Epoch: 10, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6682066917419434
Epoch: 11, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5984082221984863
Epoch: 12, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0534720420837402
Epoch: 1, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.711658239364624
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7083251476287842
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6696655750274658
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6696207523345947
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6533932685852051
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6932358741760254
Epoch: 7, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.67903733253479
Epoch: 8, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.716804027557373
Epoch: 9, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6684672832489014
Epoch: 10, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7010831832885742
Epoch: 11, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6755025386810303
Epoch: 12, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7028417587280273
Epoch: 13, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6729164123535156
Epoch: 14, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7298762798309326
Epoch: 15, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.724083423614502
Epoch: 16, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8036859035491943
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8357586860656738
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8199119567871094
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.029715061187744
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7567379474639893
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.6790604591369629
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7984838485717773
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8068380355834961
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6812734603881836
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7315118312835693
Epoch: 7, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6728944778442383
Epoch: 8, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7658143043518066
Epoch: 9, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6753993034362793
Epoch: 10, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7361507415771484
Epoch: 11, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6574292182922363
Epoch: 12, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7299327850341797
Epoch: 13, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7419953346252441
Epoch: 14, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7158222198486328
Epoch: 15, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6697087287902832
Epoch: 16, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6903939247131348
Epoch: 17, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6252601146697998
Epoch: 18, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0252511501312256
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5707197189331055
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6566674709320068
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6558969020843506
Epoch: 4, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6305103302001953
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7447631359100342
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7461981773376465
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7611496448516846
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7050466537475586
Epoch: 9, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7364699840545654
Epoch: 10, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7781383991241455
Epoch: 11, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7254693508148193
Epoch: 12, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2309088706970215
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7577440738677979
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7342007160186768
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6970441341400146
Epoch: 4, Steps: 1 | Train Loss: 1.339 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.7874894142150879
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7062711715698242
Epoch: 6, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6279678344726562
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6747264862060547
Epoch: 8, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.207 Vali Acc: 0.067 Test Loss: 1.207 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7123651504516602
Epoch: 9, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.212 Vali Acc: 0.067 Test Loss: 1.212 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7237887382507324
Epoch: 10, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.218 Vali Acc: 0.067 Test Loss: 1.218 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7568953037261963
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.222 Vali Acc: 0.067 Test Loss: 1.222 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.673952579498291
Epoch: 12, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.227 Vali Acc: 0.067 Test Loss: 1.227 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7078030109405518
Epoch: 13, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.229 Vali Acc: 0.067 Test Loss: 1.229 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6336688995361328
Epoch: 14, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.236 Vali Acc: 0.067 Test Loss: 1.236 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1006467
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.857471227645874
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6294271945953369
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6573512554168701
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6031904220581055
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6359102725982666
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.56954026222229
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6192333698272705
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6695928573608398
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6108355522155762
Epoch: 9, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6716558933258057
Epoch: 10, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6444094181060791
Epoch: 11, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6779046058654785
Epoch: 12, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.266416311264038
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7611582279205322
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.196 Vali Acc: 0.133 Test Loss: 1.196 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8487045764923096
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8503556251525879
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.201 Vali Acc: 0.133 Test Loss: 1.201 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7307825088500977
Epoch: 5, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7612113952636719
Epoch: 6, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7120363712310791
Epoch: 7, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7497668266296387
Epoch: 8, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.7732560634613037
Epoch: 9, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7499253749847412
Epoch: 10, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6905837059020996
Epoch: 11, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.7220654487609863
Epoch: 12, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7575366497039795
Epoch: 13, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.773369550704956
Epoch: 14, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7462179660797119
Epoch: 15, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.322 Vali Acc: 0.467 Test Loss: 1.322 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466653).  Saving model ...
Epoch: 16 cost time: 0.6990551948547363
Epoch: 16, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.351 Vali Acc: 0.467 Test Loss: 1.351 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7424819469451904
Epoch: 17, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.377 Vali Acc: 0.467 Test Loss: 1.377 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6908619403839111
Epoch: 18, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.398 Vali Acc: 0.467 Test Loss: 1.398 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6180839538574219
Epoch: 19, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.420 Vali Acc: 0.467 Test Loss: 1.420 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.722301721572876
Epoch: 20, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.449 Vali Acc: 0.400 Test Loss: 1.449 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7528998851776123
Epoch: 21, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.730412483215332
Epoch: 22, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.518 Vali Acc: 0.333 Test Loss: 1.518 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6967332363128662
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.555 Vali Acc: 0.267 Test Loss: 1.555 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.657250165939331
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.592 Vali Acc: 0.267 Test Loss: 1.592 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6642098426818848
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.629 Vali Acc: 0.333 Test Loss: 1.629 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.190704345703125
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6829659938812256
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6863102912902832
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.221 Vali Acc: 0.133 Test Loss: 1.221 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6813294887542725
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6307578086853027
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6947903633117676
Epoch: 6, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6152904033660889
Epoch: 7, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7046782970428467
Epoch: 8, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6731617450714111
Epoch: 9, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6210947036743164
Epoch: 10, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7263822555541992
Epoch: 11, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7742302417755127
Epoch: 12, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6289858818054199
Epoch: 13, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6638674736022949
Epoch: 14, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6448554992675781
Epoch: 15, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.312 Vali Acc: 0.267 Test Loss: 1.312 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9731855392456055
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6742844581604004
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7355341911315918
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6608173847198486
Epoch: 4, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6580331325531006
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6659376621246338
Epoch: 6, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6110451221466064
Epoch: 7, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6619563102722168
Epoch: 8, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7590835094451904
Epoch: 9, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7003026008605957
Epoch: 10, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6657087802886963
Epoch: 11, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.727686882019043
Epoch: 12, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.089198350906372
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7123010158538818
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6511352062225342
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7463862895965576
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6431734561920166
Epoch: 5, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6509101390838623
Epoch: 6, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.278 Vali Acc: 0.133 Test Loss: 1.278 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5697579383850098
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.299 Vali Acc: 0.133 Test Loss: 1.299 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5790624618530273
Epoch: 8, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.324 Vali Acc: 0.200 Test Loss: 1.324 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.609917163848877
Epoch: 9, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5875086784362793
Epoch: 10, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.390 Vali Acc: 0.200 Test Loss: 1.390 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6377933025360107
Epoch: 11, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.433 Vali Acc: 0.200 Test Loss: 1.433 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9426531791687012
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.219 Vali Acc: 0.067 Test Loss: 1.219 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.6058590412139893
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.217 Vali Acc: 0.067 Test Loss: 1.217 Test Acc: 0.067
Validation loss decreased (-0.066654 --> -0.066654).  Saving model ...
Epoch: 3 cost time: 0.6572279930114746
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.218 Vali Acc: 0.133 Test Loss: 1.218 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.6047248840332031
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.220 Vali Acc: 0.133 Test Loss: 1.220 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6225602626800537
Epoch: 5, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.7030248641967773
Epoch: 6, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6758594512939453
Epoch: 7, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6899247169494629
Epoch: 8, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.231 Vali Acc: 0.133 Test Loss: 1.231 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6407594680786133
Epoch: 9, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6611518859863281
Epoch: 10, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.239 Vali Acc: 0.067 Test Loss: 1.239 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6668298244476318
Epoch: 11, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.248 Vali Acc: 0.067 Test Loss: 1.248 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6063601970672607
Epoch: 12, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6175088882446289
Epoch: 13, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.285 Vali Acc: 0.133 Test Loss: 1.285 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7189929485321045
Epoch: 14, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266653).  Saving model ...
Epoch: 15 cost time: 0.597862958908081
Epoch: 15, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.364 Vali Acc: 0.267 Test Loss: 1.364 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5618386268615723
Epoch: 16, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.405 Vali Acc: 0.267 Test Loss: 1.405 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6162159442901611
Epoch: 17, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.437 Vali Acc: 0.200 Test Loss: 1.437 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.645744800567627
Epoch: 18, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.462 Vali Acc: 0.200 Test Loss: 1.462 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6515610218048096
Epoch: 19, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.481 Vali Acc: 0.267 Test Loss: 1.481 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7738738059997559
Epoch: 20, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.499 Vali Acc: 0.333 Test Loss: 1.499 Test Acc: 0.333
Validation loss decreased (-0.266653 --> -0.333318).  Saving model ...
Epoch: 21 cost time: 0.6281001567840576
Epoch: 21, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.519 Vali Acc: 0.267 Test Loss: 1.519 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7782282829284668
Epoch: 22, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.540 Vali Acc: 0.267 Test Loss: 1.540 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6457462310791016
Epoch: 23, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.563 Vali Acc: 0.267 Test Loss: 1.563 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6724743843078613
Epoch: 24, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.587 Vali Acc: 0.267 Test Loss: 1.587 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6837544441223145
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.612 Vali Acc: 0.267 Test Loss: 1.612 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7524106502532959
Epoch: 26, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.267 Test Loss: 1.637 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6808047294616699
Epoch: 27, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.267 Test Loss: 1.661 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6996445655822754
Epoch: 28, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.685 Vali Acc: 0.267 Test Loss: 1.685 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6836659908294678
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.267 Test Loss: 1.708 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7441301345825195
Epoch: 30, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.267 Test Loss: 1.731 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.028831958770752
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.197 Vali Acc: 0.067 Test Loss: 1.197 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.7202417850494385
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
Validation loss decreased (-0.066655 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7461240291595459
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7027580738067627
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6879560947418213
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.612055778503418
Epoch: 6, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6212399005889893
Epoch: 7, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6287641525268555
Epoch: 8, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.6112449169158936
Epoch: 9, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.618828296661377
Epoch: 10, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.7046384811401367
Epoch: 11, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5883715152740479
Epoch: 12, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.7243082523345947
Epoch: 13, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6804537773132324
Epoch: 14, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6212055683135986
Epoch: 15, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6313846111297607
Epoch: 16, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6700935363769531
Epoch: 17, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5730431079864502
Epoch: 18, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6112010478973389
Epoch: 19, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.5926446914672852
Epoch: 20, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6384940147399902
Epoch: 21, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5806975364685059
Epoch: 22, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6288192272186279
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5957300662994385
Epoch: 24, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.257 Vali Acc: 0.467 Test Loss: 1.257 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6750903129577637
Epoch: 25, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.267 Vali Acc: 0.533 Test Loss: 1.267 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 26 cost time: 0.6717050075531006
Epoch: 26, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.277 Vali Acc: 0.533 Test Loss: 1.277 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.643641471862793
Epoch: 27, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.288 Vali Acc: 0.533 Test Loss: 1.288 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6773567199707031
Epoch: 28, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.298 Vali Acc: 0.533 Test Loss: 1.298 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6643886566162109
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.533 Test Loss: 1.308 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6641678810119629
Epoch: 30, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.533 Test Loss: 1.318 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7538392543792725
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.533 Test Loss: 1.327 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6775457859039307
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.533 Test Loss: 1.336 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6461820602416992
Epoch: 33, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.533 Test Loss: 1.345 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6060335636138916
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.533 Test Loss: 1.353 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6785247325897217
Epoch: 35, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.533 Test Loss: 1.361 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.085117816925049
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6832311153411865
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6619234085083008
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6554663181304932
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6721162796020508
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7473738193511963
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7233450412750244
Epoch: 7, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.7027058601379395
Epoch: 8, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.6848227977752686
Epoch: 9, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.6947557926177979
Epoch: 10, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.7694823741912842
Epoch: 11, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.7167840003967285
Epoch: 12, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.7334079742431641
Epoch: 13, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.7845058441162109
Epoch: 14, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7995233535766602
Epoch: 15, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8582847118377686
Epoch: 16, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7987608909606934
Epoch: 17, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7387936115264893
Epoch: 18, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7136814594268799
Epoch: 19, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6795220375061035
Epoch: 20, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6451902389526367
Epoch: 21, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.277 Vali Acc: 0.333 Test Loss: 1.277 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7199621200561523
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6679449081420898
Epoch: 23, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.95414400100708
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5799877643585205
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5998241901397705
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6292808055877686
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7279233932495117
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6465904712677002
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6497085094451904
Epoch: 7, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6813628673553467
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6678347587585449
Epoch: 9, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.619922399520874
Epoch: 10, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7052547931671143
Epoch: 11, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6445386409759521
Epoch: 12, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5772652626037598
Epoch: 13, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.697462797164917
Epoch: 14, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6236741542816162
Epoch: 15, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.6512336730957031
Epoch: 16, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6927497386932373
Epoch: 17, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6967353820800781
Epoch: 18, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7637341022491455
Epoch: 19, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.7100350856781006
Epoch: 20, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.189 Vali Acc: 0.533 Test Loss: 1.189 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6967315673828125
Epoch: 21, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.211 Vali Acc: 0.533 Test Loss: 1.211 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7335703372955322
Epoch: 22, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.230 Vali Acc: 0.533 Test Loss: 1.230 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7203121185302734
Epoch: 23, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.249 Vali Acc: 0.533 Test Loss: 1.249 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7325546741485596
Epoch: 24, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.268 Vali Acc: 0.533 Test Loss: 1.268 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7423303127288818
Epoch: 25, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.287 Vali Acc: 0.533 Test Loss: 1.287 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.641247034072876
Epoch: 26, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.300 Vali Acc: 0.533 Test Loss: 1.300 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.758922815322876
Epoch: 27, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.312 Vali Acc: 0.533 Test Loss: 1.312 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7351436614990234
Epoch: 28, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.325 Vali Acc: 0.533 Test Loss: 1.325 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7966594696044922
Epoch: 29, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.343 Vali Acc: 0.533 Test Loss: 1.343 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.980588674545288
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6912391185760498
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.711184024810791
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8243594169616699
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.653325080871582
Epoch: 5, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.6853859424591064
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.6877009868621826
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.6366317272186279
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6306078433990479
Epoch: 9, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5854601860046387
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.605888843536377
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5641756057739258
Epoch: 12, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6160941123962402
Epoch: 13, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6877360343933105
Epoch: 14, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6218373775482178
Epoch: 15, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6585657596588135
Epoch: 16, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6595020294189453
Epoch: 17, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1076675
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9206607341766357
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6573045253753662
Epoch: 2, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.64272141456604
Epoch: 3, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7129514217376709
Epoch: 4, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6399490833282471
Epoch: 5, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.637805700302124
Epoch: 6, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.664046049118042
Epoch: 7, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.707650899887085
Epoch: 8, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7026019096374512
Epoch: 9, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6941180229187012
Epoch: 10, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.739738941192627
Epoch: 11, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7065215110778809
Epoch: 12, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7049088478088379
Epoch: 13, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.295 Vali Acc: 0.200 Test Loss: 1.295 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7338814735412598
Epoch: 14, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5984559059143066
Epoch: 15, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.354 Vali Acc: 0.333 Test Loss: 1.354 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6489584445953369
Epoch: 16, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.396 Vali Acc: 0.333 Test Loss: 1.396 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5918943881988525
Epoch: 17, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.446 Vali Acc: 0.333 Test Loss: 1.446 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9724054336547852
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6070585250854492
Epoch: 2, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6168732643127441
Epoch: 3, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6878783702850342
Epoch: 4, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.7410001754760742
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6565022468566895
Epoch: 6, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6331367492675781
Epoch: 7, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.6916098594665527
Epoch: 8, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6452815532684326
Epoch: 9, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7270772457122803
Epoch: 10, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6873657703399658
Epoch: 11, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6675882339477539
Epoch: 12, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.328 Vali Acc: 0.267 Test Loss: 1.328 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.655148983001709
Epoch: 13, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.675224781036377
Epoch: 14, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.370 Vali Acc: 0.333 Test Loss: 1.370 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6822361946105957
Epoch: 15, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.403 Vali Acc: 0.333 Test Loss: 1.403 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6765501499176025
Epoch: 16, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.443 Vali Acc: 0.333 Test Loss: 1.443 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7312467098236084
Epoch: 17, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399985).  Saving model ...
Epoch: 18 cost time: 0.7120156288146973
Epoch: 18, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7597477436065674
Epoch: 19, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.582 Vali Acc: 0.400 Test Loss: 1.582 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6949512958526611
Epoch: 20, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.624 Vali Acc: 0.333 Test Loss: 1.624 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7032454013824463
Epoch: 21, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.666 Vali Acc: 0.400 Test Loss: 1.666 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7136552333831787
Epoch: 22, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.706 Vali Acc: 0.400 Test Loss: 1.706 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7132341861724854
Epoch: 23, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.745 Vali Acc: 0.333 Test Loss: 1.745 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7161080837249756
Epoch: 24, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.783 Vali Acc: 0.333 Test Loss: 1.783 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6971161365509033
Epoch: 25, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.821 Vali Acc: 0.333 Test Loss: 1.821 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6999666690826416
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.859 Vali Acc: 0.333 Test Loss: 1.859 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6789312362670898
Epoch: 27, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.895 Vali Acc: 0.333 Test Loss: 1.895 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9908721446990967
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.582045316696167
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6168534755706787
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6913754940032959
Epoch: 4, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6808102130889893
Epoch: 5, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7603631019592285
Epoch: 6, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6246426105499268
Epoch: 7, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6431503295898438
Epoch: 8, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.624584436416626
Epoch: 9, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5907971858978271
Epoch: 10, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5719165802001953
Epoch: 11, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5939786434173584
Epoch: 12, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.277 Vali Acc: 0.200 Test Loss: 1.277 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8931503295898438
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5908637046813965
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5904076099395752
Epoch: 3, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5645432472229004
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5478813648223877
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.576425313949585
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5768795013427734
Epoch: 7, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5808520317077637
Epoch: 8, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7031071186065674
Epoch: 9, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6299777030944824
Epoch: 10, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6262385845184326
Epoch: 11, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2306082248687744
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.220 Vali Acc: 0.133 Test Loss: 1.220 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7065224647521973
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.7878966331481934
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8191494941711426
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.7158257961273193
Epoch: 5, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8295760154724121
Epoch: 6, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.255 Vali Acc: 0.133 Test Loss: 1.255 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6910831928253174
Epoch: 7, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.275 Vali Acc: 0.133 Test Loss: 1.275 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.696458101272583
Epoch: 8, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7318305969238281
Epoch: 9, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.329 Vali Acc: 0.200 Test Loss: 1.329 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7692747116088867
Epoch: 10, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.363 Vali Acc: 0.133 Test Loss: 1.363 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7521793842315674
Epoch: 11, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.403 Vali Acc: 0.133 Test Loss: 1.403 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7186145782470703
Epoch: 12, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.448 Vali Acc: 0.133 Test Loss: 1.448 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7151942253112793
Epoch: 13, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.497 Vali Acc: 0.133 Test Loss: 1.497 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7954361438751221
Epoch: 14, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.552 Vali Acc: 0.133 Test Loss: 1.552 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8078932762145996
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6525106430053711
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7053864002227783
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6731662750244141
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6356639862060547
Epoch: 5, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6168942451477051
Epoch: 6, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6231791973114014
Epoch: 7, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.633112907409668
Epoch: 8, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5954432487487793
Epoch: 9, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6294209957122803
Epoch: 10, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6342198848724365
Epoch: 11, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6777307987213135
Epoch: 12, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6244111061096191
Epoch: 13, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6133770942687988
Epoch: 14, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6498408317565918
Epoch: 15, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6132919788360596
Epoch: 16, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.278 Vali Acc: 0.200 Test Loss: 1.278 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6560263633728027
Epoch: 17, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.968310832977295
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7053399085998535
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.7023425102233887
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.6929106712341309
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.145 Vali Acc: 0.067 Test Loss: 1.145 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7296874523162842
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 6 cost time: 0.6309828758239746
Epoch: 6, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 7 cost time: 0.6070115566253662
Epoch: 7, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.6885354518890381
Epoch: 8, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.6821012496948242
Epoch: 9, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6617071628570557
Epoch: 10, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6520788669586182
Epoch: 11, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.741093635559082
Epoch: 12, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7483723163604736
Epoch: 13, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6676719188690186
Epoch: 14, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7696254253387451
Epoch: 15, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.7658958435058594
Epoch: 16, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.680722713470459
Epoch: 17, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7166862487792969
Epoch: 18, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6420986652374268
Epoch: 19, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.6573455333709717
Epoch: 20, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6982812881469727
Epoch: 21, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.227 Vali Acc: 0.533 Test Loss: 1.227 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 22 cost time: 0.7053167819976807
Epoch: 22, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6913254261016846
Epoch: 23, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8036746978759766
Epoch: 24, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7330472469329834
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6697897911071777
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.289 Vali Acc: 0.467 Test Loss: 1.289 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6791591644287109
Epoch: 27, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.302 Vali Acc: 0.467 Test Loss: 1.302 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6626343727111816
Epoch: 28, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.467 Test Loss: 1.315 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7382822036743164
Epoch: 29, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.467 Test Loss: 1.327 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6618351936340332
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.467 Test Loss: 1.339 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7026803493499756
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.467 Test Loss: 1.350 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9245526790618896
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5840620994567871
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6958441734313965
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.6327903270721436
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6275131702423096
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5959742069244385
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6737508773803711
Epoch: 7, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6943483352661133
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7207803726196289
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.6889512538909912
Epoch: 10, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.668053150177002
Epoch: 11, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6603012084960938
Epoch: 12, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6576626300811768
Epoch: 13, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.714040994644165
Epoch: 14, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.633171796798706
Epoch: 15, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6969902515411377
Epoch: 16, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6287055015563965
Epoch: 17, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6571485996246338
Epoch: 18, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6504805088043213
Epoch: 19, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9783711433410645
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6689116954803467
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6825075149536133
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7119812965393066
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7262427806854248
Epoch: 5, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7092928886413574
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.7607839107513428
Epoch: 7, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.795661449432373
Epoch: 8, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6686289310455322
Epoch: 9, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6640849113464355
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6979777812957764
Epoch: 11, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.667109489440918
Epoch: 12, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6333544254302979
Epoch: 13, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6764397621154785
Epoch: 14, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.70223069190979
Epoch: 15, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.6822314262390137
Epoch: 16, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 0.7282848358154297
Epoch: 17, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 0.7121539115905762
Epoch: 18, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6877710819244385
Epoch: 19, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.7582845687866211
Epoch: 20, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 21 cost time: 0.6694216728210449
Epoch: 21, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6968297958374023
Epoch: 22, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.323 Vali Acc: 0.467 Test Loss: 1.323 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6621012687683105
Epoch: 23, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.350 Vali Acc: 0.467 Test Loss: 1.350 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.634068489074707
Epoch: 24, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.364 Vali Acc: 0.467 Test Loss: 1.364 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5938377380371094
Epoch: 25, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.370 Vali Acc: 0.467 Test Loss: 1.370 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6795163154602051
Epoch: 26, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.379 Vali Acc: 0.467 Test Loss: 1.379 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.598297119140625
Epoch: 27, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.392 Vali Acc: 0.467 Test Loss: 1.392 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6144003868103027
Epoch: 28, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.407 Vali Acc: 0.467 Test Loss: 1.407 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6391148567199707
Epoch: 29, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.429 Vali Acc: 0.533 Test Loss: 1.429 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533319).  Saving model ...
Epoch: 30 cost time: 0.6067745685577393
Epoch: 30, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.452 Vali Acc: 0.467 Test Loss: 1.452 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5932154655456543
Epoch: 31, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.474 Vali Acc: 0.467 Test Loss: 1.474 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.581732988357544
Epoch: 32, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.497 Vali Acc: 0.467 Test Loss: 1.497 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6276791095733643
Epoch: 33, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.520 Vali Acc: 0.533 Test Loss: 1.520 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5888407230377197
Epoch: 34, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.543 Vali Acc: 0.533 Test Loss: 1.543 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5910987854003906
Epoch: 35, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.565 Vali Acc: 0.533 Test Loss: 1.565 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6287667751312256
Epoch: 36, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.587 Vali Acc: 0.533 Test Loss: 1.587 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6038351058959961
Epoch: 37, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.607 Vali Acc: 0.533 Test Loss: 1.607 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6469769477844238
Epoch: 38, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.626 Vali Acc: 0.533 Test Loss: 1.626 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6293313503265381
Epoch: 39, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.533 Test Loss: 1.644 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.825645923614502
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.297 Vali Acc: 0.267 Test Loss: 1.297 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6908111572265625
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.637017011642456
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6146793365478516
Epoch: 4, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6309549808502197
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6553378105163574
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5529968738555908
Epoch: 7, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.294 Vali Acc: 0.133 Test Loss: 1.294 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5672800540924072
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.295 Vali Acc: 0.133 Test Loss: 1.295 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6869688034057617
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.296 Vali Acc: 0.133 Test Loss: 1.296 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5621304512023926
Epoch: 10, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.299 Vali Acc: 0.133 Test Loss: 1.299 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6789102554321289
Epoch: 11, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7296431064605713
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.305 Vali Acc: 0.133 Test Loss: 1.305 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 683459
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.935692548751831
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7065041065216064
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6879758834838867
Epoch: 3, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7094216346740723
Epoch: 4, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7402946949005127
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6819689273834229
Epoch: 6, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6795370578765869
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7270779609680176
Epoch: 8, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7370204925537109
Epoch: 9, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6674048900604248
Epoch: 10, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.722836971282959
Epoch: 11, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8805208206176758
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6483829021453857
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6940693855285645
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6252360343933105
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6612062454223633
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7088372707366943
Epoch: 6, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6944503784179688
Epoch: 7, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6818838119506836
Epoch: 8, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.76104736328125
Epoch: 9, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.725977897644043
Epoch: 10, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.67462158203125
Epoch: 11, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9633097648620605
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6741414070129395
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6714205741882324
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6978697776794434
Epoch: 4, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6450111865997314
Epoch: 5, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7052838802337646
Epoch: 6, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6174099445343018
Epoch: 7, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6157634258270264
Epoch: 8, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6619081497192383
Epoch: 9, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6537685394287109
Epoch: 10, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7097768783569336
Epoch: 11, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.712317705154419
Epoch: 12, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6823370456695557
Epoch: 13, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8130791187286377
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.678868293762207
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7280778884887695
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6887516975402832
Epoch: 4, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6729683876037598
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6809723377227783
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.673893928527832
Epoch: 7, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6461355686187744
Epoch: 8, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7358932495117188
Epoch: 9, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6800858974456787
Epoch: 10, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7907166481018066
Epoch: 11, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6995606422424316
Epoch: 12, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6608777046203613
Epoch: 13, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.652393102645874
Epoch: 14, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7997069358825684
Epoch: 1, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6267447471618652
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.134 Vali Acc: 0.133 Test Loss: 1.134 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6308748722076416
Epoch: 3, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6603968143463135
Epoch: 4, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6559622287750244
Epoch: 5, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6970345973968506
Epoch: 6, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6280360221862793
Epoch: 7, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6829822063446045
Epoch: 8, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5651586055755615
Epoch: 9, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.6689906120300293
Epoch: 10, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6102414131164551
Epoch: 11, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.335 Vali Acc: 0.200 Test Loss: 1.335 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.568047285079956
Epoch: 12, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.385 Vali Acc: 0.200 Test Loss: 1.385 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6070818901062012
Epoch: 13, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.440 Vali Acc: 0.200 Test Loss: 1.440 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6362392902374268
Epoch: 14, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.500 Vali Acc: 0.133 Test Loss: 1.500 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6835191249847412
Epoch: 15, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.563 Vali Acc: 0.133 Test Loss: 1.563 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6703925132751465
Epoch: 16, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.630 Vali Acc: 0.133 Test Loss: 1.630 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6770946979522705
Epoch: 17, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.700 Vali Acc: 0.133 Test Loss: 1.700 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6663763523101807
Epoch: 18, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.772 Vali Acc: 0.133 Test Loss: 1.772 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5934782028198242
Epoch: 19, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.845 Vali Acc: 0.133 Test Loss: 1.845 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0145442485809326
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6435286998748779
Epoch: 2, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.701819658279419
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8275692462921143
Epoch: 4, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.709374189376831
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7351701259613037
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7093994617462158
Epoch: 7, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7485902309417725
Epoch: 8, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7154245376586914
Epoch: 9, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8004434108734131
Epoch: 10, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7657351493835449
Epoch: 11, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7616991996765137
Epoch: 12, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7423546314239502
Epoch: 13, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.236553192138672
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7743113040924072
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7210738658905029
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6655731201171875
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.65460205078125
Epoch: 5, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6454236507415771
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6033520698547363
Epoch: 7, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7778153419494629
Epoch: 8, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7140612602233887
Epoch: 9, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6872282028198242
Epoch: 10, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7260980606079102
Epoch: 11, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6921725273132324
Epoch: 12, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.6901185512542725
Epoch: 13, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8669083118438721
Epoch: 14, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6589622497558594
Epoch: 15, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6317808628082275
Epoch: 16, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7199831008911133
Epoch: 17, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6987643241882324
Epoch: 18, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.124 Vali Acc: 0.600 Test Loss: 1.124 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.6229157447814941
Epoch: 19, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.129 Vali Acc: 0.667 Test Loss: 1.129 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666655).  Saving model ...
Epoch: 20 cost time: 0.6640310287475586
Epoch: 20, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.134 Vali Acc: 0.667 Test Loss: 1.134 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6392831802368164
Epoch: 21, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.142 Vali Acc: 0.667 Test Loss: 1.142 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7131800651550293
Epoch: 22, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.152 Vali Acc: 0.667 Test Loss: 1.152 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6648075580596924
Epoch: 23, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.162 Vali Acc: 0.667 Test Loss: 1.162 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.63582444190979
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.173 Vali Acc: 0.667 Test Loss: 1.173 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7075717449188232
Epoch: 25, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.667 Test Loss: 1.185 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5892734527587891
Epoch: 26, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.198 Vali Acc: 0.667 Test Loss: 1.198 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6535677909851074
Epoch: 27, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.212 Vali Acc: 0.667 Test Loss: 1.212 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6605331897735596
Epoch: 28, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.225 Vali Acc: 0.600 Test Loss: 1.225 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6635959148406982
Epoch: 29, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0785531997680664
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6455442905426025
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.713519811630249
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6918439865112305
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.625483512878418
Epoch: 5, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7136542797088623
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8043310642242432
Epoch: 7, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6429409980773926
Epoch: 8, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.6935462951660156
Epoch: 9, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.6510374546051025
Epoch: 10, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6816198825836182
Epoch: 11, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6801316738128662
Epoch: 12, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6553928852081299
Epoch: 13, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7257950305938721
Epoch: 14, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7667837142944336
Epoch: 15, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6222548484802246
Epoch: 16, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6403257846832275
Epoch: 17, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7247209548950195
Epoch: 18, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6187658309936523
Epoch: 19, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1053459644317627
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.7196323871612549
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.793790340423584
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7412803173065186
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.6907622814178467
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6546616554260254
Epoch: 6, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6356203556060791
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6488862037658691
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6631424427032471
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6587567329406738
Epoch: 10, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6815803050994873
Epoch: 11, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6394729614257812
Epoch: 12, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.728640079498291
Epoch: 13, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6877150535583496
Epoch: 14, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9647157192230225
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.6346218585968018
Epoch: 2, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7424304485321045
Epoch: 3, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7269730567932129
Epoch: 4, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7248227596282959
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7766401767730713
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6627833843231201
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7913506031036377
Epoch: 8, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7276501655578613
Epoch: 9, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7217097282409668
Epoch: 10, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6774148941040039
Epoch: 11, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 486851
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3452401161193848
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7578959465026855
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7521882057189941
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6468448638916016
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6880271434783936
Epoch: 5, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7311146259307861
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6444768905639648
Epoch: 7, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6723275184631348
Epoch: 8, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7001388072967529
Epoch: 9, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6342926025390625
Epoch: 10, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6576559543609619
Epoch: 11, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6648819446563721
Epoch: 12, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.630812406539917
Epoch: 13, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.968895435333252
Epoch: 1, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.644113302230835
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7074172496795654
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.640949010848999
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6867959499359131
Epoch: 5, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7283616065979004
Epoch: 6, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7007231712341309
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7700610160827637
Epoch: 8, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8300459384918213
Epoch: 9, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6799323558807373
Epoch: 10, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6861767768859863
Epoch: 11, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9388375282287598
Epoch: 1, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7585766315460205
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6759610176086426
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6878840923309326
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6669230461120605
Epoch: 5, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6871707439422607
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.729036808013916
Epoch: 7, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7198047637939453
Epoch: 8, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7437927722930908
Epoch: 9, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6752548217773438
Epoch: 10, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7405071258544922
Epoch: 11, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1400959491729736
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7506425380706787
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7816059589385986
Epoch: 3, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6379642486572266
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.695730447769165
Epoch: 5, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6580328941345215
Epoch: 6, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.622805118560791
Epoch: 7, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6285560131072998
Epoch: 8, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6180822849273682
Epoch: 9, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6547846794128418
Epoch: 10, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5975117683410645
Epoch: 11, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6414620876312256
Epoch: 12, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7556896209716797
Epoch: 13, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6124913692474365
Epoch: 14, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6587681770324707
Epoch: 15, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7187480926513672
Epoch: 16, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6556293964385986
Epoch: 17, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5928359031677246
Epoch: 18, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.593280553817749
Epoch: 19, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.225 Vali Acc: 0.467 Test Loss: 1.225 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5880265235900879
Epoch: 20, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6119389533996582
Epoch: 21, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.467 Test Loss: 1.278 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6294107437133789
Epoch: 22, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.306 Vali Acc: 0.467 Test Loss: 1.306 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6271629333496094
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.337 Vali Acc: 0.467 Test Loss: 1.337 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6250803470611572
Epoch: 24, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.370 Vali Acc: 0.467 Test Loss: 1.370 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.663240909576416
Epoch: 25, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.404 Vali Acc: 0.467 Test Loss: 1.404 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6051313877105713
Epoch: 26, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.437 Vali Acc: 0.467 Test Loss: 1.437 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6491227149963379
Epoch: 27, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.468 Vali Acc: 0.467 Test Loss: 1.468 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7273252010345459
Epoch: 28, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.498 Vali Acc: 0.467 Test Loss: 1.498 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1645755767822266
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6960783004760742
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6157922744750977
Epoch: 3, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6066906452178955
Epoch: 4, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6960740089416504
Epoch: 5, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6529173851013184
Epoch: 6, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6580934524536133
Epoch: 7, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7140367031097412
Epoch: 8, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6798617839813232
Epoch: 9, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.255 Vali Acc: 0.200 Test Loss: 1.255 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7354505062103271
Epoch: 10, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7235922813415527
Epoch: 11, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7485473155975342
Epoch: 12, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.357 Vali Acc: 0.200 Test Loss: 1.357 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6689839363098145
Epoch: 13, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.403 Vali Acc: 0.200 Test Loss: 1.403 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.737199068069458
Epoch: 14, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9943492412567139
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6553299427032471
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6740243434906006
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7928860187530518
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6019079685211182
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6766664981842041
Epoch: 6, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6798043251037598
Epoch: 7, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6357519626617432
Epoch: 8, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5889651775360107
Epoch: 9, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6651432514190674
Epoch: 10, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5901908874511719
Epoch: 11, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.025263547897339
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.577608585357666
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.6554241180419922
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6132981777191162
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6345126628875732
Epoch: 5, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6974952220916748
Epoch: 6, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7272145748138428
Epoch: 7, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6584444046020508
Epoch: 8, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7889692783355713
Epoch: 9, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6082625389099121
Epoch: 10, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6367287635803223
Epoch: 11, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6624763011932373
Epoch: 12, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.136518955230713
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.638056755065918
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7105050086975098
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7282466888427734
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7304248809814453
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6951930522918701
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7327041625976562
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.7616581916809082
Epoch: 8, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7380592823028564
Epoch: 9, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.6995875835418701
Epoch: 10, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.760495662689209
Epoch: 11, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.7270071506500244
Epoch: 12, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.623206377029419
Epoch: 13, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7041501998901367
Epoch: 14, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6502466201782227
Epoch: 15, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6672265529632568
Epoch: 16, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6762502193450928
Epoch: 17, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.728182315826416
Epoch: 18, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6970279216766357
Epoch: 19, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.694730281829834
Epoch: 20, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6960923671722412
Epoch: 21, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7290880680084229
Epoch: 22, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.04242205619812
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6117696762084961
Epoch: 2, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6474225521087646
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6145415306091309
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6804332733154297
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5838508605957031
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6053493022918701
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5748395919799805
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5563228130340576
Epoch: 9, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6440763473510742
Epoch: 10, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5951192378997803
Epoch: 11, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6080732345581055
Epoch: 12, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6168782711029053
Epoch: 13, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.161 Vali Acc: 0.533 Test Loss: 1.161 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.6309864521026611
Epoch: 14, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6467492580413818
Epoch: 15, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6516401767730713
Epoch: 16, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5643348693847656
Epoch: 17, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.176 Vali Acc: 0.533 Test Loss: 1.176 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5901565551757812
Epoch: 18, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6013305187225342
Epoch: 19, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.200 Vali Acc: 0.533 Test Loss: 1.200 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5946714878082275
Epoch: 20, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.622072696685791
Epoch: 21, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.257 Vali Acc: 0.533 Test Loss: 1.257 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6842803955078125
Epoch: 22, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7286844253540039
Epoch: 23, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.316 Vali Acc: 0.533 Test Loss: 1.316 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1125669479370117
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6623358726501465
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7212011814117432
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7223343849182129
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7721376419067383
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.729935884475708
Epoch: 6, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7540891170501709
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7042763233184814
Epoch: 8, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6837327480316162
Epoch: 9, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8058810234069824
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7365996837615967
Epoch: 11, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7213492393493652
Epoch: 12, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6975076198577881
Epoch: 13, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6502282619476318
Epoch: 14, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 388547
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.08453631401062
Epoch: 1, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.6602134704589844
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7311198711395264
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6897017955780029
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6930646896362305
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7044727802276611
Epoch: 6, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7245526313781738
Epoch: 7, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.717134952545166
Epoch: 8, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.718796968460083
Epoch: 9, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6440434455871582
Epoch: 10, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7577121257781982
Epoch: 11, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9765636920928955
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6701807975769043
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6932387351989746
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7527801990509033
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7402689456939697
Epoch: 5, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6773195266723633
Epoch: 6, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8115668296813965
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8042542934417725
Epoch: 8, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8775687217712402
Epoch: 9, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7889888286590576
Epoch: 10, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7877285480499268
Epoch: 11, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.161165952682495
Epoch: 1, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7113125324249268
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7217340469360352
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7007102966308594
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7047972679138184
Epoch: 5, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6443583965301514
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6227967739105225
Epoch: 7, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7061605453491211
Epoch: 8, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5906720161437988
Epoch: 9, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5693972110748291
Epoch: 10, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.668529748916626
Epoch: 11, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.059086322784424
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5845623016357422
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6096723079681396
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5903997421264648
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6244707107543945
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6082606315612793
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5938329696655273
Epoch: 7, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6391615867614746
Epoch: 8, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5814599990844727
Epoch: 9, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.6237754821777344
Epoch: 10, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6312477588653564
Epoch: 11, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.589780330657959
Epoch: 12, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6507847309112549
Epoch: 13, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6599686145782471
Epoch: 14, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.561417818069458
Epoch: 15, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5589315891265869
Epoch: 16, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6251661777496338
Epoch: 17, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7236058712005615
Epoch: 18, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.596062183380127
Epoch: 19, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9898107051849365
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6618351936340332
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7303528785705566
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7522389888763428
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7258584499359131
Epoch: 5, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6712524890899658
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6506361961364746
Epoch: 7, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6606879234313965
Epoch: 8, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.624431848526001
Epoch: 9, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6670982837677002
Epoch: 10, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7284853458404541
Epoch: 11, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6710822582244873
Epoch: 12, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7050023078918457
Epoch: 13, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7091951370239258
Epoch: 14, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7997725009918213
Epoch: 15, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.341 Vali Acc: 0.267 Test Loss: 1.341 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7578086853027344
Epoch: 16, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.393 Vali Acc: 0.200 Test Loss: 1.393 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7095420360565186
Epoch: 17, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.448 Vali Acc: 0.200 Test Loss: 1.448 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7466633319854736
Epoch: 18, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.507 Vali Acc: 0.133 Test Loss: 1.507 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0933308601379395
Epoch: 1, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.65859055519104
Epoch: 2, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5639290809631348
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.596541166305542
Epoch: 4, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.6154270172119141
Epoch: 5, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.592350959777832
Epoch: 6, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.703913688659668
Epoch: 7, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6562159061431885
Epoch: 8, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6318514347076416
Epoch: 9, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.140 Vali Acc: 0.600 Test Loss: 1.140 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6963162422180176
Epoch: 10, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.158 Vali Acc: 0.600 Test Loss: 1.158 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6105468273162842
Epoch: 11, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6361818313598633
Epoch: 12, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.205 Vali Acc: 0.533 Test Loss: 1.205 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6980006694793701
Epoch: 13, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.226 Vali Acc: 0.533 Test Loss: 1.226 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.589385986328125
Epoch: 14, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.247 Vali Acc: 0.467 Test Loss: 1.247 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0497941970825195
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5922024250030518
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6537706851959229
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6593868732452393
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5992884635925293
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6264820098876953
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5937745571136475
Epoch: 7, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5832335948944092
Epoch: 8, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5610373020172119
Epoch: 9, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6590578556060791
Epoch: 10, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5741119384765625
Epoch: 11, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6032898426055908
Epoch: 12, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6309449672698975
Epoch: 13, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6251776218414307
Epoch: 14, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6254398822784424
Epoch: 15, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.578862190246582
Epoch: 16, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6054954528808594
Epoch: 17, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6531205177307129
Epoch: 18, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.6421303749084473
Epoch: 19, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.686561107635498
Epoch: 20, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.624622106552124
Epoch: 21, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6508166790008545
Epoch: 22, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6046125888824463
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.193 Vali Acc: 0.533 Test Loss: 1.193 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6297345161437988
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 25 cost time: 0.6350862979888916
Epoch: 25, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.212 Vali Acc: 0.600 Test Loss: 1.212 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6285157203674316
Epoch: 26, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.223 Vali Acc: 0.600 Test Loss: 1.223 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7223861217498779
Epoch: 27, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.234 Vali Acc: 0.600 Test Loss: 1.234 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6173899173736572
Epoch: 28, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.600 Test Loss: 1.245 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6679642200469971
Epoch: 29, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.256 Vali Acc: 0.600 Test Loss: 1.256 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6785907745361328
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5876743793487549
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.278 Vali Acc: 0.600 Test Loss: 1.278 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7183759212493896
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.600 Test Loss: 1.288 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6129443645477295
Epoch: 33, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.600 Test Loss: 1.298 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.65242600440979
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.533 Test Loss: 1.308 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1301915645599365
Epoch: 1, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6722071170806885
Epoch: 2, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6043639183044434
Epoch: 3, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7386891841888428
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6420938968658447
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6905684471130371
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6204242706298828
Epoch: 7, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.6937084197998047
Epoch: 8, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7027237415313721
Epoch: 9, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6251301765441895
Epoch: 10, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6999952793121338
Epoch: 11, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6532759666442871
Epoch: 12, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.678929328918457
Epoch: 13, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6355161666870117
Epoch: 14, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7200355529785156
Epoch: 15, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7674105167388916
Epoch: 16, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6791403293609619
Epoch: 17, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7340455055236816
Epoch: 18, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6040711402893066
Epoch: 19, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.04089093208313
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6310267448425293
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6812543869018555
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6307368278503418
Epoch: 4, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.63448166847229
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.6484324932098389
Epoch: 6, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.645014762878418
Epoch: 7, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.7149415016174316
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6290538311004639
Epoch: 9, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7112832069396973
Epoch: 10, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7390496730804443
Epoch: 11, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7711081504821777
Epoch: 12, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7172467708587646
Epoch: 13, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7028460502624512
Epoch: 14, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 0.6987240314483643
Epoch: 15, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7426424026489258
Epoch: 16, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6340312957763672
Epoch: 17, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7269062995910645
Epoch: 18, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.228 Vali Acc: 0.467 Test Loss: 1.228 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 19 cost time: 0.7065839767456055
Epoch: 19, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533321).  Saving model ...
Epoch: 20 cost time: 0.6840188503265381
Epoch: 20, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8316574096679688
Epoch: 21, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.240 Vali Acc: 0.467 Test Loss: 1.240 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6840531826019287
Epoch: 22, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.731884241104126
Epoch: 23, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7429530620574951
Epoch: 24, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6861898899078369
Epoch: 25, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.709052324295044
Epoch: 26, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.327 Vali Acc: 0.533 Test Loss: 1.327 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7764067649841309
Epoch: 27, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.366 Vali Acc: 0.533 Test Loss: 1.366 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.713409423828125
Epoch: 28, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.412 Vali Acc: 0.533 Test Loss: 1.412 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8234262466430664
Epoch: 29, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.458 Vali Acc: 0.533 Test Loss: 1.458 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.863981008529663
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6435885429382324
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6472258567810059
Epoch: 3, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6362333297729492
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7529735565185547
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6894822120666504
Epoch: 6, Steps: 1 | Train Loss: 1.304 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7206635475158691
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6683425903320312
Epoch: 8, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6580705642700195
Epoch: 9, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6603059768676758
Epoch: 10, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6832988262176514
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6544065475463867
Epoch: 12, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 339395
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9418437480926514
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5841343402862549
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6035676002502441
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6305751800537109
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6374828815460205
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5729210376739502
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6713578701019287
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.593083381652832
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6377944946289062
Epoch: 9, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6414201259613037
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6092262268066406
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.608496904373169
Epoch: 12, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.587641716003418
Epoch: 13, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.661487340927124
Epoch: 14, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6273562908172607
Epoch: 15, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6411335468292236
Epoch: 16, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6308300495147705
Epoch: 17, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6976580619812012
Epoch: 18, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6919498443603516
Epoch: 19, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6567163467407227
Epoch: 20, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7237133979797363
Epoch: 21, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.660956621170044
Epoch: 22, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.591454029083252
Epoch: 23, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.129147529602051
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6892783641815186
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6328608989715576
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6562519073486328
Epoch: 4, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6660263538360596
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6211328506469727
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7060267925262451
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6292243003845215
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6945827007293701
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6417741775512695
Epoch: 10, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6404364109039307
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9188649654388428
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6722567081451416
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.640526294708252
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6909899711608887
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6929092407226562
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.6234431266784668
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5906269550323486
Epoch: 7, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6114339828491211
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6807646751403809
Epoch: 9, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6986813545227051
Epoch: 10, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6618392467498779
Epoch: 11, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6708180904388428
Epoch: 12, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6402642726898193
Epoch: 13, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6743512153625488
Epoch: 14, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.628964900970459
Epoch: 15, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.5954508781433105
Epoch: 16, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6308588981628418
Epoch: 17, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.610734224319458
Epoch: 18, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6385571956634521
Epoch: 19, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6028387546539307
Epoch: 20, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6163473129272461
Epoch: 21, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6267476081848145
Epoch: 22, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6807124614715576
Epoch: 23, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6502482891082764
Epoch: 24, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6072804927825928
Epoch: 25, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.384 Vali Acc: 0.333 Test Loss: 1.384 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.173818588256836
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6783788204193115
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.754755973815918
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7061970233917236
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6723883152008057
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.685744047164917
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6263275146484375
Epoch: 7, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6911373138427734
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.245 Vali Acc: 0.133 Test Loss: 1.245 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7781274318695068
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.248 Vali Acc: 0.133 Test Loss: 1.248 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6176402568817139
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6915056705474854
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1734423637390137
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6608254909515381
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7095670700073242
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7184550762176514
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6273210048675537
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6937079429626465
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6195809841156006
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.684016227722168
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.644428014755249
Epoch: 9, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6827499866485596
Epoch: 10, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6589446067810059
Epoch: 11, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6246585845947266
Epoch: 12, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6425011157989502
Epoch: 13, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6898317337036133
Epoch: 14, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.281 Vali Acc: 0.133 Test Loss: 1.281 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.819981336593628
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7064580917358398
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6792259216308594
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6243164539337158
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6931514739990234
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5742363929748535
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6350784301757812
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6378185749053955
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6264512538909912
Epoch: 9, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6121609210968018
Epoch: 10, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6571357250213623
Epoch: 11, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.576829195022583
Epoch: 12, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.641977071762085
Epoch: 13, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6826846599578857
Epoch: 14, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6020636558532715
Epoch: 15, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6685800552368164
Epoch: 16, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6328496932983398
Epoch: 17, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6494040489196777
Epoch: 18, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.631415605545044
Epoch: 19, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5875668525695801
Epoch: 20, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6186506748199463
Epoch: 21, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8945386409759521
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6571166515350342
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6250684261322021
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6405441761016846
Epoch: 4, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6400260925292969
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5875520706176758
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.703911304473877
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6969020366668701
Epoch: 8, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7280557155609131
Epoch: 9, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7827761173248291
Epoch: 10, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.69169020652771
Epoch: 11, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6664490699768066
Epoch: 12, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7235314846038818
Epoch: 13, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6461098194122314
Epoch: 14, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.6750748157501221
Epoch: 15, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7395615577697754
Epoch: 16, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7239630222320557
Epoch: 17, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7216498851776123
Epoch: 18, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7298569679260254
Epoch: 19, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7207181453704834
Epoch: 20, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7311010360717773
Epoch: 21, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 22 cost time: 0.7449679374694824
Epoch: 22, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.7852704524993896
Epoch: 23, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6967220306396484
Epoch: 24, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.692908763885498
Epoch: 25, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7780704498291016
Epoch: 26, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8281996250152588
Epoch: 27, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7428414821624756
Epoch: 28, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7404282093048096
Epoch: 29, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7198941707611084
Epoch: 30, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7820043563842773
Epoch: 31, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.66007399559021
Epoch: 32, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7721238136291504
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.567014217376709
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.567840576171875
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6370880603790283
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6245157718658447
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6571168899536133
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6049902439117432
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6022357940673828
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.625117301940918
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6653232574462891
Epoch: 10, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5990173816680908
Epoch: 11, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6077530384063721
Epoch: 12, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8791232109069824
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6289222240447998
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6492877006530762
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5899207592010498
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6597316265106201
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5938937664031982
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5897738933563232
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6637811660766602
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6522939205169678
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.6019773483276367
Epoch: 10, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.6534957885742188
Epoch: 11, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.5934062004089355
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.6258199214935303
Epoch: 13, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6725001335144043
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6592080593109131
Epoch: 15, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6709258556365967
Epoch: 16, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6798913478851318
Epoch: 17, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6351728439331055
Epoch: 18, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5949757099151611
Epoch: 19, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6489920616149902
Epoch: 20, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.63712477684021
Epoch: 21, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7485404014587402
Epoch: 22, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9205968379974365
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6179018020629883
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6002628803253174
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6424729824066162
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7295129299163818
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.636197566986084
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7219691276550293
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7638211250305176
Epoch: 8, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6607871055603027
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6449522972106934
Epoch: 10, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6400182247161865
Epoch: 11, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.6951472759246826
Epoch: 12, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7303957939147949
Epoch: 13, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6941077709197998
Epoch: 14, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7292361259460449
Epoch: 15, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7077500820159912
Epoch: 16, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6440949440002441
Epoch: 17, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6762690544128418
Epoch: 18, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6783251762390137
Epoch: 19, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6425116062164307
Epoch: 20, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6848924160003662
Epoch: 21, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 497379
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1325600147247314
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.7138121128082275
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.7450940608978271
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7534451484680176
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7725174427032471
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6986124515533447
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7264754772186279
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.716724157333374
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8705651760101318
Epoch: 9, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.715512752532959
Epoch: 10, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8638551235198975
Epoch: 11, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7437658309936523
Epoch: 12, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0416176319122314
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6420080661773682
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6686444282531738
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6820309162139893
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6550228595733643
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7049615383148193
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6229708194732666
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6459925174713135
Epoch: 8, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6067757606506348
Epoch: 9, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6066727638244629
Epoch: 10, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5937819480895996
Epoch: 11, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6368978023529053
Epoch: 12, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5977833271026611
Epoch: 13, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5717413425445557
Epoch: 14, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5625309944152832
Epoch: 15, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6010401248931885
Epoch: 16, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5703294277191162
Epoch: 17, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.598698616027832
Epoch: 18, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6011993885040283
Epoch: 19, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5932440757751465
Epoch: 20, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6142163276672363
Epoch: 21, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8504657745361328
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5296213626861572
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5926988124847412
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.544238805770874
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6397750377655029
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6982049942016602
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6372969150543213
Epoch: 7, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6258373260498047
Epoch: 8, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.637596845626831
Epoch: 9, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5878818035125732
Epoch: 10, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5962755680084229
Epoch: 11, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.609623908996582
Epoch: 12, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5670442581176758
Epoch: 13, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5800192356109619
Epoch: 14, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6294059753417969
Epoch: 15, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5715348720550537
Epoch: 16, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6353521347045898
Epoch: 17, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6582088470458984
Epoch: 18, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7503952980041504
Epoch: 19, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7088222503662109
Epoch: 20, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6414365768432617
Epoch: 21, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0680294036865234
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6811046600341797
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7178843021392822
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.632136344909668
Epoch: 4, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6714973449707031
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6846506595611572
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7021713256835938
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6689181327819824
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6451866626739502
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6782999038696289
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.640162467956543
Epoch: 11, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6692259311676025
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6210501194000244
Epoch: 13, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6319601535797119
Epoch: 14, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.636591911315918
Epoch: 15, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5890955924987793
Epoch: 16, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5824472904205322
Epoch: 17, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6713321208953857
Epoch: 18, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9714133739471436
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5885281562805176
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6692171096801758
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.641411542892456
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6600663661956787
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6599330902099609
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7159929275512695
Epoch: 7, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7589623928070068
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6622791290283203
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6420531272888184
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7017393112182617
Epoch: 11, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6741442680358887
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.866917610168457
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7015254497528076
Epoch: 2, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6601502895355225
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6832613945007324
Epoch: 4, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6479895114898682
Epoch: 5, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6652927398681641
Epoch: 6, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6392316818237305
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.157 Vali Acc: 0.067 Test Loss: 1.157 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.699213981628418
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.161 Vali Acc: 0.067 Test Loss: 1.161 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6328480243682861
Epoch: 9, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.166 Vali Acc: 0.067 Test Loss: 1.166 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6847085952758789
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.172 Vali Acc: 0.067 Test Loss: 1.172 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7012624740600586
Epoch: 11, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.178 Vali Acc: 0.067 Test Loss: 1.178 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9472541809082031
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.676959753036499
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6449329853057861
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6866693496704102
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6416831016540527
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6501364707946777
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6004812717437744
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6105644702911377
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6538429260253906
Epoch: 9, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5890786647796631
Epoch: 10, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6252024173736572
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7202787399291992
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6891694068908691
Epoch: 13, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6503269672393799
Epoch: 14, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6415266990661621
Epoch: 15, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8195903301239014
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.6045935153961182
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.6461341381072998
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6723189353942871
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.645899772644043
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6592733860015869
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6042907238006592
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5561854839324951
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.5755751132965088
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.5540754795074463
Epoch: 10, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.6361541748046875
Epoch: 11, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.5849518775939941
Epoch: 12, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6009433269500732
Epoch: 13, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.632481575012207
Epoch: 14, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7300052642822266
Epoch: 15, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6206142902374268
Epoch: 16, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6423239707946777
Epoch: 17, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.709369421005249
Epoch: 18, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6555969715118408
Epoch: 19, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.661945104598999
Epoch: 20, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6775469779968262
Epoch: 21, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.013282299041748
Epoch: 1, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6275722980499268
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.652355432510376
Epoch: 3, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6632065773010254
Epoch: 4, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6750137805938721
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6857097148895264
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6584064960479736
Epoch: 7, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6956629753112793
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7298069000244141
Epoch: 9, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7235503196716309
Epoch: 10, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6423733234405518
Epoch: 11, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6975464820861816
Epoch: 12, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.634906530380249
Epoch: 13, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.6061418056488037
Epoch: 14, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.6469299793243408
Epoch: 15, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5596969127655029
Epoch: 16, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7130193710327148
Epoch: 17, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6423370838165283
Epoch: 18, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6758294105529785
Epoch: 19, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6291320323944092
Epoch: 20, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6703906059265137
Epoch: 21, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6468260288238525
Epoch: 22, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6083736419677734
Epoch: 23, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5572686195373535
Epoch: 24, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9002223014831543
Epoch: 1, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6390602588653564
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7502796649932861
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6173503398895264
Epoch: 4, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6584300994873047
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6381213665008545
Epoch: 6, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5971763134002686
Epoch: 7, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.60577392578125
Epoch: 8, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6590659618377686
Epoch: 9, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7274050712585449
Epoch: 10, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7489590644836426
Epoch: 11, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 300771
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8505346775054932
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6480123996734619
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.630253791809082
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7715277671813965
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8101680278778076
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7565619945526123
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7869079113006592
Epoch: 7, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6921415328979492
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7792532444000244
Epoch: 9, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6771624088287354
Epoch: 10, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7690362930297852
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6669118404388428
Epoch: 12, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.6761860847473145
Epoch: 13, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.541572093963623
Epoch: 14, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7205920219421387
Epoch: 15, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7818348407745361
Epoch: 16, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7529942989349365
Epoch: 17, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7054922580718994
Epoch: 18, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7307727336883545
Epoch: 19, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6575577259063721
Epoch: 20, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.631472110748291
Epoch: 21, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6256732940673828
Epoch: 22, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.858459234237671
Epoch: 1, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6225383281707764
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6257212162017822
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.182 Vali Acc: 0.133 Test Loss: 1.182 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6378483772277832
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.6803865432739258
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6769223213195801
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6600308418273926
Epoch: 7, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6663033962249756
Epoch: 8, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7177598476409912
Epoch: 9, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.7550175189971924
Epoch: 10, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7035012245178223
Epoch: 11, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6951436996459961
Epoch: 12, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.712561845779419
Epoch: 13, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.65981125831604
Epoch: 14, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7860064506530762
Epoch: 15, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7024283409118652
Epoch: 16, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6693160533905029
Epoch: 17, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6437854766845703
Epoch: 18, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.666196346282959
Epoch: 19, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.075590133666992
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7066948413848877
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7412762641906738
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6875150203704834
Epoch: 4, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7869973182678223
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.707484245300293
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6658976078033447
Epoch: 7, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6589295864105225
Epoch: 8, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6524500846862793
Epoch: 9, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6981580257415771
Epoch: 10, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6900267601013184
Epoch: 11, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9657509326934814
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7969896793365479
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6522417068481445
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.733339786529541
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7261037826538086
Epoch: 5, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7606344223022461
Epoch: 6, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7463953495025635
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7067687511444092
Epoch: 8, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6740889549255371
Epoch: 9, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.786510705947876
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6424736976623535
Epoch: 11, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7162609100341797
Epoch: 12, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6144874095916748
Epoch: 13, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.640125036239624
Epoch: 14, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6983771324157715
Epoch: 15, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6929833889007568
Epoch: 16, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6807754039764404
Epoch: 17, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6865847110748291
Epoch: 18, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7283575534820557
Epoch: 19, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7627003192901611
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6377573013305664
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6667783260345459
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6003537178039551
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6146652698516846
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6567850112915039
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.630103588104248
Epoch: 7, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6020002365112305
Epoch: 8, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5951540470123291
Epoch: 9, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5944070816040039
Epoch: 10, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5665218830108643
Epoch: 11, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.628082275390625
Epoch: 12, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0169923305511475
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6150150299072266
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.613847017288208
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6353886127471924
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6693766117095947
Epoch: 5, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6378440856933594
Epoch: 6, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6555085182189941
Epoch: 7, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6680283546447754
Epoch: 8, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6470911502838135
Epoch: 9, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7022593021392822
Epoch: 10, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6464729309082031
Epoch: 11, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7502903938293457
Epoch: 12, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.701636791229248
Epoch: 13, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7530562877655029
Epoch: 14, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.658240795135498
Epoch: 15, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7347233295440674
Epoch: 16, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.680971622467041
Epoch: 17, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7016658782958984
Epoch: 18, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6539645195007324
Epoch: 19, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5903337001800537
Epoch: 20, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9928994178771973
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6423096656799316
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6563513278961182
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6469423770904541
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6383993625640869
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.659616231918335
Epoch: 6, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6187460422515869
Epoch: 7, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.598006010055542
Epoch: 8, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6561934947967529
Epoch: 9, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.6306843757629395
Epoch: 10, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7037796974182129
Epoch: 11, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6802175045013428
Epoch: 12, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.8449106216430664
Epoch: 13, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.062 Vali Acc: 0.733 Test Loss: 1.062 Test Acc: 0.733
Validation loss decreased (-0.599989 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.6546456813812256
Epoch: 14, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.061 Vali Acc: 0.733 Test Loss: 1.061 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.6150832176208496
Epoch: 15, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.062 Vali Acc: 0.667 Test Loss: 1.062 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5831475257873535
Epoch: 16, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6729249954223633
Epoch: 17, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6194846630096436
Epoch: 18, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7096297740936279
Epoch: 19, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6806633472442627
Epoch: 20, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6261048316955566
Epoch: 21, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6712844371795654
Epoch: 22, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6215856075286865
Epoch: 23, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6822404861450195
Epoch: 24, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9682512283325195
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6922552585601807
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6774957180023193
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6977627277374268
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6498959064483643
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.642423152923584
Epoch: 6, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6808583736419678
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7068853378295898
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6979997158050537
Epoch: 9, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7319545745849609
Epoch: 10, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.7621595859527588
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.6819977760314941
Epoch: 12, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7017018795013428
Epoch: 13, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6890966892242432
Epoch: 14, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6992604732513428
Epoch: 15, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.6275746822357178
Epoch: 16, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.5920529365539551
Epoch: 17, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6077663898468018
Epoch: 18, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5632796287536621
Epoch: 19, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5941696166992188
Epoch: 20, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7272224426269531
Epoch: 21, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7134103775024414
Epoch: 22, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6234266757965088
Epoch: 23, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8297293186187744
Epoch: 24, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6946451663970947
Epoch: 25, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6492562294006348
Epoch: 26, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8399481773376465
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6946375370025635
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6273102760314941
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.682999849319458
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6669344902038574
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6895053386688232
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6676900386810303
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6841938495635986
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6402671337127686
Epoch: 9, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.6209704875946045
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.6167221069335938
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6215181350708008
Epoch: 12, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.6554238796234131
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6288454532623291
Epoch: 14, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6814608573913574
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.721060037612915
Epoch: 16, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7626810073852539
Epoch: 17, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7261078357696533
Epoch: 18, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 0.7204153537750244
Epoch: 19, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8775448799133301
Epoch: 20, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.8148558139801025
Epoch: 21, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.671720027923584
Epoch: 22, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6655073165893555
Epoch: 23, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.669823169708252
Epoch: 24, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7114236354827881
Epoch: 25, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6898229122161865
Epoch: 26, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.70810866355896
Epoch: 27, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7329344749450684
Epoch: 28, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.829310417175293
Epoch: 29, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8303468227386475
Epoch: 30, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8959438800811768
Epoch: 1, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6109116077423096
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6227273941040039
Epoch: 3, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.605039119720459
Epoch: 4, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6070923805236816
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6229574680328369
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5871503353118896
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.302 Vali Acc: 0.200 Test Loss: 1.302 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.632211446762085
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.304 Vali Acc: 0.200 Test Loss: 1.304 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5629005432128906
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6304647922515869
Epoch: 10, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6205816268920898
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 202467
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8267643451690674
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6175920963287354
Epoch: 2, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6198937892913818
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6652364730834961
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6381585597991943
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.687751293182373
Epoch: 6, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.654109001159668
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6598379611968994
Epoch: 8, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7418606281280518
Epoch: 9, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6336073875427246
Epoch: 10, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5943794250488281
Epoch: 11, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5783030986785889
Epoch: 12, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6374185085296631
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.103163003921509
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5845985412597656
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6901857852935791
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7166275978088379
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7744140625
Epoch: 5, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6476242542266846
Epoch: 6, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6625893115997314
Epoch: 7, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6877186298370361
Epoch: 8, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6994011402130127
Epoch: 9, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6867368221282959
Epoch: 10, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.713127613067627
Epoch: 11, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.879302978515625
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6040229797363281
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6420817375183105
Epoch: 3, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5914006233215332
Epoch: 4, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6038367748260498
Epoch: 5, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6600301265716553
Epoch: 6, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6314339637756348
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.717003583908081
Epoch: 8, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.725306510925293
Epoch: 9, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6507241725921631
Epoch: 10, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6665208339691162
Epoch: 11, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.909010410308838
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6013197898864746
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6704163551330566
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7147552967071533
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6562647819519043
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.641516923904419
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6051266193389893
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6184945106506348
Epoch: 8, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6245748996734619
Epoch: 9, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6804301738739014
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6090002059936523
Epoch: 11, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6658749580383301
Epoch: 12, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.690143346786499
Epoch: 13, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0787150859832764
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6592278480529785
Epoch: 2, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6498758792877197
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6879620552062988
Epoch: 4, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.705650806427002
Epoch: 5, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7572348117828369
Epoch: 6, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7124481201171875
Epoch: 7, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6894073486328125
Epoch: 8, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6957662105560303
Epoch: 9, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6573927402496338
Epoch: 10, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7051982879638672
Epoch: 11, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1178603172302246
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5166678428649902
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6305897235870361
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.6227319240570068
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.6574652194976807
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6397585868835449
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6117775440216064
Epoch: 7, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5966103076934814
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7359678745269775
Epoch: 9, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6968317031860352
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6590957641601562
Epoch: 11, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6493008136749268
Epoch: 12, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6315488815307617
Epoch: 13, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.674443244934082
Epoch: 14, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9847726821899414
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7582817077636719
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7665359973907471
Epoch: 3, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.590325117111206
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6651484966278076
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.732262372970581
Epoch: 6, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6064491271972656
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6563210487365723
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6019203662872314
Epoch: 9, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7064859867095947
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6726706027984619
Epoch: 11, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6832377910614014
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7045660018920898
Epoch: 13, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6908068656921387
Epoch: 14, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9804706573486328
Epoch: 1, Steps: 1 | Train Loss: 1.364 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6469893455505371
Epoch: 2, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6221239566802979
Epoch: 3, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.6545839309692383
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5979878902435303
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6826457977294922
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6579103469848633
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6674723625183105
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6593787670135498
Epoch: 9, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6909065246582031
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7281360626220703
Epoch: 11, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.744654655456543
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6210112571716309
Epoch: 13, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6713767051696777
Epoch: 14, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7002694606781006
Epoch: 15, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.5883572101593018
Epoch: 16, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.6023335456848145
Epoch: 17, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.6070723533630371
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5987679958343506
Epoch: 19, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6400666236877441
Epoch: 20, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6746389865875244
Epoch: 21, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6951189041137695
Epoch: 22, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7017905712127686
Epoch: 23, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6176183223724365
Epoch: 24, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.628779411315918
Epoch: 25, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6945693492889404
Epoch: 26, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6109421253204346
Epoch: 27, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6029605865478516
Epoch: 28, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6053154468536377
Epoch: 29, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6720495223999023
Epoch: 30, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.161 Vali Acc: 0.533 Test Loss: 1.161 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6341900825500488
Epoch: 31, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6572995185852051
Epoch: 32, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6161656379699707
Epoch: 33, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.210 Vali Acc: 0.533 Test Loss: 1.210 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.635596513748169
Epoch: 34, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.227 Vali Acc: 0.533 Test Loss: 1.227 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9288787841796875
Epoch: 1, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6191091537475586
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6715729236602783
Epoch: 3, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6747071743011475
Epoch: 4, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7011902332305908
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6860182285308838
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7259171009063721
Epoch: 7, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7647511959075928
Epoch: 8, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6811201572418213
Epoch: 9, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6916868686676025
Epoch: 10, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8012166023254395
Epoch: 11, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7101907730102539
Epoch: 12, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6861670017242432
Epoch: 13, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6606888771057129
Epoch: 14, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6621112823486328
Epoch: 15, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7033820152282715
Epoch: 16, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0787830352783203
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7107577323913574
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6496555805206299
Epoch: 3, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7187654972076416
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6847591400146484
Epoch: 5, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6276850700378418
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6161091327667236
Epoch: 7, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5889620780944824
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.651292085647583
Epoch: 9, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.603614091873169
Epoch: 10, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6106319427490234
Epoch: 11, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6068928241729736
Epoch: 12, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6394658088684082
Epoch: 13, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6449813842773438
Epoch: 14, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.701085090637207
Epoch: 15, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6289584636688232
Epoch: 16, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6762266159057617
Epoch: 17, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7266340255737305
Epoch: 18, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6273577213287354
Epoch: 19, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.619387149810791
Epoch: 20, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 153315
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         320                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9101788997650146
Epoch: 1, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.601628303527832
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5464315414428711
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.6239666938781738
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6219902038574219
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5971903800964355
Epoch: 6, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6089987754821777
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6359231472015381
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7461497783660889
Epoch: 9, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.68088698387146
Epoch: 10, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.677621603012085
Epoch: 11, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7576684951782227
Epoch: 12, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7348480224609375
Epoch: 13, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.703970193862915
Epoch: 14, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.710888147354126
Epoch: 15, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         256                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma256_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1340837478637695
Epoch: 1, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7056949138641357
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6978378295898438
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.7084126472473145
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6527976989746094
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7302184104919434
Epoch: 6, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6837894916534424
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7196502685546875
Epoch: 8, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.74068284034729
Epoch: 9, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7015879154205322
Epoch: 10, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.642122745513916
Epoch: 11, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.673872709274292
Epoch: 12, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6804182529449463
Epoch: 13, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.6581926345825195
Epoch: 14, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6785073280334473
Epoch: 15, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6369926929473877
Epoch: 16, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6701085567474365
Epoch: 17, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6353747844696045
Epoch: 18, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6123158931732178
Epoch: 19, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6304497718811035
Epoch: 20, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6038076877593994
Epoch: 21, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6572365760803223
Epoch: 22, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6637256145477295
Epoch: 23, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma256_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         192                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0144152641296387
Epoch: 1, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.680994987487793
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.6407599449157715
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6337966918945312
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6771769523620605
Epoch: 5, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7658026218414307
Epoch: 6, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7015907764434814
Epoch: 7, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6981370449066162
Epoch: 8, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6755077838897705
Epoch: 9, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6761703491210938
Epoch: 10, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6312739849090576
Epoch: 11, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.6650841236114502
Epoch: 12, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6856703758239746
Epoch: 13, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8605742454528809
Epoch: 14, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8836009502410889
Epoch: 15, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.755253791809082
Epoch: 16, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.782045841217041
Epoch: 17, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7643332481384277
Epoch: 18, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7704300880432129
Epoch: 19, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8300662040710449
Epoch: 20, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.7313947677612305
Epoch: 21, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6506681442260742
Epoch: 22, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7508087158203125
Epoch: 23, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6534364223480225
Epoch: 24, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6796483993530273
Epoch: 25, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.756925106048584
Epoch: 26, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7797656059265137
Epoch: 27, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7279224395751953
Epoch: 28, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7184524536132812
Epoch: 29, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7203526496887207
Epoch: 30, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         128                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0027055740356445
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5456974506378174
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5708029270172119
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6476871967315674
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6579201221466064
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6618185043334961
Epoch: 6, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.735541820526123
Epoch: 7, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.659348726272583
Epoch: 8, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6038510799407959
Epoch: 9, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6216621398925781
Epoch: 10, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6602122783660889
Epoch: 11, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6498584747314453
Epoch: 12, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6853885650634766
Epoch: 13, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6851639747619629
Epoch: 14, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5827932357788086
Epoch: 15, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6333167552947998
Epoch: 16, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         64                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.931750774383545
Epoch: 1, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.249 Vali Acc: 0.067 Test Loss: 1.249 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.5889542102813721
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.251 Vali Acc: 0.067 Test Loss: 1.251 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6797192096710205
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.253 Vali Acc: 0.133 Test Loss: 1.253 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.579118013381958
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.257 Vali Acc: 0.133 Test Loss: 1.257 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.551098108291626
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.261 Vali Acc: 0.133 Test Loss: 1.261 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6492564678192139
Epoch: 6, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.267 Vali Acc: 0.133 Test Loss: 1.267 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6319789886474609
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6542441844940186
Epoch: 8, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.642848014831543
Epoch: 9, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.6493220329284668
Epoch: 10, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.307 Vali Acc: 0.200 Test Loss: 1.307 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6041915416717529
Epoch: 11, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.321 Vali Acc: 0.200 Test Loss: 1.321 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6436524391174316
Epoch: 12, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6454362869262695
Epoch: 13, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7052912712097168
Epoch: 14, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.373 Vali Acc: 0.200 Test Loss: 1.373 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6649911403656006
Epoch: 15, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.394 Vali Acc: 0.133 Test Loss: 1.394 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.688382625579834
Epoch: 16, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.418 Vali Acc: 0.133 Test Loss: 1.418 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6392679214477539
Epoch: 17, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.443 Vali Acc: 0.133 Test Loss: 1.443 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.650123119354248
Epoch: 18, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.470 Vali Acc: 0.133 Test Loss: 1.470 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6726987361907959
Epoch: 19, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.500 Vali Acc: 0.133 Test Loss: 1.500 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         32                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8877270221710205
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6188039779663086
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.648115873336792
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.688002347946167
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7334532737731934
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6771011352539062
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7290470600128174
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6970834732055664
Epoch: 8, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7018246650695801
Epoch: 9, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6938309669494629
Epoch: 10, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8562986850738525
Epoch: 11, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8598275184631348
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6311795711517334
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6540226936340332
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6918797492980957
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7286055088043213
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6844682693481445
Epoch: 6, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6830649375915527
Epoch: 7, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6291592121124268
Epoch: 8, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6196162700653076
Epoch: 9, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6548616886138916
Epoch: 10, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5964338779449463
Epoch: 11, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7222087383270264
Epoch: 12, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.9649584293365479
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5605013370513916
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7289435863494873
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.201 Vali Acc: 0.133 Test Loss: 1.201 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6422643661499023
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6365249156951904
Epoch: 5, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6350741386413574
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6756336688995361
Epoch: 7, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7022016048431396
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.6241116523742676
Epoch: 9, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.6437273025512695
Epoch: 10, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.64113450050354
Epoch: 11, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.6978893280029297
Epoch: 12, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 0.7777965068817139
Epoch: 13, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 0.7816483974456787
Epoch: 14, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 15 cost time: 0.7524771690368652
Epoch: 15, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.7293848991394043
Epoch: 16, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7235414981842041
Epoch: 17, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.766754150390625
Epoch: 18, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6726210117340088
Epoch: 19, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8040845394134521
Epoch: 20, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7986295223236084
Epoch: 21, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7347371578216553
Epoch: 22, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6793551445007324
Epoch: 23, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.695897102355957
Epoch: 24, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.748253345489502
Epoch: 25, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.149827003479004
Epoch: 1, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7029471397399902
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6904616355895996
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7152113914489746
Epoch: 4, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6445193290710449
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7056117057800293
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7122035026550293
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6972360610961914
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7492320537567139
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7126686573028564
Epoch: 10, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7009358406066895
Epoch: 11, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6747591495513916
Epoch: 12, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6852443218231201
Epoch: 13, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7650315761566162
Epoch: 14, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7264447212219238
Epoch: 15, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6875941753387451
Epoch: 16, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.6912617683410645
Epoch: 17, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.690758466720581
Epoch: 18, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6844611167907715
Epoch: 19, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7341604232788086
Epoch: 20, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.740044355392456
Epoch: 21, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7638168334960938
Epoch: 22, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.197 Vali Acc: 0.467 Test Loss: 1.197 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.6725842952728271
Epoch: 23, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.754990816116333
Epoch: 24, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7613503932952881
Epoch: 25, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.221 Vali Acc: 0.467 Test Loss: 1.221 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7062864303588867
Epoch: 26, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7719919681549072
Epoch: 27, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.248 Vali Acc: 0.533 Test Loss: 1.248 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 28 cost time: 0.8323180675506592
Epoch: 28, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.264 Vali Acc: 0.533 Test Loss: 1.264 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7101466655731201
Epoch: 29, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.275 Vali Acc: 0.533 Test Loss: 1.275 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6209256649017334
Epoch: 30, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.730076789855957
Epoch: 31, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.298 Vali Acc: 0.467 Test Loss: 1.298 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7870340347290039
Epoch: 32, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.732431173324585
Epoch: 33, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.303 Vali Acc: 0.533 Test Loss: 1.303 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.701251745223999
Epoch: 34, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.304 Vali Acc: 0.533 Test Loss: 1.304 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7048335075378418
Epoch: 35, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.305 Vali Acc: 0.533 Test Loss: 1.305 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6180837154388428
Epoch: 36, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.310 Vali Acc: 0.467 Test Loss: 1.310 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.611708402633667
Epoch: 37, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.320 Vali Acc: 0.467 Test Loss: 1.320 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 128739
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
fourier enhanced block used!
modes=32, index=[1, 2, 6, 9, 28, 36, 41, 48, 64, 79, 94, 95, 103, 118, 124, 129, 132, 133, 137, 138, 141, 158, 183, 197, 216, 220, 227, 235, 243, 244, 302, 314]
fourier enhanced block used!
modes=32, index=[2, 3, 17, 20, 24, 26, 30, 34, 38, 43, 45, 46, 62, 65, 68, 73, 78, 85, 87, 90, 99, 105, 118, 120, 121, 123, 127, 134, 144, 145, 154, 159]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 9, 17, 19, 20, 21, 22, 28, 32, 44, 59, 62, 64, 68, 70, 84, 86, 95, 99, 101, 102, 106, 115, 117, 122, 127, 129, 137, 144, 146, 148, 152]
modes_kv=32, index_kv=[12, 23, 38, 59, 62, 63, 88, 92, 93, 97, 102, 114, 120, 122, 128, 133, 134, 137, 146, 178, 200, 201, 227, 245, 250, 254, 261, 263, 265, 269, 291, 292]
>>>>>>>start training : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.0755457878112793
Epoch: 1, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7211191654205322
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6982426643371582
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6844534873962402
Epoch: 4, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6778545379638672
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7002525329589844
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6826322078704834
Epoch: 7, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7282242774963379
Epoch: 8, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7039523124694824
Epoch: 9, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7432131767272949
Epoch: 10, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.722470760345459
Epoch: 11, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7452290058135986
Epoch: 12, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6806731224060059
Epoch: 13, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8499646186828613
Epoch: 14, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_FEDformer_UEA_ftM_sl640_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 128739
model size : 1.74MB
