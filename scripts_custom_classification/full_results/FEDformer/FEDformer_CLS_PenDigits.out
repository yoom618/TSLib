Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6821453
	speed: 0.0674s/iter; left time: 3154.8294s
	iters: 200, epoch: 1 | loss: 0.1929707
	speed: 0.0504s/iter; left time: 2351.7274s
	iters: 300, epoch: 1 | loss: 0.1123419
	speed: 0.0549s/iter; left time: 2557.4756s
	iters: 400, epoch: 1 | loss: 0.1504157
	speed: 0.0525s/iter; left time: 2441.5262s
Epoch: 1 cost time: 26.279829740524292
Epoch: 1, Steps: 469 | Train Loss: 0.293 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
Validation loss decreased (inf --> -0.932245).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0154017
	speed: 0.1724s/iter; left time: 7989.7385s
	iters: 200, epoch: 2 | loss: 1.0615658
	speed: 0.0504s/iter; left time: 2329.1563s
	iters: 300, epoch: 2 | loss: 0.1006584
	speed: 0.0501s/iter; left time: 2308.9336s
	iters: 400, epoch: 2 | loss: 0.0584834
	speed: 0.0570s/iter; left time: 2625.1067s
Epoch: 2 cost time: 25.512638092041016
Epoch: 2, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.441 Vali Acc: 0.934 Test Loss: 0.441 Test Acc: 0.934
Validation loss decreased (-0.932245 --> -0.934244).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0045571
	speed: 0.2832s/iter; left time: 12989.8773s
	iters: 200, epoch: 3 | loss: 0.0015611
	speed: 0.0607s/iter; left time: 2776.0116s
	iters: 300, epoch: 3 | loss: 0.1918674
	speed: 0.0625s/iter; left time: 2855.8595s
	iters: 400, epoch: 3 | loss: 0.0164228
	speed: 0.0681s/iter; left time: 3104.1629s
Epoch: 3 cost time: 31.16824984550476
Epoch: 3, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.261 Vali Acc: 0.939 Test Loss: 0.261 Test Acc: 0.939
Validation loss decreased (-0.934244 --> -0.938534).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0277404
	speed: 0.3048s/iter; left time: 13834.1924s
	iters: 200, epoch: 4 | loss: 0.1328035
	speed: 0.0689s/iter; left time: 3119.3169s
	iters: 300, epoch: 4 | loss: 0.9789876
	speed: 0.0690s/iter; left time: 3117.8034s
	iters: 400, epoch: 4 | loss: 0.1382811
	speed: 0.0678s/iter; left time: 3057.2221s
Epoch: 4 cost time: 32.45530033111572
Epoch: 4, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.938534 --> -0.950827).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5435119
	speed: 0.2839s/iter; left time: 12753.7116s
	iters: 200, epoch: 5 | loss: 0.1701037
	speed: 0.0655s/iter; left time: 2934.7504s
	iters: 300, epoch: 5 | loss: 0.2533264
	speed: 0.0614s/iter; left time: 2744.5557s
	iters: 400, epoch: 5 | loss: 0.7699049
	speed: 0.0637s/iter; left time: 2844.3542s
Epoch: 5 cost time: 29.90716242790222
Epoch: 5, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.950827 --> -0.952256).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0099670
	speed: 0.3007s/iter; left time: 13370.0493s
	iters: 200, epoch: 6 | loss: 0.0015337
	speed: 0.0699s/iter; left time: 3100.5217s
	iters: 300, epoch: 6 | loss: 0.0011079
	speed: 0.0686s/iter; left time: 3037.1798s
	iters: 400, epoch: 6 | loss: 0.0073613
	speed: 0.0670s/iter; left time: 2956.3082s
Epoch: 6 cost time: 32.820929288864136
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.401 Vali Acc: 0.927 Test Loss: 0.401 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1032258
	speed: 0.3001s/iter; left time: 13198.6154s
	iters: 200, epoch: 7 | loss: 0.0433625
	speed: 0.0719s/iter; left time: 3155.2192s
	iters: 300, epoch: 7 | loss: 0.2980292
	speed: 0.0694s/iter; left time: 3038.2679s
	iters: 400, epoch: 7 | loss: 0.1955424
	speed: 0.0701s/iter; left time: 3063.2579s
Epoch: 7 cost time: 33.21389865875244
Epoch: 7, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0051990
	speed: 0.2803s/iter; left time: 12199.6156s
	iters: 200, epoch: 8 | loss: 0.0015673
	speed: 0.0676s/iter; left time: 2933.8267s
	iters: 300, epoch: 8 | loss: 0.0089016
	speed: 0.0650s/iter; left time: 2817.6986s
	iters: 400, epoch: 8 | loss: 0.0392653
	speed: 0.0708s/iter; left time: 3058.4092s
Epoch: 8 cost time: 32.036558866500854
Epoch: 8, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.411 Vali Acc: 0.918 Test Loss: 0.411 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0994846
	speed: 0.2850s/iter; left time: 12270.3453s
	iters: 200, epoch: 9 | loss: 0.0653325
	speed: 0.0742s/iter; left time: 3188.7887s
	iters: 300, epoch: 9 | loss: 0.0026857
	speed: 0.0714s/iter; left time: 3057.6775s
	iters: 400, epoch: 9 | loss: 0.1532488
	speed: 0.0700s/iter; left time: 2992.1769s
Epoch: 9 cost time: 33.743096351623535
Epoch: 9, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0002365
	speed: 0.3009s/iter; left time: 12813.6832s
	iters: 200, epoch: 10 | loss: 0.2835756
	speed: 0.0702s/iter; left time: 2983.9552s
	iters: 300, epoch: 10 | loss: 0.0000506
	speed: 0.0701s/iter; left time: 2969.2988s
	iters: 400, epoch: 10 | loss: 0.0040530
	speed: 0.0695s/iter; left time: 2939.6986s
Epoch: 10 cost time: 33.158594608306885
Epoch: 10, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.952256 --> -0.958832).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0110697
	speed: 0.2903s/iter; left time: 12224.7212s
	iters: 200, epoch: 11 | loss: 0.0045587
	speed: 0.0706s/iter; left time: 2965.8117s
	iters: 300, epoch: 11 | loss: 0.0000715
	speed: 0.0720s/iter; left time: 3018.7891s
	iters: 400, epoch: 11 | loss: 0.0063128
	speed: 0.0697s/iter; left time: 2912.7385s
Epoch: 11 cost time: 33.2595796585083
Epoch: 11, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.338 Vali Acc: 0.943 Test Loss: 0.338 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5271328
	speed: 0.2849s/iter; left time: 11865.5551s
	iters: 200, epoch: 12 | loss: 0.0017047
	speed: 0.0700s/iter; left time: 2908.8372s
	iters: 300, epoch: 12 | loss: 0.0006123
	speed: 0.0732s/iter; left time: 3032.9917s
	iters: 400, epoch: 12 | loss: 0.0178271
	speed: 0.0696s/iter; left time: 2877.6730s
Epoch: 12 cost time: 33.564645528793335
Epoch: 12, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0579870
	speed: 0.2995s/iter; left time: 12331.5684s
	iters: 200, epoch: 13 | loss: 0.0018091
	speed: 0.0668s/iter; left time: 2743.8402s
	iters: 300, epoch: 13 | loss: 0.0155600
	speed: 0.0689s/iter; left time: 2824.2516s
	iters: 400, epoch: 13 | loss: 0.0189573
	speed: 0.0667s/iter; left time: 2726.6700s
Epoch: 13 cost time: 31.952194452285767
Epoch: 13, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.233 Vali Acc: 0.947 Test Loss: 0.233 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001313
	speed: 0.2810s/iter; left time: 11436.5770s
	iters: 200, epoch: 14 | loss: 0.0080824
	speed: 0.0693s/iter; left time: 2814.0640s
	iters: 300, epoch: 14 | loss: 0.1520284
	speed: 0.0708s/iter; left time: 2869.4795s
	iters: 400, epoch: 14 | loss: 0.0937480
	speed: 0.0700s/iter; left time: 2828.5173s
Epoch: 14 cost time: 32.975382566452026
Epoch: 14, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
Validation loss decreased (-0.958832 --> -0.967408).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0096478
	speed: 0.2984s/iter; left time: 12004.3558s
	iters: 200, epoch: 15 | loss: 0.0559548
	speed: 0.0659s/iter; left time: 2643.3700s
	iters: 300, epoch: 15 | loss: 0.0002147
	speed: 0.0685s/iter; left time: 2741.6556s
	iters: 400, epoch: 15 | loss: 0.1869950
	speed: 0.0672s/iter; left time: 2682.2904s
Epoch: 15 cost time: 32.476789236068726
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.288 Vali Acc: 0.943 Test Loss: 0.288 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2733685
	speed: 0.2944s/iter; left time: 11708.2001s
	iters: 200, epoch: 16 | loss: 0.0091842
	speed: 0.0675s/iter; left time: 2678.0459s
	iters: 300, epoch: 16 | loss: 0.0004327
	speed: 0.0653s/iter; left time: 2584.2205s
	iters: 400, epoch: 16 | loss: 1.0447717
	speed: 0.0687s/iter; left time: 2710.9533s
Epoch: 16 cost time: 31.997645139694214
Epoch: 16, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.364 Vali Acc: 0.929 Test Loss: 0.364 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0343754
	speed: 0.2795s/iter; left time: 10983.1573s
	iters: 200, epoch: 17 | loss: 0.0199482
	speed: 0.0662s/iter; left time: 2595.4198s
	iters: 300, epoch: 17 | loss: 0.0236776
	speed: 0.0647s/iter; left time: 2527.7961s
	iters: 400, epoch: 17 | loss: 0.5481000
	speed: 0.0674s/iter; left time: 2627.9609s
Epoch: 17 cost time: 31.37989854812622
Epoch: 17, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0013476
	speed: 0.2560s/iter; left time: 9938.8995s
	iters: 200, epoch: 18 | loss: 0.0072454
	speed: 0.0604s/iter; left time: 2337.8925s
	iters: 300, epoch: 18 | loss: 0.0018492
	speed: 0.0587s/iter; left time: 2266.6995s
	iters: 400, epoch: 18 | loss: 0.0003656
	speed: 0.0667s/iter; left time: 2570.0916s
Epoch: 18 cost time: 29.238725185394287
Epoch: 18, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0044771
	speed: 0.2812s/iter; left time: 10785.4141s
	iters: 200, epoch: 19 | loss: 0.0003947
	speed: 0.0662s/iter; left time: 2531.0883s
	iters: 300, epoch: 19 | loss: 0.0074193
	speed: 0.0699s/iter; left time: 2666.3477s
	iters: 400, epoch: 19 | loss: 0.4938678
	speed: 0.0696s/iter; left time: 2648.7131s
Epoch: 19 cost time: 32.37607264518738
Epoch: 19, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.470 Vali Acc: 0.909 Test Loss: 0.470 Test Acc: 0.909
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0055775
	speed: 0.2986s/iter; left time: 11314.0075s
	iters: 200, epoch: 20 | loss: 0.0000563
	speed: 0.0698s/iter; left time: 2637.8921s
	iters: 300, epoch: 20 | loss: 0.0202464
	speed: 0.0718s/iter; left time: 2705.9037s
	iters: 400, epoch: 20 | loss: 0.0002658
	speed: 0.0709s/iter; left time: 2663.9403s
Epoch: 20 cost time: 32.86957049369812
Epoch: 20, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0010016
	speed: 0.2687s/iter; left time: 10056.4200s
	iters: 200, epoch: 21 | loss: 0.0000263
	speed: 0.0646s/iter; left time: 2410.7626s
	iters: 300, epoch: 21 | loss: 0.2142516
	speed: 0.0645s/iter; left time: 2401.0766s
	iters: 400, epoch: 21 | loss: 0.0001132
	speed: 0.0659s/iter; left time: 2447.8697s
Epoch: 21 cost time: 30.72840404510498
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0610962
	speed: 0.2845s/iter; left time: 10513.4582s
	iters: 200, epoch: 22 | loss: 0.0047346
	speed: 0.0677s/iter; left time: 2496.1548s
	iters: 300, epoch: 22 | loss: 0.0399354
	speed: 0.0643s/iter; left time: 2363.7231s
	iters: 400, epoch: 22 | loss: 0.0192622
	speed: 0.0665s/iter; left time: 2436.2233s
Epoch: 22 cost time: 30.841450691223145
Epoch: 22, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.1129304
	speed: 0.2846s/iter; left time: 10384.8391s
	iters: 200, epoch: 23 | loss: 0.1885363
	speed: 0.0673s/iter; left time: 2447.6272s
	iters: 300, epoch: 23 | loss: 0.0029038
	speed: 0.0683s/iter; left time: 2478.6534s
	iters: 400, epoch: 23 | loss: 0.0149985
	speed: 0.0700s/iter; left time: 2532.8833s
Epoch: 23 cost time: 32.17199373245239
Epoch: 23, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0002013
	speed: 0.2752s/iter; left time: 9911.0504s
	iters: 200, epoch: 24 | loss: 0.2144419
	speed: 0.0607s/iter; left time: 2179.4476s
	iters: 300, epoch: 24 | loss: 0.0000648
	speed: 0.0622s/iter; left time: 2228.8907s
	iters: 400, epoch: 24 | loss: 0.0028532
	speed: 0.0657s/iter; left time: 2346.3136s
Epoch: 24 cost time: 30.470703125
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.967409948542024
model parameter : 11079178
model size : 61.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7649933
	speed: 0.0869s/iter; left time: 4065.0614s
	iters: 200, epoch: 1 | loss: 0.3091812
	speed: 0.0713s/iter; left time: 3331.2181s
	iters: 300, epoch: 1 | loss: 0.1307886
	speed: 0.0694s/iter; left time: 3235.7980s
	iters: 400, epoch: 1 | loss: 0.0408205
	speed: 0.0691s/iter; left time: 3214.7737s
Epoch: 1 cost time: 34.20305562019348
Epoch: 1, Steps: 469 | Train Loss: 0.358 Vali Loss: 0.236 Vali Acc: 0.924 Test Loss: 0.236 Test Acc: 0.924
Validation loss decreased (inf --> -0.924240).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0033710
	speed: 0.2722s/iter; left time: 12612.0035s
	iters: 200, epoch: 2 | loss: 0.3606700
	speed: 0.0726s/iter; left time: 3356.8637s
	iters: 300, epoch: 2 | loss: 0.1399387
	speed: 0.0667s/iter; left time: 3076.1655s
	iters: 400, epoch: 2 | loss: 0.0584263
	speed: 0.0679s/iter; left time: 3126.7888s
Epoch: 2 cost time: 32.54717540740967
Epoch: 2, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0861016
	speed: 0.2651s/iter; left time: 12156.1048s
	iters: 200, epoch: 3 | loss: 0.0822095
	speed: 0.0682s/iter; left time: 3122.1790s
	iters: 300, epoch: 3 | loss: 0.0796211
	speed: 0.0728s/iter; left time: 3323.4011s
	iters: 400, epoch: 3 | loss: 0.2694761
	speed: 0.0720s/iter; left time: 3281.9854s
Epoch: 3 cost time: 32.71373176574707
Epoch: 3, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.328 Vali Acc: 0.918 Test Loss: 0.328 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0781084
	speed: 0.2807s/iter; left time: 12742.2030s
	iters: 200, epoch: 4 | loss: 0.0770919
	speed: 0.0712s/iter; left time: 3225.7545s
	iters: 300, epoch: 4 | loss: 0.0916228
	speed: 0.0723s/iter; left time: 3265.5840s
	iters: 400, epoch: 4 | loss: 0.0426240
	speed: 0.0693s/iter; left time: 3124.5117s
Epoch: 4 cost time: 33.27687978744507
Epoch: 4, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.534 Vali Acc: 0.897 Test Loss: 0.534 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0631140
	speed: 0.2846s/iter; left time: 12783.5193s
	iters: 200, epoch: 5 | loss: 0.1313527
	speed: 0.0659s/iter; left time: 2955.2804s
	iters: 300, epoch: 5 | loss: 0.7395793
	speed: 0.0716s/iter; left time: 3200.7606s
	iters: 400, epoch: 5 | loss: 0.3003805
	speed: 0.0642s/iter; left time: 2862.7392s
Epoch: 5 cost time: 32.01809215545654
Epoch: 5, Steps: 469 | Train Loss: 0.172 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0188261
	speed: 0.2559s/iter; left time: 11376.5906s
	iters: 200, epoch: 6 | loss: 0.0302767
	speed: 0.0651s/iter; left time: 2888.0819s
	iters: 300, epoch: 6 | loss: 0.0006248
	speed: 0.0696s/iter; left time: 3080.8802s
	iters: 400, epoch: 6 | loss: 0.0091558
	speed: 0.0696s/iter; left time: 3072.3519s
Epoch: 6 cost time: 32.11307883262634
Epoch: 6, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.385 Vali Acc: 0.915 Test Loss: 0.385 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0381552
	speed: 0.2881s/iter; left time: 12673.2199s
	iters: 200, epoch: 7 | loss: 0.2683307
	speed: 0.0696s/iter; left time: 3055.2005s
	iters: 300, epoch: 7 | loss: 0.1885749
	speed: 0.0713s/iter; left time: 3120.1511s
	iters: 400, epoch: 7 | loss: 0.0307188
	speed: 0.0692s/iter; left time: 3024.8675s
Epoch: 7 cost time: 32.86680293083191
Epoch: 7, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.429 Vali Acc: 0.920 Test Loss: 0.429 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0131813
	speed: 0.2921s/iter; left time: 12709.7891s
	iters: 200, epoch: 8 | loss: 0.0002899
	speed: 0.0706s/iter; left time: 3064.1635s
	iters: 300, epoch: 8 | loss: 0.0085838
	speed: 0.0718s/iter; left time: 3108.6915s
	iters: 400, epoch: 8 | loss: 0.5817652
	speed: 0.0660s/iter; left time: 2852.7469s
Epoch: 8 cost time: 32.754788398742676
Epoch: 8, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.432 Vali Acc: 0.917 Test Loss: 0.432 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0155637
	speed: 0.2741s/iter; left time: 11798.0996s
	iters: 200, epoch: 9 | loss: 0.3321101
	speed: 0.0617s/iter; left time: 2648.3175s
	iters: 300, epoch: 9 | loss: 0.0243410
	speed: 0.0702s/iter; left time: 3007.5062s
	iters: 400, epoch: 9 | loss: 0.0037685
	speed: 0.0672s/iter; left time: 2871.6877s
Epoch: 9 cost time: 31.52577304840088
Epoch: 9, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.401 Vali Acc: 0.920 Test Loss: 0.401 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0020131
	speed: 0.2837s/iter; left time: 12079.4986s
	iters: 200, epoch: 10 | loss: 0.0050975
	speed: 0.0685s/iter; left time: 2908.3186s
	iters: 300, epoch: 10 | loss: 0.5098622
	speed: 0.0691s/iter; left time: 2930.4775s
	iters: 400, epoch: 10 | loss: 0.0002972
	speed: 0.0694s/iter; left time: 2933.0797s
Epoch: 10 cost time: 32.61477041244507
Epoch: 10, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.301 Vali Acc: 0.940 Test Loss: 0.301 Test Acc: 0.940
Validation loss decreased (-0.924240 --> -0.940249).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0451140
	speed: 0.2982s/iter; left time: 12555.9928s
	iters: 200, epoch: 11 | loss: 0.5331685
	speed: 0.0687s/iter; left time: 2885.6573s
	iters: 300, epoch: 11 | loss: 0.0026583
	speed: 0.0717s/iter; left time: 3003.6611s
	iters: 400, epoch: 11 | loss: 0.0019596
	speed: 0.0669s/iter; left time: 2798.8009s
Epoch: 11 cost time: 32.488524198532104
Epoch: 11, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (-0.940249 --> -0.955973).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0024867
	speed: 0.2779s/iter; left time: 11571.8148s
	iters: 200, epoch: 12 | loss: 0.0015673
	speed: 0.0649s/iter; left time: 2697.1776s
	iters: 300, epoch: 12 | loss: 0.0209864
	speed: 0.0702s/iter; left time: 2908.7356s
	iters: 400, epoch: 12 | loss: 0.0455404
	speed: 0.0671s/iter; left time: 2776.0856s
Epoch: 12 cost time: 31.714936017990112
Epoch: 12, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
Validation loss decreased (-0.955973 --> -0.963977).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0003326
	speed: 0.2974s/iter; left time: 12245.6166s
	iters: 200, epoch: 13 | loss: 0.2987563
	speed: 0.0648s/iter; left time: 2662.5925s
	iters: 300, epoch: 13 | loss: 0.0301129
	speed: 0.0707s/iter; left time: 2898.8139s
	iters: 400, epoch: 13 | loss: 0.0330942
	speed: 0.0646s/iter; left time: 2640.2434s
Epoch: 13 cost time: 31.945656061172485
Epoch: 13, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.963977 --> -0.966837).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5596856
	speed: 0.2942s/iter; left time: 11976.2715s
	iters: 200, epoch: 14 | loss: 0.0035964
	speed: 0.0694s/iter; left time: 2817.7060s
	iters: 300, epoch: 14 | loss: 0.4704638
	speed: 0.0673s/iter; left time: 2724.3566s
	iters: 400, epoch: 14 | loss: 0.0896966
	speed: 0.0662s/iter; left time: 2672.9601s
Epoch: 14 cost time: 32.082804679870605
Epoch: 14, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.938 Test Loss: 0.296 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0119437
	speed: 0.2752s/iter; left time: 11072.3370s
	iters: 200, epoch: 15 | loss: 0.0488644
	speed: 0.0647s/iter; left time: 2597.1115s
	iters: 300, epoch: 15 | loss: 0.0505486
	speed: 0.0688s/iter; left time: 2754.0354s
	iters: 400, epoch: 15 | loss: 0.1685528
	speed: 0.0706s/iter; left time: 2820.5286s
Epoch: 15 cost time: 31.95142698287964
Epoch: 15, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.337 Vali Acc: 0.953 Test Loss: 0.337 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0087211
	speed: 0.2976s/iter; left time: 11835.2135s
	iters: 200, epoch: 16 | loss: 0.0002049
	speed: 0.0705s/iter; left time: 2794.9386s
	iters: 300, epoch: 16 | loss: 0.0046638
	speed: 0.0703s/iter; left time: 2781.5890s
	iters: 400, epoch: 16 | loss: 0.0061807
	speed: 0.0684s/iter; left time: 2701.0660s
Epoch: 16 cost time: 32.760414600372314
Epoch: 16, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1075027
	speed: 0.2972s/iter; left time: 11677.2772s
	iters: 200, epoch: 17 | loss: 0.0077687
	speed: 0.0718s/iter; left time: 2812.9699s
	iters: 300, epoch: 17 | loss: 0.1841382
	speed: 0.0607s/iter; left time: 2373.7448s
	iters: 400, epoch: 17 | loss: 0.5204342
	speed: 0.0674s/iter; left time: 2629.3264s
Epoch: 17 cost time: 31.60079789161682
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
Validation loss decreased (-0.966837 --> -0.969981).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0442414
	speed: 0.2809s/iter; left time: 10906.1958s
	iters: 200, epoch: 18 | loss: 0.0004227
	speed: 0.0673s/iter; left time: 2606.7326s
	iters: 300, epoch: 18 | loss: 0.0216544
	speed: 0.0657s/iter; left time: 2538.1559s
	iters: 400, epoch: 18 | loss: 0.0102264
	speed: 0.0701s/iter; left time: 2699.5504s
Epoch: 18 cost time: 31.947895765304565
Epoch: 18, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.946 Test Loss: 0.270 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0112977
	speed: 0.2933s/iter; left time: 11250.2457s
	iters: 200, epoch: 19 | loss: 0.0154323
	speed: 0.0687s/iter; left time: 2627.3148s
	iters: 300, epoch: 19 | loss: 0.0038940
	speed: 0.0663s/iter; left time: 2528.6266s
	iters: 400, epoch: 19 | loss: 0.0212271
	speed: 0.0697s/iter; left time: 2653.8492s
Epoch: 19 cost time: 32.43341588973999
Epoch: 19, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.329 Vali Acc: 0.952 Test Loss: 0.329 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0070553
	speed: 0.2946s/iter; left time: 11162.5566s
	iters: 200, epoch: 20 | loss: 0.0003169
	speed: 0.0710s/iter; left time: 2684.6784s
	iters: 300, epoch: 20 | loss: 0.0000619
	speed: 0.0651s/iter; left time: 2455.3328s
	iters: 400, epoch: 20 | loss: 0.3116143
	speed: 0.0673s/iter; left time: 2530.9308s
Epoch: 20 cost time: 32.142866134643555
Epoch: 20, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0004066
	speed: 0.2768s/iter; left time: 10357.9191s
	iters: 200, epoch: 21 | loss: 0.0009339
	speed: 0.0610s/iter; left time: 2276.2078s
	iters: 300, epoch: 21 | loss: 0.0346287
	speed: 0.0690s/iter; left time: 2567.2924s
	iters: 400, epoch: 21 | loss: 0.0170293
	speed: 0.0670s/iter; left time: 2488.0830s
Epoch: 21 cost time: 31.34622287750244
Epoch: 21, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0008388
	speed: 0.2918s/iter; left time: 10783.3262s
	iters: 200, epoch: 22 | loss: 0.0777871
	speed: 0.0705s/iter; left time: 2597.9542s
	iters: 300, epoch: 22 | loss: 0.1276268
	speed: 0.0680s/iter; left time: 2500.7297s
	iters: 400, epoch: 22 | loss: 0.0002629
	speed: 0.0682s/iter; left time: 2498.8638s
Epoch: 22 cost time: 32.718100786209106
Epoch: 22, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.969981 --> -0.977986).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0015827
	speed: 0.3019s/iter; left time: 11015.1177s
	iters: 200, epoch: 23 | loss: 0.1487493
	speed: 0.0697s/iter; left time: 2534.5423s
	iters: 300, epoch: 23 | loss: 0.0159122
	speed: 0.0645s/iter; left time: 2339.3610s
	iters: 400, epoch: 23 | loss: 0.0451162
	speed: 0.0650s/iter; left time: 2351.5493s
Epoch: 23 cost time: 31.62123680114746
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.954 Test Loss: 0.266 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0024990
	speed: 0.2799s/iter; left time: 10081.6677s
	iters: 200, epoch: 24 | loss: 0.0586961
	speed: 0.0651s/iter; left time: 2337.8665s
	iters: 300, epoch: 24 | loss: 0.0041217
	speed: 0.0693s/iter; left time: 2480.5758s
	iters: 400, epoch: 24 | loss: 0.0202158
	speed: 0.0698s/iter; left time: 2491.7882s
Epoch: 24 cost time: 32.21334528923035
Epoch: 24, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.190 Vali Acc: 0.969 Test Loss: 0.190 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0165561
	speed: 0.2993s/iter; left time: 10638.4656s
	iters: 200, epoch: 25 | loss: 0.0029597
	speed: 0.0673s/iter; left time: 2386.0018s
	iters: 300, epoch: 25 | loss: 0.0003708
	speed: 0.0652s/iter; left time: 2305.9792s
	iters: 400, epoch: 25 | loss: 0.0211450
	speed: 0.0700s/iter; left time: 2468.4419s
Epoch: 25 cost time: 31.910951375961304
Epoch: 25, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1525199
	speed: 0.2816s/iter; left time: 9878.7925s
	iters: 200, epoch: 26 | loss: 0.0072431
	speed: 0.0691s/iter; left time: 2415.5434s
	iters: 300, epoch: 26 | loss: 0.0034736
	speed: 0.0647s/iter; left time: 2256.6009s
	iters: 400, epoch: 26 | loss: 0.0018841
	speed: 0.0647s/iter; left time: 2248.3482s
Epoch: 26 cost time: 31.707022666931152
Epoch: 26, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0001098
	speed: 0.2874s/iter; left time: 9946.4285s
	iters: 200, epoch: 27 | loss: 0.0046852
	speed: 0.0699s/iter; left time: 2412.3556s
	iters: 300, epoch: 27 | loss: 0.0118565
	speed: 0.0709s/iter; left time: 2438.6888s
	iters: 400, epoch: 27 | loss: 0.0242788
	speed: 0.0711s/iter; left time: 2440.5641s
Epoch: 27 cost time: 33.3075168132782
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0009105
	speed: 0.3020s/iter; left time: 10310.1217s
	iters: 200, epoch: 28 | loss: 0.4108286
	speed: 0.0689s/iter; left time: 2346.6594s
	iters: 300, epoch: 28 | loss: 0.0012962
	speed: 0.0683s/iter; left time: 2318.7370s
	iters: 400, epoch: 28 | loss: 0.0013528
	speed: 0.0674s/iter; left time: 2281.1707s
Epoch: 28 cost time: 32.27339220046997
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0082718
	speed: 0.2934s/iter; left time: 9878.6340s
	iters: 200, epoch: 29 | loss: 0.0066700
	speed: 0.0710s/iter; left time: 2385.0566s
	iters: 300, epoch: 29 | loss: 0.0054443
	speed: 0.0666s/iter; left time: 2227.3832s
	iters: 400, epoch: 29 | loss: 0.0234245
	speed: 0.0633s/iter; left time: 2111.7674s
Epoch: 29 cost time: 31.78527069091797
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0001123
	speed: 0.2664s/iter; left time: 8844.2950s
	iters: 200, epoch: 30 | loss: 0.0005502
	speed: 0.0699s/iter; left time: 2314.6698s
	iters: 300, epoch: 30 | loss: 0.0010925
	speed: 0.0723s/iter; left time: 2385.1234s
	iters: 400, epoch: 30 | loss: 0.0002764
	speed: 0.0658s/iter; left time: 2165.8332s
Epoch: 30 cost time: 33.181623458862305
Epoch: 30, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0069816
	speed: 0.2954s/iter; left time: 9668.7440s
	iters: 200, epoch: 31 | loss: 0.0007837
	speed: 0.0688s/iter; left time: 2244.2647s
	iters: 300, epoch: 31 | loss: 0.0212946
	speed: 0.0691s/iter; left time: 2246.7618s
	iters: 400, epoch: 31 | loss: 0.0004323
	speed: 0.0673s/iter; left time: 2182.1316s
Epoch: 31 cost time: 32.7445011138916
Epoch: 31, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0067727
	speed: 0.2814s/iter; left time: 9080.1055s
	iters: 200, epoch: 32 | loss: 0.1602212
	speed: 0.0740s/iter; left time: 2380.8876s
	iters: 300, epoch: 32 | loss: 0.2395987
	speed: 0.0708s/iter; left time: 2270.1341s
	iters: 400, epoch: 32 | loss: 0.0076270
	speed: 0.0673s/iter; left time: 2151.6145s
Epoch: 32 cost time: 33.39190053939819
Epoch: 32, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 11079178
model size : 61.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6944118
	speed: 0.0857s/iter; left time: 4008.5130s
	iters: 200, epoch: 1 | loss: 0.1468141
	speed: 0.0591s/iter; left time: 2762.1365s
	iters: 300, epoch: 1 | loss: 0.1083370
	speed: 0.0630s/iter; left time: 2937.9723s
	iters: 400, epoch: 1 | loss: 0.0760434
	speed: 0.0631s/iter; left time: 2934.4223s
Epoch: 1 cost time: 31.889703035354614
Epoch: 1, Steps: 469 | Train Loss: 0.324 Vali Loss: 0.287 Vali Acc: 0.907 Test Loss: 0.287 Test Acc: 0.907
Validation loss decreased (inf --> -0.907087).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0039578
	speed: 0.3008s/iter; left time: 13936.0028s
	iters: 200, epoch: 2 | loss: 0.7383466
	speed: 0.0660s/iter; left time: 3053.0950s
	iters: 300, epoch: 2 | loss: 0.0215136
	speed: 0.0625s/iter; left time: 2884.5284s
	iters: 400, epoch: 2 | loss: 0.1117682
	speed: 0.0650s/iter; left time: 2992.5393s
Epoch: 2 cost time: 31.401845932006836
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.412 Vali Acc: 0.905 Test Loss: 0.412 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0049724
	speed: 0.2956s/iter; left time: 13558.8695s
	iters: 200, epoch: 3 | loss: 0.2344495
	speed: 0.0619s/iter; left time: 2832.4619s
	iters: 300, epoch: 3 | loss: 0.3013459
	speed: 0.0607s/iter; left time: 2773.6867s
	iters: 400, epoch: 3 | loss: 0.0104784
	speed: 0.0608s/iter; left time: 2772.1007s
Epoch: 3 cost time: 29.87450623512268
Epoch: 3, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.907087 --> -0.925383).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5592099
	speed: 0.2858s/iter; left time: 12974.9488s
	iters: 200, epoch: 4 | loss: 0.0024035
	speed: 0.0681s/iter; left time: 3082.4385s
	iters: 300, epoch: 4 | loss: 0.0015784
	speed: 0.0645s/iter; left time: 2912.9564s
	iters: 400, epoch: 4 | loss: 0.0851605
	speed: 0.0620s/iter; left time: 2797.8837s
Epoch: 4 cost time: 31.208044052124023
Epoch: 4, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.276 Vali Acc: 0.939 Test Loss: 0.276 Test Acc: 0.939
Validation loss decreased (-0.925383 --> -0.939105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3549268
	speed: 0.2945s/iter; left time: 13231.5645s
	iters: 200, epoch: 5 | loss: 0.1841247
	speed: 0.0651s/iter; left time: 2918.2550s
	iters: 300, epoch: 5 | loss: 0.9214650
	speed: 0.0657s/iter; left time: 2940.3709s
	iters: 400, epoch: 5 | loss: 0.4709240
	speed: 0.0618s/iter; left time: 2758.2568s
Epoch: 5 cost time: 30.888879776000977
Epoch: 5, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.939105 --> -0.947682).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0412741
	speed: 0.2964s/iter; left time: 13175.2541s
	iters: 200, epoch: 6 | loss: 0.0071412
	speed: 0.0627s/iter; left time: 2782.5704s
	iters: 300, epoch: 6 | loss: 0.0019097
	speed: 0.0612s/iter; left time: 2709.9078s
	iters: 400, epoch: 6 | loss: 0.0056717
	speed: 0.0589s/iter; left time: 2602.6122s
Epoch: 6 cost time: 29.57217264175415
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
Validation loss decreased (-0.947682 --> -0.960833).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2972803
	speed: 0.2836s/iter; left time: 12476.0588s
	iters: 200, epoch: 7 | loss: 0.1169811
	speed: 0.0682s/iter; left time: 2993.8099s
	iters: 300, epoch: 7 | loss: 0.0245817
	speed: 0.0647s/iter; left time: 2831.8031s
	iters: 400, epoch: 7 | loss: 0.0020142
	speed: 0.0631s/iter; left time: 2758.0791s
Epoch: 7 cost time: 31.421568393707275
Epoch: 7, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.960833 --> -0.978844).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2554052
	speed: 0.2937s/iter; left time: 12782.1649s
	iters: 200, epoch: 8 | loss: 0.0063499
	speed: 0.0677s/iter; left time: 2940.0031s
	iters: 300, epoch: 8 | loss: 0.0047507
	speed: 0.0652s/iter; left time: 2824.0311s
	iters: 400, epoch: 8 | loss: 0.0083146
	speed: 0.0634s/iter; left time: 2741.6776s
Epoch: 8 cost time: 31.442595720291138
Epoch: 8, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0796601
	speed: 0.2817s/iter; left time: 12125.4359s
	iters: 200, epoch: 9 | loss: 0.1691051
	speed: 0.0643s/iter; left time: 2760.7484s
	iters: 300, epoch: 9 | loss: 0.0110251
	speed: 0.0632s/iter; left time: 2709.8243s
	iters: 400, epoch: 9 | loss: 0.4352969
	speed: 0.0613s/iter; left time: 2620.0953s
Epoch: 9 cost time: 30.13720464706421
Epoch: 9, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0003427
	speed: 0.2684s/iter; left time: 11428.2439s
	iters: 200, epoch: 10 | loss: 0.3618468
	speed: 0.0712s/iter; left time: 3024.8246s
	iters: 300, epoch: 10 | loss: 0.0002350
	speed: 0.0687s/iter; left time: 2912.5874s
	iters: 400, epoch: 10 | loss: 0.0004922
	speed: 0.0665s/iter; left time: 2811.7208s
Epoch: 10 cost time: 32.24062418937683
Epoch: 10, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.416 Vali Acc: 0.907 Test Loss: 0.416 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0003563
	speed: 0.2842s/iter; left time: 11969.2901s
	iters: 200, epoch: 11 | loss: 0.7494546
	speed: 0.0710s/iter; left time: 2982.8524s
	iters: 300, epoch: 11 | loss: 0.3959236
	speed: 0.0658s/iter; left time: 2759.5414s
	iters: 400, epoch: 11 | loss: 0.1826978
	speed: 0.0652s/iter; left time: 2728.1551s
Epoch: 11 cost time: 32.150550365448
Epoch: 11, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1825087
	speed: 0.2829s/iter; left time: 11781.1537s
	iters: 200, epoch: 12 | loss: 0.0002818
	speed: 0.0680s/iter; left time: 2824.5204s
	iters: 300, epoch: 12 | loss: 0.0010032
	speed: 0.0652s/iter; left time: 2703.1457s
	iters: 400, epoch: 12 | loss: 0.2142726
	speed: 0.0649s/iter; left time: 2681.9765s
Epoch: 12 cost time: 31.498207569122314
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.324 Vali Acc: 0.955 Test Loss: 0.324 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0413071
	speed: 0.2648s/iter; left time: 10903.2428s
	iters: 200, epoch: 13 | loss: 0.0963891
	speed: 0.0692s/iter; left time: 2844.2691s
	iters: 300, epoch: 13 | loss: 0.0592944
	speed: 0.0667s/iter; left time: 2732.6365s
	iters: 400, epoch: 13 | loss: 0.0000187
	speed: 0.0625s/iter; left time: 2555.3054s
Epoch: 13 cost time: 31.58130645751953
Epoch: 13, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5218495
	speed: 0.2675s/iter; left time: 10888.1804s
	iters: 200, epoch: 14 | loss: 0.0001052
	speed: 0.0717s/iter; left time: 2911.9926s
	iters: 300, epoch: 14 | loss: 0.3188002
	speed: 0.0698s/iter; left time: 2825.8647s
	iters: 400, epoch: 14 | loss: 0.1443429
	speed: 0.0679s/iter; left time: 2743.3582s
Epoch: 14 cost time: 32.53020143508911
Epoch: 14, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2471352
	speed: 0.2723s/iter; left time: 10954.1381s
	iters: 200, epoch: 15 | loss: 0.2580797
	speed: 0.0686s/iter; left time: 2754.7196s
	iters: 300, epoch: 15 | loss: 0.0030341
	speed: 0.0638s/iter; left time: 2553.3284s
	iters: 400, epoch: 15 | loss: 0.0074215
	speed: 0.0638s/iter; left time: 2547.0897s
Epoch: 15 cost time: 30.9245548248291
Epoch: 15, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0033166
	speed: 0.2715s/iter; left time: 10794.4816s
	iters: 200, epoch: 16 | loss: 0.0750632
	speed: 0.0663s/iter; left time: 2630.3537s
	iters: 300, epoch: 16 | loss: 0.1338612
	speed: 0.0722s/iter; left time: 2855.4782s
	iters: 400, epoch: 16 | loss: 0.0005099
	speed: 0.0697s/iter; left time: 2749.3169s
Epoch: 16 cost time: 32.44397759437561
Epoch: 16, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.347 Vali Acc: 0.932 Test Loss: 0.347 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0435283
	speed: 0.2816s/iter; left time: 11066.0839s
	iters: 200, epoch: 17 | loss: 0.0024919
	speed: 0.0660s/iter; left time: 2585.9742s
	iters: 300, epoch: 17 | loss: 0.7333565
	speed: 0.0678s/iter; left time: 2652.5581s
	iters: 400, epoch: 17 | loss: 1.0248828
	speed: 0.0682s/iter; left time: 2657.7729s
Epoch: 17 cost time: 31.810492992401123
Epoch: 17, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.196 Vali Acc: 0.961 Test Loss: 0.196 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 11079178
model size : 61.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3046212
	speed: 0.0875s/iter; left time: 4095.4789s
	iters: 200, epoch: 1 | loss: 2.2995224
	speed: 0.0704s/iter; left time: 3286.7323s
	iters: 300, epoch: 1 | loss: 2.3029084
	speed: 0.0673s/iter; left time: 3138.1829s
	iters: 400, epoch: 1 | loss: 2.2974107
	speed: 0.0670s/iter; left time: 3114.5336s
Epoch: 1 cost time: 33.94683814048767
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3043654
	speed: 0.2742s/iter; left time: 12704.4779s
	iters: 200, epoch: 2 | loss: 2.2940631
	speed: 0.0689s/iter; left time: 3184.3020s
	iters: 300, epoch: 2 | loss: 2.3126962
	speed: 0.0688s/iter; left time: 3171.8910s
	iters: 400, epoch: 2 | loss: 2.3044376
	speed: 0.0688s/iter; left time: 3165.0411s
Epoch: 2 cost time: 32.78062605857849
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3115332
	speed: 0.2813s/iter; left time: 12899.7380s
	iters: 200, epoch: 3 | loss: 2.3056865
	speed: 0.0723s/iter; left time: 3310.1391s
	iters: 300, epoch: 3 | loss: 2.3092406
	speed: 0.0742s/iter; left time: 3389.6027s
	iters: 400, epoch: 3 | loss: 2.2932081
	speed: 0.0704s/iter; left time: 3207.7614s
Epoch: 3 cost time: 33.92453479766846
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2929330
	speed: 0.2768s/iter; left time: 12565.3813s
	iters: 200, epoch: 4 | loss: 2.3040445
	speed: 0.0662s/iter; left time: 2996.7834s
	iters: 300, epoch: 4 | loss: 2.2983005
	speed: 0.0668s/iter; left time: 3020.7277s
	iters: 400, epoch: 4 | loss: 2.2967412
	speed: 0.0643s/iter; left time: 2900.8897s
Epoch: 4 cost time: 31.72467279434204
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3051324
	speed: 0.2776s/iter; left time: 12469.7843s
	iters: 200, epoch: 5 | loss: 2.3038912
	speed: 0.0723s/iter; left time: 3243.0531s
	iters: 300, epoch: 5 | loss: 2.3017833
	speed: 0.0727s/iter; left time: 3250.1932s
	iters: 400, epoch: 5 | loss: 2.3065066
	speed: 0.0719s/iter; left time: 3208.3883s
Epoch: 5 cost time: 33.74729108810425
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2911830
	speed: 0.2910s/iter; left time: 12934.6853s
	iters: 200, epoch: 6 | loss: 2.2876420
	speed: 0.0686s/iter; left time: 3042.2909s
	iters: 300, epoch: 6 | loss: 2.2920315
	speed: 0.0700s/iter; left time: 3099.5792s
	iters: 400, epoch: 6 | loss: 2.2954814
	speed: 0.0703s/iter; left time: 3105.8700s
Epoch: 6 cost time: 33.355908155441284
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3105922
	speed: 0.2914s/iter; left time: 12818.5516s
	iters: 200, epoch: 7 | loss: 2.3134382
	speed: 0.0664s/iter; left time: 2913.2523s
	iters: 300, epoch: 7 | loss: 2.3160086
	speed: 0.0677s/iter; left time: 2963.7819s
	iters: 400, epoch: 7 | loss: 2.2904603
	speed: 0.0723s/iter; left time: 3159.9419s
Epoch: 7 cost time: 32.54417610168457
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2905531
	speed: 0.2743s/iter; left time: 11936.2408s
	iters: 200, epoch: 8 | loss: 2.3068068
	speed: 0.0697s/iter; left time: 3025.4198s
	iters: 300, epoch: 8 | loss: 2.2943351
	speed: 0.0728s/iter; left time: 3151.8798s
	iters: 400, epoch: 8 | loss: 2.2984931
	speed: 0.0690s/iter; left time: 2981.4749s
Epoch: 8 cost time: 33.445714235305786
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3092070
	speed: 0.2946s/iter; left time: 12680.5467s
	iters: 200, epoch: 9 | loss: 2.2971931
	speed: 0.0686s/iter; left time: 2944.4580s
	iters: 300, epoch: 9 | loss: 2.2951982
	speed: 0.0699s/iter; left time: 2997.1221s
	iters: 400, epoch: 9 | loss: 2.2889924
	speed: 0.0702s/iter; left time: 3000.5377s
Epoch: 9 cost time: 32.71190047264099
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3066580
	speed: 0.2821s/iter; left time: 12013.2734s
	iters: 200, epoch: 10 | loss: 2.2908170
	speed: 0.0665s/iter; left time: 2825.2384s
	iters: 300, epoch: 10 | loss: 2.3045866
	speed: 0.0656s/iter; left time: 2779.0074s
	iters: 400, epoch: 10 | loss: 2.3186004
	speed: 0.0675s/iter; left time: 2852.0626s
Epoch: 10 cost time: 32.19840979576111
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3023372
	speed: 0.2741s/iter; left time: 11542.5200s
	iters: 200, epoch: 11 | loss: 2.3048353
	speed: 0.0706s/iter; left time: 2965.9987s
	iters: 300, epoch: 11 | loss: 2.2986531
	speed: 0.0708s/iter; left time: 2967.3678s
	iters: 400, epoch: 11 | loss: 2.2887230
	speed: 0.0708s/iter; left time: 2958.9581s
Epoch: 11 cost time: 33.0793080329895
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2865379
	speed: 0.2785s/iter; left time: 11597.7032s
	iters: 200, epoch: 12 | loss: 2.2996240
	speed: 0.0673s/iter; left time: 2796.8581s
	iters: 300, epoch: 12 | loss: 2.3050358
	speed: 0.0639s/iter; left time: 2648.1103s
	iters: 400, epoch: 12 | loss: 2.2923596
	speed: 0.0641s/iter; left time: 2650.9131s
Epoch: 12 cost time: 31.582087993621826
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.2890103
	speed: 0.3044s/iter; left time: 12531.8819s
	iters: 200, epoch: 13 | loss: 2.2763433
	speed: 0.0639s/iter; left time: 2622.9526s
	iters: 300, epoch: 13 | loss: 2.3076622
	speed: 0.0643s/iter; left time: 2635.2089s
	iters: 400, epoch: 13 | loss: 2.3040528
	speed: 0.0661s/iter; left time: 2702.0375s
Epoch: 13 cost time: 31.421093463897705
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3034687
	speed: 0.2905s/iter; left time: 11822.6305s
	iters: 200, epoch: 14 | loss: 2.3127282
	speed: 0.0675s/iter; left time: 2742.3906s
	iters: 300, epoch: 14 | loss: 2.3101432
	speed: 0.0664s/iter; left time: 2690.5316s
	iters: 400, epoch: 14 | loss: 2.2981467
	speed: 0.0693s/iter; left time: 2800.8506s
Epoch: 14 cost time: 32.4182448387146
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3144517
	speed: 0.3029s/iter; left time: 12187.2622s
	iters: 200, epoch: 15 | loss: 2.2978675
	speed: 0.0674s/iter; left time: 2706.3455s
	iters: 300, epoch: 15 | loss: 2.3039534
	speed: 0.0707s/iter; left time: 2829.4990s
	iters: 400, epoch: 15 | loss: 2.2920947
	speed: 0.0712s/iter; left time: 2841.7682s
Epoch: 15 cost time: 33.07481551170349
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3050849
	speed: 0.2874s/iter; left time: 11429.5471s
	iters: 200, epoch: 16 | loss: 2.3124056
	speed: 0.0658s/iter; left time: 2610.3869s
	iters: 300, epoch: 16 | loss: 2.2908351
	speed: 0.0624s/iter; left time: 2469.9848s
	iters: 400, epoch: 16 | loss: 2.3105383
	speed: 0.0636s/iter; left time: 2511.1957s
Epoch: 16 cost time: 30.32540988922119
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3053672
	speed: 0.2818s/iter; left time: 11074.1139s
	iters: 200, epoch: 17 | loss: 2.2904539
	speed: 0.0693s/iter; left time: 2716.9699s
	iters: 300, epoch: 17 | loss: 2.2881007
	speed: 0.0639s/iter; left time: 2496.5064s
	iters: 400, epoch: 17 | loss: 2.2840524
	speed: 0.0652s/iter; left time: 2541.3970s
Epoch: 17 cost time: 31.76275134086609
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.3075774
	speed: 0.3053s/iter; left time: 11852.9915s
	iters: 200, epoch: 18 | loss: 2.3059995
	speed: 0.0696s/iter; left time: 2696.6071s
	iters: 300, epoch: 18 | loss: 2.3154614
	speed: 0.0698s/iter; left time: 2697.6135s
	iters: 400, epoch: 18 | loss: 2.3045869
	speed: 0.0643s/iter; left time: 2476.3152s
Epoch: 18 cost time: 32.67469024658203
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.3013883
	speed: 0.3046s/iter; left time: 11683.9626s
	iters: 200, epoch: 19 | loss: 2.3119316
	speed: 0.0647s/iter; left time: 2474.6754s
	iters: 300, epoch: 19 | loss: 2.3112361
	speed: 0.0639s/iter; left time: 2438.1104s
	iters: 400, epoch: 19 | loss: 2.2928653
	speed: 0.0632s/iter; left time: 2407.1936s
Epoch: 19 cost time: 31.335264444351196
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.2884476
	speed: 0.2892s/iter; left time: 10957.0654s
	iters: 200, epoch: 20 | loss: 2.3050656
	speed: 0.0660s/iter; left time: 2495.7466s
	iters: 300, epoch: 20 | loss: 2.3060949
	speed: 0.0662s/iter; left time: 2493.6078s
	iters: 400, epoch: 20 | loss: 2.3073993
	speed: 0.0613s/iter; left time: 2305.1367s
Epoch: 20 cost time: 30.652610301971436
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.2812123
	speed: 0.1795s/iter; left time: 6718.4988s
	iters: 200, epoch: 21 | loss: 2.3128302
	speed: 0.0570s/iter; left time: 2127.7013s
	iters: 300, epoch: 21 | loss: 2.3086839
	speed: 0.0548s/iter; left time: 2039.2682s
	iters: 400, epoch: 21 | loss: 2.3044677
	speed: 0.0493s/iter; left time: 1828.6406s
Epoch: 21 cost time: 25.34718108177185
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.3083484
	speed: 0.1875s/iter; left time: 6928.3310s
	iters: 200, epoch: 22 | loss: 2.2960553
	speed: 0.0718s/iter; left time: 2645.0156s
	iters: 300, epoch: 22 | loss: 2.2998114
	speed: 0.0713s/iter; left time: 2621.2607s
	iters: 400, epoch: 22 | loss: 2.3039401
	speed: 0.0682s/iter; left time: 2498.0756s
Epoch: 22 cost time: 32.791478872299194
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.3180089
	speed: 0.2730s/iter; left time: 9959.1723s
	iters: 200, epoch: 23 | loss: 2.3050621
	speed: 0.0705s/iter; left time: 2565.2309s
	iters: 300, epoch: 23 | loss: 2.2909179
	speed: 0.0687s/iter; left time: 2491.6556s
	iters: 400, epoch: 23 | loss: 2.2940805
	speed: 0.0661s/iter; left time: 2392.5206s
Epoch: 23 cost time: 32.293084144592285
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 2.2989802
	speed: 0.2776s/iter; left time: 9997.1614s
	iters: 200, epoch: 24 | loss: 2.2979755
	speed: 0.0700s/iter; left time: 2513.7027s
	iters: 300, epoch: 24 | loss: 2.2950442
	speed: 0.0738s/iter; left time: 2644.3519s
	iters: 400, epoch: 24 | loss: 2.3087223
	speed: 0.0664s/iter; left time: 2371.8865s
Epoch: 24 cost time: 32.86914420127869
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 2.3113859
	speed: 0.2698s/iter; left time: 9589.0904s
	iters: 200, epoch: 25 | loss: 2.3138614
	speed: 0.0705s/iter; left time: 2500.1849s
	iters: 300, epoch: 25 | loss: 2.3018217
	speed: 0.0709s/iter; left time: 2505.3606s
	iters: 400, epoch: 25 | loss: 2.3086832
	speed: 0.0711s/iter; left time: 2506.9246s
Epoch: 25 cost time: 32.98967504501343
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 2.3073928
	speed: 0.2766s/iter; left time: 9702.3980s
	iters: 200, epoch: 26 | loss: 2.2891874
	speed: 0.0683s/iter; left time: 2388.5412s
	iters: 300, epoch: 26 | loss: 2.3157539
	speed: 0.0677s/iter; left time: 2362.4038s
	iters: 400, epoch: 26 | loss: 2.3147051
	speed: 0.0692s/iter; left time: 2407.2498s
Epoch: 26 cost time: 32.004793882369995
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 2.2961411
	speed: 0.2720s/iter; left time: 9414.5413s
	iters: 200, epoch: 27 | loss: 2.3158598
	speed: 0.0666s/iter; left time: 2296.8173s
	iters: 300, epoch: 27 | loss: 2.3082073
	speed: 0.0727s/iter; left time: 2501.3717s
	iters: 400, epoch: 27 | loss: 2.2951753
	speed: 0.0718s/iter; left time: 2463.5856s
Epoch: 27 cost time: 32.83691096305847
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 2.3173399
	speed: 0.2898s/iter; left time: 9891.6887s
	iters: 200, epoch: 28 | loss: 2.3313890
	speed: 0.0699s/iter; left time: 2380.7496s
	iters: 300, epoch: 28 | loss: 2.2893763
	speed: 0.0723s/iter; left time: 2453.2456s
	iters: 400, epoch: 28 | loss: 2.2935724
	speed: 0.0698s/iter; left time: 2362.4363s
Epoch: 28 cost time: 33.04657316207886
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 2.3120694
	speed: 0.2745s/iter; left time: 9241.5373s
	iters: 200, epoch: 29 | loss: 2.3159423
	speed: 0.0674s/iter; left time: 2263.2307s
	iters: 300, epoch: 29 | loss: 2.3076503
	speed: 0.0661s/iter; left time: 2212.2641s
	iters: 400, epoch: 29 | loss: 2.3038960
	speed: 0.0653s/iter; left time: 2178.6966s
Epoch: 29 cost time: 31.166507482528687
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 11079178
model size : 61.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.0677223
	speed: 0.0873s/iter; left time: 4084.1922s
	iters: 200, epoch: 1 | loss: 0.1031531
	speed: 0.0685s/iter; left time: 3198.0655s
	iters: 300, epoch: 1 | loss: 0.1462780
	speed: 0.0708s/iter; left time: 3300.5785s
	iters: 400, epoch: 1 | loss: 0.0243257
	speed: 0.0644s/iter; left time: 2993.9593s
Epoch: 1 cost time: 33.949759006500244
Epoch: 1, Steps: 469 | Train Loss: 0.300 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
Validation loss decreased (inf --> -0.948539).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0047403
	speed: 0.2865s/iter; left time: 13274.6463s
	iters: 200, epoch: 2 | loss: 0.1451209
	speed: 0.0671s/iter; left time: 3103.6636s
	iters: 300, epoch: 2 | loss: 0.1274872
	speed: 0.0658s/iter; left time: 3035.4011s
	iters: 400, epoch: 2 | loss: 0.0134166
	speed: 0.0634s/iter; left time: 2919.5435s
Epoch: 2 cost time: 30.612112998962402
Epoch: 2, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0844810
	speed: 0.2474s/iter; left time: 11344.4058s
	iters: 200, epoch: 3 | loss: 0.2303182
	speed: 0.0661s/iter; left time: 3024.0263s
	iters: 300, epoch: 3 | loss: 0.0189992
	speed: 0.0638s/iter; left time: 2912.6312s
	iters: 400, epoch: 3 | loss: 0.5511042
	speed: 0.0674s/iter; left time: 3070.3171s
Epoch: 3 cost time: 31.225953817367554
Epoch: 3, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0257103
	speed: 0.2878s/iter; left time: 13064.4964s
	iters: 200, epoch: 4 | loss: 0.1082318
	speed: 0.0655s/iter; left time: 2968.7339s
	iters: 300, epoch: 4 | loss: 0.0131189
	speed: 0.0689s/iter; left time: 3114.3557s
	iters: 400, epoch: 4 | loss: 0.0016043
	speed: 0.0689s/iter; left time: 3104.8697s
Epoch: 4 cost time: 32.72551894187927
Epoch: 4, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4362106
	speed: 0.2839s/iter; left time: 12751.9939s
	iters: 200, epoch: 5 | loss: 0.0019672
	speed: 0.0685s/iter; left time: 3068.6268s
	iters: 300, epoch: 5 | loss: 0.5416146
	speed: 0.0693s/iter; left time: 3101.6391s
	iters: 400, epoch: 5 | loss: 0.3638667
	speed: 0.0693s/iter; left time: 3091.4273s
Epoch: 5 cost time: 32.29422402381897
Epoch: 5, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
Validation loss decreased (-0.948539 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0645993
	speed: 0.2627s/iter; left time: 11680.4641s
	iters: 200, epoch: 6 | loss: 0.0190384
	speed: 0.0667s/iter; left time: 2960.4609s
	iters: 300, epoch: 6 | loss: 0.0016839
	speed: 0.0639s/iter; left time: 2826.0732s
	iters: 400, epoch: 6 | loss: 0.0261342
	speed: 0.0676s/iter; left time: 2986.2486s
Epoch: 6 cost time: 31.381126165390015
Epoch: 6, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.493 Vali Acc: 0.913 Test Loss: 0.493 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0103757
	speed: 0.2849s/iter; left time: 12531.5168s
	iters: 200, epoch: 7 | loss: 0.5037932
	speed: 0.0676s/iter; left time: 2966.2284s
	iters: 300, epoch: 7 | loss: 0.3400218
	speed: 0.0714s/iter; left time: 3127.8829s
	iters: 400, epoch: 7 | loss: 0.0004651
	speed: 0.0670s/iter; left time: 2926.3148s
Epoch: 7 cost time: 32.57831358909607
Epoch: 7, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.960547 --> -0.963692).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0031993
	speed: 0.2924s/iter; left time: 12725.4861s
	iters: 200, epoch: 8 | loss: 0.0001206
	speed: 0.0667s/iter; left time: 2896.1206s
	iters: 300, epoch: 8 | loss: 0.0000207
	speed: 0.0668s/iter; left time: 2893.1208s
	iters: 400, epoch: 8 | loss: 0.0050190
	speed: 0.0677s/iter; left time: 2924.8479s
Epoch: 8 cost time: 32.448936462402344
Epoch: 8, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.326 Vali Acc: 0.948 Test Loss: 0.326 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0266115
	speed: 0.2749s/iter; left time: 11835.5998s
	iters: 200, epoch: 9 | loss: 0.0220724
	speed: 0.0654s/iter; left time: 2807.7721s
	iters: 300, epoch: 9 | loss: 0.2478187
	speed: 0.0674s/iter; left time: 2888.9274s
	iters: 400, epoch: 9 | loss: 0.0001864
	speed: 0.0676s/iter; left time: 2889.4836s
Epoch: 9 cost time: 31.590850114822388
Epoch: 9, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.355 Vali Acc: 0.943 Test Loss: 0.355 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0018725
	speed: 0.2833s/iter; left time: 12063.7466s
	iters: 200, epoch: 10 | loss: 0.0173672
	speed: 0.0660s/iter; left time: 2804.8179s
	iters: 300, epoch: 10 | loss: 0.0001666
	speed: 0.0654s/iter; left time: 2770.3776s
	iters: 400, epoch: 10 | loss: 0.1013920
	speed: 0.0656s/iter; left time: 2774.1090s
Epoch: 10 cost time: 31.527809619903564
Epoch: 10, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0005268
	speed: 0.2701s/iter; left time: 11376.0460s
	iters: 200, epoch: 11 | loss: 0.0094502
	speed: 0.0639s/iter; left time: 2683.8577s
	iters: 300, epoch: 11 | loss: 0.0025641
	speed: 0.0587s/iter; left time: 2459.8545s
	iters: 400, epoch: 11 | loss: 0.0006644
	speed: 0.0598s/iter; left time: 2501.8809s
Epoch: 11 cost time: 29.496723890304565
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0076520
	speed: 0.2820s/iter; left time: 11744.7185s
	iters: 200, epoch: 12 | loss: 0.0088441
	speed: 0.0629s/iter; left time: 2611.9612s
	iters: 300, epoch: 12 | loss: 0.0305248
	speed: 0.0619s/iter; left time: 2564.0887s
	iters: 400, epoch: 12 | loss: 0.0013863
	speed: 0.0597s/iter; left time: 2467.3957s
Epoch: 12 cost time: 29.857645988464355
Epoch: 12, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.450 Vali Acc: 0.924 Test Loss: 0.450 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0575982
	speed: 0.2911s/iter; left time: 11985.1339s
	iters: 200, epoch: 13 | loss: 0.2871141
	speed: 0.0647s/iter; left time: 2657.5394s
	iters: 300, epoch: 13 | loss: 0.0001522
	speed: 0.0621s/iter; left time: 2542.9187s
	iters: 400, epoch: 13 | loss: 0.0008536
	speed: 0.0634s/iter; left time: 2590.3359s
Epoch: 13 cost time: 30.582256078720093
Epoch: 13, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.963692 --> -0.971982).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1924115
	speed: 0.2991s/iter; left time: 12172.9670s
	iters: 200, epoch: 14 | loss: 0.0001470
	speed: 0.0619s/iter; left time: 2515.3521s
	iters: 300, epoch: 14 | loss: 0.0846855
	speed: 0.0619s/iter; left time: 2505.3996s
	iters: 400, epoch: 14 | loss: 0.0021415
	speed: 0.0635s/iter; left time: 2566.4205s
Epoch: 14 cost time: 30.614187955856323
Epoch: 14, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2646678
	speed: 0.2829s/iter; left time: 11381.2702s
	iters: 200, epoch: 15 | loss: 0.0000535
	speed: 0.0626s/iter; left time: 2512.7679s
	iters: 300, epoch: 15 | loss: 0.0081768
	speed: 0.0599s/iter; left time: 2399.1284s
	iters: 400, epoch: 15 | loss: 0.0000855
	speed: 0.0608s/iter; left time: 2429.5834s
Epoch: 15 cost time: 29.58614993095398
Epoch: 15, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.343 Vali Acc: 0.940 Test Loss: 0.343 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000403
	speed: 0.2974s/iter; left time: 11826.7008s
	iters: 200, epoch: 16 | loss: 0.0002524
	speed: 0.0667s/iter; left time: 2644.4047s
	iters: 300, epoch: 16 | loss: 0.0148973
	speed: 0.0639s/iter; left time: 2528.4288s
	iters: 400, epoch: 16 | loss: 0.0021724
	speed: 0.0641s/iter; left time: 2527.9159s
Epoch: 16 cost time: 31.197970151901245
Epoch: 16, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0271584
	speed: 0.2860s/iter; left time: 11237.5795s
	iters: 200, epoch: 17 | loss: 0.0002255
	speed: 0.0678s/iter; left time: 2657.3973s
	iters: 300, epoch: 17 | loss: 0.0000973
	speed: 0.0624s/iter; left time: 2440.6921s
	iters: 400, epoch: 17 | loss: 0.2500148
	speed: 0.0648s/iter; left time: 2527.2358s
Epoch: 17 cost time: 31.003172397613525
Epoch: 17, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0002610
	speed: 0.2798s/iter; left time: 10862.8329s
	iters: 200, epoch: 18 | loss: 0.0657036
	speed: 0.0643s/iter; left time: 2489.1301s
	iters: 300, epoch: 18 | loss: 0.0003342
	speed: 0.0607s/iter; left time: 2344.3860s
	iters: 400, epoch: 18 | loss: 0.0000329
	speed: 0.0607s/iter; left time: 2337.3653s
Epoch: 18 cost time: 29.66883373260498
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002364
	speed: 0.2680s/iter; left time: 10278.8451s
	iters: 200, epoch: 19 | loss: 0.0003587
	speed: 0.0633s/iter; left time: 2422.0927s
	iters: 300, epoch: 19 | loss: 0.2038370
	speed: 0.0584s/iter; left time: 2226.7365s
	iters: 400, epoch: 19 | loss: 0.0001363
	speed: 0.0579s/iter; left time: 2204.9318s
Epoch: 19 cost time: 28.769059419631958
Epoch: 19, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0057948
	speed: 0.2366s/iter; left time: 8963.0628s
	iters: 200, epoch: 20 | loss: 0.0000538
	speed: 0.0681s/iter; left time: 2572.2285s
	iters: 300, epoch: 20 | loss: 0.0002565
	speed: 0.0704s/iter; left time: 2654.2962s
	iters: 400, epoch: 20 | loss: 0.0003987
	speed: 0.0643s/iter; left time: 2417.1148s
Epoch: 20 cost time: 31.918476581573486
Epoch: 20, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0001369
	speed: 0.2804s/iter; left time: 10492.6608s
	iters: 200, epoch: 21 | loss: 0.0016956
	speed: 0.0688s/iter; left time: 2566.7647s
	iters: 300, epoch: 21 | loss: 0.0015582
	speed: 0.0683s/iter; left time: 2542.5916s
	iters: 400, epoch: 21 | loss: 0.0217264
	speed: 0.0653s/iter; left time: 2423.2666s
Epoch: 21 cost time: 31.76750683784485
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
Validation loss decreased (-0.971982 --> -0.973984).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0049148
	speed: 0.2797s/iter; left time: 10336.0822s
	iters: 200, epoch: 22 | loss: 0.2325509
	speed: 0.0657s/iter; left time: 2422.2143s
	iters: 300, epoch: 22 | loss: 0.0311918
	speed: 0.0665s/iter; left time: 2445.7634s
	iters: 400, epoch: 22 | loss: 0.0013853
	speed: 0.0623s/iter; left time: 2282.9934s
Epoch: 22 cost time: 30.816847562789917
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000943
	speed: 0.2455s/iter; left time: 8958.3246s
	iters: 200, epoch: 23 | loss: 0.0019298
	speed: 0.0671s/iter; left time: 2439.5547s
	iters: 300, epoch: 23 | loss: 0.0034428
	speed: 0.0624s/iter; left time: 2265.6697s
	iters: 400, epoch: 23 | loss: 0.0008550
	speed: 0.0654s/iter; left time: 2365.4729s
Epoch: 23 cost time: 29.79864001274109
Epoch: 23, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.209 Vali Acc: 0.968 Test Loss: 0.209 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0004303
	speed: 0.1750s/iter; left time: 6302.8810s
	iters: 200, epoch: 24 | loss: 0.0177620
	speed: 0.0435s/iter; left time: 1563.3852s
	iters: 300, epoch: 24 | loss: 0.0173847
	speed: 0.0478s/iter; left time: 1711.8119s
	iters: 400, epoch: 24 | loss: 0.0056770
	speed: 0.0534s/iter; left time: 1907.4610s
Epoch: 24 cost time: 23.195096015930176
Epoch: 24, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0554548
	speed: 0.1614s/iter; left time: 5737.4935s
	iters: 200, epoch: 25 | loss: 0.0002669
	speed: 0.0481s/iter; left time: 1703.8561s
	iters: 300, epoch: 25 | loss: 0.0008021
	speed: 0.0614s/iter; left time: 2170.2461s
	iters: 400, epoch: 25 | loss: 0.0074404
	speed: 0.0630s/iter; left time: 2219.2702s
Epoch: 25 cost time: 26.922990560531616
Epoch: 25, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.966 Test Loss: 0.198 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1944510
	speed: 0.2878s/iter; left time: 10094.6506s
	iters: 200, epoch: 26 | loss: 0.0003238
	speed: 0.0636s/iter; left time: 2224.1066s
	iters: 300, epoch: 26 | loss: 0.0004111
	speed: 0.0615s/iter; left time: 2143.6901s
	iters: 400, epoch: 26 | loss: 0.3080814
	speed: 0.0621s/iter; left time: 2160.8591s
Epoch: 26 cost time: 29.919424057006836
Epoch: 26, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0082579
	speed: 0.2716s/iter; left time: 9398.0021s
	iters: 200, epoch: 27 | loss: 0.0040432
	speed: 0.0649s/iter; left time: 2241.0293s
	iters: 300, epoch: 27 | loss: 0.0007084
	speed: 0.0610s/iter; left time: 2097.5339s
	iters: 400, epoch: 27 | loss: 0.0000756
	speed: 0.0633s/iter; left time: 2172.9132s
Epoch: 27 cost time: 30.55222177505493
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0001617
	speed: 0.2920s/iter; left time: 9968.4542s
	iters: 200, epoch: 28 | loss: 0.0096952
	speed: 0.0653s/iter; left time: 2221.6056s
	iters: 300, epoch: 28 | loss: 0.0607249
	speed: 0.0641s/iter; left time: 2176.9106s
	iters: 400, epoch: 28 | loss: 0.0000021
	speed: 0.0653s/iter; left time: 2210.3676s
Epoch: 28 cost time: 31.042802095413208
Epoch: 28, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0753673
	speed: 0.2842s/iter; left time: 9570.1491s
	iters: 200, epoch: 29 | loss: 0.0000255
	speed: 0.0616s/iter; left time: 2067.8790s
	iters: 300, epoch: 29 | loss: 0.0003565
	speed: 0.0633s/iter; left time: 2119.6237s
	iters: 400, epoch: 29 | loss: 0.0001038
	speed: 0.0618s/iter; left time: 2060.9731s
Epoch: 29 cost time: 29.72285747528076
Epoch: 29, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0543445
	speed: 0.2798s/iter; left time: 9288.9156s
	iters: 200, epoch: 30 | loss: 0.0285219
	speed: 0.0689s/iter; left time: 2282.1825s
	iters: 300, epoch: 30 | loss: 0.4326365
	speed: 0.0661s/iter; left time: 2181.8307s
	iters: 400, epoch: 30 | loss: 0.0128762
	speed: 0.0655s/iter; left time: 2155.6768s
Epoch: 30 cost time: 31.951951026916504
Epoch: 30, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.1191708
	speed: 0.2901s/iter; left time: 9496.7272s
	iters: 200, epoch: 31 | loss: 0.0781214
	speed: 0.0662s/iter; left time: 2159.7999s
	iters: 300, epoch: 31 | loss: 0.0355567
	speed: 0.0628s/iter; left time: 2041.3283s
	iters: 400, epoch: 31 | loss: 0.3650385
	speed: 0.0643s/iter; left time: 2085.4509s
Epoch: 31 cost time: 30.82111144065857
Epoch: 31, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.962 Test Loss: 0.227 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 7933450
model size : 49.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.0951247
	speed: 0.0761s/iter; left time: 3562.6735s
	iters: 200, epoch: 1 | loss: 0.1118952
	speed: 0.0639s/iter; left time: 2985.5617s
	iters: 300, epoch: 1 | loss: 0.1679042
	speed: 0.0649s/iter; left time: 3025.9700s
	iters: 400, epoch: 1 | loss: 0.0490354
	speed: 0.0633s/iter; left time: 2942.7642s
Epoch: 1 cost time: 31.37143564224243
Epoch: 1, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (inf --> -0.927956).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0657708
	speed: 0.2707s/iter; left time: 12541.4764s
	iters: 200, epoch: 2 | loss: 0.1794095
	speed: 0.0662s/iter; left time: 3060.9776s
	iters: 300, epoch: 2 | loss: 0.1112936
	speed: 0.0682s/iter; left time: 3147.8134s
	iters: 400, epoch: 2 | loss: 0.1033999
	speed: 0.0661s/iter; left time: 3042.5364s
Epoch: 2 cost time: 31.7712140083313
Epoch: 2, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.459 Vali Acc: 0.904 Test Loss: 0.459 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0697514
	speed: 0.2767s/iter; left time: 12691.5862s
	iters: 200, epoch: 3 | loss: 0.0416189
	speed: 0.0671s/iter; left time: 3070.7602s
	iters: 300, epoch: 3 | loss: 0.0227969
	speed: 0.0688s/iter; left time: 3139.7819s
	iters: 400, epoch: 3 | loss: 0.0060743
	speed: 0.0665s/iter; left time: 3031.1426s
Epoch: 3 cost time: 31.939198970794678
Epoch: 3, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.372 Vali Acc: 0.914 Test Loss: 0.372 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0488284
	speed: 0.2650s/iter; left time: 12031.4718s
	iters: 200, epoch: 4 | loss: 0.7316468
	speed: 0.0614s/iter; left time: 2780.8510s
	iters: 300, epoch: 4 | loss: 0.0012412
	speed: 0.0640s/iter; left time: 2893.9827s
	iters: 400, epoch: 4 | loss: 0.1391574
	speed: 0.0598s/iter; left time: 2695.9086s
Epoch: 4 cost time: 29.411248207092285
Epoch: 4, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.283 Vali Acc: 0.912 Test Loss: 0.283 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3207713
	speed: 0.2774s/iter; left time: 12460.5863s
	iters: 200, epoch: 5 | loss: 0.1450908
	speed: 0.0673s/iter; left time: 3015.8535s
	iters: 300, epoch: 5 | loss: 0.0014057
	speed: 0.0699s/iter; left time: 3124.7044s
	iters: 400, epoch: 5 | loss: 0.1586789
	speed: 0.0712s/iter; left time: 3177.9311s
Epoch: 5 cost time: 32.481361627578735
Epoch: 5, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.493 Vali Acc: 0.890 Test Loss: 0.493 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0095977
	speed: 0.2778s/iter; left time: 12350.8276s
	iters: 200, epoch: 6 | loss: 0.0070173
	speed: 0.0669s/iter; left time: 2968.7008s
	iters: 300, epoch: 6 | loss: 0.0098581
	speed: 0.0695s/iter; left time: 3074.0077s
	iters: 400, epoch: 6 | loss: 0.0547755
	speed: 0.0683s/iter; left time: 3015.8016s
Epoch: 6 cost time: 31.77252721786499
Epoch: 6, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.927956 --> -0.950826).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0027863
	speed: 0.2619s/iter; left time: 11519.0620s
	iters: 200, epoch: 7 | loss: 0.0217156
	speed: 0.0622s/iter; left time: 2729.1525s
	iters: 300, epoch: 7 | loss: 0.0245594
	speed: 0.0637s/iter; left time: 2790.5142s
	iters: 400, epoch: 7 | loss: 0.0112325
	speed: 0.0677s/iter; left time: 2956.3971s
Epoch: 7 cost time: 30.433748245239258
Epoch: 7, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4177329
	speed: 0.2738s/iter; left time: 11914.5770s
	iters: 200, epoch: 8 | loss: 0.0028348
	speed: 0.0680s/iter; left time: 2950.4092s
	iters: 300, epoch: 8 | loss: 0.1357297
	speed: 0.0680s/iter; left time: 2947.0269s
	iters: 400, epoch: 8 | loss: 0.5575202
	speed: 0.0685s/iter; left time: 2960.7504s
Epoch: 8 cost time: 31.82006812095642
Epoch: 8, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.310 Vali Acc: 0.942 Test Loss: 0.310 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6908982
	speed: 0.2652s/iter; left time: 11416.7746s
	iters: 200, epoch: 9 | loss: 0.0071334
	speed: 0.0653s/iter; left time: 2803.9211s
	iters: 300, epoch: 9 | loss: 0.0234003
	speed: 0.0633s/iter; left time: 2713.3570s
	iters: 400, epoch: 9 | loss: 0.0018432
	speed: 0.0703s/iter; left time: 3005.7163s
Epoch: 9 cost time: 30.989901781082153
Epoch: 9, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.276 Vali Acc: 0.953 Test Loss: 0.276 Test Acc: 0.953
Validation loss decreased (-0.950826 --> -0.953399).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0203643
	speed: 0.2832s/iter; left time: 12057.2133s
	iters: 200, epoch: 10 | loss: 0.0174415
	speed: 0.0629s/iter; left time: 2672.3689s
	iters: 300, epoch: 10 | loss: 0.0322000
	speed: 0.0628s/iter; left time: 2662.4447s
	iters: 400, epoch: 10 | loss: 0.0241460
	speed: 0.0654s/iter; left time: 2765.2603s
Epoch: 10 cost time: 29.90640664100647
Epoch: 10, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.297 Vali Acc: 0.946 Test Loss: 0.297 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0073525
	speed: 0.2702s/iter; left time: 11377.7501s
	iters: 200, epoch: 11 | loss: 0.0053568
	speed: 0.0708s/iter; left time: 2973.1545s
	iters: 300, epoch: 11 | loss: 0.0834443
	speed: 0.0668s/iter; left time: 2798.5623s
	iters: 400, epoch: 11 | loss: 0.0006966
	speed: 0.0663s/iter; left time: 2773.2854s
Epoch: 11 cost time: 32.09460473060608
Epoch: 11, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.440 Vali Acc: 0.907 Test Loss: 0.440 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0190421
	speed: 0.2761s/iter; left time: 11497.7363s
	iters: 200, epoch: 12 | loss: 0.0071975
	speed: 0.0730s/iter; left time: 3030.5189s
	iters: 300, epoch: 12 | loss: 0.0002092
	speed: 0.0699s/iter; left time: 2898.5155s
	iters: 400, epoch: 12 | loss: 0.0016613
	speed: 0.0620s/iter; left time: 2561.3460s
Epoch: 12 cost time: 32.24665379524231
Epoch: 12, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.948 Test Loss: 0.282 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1248055
	speed: 0.2798s/iter; left time: 11521.1212s
	iters: 200, epoch: 13 | loss: 0.0083404
	speed: 0.0682s/iter; left time: 2802.6651s
	iters: 300, epoch: 13 | loss: 0.0002350
	speed: 0.0633s/iter; left time: 2592.7080s
	iters: 400, epoch: 13 | loss: 0.0005454
	speed: 0.0624s/iter; left time: 2552.1982s
Epoch: 13 cost time: 30.702971696853638
Epoch: 13, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.221 Vali Acc: 0.961 Test Loss: 0.221 Test Acc: 0.961
Validation loss decreased (-0.953399 --> -0.961404).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0014999
	speed: 0.2603s/iter; left time: 10595.1441s
	iters: 200, epoch: 14 | loss: 0.0005773
	speed: 0.0689s/iter; left time: 2799.2499s
	iters: 300, epoch: 14 | loss: 0.0229482
	speed: 0.0672s/iter; left time: 2723.7576s
	iters: 400, epoch: 14 | loss: 0.0294795
	speed: 0.0681s/iter; left time: 2749.9974s
Epoch: 14 cost time: 31.911139965057373
Epoch: 14, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
Validation loss decreased (-0.961404 --> -0.975985).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0544757
	speed: 0.2965s/iter; left time: 11928.0196s
	iters: 200, epoch: 15 | loss: 0.0293797
	speed: 0.0698s/iter; left time: 2803.2745s
	iters: 300, epoch: 15 | loss: 0.0002449
	speed: 0.0724s/iter; left time: 2900.3290s
	iters: 400, epoch: 15 | loss: 0.0010364
	speed: 0.0689s/iter; left time: 2749.6352s
Epoch: 15 cost time: 32.996150493621826
Epoch: 15, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.596 Vali Acc: 0.931 Test Loss: 0.596 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0022906
	speed: 0.2775s/iter; left time: 11034.5189s
	iters: 200, epoch: 16 | loss: 0.0046653
	speed: 0.0660s/iter; left time: 2618.5193s
	iters: 300, epoch: 16 | loss: 0.0000824
	speed: 0.0629s/iter; left time: 2490.6667s
	iters: 400, epoch: 16 | loss: 0.0021605
	speed: 0.0628s/iter; left time: 2477.4672s
Epoch: 16 cost time: 30.266107320785522
Epoch: 16, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0073391
	speed: 0.2764s/iter; left time: 10861.7542s
	iters: 200, epoch: 17 | loss: 0.0016461
	speed: 0.0694s/iter; left time: 2720.1647s
	iters: 300, epoch: 17 | loss: 0.0003016
	speed: 0.0673s/iter; left time: 2631.7532s
	iters: 400, epoch: 17 | loss: 0.2750367
	speed: 0.0668s/iter; left time: 2605.8174s
Epoch: 17 cost time: 32.42752003669739
Epoch: 17, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.289 Vali Acc: 0.956 Test Loss: 0.289 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0002761
	speed: 0.2926s/iter; left time: 11362.7769s
	iters: 200, epoch: 18 | loss: 0.0002186
	speed: 0.0686s/iter; left time: 2656.9339s
	iters: 300, epoch: 18 | loss: 0.0007726
	speed: 0.0652s/iter; left time: 2518.3881s
	iters: 400, epoch: 18 | loss: 0.0025257
	speed: 0.0668s/iter; left time: 2572.2243s
Epoch: 18 cost time: 32.18911933898926
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000659
	speed: 0.2656s/iter; left time: 10186.6083s
	iters: 200, epoch: 19 | loss: 0.0013632
	speed: 0.0615s/iter; left time: 2354.6675s
	iters: 300, epoch: 19 | loss: 0.2268251
	speed: 0.0633s/iter; left time: 2414.7135s
	iters: 400, epoch: 19 | loss: 0.0005399
	speed: 0.0615s/iter; left time: 2340.4192s
Epoch: 19 cost time: 29.452627182006836
Epoch: 19, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.396 Vali Acc: 0.940 Test Loss: 0.396 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000297
	speed: 0.2692s/iter; left time: 10201.1781s
	iters: 200, epoch: 20 | loss: 0.0002225
	speed: 0.0657s/iter; left time: 2482.6549s
	iters: 300, epoch: 20 | loss: 0.0026853
	speed: 0.0668s/iter; left time: 2516.8493s
	iters: 400, epoch: 20 | loss: 0.0227683
	speed: 0.0653s/iter; left time: 2455.4336s
Epoch: 20 cost time: 30.9020037651062
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0084443
	speed: 0.2770s/iter; left time: 10364.0228s
	iters: 200, epoch: 21 | loss: 0.0169387
	speed: 0.0641s/iter; left time: 2393.1815s
	iters: 300, epoch: 21 | loss: 0.0022422
	speed: 0.0667s/iter; left time: 2484.1162s
	iters: 400, epoch: 21 | loss: 0.1457626
	speed: 0.0614s/iter; left time: 2278.2729s
Epoch: 21 cost time: 30.688570261001587
Epoch: 21, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1859706
	speed: 0.2654s/iter; left time: 9806.4864s
	iters: 200, epoch: 22 | loss: 0.0337407
	speed: 0.0632s/iter; left time: 2330.6181s
	iters: 300, epoch: 22 | loss: 0.0001075
	speed: 0.0632s/iter; left time: 2323.8565s
	iters: 400, epoch: 22 | loss: 0.3187384
	speed: 0.0623s/iter; left time: 2285.0197s
Epoch: 22 cost time: 30.085105895996094
Epoch: 22, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0035977
	speed: 0.2665s/iter; left time: 9724.2066s
	iters: 200, epoch: 23 | loss: 0.0026307
	speed: 0.0671s/iter; left time: 2441.3020s
	iters: 300, epoch: 23 | loss: 0.0003924
	speed: 0.0655s/iter; left time: 2377.4644s
	iters: 400, epoch: 23 | loss: 0.0025771
	speed: 0.0659s/iter; left time: 2383.1659s
Epoch: 23 cost time: 31.29953360557556
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.305 Vali Acc: 0.951 Test Loss: 0.305 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0004825
	speed: 0.2692s/iter; left time: 9694.6704s
	iters: 200, epoch: 24 | loss: 0.0000797
	speed: 0.0652s/iter; left time: 2341.8585s
	iters: 300, epoch: 24 | loss: 0.2430392
	speed: 0.0645s/iter; left time: 2308.6203s
	iters: 400, epoch: 24 | loss: 0.1480599
	speed: 0.0616s/iter; left time: 2200.4669s
Epoch: 24 cost time: 30.407255172729492
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.328 Vali Acc: 0.935 Test Loss: 0.328 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 7933450
model size : 49.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.0995842
	speed: 0.0788s/iter; left time: 3687.9567s
	iters: 200, epoch: 1 | loss: 0.0622211
	speed: 0.0628s/iter; left time: 2934.6680s
	iters: 300, epoch: 1 | loss: 0.1203721
	speed: 0.0624s/iter; left time: 2909.7706s
	iters: 400, epoch: 1 | loss: 0.1461228
	speed: 0.0601s/iter; left time: 2794.2349s
Epoch: 1 cost time: 30.95874524116516
Epoch: 1, Steps: 469 | Train Loss: 0.320 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (inf --> -0.941107).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0736394
	speed: 0.2775s/iter; left time: 12857.5700s
	iters: 200, epoch: 2 | loss: 0.0300007
	speed: 0.0638s/iter; left time: 2947.6615s
	iters: 300, epoch: 2 | loss: 0.0945919
	speed: 0.0602s/iter; left time: 2775.5091s
	iters: 400, epoch: 2 | loss: 0.0065904
	speed: 0.0614s/iter; left time: 2826.0423s
Epoch: 2 cost time: 29.40069007873535
Epoch: 2, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.941107 --> -0.943680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1690327
	speed: 0.2790s/iter; left time: 12795.8238s
	iters: 200, epoch: 3 | loss: 0.0151821
	speed: 0.0656s/iter; left time: 3004.1144s
	iters: 300, epoch: 3 | loss: 0.2464850
	speed: 0.0622s/iter; left time: 2839.7855s
	iters: 400, epoch: 3 | loss: 0.0377162
	speed: 0.0636s/iter; left time: 2899.8554s
Epoch: 3 cost time: 30.29072070121765
Epoch: 3, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0028129
	speed: 0.2779s/iter; left time: 12615.5222s
	iters: 200, epoch: 4 | loss: 0.2798114
	speed: 0.0650s/iter; left time: 2942.3431s
	iters: 300, epoch: 4 | loss: 0.0028697
	speed: 0.0643s/iter; left time: 2907.1166s
	iters: 400, epoch: 4 | loss: 0.0295802
	speed: 0.0587s/iter; left time: 2649.1817s
Epoch: 4 cost time: 29.88178253173828
Epoch: 4, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
Validation loss decreased (-0.943680 --> -0.960833).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4561601
	speed: 0.2514s/iter; left time: 11295.6665s
	iters: 200, epoch: 5 | loss: 0.0729977
	speed: 0.0649s/iter; left time: 2907.3067s
	iters: 300, epoch: 5 | loss: 0.0099143
	speed: 0.0666s/iter; left time: 2979.8333s
	iters: 400, epoch: 5 | loss: 0.2333034
	speed: 0.0642s/iter; left time: 2865.9240s
Epoch: 5 cost time: 30.75499963760376
Epoch: 5, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.212 Vali Acc: 0.955 Test Loss: 0.212 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0359193
	speed: 0.2672s/iter; left time: 11878.8463s
	iters: 200, epoch: 6 | loss: 0.0011723
	speed: 0.0667s/iter; left time: 2956.5693s
	iters: 300, epoch: 6 | loss: 0.0209933
	speed: 0.0676s/iter; left time: 2991.3487s
	iters: 400, epoch: 6 | loss: 0.0120366
	speed: 0.0653s/iter; left time: 2883.4543s
Epoch: 6 cost time: 31.467779397964478
Epoch: 6, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0753617
	speed: 0.2759s/iter; left time: 12135.8691s
	iters: 200, epoch: 7 | loss: 0.0380063
	speed: 0.0695s/iter; left time: 3050.8662s
	iters: 300, epoch: 7 | loss: 0.0081500
	speed: 0.0641s/iter; left time: 2807.4849s
	iters: 400, epoch: 7 | loss: 0.0000953
	speed: 0.0629s/iter; left time: 2749.0283s
Epoch: 7 cost time: 31.083839178085327
Epoch: 7, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.237 Vali Acc: 0.945 Test Loss: 0.237 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1333909
	speed: 0.2513s/iter; left time: 10935.8513s
	iters: 200, epoch: 8 | loss: 0.0027161
	speed: 0.0657s/iter; left time: 2854.5186s
	iters: 300, epoch: 8 | loss: 0.0067199
	speed: 0.0688s/iter; left time: 2979.5025s
	iters: 400, epoch: 8 | loss: 0.0003866
	speed: 0.0709s/iter; left time: 3064.4182s
Epoch: 8 cost time: 31.78452157974243
Epoch: 8, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0084671
	speed: 0.2728s/iter; left time: 11745.5834s
	iters: 200, epoch: 9 | loss: 0.0015916
	speed: 0.0656s/iter; left time: 2817.1893s
	iters: 300, epoch: 9 | loss: 0.1714267
	speed: 0.0668s/iter; left time: 2862.6269s
	iters: 400, epoch: 9 | loss: 0.0257403
	speed: 0.0702s/iter; left time: 2999.4785s
Epoch: 9 cost time: 31.84463334083557
Epoch: 9, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6211083
	speed: 0.2666s/iter; left time: 11351.7296s
	iters: 200, epoch: 10 | loss: 0.1775237
	speed: 0.0674s/iter; left time: 2863.5107s
	iters: 300, epoch: 10 | loss: 0.0201129
	speed: 0.0608s/iter; left time: 2575.9817s
	iters: 400, epoch: 10 | loss: 0.0141629
	speed: 0.0638s/iter; left time: 2697.1231s
Epoch: 10 cost time: 29.55474066734314
Epoch: 10, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0004411
	speed: 0.1695s/iter; left time: 7139.4017s
	iters: 200, epoch: 11 | loss: 0.0063223
	speed: 0.0477s/iter; left time: 2002.9358s
	iters: 300, epoch: 11 | loss: 0.0217241
	speed: 0.0466s/iter; left time: 1953.3143s
	iters: 400, epoch: 11 | loss: 0.0818454
	speed: 0.0504s/iter; left time: 2107.1771s
Epoch: 11 cost time: 22.990614414215088
Epoch: 11, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.640 Vali Acc: 0.877 Test Loss: 0.640 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0023331
	speed: 0.1825s/iter; left time: 7597.8744s
	iters: 200, epoch: 12 | loss: 0.0257873
	speed: 0.0657s/iter; left time: 2728.2023s
	iters: 300, epoch: 12 | loss: 0.1076263
	speed: 0.0620s/iter; left time: 2568.8067s
	iters: 400, epoch: 12 | loss: 0.1836677
	speed: 0.0650s/iter; left time: 2685.6496s
Epoch: 12 cost time: 30.354693174362183
Epoch: 12, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0023007
	speed: 0.2937s/iter; left time: 12090.6376s
	iters: 200, epoch: 13 | loss: 0.3798923
	speed: 0.0652s/iter; left time: 2678.9255s
	iters: 300, epoch: 13 | loss: 0.0005777
	speed: 0.0623s/iter; left time: 2551.3596s
	iters: 400, epoch: 13 | loss: 0.0160704
	speed: 0.0630s/iter; left time: 2575.5387s
Epoch: 13 cost time: 30.238099336624146
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
Validation loss decreased (-0.960833 --> -0.964264).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0013525
	speed: 0.2720s/iter; left time: 11069.7815s
	iters: 200, epoch: 14 | loss: 0.0002544
	speed: 0.0624s/iter; left time: 2533.7982s
	iters: 300, epoch: 14 | loss: 0.6305047
	speed: 0.0613s/iter; left time: 2482.3604s
	iters: 400, epoch: 14 | loss: 0.0185942
	speed: 0.0601s/iter; left time: 2428.5812s
Epoch: 14 cost time: 29.340842962265015
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.964264 --> -0.970839).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0644828
	speed: 0.2856s/iter; left time: 11491.4446s
	iters: 200, epoch: 15 | loss: 0.0004895
	speed: 0.0649s/iter; left time: 2604.0392s
	iters: 300, epoch: 15 | loss: 0.0003067
	speed: 0.0577s/iter; left time: 2311.5816s
	iters: 400, epoch: 15 | loss: 0.0001519
	speed: 0.0653s/iter; left time: 2607.8636s
Epoch: 15 cost time: 29.981743812561035
Epoch: 15, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0101961
	speed: 0.2934s/iter; left time: 11668.1458s
	iters: 200, epoch: 16 | loss: 0.3492605
	speed: 0.0680s/iter; left time: 2696.4312s
	iters: 300, epoch: 16 | loss: 0.0815314
	speed: 0.0641s/iter; left time: 2535.5424s
	iters: 400, epoch: 16 | loss: 0.0686169
	speed: 0.0644s/iter; left time: 2542.2328s
Epoch: 16 cost time: 31.316171646118164
Epoch: 16, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.267 Vali Acc: 0.939 Test Loss: 0.267 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0011661
	speed: 0.2666s/iter; left time: 10476.5716s
	iters: 200, epoch: 17 | loss: 0.0003017
	speed: 0.0658s/iter; left time: 2580.9829s
	iters: 300, epoch: 17 | loss: 0.0294160
	speed: 0.0612s/iter; left time: 2393.4641s
	iters: 400, epoch: 17 | loss: 0.0163388
	speed: 0.0631s/iter; left time: 2461.6234s
Epoch: 17 cost time: 29.936433792114258
Epoch: 17, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.956 Test Loss: 0.257 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000326
	speed: 0.2769s/iter; left time: 10750.1016s
	iters: 200, epoch: 18 | loss: 0.0000081
	speed: 0.0694s/iter; left time: 2686.5424s
	iters: 300, epoch: 18 | loss: 0.0001163
	speed: 0.0646s/iter; left time: 2497.0516s
	iters: 400, epoch: 18 | loss: 0.1147897
	speed: 0.0615s/iter; left time: 2368.0522s
Epoch: 18 cost time: 30.938592433929443
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0487679
	speed: 0.2844s/iter; left time: 10908.6133s
	iters: 200, epoch: 19 | loss: 0.0002787
	speed: 0.0695s/iter; left time: 2659.7109s
	iters: 300, epoch: 19 | loss: 0.0213440
	speed: 0.0663s/iter; left time: 2530.2682s
	iters: 400, epoch: 19 | loss: 0.0001780
	speed: 0.0630s/iter; left time: 2395.8515s
Epoch: 19 cost time: 31.416240453720093
Epoch: 19, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0218783
	speed: 0.2722s/iter; left time: 10314.4745s
	iters: 200, epoch: 20 | loss: 0.0001378
	speed: 0.0647s/iter; left time: 2444.5671s
	iters: 300, epoch: 20 | loss: 0.0595725
	speed: 0.0622s/iter; left time: 2342.5862s
	iters: 400, epoch: 20 | loss: 0.0749970
	speed: 0.0573s/iter; left time: 2154.6803s
Epoch: 20 cost time: 29.25867533683777
Epoch: 20, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0333214
	speed: 0.2674s/iter; left time: 10005.4509s
	iters: 200, epoch: 21 | loss: 0.1875061
	speed: 0.0686s/iter; left time: 2559.7846s
	iters: 300, epoch: 21 | loss: 0.0028843
	speed: 0.0688s/iter; left time: 2559.9227s
	iters: 400, epoch: 21 | loss: 0.3668806
	speed: 0.0649s/iter; left time: 2410.4877s
Epoch: 21 cost time: 31.803305625915527
Epoch: 21, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0069494
	speed: 0.2650s/iter; left time: 9791.7890s
	iters: 200, epoch: 22 | loss: 0.0036574
	speed: 0.0676s/iter; left time: 2491.5951s
	iters: 300, epoch: 22 | loss: 0.0015320
	speed: 0.0687s/iter; left time: 2524.7197s
	iters: 400, epoch: 22 | loss: 0.4803755
	speed: 0.0686s/iter; left time: 2512.7023s
Epoch: 22 cost time: 31.81558346748352
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972840).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0001080
	speed: 0.2783s/iter; left time: 10153.4919s
	iters: 200, epoch: 23 | loss: 0.0502435
	speed: 0.0664s/iter; left time: 2417.3857s
	iters: 300, epoch: 23 | loss: 0.0019474
	speed: 0.0636s/iter; left time: 2308.5133s
	iters: 400, epoch: 23 | loss: 0.0016681
	speed: 0.0656s/iter; left time: 2373.7510s
Epoch: 23 cost time: 30.51054334640503
Epoch: 23, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0004849
	speed: 0.2441s/iter; left time: 8792.2906s
	iters: 200, epoch: 24 | loss: 0.0113165
	speed: 0.0665s/iter; left time: 2389.4050s
	iters: 300, epoch: 24 | loss: 0.3463279
	speed: 0.0672s/iter; left time: 2407.7229s
	iters: 400, epoch: 24 | loss: 0.1262536
	speed: 0.0680s/iter; left time: 2429.7780s
Epoch: 24 cost time: 31.935733318328857
Epoch: 24, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0100446
	speed: 0.2728s/iter; left time: 9696.5990s
	iters: 200, epoch: 25 | loss: 0.0005497
	speed: 0.0683s/iter; left time: 2420.4695s
	iters: 300, epoch: 25 | loss: 0.0000465
	speed: 0.0696s/iter; left time: 2458.9144s
	iters: 400, epoch: 25 | loss: 0.0008320
	speed: 0.0684s/iter; left time: 2409.5825s
Epoch: 25 cost time: 32.348026514053345
Epoch: 25, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.962 Test Loss: 0.210 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0008007
	speed: 0.2531s/iter; left time: 8877.4858s
	iters: 200, epoch: 26 | loss: 0.0091750
	speed: 0.0644s/iter; left time: 2253.3529s
	iters: 300, epoch: 26 | loss: 0.0033147
	speed: 0.0666s/iter; left time: 2321.0430s
	iters: 400, epoch: 26 | loss: 0.0125773
	speed: 0.0674s/iter; left time: 2343.0440s
Epoch: 26 cost time: 30.858404636383057
Epoch: 26, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973126).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0039889
	speed: 0.2664s/iter; left time: 9217.6216s
	iters: 200, epoch: 27 | loss: 0.0000294
	speed: 0.0650s/iter; left time: 2243.2657s
	iters: 300, epoch: 27 | loss: 0.0001491
	speed: 0.0692s/iter; left time: 2379.6857s
	iters: 400, epoch: 27 | loss: 0.0027581
	speed: 0.0690s/iter; left time: 2368.8937s
Epoch: 27 cost time: 31.388598918914795
Epoch: 27, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000203
	speed: 0.2596s/iter; left time: 8861.9115s
	iters: 200, epoch: 28 | loss: 0.0005899
	speed: 0.0642s/iter; left time: 2186.6622s
	iters: 300, epoch: 28 | loss: 0.0092928
	speed: 0.0693s/iter; left time: 2350.9531s
	iters: 400, epoch: 28 | loss: 0.0001441
	speed: 0.0700s/iter; left time: 2368.9298s
Epoch: 28 cost time: 31.657700300216675
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0022803
	speed: 0.2791s/iter; left time: 9396.0127s
	iters: 200, epoch: 29 | loss: 0.0001414
	speed: 0.0623s/iter; left time: 2092.4534s
	iters: 300, epoch: 29 | loss: 0.0005016
	speed: 0.0632s/iter; left time: 2114.2607s
	iters: 400, epoch: 29 | loss: 0.0038741
	speed: 0.0642s/iter; left time: 2142.8900s
Epoch: 29 cost time: 30.0480740070343
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0095504
	speed: 0.2492s/iter; left time: 8273.0777s
	iters: 200, epoch: 30 | loss: 0.0016651
	speed: 0.0635s/iter; left time: 2103.4563s
	iters: 300, epoch: 30 | loss: 0.0157233
	speed: 0.0687s/iter; left time: 2266.3314s
	iters: 400, epoch: 30 | loss: 0.0644565
	speed: 0.0664s/iter; left time: 2184.2435s
Epoch: 30 cost time: 31.050879955291748
Epoch: 30, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0347745
	speed: 0.2887s/iter; left time: 9450.1898s
	iters: 200, epoch: 31 | loss: 0.0014177
	speed: 0.0623s/iter; left time: 2033.2850s
	iters: 300, epoch: 31 | loss: 0.0021158
	speed: 0.0663s/iter; left time: 2156.1400s
	iters: 400, epoch: 31 | loss: 0.6246237
	speed: 0.0677s/iter; left time: 2195.0494s
Epoch: 31 cost time: 31.231842279434204
Epoch: 31, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.951 Test Loss: 0.266 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.2273706
	speed: 0.2712s/iter; left time: 8748.7499s
	iters: 200, epoch: 32 | loss: 0.0005698
	speed: 0.0625s/iter; left time: 2010.7456s
	iters: 300, epoch: 32 | loss: 0.0507970
	speed: 0.0620s/iter; left time: 1988.9050s
	iters: 400, epoch: 32 | loss: 0.0427968
	speed: 0.0637s/iter; left time: 2035.6393s
Epoch: 32 cost time: 29.748605728149414
Epoch: 32, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.968 Test Loss: 0.217 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0392417
	speed: 0.2758s/iter; left time: 8769.8632s
	iters: 200, epoch: 33 | loss: 0.0145602
	speed: 0.0643s/iter; left time: 2036.9747s
	iters: 300, epoch: 33 | loss: 0.0005540
	speed: 0.0629s/iter; left time: 1987.0263s
	iters: 400, epoch: 33 | loss: 0.1544411
	speed: 0.0676s/iter; left time: 2128.8558s
Epoch: 33 cost time: 30.52053928375244
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0003502
	speed: 0.2758s/iter; left time: 8637.8582s
	iters: 200, epoch: 34 | loss: 0.0000699
	speed: 0.0617s/iter; left time: 1926.7077s
	iters: 300, epoch: 34 | loss: 0.0132683
	speed: 0.0646s/iter; left time: 2009.0960s
	iters: 400, epoch: 34 | loss: 0.0005912
	speed: 0.0658s/iter; left time: 2040.4354s
Epoch: 34 cost time: 31.054610013961792
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0016943
	speed: 0.2888s/iter; left time: 8911.8457s
	iters: 200, epoch: 35 | loss: 0.0046322
	speed: 0.0617s/iter; left time: 1898.7455s
	iters: 300, epoch: 35 | loss: 0.0040670
	speed: 0.0624s/iter; left time: 1914.0518s
	iters: 400, epoch: 35 | loss: 0.0067277
	speed: 0.0652s/iter; left time: 1992.0584s
Epoch: 35 cost time: 29.36760711669922
Epoch: 35, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.209 Vali Acc: 0.961 Test Loss: 0.209 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0010972
	speed: 0.2507s/iter; left time: 7618.4173s
	iters: 200, epoch: 36 | loss: 0.0009108
	speed: 0.0639s/iter; left time: 1934.0318s
	iters: 300, epoch: 36 | loss: 0.2015707
	speed: 0.0627s/iter; left time: 1892.8477s
	iters: 400, epoch: 36 | loss: 0.0014739
	speed: 0.0648s/iter; left time: 1949.1659s
Epoch: 36 cost time: 30.493484497070312
Epoch: 36, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 7933450
model size : 49.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3036528
	speed: 0.0822s/iter; left time: 3849.2390s
	iters: 200, epoch: 1 | loss: 2.3029251
	speed: 0.0696s/iter; left time: 3250.0490s
	iters: 300, epoch: 1 | loss: 2.2995405
	speed: 0.0662s/iter; left time: 3085.9933s
	iters: 400, epoch: 1 | loss: 2.3041942
	speed: 0.0714s/iter; left time: 3320.2473s
Epoch: 1 cost time: 33.834375858306885
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3009284
	speed: 0.2764s/iter; left time: 12804.5449s
	iters: 200, epoch: 2 | loss: 2.3030789
	speed: 0.0694s/iter; left time: 3207.3071s
	iters: 300, epoch: 2 | loss: 2.3092430
	speed: 0.0683s/iter; left time: 3149.2739s
	iters: 400, epoch: 2 | loss: 2.2999775
	speed: 0.0647s/iter; left time: 2976.7028s
Epoch: 2 cost time: 31.535617351531982
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3148873
	speed: 0.2673s/iter; left time: 12258.4972s
	iters: 200, epoch: 3 | loss: 2.3063018
	speed: 0.0689s/iter; left time: 3154.6266s
	iters: 300, epoch: 3 | loss: 2.3041434
	speed: 0.0688s/iter; left time: 3139.4780s
	iters: 400, epoch: 3 | loss: 2.3043885
	speed: 0.0689s/iter; left time: 3139.3028s
Epoch: 3 cost time: 32.21556639671326
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2998743
	speed: 0.2903s/iter; left time: 13178.3491s
	iters: 200, epoch: 4 | loss: 2.2934575
	speed: 0.0702s/iter; left time: 3180.5272s
	iters: 300, epoch: 4 | loss: 2.3084271
	speed: 0.0707s/iter; left time: 3194.6081s
	iters: 400, epoch: 4 | loss: 2.3000312
	speed: 0.0667s/iter; left time: 3009.2517s
Epoch: 4 cost time: 32.74788498878479
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3006437
	speed: 0.2618s/iter; left time: 11760.3857s
	iters: 200, epoch: 5 | loss: 2.3205941
	speed: 0.0640s/iter; left time: 2866.8023s
	iters: 300, epoch: 5 | loss: 2.3166404
	speed: 0.0676s/iter; left time: 3025.1829s
	iters: 400, epoch: 5 | loss: 2.2934053
	speed: 0.0665s/iter; left time: 2966.5070s
Epoch: 5 cost time: 30.80683732032776
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3061435
	speed: 0.2770s/iter; left time: 12313.5863s
	iters: 200, epoch: 6 | loss: 2.3037283
	speed: 0.0677s/iter; left time: 3002.1680s
	iters: 300, epoch: 6 | loss: 2.3008134
	speed: 0.0690s/iter; left time: 3052.3504s
	iters: 400, epoch: 6 | loss: 2.2884030
	speed: 0.0706s/iter; left time: 3118.3965s
Epoch: 6 cost time: 32.75070667266846
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3019037
	speed: 0.2737s/iter; left time: 12041.3799s
	iters: 200, epoch: 7 | loss: 2.3054442
	speed: 0.0648s/iter; left time: 2844.2832s
	iters: 300, epoch: 7 | loss: 2.2968509
	speed: 0.0646s/iter; left time: 2827.1162s
	iters: 400, epoch: 7 | loss: 2.3122478
	speed: 0.0625s/iter; left time: 2732.0067s
Epoch: 7 cost time: 30.413576126098633
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2989383
	speed: 0.2879s/iter; left time: 12526.7848s
	iters: 200, epoch: 8 | loss: 2.3131635
	speed: 0.0653s/iter; left time: 2834.6969s
	iters: 300, epoch: 8 | loss: 2.3058028
	speed: 0.0658s/iter; left time: 2851.0155s
	iters: 400, epoch: 8 | loss: 2.2897544
	speed: 0.0640s/iter; left time: 2767.4477s
Epoch: 8 cost time: 31.28488540649414
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2983093
	speed: 0.2762s/iter; left time: 11888.6494s
	iters: 200, epoch: 9 | loss: 2.2822170
	speed: 0.0692s/iter; left time: 2971.8971s
	iters: 300, epoch: 9 | loss: 2.2993124
	speed: 0.0676s/iter; left time: 2895.5217s
	iters: 400, epoch: 9 | loss: 2.2888410
	speed: 0.0691s/iter; left time: 2952.8487s
Epoch: 9 cost time: 32.57745933532715
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3012528
	speed: 0.2940s/iter; left time: 12518.0754s
	iters: 200, epoch: 10 | loss: 2.3150907
	speed: 0.0687s/iter; left time: 2920.1407s
	iters: 300, epoch: 10 | loss: 2.2996602
	speed: 0.0664s/iter; left time: 2814.1030s
	iters: 400, epoch: 10 | loss: 2.2860985
	speed: 0.0658s/iter; left time: 2783.8082s
Epoch: 10 cost time: 32.04692268371582
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3088098
	speed: 0.2743s/iter; left time: 11549.3598s
	iters: 200, epoch: 11 | loss: 2.2969031
	speed: 0.0662s/iter; left time: 2779.1283s
	iters: 300, epoch: 11 | loss: 2.2939310
	speed: 0.0637s/iter; left time: 2668.2355s
	iters: 400, epoch: 11 | loss: 2.2996552
	speed: 0.0630s/iter; left time: 2633.8778s
Epoch: 11 cost time: 30.833426237106323
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3122995
	speed: 0.2823s/iter; left time: 11755.5229s
	iters: 200, epoch: 12 | loss: 2.3020599
	speed: 0.0641s/iter; left time: 2662.5414s
	iters: 300, epoch: 12 | loss: 2.2851048
	speed: 0.0649s/iter; left time: 2689.6905s
	iters: 400, epoch: 12 | loss: 2.2925718
	speed: 0.0612s/iter; left time: 2529.6676s
Epoch: 12 cost time: 30.58040475845337
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.2900951
	speed: 0.2939s/iter; left time: 12102.3956s
	iters: 200, epoch: 13 | loss: 2.2952650
	speed: 0.0666s/iter; left time: 2736.2714s
	iters: 300, epoch: 13 | loss: 2.3109033
	speed: 0.0653s/iter; left time: 2674.7643s
	iters: 400, epoch: 13 | loss: 2.3040943
	speed: 0.0656s/iter; left time: 2682.8534s
Epoch: 13 cost time: 31.752997875213623
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.2942169
	speed: 0.2982s/iter; left time: 12136.6501s
	iters: 200, epoch: 14 | loss: 2.3072271
	speed: 0.0636s/iter; left time: 2581.6068s
	iters: 300, epoch: 14 | loss: 2.2976322
	speed: 0.0619s/iter; left time: 2508.6491s
	iters: 400, epoch: 14 | loss: 2.3022912
	speed: 0.0630s/iter; left time: 2543.4382s
Epoch: 14 cost time: 30.345206022262573
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.3103635
	speed: 0.2180s/iter; left time: 8772.9234s
	iters: 200, epoch: 15 | loss: 2.2967944
	speed: 0.0499s/iter; left time: 2002.8256s
	iters: 300, epoch: 15 | loss: 2.3148639
	speed: 0.0492s/iter; left time: 1967.9795s
	iters: 400, epoch: 15 | loss: 2.3083105
	speed: 0.0530s/iter; left time: 2117.3915s
Epoch: 15 cost time: 24.50204110145569
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.3016841
	speed: 0.1752s/iter; left time: 6968.3885s
	iters: 200, epoch: 16 | loss: 2.3114548
	speed: 0.0645s/iter; left time: 2559.0229s
	iters: 300, epoch: 16 | loss: 2.2997417
	speed: 0.0650s/iter; left time: 2570.4562s
	iters: 400, epoch: 16 | loss: 2.3170059
	speed: 0.0659s/iter; left time: 2598.9112s
Epoch: 16 cost time: 29.549926280975342
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.2929533
	speed: 0.3010s/iter; left time: 11827.5727s
	iters: 200, epoch: 17 | loss: 2.2880812
	speed: 0.0672s/iter; left time: 2633.4033s
	iters: 300, epoch: 17 | loss: 2.3083861
	speed: 0.0597s/iter; left time: 2335.7746s
	iters: 400, epoch: 17 | loss: 2.3081539
	speed: 0.0615s/iter; left time: 2397.1151s
Epoch: 17 cost time: 30.700533866882324
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.3177290
	speed: 0.2773s/iter; left time: 10768.9368s
	iters: 200, epoch: 18 | loss: 2.2942195
	speed: 0.0661s/iter; left time: 2561.8095s
	iters: 300, epoch: 18 | loss: 2.2981029
	speed: 0.0643s/iter; left time: 2485.4823s
	iters: 400, epoch: 18 | loss: 2.3108673
	speed: 0.0618s/iter; left time: 2379.4744s
Epoch: 18 cost time: 30.949648141860962
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3132727
	speed: 0.2893s/iter; left time: 11098.6539s
	iters: 200, epoch: 19 | loss: 2.3007042
	speed: 0.0670s/iter; left time: 2562.0010s
	iters: 300, epoch: 19 | loss: 2.3208585
	speed: 0.0634s/iter; left time: 2419.1074s
	iters: 400, epoch: 19 | loss: 2.3109751
	speed: 0.0647s/iter; left time: 2461.1272s
Epoch: 19 cost time: 30.97670865058899
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 7933450
model size : 49.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2574070
	speed: 0.0769s/iter; left time: 3598.8851s
	iters: 200, epoch: 1 | loss: 0.1512685
	speed: 0.0626s/iter; left time: 2922.2194s
	iters: 300, epoch: 1 | loss: 0.0443866
	speed: 0.0599s/iter; left time: 2791.3734s
	iters: 400, epoch: 1 | loss: 0.0113295
	speed: 0.0626s/iter; left time: 2911.8673s
Epoch: 1 cost time: 30.472997903823853
Epoch: 1, Steps: 469 | Train Loss: 0.306 Vali Loss: 0.211 Vali Acc: 0.934 Test Loss: 0.211 Test Acc: 0.934
Validation loss decreased (inf --> -0.933960).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0887132
	speed: 0.2702s/iter; left time: 12519.2743s
	iters: 200, epoch: 2 | loss: 0.0360529
	speed: 0.0619s/iter; left time: 2860.9433s
	iters: 300, epoch: 2 | loss: 0.3388239
	speed: 0.0594s/iter; left time: 2738.3180s
	iters: 400, epoch: 2 | loss: 0.1033239
	speed: 0.0603s/iter; left time: 2773.9197s
Epoch: 2 cost time: 28.607791423797607
Epoch: 2, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1480966
	speed: 0.2372s/iter; left time: 10879.2168s
	iters: 200, epoch: 3 | loss: 0.0642656
	speed: 0.0574s/iter; left time: 2625.5428s
	iters: 300, epoch: 3 | loss: 0.0099573
	speed: 0.0597s/iter; left time: 2728.0073s
	iters: 400, epoch: 3 | loss: 0.0018965
	speed: 0.0636s/iter; left time: 2898.6127s
Epoch: 3 cost time: 28.76256489753723
Epoch: 3, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.933960 --> -0.947682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0024385
	speed: 0.2894s/iter; left time: 13136.3666s
	iters: 200, epoch: 4 | loss: 0.1044506
	speed: 0.0624s/iter; left time: 2826.9253s
	iters: 300, epoch: 4 | loss: 0.6139379
	speed: 0.0637s/iter; left time: 2877.7885s
	iters: 400, epoch: 4 | loss: 0.0806682
	speed: 0.0677s/iter; left time: 3051.7225s
Epoch: 4 cost time: 30.89849066734314
Epoch: 4, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.531 Vali Acc: 0.901 Test Loss: 0.531 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0189813
	speed: 0.2820s/iter; left time: 12667.3840s
	iters: 200, epoch: 5 | loss: 0.0704245
	speed: 0.0613s/iter; left time: 2749.4038s
	iters: 300, epoch: 5 | loss: 0.5425245
	speed: 0.0628s/iter; left time: 2806.9259s
	iters: 400, epoch: 5 | loss: 0.3429769
	speed: 0.0662s/iter; left time: 2953.8632s
Epoch: 5 cost time: 29.90247416496277
Epoch: 5, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.261 Vali Acc: 0.940 Test Loss: 0.261 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0090901
	speed: 0.2785s/iter; left time: 12382.1076s
	iters: 200, epoch: 6 | loss: 0.0136730
	speed: 0.0575s/iter; left time: 2551.2270s
	iters: 300, epoch: 6 | loss: 0.0029950
	speed: 0.0589s/iter; left time: 2604.5595s
	iters: 400, epoch: 6 | loss: 0.0018682
	speed: 0.0604s/iter; left time: 2669.0983s
Epoch: 6 cost time: 28.84809970855713
Epoch: 6, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.307 Vali Acc: 0.939 Test Loss: 0.307 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0073576
	speed: 0.2955s/iter; left time: 12996.3815s
	iters: 200, epoch: 7 | loss: 0.2849323
	speed: 0.0633s/iter; left time: 2776.0055s
	iters: 300, epoch: 7 | loss: 0.0074260
	speed: 0.0628s/iter; left time: 2749.9879s
	iters: 400, epoch: 7 | loss: 0.1777568
	speed: 0.0664s/iter; left time: 2903.0006s
Epoch: 7 cost time: 30.951271057128906
Epoch: 7, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
Validation loss decreased (-0.947682 --> -0.954258).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0682413
	speed: 0.2831s/iter; left time: 12321.7175s
	iters: 200, epoch: 8 | loss: 0.6149891
	speed: 0.0630s/iter; left time: 2736.0866s
	iters: 300, epoch: 8 | loss: 0.0333898
	speed: 0.0636s/iter; left time: 2755.9501s
	iters: 400, epoch: 8 | loss: 0.0239348
	speed: 0.0666s/iter; left time: 2878.2323s
Epoch: 8 cost time: 30.881889581680298
Epoch: 8, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.954258 --> -0.961977).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0009493
	speed: 0.2738s/iter; left time: 11786.8383s
	iters: 200, epoch: 9 | loss: 0.0290173
	speed: 0.0596s/iter; left time: 2558.8434s
	iters: 300, epoch: 9 | loss: 0.1071885
	speed: 0.0618s/iter; left time: 2650.0275s
	iters: 400, epoch: 9 | loss: 0.0028271
	speed: 0.0631s/iter; left time: 2696.3236s
Epoch: 9 cost time: 29.59786581993103
Epoch: 9, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0024255
	speed: 0.2943s/iter; left time: 12532.0130s
	iters: 200, epoch: 10 | loss: 0.0231126
	speed: 0.0611s/iter; left time: 2595.7251s
	iters: 300, epoch: 10 | loss: 0.0001027
	speed: 0.0625s/iter; left time: 2649.5375s
	iters: 400, epoch: 10 | loss: 0.0140100
	speed: 0.0656s/iter; left time: 2774.0111s
Epoch: 10 cost time: 30.726719617843628
Epoch: 10, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.421 Vali Acc: 0.914 Test Loss: 0.421 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0984472
	speed: 0.2925s/iter; left time: 12315.5966s
	iters: 200, epoch: 11 | loss: 0.1289899
	speed: 0.0644s/iter; left time: 2706.9871s
	iters: 300, epoch: 11 | loss: 0.0140912
	speed: 0.0625s/iter; left time: 2619.2404s
	iters: 400, epoch: 11 | loss: 0.0050536
	speed: 0.0656s/iter; left time: 2744.6056s
Epoch: 11 cost time: 30.623200178146362
Epoch: 11, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.961977 --> -0.966837).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0464151
	speed: 0.2655s/iter; left time: 11057.2467s
	iters: 200, epoch: 12 | loss: 0.5783319
	speed: 0.0602s/iter; left time: 2501.7232s
	iters: 300, epoch: 12 | loss: 0.0137519
	speed: 0.0607s/iter; left time: 2515.0890s
	iters: 400, epoch: 12 | loss: 0.0002476
	speed: 0.0629s/iter; left time: 2599.5955s
Epoch: 12 cost time: 29.517388105392456
Epoch: 12, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001036
	speed: 0.2757s/iter; left time: 11352.6378s
	iters: 200, epoch: 13 | loss: 0.0001345
	speed: 0.0633s/iter; left time: 2599.0671s
	iters: 300, epoch: 13 | loss: 0.0978028
	speed: 0.0628s/iter; left time: 2574.9928s
	iters: 400, epoch: 13 | loss: 0.3910834
	speed: 0.0642s/iter; left time: 2624.3619s
Epoch: 13 cost time: 30.12281107902527
Epoch: 13, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.188 Vali Acc: 0.961 Test Loss: 0.188 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0564451
	speed: 0.2753s/iter; left time: 11204.1954s
	iters: 200, epoch: 14 | loss: 0.0077240
	speed: 0.0635s/iter; left time: 2580.3817s
	iters: 300, epoch: 14 | loss: 0.0186915
	speed: 0.0628s/iter; left time: 2542.1777s
	iters: 400, epoch: 14 | loss: 0.0124706
	speed: 0.0644s/iter; left time: 2603.7486s
Epoch: 14 cost time: 30.10415244102478
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4229678
	speed: 0.2696s/iter; left time: 10846.4288s
	iters: 200, epoch: 15 | loss: 0.0001555
	speed: 0.0606s/iter; left time: 2433.9670s
	iters: 300, epoch: 15 | loss: 0.0907866
	speed: 0.0612s/iter; left time: 2448.9249s
	iters: 400, epoch: 15 | loss: 0.0024452
	speed: 0.0650s/iter; left time: 2594.2967s
Epoch: 15 cost time: 29.588523626327515
Epoch: 15, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.484 Vali Acc: 0.904 Test Loss: 0.484 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1766169
	speed: 0.2731s/iter; left time: 10860.9942s
	iters: 200, epoch: 16 | loss: 0.0029891
	speed: 0.0619s/iter; left time: 2454.3135s
	iters: 300, epoch: 16 | loss: 0.0377711
	speed: 0.0662s/iter; left time: 2620.2612s
	iters: 400, epoch: 16 | loss: 0.0198613
	speed: 0.0664s/iter; left time: 2622.4685s
Epoch: 16 cost time: 30.868350744247437
Epoch: 16, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.350 Vali Acc: 0.942 Test Loss: 0.350 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2117701
	speed: 0.2815s/iter; left time: 11060.6765s
	iters: 200, epoch: 17 | loss: 0.0001160
	speed: 0.0608s/iter; left time: 2385.0779s
	iters: 300, epoch: 17 | loss: 0.0095513
	speed: 0.0645s/iter; left time: 2519.8459s
	iters: 400, epoch: 17 | loss: 0.0029031
	speed: 0.0664s/iter; left time: 2589.2239s
Epoch: 17 cost time: 30.549428462982178
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0013056
	speed: 0.2783s/iter; left time: 10806.0951s
	iters: 200, epoch: 18 | loss: 0.0057598
	speed: 0.0606s/iter; left time: 2345.9901s
	iters: 300, epoch: 18 | loss: 0.0080595
	speed: 0.0586s/iter; left time: 2265.4893s
	iters: 400, epoch: 18 | loss: 0.0125632
	speed: 0.0602s/iter; left time: 2319.1925s
Epoch: 18 cost time: 28.866206169128418
Epoch: 18, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0524865
	speed: 0.2804s/iter; left time: 10755.1538s
	iters: 200, epoch: 19 | loss: 0.0001595
	speed: 0.0632s/iter; left time: 2418.7899s
	iters: 300, epoch: 19 | loss: 0.0874069
	speed: 0.0641s/iter; left time: 2444.8614s
	iters: 400, epoch: 19 | loss: 0.0000777
	speed: 0.0675s/iter; left time: 2568.5114s
Epoch: 19 cost time: 30.620916604995728
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.555 Vali Acc: 0.918 Test Loss: 0.555 Test Acc: 0.918
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000231
	speed: 0.2545s/iter; left time: 9643.3246s
	iters: 200, epoch: 20 | loss: 0.1324170
	speed: 0.0634s/iter; left time: 2394.6724s
	iters: 300, epoch: 20 | loss: 0.0151626
	speed: 0.0612s/iter; left time: 2306.0620s
	iters: 400, epoch: 20 | loss: 0.0000215
	speed: 0.0640s/iter; left time: 2404.7485s
Epoch: 20 cost time: 30.213013648986816
Epoch: 20, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001107
	speed: 0.2814s/iter; left time: 10528.6465s
	iters: 200, epoch: 21 | loss: 0.0072597
	speed: 0.0560s/iter; left time: 2090.4853s
	iters: 300, epoch: 21 | loss: 0.0094262
	speed: 0.0562s/iter; left time: 2091.9760s
	iters: 400, epoch: 21 | loss: 0.2963006
	speed: 0.0625s/iter; left time: 2320.2197s
Epoch: 21 cost time: 28.280609369277954
Epoch: 21, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 6360586
model size : 43.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2403370
	speed: 0.0737s/iter; left time: 3448.0813s
	iters: 200, epoch: 1 | loss: 0.1971295
	speed: 0.0647s/iter; left time: 3019.2501s
	iters: 300, epoch: 1 | loss: 0.0722499
	speed: 0.0693s/iter; left time: 3228.2577s
	iters: 400, epoch: 1 | loss: 0.0558647
	speed: 0.0683s/iter; left time: 3174.2964s
Epoch: 1 cost time: 32.47294735908508
Epoch: 1, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (inf --> -0.940536).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0905249
	speed: 0.2809s/iter; left time: 13016.7621s
	iters: 200, epoch: 2 | loss: 0.0186262
	speed: 0.0706s/iter; left time: 3262.7917s
	iters: 300, epoch: 2 | loss: 0.4298865
	speed: 0.0691s/iter; left time: 3189.3475s
	iters: 400, epoch: 2 | loss: 0.2296250
	speed: 0.0693s/iter; left time: 3188.3227s
Epoch: 2 cost time: 32.688719749450684
Epoch: 2, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.940536 --> -0.947968).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1078999
	speed: 0.2707s/iter; left time: 12417.2837s
	iters: 200, epoch: 3 | loss: 0.1509102
	speed: 0.0678s/iter; left time: 3104.5292s
	iters: 300, epoch: 3 | loss: 0.0415479
	speed: 0.0668s/iter; left time: 3049.8905s
	iters: 400, epoch: 3 | loss: 0.1332741
	speed: 0.0663s/iter; left time: 3021.9180s
Epoch: 3 cost time: 30.896040678024292
Epoch: 3, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
Validation loss decreased (-0.947968 --> -0.952828).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0023167
	speed: 0.2545s/iter; left time: 11551.2367s
	iters: 200, epoch: 4 | loss: 0.0085715
	speed: 0.0676s/iter; left time: 3063.6148s
	iters: 300, epoch: 4 | loss: 0.0709913
	speed: 0.0680s/iter; left time: 3072.0394s
	iters: 400, epoch: 4 | loss: 0.0092547
	speed: 0.0688s/iter; left time: 3100.8591s
Epoch: 4 cost time: 31.98564386367798
Epoch: 4, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0564624
	speed: 0.2667s/iter; left time: 11982.9624s
	iters: 200, epoch: 5 | loss: 0.9101807
	speed: 0.0639s/iter; left time: 2862.4942s
	iters: 300, epoch: 5 | loss: 0.1140452
	speed: 0.0700s/iter; left time: 3129.1696s
	iters: 400, epoch: 5 | loss: 0.3413439
	speed: 0.0693s/iter; left time: 3092.0987s
Epoch: 5 cost time: 31.43574595451355
Epoch: 5, Steps: 469 | Train Loss: 0.234 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0354096
	speed: 0.2651s/iter; left time: 11784.4783s
	iters: 200, epoch: 6 | loss: 0.1531705
	speed: 0.0605s/iter; left time: 2685.4164s
	iters: 300, epoch: 6 | loss: 0.2208451
	speed: 0.0630s/iter; left time: 2788.0813s
	iters: 400, epoch: 6 | loss: 0.0015452
	speed: 0.0629s/iter; left time: 2775.5352s
Epoch: 6 cost time: 29.729468822479248
Epoch: 6, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
Validation loss decreased (-0.952828 --> -0.955973).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0214703
	speed: 0.2833s/iter; left time: 12462.3932s
	iters: 200, epoch: 7 | loss: 0.3154370
	speed: 0.0667s/iter; left time: 2928.5948s
	iters: 300, epoch: 7 | loss: 0.0147353
	speed: 0.0647s/iter; left time: 2835.1020s
	iters: 400, epoch: 7 | loss: 0.0017700
	speed: 0.0698s/iter; left time: 3049.4931s
Epoch: 7 cost time: 31.630568027496338
Epoch: 7, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0285019
	speed: 0.2561s/iter; left time: 11143.8533s
	iters: 200, epoch: 8 | loss: 0.0010056
	speed: 0.0634s/iter; left time: 2753.2482s
	iters: 300, epoch: 8 | loss: 0.0507318
	speed: 0.0674s/iter; left time: 2917.8980s
	iters: 400, epoch: 8 | loss: 0.1619301
	speed: 0.0674s/iter; left time: 2914.7670s
Epoch: 8 cost time: 30.978715419769287
Epoch: 8, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2326373
	speed: 0.2735s/iter; left time: 11772.0917s
	iters: 200, epoch: 9 | loss: 0.2188253
	speed: 0.0551s/iter; left time: 2365.8159s
	iters: 300, epoch: 9 | loss: 0.1490273
	speed: 0.0637s/iter; left time: 2729.3173s
	iters: 400, epoch: 9 | loss: 0.1091189
	speed: 0.0650s/iter; left time: 2779.0449s
Epoch: 9 cost time: 29.297056198120117
Epoch: 9, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0006841
	speed: 0.2837s/iter; left time: 12080.6589s
	iters: 200, epoch: 10 | loss: 0.0857530
	speed: 0.0633s/iter; left time: 2690.7609s
	iters: 300, epoch: 10 | loss: 0.0445324
	speed: 0.0626s/iter; left time: 2651.6215s
	iters: 400, epoch: 10 | loss: 0.3475840
	speed: 0.0599s/iter; left time: 2533.1234s
Epoch: 10 cost time: 29.27258849143982
Epoch: 10, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
Validation loss decreased (-0.955973 --> -0.965979).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1722635
	speed: 0.2797s/iter; left time: 11777.2703s
	iters: 200, epoch: 11 | loss: 0.0486733
	speed: 0.0667s/iter; left time: 2803.4068s
	iters: 300, epoch: 11 | loss: 0.0003084
	speed: 0.0666s/iter; left time: 2790.3168s
	iters: 400, epoch: 11 | loss: 0.0030480
	speed: 0.0659s/iter; left time: 2754.8610s
Epoch: 11 cost time: 31.80590581893921
Epoch: 11, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1931165
	speed: 0.2445s/iter; left time: 10180.0068s
	iters: 200, epoch: 12 | loss: 0.3863283
	speed: 0.0514s/iter; left time: 2133.5471s
	iters: 300, epoch: 12 | loss: 0.2586045
	speed: 0.0501s/iter; left time: 2074.8853s
	iters: 400, epoch: 12 | loss: 0.0007867
	speed: 0.0496s/iter; left time: 2048.8983s
Epoch: 12 cost time: 24.23459267616272
Epoch: 12, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.842 Vali Acc: 0.907 Test Loss: 0.842 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0042032
	speed: 0.1692s/iter; left time: 6968.3620s
	iters: 200, epoch: 13 | loss: 0.0001350
	speed: 0.0549s/iter; left time: 2256.8743s
	iters: 300, epoch: 13 | loss: 0.0026748
	speed: 0.0644s/iter; left time: 2640.2870s
	iters: 400, epoch: 13 | loss: 0.0446250
	speed: 0.0678s/iter; left time: 2772.5846s
Epoch: 13 cost time: 28.119920015335083
Epoch: 13, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.298 Vali Acc: 0.940 Test Loss: 0.298 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1319336
	speed: 0.2794s/iter; left time: 11374.3964s
	iters: 200, epoch: 14 | loss: 0.7251460
	speed: 0.0657s/iter; left time: 2667.1507s
	iters: 300, epoch: 14 | loss: 0.0027471
	speed: 0.0658s/iter; left time: 2666.2491s
	iters: 400, epoch: 14 | loss: 0.0442867
	speed: 0.0657s/iter; left time: 2652.5781s
Epoch: 14 cost time: 30.96899390220642
Epoch: 14, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.485 Vali Acc: 0.901 Test Loss: 0.485 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2298477
	speed: 0.2750s/iter; left time: 11064.1668s
	iters: 200, epoch: 15 | loss: 0.0035923
	speed: 0.0626s/iter; left time: 2513.2356s
	iters: 300, epoch: 15 | loss: 0.1988638
	speed: 0.0646s/iter; left time: 2588.1746s
	iters: 400, epoch: 15 | loss: 0.0041135
	speed: 0.0638s/iter; left time: 2546.0700s
Epoch: 15 cost time: 30.184454679489136
Epoch: 15, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1161601
	speed: 0.2548s/iter; left time: 10130.9045s
	iters: 200, epoch: 16 | loss: 0.4747281
	speed: 0.0669s/iter; left time: 2653.1796s
	iters: 300, epoch: 16 | loss: 0.0207226
	speed: 0.0658s/iter; left time: 2602.5499s
	iters: 400, epoch: 16 | loss: 0.0032137
	speed: 0.0653s/iter; left time: 2575.4743s
Epoch: 16 cost time: 30.581254959106445
Epoch: 16, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.321 Vali Acc: 0.941 Test Loss: 0.321 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2462485
	speed: 0.2626s/iter; left time: 10320.0795s
	iters: 200, epoch: 17 | loss: 0.0036273
	speed: 0.0674s/iter; left time: 2643.4047s
	iters: 300, epoch: 17 | loss: 0.0004984
	speed: 0.0685s/iter; left time: 2679.1943s
	iters: 400, epoch: 17 | loss: 0.0002393
	speed: 0.0670s/iter; left time: 2611.1038s
Epoch: 17 cost time: 31.12366557121277
Epoch: 17, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
Validation loss decreased (-0.965979 --> -0.970553).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0088781
	speed: 0.2739s/iter; left time: 10636.0354s
	iters: 200, epoch: 18 | loss: 0.0003701
	speed: 0.0672s/iter; left time: 2604.4335s
	iters: 300, epoch: 18 | loss: 0.0011792
	speed: 0.0646s/iter; left time: 2494.7204s
	iters: 400, epoch: 18 | loss: 0.0003709
	speed: 0.0624s/iter; left time: 2405.5253s
Epoch: 18 cost time: 30.410702228546143
Epoch: 18, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.401 Vali Acc: 0.926 Test Loss: 0.401 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2005923
	speed: 0.2567s/iter; left time: 9847.9791s
	iters: 200, epoch: 19 | loss: 0.0011652
	speed: 0.0639s/iter; left time: 2444.4740s
	iters: 300, epoch: 19 | loss: 0.0260586
	speed: 0.0670s/iter; left time: 2556.0094s
	iters: 400, epoch: 19 | loss: 0.0020863
	speed: 0.0681s/iter; left time: 2591.2425s
Epoch: 19 cost time: 30.563777208328247
Epoch: 19, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000603
	speed: 0.2747s/iter; left time: 10408.6783s
	iters: 200, epoch: 20 | loss: 0.0025599
	speed: 0.0659s/iter; left time: 2489.6561s
	iters: 300, epoch: 20 | loss: 0.0196460
	speed: 0.0694s/iter; left time: 2614.3338s
	iters: 400, epoch: 20 | loss: 0.5724340
	speed: 0.0654s/iter; left time: 2460.2502s
Epoch: 20 cost time: 31.348127126693726
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000563
	speed: 0.2749s/iter; left time: 10288.7544s
	iters: 200, epoch: 21 | loss: 0.0002111
	speed: 0.0591s/iter; left time: 2205.0896s
	iters: 300, epoch: 21 | loss: 0.4517310
	speed: 0.0646s/iter; left time: 2405.1754s
	iters: 400, epoch: 21 | loss: 0.0020694
	speed: 0.0626s/iter; left time: 2324.6495s
Epoch: 21 cost time: 29.642131090164185
Epoch: 21, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.301 Vali Acc: 0.946 Test Loss: 0.301 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0535263
	speed: 0.2641s/iter; left time: 9758.2989s
	iters: 200, epoch: 22 | loss: 0.0001891
	speed: 0.0566s/iter; left time: 2084.4650s
	iters: 300, epoch: 22 | loss: 0.2437055
	speed: 0.0691s/iter; left time: 2539.0973s
	iters: 400, epoch: 22 | loss: 0.0014058
	speed: 0.0662s/iter; left time: 2425.4863s
Epoch: 22 cost time: 30.36165165901184
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
Validation loss decreased (-0.970553 --> -0.974270).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0002994
	speed: 0.2844s/iter; left time: 10376.8040s
	iters: 200, epoch: 23 | loss: 0.0007770
	speed: 0.0626s/iter; left time: 2277.4128s
	iters: 300, epoch: 23 | loss: 0.0172518
	speed: 0.0676s/iter; left time: 2451.7767s
	iters: 400, epoch: 23 | loss: 0.0628467
	speed: 0.0699s/iter; left time: 2530.9327s
Epoch: 23 cost time: 31.487822771072388
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0003249
	speed: 0.2855s/iter; left time: 10281.3509s
	iters: 200, epoch: 24 | loss: 0.0037288
	speed: 0.0588s/iter; left time: 2112.5497s
	iters: 300, epoch: 24 | loss: 0.0004474
	speed: 0.0646s/iter; left time: 2312.1479s
	iters: 400, epoch: 24 | loss: 0.0007645
	speed: 0.0649s/iter; left time: 2317.9473s
Epoch: 24 cost time: 30.453028917312622
Epoch: 24, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0170143
	speed: 0.2611s/iter; left time: 9281.9669s
	iters: 200, epoch: 25 | loss: 0.0002128
	speed: 0.0578s/iter; left time: 2047.7047s
	iters: 300, epoch: 25 | loss: 0.0371025
	speed: 0.0631s/iter; left time: 2229.4731s
	iters: 400, epoch: 25 | loss: 0.0081206
	speed: 0.0680s/iter; left time: 2395.4140s
Epoch: 25 cost time: 30.103110313415527
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0038397
	speed: 0.2801s/iter; left time: 9824.5134s
	iters: 200, epoch: 26 | loss: 0.0009282
	speed: 0.0598s/iter; left time: 2091.5424s
	iters: 300, epoch: 26 | loss: 0.0020984
	speed: 0.0612s/iter; left time: 2133.8347s
	iters: 400, epoch: 26 | loss: 0.0000702
	speed: 0.0664s/iter; left time: 2307.6589s
Epoch: 26 cost time: 30.216423273086548
Epoch: 26, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0134390
	speed: 0.2775s/iter; left time: 9602.3431s
	iters: 200, epoch: 27 | loss: 0.0129451
	speed: 0.0604s/iter; left time: 2083.1493s
	iters: 300, epoch: 27 | loss: 0.0112264
	speed: 0.0581s/iter; left time: 2000.7057s
	iters: 400, epoch: 27 | loss: 0.0011067
	speed: 0.0611s/iter; left time: 2095.8212s
Epoch: 27 cost time: 29.106040477752686
Epoch: 27, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0001310
	speed: 0.2697s/iter; left time: 9208.2944s
	iters: 200, epoch: 28 | loss: 0.0029136
	speed: 0.0608s/iter; left time: 2070.5152s
	iters: 300, epoch: 28 | loss: 0.1328155
	speed: 0.0591s/iter; left time: 2005.6032s
	iters: 400, epoch: 28 | loss: 0.0000587
	speed: 0.0641s/iter; left time: 2167.9428s
Epoch: 28 cost time: 29.59991455078125
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000837
	speed: 0.2837s/iter; left time: 9551.8188s
	iters: 200, epoch: 29 | loss: 0.0036141
	speed: 0.0621s/iter; left time: 2083.1094s
	iters: 300, epoch: 29 | loss: 0.0002124
	speed: 0.0619s/iter; left time: 2071.9635s
	iters: 400, epoch: 29 | loss: 0.1074173
	speed: 0.0629s/iter; left time: 2098.6037s
Epoch: 29 cost time: 29.38807725906372
Epoch: 29, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0043817
	speed: 0.2872s/iter; left time: 9533.9204s
	iters: 200, epoch: 30 | loss: 0.0008079
	speed: 0.0604s/iter; left time: 2000.6608s
	iters: 300, epoch: 30 | loss: 0.4217687
	speed: 0.0609s/iter; left time: 2010.4778s
	iters: 400, epoch: 30 | loss: 0.1611640
	speed: 0.0589s/iter; left time: 1939.3447s
Epoch: 30 cost time: 28.915696382522583
Epoch: 30, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0027942
	speed: 0.2701s/iter; left time: 8840.1982s
	iters: 200, epoch: 31 | loss: 0.0251372
	speed: 0.0604s/iter; left time: 1970.3401s
	iters: 300, epoch: 31 | loss: 0.0110427
	speed: 0.0609s/iter; left time: 1982.3497s
	iters: 400, epoch: 31 | loss: 0.0015917
	speed: 0.0620s/iter; left time: 2009.8283s
Epoch: 31 cost time: 29.46310782432556
Epoch: 31, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0018948
	speed: 0.2052s/iter; left time: 6620.9877s
	iters: 200, epoch: 32 | loss: 0.0004629
	speed: 0.0475s/iter; left time: 1528.9055s
	iters: 300, epoch: 32 | loss: 0.0003514
	speed: 0.0464s/iter; left time: 1488.2148s
	iters: 400, epoch: 32 | loss: 0.0427967
	speed: 0.0476s/iter; left time: 1520.9449s
Epoch: 32 cost time: 23.085577249526978
Epoch: 32, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 6360586
model size : 43.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2504577
	speed: 0.0804s/iter; left time: 3762.3506s
	iters: 200, epoch: 1 | loss: 0.1764000
	speed: 0.0622s/iter; left time: 2904.4769s
	iters: 300, epoch: 1 | loss: 0.0630846
	speed: 0.0653s/iter; left time: 3043.2504s
	iters: 400, epoch: 1 | loss: 0.0213584
	speed: 0.0645s/iter; left time: 3000.7402s
Epoch: 1 cost time: 31.909711360931396
Epoch: 1, Steps: 469 | Train Loss: 0.330 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (inf --> -0.937105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0472748
	speed: 0.2676s/iter; left time: 12399.2357s
	iters: 200, epoch: 2 | loss: 0.0274706
	speed: 0.0593s/iter; left time: 2741.2448s
	iters: 300, epoch: 2 | loss: 0.5396246
	speed: 0.0630s/iter; left time: 2907.5097s
	iters: 400, epoch: 2 | loss: 0.2315515
	speed: 0.0663s/iter; left time: 3051.8809s
Epoch: 2 cost time: 30.019031763076782
Epoch: 2, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.381 Vali Acc: 0.893 Test Loss: 0.381 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1506385
	speed: 0.2786s/iter; left time: 12775.5724s
	iters: 200, epoch: 3 | loss: 0.0028136
	speed: 0.0650s/iter; left time: 2974.6390s
	iters: 300, epoch: 3 | loss: 0.0351541
	speed: 0.0676s/iter; left time: 3086.5603s
	iters: 400, epoch: 3 | loss: 0.0328180
	speed: 0.0660s/iter; left time: 3007.2673s
Epoch: 3 cost time: 31.842774152755737
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.330 Vali Acc: 0.905 Test Loss: 0.330 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2193740
	speed: 0.2768s/iter; left time: 12563.3907s
	iters: 200, epoch: 4 | loss: 0.1051372
	speed: 0.0634s/iter; left time: 2870.6153s
	iters: 300, epoch: 4 | loss: 0.1472351
	speed: 0.0667s/iter; left time: 3012.6550s
	iters: 400, epoch: 4 | loss: 0.0148054
	speed: 0.0652s/iter; left time: 2940.0751s
Epoch: 4 cost time: 31.40914750099182
Epoch: 4, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.466 Vali Acc: 0.895 Test Loss: 0.466 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0596833
	speed: 0.2666s/iter; left time: 11978.7401s
	iters: 200, epoch: 5 | loss: 0.3340988
	speed: 0.0613s/iter; left time: 2749.1157s
	iters: 300, epoch: 5 | loss: 0.4566218
	speed: 0.0646s/iter; left time: 2891.1335s
	iters: 400, epoch: 5 | loss: 0.0259049
	speed: 0.0625s/iter; left time: 2789.6416s
Epoch: 5 cost time: 30.457669258117676
Epoch: 5, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
Validation loss decreased (-0.937105 --> -0.951684).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0025783
	speed: 0.2962s/iter; left time: 13166.9085s
	iters: 200, epoch: 6 | loss: 0.0250652
	speed: 0.0651s/iter; left time: 2886.8831s
	iters: 300, epoch: 6 | loss: 0.0280501
	speed: 0.0576s/iter; left time: 2547.8693s
	iters: 400, epoch: 6 | loss: 0.0014011
	speed: 0.0603s/iter; left time: 2661.5880s
Epoch: 6 cost time: 29.634623527526855
Epoch: 6, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0428066
	speed: 0.2935s/iter; left time: 12909.3940s
	iters: 200, epoch: 7 | loss: 0.0132444
	speed: 0.0644s/iter; left time: 2828.5166s
	iters: 300, epoch: 7 | loss: 0.0109389
	speed: 0.0548s/iter; left time: 2401.0766s
	iters: 400, epoch: 7 | loss: 0.0320642
	speed: 0.0642s/iter; left time: 2804.4963s
Epoch: 7 cost time: 29.834439992904663
Epoch: 7, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.386 Vali Acc: 0.916 Test Loss: 0.386 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002140
	speed: 0.2755s/iter; left time: 11987.3909s
	iters: 200, epoch: 8 | loss: 0.0055600
	speed: 0.0604s/iter; left time: 2620.6728s
	iters: 300, epoch: 8 | loss: 0.0125411
	speed: 0.0579s/iter; left time: 2509.8804s
	iters: 400, epoch: 8 | loss: 0.0680530
	speed: 0.0631s/iter; left time: 2728.6977s
Epoch: 8 cost time: 29.446956872940063
Epoch: 8, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.535 Vali Acc: 0.857 Test Loss: 0.535 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0046927
	speed: 0.2900s/iter; left time: 12485.5105s
	iters: 200, epoch: 9 | loss: 0.0402979
	speed: 0.0624s/iter; left time: 2678.8771s
	iters: 300, epoch: 9 | loss: 0.0001310
	speed: 0.0639s/iter; left time: 2737.6582s
	iters: 400, epoch: 9 | loss: 0.0063330
	speed: 0.0629s/iter; left time: 2690.3552s
Epoch: 9 cost time: 30.145519495010376
Epoch: 9, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.951684 --> -0.969981).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001123
	speed: 0.2848s/iter; left time: 12127.2355s
	iters: 200, epoch: 10 | loss: 0.0111509
	speed: 0.0671s/iter; left time: 2850.2910s
	iters: 300, epoch: 10 | loss: 0.2181000
	speed: 0.0655s/iter; left time: 2776.4664s
	iters: 400, epoch: 10 | loss: 0.1568407
	speed: 0.0636s/iter; left time: 2688.9037s
Epoch: 10 cost time: 30.672210216522217
Epoch: 10, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0745665
	speed: 0.2722s/iter; left time: 11461.7826s
	iters: 200, epoch: 11 | loss: 0.1817897
	speed: 0.0649s/iter; left time: 2725.6696s
	iters: 300, epoch: 11 | loss: 0.0022207
	speed: 0.0602s/iter; left time: 2523.2921s
	iters: 400, epoch: 11 | loss: 0.0033780
	speed: 0.0629s/iter; left time: 2631.4845s
Epoch: 11 cost time: 30.54509997367859
Epoch: 11, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0006536
	speed: 0.2713s/iter; left time: 11296.4292s
	iters: 200, epoch: 12 | loss: 0.0463544
	speed: 0.0701s/iter; left time: 2912.9922s
	iters: 300, epoch: 12 | loss: 0.0551371
	speed: 0.0660s/iter; left time: 2735.8483s
	iters: 400, epoch: 12 | loss: 0.0143353
	speed: 0.0649s/iter; left time: 2681.8187s
Epoch: 12 cost time: 31.73867130279541
Epoch: 12, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0912150
	speed: 0.2774s/iter; left time: 11422.7014s
	iters: 200, epoch: 13 | loss: 0.0029705
	speed: 0.0686s/iter; left time: 2819.6186s
	iters: 300, epoch: 13 | loss: 0.1217840
	speed: 0.0659s/iter; left time: 2698.3673s
	iters: 400, epoch: 13 | loss: 0.0516435
	speed: 0.0677s/iter; left time: 2768.2982s
Epoch: 13 cost time: 31.620743989944458
Epoch: 13, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.262 Vali Acc: 0.946 Test Loss: 0.262 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0236010
	speed: 0.2640s/iter; left time: 10747.2068s
	iters: 200, epoch: 14 | loss: 0.7000673
	speed: 0.0652s/iter; left time: 2649.1913s
	iters: 300, epoch: 14 | loss: 0.0035130
	speed: 0.0667s/iter; left time: 2699.6578s
	iters: 400, epoch: 14 | loss: 0.4521910
	speed: 0.0611s/iter; left time: 2467.7446s
Epoch: 14 cost time: 30.46804404258728
Epoch: 14, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.602 Vali Acc: 0.896 Test Loss: 0.602 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8627734
	speed: 0.2780s/iter; left time: 11186.2400s
	iters: 200, epoch: 15 | loss: 0.0148620
	speed: 0.0681s/iter; left time: 2731.7348s
	iters: 300, epoch: 15 | loss: 0.0141730
	speed: 0.0669s/iter; left time: 2679.4084s
	iters: 400, epoch: 15 | loss: 0.2693941
	speed: 0.0612s/iter; left time: 2444.5666s
Epoch: 15 cost time: 31.07122540473938
Epoch: 15, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.227 Vali Acc: 0.954 Test Loss: 0.227 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3141688
	speed: 0.2839s/iter; left time: 11290.8342s
	iters: 200, epoch: 16 | loss: 0.0003398
	speed: 0.0676s/iter; left time: 2683.2232s
	iters: 300, epoch: 16 | loss: 0.0135664
	speed: 0.0653s/iter; left time: 2582.5889s
	iters: 400, epoch: 16 | loss: 0.0125564
	speed: 0.0617s/iter; left time: 2436.2516s
Epoch: 16 cost time: 30.495498657226562
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0035972
	speed: 0.1790s/iter; left time: 7035.3710s
	iters: 200, epoch: 17 | loss: 0.0003119
	speed: 0.0505s/iter; left time: 1979.3633s
	iters: 300, epoch: 17 | loss: 0.0075909
	speed: 0.0492s/iter; left time: 1924.7456s
	iters: 400, epoch: 17 | loss: 0.1905023
	speed: 0.0609s/iter; left time: 2373.6592s
Epoch: 17 cost time: 26.166749238967896
Epoch: 17, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.436 Vali Acc: 0.927 Test Loss: 0.436 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0497542
	speed: 0.2661s/iter; left time: 10330.9702s
	iters: 200, epoch: 18 | loss: 0.0001816
	speed: 0.0661s/iter; left time: 2558.0646s
	iters: 300, epoch: 18 | loss: 0.4127871
	speed: 0.0697s/iter; left time: 2693.5894s
	iters: 400, epoch: 18 | loss: 0.0019300
	speed: 0.0660s/iter; left time: 2544.5919s
Epoch: 18 cost time: 31.738654613494873
Epoch: 18, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1549565
	speed: 0.2726s/iter; left time: 10455.7611s
	iters: 200, epoch: 19 | loss: 0.1771794
	speed: 0.0684s/iter; left time: 2617.3827s
	iters: 300, epoch: 19 | loss: 0.0104140
	speed: 0.0676s/iter; left time: 2578.4695s
	iters: 400, epoch: 19 | loss: 0.0015836
	speed: 0.0708s/iter; left time: 2695.3032s
Epoch: 19 cost time: 31.889633178710938
Epoch: 19, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.423 Vali Acc: 0.907 Test Loss: 0.423 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9699828473413379
model parameter : 6360586
model size : 43.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3034365
	speed: 0.0790s/iter; left time: 3696.6503s
	iters: 200, epoch: 1 | loss: 2.3039181
	speed: 0.0624s/iter; left time: 2913.9590s
	iters: 300, epoch: 1 | loss: 2.3022263
	speed: 0.0540s/iter; left time: 2515.4407s
	iters: 400, epoch: 1 | loss: 2.3016226
	speed: 0.0588s/iter; left time: 2736.1561s
Epoch: 1 cost time: 29.722557306289673
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2975523
	speed: 0.2790s/iter; left time: 12924.3188s
	iters: 200, epoch: 2 | loss: 2.2971416
	speed: 0.0607s/iter; left time: 2804.7559s
	iters: 300, epoch: 2 | loss: 2.3072660
	speed: 0.0605s/iter; left time: 2791.8018s
	iters: 400, epoch: 2 | loss: 2.3034744
	speed: 0.0638s/iter; left time: 2935.9615s
Epoch: 2 cost time: 29.543957233428955
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2951555
	speed: 0.2760s/iter; left time: 12658.6221s
	iters: 200, epoch: 3 | loss: 2.3004048
	speed: 0.0590s/iter; left time: 2700.7353s
	iters: 300, epoch: 3 | loss: 2.3136787
	speed: 0.0636s/iter; left time: 2902.3666s
	iters: 400, epoch: 3 | loss: 2.2951980
	speed: 0.0612s/iter; left time: 2786.6404s
Epoch: 3 cost time: 29.339491367340088
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2997084
	speed: 0.2567s/iter; left time: 11652.4043s
	iters: 200, epoch: 4 | loss: 2.3038404
	speed: 0.0638s/iter; left time: 2891.8431s
	iters: 300, epoch: 4 | loss: 2.3030760
	speed: 0.0629s/iter; left time: 2843.9599s
	iters: 400, epoch: 4 | loss: 2.2989006
	speed: 0.0583s/iter; left time: 2628.9057s
Epoch: 4 cost time: 29.30528998374939
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2925243
	speed: 0.2354s/iter; left time: 10573.3723s
	iters: 200, epoch: 5 | loss: 2.3028758
	speed: 0.0694s/iter; left time: 3110.7233s
	iters: 300, epoch: 5 | loss: 2.2864573
	speed: 0.0654s/iter; left time: 2923.8594s
	iters: 400, epoch: 5 | loss: 2.3030992
	speed: 0.0660s/iter; left time: 2944.8533s
Epoch: 5 cost time: 31.205243349075317
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2970197
	speed: 0.2530s/iter; left time: 11248.8257s
	iters: 200, epoch: 6 | loss: 2.2996159
	speed: 0.0679s/iter; left time: 3013.8265s
	iters: 300, epoch: 6 | loss: 2.2950778
	speed: 0.0663s/iter; left time: 2933.9369s
	iters: 400, epoch: 6 | loss: 2.2948110
	speed: 0.0643s/iter; left time: 2839.9786s
Epoch: 6 cost time: 31.483370780944824
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3126984
	speed: 0.2490s/iter; left time: 10954.7810s
	iters: 200, epoch: 7 | loss: 2.3069868
	speed: 0.0624s/iter; left time: 2737.5194s
	iters: 300, epoch: 7 | loss: 2.2970693
	speed: 0.0616s/iter; left time: 2697.7347s
	iters: 400, epoch: 7 | loss: 2.3136201
	speed: 0.0617s/iter; left time: 2693.4232s
Epoch: 7 cost time: 28.84178900718689
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3185236
	speed: 0.2514s/iter; left time: 10942.0183s
	iters: 200, epoch: 8 | loss: 2.3029892
	speed: 0.0673s/iter; left time: 2922.6391s
	iters: 300, epoch: 8 | loss: 2.2909992
	speed: 0.0656s/iter; left time: 2839.7220s
	iters: 400, epoch: 8 | loss: 2.2924545
	speed: 0.0612s/iter; left time: 2646.1982s
Epoch: 8 cost time: 30.424247980117798
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3131282
	speed: 0.2644s/iter; left time: 11381.7628s
	iters: 200, epoch: 9 | loss: 2.2986684
	speed: 0.0617s/iter; left time: 2649.8766s
	iters: 300, epoch: 9 | loss: 2.2868817
	speed: 0.0594s/iter; left time: 2547.3191s
	iters: 400, epoch: 9 | loss: 2.2881479
	speed: 0.0631s/iter; left time: 2697.1922s
Epoch: 9 cost time: 29.678991317749023
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3157754
	speed: 0.2833s/iter; left time: 12061.6938s
	iters: 200, epoch: 10 | loss: 2.2928936
	speed: 0.0562s/iter; left time: 2388.9030s
	iters: 300, epoch: 10 | loss: 2.2965603
	speed: 0.0575s/iter; left time: 2437.2947s
	iters: 400, epoch: 10 | loss: 2.2978637
	speed: 0.0618s/iter; left time: 2612.1353s
Epoch: 10 cost time: 28.200926065444946
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3016346
	speed: 0.2614s/iter; left time: 11005.9189s
	iters: 200, epoch: 11 | loss: 2.3033414
	speed: 0.0591s/iter; left time: 2481.2609s
	iters: 300, epoch: 11 | loss: 2.3064022
	speed: 0.0611s/iter; left time: 2562.4524s
	iters: 400, epoch: 11 | loss: 2.2967892
	speed: 0.0644s/iter; left time: 2693.0652s
Epoch: 11 cost time: 29.193037271499634
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3133357
	speed: 0.2787s/iter; left time: 11603.7328s
	iters: 200, epoch: 12 | loss: 2.3002887
	speed: 0.0588s/iter; left time: 2442.3448s
	iters: 300, epoch: 12 | loss: 2.3173661
	speed: 0.0607s/iter; left time: 2515.4503s
	iters: 400, epoch: 12 | loss: 2.3155656
	speed: 0.0626s/iter; left time: 2586.9353s
Epoch: 12 cost time: 29.088868141174316
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3093958
	speed: 0.2817s/iter; left time: 11599.2889s
	iters: 200, epoch: 13 | loss: 2.2907524
	speed: 0.0599s/iter; left time: 2462.1528s
	iters: 300, epoch: 13 | loss: 2.2993007
	speed: 0.0587s/iter; left time: 2404.9800s
	iters: 400, epoch: 13 | loss: 2.3114257
	speed: 0.0608s/iter; left time: 2485.2810s
Epoch: 13 cost time: 29.008166074752808
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3124228
	speed: 0.2496s/iter; left time: 10158.6773s
	iters: 200, epoch: 14 | loss: 2.3061783
	speed: 0.0610s/iter; left time: 2478.7078s
	iters: 300, epoch: 14 | loss: 2.3081872
	speed: 0.0609s/iter; left time: 2465.7025s
	iters: 400, epoch: 14 | loss: 2.3040700
	speed: 0.0624s/iter; left time: 2521.2704s
Epoch: 14 cost time: 29.852211952209473
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3077290
	speed: 0.2758s/iter; left time: 11095.7760s
	iters: 200, epoch: 15 | loss: 2.2958088
	speed: 0.0627s/iter; left time: 2515.7123s
	iters: 300, epoch: 15 | loss: 2.3165057
	speed: 0.0628s/iter; left time: 2516.0229s
	iters: 400, epoch: 15 | loss: 2.3093462
	speed: 0.0624s/iter; left time: 2492.5781s
Epoch: 15 cost time: 29.975549697875977
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.2959099
	speed: 0.2771s/iter; left time: 11021.1447s
	iters: 200, epoch: 16 | loss: 2.3137088
	speed: 0.0690s/iter; left time: 2736.7641s
	iters: 300, epoch: 16 | loss: 2.3231199
	speed: 0.0616s/iter; left time: 2439.1860s
	iters: 400, epoch: 16 | loss: 2.2934623
	speed: 0.0565s/iter; left time: 2229.6434s
Epoch: 16 cost time: 29.670735359191895
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3302674
	speed: 0.2638s/iter; left time: 10366.6801s
	iters: 200, epoch: 17 | loss: 2.3129721
	speed: 0.0653s/iter; left time: 2558.6554s
	iters: 300, epoch: 17 | loss: 2.3128455
	speed: 0.0582s/iter; left time: 2273.7413s
	iters: 400, epoch: 17 | loss: 2.3028655
	speed: 0.0576s/iter; left time: 2247.8560s
Epoch: 17 cost time: 29.01360559463501
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.2917016
	speed: 0.2809s/iter; left time: 10907.6689s
	iters: 200, epoch: 18 | loss: 2.2885678
	speed: 0.0669s/iter; left time: 2591.4437s
	iters: 300, epoch: 18 | loss: 2.2897329
	speed: 0.0606s/iter; left time: 2340.9373s
	iters: 400, epoch: 18 | loss: 2.3036914
	speed: 0.0599s/iter; left time: 2309.6737s
Epoch: 18 cost time: 30.050976753234863
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.2956114
	speed: 0.2844s/iter; left time: 10907.9922s
	iters: 200, epoch: 19 | loss: 2.2982011
	speed: 0.0601s/iter; left time: 2301.1233s
	iters: 300, epoch: 19 | loss: 2.2974102
	speed: 0.0613s/iter; left time: 2340.5200s
	iters: 400, epoch: 19 | loss: 2.2984359
	speed: 0.0575s/iter; left time: 2187.6944s
Epoch: 19 cost time: 29.089023113250732
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.2884865
	speed: 0.2609s/iter; left time: 9884.2136s
	iters: 200, epoch: 20 | loss: 2.2875521
	speed: 0.0642s/iter; left time: 2426.5296s
	iters: 300, epoch: 20 | loss: 2.3101149
	speed: 0.0588s/iter; left time: 2216.8948s
	iters: 400, epoch: 20 | loss: 2.2942879
	speed: 0.0595s/iter; left time: 2237.8605s
Epoch: 20 cost time: 28.811429500579834
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.2966337
	speed: 0.2355s/iter; left time: 8812.5979s
	iters: 200, epoch: 21 | loss: 2.2832217
	speed: 0.0583s/iter; left time: 2174.9319s
	iters: 300, epoch: 21 | loss: 2.3101587
	speed: 0.0612s/iter; left time: 2276.7146s
	iters: 400, epoch: 21 | loss: 2.2915993
	speed: 0.0551s/iter; left time: 2046.6107s
Epoch: 21 cost time: 27.817457675933838
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.2975571
	speed: 0.2155s/iter; left time: 7962.2369s
	iters: 200, epoch: 22 | loss: 2.2948802
	speed: 0.0602s/iter; left time: 2218.6746s
	iters: 300, epoch: 22 | loss: 2.2881863
	speed: 0.0588s/iter; left time: 2162.2972s
	iters: 400, epoch: 22 | loss: 2.3030355
	speed: 0.0569s/iter; left time: 2085.4907s
Epoch: 22 cost time: 27.496439695358276
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 6360586
model size : 43.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2672238
	speed: 0.0652s/iter; left time: 3049.2521s
	iters: 200, epoch: 1 | loss: 0.2477021
	speed: 0.0568s/iter; left time: 2651.5117s
	iters: 300, epoch: 1 | loss: 0.0613520
	speed: 0.0645s/iter; left time: 3003.9273s
	iters: 400, epoch: 1 | loss: 0.0437302
	speed: 0.0616s/iter; left time: 2864.0213s
Epoch: 1 cost time: 29.305212259292603
Epoch: 1, Steps: 469 | Train Loss: 0.312 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (inf --> -0.943394).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0868348
	speed: 0.2648s/iter; left time: 12268.0480s
	iters: 200, epoch: 2 | loss: 0.0226261
	speed: 0.0675s/iter; left time: 3121.9106s
	iters: 300, epoch: 2 | loss: 0.0494894
	speed: 0.0676s/iter; left time: 3117.7447s
	iters: 400, epoch: 2 | loss: 0.0075457
	speed: 0.0598s/iter; left time: 2751.4192s
Epoch: 2 cost time: 30.327812671661377
Epoch: 2, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.943394 --> -0.943680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0185633
	speed: 0.2435s/iter; left time: 11168.4286s
	iters: 200, epoch: 3 | loss: 0.3436293
	speed: 0.0668s/iter; left time: 3056.2652s
	iters: 300, epoch: 3 | loss: 0.0015030
	speed: 0.0673s/iter; left time: 3071.0674s
	iters: 400, epoch: 3 | loss: 0.2987679
	speed: 0.0602s/iter; left time: 2744.9806s
Epoch: 3 cost time: 30.334602117538452
Epoch: 3, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0134788
	speed: 0.2528s/iter; left time: 11473.9803s
	iters: 200, epoch: 4 | loss: 0.0514866
	speed: 0.0674s/iter; left time: 3054.3347s
	iters: 300, epoch: 4 | loss: 0.0475770
	speed: 0.0646s/iter; left time: 2918.8025s
	iters: 400, epoch: 4 | loss: 0.0920877
	speed: 0.0623s/iter; left time: 2808.5014s
Epoch: 4 cost time: 30.97778820991516
Epoch: 4, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1884628
	speed: 0.2719s/iter; left time: 12213.6562s
	iters: 200, epoch: 5 | loss: 0.0544455
	speed: 0.0636s/iter; left time: 2848.8558s
	iters: 300, epoch: 5 | loss: 0.2536191
	speed: 0.0628s/iter; left time: 2807.2413s
	iters: 400, epoch: 5 | loss: 0.0062541
	speed: 0.0689s/iter; left time: 3073.6688s
Epoch: 5 cost time: 30.973294496536255
Epoch: 5, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.424 Vali Acc: 0.905 Test Loss: 0.424 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2114350
	speed: 0.2401s/iter; left time: 10675.0189s
	iters: 200, epoch: 6 | loss: 0.1665894
	speed: 0.0608s/iter; left time: 2696.5543s
	iters: 300, epoch: 6 | loss: 0.2478456
	speed: 0.0570s/iter; left time: 2524.6919s
	iters: 400, epoch: 6 | loss: 0.1552961
	speed: 0.0611s/iter; left time: 2696.3518s
Epoch: 6 cost time: 28.237849473953247
Epoch: 6, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0257606
	speed: 0.2538s/iter; left time: 11165.8265s
	iters: 200, epoch: 7 | loss: 0.2414806
	speed: 0.0637s/iter; left time: 2794.5195s
	iters: 300, epoch: 7 | loss: 0.0178150
	speed: 0.0666s/iter; left time: 2914.7658s
	iters: 400, epoch: 7 | loss: 0.0007206
	speed: 0.0662s/iter; left time: 2893.5860s
Epoch: 7 cost time: 31.153398990631104
Epoch: 7, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0091593
	speed: 0.2454s/iter; left time: 10678.0858s
	iters: 200, epoch: 8 | loss: 0.0044204
	speed: 0.0617s/iter; left time: 2677.9967s
	iters: 300, epoch: 8 | loss: 0.0667554
	speed: 0.0640s/iter; left time: 2770.7995s
	iters: 400, epoch: 8 | loss: 0.0079392
	speed: 0.0677s/iter; left time: 2925.6975s
Epoch: 8 cost time: 29.81600260734558
Epoch: 8, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.787 Vali Acc: 0.870 Test Loss: 0.787 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0668931
	speed: 0.2556s/iter; left time: 11003.8042s
	iters: 200, epoch: 9 | loss: 0.0003550
	speed: 0.0607s/iter; left time: 2607.5610s
	iters: 300, epoch: 9 | loss: 0.0004298
	speed: 0.0629s/iter; left time: 2693.9178s
	iters: 400, epoch: 9 | loss: 0.0238771
	speed: 0.0572s/iter; left time: 2445.3245s
Epoch: 9 cost time: 28.568973064422607
Epoch: 9, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.943680 --> -0.955687).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1398115
	speed: 0.2799s/iter; left time: 11918.6672s
	iters: 200, epoch: 10 | loss: 0.8502630
	speed: 0.0602s/iter; left time: 2557.1072s
	iters: 300, epoch: 10 | loss: 0.0136676
	speed: 0.0642s/iter; left time: 2719.9301s
	iters: 400, epoch: 10 | loss: 0.1600803
	speed: 0.0643s/iter; left time: 2717.7440s
Epoch: 10 cost time: 30.19139790534973
Epoch: 10, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0431675
	speed: 0.2738s/iter; left time: 11531.4301s
	iters: 200, epoch: 11 | loss: 0.0006534
	speed: 0.0616s/iter; left time: 2586.7369s
	iters: 300, epoch: 11 | loss: 0.2299146
	speed: 0.0631s/iter; left time: 2644.7740s
	iters: 400, epoch: 11 | loss: 0.0002361
	speed: 0.0661s/iter; left time: 2762.1351s
Epoch: 11 cost time: 30.01193928718567
Epoch: 11, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1023377
	speed: 0.2535s/iter; left time: 10554.4198s
	iters: 200, epoch: 12 | loss: 0.0163056
	speed: 0.0598s/iter; left time: 2485.6222s
	iters: 300, epoch: 12 | loss: 0.0001266
	speed: 0.0597s/iter; left time: 2473.7561s
	iters: 400, epoch: 12 | loss: 0.0005522
	speed: 0.0623s/iter; left time: 2577.5868s
Epoch: 12 cost time: 28.627196311950684
Epoch: 12, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.460 Vali Acc: 0.927 Test Loss: 0.460 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000100
	speed: 0.2552s/iter; left time: 10505.6513s
	iters: 200, epoch: 13 | loss: 0.3579931
	speed: 0.0659s/iter; left time: 2708.7319s
	iters: 300, epoch: 13 | loss: 0.3965224
	speed: 0.0643s/iter; left time: 2634.7340s
	iters: 400, epoch: 13 | loss: 0.0306080
	speed: 0.0610s/iter; left time: 2494.1969s
Epoch: 13 cost time: 29.749306201934814
Epoch: 13, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
Validation loss decreased (-0.955687 --> -0.965979).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002934
	speed: 0.2811s/iter; left time: 11441.3983s
	iters: 200, epoch: 14 | loss: 0.0004767
	speed: 0.0641s/iter; left time: 2601.1675s
	iters: 300, epoch: 14 | loss: 0.0040923
	speed: 0.0602s/iter; left time: 2437.6710s
	iters: 400, epoch: 14 | loss: 0.0038640
	speed: 0.0614s/iter; left time: 2481.1232s
Epoch: 14 cost time: 30.122259378433228
Epoch: 14, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.463 Vali Acc: 0.909 Test Loss: 0.463 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4198012
	speed: 0.2726s/iter; left time: 10969.7477s
	iters: 200, epoch: 15 | loss: 0.0166985
	speed: 0.0553s/iter; left time: 2218.1113s
	iters: 300, epoch: 15 | loss: 0.0042544
	speed: 0.0599s/iter; left time: 2397.0671s
	iters: 400, epoch: 15 | loss: 0.0000560
	speed: 0.0602s/iter; left time: 2405.9289s
Epoch: 15 cost time: 28.44439697265625
Epoch: 15, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.965979 --> -0.969695).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0215920
	speed: 0.2623s/iter; left time: 10429.6846s
	iters: 200, epoch: 16 | loss: 0.0539278
	speed: 0.0534s/iter; left time: 2117.2941s
	iters: 300, epoch: 16 | loss: 0.0010943
	speed: 0.0457s/iter; left time: 1806.2202s
	iters: 400, epoch: 16 | loss: 0.0135512
	speed: 0.0488s/iter; left time: 1924.7513s
Epoch: 16 cost time: 24.873735904693604
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969695 --> -0.969695).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0002327
	speed: 0.1883s/iter; left time: 7400.3221s
	iters: 200, epoch: 17 | loss: 0.0841614
	speed: 0.0670s/iter; left time: 2627.8266s
	iters: 300, epoch: 17 | loss: 0.0054736
	speed: 0.0627s/iter; left time: 2452.7487s
	iters: 400, epoch: 17 | loss: 0.0337915
	speed: 0.0645s/iter; left time: 2516.2573s
Epoch: 17 cost time: 30.19628643989563
Epoch: 17, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0040375
	speed: 0.2678s/iter; left time: 10397.4144s
	iters: 200, epoch: 18 | loss: 0.1607662
	speed: 0.0662s/iter; left time: 2564.9057s
	iters: 300, epoch: 18 | loss: 0.0057174
	speed: 0.0610s/iter; left time: 2357.9294s
	iters: 400, epoch: 18 | loss: 0.0303522
	speed: 0.0574s/iter; left time: 2209.9299s
Epoch: 18 cost time: 29.30364680290222
Epoch: 18, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.6576907
	speed: 0.2574s/iter; left time: 9875.3424s
	iters: 200, epoch: 19 | loss: 0.0000123
	speed: 0.0611s/iter; left time: 2336.0169s
	iters: 300, epoch: 19 | loss: 0.0000396
	speed: 0.0600s/iter; left time: 2289.7745s
	iters: 400, epoch: 19 | loss: 0.0100379
	speed: 0.0612s/iter; left time: 2330.1350s
Epoch: 19 cost time: 29.24110174179077
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969695 --> -0.972840).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0333781
	speed: 0.2807s/iter; left time: 10635.8013s
	iters: 200, epoch: 20 | loss: 0.0282637
	speed: 0.0630s/iter; left time: 2381.9651s
	iters: 300, epoch: 20 | loss: 0.0018918
	speed: 0.0675s/iter; left time: 2544.9220s
	iters: 400, epoch: 20 | loss: 0.0000287
	speed: 0.0618s/iter; left time: 2323.0795s
Epoch: 20 cost time: 30.154112577438354
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0007490
	speed: 0.2611s/iter; left time: 9769.5133s
	iters: 200, epoch: 21 | loss: 0.3668803
	speed: 0.0644s/iter; left time: 2402.7678s
	iters: 300, epoch: 21 | loss: 0.0027766
	speed: 0.0641s/iter; left time: 2384.2389s
	iters: 400, epoch: 21 | loss: 0.2737213
	speed: 0.0599s/iter; left time: 2222.8909s
Epoch: 21 cost time: 29.832218408584595
Epoch: 21, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0293711
	speed: 0.2378s/iter; left time: 8787.2801s
	iters: 200, epoch: 22 | loss: 0.0000626
	speed: 0.0594s/iter; left time: 2188.2461s
	iters: 300, epoch: 22 | loss: 0.0364944
	speed: 0.0555s/iter; left time: 2040.6351s
	iters: 400, epoch: 22 | loss: 0.0193170
	speed: 0.0650s/iter; left time: 2383.5944s
Epoch: 22 cost time: 29.013413429260254
Epoch: 22, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.342 Vali Acc: 0.936 Test Loss: 0.342 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0045760
	speed: 0.2897s/iter; left time: 10569.6936s
	iters: 200, epoch: 23 | loss: 0.0018193
	speed: 0.0602s/iter; left time: 2190.1646s
	iters: 300, epoch: 23 | loss: 0.1452651
	speed: 0.0633s/iter; left time: 2298.1906s
	iters: 400, epoch: 23 | loss: 0.0024848
	speed: 0.0640s/iter; left time: 2317.4926s
Epoch: 23 cost time: 29.82430410385132
Epoch: 23, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974269).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0003669
	speed: 0.2806s/iter; left time: 10105.8056s
	iters: 200, epoch: 24 | loss: 0.0001826
	speed: 0.0649s/iter; left time: 2330.7986s
	iters: 300, epoch: 24 | loss: 0.0272613
	speed: 0.0636s/iter; left time: 2278.3215s
	iters: 400, epoch: 24 | loss: 0.0008772
	speed: 0.0610s/iter; left time: 2178.0919s
Epoch: 24 cost time: 30.303534984588623
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000413
	speed: 0.2540s/iter; left time: 9028.3355s
	iters: 200, epoch: 25 | loss: 0.0002702
	speed: 0.0589s/iter; left time: 2086.2248s
	iters: 300, epoch: 25 | loss: 0.0069943
	speed: 0.0591s/iter; left time: 2089.0330s
	iters: 400, epoch: 25 | loss: 0.0008958
	speed: 0.0590s/iter; left time: 2079.9484s
Epoch: 25 cost time: 28.574378490447998
Epoch: 25, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.290 Vali Acc: 0.936 Test Loss: 0.290 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0025094
	speed: 0.2834s/iter; left time: 9939.6388s
	iters: 200, epoch: 26 | loss: 0.0005802
	speed: 0.0646s/iter; left time: 2259.7888s
	iters: 300, epoch: 26 | loss: 0.0005791
	speed: 0.0589s/iter; left time: 2054.2063s
	iters: 400, epoch: 26 | loss: 0.0473573
	speed: 0.0541s/iter; left time: 1880.8983s
Epoch: 26 cost time: 28.401142358779907
Epoch: 26, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0677857
	speed: 0.1775s/iter; left time: 6143.5863s
	iters: 200, epoch: 27 | loss: 0.0001297
	speed: 0.0527s/iter; left time: 1818.6624s
	iters: 300, epoch: 27 | loss: 0.0201562
	speed: 0.0488s/iter; left time: 1678.6285s
	iters: 400, epoch: 27 | loss: 0.0006008
	speed: 0.0638s/iter; left time: 2189.4972s
Epoch: 27 cost time: 27.073474645614624
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0188200
	speed: 0.2742s/iter; left time: 9361.1602s
	iters: 200, epoch: 28 | loss: 0.0983830
	speed: 0.0651s/iter; left time: 2214.5379s
	iters: 300, epoch: 28 | loss: 0.0000599
	speed: 0.0632s/iter; left time: 2143.5759s
	iters: 400, epoch: 28 | loss: 0.0352871
	speed: 0.0611s/iter; left time: 2067.4299s
Epoch: 28 cost time: 30.143460273742676
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.4127490
	speed: 0.2817s/iter; left time: 9483.4034s
	iters: 200, epoch: 29 | loss: 0.0090744
	speed: 0.0686s/iter; left time: 2302.3941s
	iters: 300, epoch: 29 | loss: 0.3038044
	speed: 0.0671s/iter; left time: 2246.3978s
	iters: 400, epoch: 29 | loss: 0.0003443
	speed: 0.0665s/iter; left time: 2218.2560s
Epoch: 29 cost time: 31.487938165664673
Epoch: 29, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1236699
	speed: 0.2736s/iter; left time: 9084.2377s
	iters: 200, epoch: 30 | loss: 0.1671026
	speed: 0.0692s/iter; left time: 2290.8389s
	iters: 300, epoch: 30 | loss: 0.0878867
	speed: 0.0687s/iter; left time: 2266.8334s
	iters: 400, epoch: 30 | loss: 0.0006426
	speed: 0.0651s/iter; left time: 2141.6411s
Epoch: 30 cost time: 31.583062887191772
Epoch: 30, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.325 Vali Acc: 0.955 Test Loss: 0.325 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0593247
	speed: 0.2636s/iter; left time: 8626.7287s
	iters: 200, epoch: 31 | loss: 0.0012841
	speed: 0.0656s/iter; left time: 2139.1303s
	iters: 300, epoch: 31 | loss: 0.0000657
	speed: 0.0644s/iter; left time: 2094.8283s
	iters: 400, epoch: 31 | loss: 0.0001995
	speed: 0.0622s/iter; left time: 2018.7488s
Epoch: 31 cost time: 30.473792791366577
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974269 --> -0.974841).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000518
	speed: 0.2819s/iter; left time: 9095.1151s
	iters: 200, epoch: 32 | loss: 0.0000735
	speed: 0.0694s/iter; left time: 2232.7483s
	iters: 300, epoch: 32 | loss: 0.0007774
	speed: 0.0690s/iter; left time: 2211.4648s
	iters: 400, epoch: 32 | loss: 0.0000323
	speed: 0.0649s/iter; left time: 2074.1525s
Epoch: 32 cost time: 31.963740587234497
Epoch: 32, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.1083321
	speed: 0.2734s/iter; left time: 8692.8574s
	iters: 200, epoch: 33 | loss: 0.0073017
	speed: 0.0709s/iter; left time: 2248.5501s
	iters: 300, epoch: 33 | loss: 0.0000675
	speed: 0.0705s/iter; left time: 2228.1195s
	iters: 400, epoch: 33 | loss: 0.0214628
	speed: 0.0636s/iter; left time: 2002.5913s
Epoch: 33 cost time: 31.329407930374146
Epoch: 33, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.940 Test Loss: 0.317 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0006440
	speed: 0.2602s/iter; left time: 8149.3592s
	iters: 200, epoch: 34 | loss: 0.0000723
	speed: 0.0657s/iter; left time: 2050.3187s
	iters: 300, epoch: 34 | loss: 0.0009549
	speed: 0.0632s/iter; left time: 1966.6387s
	iters: 400, epoch: 34 | loss: 0.0001523
	speed: 0.0637s/iter; left time: 1975.6738s
Epoch: 34 cost time: 30.514312267303467
Epoch: 34, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0127484
	speed: 0.2780s/iter; left time: 8576.8404s
	iters: 200, epoch: 35 | loss: 0.0842963
	speed: 0.0670s/iter; left time: 2060.3649s
	iters: 300, epoch: 35 | loss: 0.0002389
	speed: 0.0679s/iter; left time: 2081.7858s
	iters: 400, epoch: 35 | loss: 0.0332902
	speed: 0.0668s/iter; left time: 2040.9851s
Epoch: 35 cost time: 31.520089626312256
Epoch: 35, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.229 Vali Acc: 0.957 Test Loss: 0.229 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0029569
	speed: 0.2721s/iter; left time: 8268.9314s
	iters: 200, epoch: 36 | loss: 0.0048884
	speed: 0.0707s/iter; left time: 2141.4749s
	iters: 300, epoch: 36 | loss: 0.1856052
	speed: 0.0642s/iter; left time: 1938.5209s
	iters: 400, epoch: 36 | loss: 0.0045386
	speed: 0.0651s/iter; left time: 1957.4104s
Epoch: 36 cost time: 31.103167057037354
Epoch: 36, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.1289318
	speed: 0.2446s/iter; left time: 7317.2933s
	iters: 200, epoch: 37 | loss: 0.1073891
	speed: 0.0650s/iter; left time: 1938.6670s
	iters: 300, epoch: 37 | loss: 0.0001949
	speed: 0.0648s/iter; left time: 1926.8960s
	iters: 400, epoch: 37 | loss: 0.0018790
	speed: 0.0598s/iter; left time: 1770.7800s
Epoch: 37 cost time: 30.091819286346436
Epoch: 37, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0046991
	speed: 0.2733s/iter; left time: 8046.9037s
	iters: 200, epoch: 38 | loss: 0.0018671
	speed: 0.0691s/iter; left time: 2029.2165s
	iters: 300, epoch: 38 | loss: 0.0005059
	speed: 0.0714s/iter; left time: 2088.3646s
	iters: 400, epoch: 38 | loss: 0.0206040
	speed: 0.0691s/iter; left time: 2015.4365s
Epoch: 38 cost time: 32.341947078704834
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.940 Test Loss: 0.279 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0052568
	speed: 0.2753s/iter; left time: 7976.5634s
	iters: 200, epoch: 39 | loss: 0.0137471
	speed: 0.0683s/iter; left time: 1972.2611s
	iters: 300, epoch: 39 | loss: 0.0001043
	speed: 0.0701s/iter; left time: 2018.6357s
	iters: 400, epoch: 39 | loss: 0.0024874
	speed: 0.0674s/iter; left time: 1933.3491s
Epoch: 39 cost time: 32.12493658065796
Epoch: 39, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.231 Vali Acc: 0.961 Test Loss: 0.231 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0174447
	speed: 0.2641s/iter; left time: 7529.0945s
	iters: 200, epoch: 40 | loss: 0.0213351
	speed: 0.0631s/iter; left time: 1793.6488s
	iters: 300, epoch: 40 | loss: 0.0002734
	speed: 0.0622s/iter; left time: 1761.3683s
	iters: 400, epoch: 40 | loss: 0.0000466
	speed: 0.0603s/iter; left time: 1701.6245s
Epoch: 40 cost time: 29.92873787879944
Epoch: 40, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.974841 --> -0.977414).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0204277
	speed: 0.3010s/iter; left time: 8439.6778s
	iters: 200, epoch: 41 | loss: 0.0002192
	speed: 0.0682s/iter; left time: 1904.2329s
	iters: 300, epoch: 41 | loss: 0.0002195
	speed: 0.0654s/iter; left time: 1820.3962s
	iters: 400, epoch: 41 | loss: 0.0028977
	speed: 0.0678s/iter; left time: 1879.7244s
Epoch: 41 cost time: 32.131361961364746
Epoch: 41, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.954 Test Loss: 0.227 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0011387
	speed: 0.2889s/iter; left time: 7966.7423s
	iters: 200, epoch: 42 | loss: 0.0009251
	speed: 0.0633s/iter; left time: 1740.0924s
	iters: 300, epoch: 42 | loss: 0.1187440
	speed: 0.0626s/iter; left time: 1713.0257s
	iters: 400, epoch: 42 | loss: 0.0028151
	speed: 0.0667s/iter; left time: 1820.0935s
Epoch: 42 cost time: 30.609878301620483
Epoch: 42, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0005787
	speed: 0.2662s/iter; left time: 7215.7426s
	iters: 200, epoch: 43 | loss: 0.0014810
	speed: 0.0613s/iter; left time: 1655.3411s
	iters: 300, epoch: 43 | loss: 0.0636350
	speed: 0.0618s/iter; left time: 1663.4114s
	iters: 400, epoch: 43 | loss: 0.0517490
	speed: 0.0581s/iter; left time: 1557.2078s
Epoch: 43 cost time: 29.487778425216675
Epoch: 43, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0119013
	speed: 0.2954s/iter; left time: 7868.2369s
	iters: 200, epoch: 44 | loss: 0.0038967
	speed: 0.0649s/iter; left time: 1721.7754s
	iters: 300, epoch: 44 | loss: 0.0006408
	speed: 0.0639s/iter; left time: 1689.6807s
	iters: 400, epoch: 44 | loss: 0.0049792
	speed: 0.0651s/iter; left time: 1714.6680s
Epoch: 44 cost time: 31.356971502304077
Epoch: 44, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.228 Vali Acc: 0.953 Test Loss: 0.228 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0043107
	speed: 0.2930s/iter; left time: 7667.0877s
	iters: 200, epoch: 45 | loss: 0.0797794
	speed: 0.0619s/iter; left time: 1614.4760s
	iters: 300, epoch: 45 | loss: 0.0136696
	speed: 0.0623s/iter; left time: 1618.9026s
	iters: 400, epoch: 45 | loss: 0.0121187
	speed: 0.0636s/iter; left time: 1644.4546s
Epoch: 45 cost time: 30.275723457336426
Epoch: 45, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.969 Test Loss: 0.208 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0002910
	speed: 0.2762s/iter; left time: 7098.1979s
	iters: 200, epoch: 46 | loss: 0.0000687
	speed: 0.0637s/iter; left time: 1629.3566s
	iters: 300, epoch: 46 | loss: 0.0099587
	speed: 0.0620s/iter; left time: 1581.9662s
	iters: 400, epoch: 46 | loss: 0.0008207
	speed: 0.0626s/iter; left time: 1589.0508s
Epoch: 46 cost time: 30.07182502746582
Epoch: 46, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0074430
	speed: 0.2812s/iter; left time: 7094.7083s
	iters: 200, epoch: 47 | loss: 0.0003889
	speed: 0.0574s/iter; left time: 1441.5791s
	iters: 300, epoch: 47 | loss: 0.0070231
	speed: 0.0557s/iter; left time: 1393.2992s
	iters: 400, epoch: 47 | loss: 0.0485247
	speed: 0.0597s/iter; left time: 1487.3836s
Epoch: 47 cost time: 28.290671586990356
Epoch: 47, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0002422
	speed: 0.2538s/iter; left time: 6283.9027s
	iters: 200, epoch: 48 | loss: 0.0529436
	speed: 0.0603s/iter; left time: 1485.9940s
	iters: 300, epoch: 48 | loss: 0.0016533
	speed: 0.0661s/iter; left time: 1622.4453s
	iters: 400, epoch: 48 | loss: 1.0362638
	speed: 0.0654s/iter; left time: 1598.6219s
Epoch: 48 cost time: 30.085291862487793
Epoch: 48, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.292 Vali Acc: 0.954 Test Loss: 0.292 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0004400
	speed: 0.2940s/iter; left time: 7141.0800s
	iters: 200, epoch: 49 | loss: 0.0067033
	speed: 0.0617s/iter; left time: 1492.4125s
	iters: 300, epoch: 49 | loss: 0.0021545
	speed: 0.0627s/iter; left time: 1509.7609s
	iters: 400, epoch: 49 | loss: 0.0109676
	speed: 0.0627s/iter; left time: 1503.1385s
Epoch: 49 cost time: 30.364357709884644
Epoch: 49, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0057242
	speed: 0.2968s/iter; left time: 7070.4546s
	iters: 200, epoch: 50 | loss: 0.0019403
	speed: 0.0612s/iter; left time: 1451.8873s
	iters: 300, epoch: 50 | loss: 0.1361870
	speed: 0.0608s/iter; left time: 1434.9179s
	iters: 400, epoch: 50 | loss: 0.0378712
	speed: 0.0631s/iter; left time: 1483.8484s
Epoch: 50 cost time: 29.883755683898926
Epoch: 50, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.452 Vali Acc: 0.929 Test Loss: 0.452 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 5574154
model size : 40.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3784400
	speed: 0.0856s/iter; left time: 4007.7360s
	iters: 200, epoch: 1 | loss: 0.1540028
	speed: 0.0700s/iter; left time: 3268.2436s
	iters: 300, epoch: 1 | loss: 0.0522858
	speed: 0.0754s/iter; left time: 3515.4057s
	iters: 400, epoch: 1 | loss: 0.2592534
	speed: 0.0624s/iter; left time: 2903.1064s
Epoch: 1 cost time: 34.06117820739746
Epoch: 1, Steps: 469 | Train Loss: 0.348 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (inf --> -0.954544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1194710
	speed: 0.2866s/iter; left time: 13276.9765s
	iters: 200, epoch: 2 | loss: 0.0096655
	speed: 0.0714s/iter; left time: 3303.1463s
	iters: 300, epoch: 2 | loss: 0.2455191
	speed: 0.0682s/iter; left time: 3144.8983s
	iters: 400, epoch: 2 | loss: 0.0136887
	speed: 0.0697s/iter; left time: 3208.6475s
Epoch: 2 cost time: 33.10495901107788
Epoch: 2, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.572 Vali Acc: 0.859 Test Loss: 0.572 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3128141
	speed: 0.2551s/iter; left time: 11698.9565s
	iters: 200, epoch: 3 | loss: 0.2900932
	speed: 0.0722s/iter; left time: 3304.9856s
	iters: 300, epoch: 3 | loss: 0.0582099
	speed: 0.0673s/iter; left time: 3071.4991s
	iters: 400, epoch: 3 | loss: 0.6429293
	speed: 0.0658s/iter; left time: 2996.9762s
Epoch: 3 cost time: 31.868816375732422
Epoch: 3, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.323 Vali Acc: 0.929 Test Loss: 0.323 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0567442
	speed: 0.2763s/iter; left time: 12544.2111s
	iters: 200, epoch: 4 | loss: 0.0125303
	speed: 0.0704s/iter; left time: 3187.6146s
	iters: 300, epoch: 4 | loss: 0.3608253
	speed: 0.0690s/iter; left time: 3119.8251s
	iters: 400, epoch: 4 | loss: 0.2271667
	speed: 0.0704s/iter; left time: 3173.8841s
Epoch: 4 cost time: 32.633063316345215
Epoch: 4, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3272537
	speed: 0.2824s/iter; left time: 12687.9895s
	iters: 200, epoch: 5 | loss: 0.0068488
	speed: 0.0712s/iter; left time: 3192.7762s
	iters: 300, epoch: 5 | loss: 0.1583658
	speed: 0.0692s/iter; left time: 3094.7417s
	iters: 400, epoch: 5 | loss: 0.0018128
	speed: 0.0655s/iter; left time: 2921.1741s
Epoch: 5 cost time: 31.92379117012024
Epoch: 5, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.295 Vali Acc: 0.936 Test Loss: 0.295 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0353119
	speed: 0.2561s/iter; left time: 11384.2742s
	iters: 200, epoch: 6 | loss: 0.2634695
	speed: 0.0644s/iter; left time: 2856.0130s
	iters: 300, epoch: 6 | loss: 0.0118988
	speed: 0.0640s/iter; left time: 2831.3848s
	iters: 400, epoch: 6 | loss: 0.3715694
	speed: 0.0712s/iter; left time: 3143.3364s
Epoch: 6 cost time: 31.112739324569702
Epoch: 6, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.436 Vali Acc: 0.918 Test Loss: 0.436 Test Acc: 0.918
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1434419
	speed: 0.2776s/iter; left time: 12210.6432s
	iters: 200, epoch: 7 | loss: 0.0730706
	speed: 0.0698s/iter; left time: 3064.8409s
	iters: 300, epoch: 7 | loss: 0.0106539
	speed: 0.0732s/iter; left time: 3206.8246s
	iters: 400, epoch: 7 | loss: 0.0203898
	speed: 0.0710s/iter; left time: 3100.5187s
Epoch: 7 cost time: 33.04019641876221
Epoch: 7, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.954544 --> -0.955973).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0006463
	speed: 0.2949s/iter; left time: 12831.3751s
	iters: 200, epoch: 8 | loss: 0.0057323
	speed: 0.0668s/iter; left time: 2899.4211s
	iters: 300, epoch: 8 | loss: 0.1494336
	speed: 0.0678s/iter; left time: 2938.2928s
	iters: 400, epoch: 8 | loss: 0.0059191
	speed: 0.0651s/iter; left time: 2814.7635s
Epoch: 8 cost time: 31.79611849784851
Epoch: 8, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7939608
	speed: 0.2640s/iter; left time: 11367.0509s
	iters: 200, epoch: 9 | loss: 0.4730791
	speed: 0.0675s/iter; left time: 2897.7316s
	iters: 300, epoch: 9 | loss: 0.0595012
	speed: 0.0680s/iter; left time: 2912.9730s
	iters: 400, epoch: 9 | loss: 0.2824610
	speed: 0.0652s/iter; left time: 2785.9781s
Epoch: 9 cost time: 31.37884020805359
Epoch: 9, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.955973 --> -0.958546).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0276803
	speed: 0.2770s/iter; left time: 11796.4086s
	iters: 200, epoch: 10 | loss: 0.4224690
	speed: 0.0693s/iter; left time: 2942.8702s
	iters: 300, epoch: 10 | loss: 0.4073510
	speed: 0.0703s/iter; left time: 2977.6943s
	iters: 400, epoch: 10 | loss: 0.0205461
	speed: 0.0703s/iter; left time: 2973.8828s
Epoch: 10 cost time: 32.6920530796051
Epoch: 10, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0098101
	speed: 0.2785s/iter; left time: 11726.5835s
	iters: 200, epoch: 11 | loss: 0.0257370
	speed: 0.0648s/iter; left time: 2722.9730s
	iters: 300, epoch: 11 | loss: 0.1763734
	speed: 0.0695s/iter; left time: 2911.8722s
	iters: 400, epoch: 11 | loss: 0.0023010
	speed: 0.0682s/iter; left time: 2851.6058s
Epoch: 11 cost time: 31.48079776763916
Epoch: 11, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1941480
	speed: 0.2658s/iter; left time: 11070.1867s
	iters: 200, epoch: 12 | loss: 0.0077853
	speed: 0.0679s/iter; left time: 2821.1302s
	iters: 300, epoch: 12 | loss: 0.0003173
	speed: 0.0693s/iter; left time: 2870.6066s
	iters: 400, epoch: 12 | loss: 0.0127859
	speed: 0.0713s/iter; left time: 2947.1972s
Epoch: 12 cost time: 32.14080500602722
Epoch: 12, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2584573
	speed: 0.2877s/iter; left time: 11846.2462s
	iters: 200, epoch: 13 | loss: 0.0473151
	speed: 0.0662s/iter; left time: 2718.7453s
	iters: 300, epoch: 13 | loss: 0.0224826
	speed: 0.0689s/iter; left time: 2824.6506s
	iters: 400, epoch: 13 | loss: 0.1032320
	speed: 0.0708s/iter; left time: 2894.2646s
Epoch: 13 cost time: 32.431018352508545
Epoch: 13, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.958546 --> -0.974841).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2117960
	speed: 0.2790s/iter; left time: 11356.2475s
	iters: 200, epoch: 14 | loss: 0.0000412
	speed: 0.0652s/iter; left time: 2647.2773s
	iters: 300, epoch: 14 | loss: 0.0053542
	speed: 0.0682s/iter; left time: 2762.3867s
	iters: 400, epoch: 14 | loss: 0.2203863
	speed: 0.0679s/iter; left time: 2744.1414s
Epoch: 14 cost time: 31.599915266036987
Epoch: 14, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1615057
	speed: 0.2760s/iter; left time: 11106.1342s
	iters: 200, epoch: 15 | loss: 0.0034080
	speed: 0.0680s/iter; left time: 2730.1129s
	iters: 300, epoch: 15 | loss: 0.3975641
	speed: 0.0697s/iter; left time: 2792.0093s
	iters: 400, epoch: 15 | loss: 0.0004149
	speed: 0.0696s/iter; left time: 2780.6807s
Epoch: 15 cost time: 32.82723593711853
Epoch: 15, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2527978
	speed: 0.2848s/iter; left time: 11327.1928s
	iters: 200, epoch: 16 | loss: 0.1591666
	speed: 0.0683s/iter; left time: 2710.3858s
	iters: 300, epoch: 16 | loss: 0.0342953
	speed: 0.0697s/iter; left time: 2758.5013s
	iters: 400, epoch: 16 | loss: 0.1516431
	speed: 0.0706s/iter; left time: 2788.1193s
Epoch: 16 cost time: 32.633100271224976
Epoch: 16, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
Validation loss decreased (-0.974841 --> -0.978844).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2154284
	speed: 0.2809s/iter; left time: 11040.2173s
	iters: 200, epoch: 17 | loss: 0.0034333
	speed: 0.0633s/iter; left time: 2479.4673s
	iters: 300, epoch: 17 | loss: 0.0001811
	speed: 0.0672s/iter; left time: 2627.0229s
	iters: 400, epoch: 17 | loss: 0.0051974
	speed: 0.0652s/iter; left time: 2542.3637s
Epoch: 17 cost time: 30.8474280834198
Epoch: 17, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0035564
	speed: 0.2758s/iter; left time: 10708.8296s
	iters: 200, epoch: 18 | loss: 0.3778242
	speed: 0.0711s/iter; left time: 2754.9457s
	iters: 300, epoch: 18 | loss: 0.0046580
	speed: 0.0700s/iter; left time: 2703.7852s
	iters: 400, epoch: 18 | loss: 0.1040975
	speed: 0.0686s/iter; left time: 2643.9403s
Epoch: 18 cost time: 32.65169954299927
Epoch: 18, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8842893
	speed: 0.2827s/iter; left time: 10845.8906s
	iters: 200, epoch: 19 | loss: 0.0095958
	speed: 0.0684s/iter; left time: 2617.1596s
	iters: 300, epoch: 19 | loss: 0.0017319
	speed: 0.0667s/iter; left time: 2544.9433s
	iters: 400, epoch: 19 | loss: 0.0016000
	speed: 0.0650s/iter; left time: 2473.3736s
Epoch: 19 cost time: 31.120711088180542
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0017649
	speed: 0.2746s/iter; left time: 10403.5077s
	iters: 200, epoch: 20 | loss: 0.0336945
	speed: 0.0652s/iter; left time: 2462.8203s
	iters: 300, epoch: 20 | loss: 0.0008945
	speed: 0.0662s/iter; left time: 2495.6877s
	iters: 400, epoch: 20 | loss: 0.0034909
	speed: 0.0631s/iter; left time: 2371.6287s
Epoch: 20 cost time: 31.005135774612427
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3186307
	speed: 0.2777s/iter; left time: 10393.5523s
	iters: 200, epoch: 21 | loss: 0.0001556
	speed: 0.0683s/iter; left time: 2549.2662s
	iters: 300, epoch: 21 | loss: 0.0100035
	speed: 0.0692s/iter; left time: 2575.6288s
	iters: 400, epoch: 21 | loss: 0.0779539
	speed: 0.0676s/iter; left time: 2509.7757s
Epoch: 21 cost time: 32.32727909088135
Epoch: 21, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0948200
	speed: 0.2924s/iter; left time: 10806.5480s
	iters: 200, epoch: 22 | loss: 0.0003148
	speed: 0.0689s/iter; left time: 2537.9464s
	iters: 300, epoch: 22 | loss: 0.0130948
	speed: 0.0685s/iter; left time: 2516.7436s
	iters: 400, epoch: 22 | loss: 0.0409489
	speed: 0.0625s/iter; left time: 2290.1128s
Epoch: 22 cost time: 31.390087366104126
Epoch: 22, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0010146
	speed: 0.2735s/iter; left time: 9977.0577s
	iters: 200, epoch: 23 | loss: 0.0005704
	speed: 0.0621s/iter; left time: 2257.5780s
	iters: 300, epoch: 23 | loss: 0.3668992
	speed: 0.0612s/iter; left time: 2221.6549s
	iters: 400, epoch: 23 | loss: 0.0128937
	speed: 0.0694s/iter; left time: 2510.0006s
Epoch: 23 cost time: 30.758781671524048
Epoch: 23, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1206859
	speed: 0.2938s/iter; left time: 10582.2238s
	iters: 200, epoch: 24 | loss: 0.0114956
	speed: 0.0672s/iter; left time: 2412.5729s
	iters: 300, epoch: 24 | loss: 0.0013748
	speed: 0.0677s/iter; left time: 2425.8977s
	iters: 400, epoch: 24 | loss: 0.0026915
	speed: 0.0675s/iter; left time: 2410.2816s
Epoch: 24 cost time: 31.678162097930908
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0013667
	speed: 0.2792s/iter; left time: 9924.1930s
	iters: 200, epoch: 25 | loss: 0.3340174
	speed: 0.0668s/iter; left time: 2367.3782s
	iters: 300, epoch: 25 | loss: 0.0051301
	speed: 0.0642s/iter; left time: 2268.9028s
	iters: 400, epoch: 25 | loss: 0.0040188
	speed: 0.0640s/iter; left time: 2257.0148s
Epoch: 25 cost time: 30.732499599456787
Epoch: 25, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1669873
	speed: 0.2721s/iter; left time: 9544.0443s
	iters: 200, epoch: 26 | loss: 0.0561935
	speed: 0.0649s/iter; left time: 2268.6315s
	iters: 300, epoch: 26 | loss: 0.0147445
	speed: 0.0660s/iter; left time: 2302.8861s
	iters: 400, epoch: 26 | loss: 0.0019741
	speed: 0.0681s/iter; left time: 2368.1074s
Epoch: 26 cost time: 31.00439691543579
Epoch: 26, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 5574154
model size : 40.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3624789
	speed: 0.0829s/iter; left time: 3878.9236s
	iters: 200, epoch: 1 | loss: 0.1411860
	speed: 0.0694s/iter; left time: 3242.1108s
	iters: 300, epoch: 1 | loss: 0.0471458
	speed: 0.0686s/iter; left time: 3198.8322s
	iters: 400, epoch: 1 | loss: 0.0494328
	speed: 0.0690s/iter; left time: 3208.1372s
Epoch: 1 cost time: 33.74809718132019
Epoch: 1, Steps: 469 | Train Loss: 0.337 Vali Loss: 0.247 Vali Acc: 0.916 Test Loss: 0.247 Test Acc: 0.916
Validation loss decreased (inf --> -0.915950).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1303714
	speed: 0.2606s/iter; left time: 12072.4765s
	iters: 200, epoch: 2 | loss: 0.0171662
	speed: 0.0661s/iter; left time: 3053.9615s
	iters: 300, epoch: 2 | loss: 0.0226129
	speed: 0.0680s/iter; left time: 3134.7851s
	iters: 400, epoch: 2 | loss: 0.0041403
	speed: 0.0639s/iter; left time: 2942.8697s
Epoch: 2 cost time: 30.816306591033936
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.915950 --> -0.952257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0481967
	speed: 0.2733s/iter; left time: 12532.3165s
	iters: 200, epoch: 3 | loss: 0.0421300
	speed: 0.0699s/iter; left time: 3198.4555s
	iters: 300, epoch: 3 | loss: 0.0371667
	speed: 0.0698s/iter; left time: 3185.1267s
	iters: 400, epoch: 3 | loss: 0.2945811
	speed: 0.0682s/iter; left time: 3108.8665s
Epoch: 3 cost time: 32.507227420806885
Epoch: 3, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.322 Vali Acc: 0.910 Test Loss: 0.322 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0029774
	speed: 0.2784s/iter; left time: 12637.4146s
	iters: 200, epoch: 4 | loss: 0.0402925
	speed: 0.0673s/iter; left time: 3049.3092s
	iters: 300, epoch: 4 | loss: 0.5824773
	speed: 0.0710s/iter; left time: 3207.7147s
	iters: 400, epoch: 4 | loss: 0.2881252
	speed: 0.0706s/iter; left time: 3182.1106s
Epoch: 4 cost time: 32.05468773841858
Epoch: 4, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0055348
	speed: 0.2667s/iter; left time: 11979.6604s
	iters: 200, epoch: 5 | loss: 0.0888226
	speed: 0.0661s/iter; left time: 2964.3088s
	iters: 300, epoch: 5 | loss: 0.1704302
	speed: 0.0636s/iter; left time: 2842.4459s
	iters: 400, epoch: 5 | loss: 0.0140845
	speed: 0.0652s/iter; left time: 2907.4698s
Epoch: 5 cost time: 30.50349473953247
Epoch: 5, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.544 Vali Acc: 0.891 Test Loss: 0.544 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3893855
	speed: 0.2640s/iter; left time: 11734.5754s
	iters: 200, epoch: 6 | loss: 0.4694919
	speed: 0.0669s/iter; left time: 2965.7822s
	iters: 300, epoch: 6 | loss: 0.0028037
	speed: 0.0724s/iter; left time: 3205.5877s
	iters: 400, epoch: 6 | loss: 0.0802359
	speed: 0.0662s/iter; left time: 2921.9799s
Epoch: 6 cost time: 31.871878385543823
Epoch: 6, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2010035
	speed: 0.2821s/iter; left time: 12408.1856s
	iters: 200, epoch: 7 | loss: 0.1559841
	speed: 0.0650s/iter; left time: 2853.3977s
	iters: 300, epoch: 7 | loss: 0.0006146
	speed: 0.0699s/iter; left time: 3061.4669s
	iters: 400, epoch: 7 | loss: 1.2086825
	speed: 0.0703s/iter; left time: 3069.6291s
Epoch: 7 cost time: 32.54057574272156
Epoch: 7, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.266 Vali Acc: 0.943 Test Loss: 0.266 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0126506
	speed: 0.2668s/iter; left time: 11612.5275s
	iters: 200, epoch: 8 | loss: 0.0005281
	speed: 0.0631s/iter; left time: 2739.2322s
	iters: 300, epoch: 8 | loss: 0.0467118
	speed: 0.0679s/iter; left time: 2939.1971s
	iters: 400, epoch: 8 | loss: 0.0027722
	speed: 0.0663s/iter; left time: 2866.0169s
Epoch: 8 cost time: 30.99061107635498
Epoch: 8, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.265 Vali Acc: 0.947 Test Loss: 0.265 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0005267
	speed: 0.2817s/iter; left time: 12126.8296s
	iters: 200, epoch: 9 | loss: 0.0006739
	speed: 0.0675s/iter; left time: 2898.1055s
	iters: 300, epoch: 9 | loss: 0.0127175
	speed: 0.0698s/iter; left time: 2991.6819s
	iters: 400, epoch: 9 | loss: 0.0058183
	speed: 0.0692s/iter; left time: 2957.5839s
Epoch: 9 cost time: 32.26605987548828
Epoch: 9, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0031003
	speed: 0.2734s/iter; left time: 11640.4517s
	iters: 200, epoch: 10 | loss: 0.0219089
	speed: 0.0685s/iter; left time: 2910.8180s
	iters: 300, epoch: 10 | loss: 0.2186521
	speed: 0.0695s/iter; left time: 2945.0702s
	iters: 400, epoch: 10 | loss: 0.1466932
	speed: 0.0667s/iter; left time: 2821.7561s
Epoch: 10 cost time: 32.24337148666382
Epoch: 10, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.254 Vali Acc: 0.961 Test Loss: 0.254 Test Acc: 0.961
Validation loss decreased (-0.952257 --> -0.961404).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0027547
	speed: 0.2702s/iter; left time: 11376.5365s
	iters: 200, epoch: 11 | loss: 0.0285353
	speed: 0.0652s/iter; left time: 2740.7495s
	iters: 300, epoch: 11 | loss: 0.0681089
	speed: 0.0643s/iter; left time: 2695.4906s
	iters: 400, epoch: 11 | loss: 0.0148727
	speed: 0.0704s/iter; left time: 2943.6593s
Epoch: 11 cost time: 31.297624588012695
Epoch: 11, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0059862
	speed: 0.2801s/iter; left time: 11662.5565s
	iters: 200, epoch: 12 | loss: 0.3519210
	speed: 0.0686s/iter; left time: 2851.5995s
	iters: 300, epoch: 12 | loss: 0.0013372
	speed: 0.0695s/iter; left time: 2879.8522s
	iters: 400, epoch: 12 | loss: 0.0127218
	speed: 0.0680s/iter; left time: 2812.2226s
Epoch: 12 cost time: 32.2257137298584
Epoch: 12, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3508689
	speed: 0.2822s/iter; left time: 11619.7414s
	iters: 200, epoch: 13 | loss: 0.0057138
	speed: 0.0656s/iter; left time: 2695.8585s
	iters: 300, epoch: 13 | loss: 0.0019002
	speed: 0.0651s/iter; left time: 2667.6961s
	iters: 400, epoch: 13 | loss: 0.0013170
	speed: 0.0658s/iter; left time: 2689.4750s
Epoch: 13 cost time: 31.1523220539093
Epoch: 13, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.322 Vali Acc: 0.947 Test Loss: 0.322 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4854630
	speed: 0.2651s/iter; left time: 10791.1528s
	iters: 200, epoch: 14 | loss: 0.0011277
	speed: 0.0671s/iter; left time: 2723.2340s
	iters: 300, epoch: 14 | loss: 0.0060061
	speed: 0.0686s/iter; left time: 2776.5676s
	iters: 400, epoch: 14 | loss: 0.2043592
	speed: 0.0692s/iter; left time: 2795.8890s
Epoch: 14 cost time: 32.00688099861145
Epoch: 14, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0771124
	speed: 0.2830s/iter; left time: 11386.0560s
	iters: 200, epoch: 15 | loss: 0.0179770
	speed: 0.0658s/iter; left time: 2639.5259s
	iters: 300, epoch: 15 | loss: 0.1183190
	speed: 0.0663s/iter; left time: 2653.7650s
	iters: 400, epoch: 15 | loss: 0.0010887
	speed: 0.0615s/iter; left time: 2454.9684s
Epoch: 15 cost time: 30.390269994735718
Epoch: 15, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0036967
	speed: 0.2878s/iter; left time: 11445.4738s
	iters: 200, epoch: 16 | loss: 0.0961222
	speed: 0.0660s/iter; left time: 2617.9785s
	iters: 300, epoch: 16 | loss: 0.9514486
	speed: 0.0640s/iter; left time: 2533.1725s
	iters: 400, epoch: 16 | loss: 0.0415893
	speed: 0.0630s/iter; left time: 2487.3794s
Epoch: 16 cost time: 31.01624321937561
Epoch: 16, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.315 Vali Acc: 0.953 Test Loss: 0.315 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0450015
	speed: 0.2611s/iter; left time: 10260.0175s
	iters: 200, epoch: 17 | loss: 0.0063445
	speed: 0.0683s/iter; left time: 2675.5007s
	iters: 300, epoch: 17 | loss: 0.0001808
	speed: 0.0669s/iter; left time: 2614.6475s
	iters: 400, epoch: 17 | loss: 0.0000802
	speed: 0.0672s/iter; left time: 2619.4853s
Epoch: 17 cost time: 31.699960947036743
Epoch: 17, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.961404 --> -0.967408).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005916
	speed: 0.2910s/iter; left time: 11297.7724s
	iters: 200, epoch: 18 | loss: 0.0209150
	speed: 0.0700s/iter; left time: 2711.7604s
	iters: 300, epoch: 18 | loss: 0.0387291
	speed: 0.0668s/iter; left time: 2578.7178s
	iters: 400, epoch: 18 | loss: 0.0585772
	speed: 0.0673s/iter; left time: 2593.9818s
Epoch: 18 cost time: 32.17435884475708
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967408 --> -0.968552).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6176322
	speed: 0.2927s/iter; left time: 11228.6833s
	iters: 200, epoch: 19 | loss: 0.0556113
	speed: 0.0650s/iter; left time: 2488.6699s
	iters: 300, epoch: 19 | loss: 0.0021800
	speed: 0.0631s/iter; left time: 2408.2669s
	iters: 400, epoch: 19 | loss: 0.0010584
	speed: 0.0611s/iter; left time: 2327.1926s
Epoch: 19 cost time: 30.26339030265808
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0078802
	speed: 0.2757s/iter; left time: 10447.1650s
	iters: 200, epoch: 20 | loss: 0.2095215
	speed: 0.0688s/iter; left time: 2598.1438s
	iters: 300, epoch: 20 | loss: 0.0002329
	speed: 0.0636s/iter; left time: 2398.7215s
	iters: 400, epoch: 20 | loss: 0.0002843
	speed: 0.0668s/iter; left time: 2512.4425s
Epoch: 20 cost time: 31.633883237838745
Epoch: 20, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.974270).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0016821
	speed: 0.2907s/iter; left time: 10879.5079s
	iters: 200, epoch: 21 | loss: 0.0088037
	speed: 0.0697s/iter; left time: 2601.6782s
	iters: 300, epoch: 21 | loss: 0.0006448
	speed: 0.0651s/iter; left time: 2421.8155s
	iters: 400, epoch: 21 | loss: 0.0011479
	speed: 0.0661s/iter; left time: 2452.7490s
Epoch: 21 cost time: 32.0372428894043
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.965 Test Loss: 0.198 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0086261
	speed: 0.2884s/iter; left time: 10655.5495s
	iters: 200, epoch: 22 | loss: 0.0089482
	speed: 0.0683s/iter; left time: 2515.2001s
	iters: 300, epoch: 22 | loss: 0.0022817
	speed: 0.0633s/iter; left time: 2325.3706s
	iters: 400, epoch: 22 | loss: 0.1109150
	speed: 0.0622s/iter; left time: 2279.3092s
Epoch: 22 cost time: 30.682104349136353
Epoch: 22, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1888347
	speed: 0.2835s/iter; left time: 10341.4395s
	iters: 200, epoch: 23 | loss: 0.0003310
	speed: 0.0696s/iter; left time: 2533.8428s
	iters: 300, epoch: 23 | loss: 0.0686119
	speed: 0.0666s/iter; left time: 2415.9149s
	iters: 400, epoch: 23 | loss: 0.5859799
	speed: 0.0689s/iter; left time: 2492.7029s
Epoch: 23 cost time: 32.92269825935364
Epoch: 23, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.977129).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0041739
	speed: 0.2933s/iter; left time: 10564.6429s
	iters: 200, epoch: 24 | loss: 0.0043007
	speed: 0.0670s/iter; left time: 2404.6493s
	iters: 300, epoch: 24 | loss: 0.0235857
	speed: 0.0670s/iter; left time: 2398.2067s
	iters: 400, epoch: 24 | loss: 0.0364311
	speed: 0.0653s/iter; left time: 2331.3607s
Epoch: 24 cost time: 31.712835550308228
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0150347
	speed: 0.2855s/iter; left time: 10147.3390s
	iters: 200, epoch: 25 | loss: 0.0106003
	speed: 0.0633s/iter; left time: 2242.9139s
	iters: 300, epoch: 25 | loss: 0.0002635
	speed: 0.0637s/iter; left time: 2252.9421s
	iters: 400, epoch: 25 | loss: 0.0032595
	speed: 0.0622s/iter; left time: 2193.6907s
Epoch: 25 cost time: 30.655215740203857
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.302 Vali Acc: 0.934 Test Loss: 0.302 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3024487
	speed: 0.2875s/iter; left time: 10082.9736s
	iters: 200, epoch: 26 | loss: 0.0019034
	speed: 0.0686s/iter; left time: 2397.8254s
	iters: 300, epoch: 26 | loss: 0.0003673
	speed: 0.0689s/iter; left time: 2401.7399s
	iters: 400, epoch: 26 | loss: 0.0048893
	speed: 0.0658s/iter; left time: 2287.7408s
Epoch: 26 cost time: 32.53118133544922
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.959 Test Loss: 0.274 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0001195
	speed: 0.2908s/iter; left time: 10063.0460s
	iters: 200, epoch: 27 | loss: 0.0003158
	speed: 0.0665s/iter; left time: 2295.9190s
	iters: 300, epoch: 27 | loss: 0.0082741
	speed: 0.0651s/iter; left time: 2241.3998s
	iters: 400, epoch: 27 | loss: 0.3212348
	speed: 0.0682s/iter; left time: 2340.0457s
Epoch: 27 cost time: 31.714643001556396
Epoch: 27, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.306 Vali Acc: 0.945 Test Loss: 0.306 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.2283517
	speed: 0.2598s/iter; left time: 8867.9504s
	iters: 200, epoch: 28 | loss: 0.0009982
	speed: 0.0618s/iter; left time: 2103.5151s
	iters: 300, epoch: 28 | loss: 0.0725341
	speed: 0.0608s/iter; left time: 2061.8179s
	iters: 400, epoch: 28 | loss: 0.0967002
	speed: 0.0640s/iter; left time: 2164.7740s
Epoch: 28 cost time: 30.22133779525757
Epoch: 28, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0021031
	speed: 0.2901s/iter; left time: 9769.0048s
	iters: 200, epoch: 29 | loss: 0.0000852
	speed: 0.0677s/iter; left time: 2272.9394s
	iters: 300, epoch: 29 | loss: 0.0040528
	speed: 0.0684s/iter; left time: 2288.6789s
	iters: 400, epoch: 29 | loss: 0.0005954
	speed: 0.0680s/iter; left time: 2269.1276s
Epoch: 29 cost time: 32.5126793384552
Epoch: 29, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0016882
	speed: 0.2894s/iter; left time: 9607.8094s
	iters: 200, epoch: 30 | loss: 0.0007111
	speed: 0.0696s/iter; left time: 2305.2705s
	iters: 300, epoch: 30 | loss: 0.0050877
	speed: 0.0707s/iter; left time: 2332.8418s
	iters: 400, epoch: 30 | loss: 0.0001974
	speed: 0.0666s/iter; left time: 2191.4194s
Epoch: 30 cost time: 32.33524012565613
Epoch: 30, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0956476
	speed: 0.2716s/iter; left time: 8888.9732s
	iters: 200, epoch: 31 | loss: 0.0078495
	speed: 0.0623s/iter; left time: 2031.8148s
	iters: 300, epoch: 31 | loss: 0.0345055
	speed: 0.0616s/iter; left time: 2003.0319s
	iters: 400, epoch: 31 | loss: 0.0439805
	speed: 0.0691s/iter; left time: 2242.0549s
Epoch: 31 cost time: 30.738237857818604
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3721447
	speed: 0.2803s/iter; left time: 9043.8242s
	iters: 200, epoch: 32 | loss: 0.0008309
	speed: 0.0640s/iter; left time: 2059.0703s
	iters: 300, epoch: 32 | loss: 0.0128925
	speed: 0.0639s/iter; left time: 2047.7683s
	iters: 400, epoch: 32 | loss: 0.0009929
	speed: 0.0700s/iter; left time: 2238.6890s
Epoch: 32 cost time: 31.43214225769043
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.3246280
	speed: 0.2972s/iter; left time: 9449.5394s
	iters: 200, epoch: 33 | loss: 0.2425426
	speed: 0.0630s/iter; left time: 1995.6103s
	iters: 300, epoch: 33 | loss: 0.0020243
	speed: 0.0621s/iter; left time: 1962.4891s
	iters: 400, epoch: 33 | loss: 0.0129309
	speed: 0.0665s/iter; left time: 2095.4167s
Epoch: 33 cost time: 31.021055459976196
Epoch: 33, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.940 Test Loss: 0.304 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 5574154
model size : 40.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3041592
	speed: 0.0885s/iter; left time: 4141.6289s
	iters: 200, epoch: 1 | loss: 2.3021212
	speed: 0.0708s/iter; left time: 3306.2319s
	iters: 300, epoch: 1 | loss: 2.3032110
	speed: 0.0689s/iter; left time: 3208.8357s
	iters: 400, epoch: 1 | loss: 2.3034763
	speed: 0.0688s/iter; left time: 3200.7503s
Epoch: 1 cost time: 34.51815938949585
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3043838
	speed: 0.2634s/iter; left time: 12202.6960s
	iters: 200, epoch: 2 | loss: 2.3017516
	speed: 0.0692s/iter; left time: 3200.7017s
	iters: 300, epoch: 2 | loss: 2.3058219
	speed: 0.0709s/iter; left time: 3269.5009s
	iters: 400, epoch: 2 | loss: 2.3036609
	speed: 0.0722s/iter; left time: 3321.5918s
Epoch: 2 cost time: 32.948102712631226
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3023891
	speed: 0.2728s/iter; left time: 12512.4487s
	iters: 200, epoch: 3 | loss: 2.3030581
	speed: 0.0669s/iter; left time: 3062.3292s
	iters: 300, epoch: 3 | loss: 2.3052726
	speed: 0.0692s/iter; left time: 3158.6516s
	iters: 400, epoch: 3 | loss: 2.2970438
	speed: 0.0661s/iter; left time: 3009.8844s
Epoch: 3 cost time: 31.615519285202026
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3094056
	speed: 0.2835s/iter; left time: 12867.3682s
	iters: 200, epoch: 4 | loss: 2.3027813
	speed: 0.0742s/iter; left time: 3358.6146s
	iters: 300, epoch: 4 | loss: 2.2935686
	speed: 0.0688s/iter; left time: 3111.1153s
	iters: 400, epoch: 4 | loss: 2.2935410
	speed: 0.0661s/iter; left time: 2981.5064s
Epoch: 4 cost time: 32.816650390625
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2979958
	speed: 0.2749s/iter; left time: 12350.1476s
	iters: 200, epoch: 5 | loss: 2.3175871
	speed: 0.0720s/iter; left time: 3228.2885s
	iters: 300, epoch: 5 | loss: 2.3150618
	speed: 0.0690s/iter; left time: 3085.7312s
	iters: 400, epoch: 5 | loss: 2.3230300
	speed: 0.0669s/iter; left time: 2983.6179s
Epoch: 5 cost time: 32.250290632247925
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2905676
	speed: 0.2544s/iter; left time: 11308.9819s
	iters: 200, epoch: 6 | loss: 2.3066630
	speed: 0.0648s/iter; left time: 2872.8792s
	iters: 300, epoch: 6 | loss: 2.2892718
	speed: 0.0641s/iter; left time: 2836.4402s
	iters: 400, epoch: 6 | loss: 2.2846897
	speed: 0.0665s/iter; left time: 2938.1585s
Epoch: 6 cost time: 30.778262853622437
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2989433
	speed: 0.2802s/iter; left time: 12327.1025s
	iters: 200, epoch: 7 | loss: 2.2862203
	speed: 0.0717s/iter; left time: 3148.4645s
	iters: 300, epoch: 7 | loss: 2.3092101
	speed: 0.0698s/iter; left time: 3057.6959s
	iters: 400, epoch: 7 | loss: 2.3074725
	speed: 0.0682s/iter; left time: 2981.1385s
Epoch: 7 cost time: 32.74379301071167
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2949162
	speed: 0.2841s/iter; left time: 12364.3404s
	iters: 200, epoch: 8 | loss: 2.3012655
	speed: 0.0710s/iter; left time: 3083.5522s
	iters: 300, epoch: 8 | loss: 2.3063810
	speed: 0.0701s/iter; left time: 3037.4552s
	iters: 400, epoch: 8 | loss: 2.3132329
	speed: 0.0653s/iter; left time: 2823.8942s
Epoch: 8 cost time: 32.1708722114563
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2979655
	speed: 0.2622s/iter; left time: 11289.5439s
	iters: 200, epoch: 9 | loss: 2.2931526
	speed: 0.0617s/iter; left time: 2649.4342s
	iters: 300, epoch: 9 | loss: 2.3148503
	speed: 0.0658s/iter; left time: 2819.4941s
	iters: 400, epoch: 9 | loss: 2.2876055
	speed: 0.0658s/iter; left time: 2812.9952s
Epoch: 9 cost time: 31.01221013069153
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3000591
	speed: 0.2888s/iter; left time: 12296.3072s
	iters: 200, epoch: 10 | loss: 2.2920017
	speed: 0.0696s/iter; left time: 2955.4364s
	iters: 300, epoch: 10 | loss: 2.2986412
	speed: 0.0671s/iter; left time: 2844.5805s
	iters: 400, epoch: 10 | loss: 2.2893937
	speed: 0.0664s/iter; left time: 2807.0543s
Epoch: 10 cost time: 32.37184262275696
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3031929
	speed: 0.2825s/iter; left time: 11895.3670s
	iters: 200, epoch: 11 | loss: 2.2898526
	speed: 0.0663s/iter; left time: 2785.2031s
	iters: 300, epoch: 11 | loss: 2.3105631
	speed: 0.0623s/iter; left time: 2610.9665s
	iters: 400, epoch: 11 | loss: 2.2936356
	speed: 0.0655s/iter; left time: 2738.3283s
Epoch: 11 cost time: 31.070763111114502
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2959580
	speed: 0.2701s/iter; left time: 11247.6400s
	iters: 200, epoch: 12 | loss: 2.3026648
	speed: 0.0673s/iter; left time: 2795.8059s
	iters: 300, epoch: 12 | loss: 2.2837744
	speed: 0.0673s/iter; left time: 2791.0097s
	iters: 400, epoch: 12 | loss: 2.3147728
	speed: 0.0677s/iter; left time: 2800.1605s
Epoch: 12 cost time: 31.759357929229736
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3085959
	speed: 0.2710s/iter; left time: 11156.5537s
	iters: 200, epoch: 13 | loss: 2.2900457
	speed: 0.0634s/iter; left time: 2602.7053s
	iters: 300, epoch: 13 | loss: 2.3041456
	speed: 0.0681s/iter; left time: 2791.4169s
	iters: 400, epoch: 13 | loss: 2.3090594
	speed: 0.0576s/iter; left time: 2355.2314s
Epoch: 13 cost time: 29.896652936935425
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3022723
	speed: 0.1746s/iter; left time: 7105.6061s
	iters: 200, epoch: 14 | loss: 2.3096342
	speed: 0.0493s/iter; left time: 2001.8822s
	iters: 300, epoch: 14 | loss: 2.2832899
	speed: 0.0542s/iter; left time: 2193.8810s
	iters: 400, epoch: 14 | loss: 2.3022141
	speed: 0.0624s/iter; left time: 2520.8158s
Epoch: 14 cost time: 26.445435523986816
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.3012533
	speed: 0.2686s/iter; left time: 10806.8451s
	iters: 200, epoch: 15 | loss: 2.3035026
	speed: 0.0651s/iter; left time: 2613.2467s
	iters: 300, epoch: 15 | loss: 2.3032653
	speed: 0.0705s/iter; left time: 2822.0784s
	iters: 400, epoch: 15 | loss: 2.2859931
	speed: 0.0649s/iter; left time: 2593.0295s
Epoch: 15 cost time: 31.50837731361389
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.3117883
	speed: 0.2856s/iter; left time: 11357.4483s
	iters: 200, epoch: 16 | loss: 2.3195846
	speed: 0.0689s/iter; left time: 2732.9792s
	iters: 300, epoch: 16 | loss: 2.3031113
	speed: 0.0731s/iter; left time: 2892.9185s
	iters: 400, epoch: 16 | loss: 2.2983184
	speed: 0.0664s/iter; left time: 2619.4898s
Epoch: 16 cost time: 32.238839864730835
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.3046312
	speed: 0.2763s/iter; left time: 10857.3098s
	iters: 200, epoch: 17 | loss: 2.3139553
	speed: 0.0629s/iter; left time: 2464.3285s
	iters: 300, epoch: 17 | loss: 2.3194449
	speed: 0.0657s/iter; left time: 2568.4877s
	iters: 400, epoch: 17 | loss: 2.3137524
	speed: 0.0648s/iter; left time: 2527.0156s
Epoch: 17 cost time: 30.477693557739258
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 2.3175485
	speed: 0.2675s/iter; left time: 10386.9569s
	iters: 200, epoch: 18 | loss: 2.3025916
	speed: 0.0677s/iter; left time: 2623.3254s
	iters: 300, epoch: 18 | loss: 2.3101079
	speed: 0.0694s/iter; left time: 2680.7955s
	iters: 400, epoch: 18 | loss: 2.2865210
	speed: 0.0683s/iter; left time: 2629.9542s
Epoch: 18 cost time: 31.606853723526
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.2925618
	speed: 0.2777s/iter; left time: 10653.2470s
	iters: 200, epoch: 19 | loss: 2.3230584
	speed: 0.0663s/iter; left time: 2536.5899s
	iters: 300, epoch: 19 | loss: 2.3007081
	speed: 0.0659s/iter; left time: 2515.6892s
	iters: 400, epoch: 19 | loss: 2.3080549
	speed: 0.0657s/iter; left time: 2500.1931s
Epoch: 19 cost time: 30.89734649658203
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.3052804
	speed: 0.2802s/iter; left time: 10616.9009s
	iters: 200, epoch: 20 | loss: 2.2845013
	speed: 0.0644s/iter; left time: 2432.9072s
	iters: 300, epoch: 20 | loss: 2.3054240
	speed: 0.0676s/iter; left time: 2546.9104s
	iters: 400, epoch: 20 | loss: 2.2948809
	speed: 0.0635s/iter; left time: 2385.4876s
Epoch: 20 cost time: 30.893704652786255
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.2900317
	speed: 0.2748s/iter; left time: 10284.1873s
	iters: 200, epoch: 21 | loss: 2.3084280
	speed: 0.0656s/iter; left time: 2446.9347s
	iters: 300, epoch: 21 | loss: 2.2911451
	speed: 0.0664s/iter; left time: 2471.0153s
	iters: 400, epoch: 21 | loss: 2.3189054
	speed: 0.0622s/iter; left time: 2307.0947s
Epoch: 21 cost time: 30.903709650039673
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.3111982
	speed: 0.2863s/iter; left time: 10579.5677s
	iters: 200, epoch: 22 | loss: 2.2950478
	speed: 0.0662s/iter; left time: 2439.0869s
	iters: 300, epoch: 22 | loss: 2.3063850
	speed: 0.0640s/iter; left time: 2351.9624s
	iters: 400, epoch: 22 | loss: 2.2981925
	speed: 0.0681s/iter; left time: 2495.7805s
Epoch: 22 cost time: 31.270184993743896
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.3149083
	speed: 0.2718s/iter; left time: 9915.5727s
	iters: 200, epoch: 23 | loss: 2.2961118
	speed: 0.0647s/iter; left time: 2353.2021s
	iters: 300, epoch: 23 | loss: 2.3033795
	speed: 0.0712s/iter; left time: 2584.2458s
	iters: 400, epoch: 23 | loss: 2.3000877
	speed: 0.0618s/iter; left time: 2236.6361s
Epoch: 23 cost time: 30.677306413650513
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3026776
	speed: 0.2434s/iter; left time: 8766.8500s
	iters: 200, epoch: 24 | loss: 2.3040946
	speed: 0.0632s/iter; left time: 2269.5272s
	iters: 300, epoch: 24 | loss: 2.2942779
	speed: 0.0636s/iter; left time: 2276.2144s
	iters: 400, epoch: 24 | loss: 2.3043690
	speed: 0.0635s/iter; left time: 2268.4439s
Epoch: 24 cost time: 30.043941736221313
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.3040819
	speed: 0.2455s/iter; left time: 8725.3010s
	iters: 200, epoch: 25 | loss: 2.2929797
	speed: 0.0588s/iter; left time: 2085.6731s
	iters: 300, epoch: 25 | loss: 2.2939975
	speed: 0.0606s/iter; left time: 2143.5015s
	iters: 400, epoch: 25 | loss: 2.2847269
	speed: 0.0613s/iter; left time: 2160.8354s
Epoch: 25 cost time: 28.298627376556396
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.2997897
	speed: 0.2644s/iter; left time: 9272.5731s
	iters: 200, epoch: 26 | loss: 2.2999301
	speed: 0.0636s/iter; left time: 2225.9478s
	iters: 300, epoch: 26 | loss: 2.2737880
	speed: 0.0683s/iter; left time: 2381.5489s
	iters: 400, epoch: 26 | loss: 2.2830992
	speed: 0.0700s/iter; left time: 2435.3572s
Epoch: 26 cost time: 31.217572450637817
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3052027
	speed: 0.2803s/iter; left time: 9699.8276s
	iters: 200, epoch: 27 | loss: 2.3009174
	speed: 0.0626s/iter; left time: 2160.5367s
	iters: 300, epoch: 27 | loss: 2.3169277
	speed: 0.0619s/iter; left time: 2129.4299s
	iters: 400, epoch: 27 | loss: 2.3131790
	speed: 0.0642s/iter; left time: 2201.5243s
Epoch: 27 cost time: 30.460594415664673
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.3068779
	speed: 0.2764s/iter; left time: 9435.5262s
	iters: 200, epoch: 28 | loss: 2.3065555
	speed: 0.0621s/iter; left time: 2113.0455s
	iters: 300, epoch: 28 | loss: 2.3083360
	speed: 0.0602s/iter; left time: 2043.3972s
	iters: 400, epoch: 28 | loss: 2.2984126
	speed: 0.0669s/iter; left time: 2264.4826s
Epoch: 28 cost time: 29.717273712158203
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 5574154
model size : 40.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1796214
	speed: 0.0840s/iter; left time: 3932.8575s
	iters: 200, epoch: 1 | loss: 0.5750176
	speed: 0.0689s/iter; left time: 3216.5571s
	iters: 300, epoch: 1 | loss: 0.0933038
	speed: 0.0716s/iter; left time: 3335.1275s
	iters: 400, epoch: 1 | loss: 0.0192085
	speed: 0.0687s/iter; left time: 3193.1412s
Epoch: 1 cost time: 34.21332049369812
Epoch: 1, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (inf --> -0.949398).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0151333
	speed: 0.2746s/iter; left time: 12723.6341s
	iters: 200, epoch: 2 | loss: 0.0928157
	speed: 0.0693s/iter; left time: 3205.6950s
	iters: 300, epoch: 2 | loss: 0.0317561
	speed: 0.0645s/iter; left time: 2977.3074s
	iters: 400, epoch: 2 | loss: 0.2293831
	speed: 0.0653s/iter; left time: 3004.2567s
Epoch: 2 cost time: 31.16344904899597
Epoch: 2, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0212395
	speed: 0.2549s/iter; left time: 11692.5001s
	iters: 200, epoch: 3 | loss: 0.2036940
	speed: 0.0646s/iter; left time: 2957.4265s
	iters: 300, epoch: 3 | loss: 0.0254140
	speed: 0.0646s/iter; left time: 2951.3983s
	iters: 400, epoch: 3 | loss: 0.1344986
	speed: 0.0687s/iter; left time: 3128.0415s
Epoch: 3 cost time: 30.768897533416748
Epoch: 3, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.949398 --> -0.959403).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1637847
	speed: 0.2756s/iter; left time: 12510.8416s
	iters: 200, epoch: 4 | loss: 0.3751766
	speed: 0.0660s/iter; left time: 2991.1940s
	iters: 300, epoch: 4 | loss: 0.0768510
	speed: 0.0705s/iter; left time: 3188.0363s
	iters: 400, epoch: 4 | loss: 0.4830181
	speed: 0.0684s/iter; left time: 3086.2043s
Epoch: 4 cost time: 31.872334718704224
Epoch: 4, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0115622
	speed: 0.2824s/iter; left time: 12688.4996s
	iters: 200, epoch: 5 | loss: 0.0010492
	speed: 0.0687s/iter; left time: 3079.6256s
	iters: 300, epoch: 5 | loss: 0.0502829
	speed: 0.0682s/iter; left time: 3051.0946s
	iters: 400, epoch: 5 | loss: 0.3228190
	speed: 0.0682s/iter; left time: 3045.2059s
Epoch: 5 cost time: 32.2143497467041
Epoch: 5, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.429 Vali Acc: 0.905 Test Loss: 0.429 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0219616
	speed: 0.2601s/iter; left time: 11563.4584s
	iters: 200, epoch: 6 | loss: 0.0883677
	speed: 0.0658s/iter; left time: 2917.2994s
	iters: 300, epoch: 6 | loss: 0.1148023
	speed: 0.0663s/iter; left time: 2933.3762s
	iters: 400, epoch: 6 | loss: 0.1721777
	speed: 0.0689s/iter; left time: 3044.2120s
Epoch: 6 cost time: 31.36523151397705
Epoch: 6, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0020037
	speed: 0.2744s/iter; left time: 12070.3998s
	iters: 200, epoch: 7 | loss: 0.0001998
	speed: 0.0661s/iter; left time: 2899.8152s
	iters: 300, epoch: 7 | loss: 0.0002243
	speed: 0.0670s/iter; left time: 2935.0892s
	iters: 400, epoch: 7 | loss: 0.0790335
	speed: 0.0668s/iter; left time: 2916.6189s
Epoch: 7 cost time: 31.520100593566895
Epoch: 7, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.535 Vali Acc: 0.913 Test Loss: 0.535 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1988464
	speed: 0.2819s/iter; left time: 12267.8283s
	iters: 200, epoch: 8 | loss: 0.0441885
	speed: 0.0650s/iter; left time: 2822.2472s
	iters: 300, epoch: 8 | loss: 0.1161053
	speed: 0.0648s/iter; left time: 2805.3258s
	iters: 400, epoch: 8 | loss: 0.0015338
	speed: 0.0668s/iter; left time: 2885.4241s
Epoch: 8 cost time: 30.713605165481567
Epoch: 8, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.321 Vali Acc: 0.938 Test Loss: 0.321 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0424718
	speed: 0.2435s/iter; left time: 10483.4890s
	iters: 200, epoch: 9 | loss: 0.0001703
	speed: 0.0590s/iter; left time: 2535.9747s
	iters: 300, epoch: 9 | loss: 0.9305619
	speed: 0.0660s/iter; left time: 2829.6867s
	iters: 400, epoch: 9 | loss: 0.0048258
	speed: 0.0694s/iter; left time: 2965.9348s
Epoch: 9 cost time: 30.393043279647827
Epoch: 9, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2611766
	speed: 0.2804s/iter; left time: 11940.8714s
	iters: 200, epoch: 10 | loss: 0.1519042
	speed: 0.0630s/iter; left time: 2674.9420s
	iters: 300, epoch: 10 | loss: 0.0684829
	speed: 0.0672s/iter; left time: 2847.1519s
	iters: 400, epoch: 10 | loss: 0.0855025
	speed: 0.0674s/iter; left time: 2848.6704s
Epoch: 10 cost time: 30.961299896240234
Epoch: 10, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.325 Vali Acc: 0.942 Test Loss: 0.325 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2988302
	speed: 0.2777s/iter; left time: 11694.1347s
	iters: 200, epoch: 11 | loss: 0.3456286
	speed: 0.0630s/iter; left time: 2646.0582s
	iters: 300, epoch: 11 | loss: 0.0326660
	speed: 0.0653s/iter; left time: 2738.1035s
	iters: 400, epoch: 11 | loss: 0.0000600
	speed: 0.0667s/iter; left time: 2786.9055s
Epoch: 11 cost time: 30.505677700042725
Epoch: 11, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.959403 --> -0.973698).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0467754
	speed: 0.2564s/iter; left time: 10675.7080s
	iters: 200, epoch: 12 | loss: 0.0696499
	speed: 0.0604s/iter; left time: 2507.6725s
	iters: 300, epoch: 12 | loss: 0.4158558
	speed: 0.0626s/iter; left time: 2594.0528s
	iters: 400, epoch: 12 | loss: 0.0000027
	speed: 0.0622s/iter; left time: 2570.9846s
Epoch: 12 cost time: 28.446309328079224
Epoch: 12, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0021013
	speed: 0.2610s/iter; left time: 10745.5849s
	iters: 200, epoch: 13 | loss: 0.0530744
	speed: 0.0661s/iter; left time: 2713.4538s
	iters: 300, epoch: 13 | loss: 0.0727060
	speed: 0.0666s/iter; left time: 2729.7821s
	iters: 400, epoch: 13 | loss: 0.0028651
	speed: 0.0646s/iter; left time: 2642.0576s
Epoch: 13 cost time: 30.977339029312134
Epoch: 13, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7134692
	speed: 0.2814s/iter; left time: 11454.3825s
	iters: 200, epoch: 14 | loss: 1.3939990
	speed: 0.0666s/iter; left time: 2703.4594s
	iters: 300, epoch: 14 | loss: 0.0186888
	speed: 0.0615s/iter; left time: 2491.3069s
	iters: 400, epoch: 14 | loss: 0.0000079
	speed: 0.0600s/iter; left time: 2424.4757s
Epoch: 14 cost time: 29.736254453659058
Epoch: 14, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0023717
	speed: 0.2398s/iter; left time: 9649.7572s
	iters: 200, epoch: 15 | loss: 0.0018668
	speed: 0.0646s/iter; left time: 2591.3814s
	iters: 300, epoch: 15 | loss: 0.0000480
	speed: 0.0674s/iter; left time: 2697.7054s
	iters: 400, epoch: 15 | loss: 0.0004275
	speed: 0.0632s/iter; left time: 2524.7874s
Epoch: 15 cost time: 30.43080496788025
Epoch: 15, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1251682
	speed: 0.2714s/iter; left time: 10793.4341s
	iters: 200, epoch: 16 | loss: 0.2001776
	speed: 0.0662s/iter; left time: 2624.2670s
	iters: 300, epoch: 16 | loss: 0.0080408
	speed: 0.0675s/iter; left time: 2672.4702s
	iters: 400, epoch: 16 | loss: 0.7225715
	speed: 0.0649s/iter; left time: 2560.3246s
Epoch: 16 cost time: 31.299277544021606
Epoch: 16, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0045843
	speed: 0.2777s/iter; left time: 10911.7748s
	iters: 200, epoch: 17 | loss: 0.0362355
	speed: 0.0702s/iter; left time: 2751.6043s
	iters: 300, epoch: 17 | loss: 0.0288863
	speed: 0.0689s/iter; left time: 2692.2748s
	iters: 400, epoch: 17 | loss: 0.0010240
	speed: 0.0634s/iter; left time: 2471.4663s
Epoch: 17 cost time: 31.940542221069336
Epoch: 17, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0088358
	speed: 0.2459s/iter; left time: 9548.2699s
	iters: 200, epoch: 18 | loss: 0.0056955
	speed: 0.0642s/iter; left time: 2488.1821s
	iters: 300, epoch: 18 | loss: 0.0007582
	speed: 0.0642s/iter; left time: 2481.6815s
	iters: 400, epoch: 18 | loss: 0.0071629
	speed: 0.0644s/iter; left time: 2483.0168s
Epoch: 18 cost time: 30.145781755447388
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.319 Vali Acc: 0.955 Test Loss: 0.319 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1503185
	speed: 0.2631s/iter; left time: 10091.1565s
	iters: 200, epoch: 19 | loss: 0.1244379
	speed: 0.0695s/iter; left time: 2657.7044s
	iters: 300, epoch: 19 | loss: 0.2404049
	speed: 0.0694s/iter; left time: 2647.1054s
	iters: 400, epoch: 19 | loss: 0.1425530
	speed: 0.0690s/iter; left time: 2627.3231s
Epoch: 19 cost time: 31.886085987091064
Epoch: 19, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0004857
	speed: 0.2653s/iter; left time: 10052.6899s
	iters: 200, epoch: 20 | loss: 0.0082119
	speed: 0.0715s/iter; left time: 2701.4775s
	iters: 300, epoch: 20 | loss: 0.0015282
	speed: 0.0701s/iter; left time: 2643.0035s
	iters: 400, epoch: 20 | loss: 0.0343454
	speed: 0.0660s/iter; left time: 2480.2900s
Epoch: 20 cost time: 32.33249378204346
Epoch: 20, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2710572
	speed: 0.2429s/iter; left time: 9091.2540s
	iters: 200, epoch: 21 | loss: 0.0401773
	speed: 0.0636s/iter; left time: 2372.8059s
	iters: 300, epoch: 21 | loss: 0.0110590
	speed: 0.0648s/iter; left time: 2411.5915s
	iters: 400, epoch: 21 | loss: 0.0010143
	speed: 0.0694s/iter; left time: 2578.0088s
Epoch: 21 cost time: 30.759032487869263
Epoch: 21, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.297 Vali Acc: 0.943 Test Loss: 0.297 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 5180938
model size : 39.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2045944
	speed: 0.0831s/iter; left time: 3890.1721s
	iters: 200, epoch: 1 | loss: 0.5106093
	speed: 0.0692s/iter; left time: 3233.8358s
	iters: 300, epoch: 1 | loss: 0.2837907
	speed: 0.0657s/iter; left time: 3059.5848s
	iters: 400, epoch: 1 | loss: 0.0244058
	speed: 0.0657s/iter; left time: 3052.8645s
Epoch: 1 cost time: 33.014514446258545
Epoch: 1, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.198 Vali Acc: 0.934 Test Loss: 0.198 Test Acc: 0.934
Validation loss decreased (inf --> -0.933674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0089151
	speed: 0.2942s/iter; left time: 13631.8522s
	iters: 200, epoch: 2 | loss: 0.0682015
	speed: 0.0622s/iter; left time: 2874.3443s
	iters: 300, epoch: 2 | loss: 0.0789576
	speed: 0.0615s/iter; left time: 2835.2510s
	iters: 400, epoch: 2 | loss: 0.9929971
	speed: 0.0575s/iter; left time: 2648.7550s
Epoch: 2 cost time: 29.363306045532227
Epoch: 2, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.227 Vali Acc: 0.939 Test Loss: 0.227 Test Acc: 0.939
Validation loss decreased (-0.933674 --> -0.939392).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0493369
	speed: 0.2639s/iter; left time: 12103.4994s
	iters: 200, epoch: 3 | loss: 0.4037671
	speed: 0.0655s/iter; left time: 2998.7344s
	iters: 300, epoch: 3 | loss: 0.1391227
	speed: 0.0638s/iter; left time: 2914.5296s
	iters: 400, epoch: 3 | loss: 0.1550851
	speed: 0.0611s/iter; left time: 2784.3575s
Epoch: 3 cost time: 30.051764488220215
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.939392 --> -0.967409).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0240443
	speed: 0.2845s/iter; left time: 12914.8675s
	iters: 200, epoch: 4 | loss: 0.0012550
	speed: 0.0671s/iter; left time: 3038.7093s
	iters: 300, epoch: 4 | loss: 0.0951110
	speed: 0.0636s/iter; left time: 2873.8099s
	iters: 400, epoch: 4 | loss: 0.3385014
	speed: 0.0612s/iter; left time: 2757.9945s
Epoch: 4 cost time: 30.647057056427002
Epoch: 4, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4699381
	speed: 0.2844s/iter; left time: 12775.9483s
	iters: 200, epoch: 5 | loss: 0.0005304
	speed: 0.0644s/iter; left time: 2887.4533s
	iters: 300, epoch: 5 | loss: 0.0027634
	speed: 0.0596s/iter; left time: 2664.8096s
	iters: 400, epoch: 5 | loss: 0.4440984
	speed: 0.0593s/iter; left time: 2646.2372s
Epoch: 5 cost time: 29.51260209083557
Epoch: 5, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.759 Vali Acc: 0.871 Test Loss: 0.759 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0619983
	speed: 0.2546s/iter; left time: 11318.5540s
	iters: 200, epoch: 6 | loss: 0.0971136
	speed: 0.0690s/iter; left time: 3061.1027s
	iters: 300, epoch: 6 | loss: 0.1639866
	speed: 0.0652s/iter; left time: 2883.5468s
	iters: 400, epoch: 6 | loss: 0.1999857
	speed: 0.0621s/iter; left time: 2742.9331s
Epoch: 6 cost time: 30.733078956604004
Epoch: 6, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.322 Vali Acc: 0.919 Test Loss: 0.322 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1596172
	speed: 0.2880s/iter; left time: 12667.1781s
	iters: 200, epoch: 7 | loss: 0.2147137
	speed: 0.0685s/iter; left time: 3008.1898s
	iters: 300, epoch: 7 | loss: 0.0598045
	speed: 0.0671s/iter; left time: 2937.2328s
	iters: 400, epoch: 7 | loss: 0.3033115
	speed: 0.0633s/iter; left time: 2766.6343s
Epoch: 7 cost time: 31.94475746154785
Epoch: 7, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0935893
	speed: 0.2902s/iter; left time: 12630.4380s
	iters: 200, epoch: 8 | loss: 0.0198939
	speed: 0.0636s/iter; left time: 2762.8307s
	iters: 300, epoch: 8 | loss: 0.1015694
	speed: 0.0633s/iter; left time: 2740.2651s
	iters: 400, epoch: 8 | loss: 0.0157072
	speed: 0.0612s/iter; left time: 2646.0661s
Epoch: 8 cost time: 30.132192134857178
Epoch: 8, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0073694
	speed: 0.2384s/iter; left time: 10261.9156s
	iters: 200, epoch: 9 | loss: 0.0003225
	speed: 0.0664s/iter; left time: 2852.5786s
	iters: 300, epoch: 9 | loss: 0.8035440
	speed: 0.0532s/iter; left time: 2281.4323s
	iters: 400, epoch: 9 | loss: 0.6326196
	speed: 0.0527s/iter; left time: 2253.8838s
Epoch: 9 cost time: 26.898679494857788
Epoch: 9, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.306 Vali Acc: 0.932 Test Loss: 0.306 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0014536
	speed: 0.2581s/iter; left time: 10990.3190s
	iters: 200, epoch: 10 | loss: 0.0268152
	speed: 0.0709s/iter; left time: 3013.7577s
	iters: 300, epoch: 10 | loss: 0.0015976
	speed: 0.0644s/iter; left time: 2727.7174s
	iters: 400, epoch: 10 | loss: 0.6481803
	speed: 0.0631s/iter; left time: 2667.1774s
Epoch: 10 cost time: 31.62883448600769
Epoch: 10, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.255 Vali Acc: 0.961 Test Loss: 0.255 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0049780
	speed: 0.2845s/iter; left time: 11979.0047s
	iters: 200, epoch: 11 | loss: 0.0156381
	speed: 0.0661s/iter; left time: 2776.5355s
	iters: 300, epoch: 11 | loss: 0.0001913
	speed: 0.0613s/iter; left time: 2568.9191s
	iters: 400, epoch: 11 | loss: 0.0092743
	speed: 0.0615s/iter; left time: 2570.4601s
Epoch: 11 cost time: 30.146824836730957
Epoch: 11, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3307969
	speed: 0.2676s/iter; left time: 11142.1777s
	iters: 200, epoch: 12 | loss: 0.0001648
	speed: 0.0698s/iter; left time: 2899.3510s
	iters: 300, epoch: 12 | loss: 0.5005420
	speed: 0.0681s/iter; left time: 2824.1670s
	iters: 400, epoch: 12 | loss: 0.0069482
	speed: 0.0681s/iter; left time: 2814.2979s
Epoch: 12 cost time: 32.33686542510986
Epoch: 12, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0407212
	speed: 0.2899s/iter; left time: 11935.9300s
	iters: 200, epoch: 13 | loss: 0.0032985
	speed: 0.0685s/iter; left time: 2811.8339s
	iters: 300, epoch: 13 | loss: 0.0021419
	speed: 0.0601s/iter; left time: 2461.4879s
	iters: 400, epoch: 13 | loss: 0.0509254
	speed: 0.0627s/iter; left time: 2561.9243s
Epoch: 13 cost time: 31.005613803863525
Epoch: 13, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.275 Vali Acc: 0.934 Test Loss: 0.275 Test Acc: 0.934
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.967409948542024
model parameter : 5180938
model size : 39.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2122004
	speed: 0.0779s/iter; left time: 3647.6215s
	iters: 200, epoch: 1 | loss: 0.7153355
	speed: 0.0648s/iter; left time: 3024.8350s
	iters: 300, epoch: 1 | loss: 0.1533617
	speed: 0.0647s/iter; left time: 3013.6658s
	iters: 400, epoch: 1 | loss: 0.0201508
	speed: 0.0655s/iter; left time: 3046.6036s
Epoch: 1 cost time: 31.83192539215088
Epoch: 1, Steps: 469 | Train Loss: 0.331 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (inf --> -0.941393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1216073
	speed: 0.2647s/iter; left time: 12265.5780s
	iters: 200, epoch: 2 | loss: 0.1024501
	speed: 0.0642s/iter; left time: 2966.8697s
	iters: 300, epoch: 2 | loss: 0.0444473
	speed: 0.0675s/iter; left time: 3114.7976s
	iters: 400, epoch: 2 | loss: 0.1111498
	speed: 0.0671s/iter; left time: 3086.5722s
Epoch: 2 cost time: 31.49054741859436
Epoch: 2, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
Validation loss decreased (-0.941393 --> -0.943394).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0110483
	speed: 0.2886s/iter; left time: 13235.7972s
	iters: 200, epoch: 3 | loss: 0.0730294
	speed: 0.0673s/iter; left time: 3078.4809s
	iters: 300, epoch: 3 | loss: 0.1507120
	speed: 0.0692s/iter; left time: 3161.7362s
	iters: 400, epoch: 3 | loss: 0.2509499
	speed: 0.0660s/iter; left time: 3006.2950s
Epoch: 3 cost time: 32.156797885894775
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.943394 --> -0.947682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1710575
	speed: 0.2573s/iter; left time: 11679.6580s
	iters: 200, epoch: 4 | loss: 0.2355437
	speed: 0.0635s/iter; left time: 2875.4190s
	iters: 300, epoch: 4 | loss: 0.0427497
	speed: 0.0665s/iter; left time: 3005.7313s
	iters: 400, epoch: 4 | loss: 0.5740242
	speed: 0.0650s/iter; left time: 2929.3643s
Epoch: 4 cost time: 30.830580949783325
Epoch: 4, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.947682 --> -0.952828).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0144000
	speed: 0.2782s/iter; left time: 12497.8052s
	iters: 200, epoch: 5 | loss: 0.0139880
	speed: 0.0701s/iter; left time: 3141.3379s
	iters: 300, epoch: 5 | loss: 0.0225643
	speed: 0.0695s/iter; left time: 3109.7430s
	iters: 400, epoch: 5 | loss: 0.1713273
	speed: 0.0715s/iter; left time: 3192.5597s
Epoch: 5 cost time: 32.84709405899048
Epoch: 5, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.407 Vali Acc: 0.916 Test Loss: 0.407 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0628305
	speed: 0.2648s/iter; left time: 11773.0031s
	iters: 200, epoch: 6 | loss: 0.6218424
	speed: 0.0689s/iter; left time: 3055.1867s
	iters: 300, epoch: 6 | loss: 0.0098278
	speed: 0.0712s/iter; left time: 3152.0472s
	iters: 400, epoch: 6 | loss: 0.0749639
	speed: 0.0696s/iter; left time: 3072.7406s
Epoch: 6 cost time: 32.87275290489197
Epoch: 6, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0479336
	speed: 0.2635s/iter; left time: 11590.0356s
	iters: 200, epoch: 7 | loss: 0.0077388
	speed: 0.0639s/iter; left time: 2806.0118s
	iters: 300, epoch: 7 | loss: 0.0059721
	speed: 0.0658s/iter; left time: 2881.9731s
	iters: 400, epoch: 7 | loss: 0.1420357
	speed: 0.0664s/iter; left time: 2899.4276s
Epoch: 7 cost time: 31.235732316970825
Epoch: 7, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.476 Vali Acc: 0.924 Test Loss: 0.476 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0389072
	speed: 0.2624s/iter; left time: 11419.5266s
	iters: 200, epoch: 8 | loss: 0.0522299
	speed: 0.0694s/iter; left time: 3013.0566s
	iters: 300, epoch: 8 | loss: 0.0682152
	speed: 0.0688s/iter; left time: 2980.6379s
	iters: 400, epoch: 8 | loss: 0.0349565
	speed: 0.0640s/iter; left time: 2763.8999s
Epoch: 8 cost time: 31.587342023849487
Epoch: 8, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.258 Vali Acc: 0.951 Test Loss: 0.258 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0055878
	speed: 0.2715s/iter; left time: 11686.5925s
	iters: 200, epoch: 9 | loss: 0.0005703
	speed: 0.0625s/iter; left time: 2685.4150s
	iters: 300, epoch: 9 | loss: 0.4591980
	speed: 0.0660s/iter; left time: 2828.1989s
	iters: 400, epoch: 9 | loss: 0.5220639
	speed: 0.0664s/iter; left time: 2838.8287s
Epoch: 9 cost time: 31.035396814346313
Epoch: 9, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
Validation loss decreased (-0.952828 --> -0.954543).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0048335
	speed: 0.2582s/iter; left time: 10994.6395s
	iters: 200, epoch: 10 | loss: 0.0302143
	speed: 0.0620s/iter; left time: 2634.5244s
	iters: 300, epoch: 10 | loss: 0.0378363
	speed: 0.0633s/iter; left time: 2684.3449s
	iters: 400, epoch: 10 | loss: 0.4059553
	speed: 0.0624s/iter; left time: 2637.2062s
Epoch: 10 cost time: 29.53268790245056
Epoch: 10, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
Validation loss decreased (-0.954543 --> -0.966836).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0615457
	speed: 0.2692s/iter; left time: 11335.6245s
	iters: 200, epoch: 11 | loss: 0.4334949
	speed: 0.0650s/iter; left time: 2732.6125s
	iters: 300, epoch: 11 | loss: 0.0009507
	speed: 0.0640s/iter; left time: 2680.4531s
	iters: 400, epoch: 11 | loss: 0.0057420
	speed: 0.0643s/iter; left time: 2688.2827s
Epoch: 11 cost time: 30.624909162521362
Epoch: 11, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.315 Vali Acc: 0.941 Test Loss: 0.315 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6758306
	speed: 0.2728s/iter; left time: 11361.8398s
	iters: 200, epoch: 12 | loss: 0.0064580
	speed: 0.0630s/iter; left time: 2616.9287s
	iters: 300, epoch: 12 | loss: 0.0070084
	speed: 0.0532s/iter; left time: 2206.0405s
	iters: 400, epoch: 12 | loss: 0.0000509
	speed: 0.0594s/iter; left time: 2454.2461s
Epoch: 12 cost time: 29.687427043914795
Epoch: 12, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1034768
	speed: 0.2733s/iter; left time: 11254.5231s
	iters: 200, epoch: 13 | loss: 0.1105568
	speed: 0.0584s/iter; left time: 2398.9526s
	iters: 300, epoch: 13 | loss: 0.1056143
	speed: 0.0583s/iter; left time: 2388.1563s
	iters: 400, epoch: 13 | loss: 0.1105812
	speed: 0.0606s/iter; left time: 2475.3923s
Epoch: 13 cost time: 28.710288763046265
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.965 Test Loss: 0.186 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0037277
	speed: 0.2868s/iter; left time: 11675.5293s
	iters: 200, epoch: 14 | loss: 0.2509817
	speed: 0.0633s/iter; left time: 2570.4165s
	iters: 300, epoch: 14 | loss: 0.0118937
	speed: 0.0615s/iter; left time: 2489.7616s
	iters: 400, epoch: 14 | loss: 0.0011194
	speed: 0.0627s/iter; left time: 2533.1020s
Epoch: 14 cost time: 30.192115306854248
Epoch: 14, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.954 Test Loss: 0.297 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0474315
	speed: 0.2788s/iter; left time: 11219.4848s
	iters: 200, epoch: 15 | loss: 0.0000779
	speed: 0.0649s/iter; left time: 2605.4354s
	iters: 300, epoch: 15 | loss: 0.0014722
	speed: 0.0630s/iter; left time: 2521.2799s
	iters: 400, epoch: 15 | loss: 0.0470466
	speed: 0.0652s/iter; left time: 2605.3419s
Epoch: 15 cost time: 30.80185866355896
Epoch: 15, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.364 Vali Acc: 0.934 Test Loss: 0.364 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0261582
	speed: 0.2688s/iter; left time: 10689.0084s
	iters: 200, epoch: 16 | loss: 0.0482474
	speed: 0.0615s/iter; left time: 2437.9806s
	iters: 300, epoch: 16 | loss: 0.0002693
	speed: 0.0600s/iter; left time: 2375.8926s
	iters: 400, epoch: 16 | loss: 0.0445215
	speed: 0.0624s/iter; left time: 2464.4947s
Epoch: 16 cost time: 28.98439908027649
Epoch: 16, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0560754
	speed: 0.2736s/iter; left time: 10753.4321s
	iters: 200, epoch: 17 | loss: 0.0065828
	speed: 0.0639s/iter; left time: 2504.0861s
	iters: 300, epoch: 17 | loss: 0.0005913
	speed: 0.0624s/iter; left time: 2438.3276s
	iters: 400, epoch: 17 | loss: 0.0071255
	speed: 0.0645s/iter; left time: 2514.4947s
Epoch: 17 cost time: 30.69492244720459
Epoch: 17, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.6975626
	speed: 0.2864s/iter; left time: 11121.7094s
	iters: 200, epoch: 18 | loss: 0.0000614
	speed: 0.0640s/iter; left time: 2476.8387s
	iters: 300, epoch: 18 | loss: 0.0043819
	speed: 0.0649s/iter; left time: 2507.6770s
	iters: 400, epoch: 18 | loss: 0.0007344
	speed: 0.0686s/iter; left time: 2642.5827s
Epoch: 18 cost time: 31.167012453079224
Epoch: 18, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1357906
	speed: 0.2598s/iter; left time: 9966.2764s
	iters: 200, epoch: 19 | loss: 0.0009122
	speed: 0.0583s/iter; left time: 2230.7918s
	iters: 300, epoch: 19 | loss: 0.0101982
	speed: 0.0610s/iter; left time: 2329.5129s
	iters: 400, epoch: 19 | loss: 0.0098355
	speed: 0.0633s/iter; left time: 2409.6282s
Epoch: 19 cost time: 28.84870195388794
Epoch: 19, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.384 Vali Acc: 0.952 Test Loss: 0.384 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0151492
	speed: 0.2795s/iter; left time: 10588.4126s
	iters: 200, epoch: 20 | loss: 0.4531574
	speed: 0.0654s/iter; left time: 2470.7214s
	iters: 300, epoch: 20 | loss: 0.0020042
	speed: 0.0615s/iter; left time: 2319.1915s
	iters: 400, epoch: 20 | loss: 0.0348185
	speed: 0.0666s/iter; left time: 2503.0900s
Epoch: 20 cost time: 30.6422176361084
Epoch: 20, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.308 Vali Acc: 0.962 Test Loss: 0.308 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 5180938
model size : 39.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3001106
	speed: 0.0793s/iter; left time: 3711.1381s
	iters: 200, epoch: 1 | loss: 2.3012927
	speed: 0.0712s/iter; left time: 3325.5969s
	iters: 300, epoch: 1 | loss: 2.3008530
	speed: 0.0638s/iter; left time: 2972.3449s
	iters: 400, epoch: 1 | loss: 2.3007641
	speed: 0.0626s/iter; left time: 2911.4184s
Epoch: 1 cost time: 32.066709995269775
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3050599
	speed: 0.2592s/iter; left time: 12010.6832s
	iters: 200, epoch: 2 | loss: 2.2980416
	speed: 0.0592s/iter; left time: 2736.1956s
	iters: 300, epoch: 2 | loss: 2.3088953
	speed: 0.0658s/iter; left time: 3037.3749s
	iters: 400, epoch: 2 | loss: 2.3003781
	speed: 0.0639s/iter; left time: 2943.4512s
Epoch: 2 cost time: 30.585842609405518
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2987819
	speed: 0.2720s/iter; left time: 12475.4754s
	iters: 200, epoch: 3 | loss: 2.2951961
	speed: 0.0680s/iter; left time: 3110.3182s
	iters: 300, epoch: 3 | loss: 2.3128796
	speed: 0.0660s/iter; left time: 3011.8389s
	iters: 400, epoch: 3 | loss: 2.2882047
	speed: 0.0650s/iter; left time: 2960.1086s
Epoch: 3 cost time: 31.58948302268982
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3057382
	speed: 0.2795s/iter; left time: 12689.1469s
	iters: 200, epoch: 4 | loss: 2.3020380
	speed: 0.0714s/iter; left time: 3232.7637s
	iters: 300, epoch: 4 | loss: 2.2946944
	speed: 0.0658s/iter; left time: 2972.0143s
	iters: 400, epoch: 4 | loss: 2.3000119
	speed: 0.0600s/iter; left time: 2706.8489s
Epoch: 4 cost time: 31.59888219833374
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2955117
	speed: 0.2744s/iter; left time: 12325.5020s
	iters: 200, epoch: 5 | loss: 2.3172805
	speed: 0.0721s/iter; left time: 3230.1715s
	iters: 300, epoch: 5 | loss: 2.3028274
	speed: 0.0635s/iter; left time: 2838.6686s
	iters: 400, epoch: 5 | loss: 2.3089890
	speed: 0.0635s/iter; left time: 2832.6127s
Epoch: 5 cost time: 31.40442395210266
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2992771
	speed: 0.2803s/iter; left time: 12459.8897s
	iters: 200, epoch: 6 | loss: 2.2900326
	speed: 0.0688s/iter; left time: 3052.6202s
	iters: 300, epoch: 6 | loss: 2.3100400
	speed: 0.0646s/iter; left time: 2858.4409s
	iters: 400, epoch: 6 | loss: 2.2986183
	speed: 0.0628s/iter; left time: 2772.7882s
Epoch: 6 cost time: 31.263335704803467
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2894757
	speed: 0.2884s/iter; left time: 12686.7772s
	iters: 200, epoch: 7 | loss: 2.2923238
	speed: 0.0667s/iter; left time: 2928.5667s
	iters: 300, epoch: 7 | loss: 2.3232090
	speed: 0.0634s/iter; left time: 2774.5429s
	iters: 400, epoch: 7 | loss: 2.3013020
	speed: 0.0601s/iter; left time: 2624.8718s
Epoch: 7 cost time: 30.748069524765015
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2924242
	speed: 0.2544s/iter; left time: 11070.3807s
	iters: 200, epoch: 8 | loss: 2.3057015
	speed: 0.0671s/iter; left time: 2911.1781s
	iters: 300, epoch: 8 | loss: 2.2816296
	speed: 0.0669s/iter; left time: 2899.5574s
	iters: 400, epoch: 8 | loss: 2.3097482
	speed: 0.0645s/iter; left time: 2787.3466s
Epoch: 8 cost time: 31.632733821868896
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3214672
	speed: 0.2924s/iter; left time: 12586.5479s
	iters: 200, epoch: 9 | loss: 2.3148372
	speed: 0.0670s/iter; left time: 2877.3564s
	iters: 300, epoch: 9 | loss: 2.2942805
	speed: 0.0631s/iter; left time: 2702.6081s
	iters: 400, epoch: 9 | loss: 2.2935319
	speed: 0.0649s/iter; left time: 2773.6565s
Epoch: 9 cost time: 31.3684344291687
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3148007
	speed: 0.2834s/iter; left time: 12068.5762s
	iters: 200, epoch: 10 | loss: 2.3200560
	speed: 0.0597s/iter; left time: 2537.6565s
	iters: 300, epoch: 10 | loss: 2.2968671
	speed: 0.0630s/iter; left time: 2670.0785s
	iters: 400, epoch: 10 | loss: 2.3084550
	speed: 0.0636s/iter; left time: 2687.4309s
Epoch: 10 cost time: 29.734644889831543
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2875924
	speed: 0.2632s/iter; left time: 11082.9681s
	iters: 200, epoch: 11 | loss: 2.3237700
	speed: 0.0691s/iter; left time: 2902.8654s
	iters: 300, epoch: 11 | loss: 2.2990983
	speed: 0.0668s/iter; left time: 2798.9306s
	iters: 400, epoch: 11 | loss: 2.3062711
	speed: 0.0679s/iter; left time: 2838.7738s
Epoch: 11 cost time: 31.561368942260742
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2908566
	speed: 0.2895s/iter; left time: 12055.9379s
	iters: 200, epoch: 12 | loss: 2.2946963
	speed: 0.0667s/iter; left time: 2769.6279s
	iters: 300, epoch: 12 | loss: 2.3106418
	speed: 0.0653s/iter; left time: 2707.1169s
	iters: 400, epoch: 12 | loss: 2.3039711
	speed: 0.0655s/iter; left time: 2709.1867s
Epoch: 12 cost time: 31.60184931755066
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.3141081
	speed: 0.2725s/iter; left time: 11218.3229s
	iters: 200, epoch: 13 | loss: 2.3051236
	speed: 0.0654s/iter; left time: 2684.3192s
	iters: 300, epoch: 13 | loss: 2.3186233
	speed: 0.0630s/iter; left time: 2580.8226s
	iters: 400, epoch: 13 | loss: 2.2905512
	speed: 0.0620s/iter; left time: 2533.5306s
Epoch: 13 cost time: 30.124408960342407
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3075991
	speed: 0.2740s/iter; left time: 11152.9844s
	iters: 200, epoch: 14 | loss: 2.2934253
	speed: 0.0674s/iter; left time: 2737.9220s
	iters: 300, epoch: 14 | loss: 2.3204103
	speed: 0.0702s/iter; left time: 2842.8584s
	iters: 400, epoch: 14 | loss: 2.2932112
	speed: 0.0694s/iter; left time: 2802.1531s
Epoch: 14 cost time: 32.507373094558716
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3079569
	speed: 0.2637s/iter; left time: 10609.5472s
	iters: 200, epoch: 15 | loss: 2.2895594
	speed: 0.0687s/iter; left time: 2755.8344s
	iters: 300, epoch: 15 | loss: 2.3229990
	speed: 0.0674s/iter; left time: 2698.5998s
	iters: 400, epoch: 15 | loss: 2.3009124
	speed: 0.0674s/iter; left time: 2692.0928s
Epoch: 15 cost time: 32.47158670425415
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3065405
	speed: 0.2680s/iter; left time: 10656.6201s
	iters: 200, epoch: 16 | loss: 2.3023806
	speed: 0.0645s/iter; left time: 2558.9840s
	iters: 300, epoch: 16 | loss: 2.2771444
	speed: 0.0650s/iter; left time: 2570.3349s
	iters: 400, epoch: 16 | loss: 2.3024130
	speed: 0.0665s/iter; left time: 2624.7725s
Epoch: 16 cost time: 30.914045572280884
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3072813
	speed: 0.2569s/iter; left time: 10094.4935s
	iters: 200, epoch: 17 | loss: 2.3073750
	speed: 0.0629s/iter; left time: 2467.2859s
	iters: 300, epoch: 17 | loss: 2.2903395
	speed: 0.0681s/iter; left time: 2660.8510s
	iters: 400, epoch: 17 | loss: 2.2912877
	speed: 0.0740s/iter; left time: 2884.3930s
Epoch: 17 cost time: 31.921952962875366
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.2984729
	speed: 0.2806s/iter; left time: 10893.9677s
	iters: 200, epoch: 18 | loss: 2.3014963
	speed: 0.0662s/iter; left time: 2562.8117s
	iters: 300, epoch: 18 | loss: 2.3003840
	speed: 0.0690s/iter; left time: 2664.9800s
	iters: 400, epoch: 18 | loss: 2.2812696
	speed: 0.0650s/iter; left time: 2504.1993s
Epoch: 18 cost time: 31.148868083953857
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.3133798
	speed: 0.2659s/iter; left time: 10200.9928s
	iters: 200, epoch: 19 | loss: 2.2985210
	speed: 0.0612s/iter; left time: 2340.4566s
	iters: 300, epoch: 19 | loss: 2.3120043
	speed: 0.0622s/iter; left time: 2374.4905s
	iters: 400, epoch: 19 | loss: 2.2979693
	speed: 0.0610s/iter; left time: 2321.6536s
Epoch: 19 cost time: 29.57244873046875
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.3034737
	speed: 0.2731s/iter; left time: 10348.5455s
	iters: 200, epoch: 20 | loss: 2.3035879
	speed: 0.0699s/iter; left time: 2640.5043s
	iters: 300, epoch: 20 | loss: 2.2826986
	speed: 0.0642s/iter; left time: 2420.8167s
	iters: 400, epoch: 20 | loss: 2.3042645
	speed: 0.0674s/iter; left time: 2534.1605s
Epoch: 20 cost time: 31.737347841262817
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.3166320
	speed: 0.2780s/iter; left time: 10403.3977s
	iters: 200, epoch: 21 | loss: 2.3198414
	speed: 0.0670s/iter; left time: 2501.4313s
	iters: 300, epoch: 21 | loss: 2.3053772
	speed: 0.0694s/iter; left time: 2583.2973s
	iters: 400, epoch: 21 | loss: 2.2923326
	speed: 0.0727s/iter; left time: 2697.1098s
Epoch: 21 cost time: 32.66428589820862
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.3081055
	speed: 0.2538s/iter; left time: 9377.9660s
	iters: 200, epoch: 22 | loss: 2.3046498
	speed: 0.0621s/iter; left time: 2287.6411s
	iters: 300, epoch: 22 | loss: 2.3087800
	speed: 0.0643s/iter; left time: 2363.9559s
	iters: 400, epoch: 22 | loss: 2.2914548
	speed: 0.0667s/iter; left time: 2443.3285s
Epoch: 22 cost time: 30.868683338165283
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.3048332
	speed: 0.2797s/iter; left time: 10204.6542s
	iters: 200, epoch: 23 | loss: 2.2993772
	speed: 0.0711s/iter; left time: 2587.4150s
	iters: 300, epoch: 23 | loss: 2.2969015
	speed: 0.0680s/iter; left time: 2466.3757s
	iters: 400, epoch: 23 | loss: 2.3034494
	speed: 0.0714s/iter; left time: 2583.3753s
Epoch: 23 cost time: 32.88677978515625
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 5180938
model size : 39.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1156233
	speed: 0.0811s/iter; left time: 3796.1455s
	iters: 200, epoch: 1 | loss: 0.1629444
	speed: 0.0666s/iter; left time: 3109.0278s
	iters: 300, epoch: 1 | loss: 0.0931639
	speed: 0.0645s/iter; left time: 3007.5673s
	iters: 400, epoch: 1 | loss: 0.1135460
	speed: 0.0635s/iter; left time: 2951.1921s
Epoch: 1 cost time: 32.14253830909729
Epoch: 1, Steps: 469 | Train Loss: 0.361 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (inf --> -0.963978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0085562
	speed: 0.2769s/iter; left time: 12828.5204s
	iters: 200, epoch: 2 | loss: 0.0101725
	speed: 0.0677s/iter; left time: 3130.6009s
	iters: 300, epoch: 2 | loss: 0.4071734
	speed: 0.0679s/iter; left time: 3131.0488s
	iters: 400, epoch: 2 | loss: 0.0347456
	speed: 0.0670s/iter; left time: 3081.9299s
Epoch: 2 cost time: 31.860085010528564
Epoch: 2, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0774792
	speed: 0.2785s/iter; left time: 12774.1517s
	iters: 200, epoch: 3 | loss: 0.0632256
	speed: 0.0680s/iter; left time: 3112.3614s
	iters: 300, epoch: 3 | loss: 0.0161006
	speed: 0.0686s/iter; left time: 3132.4753s
	iters: 400, epoch: 3 | loss: 0.1398603
	speed: 0.0685s/iter; left time: 3121.5065s
Epoch: 3 cost time: 32.22987222671509
Epoch: 3, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.281 Vali Acc: 0.954 Test Loss: 0.281 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0222172
	speed: 0.2546s/iter; left time: 11556.5347s
	iters: 200, epoch: 4 | loss: 0.0253901
	speed: 0.0673s/iter; left time: 3047.6562s
	iters: 300, epoch: 4 | loss: 0.0129111
	speed: 0.0671s/iter; left time: 3034.7063s
	iters: 400, epoch: 4 | loss: 0.0498936
	speed: 0.0685s/iter; left time: 3088.6925s
Epoch: 4 cost time: 31.636249780654907
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.244 Vali Acc: 0.947 Test Loss: 0.244 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2180416
	speed: 0.2569s/iter; left time: 11540.3130s
	iters: 200, epoch: 5 | loss: 0.0508758
	speed: 0.0716s/iter; left time: 3207.9878s
	iters: 300, epoch: 5 | loss: 0.1303841
	speed: 0.0726s/iter; left time: 3245.1237s
	iters: 400, epoch: 5 | loss: 0.0005462
	speed: 0.0711s/iter; left time: 3174.8880s
Epoch: 5 cost time: 33.46388220787048
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0029356
	speed: 0.2714s/iter; left time: 12063.7425s
	iters: 200, epoch: 6 | loss: 0.0053898
	speed: 0.0699s/iter; left time: 3100.1374s
	iters: 300, epoch: 6 | loss: 0.6357861
	speed: 0.0732s/iter; left time: 3241.2641s
	iters: 400, epoch: 6 | loss: 0.0028853
	speed: 0.0707s/iter; left time: 3122.7385s
Epoch: 6 cost time: 32.92168855667114
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1050900
	speed: 0.2683s/iter; left time: 11803.5523s
	iters: 200, epoch: 7 | loss: 0.0155353
	speed: 0.0706s/iter; left time: 3096.9430s
	iters: 300, epoch: 7 | loss: 0.0204349
	speed: 0.0661s/iter; left time: 2896.1863s
	iters: 400, epoch: 7 | loss: 0.0169965
	speed: 0.0644s/iter; left time: 2814.9616s
Epoch: 7 cost time: 31.49722981452942
Epoch: 7, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.2474556
	speed: 0.1994s/iter; left time: 8679.1597s
	iters: 200, epoch: 8 | loss: 0.0012861
	speed: 0.0527s/iter; left time: 2290.2618s
	iters: 300, epoch: 8 | loss: 0.0101355
	speed: 0.0553s/iter; left time: 2395.1859s
	iters: 400, epoch: 8 | loss: 0.0018377
	speed: 0.0539s/iter; left time: 2329.4261s
Epoch: 8 cost time: 25.8220157623291
Epoch: 8, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.963978 --> -0.974270).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0167172
	speed: 0.2632s/iter; left time: 11328.6767s
	iters: 200, epoch: 9 | loss: 0.0005606
	speed: 0.0699s/iter; left time: 3001.8645s
	iters: 300, epoch: 9 | loss: 0.0006670
	speed: 0.0724s/iter; left time: 3100.5721s
	iters: 400, epoch: 9 | loss: 0.0010110
	speed: 0.0712s/iter; left time: 3042.5321s
Epoch: 9 cost time: 33.27375769615173
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0164015
	speed: 0.2618s/iter; left time: 11147.3615s
	iters: 200, epoch: 10 | loss: 0.0003501
	speed: 0.0671s/iter; left time: 2848.8762s
	iters: 300, epoch: 10 | loss: 0.0005598
	speed: 0.0681s/iter; left time: 2888.0950s
	iters: 400, epoch: 10 | loss: 0.7664723
	speed: 0.0684s/iter; left time: 2889.8875s
Epoch: 10 cost time: 31.5568368434906
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004569
	speed: 0.2590s/iter; left time: 10905.9346s
	iters: 200, epoch: 11 | loss: 0.0041682
	speed: 0.0677s/iter; left time: 2845.6055s
	iters: 300, epoch: 11 | loss: 0.0006992
	speed: 0.0727s/iter; left time: 3048.7177s
	iters: 400, epoch: 11 | loss: 0.0018862
	speed: 0.0672s/iter; left time: 2809.2191s
Epoch: 11 cost time: 32.805516719818115
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0347678
	speed: 0.2768s/iter; left time: 11527.9853s
	iters: 200, epoch: 12 | loss: 0.0007730
	speed: 0.0695s/iter; left time: 2887.6787s
	iters: 300, epoch: 12 | loss: 0.0032246
	speed: 0.0732s/iter; left time: 3033.2866s
	iters: 400, epoch: 12 | loss: 0.0409770
	speed: 0.0717s/iter; left time: 2963.4649s
Epoch: 12 cost time: 33.68860411643982
Epoch: 12, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2456230
	speed: 0.2477s/iter; left time: 10199.8942s
	iters: 200, epoch: 13 | loss: 0.0142783
	speed: 0.0667s/iter; left time: 2738.5156s
	iters: 300, epoch: 13 | loss: 0.0034610
	speed: 0.0679s/iter; left time: 2780.4679s
	iters: 400, epoch: 13 | loss: 0.0002414
	speed: 0.0679s/iter; left time: 2777.0997s
Epoch: 13 cost time: 31.774307012557983
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0010293
	speed: 0.2540s/iter; left time: 10338.0978s
	iters: 200, epoch: 14 | loss: 0.3866448
	speed: 0.0586s/iter; left time: 2381.2898s
	iters: 300, epoch: 14 | loss: 0.0087303
	speed: 0.0653s/iter; left time: 2646.5711s
	iters: 400, epoch: 14 | loss: 0.2624309
	speed: 0.0662s/iter; left time: 2676.5706s
Epoch: 14 cost time: 30.317137002944946
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0146457
	speed: 0.2397s/iter; left time: 9643.1236s
	iters: 200, epoch: 15 | loss: 0.0956655
	speed: 0.0617s/iter; left time: 2475.1060s
	iters: 300, epoch: 15 | loss: 0.0001434
	speed: 0.0618s/iter; left time: 2473.1505s
	iters: 400, epoch: 15 | loss: 0.2053932
	speed: 0.0635s/iter; left time: 2535.3967s
Epoch: 15 cost time: 28.973711490631104
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.405 Vali Acc: 0.931 Test Loss: 0.405 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0031181
	speed: 0.2402s/iter; left time: 9550.5555s
	iters: 200, epoch: 16 | loss: 0.1358910
	speed: 0.0690s/iter; left time: 2736.0371s
	iters: 300, epoch: 16 | loss: 0.0811252
	speed: 0.0722s/iter; left time: 2858.6409s
	iters: 400, epoch: 16 | loss: 0.0021874
	speed: 0.0708s/iter; left time: 2794.4860s
Epoch: 16 cost time: 33.328200578689575
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0002549
	speed: 0.2731s/iter; left time: 10730.6787s
	iters: 200, epoch: 17 | loss: 0.0044826
	speed: 0.0689s/iter; left time: 2700.5704s
	iters: 300, epoch: 17 | loss: 0.0187926
	speed: 0.0701s/iter; left time: 2739.4084s
	iters: 400, epoch: 17 | loss: 0.0001698
	speed: 0.0710s/iter; left time: 2768.5732s
Epoch: 17 cost time: 32.58390760421753
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3550396
	speed: 0.2742s/iter; left time: 10646.6594s
	iters: 200, epoch: 18 | loss: 0.0003522
	speed: 0.0661s/iter; left time: 2558.5495s
	iters: 300, epoch: 18 | loss: 0.0017186
	speed: 0.0682s/iter; left time: 2632.7396s
	iters: 400, epoch: 18 | loss: 0.0001931
	speed: 0.0686s/iter; left time: 2642.1285s
Epoch: 18 cost time: 31.793806314468384
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 4359946
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2198894
	speed: 0.0852s/iter; left time: 3986.4627s
	iters: 200, epoch: 1 | loss: 0.1956310
	speed: 0.0674s/iter; left time: 3146.2923s
	iters: 300, epoch: 1 | loss: 0.1065028
	speed: 0.0670s/iter; left time: 3119.9599s
	iters: 400, epoch: 1 | loss: 0.1508898
	speed: 0.0642s/iter; left time: 2984.7582s
Epoch: 1 cost time: 32.83360981941223
Epoch: 1, Steps: 469 | Train Loss: 0.420 Vali Loss: 0.182 Vali Acc: 0.936 Test Loss: 0.182 Test Acc: 0.936
Validation loss decreased (inf --> -0.936247).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0111126
	speed: 0.2918s/iter; left time: 13520.9566s
	iters: 200, epoch: 2 | loss: 0.0142757
	speed: 0.0657s/iter; left time: 3038.8545s
	iters: 300, epoch: 2 | loss: 0.4698702
	speed: 0.0597s/iter; left time: 2756.3337s
	iters: 400, epoch: 2 | loss: 0.0858218
	speed: 0.0608s/iter; left time: 2800.3047s
Epoch: 2 cost time: 29.93886971473694
Epoch: 2, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.298 Vali Acc: 0.914 Test Loss: 0.298 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0999631
	speed: 0.2739s/iter; left time: 12562.1459s
	iters: 200, epoch: 3 | loss: 0.2277767
	speed: 0.0673s/iter; left time: 3080.8252s
	iters: 300, epoch: 3 | loss: 0.1638159
	speed: 0.0666s/iter; left time: 3040.7874s
	iters: 400, epoch: 3 | loss: 0.3560183
	speed: 0.0694s/iter; left time: 3159.9482s
Epoch: 3 cost time: 31.940967559814453
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
Validation loss decreased (-0.936247 --> -0.946825).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1891639
	speed: 0.2773s/iter; left time: 12588.4327s
	iters: 200, epoch: 4 | loss: 0.0695122
	speed: 0.0692s/iter; left time: 3135.6652s
	iters: 300, epoch: 4 | loss: 0.0048290
	speed: 0.0640s/iter; left time: 2892.6086s
	iters: 400, epoch: 4 | loss: 0.0158022
	speed: 0.0648s/iter; left time: 2922.4054s
Epoch: 4 cost time: 31.84590792655945
Epoch: 4, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0678087
	speed: 0.2886s/iter; left time: 12965.4067s
	iters: 200, epoch: 5 | loss: 0.0726374
	speed: 0.0634s/iter; left time: 2839.8309s
	iters: 300, epoch: 5 | loss: 0.0496669
	speed: 0.0648s/iter; left time: 2900.2470s
	iters: 400, epoch: 5 | loss: 0.0326665
	speed: 0.0597s/iter; left time: 2664.0037s
Epoch: 5 cost time: 29.893616199493408
Epoch: 5, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0490021
	speed: 0.2655s/iter; left time: 11804.3074s
	iters: 200, epoch: 6 | loss: 0.0020667
	speed: 0.0702s/iter; left time: 3111.5738s
	iters: 300, epoch: 6 | loss: 0.0303926
	speed: 0.0653s/iter; left time: 2891.1561s
	iters: 400, epoch: 6 | loss: 0.3090654
	speed: 0.0669s/iter; left time: 2954.4602s
Epoch: 6 cost time: 32.46451783180237
Epoch: 6, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.946825 --> -0.947682).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1794176
	speed: 0.2926s/iter; left time: 12871.1745s
	iters: 200, epoch: 7 | loss: 0.0012793
	speed: 0.0665s/iter; left time: 2917.7716s
	iters: 300, epoch: 7 | loss: 0.3165388
	speed: 0.0614s/iter; left time: 2689.2854s
	iters: 400, epoch: 7 | loss: 0.0017997
	speed: 0.0613s/iter; left time: 2679.1950s
Epoch: 7 cost time: 30.599315404891968
Epoch: 7, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.947682 --> -0.953114).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0250135
	speed: 0.2813s/iter; left time: 12242.1745s
	iters: 200, epoch: 8 | loss: 0.0059034
	speed: 0.0621s/iter; left time: 2695.9681s
	iters: 300, epoch: 8 | loss: 0.0496349
	speed: 0.0599s/iter; left time: 2596.8483s
	iters: 400, epoch: 8 | loss: 0.0003566
	speed: 0.0653s/iter; left time: 2822.3263s
Epoch: 8 cost time: 29.74586272239685
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0030590
	speed: 0.2826s/iter; left time: 12167.0581s
	iters: 200, epoch: 9 | loss: 0.0014922
	speed: 0.0624s/iter; left time: 2681.9629s
	iters: 300, epoch: 9 | loss: 0.0008101
	speed: 0.0594s/iter; left time: 2546.8566s
	iters: 400, epoch: 9 | loss: 0.0000291
	speed: 0.0661s/iter; left time: 2826.3659s
Epoch: 9 cost time: 30.099304676055908
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
Validation loss decreased (-0.953114 --> -0.966265).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0221084
	speed: 0.2899s/iter; left time: 12345.4126s
	iters: 200, epoch: 10 | loss: 0.0054426
	speed: 0.0640s/iter; left time: 2720.7423s
	iters: 300, epoch: 10 | loss: 0.0081760
	speed: 0.0659s/iter; left time: 2792.9241s
	iters: 400, epoch: 10 | loss: 0.6322051
	speed: 0.0659s/iter; left time: 2785.3751s
Epoch: 10 cost time: 31.168436527252197
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0005165
	speed: 0.2570s/iter; left time: 10820.6339s
	iters: 200, epoch: 11 | loss: 0.0016685
	speed: 0.0605s/iter; left time: 2541.9391s
	iters: 300, epoch: 11 | loss: 0.0029817
	speed: 0.0599s/iter; left time: 2508.4055s
	iters: 400, epoch: 11 | loss: 0.0073477
	speed: 0.0609s/iter; left time: 2546.4845s
Epoch: 11 cost time: 29.076910734176636
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2313178
	speed: 0.2793s/iter; left time: 11631.2008s
	iters: 200, epoch: 12 | loss: 0.0090164
	speed: 0.0648s/iter; left time: 2690.2217s
	iters: 300, epoch: 12 | loss: 0.0520115
	speed: 0.0672s/iter; left time: 2785.6913s
	iters: 400, epoch: 12 | loss: 0.1348132
	speed: 0.0657s/iter; left time: 2717.7893s
Epoch: 12 cost time: 30.971193075180054
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0074038
	speed: 0.2643s/iter; left time: 10881.2359s
	iters: 200, epoch: 13 | loss: 0.0048442
	speed: 0.0652s/iter; left time: 2677.1166s
	iters: 300, epoch: 13 | loss: 0.0031133
	speed: 0.0669s/iter; left time: 2740.1543s
	iters: 400, epoch: 13 | loss: 0.0003085
	speed: 0.0603s/iter; left time: 2465.3920s
Epoch: 13 cost time: 30.483089447021484
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0702994
	speed: 0.2599s/iter; left time: 10580.8554s
	iters: 200, epoch: 14 | loss: 0.6387388
	speed: 0.0623s/iter; left time: 2529.4831s
	iters: 300, epoch: 14 | loss: 0.0214730
	speed: 0.0607s/iter; left time: 2460.1713s
	iters: 400, epoch: 14 | loss: 0.1475948
	speed: 0.0651s/iter; left time: 2629.4410s
Epoch: 14 cost time: 29.66519522666931
Epoch: 14, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.966265 --> -0.972555).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004101
	speed: 0.2772s/iter; left time: 11153.2641s
	iters: 200, epoch: 15 | loss: 0.0004572
	speed: 0.0642s/iter; left time: 2577.8226s
	iters: 300, epoch: 15 | loss: 0.0095089
	speed: 0.0673s/iter; left time: 2696.2036s
	iters: 400, epoch: 15 | loss: 0.0033872
	speed: 0.0681s/iter; left time: 2718.3190s
Epoch: 15 cost time: 31.326865434646606
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0320554
	speed: 0.2776s/iter; left time: 11040.0877s
	iters: 200, epoch: 16 | loss: 0.0116080
	speed: 0.0615s/iter; left time: 2440.4436s
	iters: 300, epoch: 16 | loss: 0.0366024
	speed: 0.0638s/iter; left time: 2524.3831s
	iters: 400, epoch: 16 | loss: 0.0068692
	speed: 0.0587s/iter; left time: 2315.5650s
Epoch: 16 cost time: 29.57350254058838
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0034183
	speed: 0.2587s/iter; left time: 10167.8371s
	iters: 200, epoch: 17 | loss: 0.0022560
	speed: 0.0613s/iter; left time: 2402.0097s
	iters: 300, epoch: 17 | loss: 0.0499861
	speed: 0.0681s/iter; left time: 2660.8431s
	iters: 400, epoch: 17 | loss: 0.0008132
	speed: 0.0688s/iter; left time: 2681.2400s
Epoch: 17 cost time: 31.09848141670227
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.8257430
	speed: 0.2718s/iter; left time: 10553.8723s
	iters: 200, epoch: 18 | loss: 0.0084891
	speed: 0.0603s/iter; left time: 2335.1269s
	iters: 300, epoch: 18 | loss: 0.0166951
	speed: 0.0690s/iter; left time: 2667.0571s
	iters: 400, epoch: 18 | loss: 0.0440565
	speed: 0.0682s/iter; left time: 2628.1694s
Epoch: 18 cost time: 31.211071968078613
Epoch: 18, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0008051
	speed: 0.2797s/iter; left time: 10728.9209s
	iters: 200, epoch: 19 | loss: 0.0611031
	speed: 0.0634s/iter; left time: 2426.9884s
	iters: 300, epoch: 19 | loss: 0.0592290
	speed: 0.0620s/iter; left time: 2364.6744s
	iters: 400, epoch: 19 | loss: 0.0088328
	speed: 0.0591s/iter; left time: 2248.1663s
Epoch: 19 cost time: 29.048816680908203
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0010056
	speed: 0.2461s/iter; left time: 9324.6758s
	iters: 200, epoch: 20 | loss: 0.0037999
	speed: 0.0648s/iter; left time: 2447.4995s
	iters: 300, epoch: 20 | loss: 0.0142639
	speed: 0.0674s/iter; left time: 2541.5528s
	iters: 400, epoch: 20 | loss: 0.0022042
	speed: 0.0644s/iter; left time: 2422.0691s
Epoch: 20 cost time: 30.87735629081726
Epoch: 20, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001819
	speed: 0.2873s/iter; left time: 10749.1955s
	iters: 200, epoch: 21 | loss: 0.0098605
	speed: 0.0681s/iter; left time: 2542.4752s
	iters: 300, epoch: 21 | loss: 0.0002549
	speed: 0.0664s/iter; left time: 2470.0306s
	iters: 400, epoch: 21 | loss: 0.0086914
	speed: 0.0612s/iter; left time: 2272.2666s
Epoch: 21 cost time: 31.07683491706848
Epoch: 21, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0007138
	speed: 0.2729s/iter; left time: 10084.0866s
	iters: 200, epoch: 22 | loss: 0.0000630
	speed: 0.0622s/iter; left time: 2292.8611s
	iters: 300, epoch: 22 | loss: 0.0219815
	speed: 0.0636s/iter; left time: 2336.0745s
	iters: 400, epoch: 22 | loss: 0.0011540
	speed: 0.0668s/iter; left time: 2448.0660s
Epoch: 22 cost time: 30.835002899169922
Epoch: 22, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.945 Test Loss: 0.239 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0397042
	speed: 0.2705s/iter; left time: 9869.2125s
	iters: 200, epoch: 23 | loss: 0.0052917
	speed: 0.0626s/iter; left time: 2279.0855s
	iters: 300, epoch: 23 | loss: 0.0872298
	speed: 0.0635s/iter; left time: 2304.8588s
	iters: 400, epoch: 23 | loss: 0.0006610
	speed: 0.0631s/iter; left time: 2283.0141s
Epoch: 23 cost time: 30.966329336166382
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.972555 --> -0.979416).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0323443
	speed: 0.2870s/iter; left time: 10335.6631s
	iters: 200, epoch: 24 | loss: 0.0060699
	speed: 0.0589s/iter; left time: 2114.1024s
	iters: 300, epoch: 24 | loss: 0.0017282
	speed: 0.0622s/iter; left time: 2225.8923s
	iters: 400, epoch: 24 | loss: 0.0002424
	speed: 0.0665s/iter; left time: 2373.8078s
Epoch: 24 cost time: 30.31814742088318
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0016467
	speed: 0.2826s/iter; left time: 10046.2685s
	iters: 200, epoch: 25 | loss: 0.1777932
	speed: 0.0602s/iter; left time: 2132.7186s
	iters: 300, epoch: 25 | loss: 0.0380481
	speed: 0.0615s/iter; left time: 2174.4428s
	iters: 400, epoch: 25 | loss: 0.0029511
	speed: 0.0644s/iter; left time: 2269.3949s
Epoch: 25 cost time: 29.51457166671753
Epoch: 25, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002938
	speed: 0.2796s/iter; left time: 9807.0785s
	iters: 200, epoch: 26 | loss: 0.0071810
	speed: 0.0660s/iter; left time: 2308.2654s
	iters: 300, epoch: 26 | loss: 0.0009783
	speed: 0.0677s/iter; left time: 2361.3388s
	iters: 400, epoch: 26 | loss: 0.0324052
	speed: 0.0680s/iter; left time: 2364.7068s
Epoch: 26 cost time: 32.054368019104004
Epoch: 26, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1752400
	speed: 0.2692s/iter; left time: 9315.1904s
	iters: 200, epoch: 27 | loss: 0.0089430
	speed: 0.0599s/iter; left time: 2068.0819s
	iters: 300, epoch: 27 | loss: 0.0004848
	speed: 0.0535s/iter; left time: 1840.3824s
	iters: 400, epoch: 27 | loss: 0.0007507
	speed: 0.0533s/iter; left time: 1827.0224s
Epoch: 27 cost time: 27.00393843650818
Epoch: 27, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000413
	speed: 0.2441s/iter; left time: 8333.8530s
	iters: 200, epoch: 28 | loss: 0.0001930
	speed: 0.0624s/iter; left time: 2123.3928s
	iters: 300, epoch: 28 | loss: 0.0438411
	speed: 0.0613s/iter; left time: 2079.1758s
	iters: 400, epoch: 28 | loss: 0.0003651
	speed: 0.0630s/iter; left time: 2132.5175s
Epoch: 28 cost time: 29.761398792266846
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0003798
	speed: 0.2717s/iter; left time: 9147.4167s
	iters: 200, epoch: 29 | loss: 0.0084990
	speed: 0.0641s/iter; left time: 2151.7364s
	iters: 300, epoch: 29 | loss: 0.0211393
	speed: 0.0628s/iter; left time: 2102.8719s
	iters: 400, epoch: 29 | loss: 0.0343903
	speed: 0.0692s/iter; left time: 2307.5433s
Epoch: 29 cost time: 30.730035543441772
Epoch: 29, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0043729
	speed: 0.2654s/iter; left time: 8812.7125s
	iters: 200, epoch: 30 | loss: 0.0071680
	speed: 0.0618s/iter; left time: 2044.4837s
	iters: 300, epoch: 30 | loss: 0.0001347
	speed: 0.0635s/iter; left time: 2097.0380s
	iters: 400, epoch: 30 | loss: 0.0001055
	speed: 0.0667s/iter; left time: 2195.5440s
Epoch: 30 cost time: 30.696958541870117
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000352
	speed: 0.2574s/iter; left time: 8424.8534s
	iters: 200, epoch: 31 | loss: 0.0652616
	speed: 0.0588s/iter; left time: 1918.7518s
	iters: 300, epoch: 31 | loss: 0.0000462
	speed: 0.0594s/iter; left time: 1931.7434s
	iters: 400, epoch: 31 | loss: 0.0205319
	speed: 0.0619s/iter; left time: 2007.2112s
Epoch: 31 cost time: 29.17654252052307
Epoch: 31, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3524046
	speed: 0.2749s/iter; left time: 8869.1302s
	iters: 200, epoch: 32 | loss: 0.0011723
	speed: 0.0629s/iter; left time: 2021.8297s
	iters: 300, epoch: 32 | loss: 0.0001530
	speed: 0.0665s/iter; left time: 2132.0628s
	iters: 400, epoch: 32 | loss: 0.0007225
	speed: 0.0661s/iter; left time: 2111.4691s
Epoch: 32 cost time: 31.03455924987793
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.957 Test Loss: 0.228 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0054284
	speed: 0.2753s/iter; left time: 8752.5740s
	iters: 200, epoch: 33 | loss: 0.0016224
	speed: 0.0638s/iter; left time: 2020.8140s
	iters: 300, epoch: 33 | loss: 0.0000072
	speed: 0.0653s/iter; left time: 2064.5386s
	iters: 400, epoch: 33 | loss: 0.0005554
	speed: 0.0678s/iter; left time: 2134.9999s
Epoch: 33 cost time: 30.355546474456787
Epoch: 33, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 4359946
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1486672
	speed: 0.0782s/iter; left time: 3662.0844s
	iters: 200, epoch: 1 | loss: 0.1505727
	speed: 0.0590s/iter; left time: 2753.5225s
	iters: 300, epoch: 1 | loss: 0.0768411
	speed: 0.0558s/iter; left time: 2599.4299s
	iters: 400, epoch: 1 | loss: 0.1053424
	speed: 0.0635s/iter; left time: 2952.7191s
Epoch: 1 cost time: 29.683225393295288
Epoch: 1, Steps: 469 | Train Loss: 0.387 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
Validation loss decreased (inf --> -0.937391).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0053725
	speed: 0.2230s/iter; left time: 10334.3436s
	iters: 200, epoch: 2 | loss: 0.0436655
	speed: 0.0583s/iter; left time: 2694.0188s
	iters: 300, epoch: 2 | loss: 0.6109284
	speed: 0.0570s/iter; left time: 2628.3123s
	iters: 400, epoch: 2 | loss: 0.2081444
	speed: 0.0566s/iter; left time: 2604.1669s
Epoch: 2 cost time: 27.037132501602173
Epoch: 2, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.226 Vali Acc: 0.940 Test Loss: 0.226 Test Acc: 0.940
Validation loss decreased (-0.937391 --> -0.940249).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0413098
	speed: 0.2168s/iter; left time: 9945.0780s
	iters: 200, epoch: 3 | loss: 0.0174745
	speed: 0.0565s/iter; left time: 2585.2427s
	iters: 300, epoch: 3 | loss: 0.1265749
	speed: 0.0560s/iter; left time: 2558.1044s
	iters: 400, epoch: 3 | loss: 0.1282203
	speed: 0.0569s/iter; left time: 2594.4190s
Epoch: 3 cost time: 26.596805810928345
Epoch: 3, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
Validation loss decreased (-0.940249 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0132309
	speed: 0.2689s/iter; left time: 12207.2183s
	iters: 200, epoch: 4 | loss: 0.1276253
	speed: 0.0654s/iter; left time: 2960.5151s
	iters: 300, epoch: 4 | loss: 0.2231110
	speed: 0.0693s/iter; left time: 3133.0097s
	iters: 400, epoch: 4 | loss: 0.0278679
	speed: 0.0646s/iter; left time: 2912.5693s
Epoch: 4 cost time: 31.53983759880066
Epoch: 4, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.246 Vali Acc: 0.947 Test Loss: 0.246 Test Acc: 0.947
Validation loss decreased (-0.943394 --> -0.946538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0612646
	speed: 0.2776s/iter; left time: 12471.5566s
	iters: 200, epoch: 5 | loss: 0.0233169
	speed: 0.0665s/iter; left time: 2982.5618s
	iters: 300, epoch: 5 | loss: 0.1334278
	speed: 0.0622s/iter; left time: 2780.5678s
	iters: 400, epoch: 5 | loss: 0.0574862
	speed: 0.0674s/iter; left time: 3006.5984s
Epoch: 5 cost time: 31.117127895355225
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.946538 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0010753
	speed: 0.2667s/iter; left time: 11856.2791s
	iters: 200, epoch: 6 | loss: 0.0292210
	speed: 0.0646s/iter; left time: 2864.9559s
	iters: 300, epoch: 6 | loss: 0.0048168
	speed: 0.0655s/iter; left time: 2898.7695s
	iters: 400, epoch: 6 | loss: 0.0097702
	speed: 0.0622s/iter; left time: 2746.3729s
Epoch: 6 cost time: 30.4019033908844
Epoch: 6, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0233792
	speed: 0.2655s/iter; left time: 11678.7172s
	iters: 200, epoch: 7 | loss: 0.0071920
	speed: 0.0679s/iter; left time: 2979.1256s
	iters: 300, epoch: 7 | loss: 0.0272031
	speed: 0.0678s/iter; left time: 2966.9517s
	iters: 400, epoch: 7 | loss: 0.0011467
	speed: 0.0650s/iter; left time: 2840.3319s
Epoch: 7 cost time: 31.52833318710327
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0344281
	speed: 0.2521s/iter; left time: 10968.9329s
	iters: 200, epoch: 8 | loss: 0.0123517
	speed: 0.0692s/iter; left time: 3003.8387s
	iters: 300, epoch: 8 | loss: 0.0379311
	speed: 0.0684s/iter; left time: 2964.6983s
	iters: 400, epoch: 8 | loss: 0.0006494
	speed: 0.0663s/iter; left time: 2863.5805s
Epoch: 8 cost time: 32.054604291915894
Epoch: 8, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0121152
	speed: 0.2434s/iter; left time: 10477.1981s
	iters: 200, epoch: 9 | loss: 0.0005589
	speed: 0.0664s/iter; left time: 2849.6717s
	iters: 300, epoch: 9 | loss: 0.0001132
	speed: 0.0678s/iter; left time: 2903.3829s
	iters: 400, epoch: 9 | loss: 0.0004722
	speed: 0.0650s/iter; left time: 2779.1731s
Epoch: 9 cost time: 30.55059790611267
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0908324
	speed: 0.2680s/iter; left time: 11413.2005s
	iters: 200, epoch: 10 | loss: 0.1676757
	speed: 0.0614s/iter; left time: 2609.8511s
	iters: 300, epoch: 10 | loss: 0.0008452
	speed: 0.0709s/iter; left time: 3003.4953s
	iters: 400, epoch: 10 | loss: 0.8056197
	speed: 0.0689s/iter; left time: 2912.1220s
Epoch: 10 cost time: 31.641592979431152
Epoch: 10, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.927 Test Loss: 0.287 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0023742
	speed: 0.2727s/iter; left time: 11484.6626s
	iters: 200, epoch: 11 | loss: 0.0001319
	speed: 0.0683s/iter; left time: 2869.9945s
	iters: 300, epoch: 11 | loss: 0.0007933
	speed: 0.0648s/iter; left time: 2716.1582s
	iters: 400, epoch: 11 | loss: 0.0008726
	speed: 0.0645s/iter; left time: 2697.2532s
Epoch: 11 cost time: 30.772668838500977
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0191450
	speed: 0.1886s/iter; left time: 7854.2137s
	iters: 200, epoch: 12 | loss: 0.0021374
	speed: 0.0468s/iter; left time: 1944.7904s
	iters: 300, epoch: 12 | loss: 0.0035616
	speed: 0.0617s/iter; left time: 2558.8839s
	iters: 400, epoch: 12 | loss: 0.0694429
	speed: 0.0657s/iter; left time: 2714.6786s
Epoch: 12 cost time: 27.966360807418823
Epoch: 12, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0027661
	speed: 0.2609s/iter; left time: 10742.5380s
	iters: 200, epoch: 13 | loss: 0.1174249
	speed: 0.0628s/iter; left time: 2581.1049s
	iters: 300, epoch: 13 | loss: 0.0308355
	speed: 0.0676s/iter; left time: 2771.5397s
	iters: 400, epoch: 13 | loss: 0.0006608
	speed: 0.0691s/iter; left time: 2825.8284s
Epoch: 13 cost time: 30.47239661216736
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0023073
	speed: 0.2608s/iter; left time: 10614.4924s
	iters: 200, epoch: 14 | loss: 0.1968041
	speed: 0.0655s/iter; left time: 2659.5848s
	iters: 300, epoch: 14 | loss: 0.0195135
	speed: 0.0668s/iter; left time: 2706.2990s
	iters: 400, epoch: 14 | loss: 0.1195244
	speed: 0.0701s/iter; left time: 2833.1384s
Epoch: 14 cost time: 31.254600048065186
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976557).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0027127
	speed: 0.2587s/iter; left time: 10407.7124s
	iters: 200, epoch: 15 | loss: 0.0002832
	speed: 0.0610s/iter; left time: 2449.6782s
	iters: 300, epoch: 15 | loss: 0.0023246
	speed: 0.0633s/iter; left time: 2534.0333s
	iters: 400, epoch: 15 | loss: 0.0002285
	speed: 0.0630s/iter; left time: 2514.9351s
Epoch: 15 cost time: 29.20005178451538
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1934426
	speed: 0.2754s/iter; left time: 10950.7288s
	iters: 200, epoch: 16 | loss: 0.0448512
	speed: 0.0623s/iter; left time: 2472.6651s
	iters: 300, epoch: 16 | loss: 0.0009031
	speed: 0.0649s/iter; left time: 2569.5328s
	iters: 400, epoch: 16 | loss: 0.0571314
	speed: 0.0655s/iter; left time: 2585.8504s
Epoch: 16 cost time: 31.1248517036438
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0005579
	speed: 0.2804s/iter; left time: 11020.1310s
	iters: 200, epoch: 17 | loss: 0.0332560
	speed: 0.0606s/iter; left time: 2375.3288s
	iters: 300, epoch: 17 | loss: 0.0010781
	speed: 0.0628s/iter; left time: 2456.9852s
	iters: 400, epoch: 17 | loss: 0.0568974
	speed: 0.0676s/iter; left time: 2634.9819s
Epoch: 17 cost time: 30.473356008529663
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7168533
	speed: 0.2661s/iter; left time: 10332.8628s
	iters: 200, epoch: 18 | loss: 0.0072785
	speed: 0.0585s/iter; left time: 2264.6507s
	iters: 300, epoch: 18 | loss: 0.8240997
	speed: 0.0634s/iter; left time: 2450.8927s
	iters: 400, epoch: 18 | loss: 0.0000896
	speed: 0.0660s/iter; left time: 2544.4630s
Epoch: 18 cost time: 30.14462971687317
Epoch: 18, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0426753
	speed: 0.2780s/iter; left time: 10663.9673s
	iters: 200, epoch: 19 | loss: 0.2389774
	speed: 0.0625s/iter; left time: 2389.3529s
	iters: 300, epoch: 19 | loss: 0.0050374
	speed: 0.0676s/iter; left time: 2581.0463s
	iters: 400, epoch: 19 | loss: 0.0001864
	speed: 0.0694s/iter; left time: 2642.3314s
Epoch: 19 cost time: 30.89846658706665
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0020185
	speed: 0.2714s/iter; left time: 10282.4947s
	iters: 200, epoch: 20 | loss: 0.0000103
	speed: 0.0612s/iter; left time: 2314.1743s
	iters: 300, epoch: 20 | loss: 0.2030357
	speed: 0.0687s/iter; left time: 2589.3703s
	iters: 400, epoch: 20 | loss: 0.0001009
	speed: 0.0709s/iter; left time: 2663.8246s
Epoch: 20 cost time: 30.493190050125122
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.980274).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0010561
	speed: 0.2574s/iter; left time: 9631.6595s
	iters: 200, epoch: 21 | loss: 0.0017373
	speed: 0.0605s/iter; left time: 2257.2085s
	iters: 300, epoch: 21 | loss: 0.0105410
	speed: 0.0634s/iter; left time: 2358.8831s
	iters: 400, epoch: 21 | loss: 0.0004036
	speed: 0.0593s/iter; left time: 2200.6647s
Epoch: 21 cost time: 29.31245708465576
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.980274 --> -0.982846).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0083513
	speed: 0.2726s/iter; left time: 10073.5758s
	iters: 200, epoch: 22 | loss: 0.0000631
	speed: 0.0662s/iter; left time: 2438.6079s
	iters: 300, epoch: 22 | loss: 0.0012878
	speed: 0.0623s/iter; left time: 2289.6091s
	iters: 400, epoch: 22 | loss: 0.0167935
	speed: 0.0645s/iter; left time: 2364.0905s
Epoch: 22 cost time: 30.89995312690735
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0007708
	speed: 0.2730s/iter; left time: 9960.6891s
	iters: 200, epoch: 23 | loss: 0.0004411
	speed: 0.0634s/iter; left time: 2307.6045s
	iters: 300, epoch: 23 | loss: 0.0014094
	speed: 0.0612s/iter; left time: 2219.7160s
	iters: 400, epoch: 23 | loss: 0.5077955
	speed: 0.0623s/iter; left time: 2255.4008s
Epoch: 23 cost time: 30.032520055770874
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4707494
	speed: 0.2600s/iter; left time: 9363.2680s
	iters: 200, epoch: 24 | loss: 0.5002313
	speed: 0.0613s/iter; left time: 2201.8344s
	iters: 300, epoch: 24 | loss: 0.0601367
	speed: 0.0614s/iter; left time: 2200.6634s
	iters: 400, epoch: 24 | loss: 0.0104390
	speed: 0.0626s/iter; left time: 2235.0255s
Epoch: 24 cost time: 29.64935326576233
Epoch: 24, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0053004
	speed: 0.2936s/iter; left time: 10436.0997s
	iters: 200, epoch: 25 | loss: 0.3361251
	speed: 0.0643s/iter; left time: 2278.2581s
	iters: 300, epoch: 25 | loss: 0.0099947
	speed: 0.0624s/iter; left time: 2203.7676s
	iters: 400, epoch: 25 | loss: 0.0083920
	speed: 0.0605s/iter; left time: 2133.6251s
Epoch: 25 cost time: 29.96682906150818
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0001548
	speed: 0.1937s/iter; left time: 6794.9987s
	iters: 200, epoch: 26 | loss: 0.0002815
	speed: 0.0513s/iter; left time: 1795.0690s
	iters: 300, epoch: 26 | loss: 0.0020583
	speed: 0.0621s/iter; left time: 2164.5392s
	iters: 400, epoch: 26 | loss: 0.6092525
	speed: 0.0609s/iter; left time: 2117.4208s
Epoch: 26 cost time: 26.960713624954224
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1064566
	speed: 0.2565s/iter; left time: 8875.4836s
	iters: 200, epoch: 27 | loss: 0.0007755
	speed: 0.0637s/iter; left time: 2197.4726s
	iters: 300, epoch: 27 | loss: 0.0001139
	speed: 0.0585s/iter; left time: 2014.0897s
	iters: 400, epoch: 27 | loss: 0.0013016
	speed: 0.0635s/iter; left time: 2177.9578s
Epoch: 27 cost time: 29.24641180038452
Epoch: 27, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.1373474
	speed: 0.2609s/iter; left time: 8906.8601s
	iters: 200, epoch: 28 | loss: 0.0000597
	speed: 0.0675s/iter; left time: 2297.5123s
	iters: 300, epoch: 28 | loss: 0.0058103
	speed: 0.0621s/iter; left time: 2105.8709s
	iters: 400, epoch: 28 | loss: 0.0041979
	speed: 0.0611s/iter; left time: 2066.3317s
Epoch: 28 cost time: 30.681925535202026
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0025538
	speed: 0.2856s/iter; left time: 9614.2567s
	iters: 200, epoch: 29 | loss: 0.0001464
	speed: 0.0604s/iter; left time: 2027.5436s
	iters: 300, epoch: 29 | loss: 0.0007000
	speed: 0.0599s/iter; left time: 2003.6203s
	iters: 400, epoch: 29 | loss: 0.0033232
	speed: 0.0642s/iter; left time: 2143.3251s
Epoch: 29 cost time: 30.419950485229492
Epoch: 29, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0182090
	speed: 0.2616s/iter; left time: 8685.7727s
	iters: 200, epoch: 30 | loss: 0.0087031
	speed: 0.0625s/iter; left time: 2067.9106s
	iters: 300, epoch: 30 | loss: 0.0018177
	speed: 0.0621s/iter; left time: 2048.6825s
	iters: 400, epoch: 30 | loss: 0.0001196
	speed: 0.0639s/iter; left time: 2100.9096s
Epoch: 30 cost time: 29.736711740493774
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0002096
	speed: 0.2717s/iter; left time: 8893.8089s
	iters: 200, epoch: 31 | loss: 0.0006566
	speed: 0.0669s/iter; left time: 2182.3957s
	iters: 300, epoch: 31 | loss: 0.0005560
	speed: 0.0663s/iter; left time: 2155.9478s
	iters: 400, epoch: 31 | loss: 0.0316941
	speed: 0.0697s/iter; left time: 2260.0802s
Epoch: 31 cost time: 31.93412685394287
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 4359946
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3048646
	speed: 0.0796s/iter; left time: 3725.0037s
	iters: 200, epoch: 1 | loss: 2.2987163
	speed: 0.0693s/iter; left time: 3238.0670s
	iters: 300, epoch: 1 | loss: 2.2996156
	speed: 0.0652s/iter; left time: 3037.0298s
	iters: 400, epoch: 1 | loss: 2.3047895
	speed: 0.0656s/iter; left time: 3050.6530s
Epoch: 1 cost time: 32.306211948394775
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3053861
	speed: 0.2394s/iter; left time: 11090.1475s
	iters: 200, epoch: 2 | loss: 2.3041661
	speed: 0.0671s/iter; left time: 3102.5378s
	iters: 300, epoch: 2 | loss: 2.3059337
	speed: 0.0688s/iter; left time: 3173.9050s
	iters: 400, epoch: 2 | loss: 2.3063374
	speed: 0.0632s/iter; left time: 2908.3046s
Epoch: 2 cost time: 31.311794757843018
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2997828
	speed: 0.2684s/iter; left time: 12308.9919s
	iters: 200, epoch: 3 | loss: 2.2919879
	speed: 0.0703s/iter; left time: 3217.5442s
	iters: 300, epoch: 3 | loss: 2.2982402
	speed: 0.0634s/iter; left time: 2896.0086s
	iters: 400, epoch: 3 | loss: 2.3101912
	speed: 0.0602s/iter; left time: 2744.7464s
Epoch: 3 cost time: 31.527735710144043
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2994251
	speed: 0.2667s/iter; left time: 12107.1649s
	iters: 200, epoch: 4 | loss: 2.3042989
	speed: 0.0626s/iter; left time: 2835.6949s
	iters: 300, epoch: 4 | loss: 2.3011000
	speed: 0.0560s/iter; left time: 2532.5012s
	iters: 400, epoch: 4 | loss: 2.2955844
	speed: 0.0554s/iter; left time: 2500.2600s
Epoch: 4 cost time: 27.96420121192932
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2932577
	speed: 0.1795s/iter; left time: 8064.6607s
	iters: 200, epoch: 5 | loss: 2.3058081
	speed: 0.0605s/iter; left time: 2711.7354s
	iters: 300, epoch: 5 | loss: 2.2948809
	speed: 0.0658s/iter; left time: 2943.2750s
	iters: 400, epoch: 5 | loss: 2.3005543
	speed: 0.0688s/iter; left time: 3069.6940s
Epoch: 5 cost time: 29.951146125793457
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3042393
	speed: 0.2430s/iter; left time: 10804.0052s
	iters: 200, epoch: 6 | loss: 2.3130503
	speed: 0.0698s/iter; left time: 3097.7028s
	iters: 300, epoch: 6 | loss: 2.2907944
	speed: 0.0688s/iter; left time: 3046.5623s
	iters: 400, epoch: 6 | loss: 2.2959957
	speed: 0.0643s/iter; left time: 2838.5382s
Epoch: 6 cost time: 31.533236265182495
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2961180
	speed: 0.2538s/iter; left time: 11165.4306s
	iters: 200, epoch: 7 | loss: 2.3063290
	speed: 0.0693s/iter; left time: 3041.5107s
	iters: 300, epoch: 7 | loss: 2.2976608
	speed: 0.0654s/iter; left time: 2863.9428s
	iters: 400, epoch: 7 | loss: 2.2885509
	speed: 0.0642s/iter; left time: 2804.5935s
Epoch: 7 cost time: 30.92678952217102
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3047073
	speed: 0.2524s/iter; left time: 10984.0076s
	iters: 200, epoch: 8 | loss: 2.3086507
	speed: 0.0640s/iter; left time: 2778.0798s
	iters: 300, epoch: 8 | loss: 2.3170006
	speed: 0.0688s/iter; left time: 2980.7376s
	iters: 400, epoch: 8 | loss: 2.3003087
	speed: 0.0670s/iter; left time: 2894.1346s
Epoch: 8 cost time: 31.05073595046997
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2959332
	speed: 0.2548s/iter; left time: 10968.2509s
	iters: 200, epoch: 9 | loss: 2.3018925
	speed: 0.0622s/iter; left time: 2670.6998s
	iters: 300, epoch: 9 | loss: 2.3048887
	speed: 0.0725s/iter; left time: 3108.6686s
	iters: 400, epoch: 9 | loss: 2.2890480
	speed: 0.0645s/iter; left time: 2755.2360s
Epoch: 9 cost time: 31.110186100006104
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3084860
	speed: 0.2681s/iter; left time: 11417.7241s
	iters: 200, epoch: 10 | loss: 2.2850602
	speed: 0.0689s/iter; left time: 2926.9652s
	iters: 300, epoch: 10 | loss: 2.3003914
	speed: 0.0660s/iter; left time: 2795.3634s
	iters: 400, epoch: 10 | loss: 2.3029957
	speed: 0.0733s/iter; left time: 3098.9040s
Epoch: 10 cost time: 32.728026151657104
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3033204
	speed: 0.2505s/iter; left time: 10546.8488s
	iters: 200, epoch: 11 | loss: 2.3010910
	speed: 0.0639s/iter; left time: 2683.4332s
	iters: 300, epoch: 11 | loss: 2.2919478
	speed: 0.0673s/iter; left time: 2820.0674s
	iters: 400, epoch: 11 | loss: 2.2948217
	speed: 0.0628s/iter; left time: 2623.8907s
Epoch: 11 cost time: 30.03865957260132
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.2898850
	speed: 0.2465s/iter; left time: 10262.8451s
	iters: 200, epoch: 12 | loss: 2.3067551
	speed: 0.0703s/iter; left time: 2920.9712s
	iters: 300, epoch: 12 | loss: 2.3024700
	speed: 0.0688s/iter; left time: 2849.5845s
	iters: 400, epoch: 12 | loss: 2.3104548
	speed: 0.0658s/iter; left time: 2718.4100s
Epoch: 12 cost time: 31.90386462211609
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.2983003
	speed: 0.2686s/iter; left time: 11058.6321s
	iters: 200, epoch: 13 | loss: 2.3018000
	speed: 0.0670s/iter; left time: 2753.4023s
	iters: 300, epoch: 13 | loss: 2.3061695
	speed: 0.0622s/iter; left time: 2550.0331s
	iters: 400, epoch: 13 | loss: 2.3134212
	speed: 0.0594s/iter; left time: 2429.6416s
Epoch: 13 cost time: 29.635775566101074
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3084426
	speed: 0.1794s/iter; left time: 7300.4749s
	iters: 200, epoch: 14 | loss: 2.3025808
	speed: 0.0594s/iter; left time: 2413.4431s
	iters: 300, epoch: 14 | loss: 2.2954571
	speed: 0.0626s/iter; left time: 2534.6968s
	iters: 400, epoch: 14 | loss: 2.3243968
	speed: 0.0634s/iter; left time: 2563.5779s
Epoch: 14 cost time: 28.561609506607056
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2986343
	speed: 0.2421s/iter; left time: 9739.8329s
	iters: 200, epoch: 15 | loss: 2.2896876
	speed: 0.0629s/iter; left time: 2525.2356s
	iters: 300, epoch: 15 | loss: 2.2987676
	speed: 0.0618s/iter; left time: 2473.0551s
	iters: 400, epoch: 15 | loss: 2.3150201
	speed: 0.0667s/iter; left time: 2662.6081s
Epoch: 15 cost time: 30.39525079727173
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.2992618
	speed: 0.2528s/iter; left time: 10053.6243s
	iters: 200, epoch: 16 | loss: 2.3125834
	speed: 0.0658s/iter; left time: 2608.2480s
	iters: 300, epoch: 16 | loss: 2.3094640
	speed: 0.0711s/iter; left time: 2811.5139s
	iters: 400, epoch: 16 | loss: 2.3046286
	speed: 0.0668s/iter; left time: 2636.9062s
Epoch: 16 cost time: 31.501025676727295
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.2920136
	speed: 0.2569s/iter; left time: 10096.6139s
	iters: 200, epoch: 17 | loss: 2.3008008
	speed: 0.0603s/iter; left time: 2363.5837s
	iters: 300, epoch: 17 | loss: 2.3155944
	speed: 0.0599s/iter; left time: 2343.1828s
	iters: 400, epoch: 17 | loss: 2.2990446
	speed: 0.0622s/iter; left time: 2423.6764s
Epoch: 17 cost time: 29.048388242721558
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.3064244
	speed: 0.2334s/iter; left time: 9062.9585s
	iters: 200, epoch: 18 | loss: 2.3117590
	speed: 0.0640s/iter; left time: 2477.6284s
	iters: 300, epoch: 18 | loss: 2.2994387
	speed: 0.0690s/iter; left time: 2664.4204s
	iters: 400, epoch: 18 | loss: 2.3096724
	speed: 0.0656s/iter; left time: 2526.3701s
Epoch: 18 cost time: 30.64179563522339
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3113675
	speed: 0.2590s/iter; left time: 9936.3511s
	iters: 200, epoch: 19 | loss: 2.3084455
	speed: 0.0605s/iter; left time: 2313.9076s
	iters: 300, epoch: 19 | loss: 2.3141766
	speed: 0.0644s/iter; left time: 2457.1107s
	iters: 400, epoch: 19 | loss: 2.2976003
	speed: 0.0682s/iter; left time: 2596.8786s
Epoch: 19 cost time: 30.332586526870728
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.3015480
	speed: 0.2457s/iter; left time: 9309.4489s
	iters: 200, epoch: 20 | loss: 2.3145039
	speed: 0.0631s/iter; left time: 2386.3283s
	iters: 300, epoch: 20 | loss: 2.2884350
	speed: 0.0635s/iter; left time: 2392.7745s
	iters: 400, epoch: 20 | loss: 2.3130462
	speed: 0.0637s/iter; left time: 2394.7401s
Epoch: 20 cost time: 29.45157551765442
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3116896
	speed: 0.2439s/iter; left time: 9128.7319s
	iters: 200, epoch: 21 | loss: 2.3030279
	speed: 0.0577s/iter; left time: 2154.7137s
	iters: 300, epoch: 21 | loss: 2.2918856
	speed: 0.0642s/iter; left time: 2391.1888s
	iters: 400, epoch: 21 | loss: 2.3082945
	speed: 0.0714s/iter; left time: 2650.9332s
Epoch: 21 cost time: 30.446949243545532
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.3019180
	speed: 0.2492s/iter; left time: 9206.9040s
	iters: 200, epoch: 22 | loss: 2.3068111
	speed: 0.0639s/iter; left time: 2355.6372s
	iters: 300, epoch: 22 | loss: 2.2816515
	speed: 0.0666s/iter; left time: 2446.7390s
	iters: 400, epoch: 22 | loss: 2.2967126
	speed: 0.0667s/iter; left time: 2445.3296s
Epoch: 22 cost time: 30.664440631866455
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.3175154
	speed: 0.2545s/iter; left time: 9286.6660s
	iters: 200, epoch: 23 | loss: 2.2837715
	speed: 0.0637s/iter; left time: 2316.3892s
	iters: 300, epoch: 23 | loss: 2.3093781
	speed: 0.0615s/iter; left time: 2231.6333s
	iters: 400, epoch: 23 | loss: 2.2946427
	speed: 0.0614s/iter; left time: 2222.6338s
Epoch: 23 cost time: 29.814299821853638
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3022091
	speed: 0.2477s/iter; left time: 8921.6270s
	iters: 200, epoch: 24 | loss: 2.2970719
	speed: 0.0597s/iter; left time: 2145.8229s
	iters: 300, epoch: 24 | loss: 2.2892036
	speed: 0.0610s/iter; left time: 2183.1167s
	iters: 400, epoch: 24 | loss: 2.2981052
	speed: 0.0640s/iter; left time: 2285.9922s
Epoch: 24 cost time: 28.673051118850708
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.3100207
	speed: 0.2556s/iter; left time: 9084.7482s
	iters: 200, epoch: 25 | loss: 2.2919233
	speed: 0.0624s/iter; left time: 2212.8155s
	iters: 300, epoch: 25 | loss: 2.3081427
	speed: 0.0575s/iter; left time: 2033.9846s
	iters: 400, epoch: 25 | loss: 2.3089998
	speed: 0.0666s/iter; left time: 2348.9343s
Epoch: 25 cost time: 29.966413021087646
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.3069701
	speed: 0.2658s/iter; left time: 9323.8603s
	iters: 200, epoch: 26 | loss: 2.3028886
	speed: 0.0521s/iter; left time: 1820.7963s
	iters: 300, epoch: 26 | loss: 2.3084741
	speed: 0.0472s/iter; left time: 1647.7803s
	iters: 400, epoch: 26 | loss: 2.2952352
	speed: 0.0493s/iter; left time: 1714.6829s
Epoch: 26 cost time: 24.264156818389893
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3038661
	speed: 0.2136s/iter; left time: 7392.7222s
	iters: 200, epoch: 27 | loss: 2.2956092
	speed: 0.0587s/iter; left time: 2024.8742s
	iters: 300, epoch: 27 | loss: 2.3103743
	speed: 0.0534s/iter; left time: 1838.2932s
	iters: 400, epoch: 27 | loss: 2.3196397
	speed: 0.0580s/iter; left time: 1990.8336s
Epoch: 27 cost time: 27.954158782958984
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.3086185
	speed: 0.2561s/iter; left time: 8743.6168s
	iters: 200, epoch: 28 | loss: 2.2985706
	speed: 0.0612s/iter; left time: 2084.2150s
	iters: 300, epoch: 28 | loss: 2.3142862
	speed: 0.0617s/iter; left time: 2095.1126s
	iters: 400, epoch: 28 | loss: 2.3119099
	speed: 0.0613s/iter; left time: 2073.5442s
Epoch: 28 cost time: 28.79129147529602
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 4359946
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5990390
	speed: 0.0770s/iter; left time: 3603.8991s
	iters: 200, epoch: 1 | loss: 0.2579696
	speed: 0.0618s/iter; left time: 2886.0240s
	iters: 300, epoch: 1 | loss: 0.0672128
	speed: 0.0573s/iter; left time: 2670.5262s
	iters: 400, epoch: 1 | loss: 0.0153943
	speed: 0.0562s/iter; left time: 2614.6582s
Epoch: 1 cost time: 29.17514133453369
Epoch: 1, Steps: 469 | Train Loss: 0.370 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (inf --> -0.954258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0269120
	speed: 0.2525s/iter; left time: 11698.7278s
	iters: 200, epoch: 2 | loss: 0.1701570
	speed: 0.0572s/iter; left time: 2646.4134s
	iters: 300, epoch: 2 | loss: 0.1701521
	speed: 0.0583s/iter; left time: 2688.8802s
	iters: 400, epoch: 2 | loss: 0.0409403
	speed: 0.0573s/iter; left time: 2638.5818s
Epoch: 2 cost time: 27.459893941879272
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.954258 --> -0.960547).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0491613
	speed: 0.2498s/iter; left time: 11456.4166s
	iters: 200, epoch: 3 | loss: 0.0348649
	speed: 0.0636s/iter; left time: 2911.1789s
	iters: 300, epoch: 3 | loss: 0.2732688
	speed: 0.0603s/iter; left time: 2753.7426s
	iters: 400, epoch: 3 | loss: 0.0128692
	speed: 0.0559s/iter; left time: 2548.9760s
Epoch: 3 cost time: 28.917707204818726
Epoch: 3, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
Validation loss decreased (-0.960547 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0027176
	speed: 0.2612s/iter; left time: 11857.2970s
	iters: 200, epoch: 4 | loss: 0.0227474
	speed: 0.0659s/iter; left time: 2984.7423s
	iters: 300, epoch: 4 | loss: 0.4318630
	speed: 0.0617s/iter; left time: 2786.8065s
	iters: 400, epoch: 4 | loss: 0.0029391
	speed: 0.0583s/iter; left time: 2627.3925s
Epoch: 4 cost time: 29.085788249969482
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2623246
	speed: 0.2410s/iter; left time: 10825.7607s
	iters: 200, epoch: 5 | loss: 0.3064592
	speed: 0.0619s/iter; left time: 2775.0018s
	iters: 300, epoch: 5 | loss: 0.0091205
	speed: 0.0571s/iter; left time: 2555.0888s
	iters: 400, epoch: 5 | loss: 0.0046691
	speed: 0.0556s/iter; left time: 2479.5383s
Epoch: 5 cost time: 28.067126989364624
Epoch: 5, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0142078
	speed: 0.2370s/iter; left time: 10536.8693s
	iters: 200, epoch: 6 | loss: 0.0473578
	speed: 0.0658s/iter; left time: 2917.4291s
	iters: 300, epoch: 6 | loss: 0.0014039
	speed: 0.0651s/iter; left time: 2880.1856s
	iters: 400, epoch: 6 | loss: 0.0436864
	speed: 0.0629s/iter; left time: 2775.4129s
Epoch: 6 cost time: 29.33395743370056
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.961119 --> -0.977415).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003461
	speed: 0.2446s/iter; left time: 10757.3599s
	iters: 200, epoch: 7 | loss: 0.0461169
	speed: 0.0673s/iter; left time: 2953.6366s
	iters: 300, epoch: 7 | loss: 0.3214965
	speed: 0.0653s/iter; left time: 2860.2325s
	iters: 400, epoch: 7 | loss: 0.0896107
	speed: 0.0557s/iter; left time: 2431.7828s
Epoch: 7 cost time: 30.191392421722412
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0013090
	speed: 0.2466s/iter; left time: 10731.3390s
	iters: 200, epoch: 8 | loss: 0.0172357
	speed: 0.0633s/iter; left time: 2749.1725s
	iters: 300, epoch: 8 | loss: 0.0115119
	speed: 0.0579s/iter; left time: 2510.1703s
	iters: 400, epoch: 8 | loss: 0.0506266
	speed: 0.0584s/iter; left time: 2523.9552s
Epoch: 8 cost time: 28.158442974090576
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.209 Vali Acc: 0.955 Test Loss: 0.209 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0042482
	speed: 0.2238s/iter; left time: 9634.0653s
	iters: 200, epoch: 9 | loss: 0.0002888
	speed: 0.0669s/iter; left time: 2874.0574s
	iters: 300, epoch: 9 | loss: 0.1716859
	speed: 0.0630s/iter; left time: 2698.6258s
	iters: 400, epoch: 9 | loss: 0.1262894
	speed: 0.0633s/iter; left time: 2707.0255s
Epoch: 9 cost time: 29.963785648345947
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0090109
	speed: 0.2440s/iter; left time: 10389.6583s
	iters: 200, epoch: 10 | loss: 0.1814955
	speed: 0.0616s/iter; left time: 2616.4431s
	iters: 300, epoch: 10 | loss: 0.2922767
	speed: 0.0657s/iter; left time: 2786.2548s
	iters: 400, epoch: 10 | loss: 0.0043815
	speed: 0.0663s/iter; left time: 2804.0288s
Epoch: 10 cost time: 30.08263897895813
Epoch: 10, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0006967
	speed: 0.2331s/iter; left time: 9818.0580s
	iters: 200, epoch: 11 | loss: 0.1960032
	speed: 0.0656s/iter; left time: 2755.1564s
	iters: 300, epoch: 11 | loss: 0.0005346
	speed: 0.0612s/iter; left time: 2565.5279s
	iters: 400, epoch: 11 | loss: 0.0692101
	speed: 0.0570s/iter; left time: 2384.8629s
Epoch: 11 cost time: 29.244835138320923
Epoch: 11, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1003849
	speed: 0.2409s/iter; left time: 10031.5713s
	iters: 200, epoch: 12 | loss: 0.0000189
	speed: 0.0626s/iter; left time: 2598.8443s
	iters: 300, epoch: 12 | loss: 0.0549631
	speed: 0.0650s/iter; left time: 2695.6134s
	iters: 400, epoch: 12 | loss: 0.0017417
	speed: 0.0634s/iter; left time: 2621.9333s
Epoch: 12 cost time: 29.20138382911682
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0163478
	speed: 0.2154s/iter; left time: 8868.7578s
	iters: 200, epoch: 13 | loss: 0.0025398
	speed: 0.0513s/iter; left time: 2107.1731s
	iters: 300, epoch: 13 | loss: 0.1782568
	speed: 0.0546s/iter; left time: 2236.0813s
	iters: 400, epoch: 13 | loss: 0.0375580
	speed: 0.0527s/iter; left time: 2153.6265s
Epoch: 13 cost time: 25.839323043823242
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0290237
	speed: 0.2588s/iter; left time: 10532.4115s
	iters: 200, epoch: 14 | loss: 0.0007441
	speed: 0.0598s/iter; left time: 2428.0795s
	iters: 300, epoch: 14 | loss: 0.0033969
	speed: 0.0657s/iter; left time: 2659.9229s
	iters: 400, epoch: 14 | loss: 0.1429171
	speed: 0.0630s/iter; left time: 2546.6132s
Epoch: 14 cost time: 29.227042198181152
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2363684
	speed: 0.2510s/iter; left time: 10100.1025s
	iters: 200, epoch: 15 | loss: 0.0005499
	speed: 0.0591s/iter; left time: 2372.6076s
	iters: 300, epoch: 15 | loss: 0.0000469
	speed: 0.0593s/iter; left time: 2373.2115s
	iters: 400, epoch: 15 | loss: 0.0074957
	speed: 0.0630s/iter; left time: 2517.3596s
Epoch: 15 cost time: 28.47120976448059
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4061062
	speed: 0.2660s/iter; left time: 10576.9496s
	iters: 200, epoch: 16 | loss: 0.0149799
	speed: 0.0589s/iter; left time: 2336.9933s
	iters: 300, epoch: 16 | loss: 0.0149479
	speed: 0.0593s/iter; left time: 2344.2938s
	iters: 400, epoch: 16 | loss: 0.0166554
	speed: 0.0634s/iter; left time: 2503.4627s
Epoch: 16 cost time: 28.78130054473877
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.260 Vali Acc: 0.953 Test Loss: 0.260 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 2787082
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6988171
	speed: 0.0775s/iter; left time: 3624.8594s
	iters: 200, epoch: 1 | loss: 0.4158138
	speed: 0.0638s/iter; left time: 2977.9412s
	iters: 300, epoch: 1 | loss: 0.0824487
	speed: 0.0630s/iter; left time: 2934.8225s
	iters: 400, epoch: 1 | loss: 0.0449213
	speed: 0.0627s/iter; left time: 2915.8168s
Epoch: 1 cost time: 30.93967366218567
Epoch: 1, Steps: 469 | Train Loss: 0.428 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
Validation loss decreased (inf --> -0.945967).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0267706
	speed: 0.2471s/iter; left time: 11450.8271s
	iters: 200, epoch: 2 | loss: 0.0217484
	speed: 0.0603s/iter; left time: 2785.6219s
	iters: 300, epoch: 2 | loss: 0.0359329
	speed: 0.0616s/iter; left time: 2841.8129s
	iters: 400, epoch: 2 | loss: 0.1016089
	speed: 0.0641s/iter; left time: 2952.7074s
Epoch: 2 cost time: 29.012199878692627
Epoch: 2, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1899227
	speed: 0.2581s/iter; left time: 11835.9803s
	iters: 200, epoch: 3 | loss: 0.1585928
	speed: 0.0646s/iter; left time: 2955.1059s
	iters: 300, epoch: 3 | loss: 0.2109068
	speed: 0.0633s/iter; left time: 2889.0484s
	iters: 400, epoch: 3 | loss: 0.4482504
	speed: 0.0663s/iter; left time: 3021.3520s
Epoch: 3 cost time: 30.354820013046265
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.225 Vali Acc: 0.934 Test Loss: 0.225 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0563111
	speed: 0.2613s/iter; left time: 11863.3277s
	iters: 200, epoch: 4 | loss: 0.0286547
	speed: 0.0629s/iter; left time: 2848.2213s
	iters: 300, epoch: 4 | loss: 0.2505239
	speed: 0.0633s/iter; left time: 2862.8282s
	iters: 400, epoch: 4 | loss: 0.0116829
	speed: 0.0606s/iter; left time: 2734.5069s
Epoch: 4 cost time: 29.542333364486694
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.945967 --> -0.949969).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2302561
	speed: 0.2427s/iter; left time: 10903.8297s
	iters: 200, epoch: 5 | loss: 0.0289107
	speed: 0.0609s/iter; left time: 2727.8387s
	iters: 300, epoch: 5 | loss: 0.1002646
	speed: 0.0590s/iter; left time: 2638.2576s
	iters: 400, epoch: 5 | loss: 0.0085806
	speed: 0.0638s/iter; left time: 2847.2078s
Epoch: 5 cost time: 29.155011415481567
Epoch: 5, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2227086
	speed: 0.2610s/iter; left time: 11602.2598s
	iters: 200, epoch: 6 | loss: 0.4031796
	speed: 0.0624s/iter; left time: 2765.9177s
	iters: 300, epoch: 6 | loss: 0.0125596
	speed: 0.0644s/iter; left time: 2849.9808s
	iters: 400, epoch: 6 | loss: 0.0473331
	speed: 0.0669s/iter; left time: 2953.0611s
Epoch: 6 cost time: 30.49008584022522
Epoch: 6, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.949969 --> -0.956545).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0911446
	speed: 0.2663s/iter; left time: 11715.4849s
	iters: 200, epoch: 7 | loss: 0.1058398
	speed: 0.0632s/iter; left time: 2773.8587s
	iters: 300, epoch: 7 | loss: 0.2185477
	speed: 0.0626s/iter; left time: 2742.4349s
	iters: 400, epoch: 7 | loss: 0.2120913
	speed: 0.0616s/iter; left time: 2690.5118s
Epoch: 7 cost time: 29.06477189064026
Epoch: 7, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0292016
	speed: 0.2385s/iter; left time: 10377.9663s
	iters: 200, epoch: 8 | loss: 0.0030409
	speed: 0.0591s/iter; left time: 2564.2501s
	iters: 300, epoch: 8 | loss: 0.0245090
	speed: 0.0613s/iter; left time: 2656.3592s
	iters: 400, epoch: 8 | loss: 0.1300098
	speed: 0.0668s/iter; left time: 2889.1159s
Epoch: 8 cost time: 28.99987244606018
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.235 Vali Acc: 0.945 Test Loss: 0.235 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0052205
	speed: 0.2563s/iter; left time: 11034.8459s
	iters: 200, epoch: 9 | loss: 0.0283454
	speed: 0.0601s/iter; left time: 2582.0794s
	iters: 300, epoch: 9 | loss: 0.0009843
	speed: 0.0632s/iter; left time: 2707.5696s
	iters: 400, epoch: 9 | loss: 0.0121709
	speed: 0.0638s/iter; left time: 2726.3599s
Epoch: 9 cost time: 29.663539171218872
Epoch: 9, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.956545 --> -0.957403).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0041331
	speed: 0.2691s/iter; left time: 11456.4504s
	iters: 200, epoch: 10 | loss: 0.0170918
	speed: 0.0611s/iter; left time: 2596.9636s
	iters: 300, epoch: 10 | loss: 0.5098911
	speed: 0.0644s/iter; left time: 2731.2665s
	iters: 400, epoch: 10 | loss: 0.2574008
	speed: 0.0628s/iter; left time: 2655.0123s
Epoch: 10 cost time: 29.427950859069824
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.957403 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0007307
	speed: 0.2535s/iter; left time: 10675.3082s
	iters: 200, epoch: 11 | loss: 0.0059024
	speed: 0.0603s/iter; left time: 2533.3206s
	iters: 300, epoch: 11 | loss: 0.4310797
	speed: 0.0601s/iter; left time: 2516.8308s
	iters: 400, epoch: 11 | loss: 0.0061073
	speed: 0.0640s/iter; left time: 2675.7795s
Epoch: 11 cost time: 29.24792718887329
Epoch: 11, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0539012
	speed: 0.2721s/iter; left time: 11329.1687s
	iters: 200, epoch: 12 | loss: 0.0015432
	speed: 0.0601s/iter; left time: 2494.8449s
	iters: 300, epoch: 12 | loss: 0.0058438
	speed: 0.0647s/iter; left time: 2681.7757s
	iters: 400, epoch: 12 | loss: 0.0096381
	speed: 0.0675s/iter; left time: 2790.4441s
Epoch: 12 cost time: 30.073440313339233
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0033876
	speed: 0.2687s/iter; left time: 11063.6469s
	iters: 200, epoch: 13 | loss: 0.0214667
	speed: 0.0606s/iter; left time: 2490.2949s
	iters: 300, epoch: 13 | loss: 0.0005096
	speed: 0.0654s/iter; left time: 2678.5287s
	iters: 400, epoch: 13 | loss: 0.0412994
	speed: 0.0632s/iter; left time: 2582.3218s
Epoch: 13 cost time: 29.423104524612427
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0003041
	speed: 0.2509s/iter; left time: 10214.3130s
	iters: 200, epoch: 14 | loss: 0.0062252
	speed: 0.0568s/iter; left time: 2308.2372s
	iters: 300, epoch: 14 | loss: 0.0599609
	speed: 0.0592s/iter; left time: 2399.7065s
	iters: 400, epoch: 14 | loss: 0.0004715
	speed: 0.0588s/iter; left time: 2375.8751s
Epoch: 14 cost time: 27.963469743728638
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1010850
	speed: 0.2691s/iter; left time: 10825.4505s
	iters: 200, epoch: 15 | loss: 0.0082149
	speed: 0.0619s/iter; left time: 2484.1497s
	iters: 300, epoch: 15 | loss: 0.0224109
	speed: 0.0617s/iter; left time: 2472.0617s
	iters: 400, epoch: 15 | loss: 0.0056540
	speed: 0.0653s/iter; left time: 2609.6420s
Epoch: 15 cost time: 29.713274002075195
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0078815
	speed: 0.2744s/iter; left time: 10911.8328s
	iters: 200, epoch: 16 | loss: 0.0454522
	speed: 0.0620s/iter; left time: 2458.4814s
	iters: 300, epoch: 16 | loss: 0.0015327
	speed: 0.0619s/iter; left time: 2449.5521s
	iters: 400, epoch: 16 | loss: 0.0083944
	speed: 0.0627s/iter; left time: 2475.9024s
Epoch: 16 cost time: 29.994866371154785
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0561542
	speed: 0.2620s/iter; left time: 10293.9785s
	iters: 200, epoch: 17 | loss: 0.5388032
	speed: 0.0587s/iter; left time: 2299.4577s
	iters: 300, epoch: 17 | loss: 0.0054536
	speed: 0.0588s/iter; left time: 2298.5457s
	iters: 400, epoch: 17 | loss: 0.0003614
	speed: 0.0626s/iter; left time: 2441.3955s
Epoch: 17 cost time: 28.2023708820343
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.979416).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1529399
	speed: 0.2690s/iter; left time: 10446.1558s
	iters: 200, epoch: 18 | loss: 0.0006770
	speed: 0.0593s/iter; left time: 2295.7827s
	iters: 300, epoch: 18 | loss: 0.0070297
	speed: 0.0602s/iter; left time: 2323.6425s
	iters: 400, epoch: 18 | loss: 0.3008443
	speed: 0.0650s/iter; left time: 2502.6028s
Epoch: 18 cost time: 29.46885657310486
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0077024
	speed: 0.2706s/iter; left time: 10381.2058s
	iters: 200, epoch: 19 | loss: 0.0023189
	speed: 0.0594s/iter; left time: 2273.5497s
	iters: 300, epoch: 19 | loss: 0.0013268
	speed: 0.0614s/iter; left time: 2344.1216s
	iters: 400, epoch: 19 | loss: 0.0472709
	speed: 0.0620s/iter; left time: 2360.2789s
Epoch: 19 cost time: 28.892030477523804
Epoch: 19, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.330 Vali Acc: 0.942 Test Loss: 0.330 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0010964
	speed: 0.2600s/iter; left time: 9852.2380s
	iters: 200, epoch: 20 | loss: 0.0016723
	speed: 0.0579s/iter; left time: 2189.8516s
	iters: 300, epoch: 20 | loss: 0.0000760
	speed: 0.0610s/iter; left time: 2299.5321s
	iters: 400, epoch: 20 | loss: 0.0225952
	speed: 0.0605s/iter; left time: 2272.7490s
Epoch: 20 cost time: 27.98970317840576
Epoch: 20, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.264 Vali Acc: 0.940 Test Loss: 0.264 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0628803
	speed: 0.2614s/iter; left time: 9780.3028s
	iters: 200, epoch: 21 | loss: 0.0001092
	speed: 0.0629s/iter; left time: 2347.3539s
	iters: 300, epoch: 21 | loss: 0.0118123
	speed: 0.0617s/iter; left time: 2296.1743s
	iters: 400, epoch: 21 | loss: 0.0003521
	speed: 0.0660s/iter; left time: 2448.7453s
Epoch: 21 cost time: 30.055867910385132
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.957 Test Loss: 0.234 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1243667
	speed: 0.2729s/iter; left time: 10082.5661s
	iters: 200, epoch: 22 | loss: 0.0027227
	speed: 0.0606s/iter; left time: 2232.4173s
	iters: 300, epoch: 22 | loss: 0.0012116
	speed: 0.0602s/iter; left time: 2212.2588s
	iters: 400, epoch: 22 | loss: 0.0054246
	speed: 0.0605s/iter; left time: 2215.9414s
Epoch: 22 cost time: 28.988544702529907
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1597003
	speed: 0.2612s/iter; left time: 9529.2427s
	iters: 200, epoch: 23 | loss: 0.1434612
	speed: 0.0614s/iter; left time: 2235.6567s
	iters: 300, epoch: 23 | loss: 0.0129217
	speed: 0.0588s/iter; left time: 2135.2130s
	iters: 400, epoch: 23 | loss: 0.0015552
	speed: 0.0632s/iter; left time: 2288.4705s
Epoch: 23 cost time: 28.841047286987305
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0016266
	speed: 0.2580s/iter; left time: 9290.7245s
	iters: 200, epoch: 24 | loss: 0.0001876
	speed: 0.0610s/iter; left time: 2189.1684s
	iters: 300, epoch: 24 | loss: 0.0011504
	speed: 0.0588s/iter; left time: 2104.3000s
	iters: 400, epoch: 24 | loss: 0.0140173
	speed: 0.0633s/iter; left time: 2261.3854s
Epoch: 24 cost time: 28.94084358215332
Epoch: 24, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.215 Vali Acc: 0.962 Test Loss: 0.215 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0016967
	speed: 0.2729s/iter; left time: 9699.6590s
	iters: 200, epoch: 25 | loss: 0.0605801
	speed: 0.0630s/iter; left time: 2231.9081s
	iters: 300, epoch: 25 | loss: 0.0228887
	speed: 0.0616s/iter; left time: 2175.6015s
	iters: 400, epoch: 25 | loss: 0.0017225
	speed: 0.0643s/iter; left time: 2267.1567s
Epoch: 25 cost time: 29.735238552093506
Epoch: 25, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0089522
	speed: 0.2633s/iter; left time: 9236.3601s
	iters: 200, epoch: 26 | loss: 0.0015763
	speed: 0.0600s/iter; left time: 2097.3678s
	iters: 300, epoch: 26 | loss: 0.0031647
	speed: 0.0600s/iter; left time: 2091.2302s
	iters: 400, epoch: 26 | loss: 0.1614342
	speed: 0.0609s/iter; left time: 2118.1022s
Epoch: 26 cost time: 28.42582869529724
Epoch: 26, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0450533
	speed: 0.2624s/iter; left time: 9079.8317s
	iters: 200, epoch: 27 | loss: 0.0047807
	speed: 0.0580s/iter; left time: 2000.4460s
	iters: 300, epoch: 27 | loss: 0.0072969
	speed: 0.0629s/iter; left time: 2162.6583s
	iters: 400, epoch: 27 | loss: 0.0108956
	speed: 0.0575s/iter; left time: 1971.3321s
Epoch: 27 cost time: 28.301708936691284
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 2787082
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6371308
	speed: 0.0775s/iter; left time: 3626.0331s
	iters: 200, epoch: 1 | loss: 0.2629267
	speed: 0.0653s/iter; left time: 3049.1684s
	iters: 300, epoch: 1 | loss: 0.0742931
	speed: 0.0648s/iter; left time: 3017.6125s
	iters: 400, epoch: 1 | loss: 0.0338427
	speed: 0.0650s/iter; left time: 3021.4354s
Epoch: 1 cost time: 31.939117908477783
Epoch: 1, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (inf --> -0.957403).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0153499
	speed: 0.2523s/iter; left time: 11687.3497s
	iters: 200, epoch: 2 | loss: 0.0823119
	speed: 0.0599s/iter; left time: 2770.9829s
	iters: 300, epoch: 2 | loss: 0.0714010
	speed: 0.0607s/iter; left time: 2799.5568s
	iters: 400, epoch: 2 | loss: 0.0637167
	speed: 0.0612s/iter; left time: 2818.7454s
Epoch: 2 cost time: 28.459288835525513
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
Validation loss decreased (-0.957403 --> -0.961405).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1551661
	speed: 0.2546s/iter; left time: 11676.7827s
	iters: 200, epoch: 3 | loss: 0.1316895
	speed: 0.0614s/iter; left time: 2811.3866s
	iters: 300, epoch: 3 | loss: 0.3319556
	speed: 0.0628s/iter; left time: 2869.5468s
	iters: 400, epoch: 3 | loss: 0.0293370
	speed: 0.0610s/iter; left time: 2777.8147s
Epoch: 3 cost time: 29.52999711036682
Epoch: 3, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0086072
	speed: 0.2568s/iter; left time: 11656.4224s
	iters: 200, epoch: 4 | loss: 0.0035306
	speed: 0.0598s/iter; left time: 2708.6146s
	iters: 300, epoch: 4 | loss: 0.0811978
	speed: 0.0660s/iter; left time: 2984.0262s
	iters: 400, epoch: 4 | loss: 0.0203330
	speed: 0.0662s/iter; left time: 2983.9712s
Epoch: 4 cost time: 29.969968795776367
Epoch: 4, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3023918
	speed: 0.2597s/iter; left time: 11664.7807s
	iters: 200, epoch: 5 | loss: 0.0253803
	speed: 0.0581s/iter; left time: 2605.2121s
	iters: 300, epoch: 5 | loss: 0.0540729
	speed: 0.0611s/iter; left time: 2732.3102s
	iters: 400, epoch: 5 | loss: 0.0369468
	speed: 0.0633s/iter; left time: 2825.8506s
Epoch: 5 cost time: 28.62260127067566
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0193127
	speed: 0.2555s/iter; left time: 11357.6554s
	iters: 200, epoch: 6 | loss: 0.0142190
	speed: 0.0576s/iter; left time: 2554.9437s
	iters: 300, epoch: 6 | loss: 0.2503944
	speed: 0.0561s/iter; left time: 2483.7126s
	iters: 400, epoch: 6 | loss: 0.0321420
	speed: 0.0565s/iter; left time: 2493.8161s
Epoch: 6 cost time: 27.198036670684814
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.961405 --> -0.964550).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0019962
	speed: 0.2200s/iter; left time: 9676.9748s
	iters: 200, epoch: 7 | loss: 0.1525066
	speed: 0.0555s/iter; left time: 2434.8669s
	iters: 300, epoch: 7 | loss: 0.3528950
	speed: 0.0558s/iter; left time: 2442.8877s
	iters: 400, epoch: 7 | loss: 0.0015392
	speed: 0.0570s/iter; left time: 2490.9206s
Epoch: 7 cost time: 27.01269793510437
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0408586
	speed: 0.2748s/iter; left time: 11957.8779s
	iters: 200, epoch: 8 | loss: 0.0158309
	speed: 0.0609s/iter; left time: 2643.0062s
	iters: 300, epoch: 8 | loss: 0.1086998
	speed: 0.0601s/iter; left time: 2601.9608s
	iters: 400, epoch: 8 | loss: 0.1924657
	speed: 0.0648s/iter; left time: 2802.4200s
Epoch: 8 cost time: 29.660104036331177
Epoch: 8, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0193702
	speed: 0.2735s/iter; left time: 11774.2783s
	iters: 200, epoch: 9 | loss: 0.0132036
	speed: 0.0589s/iter; left time: 2531.6585s
	iters: 300, epoch: 9 | loss: 0.0123225
	speed: 0.0590s/iter; left time: 2527.7252s
	iters: 400, epoch: 9 | loss: 0.0137085
	speed: 0.0645s/iter; left time: 2759.2210s
Epoch: 9 cost time: 29.262349367141724
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0048377
	speed: 0.2527s/iter; left time: 10761.1791s
	iters: 200, epoch: 10 | loss: 0.0151911
	speed: 0.0568s/iter; left time: 2413.9401s
	iters: 300, epoch: 10 | loss: 0.0490810
	speed: 0.0588s/iter; left time: 2492.8514s
	iters: 400, epoch: 10 | loss: 0.1205614
	speed: 0.0630s/iter; left time: 2661.8239s
Epoch: 10 cost time: 28.45939588546753
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0002598
	speed: 0.2721s/iter; left time: 11459.4863s
	iters: 200, epoch: 11 | loss: 0.2150388
	speed: 0.0607s/iter; left time: 2548.5588s
	iters: 300, epoch: 11 | loss: 0.0065261
	speed: 0.0618s/iter; left time: 2590.0329s
	iters: 400, epoch: 11 | loss: 0.0006287
	speed: 0.0635s/iter; left time: 2656.4873s
Epoch: 11 cost time: 29.578518390655518
Epoch: 11, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.966836).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2974971
	speed: 0.2788s/iter; left time: 11607.9958s
	iters: 200, epoch: 12 | loss: 0.0008934
	speed: 0.0620s/iter; left time: 2576.9367s
	iters: 300, epoch: 12 | loss: 0.0066477
	speed: 0.0604s/iter; left time: 2504.8471s
	iters: 400, epoch: 12 | loss: 0.0018943
	speed: 0.0640s/iter; left time: 2645.8247s
Epoch: 12 cost time: 29.83517098426819
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.966836 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0063260
	speed: 0.2664s/iter; left time: 10967.6158s
	iters: 200, epoch: 13 | loss: 0.0003926
	speed: 0.0573s/iter; left time: 2353.9294s
	iters: 300, epoch: 13 | loss: 0.0004069
	speed: 0.0582s/iter; left time: 2383.2225s
	iters: 400, epoch: 13 | loss: 0.0007858
	speed: 0.0614s/iter; left time: 2509.0854s
Epoch: 13 cost time: 28.316022396087646
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0477086
	speed: 0.2670s/iter; left time: 10869.4295s
	iters: 200, epoch: 14 | loss: 0.0086988
	speed: 0.0631s/iter; left time: 2562.2359s
	iters: 300, epoch: 14 | loss: 0.0055187
	speed: 0.0603s/iter; left time: 2442.2337s
	iters: 400, epoch: 14 | loss: 0.0538314
	speed: 0.0644s/iter; left time: 2601.5189s
Epoch: 14 cost time: 29.687528371810913
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0071431
	speed: 0.2778s/iter; left time: 11175.3971s
	iters: 200, epoch: 15 | loss: 0.0010732
	speed: 0.0644s/iter; left time: 2586.2163s
	iters: 300, epoch: 15 | loss: 0.0000341
	speed: 0.0648s/iter; left time: 2595.4808s
	iters: 400, epoch: 15 | loss: 0.0045604
	speed: 0.0683s/iter; left time: 2728.0086s
Epoch: 15 cost time: 31.118648767471313
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0716842
	speed: 0.2849s/iter; left time: 11327.7371s
	iters: 200, epoch: 16 | loss: 0.3471367
	speed: 0.0606s/iter; left time: 2404.0422s
	iters: 300, epoch: 16 | loss: 0.0197817
	speed: 0.0648s/iter; left time: 2565.5806s
	iters: 400, epoch: 16 | loss: 0.0264530
	speed: 0.0634s/iter; left time: 2502.3252s
Epoch: 16 cost time: 30.200603485107422
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0014677
	speed: 0.2678s/iter; left time: 10523.6211s
	iters: 200, epoch: 17 | loss: 0.1268867
	speed: 0.0678s/iter; left time: 2658.8491s
	iters: 300, epoch: 17 | loss: 0.0005446
	speed: 0.0677s/iter; left time: 2645.1813s
	iters: 400, epoch: 17 | loss: 0.0548334
	speed: 0.0675s/iter; left time: 2630.8855s
Epoch: 17 cost time: 31.7342369556427
Epoch: 17, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0025546
	speed: 0.2749s/iter; left time: 10675.3163s
	iters: 200, epoch: 18 | loss: 0.0003252
	speed: 0.0647s/iter; left time: 2505.0738s
	iters: 300, epoch: 18 | loss: 0.0047639
	speed: 0.0637s/iter; left time: 2461.7688s
	iters: 400, epoch: 18 | loss: 0.0154234
	speed: 0.0680s/iter; left time: 2618.7877s
Epoch: 18 cost time: 31.100006818771362
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002675
	speed: 0.2639s/iter; left time: 10123.8963s
	iters: 200, epoch: 19 | loss: 0.0013272
	speed: 0.0665s/iter; left time: 2544.8285s
	iters: 300, epoch: 19 | loss: 0.0063920
	speed: 0.0617s/iter; left time: 2355.1871s
	iters: 400, epoch: 19 | loss: 0.0495277
	speed: 0.0641s/iter; left time: 2440.0061s
Epoch: 19 cost time: 30.121034145355225
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000572
	speed: 0.2461s/iter; left time: 9326.0859s
	iters: 200, epoch: 20 | loss: 0.0023956
	speed: 0.0706s/iter; left time: 2669.1867s
	iters: 300, epoch: 20 | loss: 0.0310651
	speed: 0.0674s/iter; left time: 2540.9711s
	iters: 400, epoch: 20 | loss: 0.0758612
	speed: 0.0686s/iter; left time: 2577.8686s
Epoch: 20 cost time: 32.16966795921326
Epoch: 20, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4510009
	speed: 0.2681s/iter; left time: 10031.3421s
	iters: 200, epoch: 21 | loss: 0.0000822
	speed: 0.0698s/iter; left time: 2604.8068s
	iters: 300, epoch: 21 | loss: 0.0014870
	speed: 0.0652s/iter; left time: 2427.4337s
	iters: 400, epoch: 21 | loss: 0.0001976
	speed: 0.0632s/iter; left time: 2346.3587s
Epoch: 21 cost time: 31.401004552841187
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0002109
	speed: 0.2586s/iter; left time: 9555.7030s
	iters: 200, epoch: 22 | loss: 0.0158851
	speed: 0.0649s/iter; left time: 2393.3695s
	iters: 300, epoch: 22 | loss: 0.0233436
	speed: 0.0633s/iter; left time: 2326.7940s
	iters: 400, epoch: 22 | loss: 0.0001270
	speed: 0.0623s/iter; left time: 2281.7457s
Epoch: 22 cost time: 29.828203916549683
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0043310
	speed: 0.2420s/iter; left time: 8830.4322s
	iters: 200, epoch: 23 | loss: 0.7407142
	speed: 0.0658s/iter; left time: 2393.7228s
	iters: 300, epoch: 23 | loss: 0.0138732
	speed: 0.0618s/iter; left time: 2242.9374s
	iters: 400, epoch: 23 | loss: 0.0000717
	speed: 0.0646s/iter; left time: 2338.9298s
Epoch: 23 cost time: 30.40398335456848
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0119423
	speed: 0.2617s/iter; left time: 9424.9201s
	iters: 200, epoch: 24 | loss: 0.0000186
	speed: 0.0635s/iter; left time: 2281.5315s
	iters: 300, epoch: 24 | loss: 0.0001974
	speed: 0.0658s/iter; left time: 2357.1149s
	iters: 400, epoch: 24 | loss: 0.0009823
	speed: 0.0646s/iter; left time: 2307.2923s
Epoch: 24 cost time: 30.503156185150146
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0419366
	speed: 0.2612s/iter; left time: 9285.0372s
	iters: 200, epoch: 25 | loss: 0.0002960
	speed: 0.0649s/iter; left time: 2300.1097s
	iters: 300, epoch: 25 | loss: 0.0127061
	speed: 0.0642s/iter; left time: 2268.5677s
	iters: 400, epoch: 25 | loss: 0.0004307
	speed: 0.0624s/iter; left time: 2198.8915s
Epoch: 25 cost time: 29.96978759765625
Epoch: 25, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.290 Vali Acc: 0.951 Test Loss: 0.290 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0070398
	speed: 0.2435s/iter; left time: 8542.7339s
	iters: 200, epoch: 26 | loss: 0.0145476
	speed: 0.0632s/iter; left time: 2211.7966s
	iters: 300, epoch: 26 | loss: 0.0005114
	speed: 0.0631s/iter; left time: 2201.3712s
	iters: 400, epoch: 26 | loss: 0.0000779
	speed: 0.0643s/iter; left time: 2237.5242s
Epoch: 26 cost time: 29.98442244529724
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0063679
	speed: 0.2523s/iter; left time: 8731.4704s
	iters: 200, epoch: 27 | loss: 0.0627069
	speed: 0.0644s/iter; left time: 2221.8273s
	iters: 300, epoch: 27 | loss: 0.0000742
	speed: 0.0624s/iter; left time: 2146.1276s
	iters: 400, epoch: 27 | loss: 0.0008483
	speed: 0.0678s/iter; left time: 2325.8815s
Epoch: 27 cost time: 30.65204906463623
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.979416).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0004337
	speed: 0.2631s/iter; left time: 8981.1200s
	iters: 200, epoch: 28 | loss: 0.0003235
	speed: 0.0657s/iter; left time: 2236.4457s
	iters: 300, epoch: 28 | loss: 0.0017192
	speed: 0.0625s/iter; left time: 2122.2199s
	iters: 400, epoch: 28 | loss: 0.0052778
	speed: 0.0625s/iter; left time: 2114.7979s
Epoch: 28 cost time: 30.108071088790894
Epoch: 28, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0062816
	speed: 0.2481s/iter; left time: 8352.0448s
	iters: 200, epoch: 29 | loss: 0.0175449
	speed: 0.0623s/iter; left time: 2090.1299s
	iters: 300, epoch: 29 | loss: 0.0001674
	speed: 0.0635s/iter; left time: 2126.3128s
	iters: 400, epoch: 29 | loss: 0.0021358
	speed: 0.0640s/iter; left time: 2135.7885s
Epoch: 29 cost time: 29.882328748703003
Epoch: 29, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000274
	speed: 0.2532s/iter; left time: 8404.8258s
	iters: 200, epoch: 30 | loss: 0.0000954
	speed: 0.0583s/iter; left time: 1930.5133s
	iters: 300, epoch: 30 | loss: 0.0000554
	speed: 0.0664s/iter; left time: 2192.3424s
	iters: 400, epoch: 30 | loss: 0.0001418
	speed: 0.0683s/iter; left time: 2246.5821s
Epoch: 30 cost time: 30.427314281463623
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0019189
	speed: 0.2593s/iter; left time: 8487.4691s
	iters: 200, epoch: 31 | loss: 0.0116811
	speed: 0.0636s/iter; left time: 2076.1232s
	iters: 300, epoch: 31 | loss: 0.0016306
	speed: 0.0632s/iter; left time: 2056.5632s
	iters: 400, epoch: 31 | loss: 0.0176622
	speed: 0.0622s/iter; left time: 2018.3543s
Epoch: 31 cost time: 29.78525161743164
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0014234
	speed: 0.2512s/iter; left time: 8103.9107s
	iters: 200, epoch: 32 | loss: 0.0005009
	speed: 0.0638s/iter; left time: 2052.6488s
	iters: 300, epoch: 32 | loss: 0.1060091
	speed: 0.0644s/iter; left time: 2065.3222s
	iters: 400, epoch: 32 | loss: 0.0535112
	speed: 0.0689s/iter; left time: 2200.6096s
Epoch: 32 cost time: 30.80276131629944
Epoch: 32, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0008761
	speed: 0.2654s/iter; left time: 8437.0865s
	iters: 200, epoch: 33 | loss: 0.1253356
	speed: 0.0693s/iter; left time: 2195.3630s
	iters: 300, epoch: 33 | loss: 0.0112789
	speed: 0.0649s/iter; left time: 2050.1173s
	iters: 400, epoch: 33 | loss: 0.0005076
	speed: 0.0657s/iter; left time: 2070.5045s
Epoch: 33 cost time: 31.177223682403564
Epoch: 33, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0030128
	speed: 0.2686s/iter; left time: 8412.3715s
	iters: 200, epoch: 34 | loss: 0.0022669
	speed: 0.0644s/iter; left time: 2009.3055s
	iters: 300, epoch: 34 | loss: 0.0001765
	speed: 0.0616s/iter; left time: 1916.0781s
	iters: 400, epoch: 34 | loss: 0.0136737
	speed: 0.0626s/iter; left time: 1942.1473s
Epoch: 34 cost time: 30.362627267837524
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0002849
	speed: 0.2644s/iter; left time: 8157.1013s
	iters: 200, epoch: 35 | loss: 0.0870659
	speed: 0.0582s/iter; left time: 1788.7728s
	iters: 300, epoch: 35 | loss: 0.0065532
	speed: 0.0628s/iter; left time: 1923.8110s
	iters: 400, epoch: 35 | loss: 0.0175271
	speed: 0.0627s/iter; left time: 1916.7224s
Epoch: 35 cost time: 29.347200632095337
Epoch: 35, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0028444
	speed: 0.2708s/iter; left time: 8227.2714s
	iters: 200, epoch: 36 | loss: 0.0000080
	speed: 0.0624s/iter; left time: 1888.4751s
	iters: 300, epoch: 36 | loss: 0.0000179
	speed: 0.0603s/iter; left time: 1819.3379s
	iters: 400, epoch: 36 | loss: 0.0116417
	speed: 0.0615s/iter; left time: 1849.6179s
Epoch: 36 cost time: 29.398335456848145
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0037486
	speed: 0.2759s/iter; left time: 8254.2147s
	iters: 200, epoch: 37 | loss: 0.0002842
	speed: 0.0607s/iter; left time: 1809.9488s
	iters: 300, epoch: 37 | loss: 0.0057388
	speed: 0.0621s/iter; left time: 1844.8402s
	iters: 400, epoch: 37 | loss: 0.0120435
	speed: 0.0624s/iter; left time: 1848.0082s
Epoch: 37 cost time: 29.63861393928528
Epoch: 37, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 2787082
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3044653
	speed: 0.0751s/iter; left time: 3514.4141s
	iters: 200, epoch: 1 | loss: 2.3063087
	speed: 0.0643s/iter; left time: 3001.1986s
	iters: 300, epoch: 1 | loss: 2.3024769
	speed: 0.0625s/iter; left time: 2913.6158s
	iters: 400, epoch: 1 | loss: 2.3034096
	speed: 0.0671s/iter; left time: 3120.9787s
Epoch: 1 cost time: 31.749759435653687
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3004055
	speed: 0.2670s/iter; left time: 12368.6121s
	iters: 200, epoch: 2 | loss: 2.2997186
	speed: 0.0661s/iter; left time: 3056.7670s
	iters: 300, epoch: 2 | loss: 2.3088927
	speed: 0.0635s/iter; left time: 2927.1406s
	iters: 400, epoch: 2 | loss: 2.2972925
	speed: 0.0632s/iter; left time: 2907.4647s
Epoch: 2 cost time: 30.445276975631714
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3020823
	speed: 0.2478s/iter; left time: 11363.0764s
	iters: 200, epoch: 3 | loss: 2.3046174
	speed: 0.0523s/iter; left time: 2393.6372s
	iters: 300, epoch: 3 | loss: 2.2984750
	speed: 0.0490s/iter; left time: 2235.8426s
	iters: 400, epoch: 3 | loss: 2.3005545
	speed: 0.0460s/iter; left time: 2094.4853s
Epoch: 3 cost time: 24.27767539024353
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2931113
	speed: 0.1646s/iter; left time: 7469.8030s
	iters: 200, epoch: 4 | loss: 2.3130007
	speed: 0.0472s/iter; left time: 2137.3806s
	iters: 300, epoch: 4 | loss: 2.3001778
	speed: 0.0457s/iter; left time: 2066.4641s
	iters: 400, epoch: 4 | loss: 2.2945538
	speed: 0.0470s/iter; left time: 2119.4032s
Epoch: 4 cost time: 23.070056915283203
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3061097
	speed: 0.2675s/iter; left time: 12017.6138s
	iters: 200, epoch: 5 | loss: 2.3126395
	speed: 0.0637s/iter; left time: 2854.8064s
	iters: 300, epoch: 5 | loss: 2.3052006
	speed: 0.0623s/iter; left time: 2785.5122s
	iters: 400, epoch: 5 | loss: 2.3070960
	speed: 0.0663s/iter; left time: 2959.9891s
Epoch: 5 cost time: 30.500049114227295
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3023942
	speed: 0.2752s/iter; left time: 12234.9736s
	iters: 200, epoch: 6 | loss: 2.3090832
	speed: 0.0624s/iter; left time: 2767.5527s
	iters: 300, epoch: 6 | loss: 2.2981048
	speed: 0.0631s/iter; left time: 2790.9615s
	iters: 400, epoch: 6 | loss: 2.3084466
	speed: 0.0599s/iter; left time: 2645.1179s
Epoch: 6 cost time: 29.34725546836853
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2785680
	speed: 0.2544s/iter; left time: 11188.5400s
	iters: 200, epoch: 7 | loss: 2.3125823
	speed: 0.0606s/iter; left time: 2658.9621s
	iters: 300, epoch: 7 | loss: 2.2893324
	speed: 0.0596s/iter; left time: 2609.0118s
	iters: 400, epoch: 7 | loss: 2.2833662
	speed: 0.0650s/iter; left time: 2839.8597s
Epoch: 7 cost time: 29.564968585968018
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3068986
	speed: 0.2784s/iter; left time: 12116.4254s
	iters: 200, epoch: 8 | loss: 2.2985630
	speed: 0.0622s/iter; left time: 2702.6403s
	iters: 300, epoch: 8 | loss: 2.3205061
	speed: 0.0624s/iter; left time: 2702.6048s
	iters: 400, epoch: 8 | loss: 2.3111625
	speed: 0.0649s/iter; left time: 2804.2512s
Epoch: 8 cost time: 29.775657653808594
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2945910
	speed: 0.2648s/iter; left time: 11398.6287s
	iters: 200, epoch: 9 | loss: 2.2864420
	speed: 0.0622s/iter; left time: 2671.0464s
	iters: 300, epoch: 9 | loss: 2.3102293
	speed: 0.0623s/iter; left time: 2670.0830s
	iters: 400, epoch: 9 | loss: 2.2997246
	speed: 0.0639s/iter; left time: 2731.8496s
Epoch: 9 cost time: 29.321340799331665
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2990727
	speed: 0.2669s/iter; left time: 11365.6561s
	iters: 200, epoch: 10 | loss: 2.3082004
	speed: 0.0601s/iter; left time: 2551.9428s
	iters: 300, epoch: 10 | loss: 2.3209715
	speed: 0.0600s/iter; left time: 2542.7624s
	iters: 400, epoch: 10 | loss: 2.2895622
	speed: 0.0591s/iter; left time: 2498.6110s
Epoch: 10 cost time: 28.537837982177734
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3018222
	speed: 0.2682s/iter; left time: 11292.1092s
	iters: 200, epoch: 11 | loss: 2.2926900
	speed: 0.0604s/iter; left time: 2536.5776s
	iters: 300, epoch: 11 | loss: 2.2924314
	speed: 0.0617s/iter; left time: 2587.1593s
	iters: 400, epoch: 11 | loss: 2.2908382
	speed: 0.0618s/iter; left time: 2585.1500s
Epoch: 11 cost time: 29.807947635650635
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3128054
	speed: 0.2795s/iter; left time: 11637.3434s
	iters: 200, epoch: 12 | loss: 2.2909820
	speed: 0.0644s/iter; left time: 2675.4358s
	iters: 300, epoch: 12 | loss: 2.3091958
	speed: 0.0616s/iter; left time: 2552.2231s
	iters: 400, epoch: 12 | loss: 2.3246498
	speed: 0.0633s/iter; left time: 2616.0261s
Epoch: 12 cost time: 30.189931869506836
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2970014
	speed: 0.2706s/iter; left time: 11140.7611s
	iters: 200, epoch: 13 | loss: 2.3022659
	speed: 0.0586s/iter; left time: 2405.8939s
	iters: 300, epoch: 13 | loss: 2.3157046
	speed: 0.0596s/iter; left time: 2440.9848s
	iters: 400, epoch: 13 | loss: 2.2850189
	speed: 0.0591s/iter; left time: 2416.7093s
Epoch: 13 cost time: 28.659250736236572
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2992544
	speed: 0.2799s/iter; left time: 11393.7905s
	iters: 200, epoch: 14 | loss: 2.3151438
	speed: 0.0602s/iter; left time: 2446.1337s
	iters: 300, epoch: 14 | loss: 2.3056300
	speed: 0.0625s/iter; left time: 2529.7848s
	iters: 400, epoch: 14 | loss: 2.2974529
	speed: 0.0602s/iter; left time: 2430.8452s
Epoch: 14 cost time: 29.90834140777588
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3003144
	speed: 0.2795s/iter; left time: 11247.4110s
	iters: 200, epoch: 15 | loss: 2.3094778
	speed: 0.0637s/iter; left time: 2557.5703s
	iters: 300, epoch: 15 | loss: 2.2988744
	speed: 0.0640s/iter; left time: 2562.6260s
	iters: 400, epoch: 15 | loss: 2.2896082
	speed: 0.0616s/iter; left time: 2458.3179s
Epoch: 15 cost time: 29.865309238433838
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3024371
	speed: 0.2498s/iter; left time: 9933.2751s
	iters: 200, epoch: 16 | loss: 2.3063517
	speed: 0.0595s/iter; left time: 2358.4883s
	iters: 300, epoch: 16 | loss: 2.2994175
	speed: 0.0591s/iter; left time: 2337.0892s
	iters: 400, epoch: 16 | loss: 2.2894869
	speed: 0.0607s/iter; left time: 2396.7658s
Epoch: 16 cost time: 28.918421268463135
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3152592
	speed: 0.2833s/iter; left time: 11130.9314s
	iters: 200, epoch: 17 | loss: 2.3167210
	speed: 0.0651s/iter; left time: 2551.9415s
	iters: 300, epoch: 17 | loss: 2.3000722
	speed: 0.0623s/iter; left time: 2434.3929s
	iters: 400, epoch: 17 | loss: 2.2941387
	speed: 0.0611s/iter; left time: 2381.0498s
Epoch: 17 cost time: 30.674482822418213
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.3001039
	speed: 0.2793s/iter; left time: 10845.7530s
	iters: 200, epoch: 18 | loss: 2.2849863
	speed: 0.0624s/iter; left time: 2415.3603s
	iters: 300, epoch: 18 | loss: 2.3038695
	speed: 0.0623s/iter; left time: 2404.9246s
	iters: 400, epoch: 18 | loss: 2.3176579
	speed: 0.0568s/iter; left time: 2186.7404s
Epoch: 18 cost time: 29.32437825202942
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.3050935
	speed: 0.2613s/iter; left time: 10021.9201s
	iters: 200, epoch: 19 | loss: 2.2953427
	speed: 0.0611s/iter; left time: 2338.4146s
	iters: 300, epoch: 19 | loss: 2.3139381
	speed: 0.0615s/iter; left time: 2347.5835s
	iters: 400, epoch: 19 | loss: 2.2946582
	speed: 0.0625s/iter; left time: 2378.7822s
Epoch: 19 cost time: 29.89566993713379
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3136611
	speed: 0.2822s/iter; left time: 10690.9683s
	iters: 200, epoch: 20 | loss: 2.2940407
	speed: 0.0663s/iter; left time: 2506.1330s
	iters: 300, epoch: 20 | loss: 2.2852592
	speed: 0.0627s/iter; left time: 2361.7121s
	iters: 400, epoch: 20 | loss: 2.3093960
	speed: 0.0629s/iter; left time: 2364.1648s
Epoch: 20 cost time: 30.476466178894043
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.2975090
	speed: 0.2643s/iter; left time: 9888.8000s
	iters: 200, epoch: 21 | loss: 2.3149307
	speed: 0.0638s/iter; left time: 2379.8265s
	iters: 300, epoch: 21 | loss: 2.2959006
	speed: 0.0645s/iter; left time: 2402.1443s
	iters: 400, epoch: 21 | loss: 2.2928040
	speed: 0.0633s/iter; left time: 2347.9608s
Epoch: 21 cost time: 29.978077173233032
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.2896466
	speed: 0.2692s/iter; left time: 9946.9618s
	iters: 200, epoch: 22 | loss: 2.3138094
	speed: 0.0620s/iter; left time: 2284.6357s
	iters: 300, epoch: 22 | loss: 2.3092806
	speed: 0.0581s/iter; left time: 2136.1282s
	iters: 400, epoch: 22 | loss: 2.2908907
	speed: 0.0619s/iter; left time: 2270.0281s
Epoch: 22 cost time: 29.29530668258667
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 2787082
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4903517
	speed: 0.0802s/iter; left time: 3753.2253s
	iters: 200, epoch: 1 | loss: 0.1147345
	speed: 0.0605s/iter; left time: 2827.4460s
	iters: 300, epoch: 1 | loss: 0.1083248
	speed: 0.0650s/iter; left time: 3029.3964s
	iters: 400, epoch: 1 | loss: 0.0499713
	speed: 0.0665s/iter; left time: 3094.1361s
Epoch: 1 cost time: 31.91852879524231
Epoch: 1, Steps: 469 | Train Loss: 0.394 Vali Loss: 0.220 Vali Acc: 0.923 Test Loss: 0.220 Test Acc: 0.923
Validation loss decreased (inf --> -0.923097).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2058062
	speed: 0.2704s/iter; left time: 12526.0831s
	iters: 200, epoch: 2 | loss: 0.1456147
	speed: 0.0660s/iter; left time: 3050.1230s
	iters: 300, epoch: 2 | loss: 0.0196094
	speed: 0.0660s/iter; left time: 3044.0212s
	iters: 400, epoch: 2 | loss: 0.1827075
	speed: 0.0661s/iter; left time: 3041.6486s
Epoch: 2 cost time: 31.041701316833496
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
Validation loss decreased (-0.923097 --> -0.947397).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0631984
	speed: 0.2652s/iter; left time: 12160.7855s
	iters: 200, epoch: 3 | loss: 0.0204421
	speed: 0.0662s/iter; left time: 3030.4380s
	iters: 300, epoch: 3 | loss: 0.2908086
	speed: 0.0702s/iter; left time: 3203.9284s
	iters: 400, epoch: 3 | loss: 0.0113370
	speed: 0.0658s/iter; left time: 2998.9131s
Epoch: 3 cost time: 31.083442211151123
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0017175
	speed: 0.2636s/iter; left time: 11965.6734s
	iters: 200, epoch: 4 | loss: 0.2453805
	speed: 0.0648s/iter; left time: 2935.9946s
	iters: 300, epoch: 4 | loss: 0.0085299
	speed: 0.0696s/iter; left time: 3147.2856s
	iters: 400, epoch: 4 | loss: 0.0618198
	speed: 0.0673s/iter; left time: 3034.2628s
Epoch: 4 cost time: 31.38874864578247
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
Validation loss decreased (-0.947397 --> -0.955687).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0024082
	speed: 0.2754s/iter; left time: 12374.1450s
	iters: 200, epoch: 5 | loss: 0.1848800
	speed: 0.0662s/iter; left time: 2969.4641s
	iters: 300, epoch: 5 | loss: 0.5036077
	speed: 0.0679s/iter; left time: 3034.6307s
	iters: 400, epoch: 5 | loss: 0.0285876
	speed: 0.0627s/iter; left time: 2798.0030s
Epoch: 5 cost time: 30.931541919708252
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.955687 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3027033
	speed: 0.2679s/iter; left time: 11909.5416s
	iters: 200, epoch: 6 | loss: 0.1977164
	speed: 0.0590s/iter; left time: 2615.9880s
	iters: 300, epoch: 6 | loss: 0.0842242
	speed: 0.0664s/iter; left time: 2937.7922s
	iters: 400, epoch: 6 | loss: 0.0906992
	speed: 0.0699s/iter; left time: 3087.5081s
Epoch: 6 cost time: 30.946501970291138
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0109783
	speed: 0.2765s/iter; left time: 12162.7606s
	iters: 200, epoch: 7 | loss: 0.0023235
	speed: 0.0654s/iter; left time: 2872.1736s
	iters: 300, epoch: 7 | loss: 0.0208543
	speed: 0.0693s/iter; left time: 3036.4554s
	iters: 400, epoch: 7 | loss: 0.0130373
	speed: 0.0666s/iter; left time: 2910.0135s
Epoch: 7 cost time: 31.37824773788452
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0068078
	speed: 0.2712s/iter; left time: 11803.2451s
	iters: 200, epoch: 8 | loss: 0.0014574
	speed: 0.0648s/iter; left time: 2813.6128s
	iters: 300, epoch: 8 | loss: 0.0315217
	speed: 0.0655s/iter; left time: 2838.3768s
	iters: 400, epoch: 8 | loss: 0.0027039
	speed: 0.0665s/iter; left time: 2874.4736s
Epoch: 8 cost time: 31.019782304763794
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.973412).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0013643
	speed: 0.2495s/iter; left time: 10741.1876s
	iters: 200, epoch: 9 | loss: 0.2207465
	speed: 0.0567s/iter; left time: 2433.5470s
	iters: 300, epoch: 9 | loss: 0.0001354
	speed: 0.0530s/iter; left time: 2270.8028s
	iters: 400, epoch: 9 | loss: 0.0252764
	speed: 0.0552s/iter; left time: 2358.9242s
Epoch: 9 cost time: 26.295611143112183
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.973412 --> -0.980845).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0680396
	speed: 0.2313s/iter; left time: 9848.2942s
	iters: 200, epoch: 10 | loss: 0.0006703
	speed: 0.0641s/iter; left time: 2722.4704s
	iters: 300, epoch: 10 | loss: 0.0005414
	speed: 0.0684s/iter; left time: 2896.7373s
	iters: 400, epoch: 10 | loss: 0.0017492
	speed: 0.0667s/iter; left time: 2821.8518s
Epoch: 10 cost time: 30.90116858482361
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3115482
	speed: 0.2779s/iter; left time: 11702.3244s
	iters: 200, epoch: 11 | loss: 0.0290889
	speed: 0.0601s/iter; left time: 2526.6180s
	iters: 300, epoch: 11 | loss: 0.0131377
	speed: 0.0641s/iter; left time: 2686.6085s
	iters: 400, epoch: 11 | loss: 0.0692194
	speed: 0.0634s/iter; left time: 2651.4349s
Epoch: 11 cost time: 30.073339223861694
Epoch: 11, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0024120
	speed: 0.2629s/iter; left time: 10949.2910s
	iters: 200, epoch: 12 | loss: 0.1077743
	speed: 0.0610s/iter; left time: 2532.2843s
	iters: 300, epoch: 12 | loss: 0.0147558
	speed: 0.0654s/iter; left time: 2711.4884s
	iters: 400, epoch: 12 | loss: 0.0077600
	speed: 0.0653s/iter; left time: 2697.6257s
Epoch: 12 cost time: 30.472106456756592
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0023940
	speed: 0.2708s/iter; left time: 11147.6975s
	iters: 200, epoch: 13 | loss: 0.0052146
	speed: 0.0645s/iter; left time: 2648.7285s
	iters: 300, epoch: 13 | loss: 0.0640461
	speed: 0.0694s/iter; left time: 2842.5286s
	iters: 400, epoch: 13 | loss: 0.0276320
	speed: 0.0727s/iter; left time: 2971.1204s
Epoch: 13 cost time: 31.99193239212036
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000280
	speed: 0.2727s/iter; left time: 11099.1493s
	iters: 200, epoch: 14 | loss: 0.0692073
	speed: 0.0622s/iter; left time: 2524.9281s
	iters: 300, epoch: 14 | loss: 0.1036425
	speed: 0.0676s/iter; left time: 2739.6268s
	iters: 400, epoch: 14 | loss: 0.0000779
	speed: 0.0670s/iter; left time: 2705.5685s
Epoch: 14 cost time: 30.90094828605652
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0332107
	speed: 0.2476s/iter; left time: 9961.8632s
	iters: 200, epoch: 15 | loss: 0.0014494
	speed: 0.0622s/iter; left time: 2495.0414s
	iters: 300, epoch: 15 | loss: 0.0066422
	speed: 0.0653s/iter; left time: 2616.1514s
	iters: 400, epoch: 15 | loss: 0.0000654
	speed: 0.0670s/iter; left time: 2675.6364s
Epoch: 15 cost time: 30.7293758392334
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0075613
	speed: 0.2801s/iter; left time: 11138.1535s
	iters: 200, epoch: 16 | loss: 0.0184470
	speed: 0.0630s/iter; left time: 2498.2904s
	iters: 300, epoch: 16 | loss: 0.0001069
	speed: 0.0658s/iter; left time: 2604.9510s
	iters: 400, epoch: 16 | loss: 0.0041377
	speed: 0.0600s/iter; left time: 2368.5284s
Epoch: 16 cost time: 29.809485912322998
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0375940
	speed: 0.2749s/iter; left time: 10802.1902s
	iters: 200, epoch: 17 | loss: 0.1338447
	speed: 0.0646s/iter; left time: 2530.2973s
	iters: 300, epoch: 17 | loss: 0.0006000
	speed: 0.0633s/iter; left time: 2473.4584s
	iters: 400, epoch: 17 | loss: 0.0093000
	speed: 0.0615s/iter; left time: 2397.4644s
Epoch: 17 cost time: 30.354102849960327
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0009457
	speed: 0.2663s/iter; left time: 10339.9146s
	iters: 200, epoch: 18 | loss: 0.4290283
	speed: 0.0596s/iter; left time: 2309.0796s
	iters: 300, epoch: 18 | loss: 0.0021749
	speed: 0.0591s/iter; left time: 2283.7233s
	iters: 400, epoch: 18 | loss: 0.0002465
	speed: 0.0622s/iter; left time: 2396.5308s
Epoch: 18 cost time: 29.14254856109619
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0665581
	speed: 0.2775s/iter; left time: 10645.6294s
	iters: 200, epoch: 19 | loss: 0.0001810
	speed: 0.0681s/iter; left time: 2606.2337s
	iters: 300, epoch: 19 | loss: 0.0015074
	speed: 0.0651s/iter; left time: 2483.0382s
	iters: 400, epoch: 19 | loss: 0.0006528
	speed: 0.0634s/iter; left time: 2412.3693s
Epoch: 19 cost time: 30.81907367706299
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 2000650
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5741073
	speed: 0.0747s/iter; left time: 3497.9200s
	iters: 200, epoch: 1 | loss: 0.2314316
	speed: 0.0650s/iter; left time: 3034.4705s
	iters: 300, epoch: 1 | loss: 0.1468383
	speed: 0.0640s/iter; left time: 2984.2172s
	iters: 400, epoch: 1 | loss: 0.0597085
	speed: 0.0647s/iter; left time: 3008.1400s
Epoch: 1 cost time: 31.55170440673828
Epoch: 1, Steps: 469 | Train Loss: 0.439 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (inf --> -0.941965).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2665355
	speed: 0.2641s/iter; left time: 12235.5218s
	iters: 200, epoch: 2 | loss: 0.1632673
	speed: 0.0626s/iter; left time: 2896.4018s
	iters: 300, epoch: 2 | loss: 0.0449460
	speed: 0.0683s/iter; left time: 3151.8846s
	iters: 400, epoch: 2 | loss: 0.0581986
	speed: 0.0680s/iter; left time: 3131.9851s
Epoch: 2 cost time: 31.291257619857788
Epoch: 2, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.941965 --> -0.953972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0851739
	speed: 0.2698s/iter; left time: 12373.3706s
	iters: 200, epoch: 3 | loss: 0.1224894
	speed: 0.0660s/iter; left time: 3021.0924s
	iters: 300, epoch: 3 | loss: 0.1117436
	speed: 0.0669s/iter; left time: 3054.3684s
	iters: 400, epoch: 3 | loss: 0.0471767
	speed: 0.0666s/iter; left time: 3035.2477s
Epoch: 3 cost time: 31.450109481811523
Epoch: 3, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.316 Vali Acc: 0.915 Test Loss: 0.316 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0071714
	speed: 0.2676s/iter; left time: 12149.4934s
	iters: 200, epoch: 4 | loss: 0.0377261
	speed: 0.0607s/iter; left time: 2748.7362s
	iters: 300, epoch: 4 | loss: 0.0234161
	speed: 0.0598s/iter; left time: 2700.3892s
	iters: 400, epoch: 4 | loss: 0.2748550
	speed: 0.0612s/iter; left time: 2759.7497s
Epoch: 4 cost time: 28.85732626914978
Epoch: 4, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
Validation loss decreased (-0.953972 --> -0.955116).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0132023
	speed: 0.2440s/iter; left time: 10962.5335s
	iters: 200, epoch: 5 | loss: 0.2655029
	speed: 0.0614s/iter; left time: 2754.3646s
	iters: 300, epoch: 5 | loss: 0.5821674
	speed: 0.0650s/iter; left time: 2907.7869s
	iters: 400, epoch: 5 | loss: 0.0394923
	speed: 0.0663s/iter; left time: 2957.9424s
Epoch: 5 cost time: 29.977585315704346
Epoch: 5, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0796072
	speed: 0.2798s/iter; left time: 12440.8568s
	iters: 200, epoch: 6 | loss: 0.0630537
	speed: 0.0620s/iter; left time: 2750.9168s
	iters: 300, epoch: 6 | loss: 0.1745252
	speed: 0.0685s/iter; left time: 3029.7872s
	iters: 400, epoch: 6 | loss: 0.1241014
	speed: 0.0656s/iter; left time: 2896.5472s
Epoch: 6 cost time: 30.764731645584106
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2781348
	speed: 0.2608s/iter; left time: 11469.6168s
	iters: 200, epoch: 7 | loss: 0.0084966
	speed: 0.0590s/iter; left time: 2588.7627s
	iters: 300, epoch: 7 | loss: 0.0934586
	speed: 0.0617s/iter; left time: 2700.0121s
	iters: 400, epoch: 7 | loss: 0.1275533
	speed: 0.0632s/iter; left time: 2762.7073s
Epoch: 7 cost time: 28.859590768814087
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5034415
	speed: 0.2550s/iter; left time: 11098.3191s
	iters: 200, epoch: 8 | loss: 0.0057453
	speed: 0.0607s/iter; left time: 2634.8701s
	iters: 300, epoch: 8 | loss: 0.0033613
	speed: 0.0661s/iter; left time: 2862.2947s
	iters: 400, epoch: 8 | loss: 0.1353841
	speed: 0.0653s/iter; left time: 2820.7136s
Epoch: 8 cost time: 29.7070209980011
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.250 Vali Acc: 0.934 Test Loss: 0.250 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0194557
	speed: 0.2583s/iter; left time: 11117.8594s
	iters: 200, epoch: 9 | loss: 0.0396489
	speed: 0.0608s/iter; left time: 2609.2581s
	iters: 300, epoch: 9 | loss: 0.0703693
	speed: 0.0613s/iter; left time: 2625.7597s
	iters: 400, epoch: 9 | loss: 0.0126979
	speed: 0.0620s/iter; left time: 2648.3435s
Epoch: 9 cost time: 29.32316279411316
Epoch: 9, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.955116 --> -0.964550).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4267769
	speed: 0.2829s/iter; left time: 12046.4337s
	iters: 200, epoch: 10 | loss: 0.0094127
	speed: 0.0637s/iter; left time: 2705.3974s
	iters: 300, epoch: 10 | loss: 0.0108733
	speed: 0.0633s/iter; left time: 2681.6304s
	iters: 400, epoch: 10 | loss: 0.0351346
	speed: 0.0666s/iter; left time: 2817.5429s
Epoch: 10 cost time: 30.825525522232056
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1112135
	speed: 0.2621s/iter; left time: 11037.8038s
	iters: 200, epoch: 11 | loss: 0.0745961
	speed: 0.0586s/iter; left time: 2460.1231s
	iters: 300, epoch: 11 | loss: 0.0020337
	speed: 0.0579s/iter; left time: 2427.5701s
	iters: 400, epoch: 11 | loss: 0.0411546
	speed: 0.0566s/iter; left time: 2368.3760s
Epoch: 11 cost time: 26.696484804153442
Epoch: 11, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0055625
	speed: 0.1664s/iter; left time: 6927.4586s
	iters: 200, epoch: 12 | loss: 0.0073741
	speed: 0.0516s/iter; left time: 2144.7955s
	iters: 300, epoch: 12 | loss: 0.0123778
	speed: 0.0614s/iter; left time: 2545.1973s
	iters: 400, epoch: 12 | loss: 0.0028581
	speed: 0.0639s/iter; left time: 2641.1019s
Epoch: 12 cost time: 27.984435319900513
Epoch: 12, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.966551).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3614127
	speed: 0.2809s/iter; left time: 11564.1849s
	iters: 200, epoch: 13 | loss: 0.1069979
	speed: 0.0639s/iter; left time: 2623.7482s
	iters: 300, epoch: 13 | loss: 0.0518110
	speed: 0.0616s/iter; left time: 2523.8817s
	iters: 400, epoch: 13 | loss: 0.0213629
	speed: 0.0604s/iter; left time: 2467.4909s
Epoch: 13 cost time: 30.200406074523926
Epoch: 13, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.966551 --> -0.975128).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0544970
	speed: 0.2817s/iter; left time: 11466.6665s
	iters: 200, epoch: 14 | loss: 0.2719139
	speed: 0.0606s/iter; left time: 2461.6964s
	iters: 300, epoch: 14 | loss: 0.0121833
	speed: 0.0611s/iter; left time: 2475.8095s
	iters: 400, epoch: 14 | loss: 0.0001711
	speed: 0.0596s/iter; left time: 2409.8794s
Epoch: 14 cost time: 29.088480949401855
Epoch: 14, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0856445
	speed: 0.2447s/iter; left time: 9846.7144s
	iters: 200, epoch: 15 | loss: 0.0083990
	speed: 0.0612s/iter; left time: 2455.6164s
	iters: 300, epoch: 15 | loss: 0.0019000
	speed: 0.0604s/iter; left time: 2416.5085s
	iters: 400, epoch: 15 | loss: 0.0000488
	speed: 0.0604s/iter; left time: 2413.8773s
Epoch: 15 cost time: 29.169795989990234
Epoch: 15, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0418338
	speed: 0.2692s/iter; left time: 10704.5592s
	iters: 200, epoch: 16 | loss: 0.0008171
	speed: 0.0635s/iter; left time: 2519.4656s
	iters: 300, epoch: 16 | loss: 0.0020925
	speed: 0.0652s/iter; left time: 2581.1643s
	iters: 400, epoch: 16 | loss: 0.0201073
	speed: 0.0658s/iter; left time: 2594.9219s
Epoch: 16 cost time: 30.449652910232544
Epoch: 16, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0006937
	speed: 0.2842s/iter; left time: 11166.2535s
	iters: 200, epoch: 17 | loss: 0.0040792
	speed: 0.0642s/iter; left time: 2514.8649s
	iters: 300, epoch: 17 | loss: 0.0236151
	speed: 0.0592s/iter; left time: 2315.4096s
	iters: 400, epoch: 17 | loss: 0.0052843
	speed: 0.0579s/iter; left time: 2258.8571s
Epoch: 17 cost time: 28.8130145072937
Epoch: 17, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0020948
	speed: 0.2609s/iter; left time: 10128.8427s
	iters: 200, epoch: 18 | loss: 0.4166974
	speed: 0.0591s/iter; left time: 2289.0940s
	iters: 300, epoch: 18 | loss: 0.1168762
	speed: 0.0607s/iter; left time: 2345.1099s
	iters: 400, epoch: 18 | loss: 0.0029063
	speed: 0.0605s/iter; left time: 2332.3455s
Epoch: 18 cost time: 28.703045129776
Epoch: 18, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0010962
	speed: 0.2582s/iter; left time: 9902.5695s
	iters: 200, epoch: 19 | loss: 0.0001332
	speed: 0.0629s/iter; left time: 2405.5101s
	iters: 300, epoch: 19 | loss: 0.0002653
	speed: 0.0630s/iter; left time: 2405.9045s
	iters: 400, epoch: 19 | loss: 0.0085127
	speed: 0.0623s/iter; left time: 2372.2227s
Epoch: 19 cost time: 29.41774892807007
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0003118
	speed: 0.2762s/iter; left time: 10463.5976s
	iters: 200, epoch: 20 | loss: 0.0678338
	speed: 0.0643s/iter; left time: 2430.0083s
	iters: 300, epoch: 20 | loss: 0.0112761
	speed: 0.0559s/iter; left time: 2107.9985s
	iters: 400, epoch: 20 | loss: 0.0044033
	speed: 0.0596s/iter; left time: 2241.6324s
Epoch: 20 cost time: 29.034338235855103
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0187542
	speed: 0.2649s/iter; left time: 9911.8633s
	iters: 200, epoch: 21 | loss: 0.0013975
	speed: 0.0615s/iter; left time: 2295.9512s
	iters: 300, epoch: 21 | loss: 0.0144278
	speed: 0.0618s/iter; left time: 2300.2417s
	iters: 400, epoch: 21 | loss: 0.0001640
	speed: 0.0594s/iter; left time: 2204.3382s
Epoch: 21 cost time: 29.34675693511963
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0105380
	speed: 0.2610s/iter; left time: 9645.4363s
	iters: 200, epoch: 22 | loss: 0.0020455
	speed: 0.0645s/iter; left time: 2377.1210s
	iters: 300, epoch: 22 | loss: 0.2350342
	speed: 0.0615s/iter; left time: 2260.3839s
	iters: 400, epoch: 22 | loss: 0.0012497
	speed: 0.0611s/iter; left time: 2240.9445s
Epoch: 22 cost time: 29.61817502975464
Epoch: 22, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.315 Vali Acc: 0.943 Test Loss: 0.315 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0245613
	speed: 0.2757s/iter; left time: 10058.2448s
	iters: 200, epoch: 23 | loss: 0.0379181
	speed: 0.0626s/iter; left time: 2277.5510s
	iters: 300, epoch: 23 | loss: 0.0282107
	speed: 0.0610s/iter; left time: 2213.1517s
	iters: 400, epoch: 23 | loss: 0.0023054
	speed: 0.0601s/iter; left time: 2175.6595s
Epoch: 23 cost time: 29.60361409187317
Epoch: 23, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 2000650
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5197104
	speed: 0.0779s/iter; left time: 3647.8430s
	iters: 200, epoch: 1 | loss: 0.1717063
	speed: 0.0635s/iter; left time: 2963.7568s
	iters: 300, epoch: 1 | loss: 0.0970695
	speed: 0.0639s/iter; left time: 2977.7431s
	iters: 400, epoch: 1 | loss: 0.0559253
	speed: 0.0630s/iter; left time: 2930.6687s
Epoch: 1 cost time: 31.34687614440918
Epoch: 1, Steps: 469 | Train Loss: 0.416 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (inf --> -0.945682).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2254048
	speed: 0.2656s/iter; left time: 12308.0316s
	iters: 200, epoch: 2 | loss: 0.0948736
	speed: 0.0618s/iter; left time: 2857.2712s
	iters: 300, epoch: 2 | loss: 0.0358119
	speed: 0.0628s/iter; left time: 2897.5556s
	iters: 400, epoch: 2 | loss: 0.2127232
	speed: 0.0659s/iter; left time: 3033.3423s
Epoch: 2 cost time: 30.136226415634155
Epoch: 2, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0107726
	speed: 0.2764s/iter; left time: 12675.0376s
	iters: 200, epoch: 3 | loss: 0.0875263
	speed: 0.0602s/iter; left time: 2755.2323s
	iters: 300, epoch: 3 | loss: 0.0158513
	speed: 0.0611s/iter; left time: 2787.9872s
	iters: 400, epoch: 3 | loss: 0.0217051
	speed: 0.0652s/iter; left time: 2972.8948s
Epoch: 3 cost time: 29.97588586807251
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
Validation loss decreased (-0.945682 --> -0.953115).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0472916
	speed: 0.2666s/iter; left time: 12103.6941s
	iters: 200, epoch: 4 | loss: 0.0311586
	speed: 0.0582s/iter; left time: 2636.3791s
	iters: 300, epoch: 4 | loss: 0.0033565
	speed: 0.0665s/iter; left time: 3006.1494s
	iters: 400, epoch: 4 | loss: 0.2096935
	speed: 0.0690s/iter; left time: 3110.3769s
Epoch: 4 cost time: 30.771629571914673
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.953115 --> -0.961691).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0087188
	speed: 0.2605s/iter; left time: 11702.4019s
	iters: 200, epoch: 5 | loss: 0.1841368
	speed: 0.0652s/iter; left time: 2920.5112s
	iters: 300, epoch: 5 | loss: 0.4363743
	speed: 0.0675s/iter; left time: 3018.7755s
	iters: 400, epoch: 5 | loss: 0.0468462
	speed: 0.0712s/iter; left time: 3176.8561s
Epoch: 5 cost time: 31.928524017333984
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1523098
	speed: 0.2815s/iter; left time: 12515.6548s
	iters: 200, epoch: 6 | loss: 0.1265886
	speed: 0.0682s/iter; left time: 3024.0601s
	iters: 300, epoch: 6 | loss: 0.0071815
	speed: 0.0662s/iter; left time: 2930.8057s
	iters: 400, epoch: 6 | loss: 0.0244058
	speed: 0.0632s/iter; left time: 2788.5795s
Epoch: 6 cost time: 31.123916387557983
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0031526
	speed: 0.2649s/iter; left time: 11653.0543s
	iters: 200, epoch: 7 | loss: 0.0004461
	speed: 0.0692s/iter; left time: 3038.2154s
	iters: 300, epoch: 7 | loss: 0.0300344
	speed: 0.0710s/iter; left time: 3110.3682s
	iters: 400, epoch: 7 | loss: 0.0549231
	speed: 0.0712s/iter; left time: 3109.9445s
Epoch: 7 cost time: 33.02986288070679
Epoch: 7, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.961691 --> -0.973698).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2905644
	speed: 0.2690s/iter; left time: 11704.3437s
	iters: 200, epoch: 8 | loss: 0.0006053
	speed: 0.0673s/iter; left time: 2922.7432s
	iters: 300, epoch: 8 | loss: 0.4272234
	speed: 0.0693s/iter; left time: 3003.1287s
	iters: 400, epoch: 8 | loss: 0.0891998
	speed: 0.0694s/iter; left time: 2998.5827s
Epoch: 8 cost time: 31.966175317764282
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3287399
	speed: 0.2696s/iter; left time: 11607.3855s
	iters: 200, epoch: 9 | loss: 0.0015440
	speed: 0.0618s/iter; left time: 2654.8434s
	iters: 300, epoch: 9 | loss: 0.0036160
	speed: 0.0660s/iter; left time: 2829.3934s
	iters: 400, epoch: 9 | loss: 0.0021333
	speed: 0.0624s/iter; left time: 2667.8148s
Epoch: 9 cost time: 30.05750274658203
Epoch: 9, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4911968
	speed: 0.2606s/iter; left time: 11096.7909s
	iters: 200, epoch: 10 | loss: 0.0043657
	speed: 0.0679s/iter; left time: 2882.5927s
	iters: 300, epoch: 10 | loss: 0.0018427
	speed: 0.0662s/iter; left time: 2806.8882s
	iters: 400, epoch: 10 | loss: 0.0039112
	speed: 0.0683s/iter; left time: 2885.8039s
Epoch: 10 cost time: 31.588932037353516
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0084143
	speed: 0.2734s/iter; left time: 11514.3528s
	iters: 200, epoch: 11 | loss: 0.2234445
	speed: 0.0630s/iter; left time: 2646.5282s
	iters: 300, epoch: 11 | loss: 0.1132160
	speed: 0.0637s/iter; left time: 2671.0250s
	iters: 400, epoch: 11 | loss: 0.0046556
	speed: 0.0654s/iter; left time: 2732.9042s
Epoch: 11 cost time: 30.05240559577942
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975413).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0197606
	speed: 0.1799s/iter; left time: 7491.1766s
	iters: 200, epoch: 12 | loss: 0.0007999
	speed: 0.0590s/iter; left time: 2449.9368s
	iters: 300, epoch: 12 | loss: 0.0043659
	speed: 0.0662s/iter; left time: 2743.9757s
	iters: 400, epoch: 12 | loss: 0.1118697
	speed: 0.0635s/iter; left time: 2626.5470s
Epoch: 12 cost time: 29.02962565422058
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0933768
	speed: 0.2544s/iter; left time: 10475.4678s
	iters: 200, epoch: 13 | loss: 0.1066069
	speed: 0.0659s/iter; left time: 2706.9302s
	iters: 300, epoch: 13 | loss: 0.0001933
	speed: 0.0683s/iter; left time: 2799.1785s
	iters: 400, epoch: 13 | loss: 0.2587776
	speed: 0.0721s/iter; left time: 2948.4291s
Epoch: 13 cost time: 31.894563674926758
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0003916
	speed: 0.2625s/iter; left time: 10683.0976s
	iters: 200, epoch: 14 | loss: 0.0704308
	speed: 0.0689s/iter; left time: 2799.6067s
	iters: 300, epoch: 14 | loss: 0.0011375
	speed: 0.0713s/iter; left time: 2885.9549s
	iters: 400, epoch: 14 | loss: 0.0007012
	speed: 0.0695s/iter; left time: 2806.9165s
Epoch: 14 cost time: 32.094167947769165
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0011833
	speed: 0.2575s/iter; left time: 10359.4477s
	iters: 200, epoch: 15 | loss: 0.0026807
	speed: 0.0662s/iter; left time: 2656.3347s
	iters: 300, epoch: 15 | loss: 0.0314187
	speed: 0.0655s/iter; left time: 2621.6840s
	iters: 400, epoch: 15 | loss: 0.0009171
	speed: 0.0660s/iter; left time: 2634.0413s
Epoch: 15 cost time: 30.601772785186768
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002423
	speed: 0.2528s/iter; left time: 10051.7102s
	iters: 200, epoch: 16 | loss: 0.0009253
	speed: 0.0695s/iter; left time: 2755.1470s
	iters: 300, epoch: 16 | loss: 0.0313373
	speed: 0.0702s/iter; left time: 2778.9163s
	iters: 400, epoch: 16 | loss: 0.0008942
	speed: 0.0729s/iter; left time: 2876.3086s
Epoch: 16 cost time: 32.676918506622314
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000635
	speed: 0.2557s/iter; left time: 10050.0259s
	iters: 200, epoch: 17 | loss: 0.3517769
	speed: 0.0701s/iter; left time: 2747.1251s
	iters: 300, epoch: 17 | loss: 0.0915131
	speed: 0.0697s/iter; left time: 2725.0030s
	iters: 400, epoch: 17 | loss: 0.0293077
	speed: 0.0697s/iter; left time: 2718.2389s
Epoch: 17 cost time: 32.78140640258789
Epoch: 17, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0072746
	speed: 0.2511s/iter; left time: 9749.3772s
	iters: 200, epoch: 18 | loss: 0.2012362
	speed: 0.0678s/iter; left time: 2627.5329s
	iters: 300, epoch: 18 | loss: 0.0002942
	speed: 0.0681s/iter; left time: 2630.8465s
	iters: 400, epoch: 18 | loss: 0.0139356
	speed: 0.0676s/iter; left time: 2603.3263s
Epoch: 18 cost time: 31.617995262145996
Epoch: 18, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.7453712
	speed: 0.2597s/iter; left time: 9962.6731s
	iters: 200, epoch: 19 | loss: 0.0054726
	speed: 0.0708s/iter; left time: 2709.7551s
	iters: 300, epoch: 19 | loss: 0.0217266
	speed: 0.0640s/iter; left time: 2441.9643s
	iters: 400, epoch: 19 | loss: 0.1637390
	speed: 0.0641s/iter; left time: 2438.9721s
Epoch: 19 cost time: 30.827003002166748
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.965 Test Loss: 0.224 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0097505
	speed: 0.2714s/iter; left time: 10281.5388s
	iters: 200, epoch: 20 | loss: 0.0449743
	speed: 0.0676s/iter; left time: 2554.1298s
	iters: 300, epoch: 20 | loss: 0.0017002
	speed: 0.0664s/iter; left time: 2503.0876s
	iters: 400, epoch: 20 | loss: 0.0361596
	speed: 0.0648s/iter; left time: 2436.4003s
Epoch: 20 cost time: 31.04957103729248
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.975699).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0019810
	speed: 0.2567s/iter; left time: 9606.2008s
	iters: 200, epoch: 21 | loss: 0.0191254
	speed: 0.0621s/iter; left time: 2316.1917s
	iters: 300, epoch: 21 | loss: 0.0170895
	speed: 0.0635s/iter; left time: 2363.8011s
	iters: 400, epoch: 21 | loss: 0.0002949
	speed: 0.0649s/iter; left time: 2409.1566s
Epoch: 21 cost time: 29.944825410842896
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002792
	speed: 0.2779s/iter; left time: 10269.1639s
	iters: 200, epoch: 22 | loss: 0.0022490
	speed: 0.0631s/iter; left time: 2327.1040s
	iters: 300, epoch: 22 | loss: 0.1415159
	speed: 0.0614s/iter; left time: 2258.1363s
	iters: 400, epoch: 22 | loss: 0.0095591
	speed: 0.0657s/iter; left time: 2407.7082s
Epoch: 22 cost time: 30.111711502075195
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0011163
	speed: 0.2800s/iter; left time: 10215.2510s
	iters: 200, epoch: 23 | loss: 0.0002128
	speed: 0.0626s/iter; left time: 2278.0330s
	iters: 300, epoch: 23 | loss: 0.0018607
	speed: 0.0662s/iter; left time: 2400.4442s
	iters: 400, epoch: 23 | loss: 0.0008922
	speed: 0.0672s/iter; left time: 2430.4124s
Epoch: 23 cost time: 30.798508405685425
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977414).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000985
	speed: 0.2637s/iter; left time: 9495.6458s
	iters: 200, epoch: 24 | loss: 0.0019775
	speed: 0.0603s/iter; left time: 2165.0992s
	iters: 300, epoch: 24 | loss: 0.0054457
	speed: 0.0670s/iter; left time: 2397.9905s
	iters: 400, epoch: 24 | loss: 0.0018349
	speed: 0.0705s/iter; left time: 2517.9224s
Epoch: 24 cost time: 30.973581314086914
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0007654
	speed: 0.2778s/iter; left time: 9874.3717s
	iters: 200, epoch: 25 | loss: 0.3897191
	speed: 0.0611s/iter; left time: 2164.3442s
	iters: 300, epoch: 25 | loss: 0.0135148
	speed: 0.0657s/iter; left time: 2320.4423s
	iters: 400, epoch: 25 | loss: 0.1201953
	speed: 0.0670s/iter; left time: 2360.8624s
Epoch: 25 cost time: 31.126296043395996
Epoch: 25, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.186 Vali Acc: 0.965 Test Loss: 0.186 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1061122
	speed: 0.2727s/iter; left time: 9565.8648s
	iters: 200, epoch: 26 | loss: 0.0014778
	speed: 0.0648s/iter; left time: 2265.4358s
	iters: 300, epoch: 26 | loss: 0.0388385
	speed: 0.0632s/iter; left time: 2205.6301s
	iters: 400, epoch: 26 | loss: 0.2869059
	speed: 0.0666s/iter; left time: 2315.0922s
Epoch: 26 cost time: 30.778977394104004
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.977414 --> -0.983704).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0001322
	speed: 0.2628s/iter; left time: 9093.5675s
	iters: 200, epoch: 27 | loss: 0.0009795
	speed: 0.0684s/iter; left time: 2359.7486s
	iters: 300, epoch: 27 | loss: 0.0009870
	speed: 0.0636s/iter; left time: 2187.9532s
	iters: 400, epoch: 27 | loss: 0.0004927
	speed: 0.0681s/iter; left time: 2337.2422s
Epoch: 27 cost time: 31.629029989242554
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.2024506
	speed: 0.2745s/iter; left time: 9371.8637s
	iters: 200, epoch: 28 | loss: 0.0008286
	speed: 0.0689s/iter; left time: 2345.6701s
	iters: 300, epoch: 28 | loss: 0.0006313
	speed: 0.0676s/iter; left time: 2292.8029s
	iters: 400, epoch: 28 | loss: 0.0010341
	speed: 0.0637s/iter; left time: 2153.9158s
Epoch: 28 cost time: 31.566688299179077
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0017413
	speed: 0.2623s/iter; left time: 8832.9749s
	iters: 200, epoch: 29 | loss: 0.0026644
	speed: 0.0648s/iter; left time: 2175.9095s
	iters: 300, epoch: 29 | loss: 0.0004109
	speed: 0.0655s/iter; left time: 2193.7311s
	iters: 400, epoch: 29 | loss: 0.0009078
	speed: 0.0682s/iter; left time: 2275.3968s
Epoch: 29 cost time: 30.7673659324646
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
Validation loss decreased (-0.983704 --> -0.983990).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0187832
	speed: 0.2691s/iter; left time: 8934.5093s
	iters: 200, epoch: 30 | loss: 0.0000691
	speed: 0.0692s/iter; left time: 2289.3450s
	iters: 300, epoch: 30 | loss: 0.0108768
	speed: 0.0674s/iter; left time: 2222.8142s
	iters: 400, epoch: 30 | loss: 0.0133293
	speed: 0.0686s/iter; left time: 2258.0805s
Epoch: 30 cost time: 32.13171887397766
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0303162
	speed: 0.2731s/iter; left time: 8938.0873s
	iters: 200, epoch: 31 | loss: 0.0089568
	speed: 0.0681s/iter; left time: 2221.4795s
	iters: 300, epoch: 31 | loss: 0.0176132
	speed: 0.0658s/iter; left time: 2142.0049s
	iters: 400, epoch: 31 | loss: 0.0010317
	speed: 0.0667s/iter; left time: 2161.9086s
Epoch: 31 cost time: 31.757018566131592
Epoch: 31, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.1408666
	speed: 0.2600s/iter; left time: 8386.5949s
	iters: 200, epoch: 32 | loss: 0.0003245
	speed: 0.0629s/iter; left time: 2023.1959s
	iters: 300, epoch: 32 | loss: 0.0000778
	speed: 0.0628s/iter; left time: 2014.6128s
	iters: 400, epoch: 32 | loss: 0.0001347
	speed: 0.0641s/iter; left time: 2049.5436s
Epoch: 32 cost time: 30.368574142456055
Epoch: 32, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000497
	speed: 0.2619s/iter; left time: 8326.2290s
	iters: 200, epoch: 33 | loss: 0.4654231
	speed: 0.0676s/iter; left time: 2142.9751s
	iters: 300, epoch: 33 | loss: 0.0307748
	speed: 0.0656s/iter; left time: 2073.2527s
	iters: 400, epoch: 33 | loss: 0.0030052
	speed: 0.0666s/iter; left time: 2098.3605s
Epoch: 33 cost time: 31.417137384414673
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.2382728
	speed: 0.2414s/iter; left time: 7562.3263s
	iters: 200, epoch: 34 | loss: 0.0019375
	speed: 0.0681s/iter; left time: 2125.2672s
	iters: 300, epoch: 34 | loss: 0.0012047
	speed: 0.0677s/iter; left time: 2107.9833s
	iters: 400, epoch: 34 | loss: 0.0245589
	speed: 0.0677s/iter; left time: 2098.8749s
Epoch: 34 cost time: 31.7835750579834
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0767114
	speed: 0.2457s/iter; left time: 7580.4867s
	iters: 200, epoch: 35 | loss: 0.0010842
	speed: 0.0665s/iter; left time: 2045.5212s
	iters: 300, epoch: 35 | loss: 0.0054379
	speed: 0.0648s/iter; left time: 1987.7076s
	iters: 400, epoch: 35 | loss: 0.0002882
	speed: 0.0647s/iter; left time: 1978.1586s
Epoch: 35 cost time: 30.504552364349365
Epoch: 35, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0081415
	speed: 0.2521s/iter; left time: 7659.1508s
	iters: 200, epoch: 36 | loss: 0.6053257
	speed: 0.0694s/iter; left time: 2100.3988s
	iters: 300, epoch: 36 | loss: 0.0000401
	speed: 0.0664s/iter; left time: 2004.0815s
	iters: 400, epoch: 36 | loss: 0.8092224
	speed: 0.0679s/iter; left time: 2041.8946s
Epoch: 36 cost time: 31.42651915550232
Epoch: 36, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0028580
	speed: 0.2674s/iter; left time: 8000.7116s
	iters: 200, epoch: 37 | loss: 0.0000187
	speed: 0.0653s/iter; left time: 1948.3741s
	iters: 300, epoch: 37 | loss: 0.0041396
	speed: 0.0639s/iter; left time: 1898.8549s
	iters: 400, epoch: 37 | loss: 0.0163161
	speed: 0.0653s/iter; left time: 1933.6715s
Epoch: 37 cost time: 30.840885162353516
Epoch: 37, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0027055
	speed: 0.2462s/iter; left time: 7251.2305s
	iters: 200, epoch: 38 | loss: 0.0002280
	speed: 0.0618s/iter; left time: 1812.6801s
	iters: 300, epoch: 38 | loss: 0.0002834
	speed: 0.0624s/iter; left time: 1823.8810s
	iters: 400, epoch: 38 | loss: 0.0000450
	speed: 0.0607s/iter; left time: 1770.0602s
Epoch: 38 cost time: 29.559231281280518
Epoch: 38, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0005171
	speed: 0.2691s/iter; left time: 7797.1370s
	iters: 200, epoch: 39 | loss: 0.0022815
	speed: 0.0685s/iter; left time: 1978.2423s
	iters: 300, epoch: 39 | loss: 0.0023986
	speed: 0.0640s/iter; left time: 1843.1021s
	iters: 400, epoch: 39 | loss: 0.0008397
	speed: 0.0625s/iter; left time: 1791.6603s
Epoch: 39 cost time: 31.352222204208374
Epoch: 39, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 2000650
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3066542
	speed: 0.0765s/iter; left time: 3578.2147s
	iters: 200, epoch: 1 | loss: 2.3017669
	speed: 0.0612s/iter; left time: 2859.1904s
	iters: 300, epoch: 1 | loss: 2.3065534
	speed: 0.0614s/iter; left time: 2861.2647s
	iters: 400, epoch: 1 | loss: 2.3053916
	speed: 0.0641s/iter; left time: 2982.5491s
Epoch: 1 cost time: 30.79018759727478
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3024583
	speed: 0.2340s/iter; left time: 10842.7135s
	iters: 200, epoch: 2 | loss: 2.3048770
	speed: 0.0652s/iter; left time: 3012.6049s
	iters: 300, epoch: 2 | loss: 2.2989943
	speed: 0.0652s/iter; left time: 3005.6354s
	iters: 400, epoch: 2 | loss: 2.3041701
	speed: 0.0602s/iter; left time: 2770.2562s
Epoch: 2 cost time: 29.00641942024231
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2961226
	speed: 0.2499s/iter; left time: 11458.9863s
	iters: 200, epoch: 3 | loss: 2.2997181
	speed: 0.0616s/iter; left time: 2819.6925s
	iters: 300, epoch: 3 | loss: 2.3039329
	speed: 0.0626s/iter; left time: 2857.6479s
	iters: 400, epoch: 3 | loss: 2.3086221
	speed: 0.0682s/iter; left time: 3107.7069s
Epoch: 3 cost time: 30.300705194473267
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2886269
	speed: 0.2650s/iter; left time: 12030.8597s
	iters: 200, epoch: 4 | loss: 2.3027160
	speed: 0.0698s/iter; left time: 3162.5911s
	iters: 300, epoch: 4 | loss: 2.2928028
	speed: 0.0648s/iter; left time: 2930.4661s
	iters: 400, epoch: 4 | loss: 2.2996278
	speed: 0.0626s/iter; left time: 2823.3527s
Epoch: 4 cost time: 30.875866174697876
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2882996
	speed: 0.2471s/iter; left time: 11101.6585s
	iters: 200, epoch: 5 | loss: 2.3049784
	speed: 0.0700s/iter; left time: 3139.8346s
	iters: 300, epoch: 5 | loss: 2.2899647
	speed: 0.0675s/iter; left time: 3019.3137s
	iters: 400, epoch: 5 | loss: 2.3029921
	speed: 0.0657s/iter; left time: 2933.3010s
Epoch: 5 cost time: 30.597564935684204
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3060510
	speed: 0.1908s/iter; left time: 8483.8122s
	iters: 200, epoch: 6 | loss: 2.3119972
	speed: 0.0543s/iter; left time: 2407.7212s
	iters: 300, epoch: 6 | loss: 2.3069513
	speed: 0.0522s/iter; left time: 2309.7360s
	iters: 400, epoch: 6 | loss: 2.3076315
	speed: 0.0543s/iter; left time: 2395.8478s
Epoch: 6 cost time: 25.98987364768982
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3075831
	speed: 0.2595s/iter; left time: 11412.8714s
	iters: 200, epoch: 7 | loss: 2.2963548
	speed: 0.0598s/iter; left time: 2624.1672s
	iters: 300, epoch: 7 | loss: 2.2944191
	speed: 0.0608s/iter; left time: 2662.8180s
	iters: 400, epoch: 7 | loss: 2.2884665
	speed: 0.0658s/iter; left time: 2876.7808s
Epoch: 7 cost time: 30.053956270217896
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3035722
	speed: 0.2400s/iter; left time: 10443.1116s
	iters: 200, epoch: 8 | loss: 2.2965097
	speed: 0.0640s/iter; left time: 2780.6329s
	iters: 300, epoch: 8 | loss: 2.2901797
	speed: 0.0657s/iter; left time: 2845.0727s
	iters: 400, epoch: 8 | loss: 2.3037670
	speed: 0.0688s/iter; left time: 2972.2012s
Epoch: 8 cost time: 30.688732147216797
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2999783
	speed: 0.2461s/iter; left time: 10595.9111s
	iters: 200, epoch: 9 | loss: 2.3190756
	speed: 0.0664s/iter; left time: 2849.8340s
	iters: 300, epoch: 9 | loss: 2.2970955
	speed: 0.0698s/iter; left time: 2991.3897s
	iters: 400, epoch: 9 | loss: 2.3046634
	speed: 0.0640s/iter; left time: 2734.7463s
Epoch: 9 cost time: 30.98677110671997
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3034661
	speed: 0.2539s/iter; left time: 10809.5308s
	iters: 200, epoch: 10 | loss: 2.3125167
	speed: 0.0615s/iter; left time: 2610.7039s
	iters: 300, epoch: 10 | loss: 2.3071132
	speed: 0.0597s/iter; left time: 2529.4255s
	iters: 400, epoch: 10 | loss: 2.3012106
	speed: 0.0648s/iter; left time: 2741.0715s
Epoch: 10 cost time: 29.750128507614136
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3063908
	speed: 0.2416s/iter; left time: 10172.1863s
	iters: 200, epoch: 11 | loss: 2.2993343
	speed: 0.0640s/iter; left time: 2687.6851s
	iters: 300, epoch: 11 | loss: 2.3058856
	speed: 0.0672s/iter; left time: 2816.0179s
	iters: 400, epoch: 11 | loss: 2.2947693
	speed: 0.0635s/iter; left time: 2653.8079s
Epoch: 11 cost time: 29.915175437927246
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3030877
	speed: 0.2516s/iter; left time: 10475.2569s
	iters: 200, epoch: 12 | loss: 2.2925828
	speed: 0.0665s/iter; left time: 2764.2250s
	iters: 300, epoch: 12 | loss: 2.2864795
	speed: 0.0691s/iter; left time: 2865.6690s
	iters: 400, epoch: 12 | loss: 2.2949507
	speed: 0.0705s/iter; left time: 2916.0651s
Epoch: 12 cost time: 31.54593062400818
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2964587
	speed: 0.2451s/iter; left time: 10089.8728s
	iters: 200, epoch: 13 | loss: 2.3054683
	speed: 0.0643s/iter; left time: 2641.6225s
	iters: 300, epoch: 13 | loss: 2.3162940
	speed: 0.0641s/iter; left time: 2627.2304s
	iters: 400, epoch: 13 | loss: 2.3014259
	speed: 0.0635s/iter; left time: 2595.4744s
Epoch: 13 cost time: 30.20405387878418
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.2926338
	speed: 0.2413s/iter; left time: 9823.2298s
	iters: 200, epoch: 14 | loss: 2.3083138
	speed: 0.0694s/iter; left time: 2816.2265s
	iters: 300, epoch: 14 | loss: 2.3098123
	speed: 0.0645s/iter; left time: 2612.9316s
	iters: 400, epoch: 14 | loss: 2.2890718
	speed: 0.0664s/iter; left time: 2680.9759s
Epoch: 14 cost time: 31.307127714157104
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2943735
	speed: 0.2682s/iter; left time: 10791.8887s
	iters: 200, epoch: 15 | loss: 2.3091230
	speed: 0.0617s/iter; left time: 2475.1420s
	iters: 300, epoch: 15 | loss: 2.3007996
	speed: 0.0655s/iter; left time: 2621.9432s
	iters: 400, epoch: 15 | loss: 2.2985554
	speed: 0.0693s/iter; left time: 2766.2208s
Epoch: 15 cost time: 31.153454065322876
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.3177423
	speed: 0.2523s/iter; left time: 10031.3223s
	iters: 200, epoch: 16 | loss: 2.3039677
	speed: 0.0641s/iter; left time: 2543.8698s
	iters: 300, epoch: 16 | loss: 2.2824516
	speed: 0.0649s/iter; left time: 2566.7010s
	iters: 400, epoch: 16 | loss: 2.2998476
	speed: 0.0655s/iter; left time: 2584.1273s
Epoch: 16 cost time: 30.219631671905518
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.2869723
	speed: 0.2323s/iter; left time: 9128.6556s
	iters: 200, epoch: 17 | loss: 2.3233666
	speed: 0.0638s/iter; left time: 2500.5199s
	iters: 300, epoch: 17 | loss: 2.3075790
	speed: 0.0675s/iter; left time: 2640.3084s
	iters: 400, epoch: 17 | loss: 2.2908487
	speed: 0.0680s/iter; left time: 2653.4047s
Epoch: 17 cost time: 30.68738293647766
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 2.3029590
	speed: 0.2372s/iter; left time: 9209.8222s
	iters: 200, epoch: 18 | loss: 2.3214002
	speed: 0.0661s/iter; left time: 2561.1107s
	iters: 300, epoch: 18 | loss: 2.3079135
	speed: 0.0658s/iter; left time: 2541.8370s
	iters: 400, epoch: 18 | loss: 2.2984173
	speed: 0.0639s/iter; left time: 2461.8173s
Epoch: 18 cost time: 30.35150718688965
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 2.3190303
	speed: 0.2372s/iter; left time: 9100.5830s
	iters: 200, epoch: 19 | loss: 2.3001399
	speed: 0.0677s/iter; left time: 2590.5054s
	iters: 300, epoch: 19 | loss: 2.3029449
	speed: 0.0627s/iter; left time: 2393.3365s
	iters: 400, epoch: 19 | loss: 2.3022525
	speed: 0.0616s/iter; left time: 2343.2177s
Epoch: 19 cost time: 30.081825017929077
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 2.2938769
	speed: 0.2421s/iter; left time: 9173.6524s
	iters: 200, epoch: 20 | loss: 2.2781594
	speed: 0.0625s/iter; left time: 2362.9696s
	iters: 300, epoch: 20 | loss: 2.2906234
	speed: 0.0578s/iter; left time: 2177.0650s
	iters: 400, epoch: 20 | loss: 2.2942805
	speed: 0.0690s/iter; left time: 2592.4621s
Epoch: 20 cost time: 29.94747567176819
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.3153818
	speed: 0.2557s/iter; left time: 9569.3788s
	iters: 200, epoch: 21 | loss: 2.3006046
	speed: 0.0691s/iter; left time: 2579.0616s
	iters: 300, epoch: 21 | loss: 2.3190801
	speed: 0.0712s/iter; left time: 2649.1866s
	iters: 400, epoch: 21 | loss: 2.2926395
	speed: 0.0654s/iter; left time: 2426.2848s
Epoch: 21 cost time: 31.284597396850586
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 2000650
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5229161
	speed: 0.0656s/iter; left time: 3069.7273s
	iters: 200, epoch: 1 | loss: 0.2910928
	speed: 0.0531s/iter; left time: 2480.8004s
	iters: 300, epoch: 1 | loss: 0.1022857
	speed: 0.0611s/iter; left time: 2847.7744s
	iters: 400, epoch: 1 | loss: 0.3569311
	speed: 0.0624s/iter; left time: 2901.3513s
Epoch: 1 cost time: 28.70443320274353
Epoch: 1, Steps: 469 | Train Loss: 0.420 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (inf --> -0.971125).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1229471
	speed: 0.2561s/iter; left time: 11863.7458s
	iters: 200, epoch: 2 | loss: 0.1707449
	speed: 0.0617s/iter; left time: 2852.6401s
	iters: 300, epoch: 2 | loss: 0.1981482
	speed: 0.0589s/iter; left time: 2716.7020s
	iters: 400, epoch: 2 | loss: 0.1398159
	speed: 0.0521s/iter; left time: 2398.1219s
Epoch: 2 cost time: 28.131277084350586
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0283219
	speed: 0.2342s/iter; left time: 10739.0973s
	iters: 200, epoch: 3 | loss: 0.0093345
	speed: 0.0563s/iter; left time: 2575.7325s
	iters: 300, epoch: 3 | loss: 0.0125624
	speed: 0.0610s/iter; left time: 2783.8094s
	iters: 400, epoch: 3 | loss: 0.0128358
	speed: 0.0621s/iter; left time: 2828.1697s
Epoch: 3 cost time: 28.856143474578857
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0854840
	speed: 0.2649s/iter; left time: 12025.0311s
	iters: 200, epoch: 4 | loss: 0.1122298
	speed: 0.0617s/iter; left time: 2794.6637s
	iters: 300, epoch: 4 | loss: 0.0239705
	speed: 0.0607s/iter; left time: 2744.0349s
	iters: 400, epoch: 4 | loss: 0.0186406
	speed: 0.0583s/iter; left time: 2628.2148s
Epoch: 4 cost time: 29.37923502922058
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.971125 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1532252
	speed: 0.2764s/iter; left time: 12418.4614s
	iters: 200, epoch: 5 | loss: 0.0218283
	speed: 0.0567s/iter; left time: 2542.9342s
	iters: 300, epoch: 5 | loss: 0.0061206
	speed: 0.0601s/iter; left time: 2687.1668s
	iters: 400, epoch: 5 | loss: 0.1226643
	speed: 0.0607s/iter; left time: 2707.8206s
Epoch: 5 cost time: 28.98847246170044
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2610903
	speed: 0.2459s/iter; left time: 10930.4630s
	iters: 200, epoch: 6 | loss: 0.0287379
	speed: 0.0567s/iter; left time: 2512.9519s
	iters: 300, epoch: 6 | loss: 0.0018504
	speed: 0.0608s/iter; left time: 2691.2940s
	iters: 400, epoch: 6 | loss: 0.0118207
	speed: 0.0607s/iter; left time: 2680.1988s
Epoch: 6 cost time: 28.817666053771973
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0416590
	speed: 0.2719s/iter; left time: 11958.9224s
	iters: 200, epoch: 7 | loss: 0.0009448
	speed: 0.0612s/iter; left time: 2685.4447s
	iters: 300, epoch: 7 | loss: 0.0611021
	speed: 0.0548s/iter; left time: 2401.2271s
	iters: 400, epoch: 7 | loss: 0.0326611
	speed: 0.0615s/iter; left time: 2688.3406s
Epoch: 7 cost time: 29.303062200546265
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0680219
	speed: 0.2708s/iter; left time: 11783.4668s
	iters: 200, epoch: 8 | loss: 0.0272618
	speed: 0.0607s/iter; left time: 2633.6549s
	iters: 300, epoch: 8 | loss: 0.0230262
	speed: 0.0616s/iter; left time: 2667.8130s
	iters: 400, epoch: 8 | loss: 0.0781452
	speed: 0.0569s/iter; left time: 2457.8163s
Epoch: 8 cost time: 28.474769592285156
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3012557
	speed: 0.2350s/iter; left time: 10117.6172s
	iters: 200, epoch: 9 | loss: 0.0212352
	speed: 0.0607s/iter; left time: 2608.5528s
	iters: 300, epoch: 9 | loss: 0.0103275
	speed: 0.0583s/iter; left time: 2496.5624s
	iters: 400, epoch: 9 | loss: 0.0017943
	speed: 0.0589s/iter; left time: 2516.9960s
Epoch: 9 cost time: 28.296148777008057
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0009364
	speed: 0.2650s/iter; left time: 11285.4702s
	iters: 200, epoch: 10 | loss: 0.0010536
	speed: 0.0575s/iter; left time: 2443.5364s
	iters: 300, epoch: 10 | loss: 0.1048570
	speed: 0.0538s/iter; left time: 2280.5074s
	iters: 400, epoch: 10 | loss: 0.0184348
	speed: 0.0477s/iter; left time: 2015.5150s
Epoch: 10 cost time: 25.547746896743774
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0005275
	speed: 0.1478s/iter; left time: 6224.5027s
	iters: 200, epoch: 11 | loss: 0.0020764
	speed: 0.0419s/iter; left time: 1762.0096s
	iters: 300, epoch: 11 | loss: 0.0085218
	speed: 0.0445s/iter; left time: 1863.6140s
	iters: 400, epoch: 11 | loss: 0.3365578
	speed: 0.0419s/iter; left time: 1753.0092s
Epoch: 11 cost time: 20.69778323173523
Epoch: 11, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0025670
	speed: 0.1746s/iter; left time: 7270.4789s
	iters: 200, epoch: 12 | loss: 0.0324123
	speed: 0.0649s/iter; left time: 2694.8461s
	iters: 300, epoch: 12 | loss: 0.0132970
	speed: 0.0629s/iter; left time: 2606.5544s
	iters: 400, epoch: 12 | loss: 0.0027736
	speed: 0.0604s/iter; left time: 2496.1907s
Epoch: 12 cost time: 28.824485301971436
Epoch: 12, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2055150
	speed: 0.2407s/iter; left time: 9911.9754s
	iters: 200, epoch: 13 | loss: 0.2731811
	speed: 0.0615s/iter; left time: 2525.0595s
	iters: 300, epoch: 13 | loss: 0.0317290
	speed: 0.0638s/iter; left time: 2613.0366s
	iters: 400, epoch: 13 | loss: 0.0006985
	speed: 0.0667s/iter; left time: 2726.5798s
Epoch: 13 cost time: 30.231773614883423
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.971983 --> -0.975699).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0006158
	speed: 0.2437s/iter; left time: 9917.6972s
	iters: 200, epoch: 14 | loss: 0.0436411
	speed: 0.0651s/iter; left time: 2645.0415s
	iters: 300, epoch: 14 | loss: 0.0040118
	speed: 0.0675s/iter; left time: 2734.9678s
	iters: 400, epoch: 14 | loss: 0.0005699
	speed: 0.0644s/iter; left time: 2601.6006s
Epoch: 14 cost time: 30.447409629821777
Epoch: 14, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0127728
	speed: 0.2557s/iter; left time: 10286.9110s
	iters: 200, epoch: 15 | loss: 0.0644582
	speed: 0.0580s/iter; left time: 2327.6880s
	iters: 300, epoch: 15 | loss: 0.0208585
	speed: 0.0633s/iter; left time: 2535.1656s
	iters: 400, epoch: 15 | loss: 0.0007969
	speed: 0.0622s/iter; left time: 2484.9545s
Epoch: 15 cost time: 29.39572787284851
Epoch: 15, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0001823
	speed: 0.2285s/iter; left time: 9088.2499s
	iters: 200, epoch: 16 | loss: 0.0005591
	speed: 0.0638s/iter; left time: 2531.9638s
	iters: 300, epoch: 16 | loss: 0.0003206
	speed: 0.0661s/iter; left time: 2615.0501s
	iters: 400, epoch: 16 | loss: 0.0067635
	speed: 0.0621s/iter; left time: 2452.7909s
Epoch: 16 cost time: 29.61716365814209
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0002001
	speed: 0.2517s/iter; left time: 9890.8957s
	iters: 200, epoch: 17 | loss: 0.0209037
	speed: 0.0597s/iter; left time: 2341.7072s
	iters: 300, epoch: 17 | loss: 0.0000732
	speed: 0.0660s/iter; left time: 2580.2697s
	iters: 400, epoch: 17 | loss: 0.0001127
	speed: 0.0663s/iter; left time: 2584.4832s
Epoch: 17 cost time: 30.50619149208069
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0015552
	speed: 0.2464s/iter; left time: 9567.6317s
	iters: 200, epoch: 18 | loss: 0.0564682
	speed: 0.0621s/iter; left time: 2405.2696s
	iters: 300, epoch: 18 | loss: 0.0009052
	speed: 0.0616s/iter; left time: 2378.5458s
	iters: 400, epoch: 18 | loss: 0.0009004
	speed: 0.0582s/iter; left time: 2242.1129s
Epoch: 18 cost time: 28.505587100982666
Epoch: 18, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0096964
	speed: 0.2454s/iter; left time: 9413.0554s
	iters: 200, epoch: 19 | loss: 0.0070963
	speed: 0.0622s/iter; left time: 2381.0215s
	iters: 300, epoch: 19 | loss: 0.0028536
	speed: 0.0631s/iter; left time: 2408.0551s
	iters: 400, epoch: 19 | loss: 0.0028253
	speed: 0.0681s/iter; left time: 2592.5466s
Epoch: 19 cost time: 30.43291926383972
Epoch: 19, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0033731
	speed: 0.2444s/iter; left time: 9260.1307s
	iters: 200, epoch: 20 | loss: 0.2186679
	speed: 0.0658s/iter; left time: 2486.9852s
	iters: 300, epoch: 20 | loss: 0.0014551
	speed: 0.0678s/iter; left time: 2556.5954s
	iters: 400, epoch: 20 | loss: 0.0000850
	speed: 0.0656s/iter; left time: 2466.7185s
Epoch: 20 cost time: 30.7433865070343
Epoch: 20, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1537519
	speed: 0.2534s/iter; left time: 9483.1256s
	iters: 200, epoch: 21 | loss: 0.0047590
	speed: 0.0582s/iter; left time: 2172.8357s
	iters: 300, epoch: 21 | loss: 0.0000971
	speed: 0.0540s/iter; left time: 2009.5086s
	iters: 400, epoch: 21 | loss: 0.3413225
	speed: 0.0526s/iter; left time: 1951.8057s
Epoch: 21 cost time: 27.173635721206665
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.966 Test Loss: 0.203 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7421346
	speed: 0.1705s/iter; left time: 6299.8105s
	iters: 200, epoch: 22 | loss: 0.0011888
	speed: 0.0444s/iter; left time: 1637.6613s
	iters: 300, epoch: 22 | loss: 0.0346484
	speed: 0.0460s/iter; left time: 1689.6976s
	iters: 400, epoch: 22 | loss: 0.0048453
	speed: 0.0487s/iter; left time: 1786.6342s
Epoch: 22 cost time: 22.743419885635376
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0007837
	speed: 0.2182s/iter; left time: 7959.6266s
	iters: 200, epoch: 23 | loss: 0.0000684
	speed: 0.0648s/iter; left time: 2358.5875s
	iters: 300, epoch: 23 | loss: 0.0121373
	speed: 0.0596s/iter; left time: 2162.7339s
	iters: 400, epoch: 23 | loss: 0.0000636
	speed: 0.0568s/iter; left time: 2055.3559s
Epoch: 23 cost time: 29.3136465549469
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 1607434
model size : 15.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6164318
	speed: 0.0758s/iter; left time: 3549.7512s
	iters: 200, epoch: 1 | loss: 0.3734500
	speed: 0.0572s/iter; left time: 2671.9880s
	iters: 300, epoch: 1 | loss: 0.1375850
	speed: 0.0612s/iter; left time: 2852.6962s
	iters: 400, epoch: 1 | loss: 0.2907715
	speed: 0.0655s/iter; left time: 3045.2083s
Epoch: 1 cost time: 30.44901990890503
Epoch: 1, Steps: 469 | Train Loss: 0.464 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (inf --> -0.959690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1682163
	speed: 0.2344s/iter; left time: 10858.8802s
	iters: 200, epoch: 2 | loss: 0.0538596
	speed: 0.0601s/iter; left time: 2779.7529s
	iters: 300, epoch: 2 | loss: 0.1589276
	speed: 0.0583s/iter; left time: 2688.0621s
	iters: 400, epoch: 2 | loss: 0.3489143
	speed: 0.0681s/iter; left time: 3135.8388s
Epoch: 2 cost time: 29.165100574493408
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0119759
	speed: 0.2555s/iter; left time: 11717.3492s
	iters: 200, epoch: 3 | loss: 0.0095450
	speed: 0.0622s/iter; left time: 2848.1199s
	iters: 300, epoch: 3 | loss: 0.0159970
	speed: 0.0642s/iter; left time: 2930.0175s
	iters: 400, epoch: 3 | loss: 0.1368721
	speed: 0.0634s/iter; left time: 2890.7000s
Epoch: 3 cost time: 29.44539213180542
Epoch: 3, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.959690 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0170668
	speed: 0.2621s/iter; left time: 11898.5783s
	iters: 200, epoch: 4 | loss: 0.0217205
	speed: 0.0544s/iter; left time: 2461.7301s
	iters: 300, epoch: 4 | loss: 0.0091700
	speed: 0.0608s/iter; left time: 2748.4947s
	iters: 400, epoch: 4 | loss: 0.2161509
	speed: 0.0645s/iter; left time: 2909.9211s
Epoch: 4 cost time: 28.604146003723145
Epoch: 4, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4413285
	speed: 0.2346s/iter; left time: 10539.5281s
	iters: 200, epoch: 5 | loss: 0.0211167
	speed: 0.0623s/iter; left time: 2792.1521s
	iters: 300, epoch: 5 | loss: 0.0104176
	speed: 0.0583s/iter; left time: 2605.6806s
	iters: 400, epoch: 5 | loss: 0.0862794
	speed: 0.0626s/iter; left time: 2793.7680s
Epoch: 5 cost time: 29.738208293914795
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1732342
	speed: 0.2474s/iter; left time: 10997.5913s
	iters: 200, epoch: 6 | loss: 0.0164411
	speed: 0.0519s/iter; left time: 2301.3889s
	iters: 300, epoch: 6 | loss: 0.0147401
	speed: 0.0537s/iter; left time: 2376.3076s
	iters: 400, epoch: 6 | loss: 0.0285507
	speed: 0.0507s/iter; left time: 2238.3302s
Epoch: 6 cost time: 24.923007011413574
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0577685
	speed: 0.1723s/iter; left time: 7576.9656s
	iters: 200, epoch: 7 | loss: 0.0187424
	speed: 0.0612s/iter; left time: 2686.9381s
	iters: 300, epoch: 7 | loss: 0.0367883
	speed: 0.0605s/iter; left time: 2647.8588s
	iters: 400, epoch: 7 | loss: 0.2687477
	speed: 0.0632s/iter; left time: 2761.1366s
Epoch: 7 cost time: 27.820700883865356
Epoch: 7, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1794242
	speed: 0.2488s/iter; left time: 10829.2625s
	iters: 200, epoch: 8 | loss: 0.0732527
	speed: 0.0536s/iter; left time: 2327.4506s
	iters: 300, epoch: 8 | loss: 0.0059930
	speed: 0.0598s/iter; left time: 2591.1852s
	iters: 400, epoch: 8 | loss: 0.5274907
	speed: 0.0672s/iter; left time: 2903.6852s
Epoch: 8 cost time: 29.03845191001892
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0115061
	speed: 0.2515s/iter; left time: 10826.2545s
	iters: 200, epoch: 9 | loss: 0.0089723
	speed: 0.0620s/iter; left time: 2664.4870s
	iters: 300, epoch: 9 | loss: 0.0330585
	speed: 0.0593s/iter; left time: 2541.5487s
	iters: 400, epoch: 9 | loss: 0.0279508
	speed: 0.0644s/iter; left time: 2751.9048s
Epoch: 9 cost time: 29.774185180664062
Epoch: 9, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0384135
	speed: 0.2581s/iter; left time: 10990.4406s
	iters: 200, epoch: 10 | loss: 0.0201587
	speed: 0.0606s/iter; left time: 2572.6267s
	iters: 300, epoch: 10 | loss: 0.1237706
	speed: 0.0589s/iter; left time: 2496.6948s
	iters: 400, epoch: 10 | loss: 0.0015662
	speed: 0.0602s/iter; left time: 2547.0439s
Epoch: 10 cost time: 27.818204879760742
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.966265 --> -0.971125).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0024001
	speed: 0.2425s/iter; left time: 10210.7720s
	iters: 200, epoch: 11 | loss: 0.0080300
	speed: 0.0526s/iter; left time: 2210.6297s
	iters: 300, epoch: 11 | loss: 0.0122971
	speed: 0.0587s/iter; left time: 2459.9478s
	iters: 400, epoch: 11 | loss: 0.2667199
	speed: 0.0646s/iter; left time: 2702.9523s
Epoch: 11 cost time: 28.282890796661377
Epoch: 11, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.351 Vali Acc: 0.936 Test Loss: 0.351 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3589060
	speed: 0.2447s/iter; left time: 10190.9679s
	iters: 200, epoch: 12 | loss: 0.0932237
	speed: 0.0612s/iter; left time: 2543.2703s
	iters: 300, epoch: 12 | loss: 0.0020272
	speed: 0.0570s/iter; left time: 2362.1134s
	iters: 400, epoch: 12 | loss: 0.0018068
	speed: 0.0601s/iter; left time: 2483.5071s
Epoch: 12 cost time: 28.679728984832764
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0014043
	speed: 0.2636s/iter; left time: 10852.6455s
	iters: 200, epoch: 13 | loss: 0.8245258
	speed: 0.0621s/iter; left time: 2552.2006s
	iters: 300, epoch: 13 | loss: 0.1086802
	speed: 0.0595s/iter; left time: 2438.8868s
	iters: 400, epoch: 13 | loss: 0.0055120
	speed: 0.0605s/iter; left time: 2471.1579s
Epoch: 13 cost time: 28.01128387451172
Epoch: 13, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3455252
	speed: 0.2485s/iter; left time: 10115.9749s
	iters: 200, epoch: 14 | loss: 0.1624885
	speed: 0.0542s/iter; left time: 2201.3370s
	iters: 300, epoch: 14 | loss: 0.6484295
	speed: 0.0620s/iter; left time: 2511.0240s
	iters: 400, epoch: 14 | loss: 0.0045629
	speed: 0.0660s/iter; left time: 2664.7495s
Epoch: 14 cost time: 29.065882444381714
Epoch: 14, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0008914
	speed: 0.2492s/iter; left time: 10028.2510s
	iters: 200, epoch: 15 | loss: 0.3067891
	speed: 0.0602s/iter; left time: 2415.2713s
	iters: 300, epoch: 15 | loss: 0.0569931
	speed: 0.0598s/iter; left time: 2393.5483s
	iters: 400, epoch: 15 | loss: 0.0002770
	speed: 0.0610s/iter; left time: 2437.4436s
Epoch: 15 cost time: 29.18376111984253
Epoch: 15, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0032640
	speed: 0.2586s/iter; left time: 10284.4333s
	iters: 200, epoch: 16 | loss: 0.0003969
	speed: 0.0657s/iter; left time: 2604.9522s
	iters: 300, epoch: 16 | loss: 0.0290414
	speed: 0.0641s/iter; left time: 2534.4438s
	iters: 400, epoch: 16 | loss: 0.0008513
	speed: 0.0613s/iter; left time: 2418.9567s
Epoch: 16 cost time: 28.970892190933228
Epoch: 16, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.237 Vali Acc: 0.949 Test Loss: 0.237 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0097774
	speed: 0.2336s/iter; left time: 9178.3222s
	iters: 200, epoch: 17 | loss: 0.1676407
	speed: 0.0527s/iter; left time: 2065.1114s
	iters: 300, epoch: 17 | loss: 0.0005218
	speed: 0.0621s/iter; left time: 2429.3821s
	iters: 400, epoch: 17 | loss: 0.0023674
	speed: 0.0632s/iter; left time: 2463.0725s
Epoch: 17 cost time: 28.098006010055542
Epoch: 17, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.971125 --> -0.973412).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0364791
	speed: 0.2445s/iter; left time: 9491.6822s
	iters: 200, epoch: 18 | loss: 0.0013060
	speed: 0.0557s/iter; left time: 2157.5525s
	iters: 300, epoch: 18 | loss: 0.0042695
	speed: 0.0660s/iter; left time: 2548.8905s
	iters: 400, epoch: 18 | loss: 0.0032758
	speed: 0.0591s/iter; left time: 2278.7846s
Epoch: 18 cost time: 28.318068265914917
Epoch: 18, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4067017
	speed: 0.2521s/iter; left time: 9671.3789s
	iters: 200, epoch: 19 | loss: 0.0011251
	speed: 0.0509s/iter; left time: 1948.2899s
	iters: 300, epoch: 19 | loss: 0.0021172
	speed: 0.0453s/iter; left time: 1728.9234s
	iters: 400, epoch: 19 | loss: 0.0052851
	speed: 0.0524s/iter; left time: 1995.2880s
Epoch: 19 cost time: 24.032056093215942
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.934 Test Loss: 0.291 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0086036
	speed: 0.1667s/iter; left time: 6316.6807s
	iters: 200, epoch: 20 | loss: 0.0082923
	speed: 0.0574s/iter; left time: 2170.0249s
	iters: 300, epoch: 20 | loss: 0.0004202
	speed: 0.0588s/iter; left time: 2217.3162s
	iters: 400, epoch: 20 | loss: 0.0013492
	speed: 0.0572s/iter; left time: 2151.0855s
Epoch: 20 cost time: 27.215665817260742
Epoch: 20, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0008768
	speed: 0.2710s/iter; left time: 10140.6055s
	iters: 200, epoch: 21 | loss: 0.0007857
	speed: 0.0598s/iter; left time: 2230.8231s
	iters: 300, epoch: 21 | loss: 0.0004066
	speed: 0.0596s/iter; left time: 2219.0433s
	iters: 400, epoch: 21 | loss: 0.4209584
	speed: 0.0619s/iter; left time: 2298.9647s
Epoch: 21 cost time: 29.27741551399231
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.975413).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1326321
	speed: 0.2737s/iter; left time: 10115.2252s
	iters: 200, epoch: 22 | loss: 0.1479183
	speed: 0.0584s/iter; left time: 2153.0590s
	iters: 300, epoch: 22 | loss: 0.0147614
	speed: 0.0575s/iter; left time: 2114.9949s
	iters: 400, epoch: 22 | loss: 0.0004880
	speed: 0.0615s/iter; left time: 2253.6068s
Epoch: 22 cost time: 28.822166681289673
Epoch: 22, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0021425
	speed: 0.2556s/iter; left time: 9324.0093s
	iters: 200, epoch: 23 | loss: 0.0544902
	speed: 0.0574s/iter; left time: 2087.3444s
	iters: 300, epoch: 23 | loss: 0.0004786
	speed: 0.0589s/iter; left time: 2135.9443s
	iters: 400, epoch: 23 | loss: 0.0005437
	speed: 0.0586s/iter; left time: 2119.7721s
Epoch: 23 cost time: 28.281507968902588
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1937502
	speed: 0.2737s/iter; left time: 9858.3361s
	iters: 200, epoch: 24 | loss: 0.0009592
	speed: 0.0599s/iter; left time: 2150.1117s
	iters: 300, epoch: 24 | loss: 0.0016990
	speed: 0.0597s/iter; left time: 2136.4004s
	iters: 400, epoch: 24 | loss: 0.1559028
	speed: 0.0645s/iter; left time: 2304.3260s
Epoch: 24 cost time: 29.591177701950073
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.3793641
	speed: 0.2681s/iter; left time: 9529.7161s
	iters: 200, epoch: 25 | loss: 0.0033915
	speed: 0.0599s/iter; left time: 2122.1448s
	iters: 300, epoch: 25 | loss: 0.0010251
	speed: 0.0606s/iter; left time: 2142.6518s
	iters: 400, epoch: 25 | loss: 0.0287756
	speed: 0.0588s/iter; left time: 2070.6617s
Epoch: 25 cost time: 28.538562059402466
Epoch: 25, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0451803
	speed: 0.2556s/iter; left time: 8963.9892s
	iters: 200, epoch: 26 | loss: 0.0012192
	speed: 0.0582s/iter; left time: 2037.3247s
	iters: 300, epoch: 26 | loss: 0.0005825
	speed: 0.0586s/iter; left time: 2042.5477s
	iters: 400, epoch: 26 | loss: 0.0012544
	speed: 0.0598s/iter; left time: 2079.5800s
Epoch: 26 cost time: 28.182039260864258
Epoch: 26, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.979130).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0003977
	speed: 0.2717s/iter; left time: 9401.2180s
	iters: 200, epoch: 27 | loss: 0.0100435
	speed: 0.0608s/iter; left time: 2096.6736s
	iters: 300, epoch: 27 | loss: 0.0007595
	speed: 0.0610s/iter; left time: 2099.8760s
	iters: 400, epoch: 27 | loss: 0.0126168
	speed: 0.0650s/iter; left time: 2231.2233s
Epoch: 27 cost time: 29.96237349510193
Epoch: 27, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0015918
	speed: 0.2616s/iter; left time: 8930.4026s
	iters: 200, epoch: 28 | loss: 0.0020375
	speed: 0.0627s/iter; left time: 2135.2087s
	iters: 300, epoch: 28 | loss: 0.7783584
	speed: 0.0680s/iter; left time: 2307.4280s
	iters: 400, epoch: 28 | loss: 0.0010813
	speed: 0.0671s/iter; left time: 2269.7026s
Epoch: 28 cost time: 30.666532039642334
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0060516
	speed: 0.2505s/iter; left time: 8435.2709s
	iters: 200, epoch: 29 | loss: 0.0017847
	speed: 0.0592s/iter; left time: 1986.1248s
	iters: 300, epoch: 29 | loss: 0.0035183
	speed: 0.0605s/iter; left time: 2024.4037s
	iters: 400, epoch: 29 | loss: 0.0000632
	speed: 0.0630s/iter; left time: 2102.4409s
Epoch: 29 cost time: 29.113698482513428
Epoch: 29, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.193 Vali Acc: 0.961 Test Loss: 0.193 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0107447
	speed: 0.2670s/iter; left time: 8865.5068s
	iters: 200, epoch: 30 | loss: 0.1772208
	speed: 0.0650s/iter; left time: 2152.5733s
	iters: 300, epoch: 30 | loss: 0.0039401
	speed: 0.0675s/iter; left time: 2228.9092s
	iters: 400, epoch: 30 | loss: 0.1004079
	speed: 0.0653s/iter; left time: 2147.9512s
Epoch: 30 cost time: 31.12329411506653
Epoch: 30, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0006852
	speed: 0.2521s/iter; left time: 8250.4540s
	iters: 200, epoch: 31 | loss: 0.0017418
	speed: 0.0601s/iter; left time: 1961.2845s
	iters: 300, epoch: 31 | loss: 0.0090904
	speed: 0.0694s/iter; left time: 2256.0535s
	iters: 400, epoch: 31 | loss: 0.0764075
	speed: 0.0628s/iter; left time: 2036.4638s
Epoch: 31 cost time: 29.800978899002075
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0005281
	speed: 0.2487s/iter; left time: 8024.9790s
	iters: 200, epoch: 32 | loss: 0.2830148
	speed: 0.0628s/iter; left time: 2018.5935s
	iters: 300, epoch: 32 | loss: 0.0099483
	speed: 0.0666s/iter; left time: 2135.9872s
	iters: 400, epoch: 32 | loss: 0.0483829
	speed: 0.0666s/iter; left time: 2129.4867s
Epoch: 32 cost time: 30.619593381881714
Epoch: 32, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0365142
	speed: 0.2666s/iter; left time: 8476.0572s
	iters: 200, epoch: 33 | loss: 0.0110203
	speed: 0.0697s/iter; left time: 2209.9921s
	iters: 300, epoch: 33 | loss: 0.0002161
	speed: 0.0635s/iter; left time: 2004.6076s
	iters: 400, epoch: 33 | loss: 0.0021730
	speed: 0.0652s/iter; left time: 2052.9226s
Epoch: 33 cost time: 31.477378606796265
Epoch: 33, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0075953
	speed: 0.2510s/iter; left time: 7863.3266s
	iters: 200, epoch: 34 | loss: 0.0014717
	speed: 0.0643s/iter; left time: 2006.7138s
	iters: 300, epoch: 34 | loss: 0.0203307
	speed: 0.0593s/iter; left time: 1846.4273s
	iters: 400, epoch: 34 | loss: 0.0070069
	speed: 0.0625s/iter; left time: 1938.7787s
Epoch: 34 cost time: 29.343456745147705
Epoch: 34, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.1404608
	speed: 0.2427s/iter; left time: 7487.1106s
	iters: 200, epoch: 35 | loss: 0.0030392
	speed: 0.0629s/iter; left time: 1934.6489s
	iters: 300, epoch: 35 | loss: 0.0002629
	speed: 0.0628s/iter; left time: 1925.5952s
	iters: 400, epoch: 35 | loss: 0.0002199
	speed: 0.0650s/iter; left time: 1985.4897s
Epoch: 35 cost time: 29.787407875061035
Epoch: 35, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0012484
	speed: 0.2552s/iter; left time: 7755.5679s
	iters: 200, epoch: 36 | loss: 0.0230553
	speed: 0.0628s/iter; left time: 1902.2316s
	iters: 300, epoch: 36 | loss: 0.0622586
	speed: 0.0587s/iter; left time: 1770.7210s
	iters: 400, epoch: 36 | loss: 0.7033466
	speed: 0.0564s/iter; left time: 1695.6956s
Epoch: 36 cost time: 28.50370454788208
Epoch: 36, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 1607434
model size : 15.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5816828
	speed: 0.0732s/iter; left time: 3425.0065s
	iters: 200, epoch: 1 | loss: 0.3636256
	speed: 0.0615s/iter; left time: 2874.4244s
	iters: 300, epoch: 1 | loss: 0.1064463
	speed: 0.0616s/iter; left time: 2870.2052s
	iters: 400, epoch: 1 | loss: 0.2936168
	speed: 0.0698s/iter; left time: 3243.7856s
Epoch: 1 cost time: 31.19098448753357
Epoch: 1, Steps: 469 | Train Loss: 0.449 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (inf --> -0.958260).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1198426
	speed: 0.2601s/iter; left time: 12052.8863s
	iters: 200, epoch: 2 | loss: 0.0518267
	speed: 0.0666s/iter; left time: 3078.2716s
	iters: 300, epoch: 2 | loss: 0.2461867
	speed: 0.0684s/iter; left time: 3153.9973s
	iters: 400, epoch: 2 | loss: 0.7174621
	speed: 0.0693s/iter; left time: 3192.3094s
Epoch: 2 cost time: 31.722686529159546
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.958260 --> -0.959404).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0595727
	speed: 0.2675s/iter; left time: 12269.8048s
	iters: 200, epoch: 3 | loss: 0.0045391
	speed: 0.0689s/iter; left time: 3150.9174s
	iters: 300, epoch: 3 | loss: 0.0163459
	speed: 0.0643s/iter; left time: 2936.8549s
	iters: 400, epoch: 3 | loss: 0.0309230
	speed: 0.0669s/iter; left time: 3046.6967s
Epoch: 3 cost time: 31.264625310897827
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.959404 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0032202
	speed: 0.2477s/iter; left time: 11244.2147s
	iters: 200, epoch: 4 | loss: 0.0222339
	speed: 0.0632s/iter; left time: 2864.4678s
	iters: 300, epoch: 4 | loss: 0.0370501
	speed: 0.0663s/iter; left time: 2997.6280s
	iters: 400, epoch: 4 | loss: 0.1429641
	speed: 0.0662s/iter; left time: 2985.4659s
Epoch: 4 cost time: 30.48359704017639
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0157626
	speed: 0.2593s/iter; left time: 11649.5480s
	iters: 200, epoch: 5 | loss: 0.1099468
	speed: 0.0680s/iter; left time: 3049.6776s
	iters: 300, epoch: 5 | loss: 0.0017364
	speed: 0.0669s/iter; left time: 2991.6564s
	iters: 400, epoch: 5 | loss: 0.1211104
	speed: 0.0686s/iter; left time: 3063.3138s
Epoch: 5 cost time: 31.32317328453064
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3004106
	speed: 0.2631s/iter; left time: 11696.1983s
	iters: 200, epoch: 6 | loss: 0.0014480
	speed: 0.0705s/iter; left time: 3128.7037s
	iters: 300, epoch: 6 | loss: 0.0082475
	speed: 0.0685s/iter; left time: 3030.9143s
	iters: 400, epoch: 6 | loss: 0.0753001
	speed: 0.0664s/iter; left time: 2931.0481s
Epoch: 6 cost time: 31.767476797103882
Epoch: 6, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0522274
	speed: 0.2346s/iter; left time: 10317.9451s
	iters: 200, epoch: 7 | loss: 0.0538118
	speed: 0.0570s/iter; left time: 2501.3691s
	iters: 300, epoch: 7 | loss: 0.5307383
	speed: 0.0646s/iter; left time: 2829.9770s
	iters: 400, epoch: 7 | loss: 0.0057806
	speed: 0.0627s/iter; left time: 2738.6001s
Epoch: 7 cost time: 29.15757656097412
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0051526
	speed: 0.2557s/iter; left time: 11128.4653s
	iters: 200, epoch: 8 | loss: 0.0202492
	speed: 0.0705s/iter; left time: 3062.1445s
	iters: 300, epoch: 8 | loss: 0.1025501
	speed: 0.0694s/iter; left time: 3005.4411s
	iters: 400, epoch: 8 | loss: 0.0046981
	speed: 0.0652s/iter; left time: 2817.9513s
Epoch: 8 cost time: 31.43804430961609
Epoch: 8, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0020528
	speed: 0.2584s/iter; left time: 11125.0685s
	iters: 200, epoch: 9 | loss: 0.0001489
	speed: 0.0676s/iter; left time: 2903.1258s
	iters: 300, epoch: 9 | loss: 0.1324413
	speed: 0.0700s/iter; left time: 3001.2957s
	iters: 400, epoch: 9 | loss: 0.0028490
	speed: 0.0632s/iter; left time: 2702.1508s
Epoch: 9 cost time: 31.276719570159912
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0273902
	speed: 0.2352s/iter; left time: 10016.1175s
	iters: 200, epoch: 10 | loss: 0.0501667
	speed: 0.0603s/iter; left time: 2561.6315s
	iters: 300, epoch: 10 | loss: 0.0170551
	speed: 0.0622s/iter; left time: 2637.2435s
	iters: 400, epoch: 10 | loss: 0.0011306
	speed: 0.0667s/iter; left time: 2819.8434s
Epoch: 10 cost time: 29.633674144744873
Epoch: 10, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000456
	speed: 0.2559s/iter; left time: 10776.2163s
	iters: 200, epoch: 11 | loss: 0.0017078
	speed: 0.0666s/iter; left time: 2799.2021s
	iters: 300, epoch: 11 | loss: 0.0180199
	speed: 0.0643s/iter; left time: 2695.9213s
	iters: 400, epoch: 11 | loss: 0.1407523
	speed: 0.0642s/iter; left time: 2685.8025s
Epoch: 11 cost time: 30.54482364654541
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.940 Test Loss: 0.303 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0142977
	speed: 0.2557s/iter; left time: 10648.9166s
	iters: 200, epoch: 12 | loss: 0.0513817
	speed: 0.0658s/iter; left time: 2731.8605s
	iters: 300, epoch: 12 | loss: 0.0004273
	speed: 0.0619s/iter; left time: 2564.8530s
	iters: 400, epoch: 12 | loss: 0.0026740
	speed: 0.0636s/iter; left time: 2631.3016s
Epoch: 12 cost time: 30.08960223197937
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0004769
	speed: 0.2468s/iter; left time: 10162.3277s
	iters: 200, epoch: 13 | loss: 0.3964064
	speed: 0.0623s/iter; left time: 2557.0595s
	iters: 300, epoch: 13 | loss: 0.0334589
	speed: 0.0602s/iter; left time: 2465.3093s
	iters: 400, epoch: 13 | loss: 0.0053244
	speed: 0.0604s/iter; left time: 2469.6017s
Epoch: 13 cost time: 28.928694486618042
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 1607434
model size : 15.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3023963
	speed: 0.0810s/iter; left time: 3789.9208s
	iters: 200, epoch: 1 | loss: 2.3008657
	speed: 0.0648s/iter; left time: 3026.2002s
	iters: 300, epoch: 1 | loss: 2.3012300
	speed: 0.0639s/iter; left time: 2977.0848s
	iters: 400, epoch: 1 | loss: 2.2979472
	speed: 0.0610s/iter; left time: 2838.4096s
Epoch: 1 cost time: 31.402796745300293
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3076289
	speed: 0.2633s/iter; left time: 12201.1098s
	iters: 200, epoch: 2 | loss: 2.2960017
	speed: 0.0644s/iter; left time: 2976.2746s
	iters: 300, epoch: 2 | loss: 2.3042798
	speed: 0.0623s/iter; left time: 2875.0433s
	iters: 400, epoch: 2 | loss: 2.3037720
	speed: 0.0590s/iter; left time: 2714.3771s
Epoch: 2 cost time: 29.356677532196045
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2940533
	speed: 0.2454s/iter; left time: 11253.5238s
	iters: 200, epoch: 3 | loss: 2.3104417
	speed: 0.0611s/iter; left time: 2796.9807s
	iters: 300, epoch: 3 | loss: 2.2964411
	speed: 0.0644s/iter; left time: 2938.8670s
	iters: 400, epoch: 3 | loss: 2.2995729
	speed: 0.0622s/iter; left time: 2836.1657s
Epoch: 3 cost time: 29.18635892868042
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3048871
	speed: 0.2607s/iter; left time: 11834.9690s
	iters: 200, epoch: 4 | loss: 2.3085284
	speed: 0.0640s/iter; left time: 2896.8479s
	iters: 300, epoch: 4 | loss: 2.2983637
	speed: 0.0641s/iter; left time: 2897.7773s
	iters: 400, epoch: 4 | loss: 2.3057318
	speed: 0.0612s/iter; left time: 2761.4545s
Epoch: 4 cost time: 29.475876092910767
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2889266
	speed: 0.2589s/iter; left time: 11632.7388s
	iters: 200, epoch: 5 | loss: 2.2990167
	speed: 0.0645s/iter; left time: 2892.6117s
	iters: 300, epoch: 5 | loss: 2.3097377
	speed: 0.0620s/iter; left time: 2774.5382s
	iters: 400, epoch: 5 | loss: 2.3121574
	speed: 0.0588s/iter; left time: 2622.0010s
Epoch: 5 cost time: 29.40384817123413
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3181100
	speed: 0.2490s/iter; left time: 11069.4367s
	iters: 200, epoch: 6 | loss: 2.3159547
	speed: 0.0591s/iter; left time: 2621.8429s
	iters: 300, epoch: 6 | loss: 2.3002858
	speed: 0.0602s/iter; left time: 2664.3119s
	iters: 400, epoch: 6 | loss: 2.3145063
	speed: 0.0647s/iter; left time: 2858.2336s
Epoch: 6 cost time: 28.957285165786743
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2981083
	speed: 0.2582s/iter; left time: 11358.6282s
	iters: 200, epoch: 7 | loss: 2.3002822
	speed: 0.0653s/iter; left time: 2864.8215s
	iters: 300, epoch: 7 | loss: 2.3119674
	speed: 0.0620s/iter; left time: 2716.4223s
	iters: 400, epoch: 7 | loss: 2.3003979
	speed: 0.0591s/iter; left time: 2583.7914s
Epoch: 7 cost time: 29.342805862426758
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2889638
	speed: 0.2672s/iter; left time: 11627.3386s
	iters: 200, epoch: 8 | loss: 2.3051310
	speed: 0.0637s/iter; left time: 2763.8502s
	iters: 300, epoch: 8 | loss: 2.2906401
	speed: 0.0615s/iter; left time: 2663.9659s
	iters: 400, epoch: 8 | loss: 2.3172874
	speed: 0.0604s/iter; left time: 2612.4519s
Epoch: 8 cost time: 29.550870418548584
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3151391
	speed: 0.2470s/iter; left time: 10632.5971s
	iters: 200, epoch: 9 | loss: 2.3184114
	speed: 0.0600s/iter; left time: 2577.3883s
	iters: 300, epoch: 9 | loss: 2.3024800
	speed: 0.0595s/iter; left time: 2548.6511s
	iters: 400, epoch: 9 | loss: 2.3125584
	speed: 0.0590s/iter; left time: 2523.7675s
Epoch: 9 cost time: 28.045141220092773
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3163450
	speed: 0.2527s/iter; left time: 10759.6419s
	iters: 200, epoch: 10 | loss: 2.2964065
	speed: 0.0617s/iter; left time: 2621.1607s
	iters: 300, epoch: 10 | loss: 2.2984138
	speed: 0.0603s/iter; left time: 2553.4533s
	iters: 400, epoch: 10 | loss: 2.2893608
	speed: 0.0606s/iter; left time: 2562.1777s
Epoch: 10 cost time: 29.222641944885254
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2888076
	speed: 0.2615s/iter; left time: 11013.6900s
	iters: 200, epoch: 11 | loss: 2.2989590
	speed: 0.0642s/iter; left time: 2696.8704s
	iters: 300, epoch: 11 | loss: 2.3017464
	speed: 0.0568s/iter; left time: 2379.3300s
	iters: 400, epoch: 11 | loss: 2.2935226
	speed: 0.0592s/iter; left time: 2475.4888s
Epoch: 11 cost time: 28.615926265716553
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3131471
	speed: 0.2437s/iter; left time: 10149.7626s
	iters: 200, epoch: 12 | loss: 2.3031020
	speed: 0.0644s/iter; left time: 2675.5169s
	iters: 300, epoch: 12 | loss: 2.3183594
	speed: 0.0626s/iter; left time: 2594.3236s
	iters: 400, epoch: 12 | loss: 2.2965810
	speed: 0.0604s/iter; left time: 2498.5909s
Epoch: 12 cost time: 29.06093955039978
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3215141
	speed: 0.2653s/iter; left time: 10921.4787s
	iters: 200, epoch: 13 | loss: 2.3023565
	speed: 0.0620s/iter; left time: 2547.2051s
	iters: 300, epoch: 13 | loss: 2.2838531
	speed: 0.0624s/iter; left time: 2558.0533s
	iters: 400, epoch: 13 | loss: 2.2923927
	speed: 0.0578s/iter; left time: 2363.5764s
Epoch: 13 cost time: 29.011086463928223
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.2928667
	speed: 0.2667s/iter; left time: 10857.5183s
	iters: 200, epoch: 14 | loss: 2.2929554
	speed: 0.0652s/iter; left time: 2648.4228s
	iters: 300, epoch: 14 | loss: 2.3007302
	speed: 0.0637s/iter; left time: 2581.7843s
	iters: 400, epoch: 14 | loss: 2.2946548
	speed: 0.0627s/iter; left time: 2532.4450s
Epoch: 14 cost time: 29.87963843345642
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.2948167
	speed: 0.2537s/iter; left time: 10207.6570s
	iters: 200, epoch: 15 | loss: 2.3183684
	speed: 0.0612s/iter; left time: 2457.8453s
	iters: 300, epoch: 15 | loss: 2.2871184
	speed: 0.0598s/iter; left time: 2392.3410s
	iters: 400, epoch: 15 | loss: 2.3083744
	speed: 0.0626s/iter; left time: 2499.1570s
Epoch: 15 cost time: 29.027555227279663
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.2961693
	speed: 0.2616s/iter; left time: 10404.6779s
	iters: 200, epoch: 16 | loss: 2.3025994
	speed: 0.0624s/iter; left time: 2473.9613s
	iters: 300, epoch: 16 | loss: 2.3028569
	speed: 0.0612s/iter; left time: 2422.1578s
	iters: 400, epoch: 16 | loss: 2.2927401
	speed: 0.0624s/iter; left time: 2463.7867s
Epoch: 16 cost time: 29.222031354904175
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.3097303
	speed: 0.2610s/iter; left time: 10255.2540s
	iters: 200, epoch: 17 | loss: 2.3151872
	speed: 0.0597s/iter; left time: 2338.3901s
	iters: 300, epoch: 17 | loss: 2.3063195
	speed: 0.0626s/iter; left time: 2448.0471s
	iters: 400, epoch: 17 | loss: 2.3033013
	speed: 0.0614s/iter; left time: 2392.5808s
Epoch: 17 cost time: 29.28317928314209
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.3050549
	speed: 0.2603s/iter; left time: 10105.1795s
	iters: 200, epoch: 18 | loss: 2.2989113
	speed: 0.0594s/iter; left time: 2299.8228s
	iters: 300, epoch: 18 | loss: 2.2987421
	speed: 0.0573s/iter; left time: 2214.6502s
	iters: 400, epoch: 18 | loss: 2.3122606
	speed: 0.0584s/iter; left time: 2251.4903s
Epoch: 18 cost time: 28.522260189056396
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3102906
	speed: 0.2561s/iter; left time: 9824.1860s
	iters: 200, epoch: 19 | loss: 2.3212032
	speed: 0.0566s/iter; left time: 2166.1849s
	iters: 300, epoch: 19 | loss: 2.3350611
	speed: 0.0571s/iter; left time: 2179.7170s
	iters: 400, epoch: 19 | loss: 2.3175950
	speed: 0.0549s/iter; left time: 2088.1308s
Epoch: 19 cost time: 27.672747135162354
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 1607434
model size : 15.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7213405
	speed: 0.0679s/iter; left time: 3179.4514s
	iters: 200, epoch: 1 | loss: 0.1738339
	speed: 0.0505s/iter; left time: 2358.8577s
	iters: 300, epoch: 1 | loss: 0.3101936
	speed: 0.0553s/iter; left time: 2578.7938s
	iters: 400, epoch: 1 | loss: 0.0562302
	speed: 0.0556s/iter; left time: 2583.5293s
Epoch: 1 cost time: 27.67130160331726
Epoch: 1, Steps: 469 | Train Loss: 0.421 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
Validation loss decreased (inf --> -0.954544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0203514
	speed: 0.2593s/iter; left time: 12014.8665s
	iters: 200, epoch: 2 | loss: 0.0211009
	speed: 0.0655s/iter; left time: 3028.8762s
	iters: 300, epoch: 2 | loss: 0.0103737
	speed: 0.0647s/iter; left time: 2986.8367s
	iters: 400, epoch: 2 | loss: 0.2122682
	speed: 0.0637s/iter; left time: 2931.2887s
Epoch: 2 cost time: 30.311572790145874
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0230046
	speed: 0.2464s/iter; left time: 11299.0393s
	iters: 200, epoch: 3 | loss: 0.0013198
	speed: 0.0606s/iter; left time: 2773.8124s
	iters: 300, epoch: 3 | loss: 0.1716921
	speed: 0.0642s/iter; left time: 2932.4911s
	iters: 400, epoch: 3 | loss: 0.3138949
	speed: 0.0653s/iter; left time: 2974.4957s
Epoch: 3 cost time: 29.46742343902588
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0484939
	speed: 0.2585s/iter; left time: 11733.5183s
	iters: 200, epoch: 4 | loss: 0.0050561
	speed: 0.0634s/iter; left time: 2871.2384s
	iters: 300, epoch: 4 | loss: 0.0178215
	speed: 0.0636s/iter; left time: 2876.2550s
	iters: 400, epoch: 4 | loss: 0.0038796
	speed: 0.0621s/iter; left time: 2801.8873s
Epoch: 4 cost time: 30.062597274780273
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0004077
	speed: 0.2614s/iter; left time: 11744.5037s
	iters: 200, epoch: 5 | loss: 0.0292687
	speed: 0.0639s/iter; left time: 2865.0303s
	iters: 300, epoch: 5 | loss: 0.0212125
	speed: 0.0619s/iter; left time: 2769.9826s
	iters: 400, epoch: 5 | loss: 0.0067453
	speed: 0.0633s/iter; left time: 2824.8214s
Epoch: 5 cost time: 29.78819513320923
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0810245
	speed: 0.2357s/iter; left time: 10480.1329s
	iters: 200, epoch: 6 | loss: 0.0272958
	speed: 0.0682s/iter; left time: 3023.3371s
	iters: 300, epoch: 6 | loss: 0.0102537
	speed: 0.0674s/iter; left time: 2983.3867s
	iters: 400, epoch: 6 | loss: 0.0169639
	speed: 0.0648s/iter; left time: 2861.2939s
Epoch: 6 cost time: 31.040515422821045
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.954544 --> -0.967980).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0046245
	speed: 0.2686s/iter; left time: 11816.5921s
	iters: 200, epoch: 7 | loss: 0.0042020
	speed: 0.0649s/iter; left time: 2848.6832s
	iters: 300, epoch: 7 | loss: 0.0750608
	speed: 0.0674s/iter; left time: 2953.3090s
	iters: 400, epoch: 7 | loss: 0.2739602
	speed: 0.0654s/iter; left time: 2856.6552s
Epoch: 7 cost time: 31.14770197868347
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.441 Vali Acc: 0.930 Test Loss: 0.441 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0013769
	speed: 0.2530s/iter; left time: 11011.4726s
	iters: 200, epoch: 8 | loss: 0.1396397
	speed: 0.0653s/iter; left time: 2835.6214s
	iters: 300, epoch: 8 | loss: 0.0095018
	speed: 0.0635s/iter; left time: 2751.1224s
	iters: 400, epoch: 8 | loss: 0.0002570
	speed: 0.0587s/iter; left time: 2535.2806s
Epoch: 8 cost time: 29.696913242340088
Epoch: 8, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0045110
	speed: 0.2555s/iter; left time: 11000.7340s
	iters: 200, epoch: 9 | loss: 0.0005973
	speed: 0.0656s/iter; left time: 2816.1063s
	iters: 300, epoch: 9 | loss: 0.0034046
	speed: 0.0662s/iter; left time: 2838.4589s
	iters: 400, epoch: 9 | loss: 0.0061755
	speed: 0.0666s/iter; left time: 2846.4808s
Epoch: 9 cost time: 30.97996425628662
Epoch: 9, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001033
	speed: 0.2435s/iter; left time: 10369.6138s
	iters: 200, epoch: 10 | loss: 0.0016356
	speed: 0.0678s/iter; left time: 2879.2762s
	iters: 300, epoch: 10 | loss: 0.0035627
	speed: 0.0678s/iter; left time: 2873.9541s
	iters: 400, epoch: 10 | loss: 0.0064950
	speed: 0.0670s/iter; left time: 2830.9755s
Epoch: 10 cost time: 31.110368013381958
Epoch: 10, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0003222
	speed: 0.2606s/iter; left time: 10972.3792s
	iters: 200, epoch: 11 | loss: 0.0014415
	speed: 0.0606s/iter; left time: 2546.8911s
	iters: 300, epoch: 11 | loss: 0.0428300
	speed: 0.0608s/iter; left time: 2548.3418s
	iters: 400, epoch: 11 | loss: 0.0150490
	speed: 0.0611s/iter; left time: 2553.7393s
Epoch: 11 cost time: 28.63504409790039
Epoch: 11, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0047276
	speed: 0.2397s/iter; left time: 9980.1186s
	iters: 200, epoch: 12 | loss: 0.1004433
	speed: 0.0649s/iter; left time: 2694.4649s
	iters: 300, epoch: 12 | loss: 0.0599378
	speed: 0.0673s/iter; left time: 2787.8935s
	iters: 400, epoch: 12 | loss: 0.0901387
	speed: 0.0672s/iter; left time: 2776.6028s
Epoch: 12 cost time: 30.782145977020264
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0177303
	speed: 0.2621s/iter; left time: 10792.8927s
	iters: 200, epoch: 13 | loss: 0.0062824
	speed: 0.0672s/iter; left time: 2759.5357s
	iters: 300, epoch: 13 | loss: 0.0445936
	speed: 0.0646s/iter; left time: 2647.0705s
	iters: 400, epoch: 13 | loss: 0.0003985
	speed: 0.0658s/iter; left time: 2690.4480s
Epoch: 13 cost time: 30.76518201828003
Epoch: 13, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0292093
	speed: 0.2556s/iter; left time: 10402.6678s
	iters: 200, epoch: 14 | loss: 0.0592199
	speed: 0.0643s/iter; left time: 2611.9786s
	iters: 300, epoch: 14 | loss: 0.0524143
	speed: 0.0625s/iter; left time: 2530.4861s
	iters: 400, epoch: 14 | loss: 0.0597041
	speed: 0.0617s/iter; left time: 2492.6428s
Epoch: 14 cost time: 29.648032188415527
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.967980 --> -0.975413).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0012648
	speed: 0.2586s/iter; left time: 10405.4574s
	iters: 200, epoch: 15 | loss: 0.0180295
	speed: 0.0680s/iter; left time: 2727.6394s
	iters: 300, epoch: 15 | loss: 0.0022272
	speed: 0.0678s/iter; left time: 2713.3408s
	iters: 400, epoch: 15 | loss: 0.0042992
	speed: 0.0667s/iter; left time: 2662.7391s
Epoch: 15 cost time: 31.841140747070312
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
Validation loss decreased (-0.975413 --> -0.977700).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0005039
	speed: 0.2603s/iter; left time: 10351.1247s
	iters: 200, epoch: 16 | loss: 0.0004549
	speed: 0.0681s/iter; left time: 2701.0431s
	iters: 300, epoch: 16 | loss: 0.0023330
	speed: 0.0676s/iter; left time: 2675.5172s
	iters: 400, epoch: 16 | loss: 0.0007513
	speed: 0.0665s/iter; left time: 2623.7346s
Epoch: 16 cost time: 31.367828130722046
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0954117
	speed: 0.2440s/iter; left time: 9588.3510s
	iters: 200, epoch: 17 | loss: 0.0092376
	speed: 0.0614s/iter; left time: 2406.8739s
	iters: 300, epoch: 17 | loss: 0.0275461
	speed: 0.0659s/iter; left time: 2575.5598s
	iters: 400, epoch: 17 | loss: 0.1214263
	speed: 0.0638s/iter; left time: 2487.2395s
Epoch: 17 cost time: 29.77713704109192
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0002849
	speed: 0.2602s/iter; left time: 10104.5708s
	iters: 200, epoch: 18 | loss: 0.0010501
	speed: 0.0656s/iter; left time: 2539.8259s
	iters: 300, epoch: 18 | loss: 0.0012460
	speed: 0.0672s/iter; left time: 2594.5656s
	iters: 400, epoch: 18 | loss: 0.0076200
	speed: 0.0634s/iter; left time: 2443.8490s
Epoch: 18 cost time: 31.00929570198059
Epoch: 18, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0003680
	speed: 0.2592s/iter; left time: 9944.5514s
	iters: 200, epoch: 19 | loss: 0.1708201
	speed: 0.0681s/iter; left time: 2605.2175s
	iters: 300, epoch: 19 | loss: 0.1037747
	speed: 0.0664s/iter; left time: 2533.5093s
	iters: 400, epoch: 19 | loss: 0.0000634
	speed: 0.0650s/iter; left time: 2473.2200s
Epoch: 19 cost time: 31.267083644866943
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5362090
	speed: 0.2439s/iter; left time: 9240.3519s
	iters: 200, epoch: 20 | loss: 0.7629982
	speed: 0.0630s/iter; left time: 2381.9731s
	iters: 300, epoch: 20 | loss: 0.2010024
	speed: 0.0717s/iter; left time: 2703.2157s
	iters: 400, epoch: 20 | loss: 0.0005585
	speed: 0.0636s/iter; left time: 2390.0272s
Epoch: 20 cost time: 30.535078287124634
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000191
	speed: 0.2571s/iter; left time: 9622.3883s
	iters: 200, epoch: 21 | loss: 0.0122959
	speed: 0.0656s/iter; left time: 2448.9760s
	iters: 300, epoch: 21 | loss: 0.2543449
	speed: 0.0674s/iter; left time: 2506.8569s
	iters: 400, epoch: 21 | loss: 0.0011213
	speed: 0.0680s/iter; left time: 2524.1207s
Epoch: 21 cost time: 31.398228406906128
Epoch: 21, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0006415
	speed: 0.2536s/iter; left time: 9372.3938s
	iters: 200, epoch: 22 | loss: 0.0003217
	speed: 0.0660s/iter; left time: 2431.2601s
	iters: 300, epoch: 22 | loss: 0.0001039
	speed: 0.0684s/iter; left time: 2514.1207s
	iters: 400, epoch: 22 | loss: 0.0002643
	speed: 0.0651s/iter; left time: 2386.9571s
Epoch: 22 cost time: 30.95012354850769
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0116253
	speed: 0.2527s/iter; left time: 9219.4139s
	iters: 200, epoch: 23 | loss: 0.0000145
	speed: 0.0656s/iter; left time: 2385.0884s
	iters: 300, epoch: 23 | loss: 0.0013605
	speed: 0.0644s/iter; left time: 2337.0173s
	iters: 400, epoch: 23 | loss: 0.0003644
	speed: 0.0673s/iter; left time: 2434.9655s
Epoch: 23 cost time: 30.636449813842773
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0018570
	speed: 0.2603s/iter; left time: 9373.4896s
	iters: 200, epoch: 24 | loss: 0.0307844
	speed: 0.0679s/iter; left time: 2439.0161s
	iters: 300, epoch: 24 | loss: 0.0620697
	speed: 0.0682s/iter; left time: 2442.1509s
	iters: 400, epoch: 24 | loss: 0.0007612
	speed: 0.0648s/iter; left time: 2313.5377s
Epoch: 24 cost time: 31.383424520492554
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0063613
	speed: 0.2495s/iter; left time: 8868.0849s
	iters: 200, epoch: 25 | loss: 0.0008754
	speed: 0.0682s/iter; left time: 2417.9219s
	iters: 300, epoch: 25 | loss: 0.0000266
	speed: 0.0681s/iter; left time: 2406.7540s
	iters: 400, epoch: 25 | loss: 0.0001050
	speed: 0.0673s/iter; left time: 2370.9396s
Epoch: 25 cost time: 31.329528331756592
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.328 Vali Acc: 0.960 Test Loss: 0.328 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 1410826
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7963377
	speed: 0.0817s/iter; left time: 3824.1339s
	iters: 200, epoch: 1 | loss: 0.1704476
	speed: 0.0615s/iter; left time: 2870.9983s
	iters: 300, epoch: 1 | loss: 0.3218557
	speed: 0.0632s/iter; left time: 2946.1210s
	iters: 400, epoch: 1 | loss: 0.0672623
	speed: 0.0629s/iter; left time: 2924.4354s
Epoch: 1 cost time: 31.486048221588135
Epoch: 1, Steps: 469 | Train Loss: 0.459 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
Validation loss decreased (inf --> -0.952828).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0323720
	speed: 0.2628s/iter; left time: 12177.7788s
	iters: 200, epoch: 2 | loss: 0.0276841
	speed: 0.0649s/iter; left time: 3001.8515s
	iters: 300, epoch: 2 | loss: 0.0106347
	speed: 0.0612s/iter; left time: 2821.5704s
	iters: 400, epoch: 2 | loss: 0.2066381
	speed: 0.0600s/iter; left time: 2762.1095s
Epoch: 2 cost time: 29.720364570617676
Epoch: 2, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.202 Vali Acc: 0.934 Test Loss: 0.202 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0793836
	speed: 0.2782s/iter; left time: 12758.9353s
	iters: 200, epoch: 3 | loss: 0.0022721
	speed: 0.0628s/iter; left time: 2872.2106s
	iters: 300, epoch: 3 | loss: 0.2042800
	speed: 0.0603s/iter; left time: 2752.5625s
	iters: 400, epoch: 3 | loss: 0.0752211
	speed: 0.0597s/iter; left time: 2720.7663s
Epoch: 3 cost time: 29.56288194656372
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.200 Vali Acc: 0.940 Test Loss: 0.200 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0203234
	speed: 0.2731s/iter; left time: 12396.5086s
	iters: 200, epoch: 4 | loss: 0.0025604
	speed: 0.0626s/iter; left time: 2836.3187s
	iters: 300, epoch: 4 | loss: 0.2308707
	speed: 0.0582s/iter; left time: 2628.2652s
	iters: 400, epoch: 4 | loss: 0.0851373
	speed: 0.0581s/iter; left time: 2618.6246s
Epoch: 4 cost time: 29.52207112312317
Epoch: 4, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.952828 --> -0.957403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0349870
	speed: 0.1962s/iter; left time: 8816.4863s
	iters: 200, epoch: 5 | loss: 0.0108004
	speed: 0.0542s/iter; left time: 2430.5261s
	iters: 300, epoch: 5 | loss: 0.0009699
	speed: 0.0540s/iter; left time: 2417.2967s
	iters: 400, epoch: 5 | loss: 0.0046289
	speed: 0.0551s/iter; left time: 2457.1509s
Epoch: 5 cost time: 26.26345133781433
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0027716
	speed: 0.2597s/iter; left time: 11543.7315s
	iters: 200, epoch: 6 | loss: 0.2481085
	speed: 0.0617s/iter; left time: 2735.3908s
	iters: 300, epoch: 6 | loss: 0.0045542
	speed: 0.0668s/iter; left time: 2954.5931s
	iters: 400, epoch: 6 | loss: 0.0773192
	speed: 0.0631s/iter; left time: 2787.6839s
Epoch: 6 cost time: 30.624752283096313
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.247 Vali Acc: 0.945 Test Loss: 0.247 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0025527
	speed: 0.2447s/iter; left time: 10764.1959s
	iters: 200, epoch: 7 | loss: 0.0341882
	speed: 0.0700s/iter; left time: 3069.9959s
	iters: 300, epoch: 7 | loss: 0.1998948
	speed: 0.0722s/iter; left time: 3160.3659s
	iters: 400, epoch: 7 | loss: 0.0455068
	speed: 0.0720s/iter; left time: 3146.3702s
Epoch: 7 cost time: 32.35358119010925
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.957403 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005081
	speed: 0.2607s/iter; left time: 11347.0942s
	iters: 200, epoch: 8 | loss: 0.2201010
	speed: 0.0691s/iter; left time: 3000.4701s
	iters: 300, epoch: 8 | loss: 0.0077774
	speed: 0.0713s/iter; left time: 3087.7437s
	iters: 400, epoch: 8 | loss: 0.0057751
	speed: 0.0698s/iter; left time: 3017.8614s
Epoch: 8 cost time: 32.003175497055054
Epoch: 8, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0002659
	speed: 0.2425s/iter; left time: 10437.5475s
	iters: 200, epoch: 9 | loss: 0.0010163
	speed: 0.0650s/iter; left time: 2792.2036s
	iters: 300, epoch: 9 | loss: 0.0111760
	speed: 0.0655s/iter; left time: 2805.5242s
	iters: 400, epoch: 9 | loss: 0.0050631
	speed: 0.0677s/iter; left time: 2894.3526s
Epoch: 9 cost time: 30.85732936859131
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0017059
	speed: 0.2571s/iter; left time: 10948.2192s
	iters: 200, epoch: 10 | loss: 0.0021016
	speed: 0.0648s/iter; left time: 2750.9425s
	iters: 300, epoch: 10 | loss: 0.1015390
	speed: 0.0645s/iter; left time: 2733.4625s
	iters: 400, epoch: 10 | loss: 0.0246029
	speed: 0.0641s/iter; left time: 2708.7887s
Epoch: 10 cost time: 30.563889026641846
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0042549
	speed: 0.2642s/iter; left time: 11127.2820s
	iters: 200, epoch: 11 | loss: 0.0002257
	speed: 0.0676s/iter; left time: 2838.2894s
	iters: 300, epoch: 11 | loss: 0.0293606
	speed: 0.0698s/iter; left time: 2924.4790s
	iters: 400, epoch: 11 | loss: 0.0775865
	speed: 0.0674s/iter; left time: 2818.7991s
Epoch: 11 cost time: 32.026313066482544
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005255
	speed: 0.2515s/iter; left time: 10474.9454s
	iters: 200, epoch: 12 | loss: 0.0228028
	speed: 0.0604s/iter; left time: 2510.1581s
	iters: 300, epoch: 12 | loss: 0.0379849
	speed: 0.0634s/iter; left time: 2629.1161s
	iters: 400, epoch: 12 | loss: 0.4572967
	speed: 0.0657s/iter; left time: 2714.6056s
Epoch: 12 cost time: 29.699480533599854
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1028629
	speed: 0.2501s/iter; left time: 10298.9648s
	iters: 200, epoch: 13 | loss: 0.0282720
	speed: 0.0684s/iter; left time: 2808.5311s
	iters: 300, epoch: 13 | loss: 0.1851261
	speed: 0.0667s/iter; left time: 2734.3559s
	iters: 400, epoch: 13 | loss: 0.0071751
	speed: 0.0647s/iter; left time: 2644.9754s
Epoch: 13 cost time: 30.923919200897217
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0010489
	speed: 0.2424s/iter; left time: 9865.1251s
	iters: 200, epoch: 14 | loss: 0.0156571
	speed: 0.0665s/iter; left time: 2700.5811s
	iters: 300, epoch: 14 | loss: 0.0048273
	speed: 0.0667s/iter; left time: 2703.2915s
	iters: 400, epoch: 14 | loss: 0.0012285
	speed: 0.0637s/iter; left time: 2573.0584s
Epoch: 14 cost time: 30.50733971595764
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0824173
	speed: 0.2573s/iter; left time: 10350.9276s
	iters: 200, epoch: 15 | loss: 0.0005848
	speed: 0.0622s/iter; left time: 2498.2787s
	iters: 300, epoch: 15 | loss: 0.0148921
	speed: 0.0619s/iter; left time: 2476.3322s
	iters: 400, epoch: 15 | loss: 0.0010424
	speed: 0.0624s/iter; left time: 2491.7435s
Epoch: 15 cost time: 29.54242491722107
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0616178
	speed: 0.2332s/iter; left time: 9274.2221s
	iters: 200, epoch: 16 | loss: 0.0065810
	speed: 0.0678s/iter; left time: 2688.5555s
	iters: 300, epoch: 16 | loss: 0.1367362
	speed: 0.0651s/iter; left time: 2577.5533s
	iters: 400, epoch: 16 | loss: 0.0073830
	speed: 0.0654s/iter; left time: 2579.9348s
Epoch: 16 cost time: 30.743804931640625
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4874258
	speed: 0.2544s/iter; left time: 9998.3803s
	iters: 200, epoch: 17 | loss: 0.0101387
	speed: 0.0664s/iter; left time: 2603.5084s
	iters: 300, epoch: 17 | loss: 0.0031271
	speed: 0.0654s/iter; left time: 2557.3674s
	iters: 400, epoch: 17 | loss: 0.0243248
	speed: 0.0637s/iter; left time: 2483.8090s
Epoch: 17 cost time: 30.54917860031128
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.977129).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000348
	speed: 0.2330s/iter; left time: 9046.0326s
	iters: 200, epoch: 18 | loss: 0.1636676
	speed: 0.0589s/iter; left time: 2282.8655s
	iters: 300, epoch: 18 | loss: 0.0513973
	speed: 0.0564s/iter; left time: 2177.7661s
	iters: 400, epoch: 18 | loss: 0.0027116
	speed: 0.0616s/iter; left time: 2372.5189s
Epoch: 18 cost time: 28.143521547317505
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0190798
	speed: 0.2542s/iter; left time: 9750.2773s
	iters: 200, epoch: 19 | loss: 0.0007471
	speed: 0.0605s/iter; left time: 2314.1375s
	iters: 300, epoch: 19 | loss: 0.0065227
	speed: 0.0594s/iter; left time: 2266.2671s
	iters: 400, epoch: 19 | loss: 0.0155577
	speed: 0.0639s/iter; left time: 2430.1808s
Epoch: 19 cost time: 29.071544885635376
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1352879
	speed: 0.2624s/iter; left time: 9943.1437s
	iters: 200, epoch: 20 | loss: 0.3066990
	speed: 0.0602s/iter; left time: 2275.8209s
	iters: 300, epoch: 20 | loss: 0.2219100
	speed: 0.0589s/iter; left time: 2221.5154s
	iters: 400, epoch: 20 | loss: 0.0128468
	speed: 0.0635s/iter; left time: 2385.8525s
Epoch: 20 cost time: 29.408118963241577
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001325
	speed: 0.2759s/iter; left time: 10324.4168s
	iters: 200, epoch: 21 | loss: 0.0326256
	speed: 0.0615s/iter; left time: 2293.5704s
	iters: 300, epoch: 21 | loss: 0.1252117
	speed: 0.0599s/iter; left time: 2228.3796s
	iters: 400, epoch: 21 | loss: 0.0002235
	speed: 0.0622s/iter; left time: 2307.4340s
Epoch: 21 cost time: 29.64065957069397
Epoch: 21, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0660798
	speed: 0.2518s/iter; left time: 9304.8493s
	iters: 200, epoch: 22 | loss: 0.1297003
	speed: 0.0605s/iter; left time: 2229.0426s
	iters: 300, epoch: 22 | loss: 0.0016668
	speed: 0.0647s/iter; left time: 2379.6408s
	iters: 400, epoch: 22 | loss: 0.0005716
	speed: 0.0672s/iter; left time: 2462.6693s
Epoch: 22 cost time: 30.281641483306885
Epoch: 22, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0005406
	speed: 0.2777s/iter; left time: 10131.7926s
	iters: 200, epoch: 23 | loss: 0.0012660
	speed: 0.0634s/iter; left time: 2307.4878s
	iters: 300, epoch: 23 | loss: 0.0421794
	speed: 0.0644s/iter; left time: 2334.9815s
	iters: 400, epoch: 23 | loss: 0.0000585
	speed: 0.0673s/iter; left time: 2434.9944s
Epoch: 23 cost time: 30.678621768951416
Epoch: 23, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0003025
	speed: 0.2477s/iter; left time: 8921.9157s
	iters: 200, epoch: 24 | loss: 0.2381407
	speed: 0.0641s/iter; left time: 2301.0534s
	iters: 300, epoch: 24 | loss: 0.0002676
	speed: 0.0638s/iter; left time: 2286.1053s
	iters: 400, epoch: 24 | loss: 0.0001482
	speed: 0.0620s/iter; left time: 2213.4069s
Epoch: 24 cost time: 29.325538158416748
Epoch: 24, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0151215
	speed: 0.2562s/iter; left time: 9107.4279s
	iters: 200, epoch: 25 | loss: 0.0465121
	speed: 0.0592s/iter; left time: 2098.8296s
	iters: 300, epoch: 25 | loss: 0.0000285
	speed: 0.0597s/iter; left time: 2111.1395s
	iters: 400, epoch: 25 | loss: 0.0039661
	speed: 0.0681s/iter; left time: 2401.8069s
Epoch: 25 cost time: 29.698291778564453
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0303420
	speed: 0.2473s/iter; left time: 8674.0657s
	iters: 200, epoch: 26 | loss: 0.1258571
	speed: 0.0600s/iter; left time: 2098.0763s
	iters: 300, epoch: 26 | loss: 0.0003034
	speed: 0.0506s/iter; left time: 1763.1853s
	iters: 400, epoch: 26 | loss: 0.0001620
	speed: 0.0508s/iter; left time: 1766.8550s
Epoch: 26 cost time: 25.622323274612427
Epoch: 26, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0182043
	speed: 0.2088s/iter; left time: 7226.9557s
	iters: 200, epoch: 27 | loss: 0.0000190
	speed: 0.0596s/iter; left time: 2055.5121s
	iters: 300, epoch: 27 | loss: 0.0003452
	speed: 0.0605s/iter; left time: 2083.0707s
	iters: 400, epoch: 27 | loss: 0.0010190
	speed: 0.0600s/iter; left time: 2057.5512s
Epoch: 27 cost time: 29.370129823684692
Epoch: 27, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 1410826
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7764959
	speed: 0.0737s/iter; left time: 3449.5976s
	iters: 200, epoch: 1 | loss: 0.1773765
	speed: 0.0623s/iter; left time: 2909.0162s
	iters: 300, epoch: 1 | loss: 0.3255010
	speed: 0.0657s/iter; left time: 3063.2371s
	iters: 400, epoch: 1 | loss: 0.0857922
	speed: 0.0642s/iter; left time: 2985.9639s
Epoch: 1 cost time: 31.25394320487976
Epoch: 1, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0521209
	speed: 0.2481s/iter; left time: 11494.9840s
	iters: 200, epoch: 2 | loss: 0.0571178
	speed: 0.0641s/iter; left time: 2963.1408s
	iters: 300, epoch: 2 | loss: 0.0150833
	speed: 0.0653s/iter; left time: 3014.0677s
	iters: 400, epoch: 2 | loss: 0.0226400
	speed: 0.0650s/iter; left time: 2993.1206s
Epoch: 2 cost time: 30.81335711479187
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0762351
	speed: 0.2655s/iter; left time: 12174.8873s
	iters: 200, epoch: 3 | loss: 0.0035918
	speed: 0.0616s/iter; left time: 2817.1365s
	iters: 300, epoch: 3 | loss: 0.2232098
	speed: 0.0619s/iter; left time: 2825.1802s
	iters: 400, epoch: 3 | loss: 0.2166064
	speed: 0.0592s/iter; left time: 2696.0521s
Epoch: 3 cost time: 29.15371322631836
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.951685 --> -0.957403).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0140444
	speed: 0.2496s/iter; left time: 11332.5854s
	iters: 200, epoch: 4 | loss: 0.0329240
	speed: 0.0587s/iter; left time: 2659.5231s
	iters: 300, epoch: 4 | loss: 0.0352622
	speed: 0.0589s/iter; left time: 2662.0809s
	iters: 400, epoch: 4 | loss: 0.1250854
	speed: 0.0560s/iter; left time: 2523.1592s
Epoch: 4 cost time: 27.79187846183777
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
Validation loss decreased (-0.957403 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0007340
	speed: 0.2718s/iter; left time: 12208.4392s
	iters: 200, epoch: 5 | loss: 0.0349948
	speed: 0.0663s/iter; left time: 2970.7973s
	iters: 300, epoch: 5 | loss: 0.0085915
	speed: 0.0635s/iter; left time: 2839.2536s
	iters: 400, epoch: 5 | loss: 0.1612104
	speed: 0.0609s/iter; left time: 2716.8783s
Epoch: 5 cost time: 30.299490690231323
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0008418
	speed: 0.2568s/iter; left time: 11415.5125s
	iters: 200, epoch: 6 | loss: 0.0055230
	speed: 0.0627s/iter; left time: 2783.2872s
	iters: 300, epoch: 6 | loss: 0.0265990
	speed: 0.0627s/iter; left time: 2773.4142s
	iters: 400, epoch: 6 | loss: 0.0108438
	speed: 0.0625s/iter; left time: 2758.4382s
Epoch: 6 cost time: 30.070948362350464
Epoch: 6, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.964264 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0223764
	speed: 0.2618s/iter; left time: 11517.2191s
	iters: 200, epoch: 7 | loss: 0.0026500
	speed: 0.0549s/iter; left time: 2407.8136s
	iters: 300, epoch: 7 | loss: 0.2631616
	speed: 0.0549s/iter; left time: 2402.7257s
	iters: 400, epoch: 7 | loss: 0.4238546
	speed: 0.0573s/iter; left time: 2501.1829s
Epoch: 7 cost time: 27.284103631973267
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0006769
	speed: 0.2677s/iter; left time: 11649.0298s
	iters: 200, epoch: 8 | loss: 0.1345023
	speed: 0.0605s/iter; left time: 2625.0055s
	iters: 300, epoch: 8 | loss: 0.0471009
	speed: 0.0614s/iter; left time: 2661.5299s
	iters: 400, epoch: 8 | loss: 0.0024869
	speed: 0.0618s/iter; left time: 2672.6486s
Epoch: 8 cost time: 29.34817624092102
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001638
	speed: 0.2561s/iter; left time: 11023.9746s
	iters: 200, epoch: 9 | loss: 0.0099832
	speed: 0.0618s/iter; left time: 2653.4512s
	iters: 300, epoch: 9 | loss: 0.0038501
	speed: 0.0609s/iter; left time: 2610.7106s
	iters: 400, epoch: 9 | loss: 0.0152121
	speed: 0.0613s/iter; left time: 2622.5373s
Epoch: 9 cost time: 29.553834676742554
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.255 Vali Acc: 0.959 Test Loss: 0.255 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0004096
	speed: 0.2687s/iter; left time: 11439.6933s
	iters: 200, epoch: 10 | loss: 0.0413404
	speed: 0.0560s/iter; left time: 2377.0166s
	iters: 300, epoch: 10 | loss: 0.0013516
	speed: 0.0576s/iter; left time: 2442.4105s
	iters: 400, epoch: 10 | loss: 0.0181889
	speed: 0.0622s/iter; left time: 2631.9034s
Epoch: 10 cost time: 28.60635256767273
Epoch: 10, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.353 Vali Acc: 0.914 Test Loss: 0.353 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0298711
	speed: 0.2627s/iter; left time: 11061.2537s
	iters: 200, epoch: 11 | loss: 0.0008347
	speed: 0.0630s/iter; left time: 2647.8206s
	iters: 300, epoch: 11 | loss: 0.0091385
	speed: 0.0648s/iter; left time: 2716.9495s
	iters: 400, epoch: 11 | loss: 0.1536675
	speed: 0.0617s/iter; left time: 2579.6191s
Epoch: 11 cost time: 29.68933939933777
Epoch: 11, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0029013
	speed: 0.2469s/iter; left time: 10281.3350s
	iters: 200, epoch: 12 | loss: 0.8374661
	speed: 0.0630s/iter; left time: 2616.0764s
	iters: 300, epoch: 12 | loss: 0.1415416
	speed: 0.0596s/iter; left time: 2468.8934s
	iters: 400, epoch: 12 | loss: 0.6019474
	speed: 0.0620s/iter; left time: 2563.5140s
Epoch: 12 cost time: 29.34244394302368
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0780688
	speed: 0.2690s/iter; left time: 11075.3151s
	iters: 200, epoch: 13 | loss: 0.1493540
	speed: 0.0554s/iter; left time: 2274.5903s
	iters: 300, epoch: 13 | loss: 0.0225956
	speed: 0.0550s/iter; left time: 2252.0388s
	iters: 400, epoch: 13 | loss: 0.0012030
	speed: 0.0629s/iter; left time: 2570.9090s
Epoch: 13 cost time: 28.33427882194519
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0075194
	speed: 0.2625s/iter; left time: 10683.9446s
	iters: 200, epoch: 14 | loss: 0.0007898
	speed: 0.0609s/iter; left time: 2470.9651s
	iters: 300, epoch: 14 | loss: 0.0144698
	speed: 0.0589s/iter; left time: 2386.0193s
	iters: 400, epoch: 14 | loss: 0.0780940
	speed: 0.0662s/iter; left time: 2676.7381s
Epoch: 14 cost time: 29.929394006729126
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0021308
	speed: 0.2619s/iter; left time: 10536.8107s
	iters: 200, epoch: 15 | loss: 0.0044924
	speed: 0.0620s/iter; left time: 2488.1466s
	iters: 300, epoch: 15 | loss: 0.0010002
	speed: 0.0624s/iter; left time: 2499.8425s
	iters: 400, epoch: 15 | loss: 0.0018404
	speed: 0.0663s/iter; left time: 2647.6877s
Epoch: 15 cost time: 30.52657461166382
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.974556 --> -0.977986).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0021436
	speed: 0.2757s/iter; left time: 10964.1387s
	iters: 200, epoch: 16 | loss: 0.0031249
	speed: 0.0585s/iter; left time: 2321.2554s
	iters: 300, epoch: 16 | loss: 0.0021780
	speed: 0.0588s/iter; left time: 2328.3701s
	iters: 400, epoch: 16 | loss: 0.0003608
	speed: 0.0586s/iter; left time: 2311.0288s
Epoch: 16 cost time: 28.488592386245728
Epoch: 16, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0121733
	speed: 0.2633s/iter; left time: 10345.6990s
	iters: 200, epoch: 17 | loss: 0.0018158
	speed: 0.0669s/iter; left time: 2622.5627s
	iters: 300, epoch: 17 | loss: 0.0007855
	speed: 0.0664s/iter; left time: 2594.7080s
	iters: 400, epoch: 17 | loss: 0.0240924
	speed: 0.0702s/iter; left time: 2738.9036s
Epoch: 17 cost time: 31.579761028289795
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0007058
	speed: 0.2679s/iter; left time: 10400.7614s
	iters: 200, epoch: 18 | loss: 0.0011877
	speed: 0.0636s/iter; left time: 2463.1549s
	iters: 300, epoch: 18 | loss: 0.0467773
	speed: 0.0691s/iter; left time: 2668.4400s
	iters: 400, epoch: 18 | loss: 0.0578173
	speed: 0.0689s/iter; left time: 2655.2899s
Epoch: 18 cost time: 31.47103977203369
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0009202
	speed: 0.2663s/iter; left time: 10213.1633s
	iters: 200, epoch: 19 | loss: 0.0001088
	speed: 0.0625s/iter; left time: 2392.9016s
	iters: 300, epoch: 19 | loss: 0.1044986
	speed: 0.0626s/iter; left time: 2390.0082s
	iters: 400, epoch: 19 | loss: 0.0003419
	speed: 0.0604s/iter; left time: 2300.0984s
Epoch: 19 cost time: 29.135453462600708
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0589205
	speed: 0.2573s/iter; left time: 9750.2074s
	iters: 200, epoch: 20 | loss: 0.4406079
	speed: 0.0647s/iter; left time: 2445.4599s
	iters: 300, epoch: 20 | loss: 0.3322997
	speed: 0.0661s/iter; left time: 2490.7689s
	iters: 400, epoch: 20 | loss: 0.1479276
	speed: 0.0695s/iter; left time: 2610.7859s
Epoch: 20 cost time: 31.22540259361267
Epoch: 20, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0001916
	speed: 0.2590s/iter; left time: 9692.4061s
	iters: 200, epoch: 21 | loss: 0.0746038
	speed: 0.0649s/iter; left time: 2423.5782s
	iters: 300, epoch: 21 | loss: 0.2895521
	speed: 0.0681s/iter; left time: 2535.4314s
	iters: 400, epoch: 21 | loss: 0.0000112
	speed: 0.0716s/iter; left time: 2656.2701s
Epoch: 21 cost time: 31.579044580459595
Epoch: 21, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0047649
	speed: 0.2570s/iter; left time: 9497.5513s
	iters: 200, epoch: 22 | loss: 0.0067717
	speed: 0.0603s/iter; left time: 2222.9378s
	iters: 300, epoch: 22 | loss: 0.0008575
	speed: 0.0650s/iter; left time: 2388.8011s
	iters: 400, epoch: 22 | loss: 0.0034701
	speed: 0.0612s/iter; left time: 2241.6574s
Epoch: 22 cost time: 29.35968852043152
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0001306
	speed: 0.2134s/iter; left time: 7785.5666s
	iters: 200, epoch: 23 | loss: 0.0005402
	speed: 0.0522s/iter; left time: 1899.2447s
	iters: 300, epoch: 23 | loss: 0.0005025
	speed: 0.0528s/iter; left time: 1916.1869s
	iters: 400, epoch: 23 | loss: 0.0057642
	speed: 0.0554s/iter; left time: 2006.1270s
Epoch: 23 cost time: 26.023938417434692
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0007420
	speed: 0.2460s/iter; left time: 8858.8564s
	iters: 200, epoch: 24 | loss: 0.0033672
	speed: 0.0581s/iter; left time: 2086.6421s
	iters: 300, epoch: 24 | loss: 0.1623842
	speed: 0.0647s/iter; left time: 2318.2448s
	iters: 400, epoch: 24 | loss: 0.0013326
	speed: 0.0699s/iter; left time: 2495.6645s
Epoch: 24 cost time: 30.78089451789856
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.275 Vali Acc: 0.959 Test Loss: 0.275 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0004191
	speed: 0.2598s/iter; left time: 9235.1612s
	iters: 200, epoch: 25 | loss: 0.0000529
	speed: 0.0589s/iter; left time: 2087.7324s
	iters: 300, epoch: 25 | loss: 0.0001067
	speed: 0.0686s/iter; left time: 2426.1075s
	iters: 400, epoch: 25 | loss: 0.0033420
	speed: 0.0685s/iter; left time: 2414.3296s
Epoch: 25 cost time: 30.25965142250061
Epoch: 25, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 1410826
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3023169
	speed: 0.0781s/iter; left time: 3657.0216s
	iters: 200, epoch: 1 | loss: 2.2998400
	speed: 0.0606s/iter; left time: 2829.3302s
	iters: 300, epoch: 1 | loss: 2.3018436
	speed: 0.0606s/iter; left time: 2823.5096s
	iters: 400, epoch: 1 | loss: 2.3025582
	speed: 0.0561s/iter; left time: 2610.5905s
Epoch: 1 cost time: 29.662877559661865
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3009055
	speed: 0.2723s/iter; left time: 12618.4889s
	iters: 200, epoch: 2 | loss: 2.2994905
	speed: 0.0687s/iter; left time: 3175.8895s
	iters: 300, epoch: 2 | loss: 2.3017488
	speed: 0.0649s/iter; left time: 2992.2540s
	iters: 400, epoch: 2 | loss: 2.3046048
	speed: 0.0562s/iter; left time: 2586.4129s
Epoch: 2 cost time: 30.528530836105347
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2976344
	speed: 0.2715s/iter; left time: 12451.9424s
	iters: 200, epoch: 3 | loss: 2.3031852
	speed: 0.0628s/iter; left time: 2871.7095s
	iters: 300, epoch: 3 | loss: 2.3150160
	speed: 0.0616s/iter; left time: 2812.2964s
	iters: 400, epoch: 3 | loss: 2.3064981
	speed: 0.0579s/iter; left time: 2636.8020s
Epoch: 3 cost time: 29.014501571655273
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2945073
	speed: 0.2612s/iter; left time: 11855.7136s
	iters: 200, epoch: 4 | loss: 2.2911558
	speed: 0.0601s/iter; left time: 2721.2124s
	iters: 300, epoch: 4 | loss: 2.2916229
	speed: 0.0598s/iter; left time: 2704.3364s
	iters: 400, epoch: 4 | loss: 2.2971110
	speed: 0.0588s/iter; left time: 2651.0282s
Epoch: 4 cost time: 29.167219400405884
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3106484
	speed: 0.2732s/iter; left time: 12273.0280s
	iters: 200, epoch: 5 | loss: 2.3054385
	speed: 0.0673s/iter; left time: 3015.7845s
	iters: 300, epoch: 5 | loss: 2.3008769
	speed: 0.0640s/iter; left time: 2860.4506s
	iters: 400, epoch: 5 | loss: 2.3017604
	speed: 0.0626s/iter; left time: 2795.3541s
Epoch: 5 cost time: 30.68494701385498
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2953863
	speed: 0.2756s/iter; left time: 12251.3553s
	iters: 200, epoch: 6 | loss: 2.3022156
	speed: 0.0644s/iter; left time: 2858.5270s
	iters: 300, epoch: 6 | loss: 2.3157282
	speed: 0.0608s/iter; left time: 2691.3525s
	iters: 400, epoch: 6 | loss: 2.3016186
	speed: 0.0627s/iter; left time: 2767.9385s
Epoch: 6 cost time: 29.912041664123535
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3013902
	speed: 0.2543s/iter; left time: 11187.1574s
	iters: 200, epoch: 7 | loss: 2.3082340
	speed: 0.0626s/iter; left time: 2749.4016s
	iters: 300, epoch: 7 | loss: 2.3038576
	speed: 0.0633s/iter; left time: 2772.6293s
	iters: 400, epoch: 7 | loss: 2.2998958
	speed: 0.0587s/iter; left time: 2563.8459s
Epoch: 7 cost time: 29.02230215072632
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.2958682
	speed: 0.2591s/iter; left time: 11276.4776s
	iters: 200, epoch: 8 | loss: 2.3069658
	speed: 0.0647s/iter; left time: 2809.6161s
	iters: 300, epoch: 8 | loss: 2.2920294
	speed: 0.0669s/iter; left time: 2899.6134s
	iters: 400, epoch: 8 | loss: 2.3028419
	speed: 0.0642s/iter; left time: 2775.4626s
Epoch: 8 cost time: 30.253185510635376
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3079524
	speed: 0.2560s/iter; left time: 11019.8946s
	iters: 200, epoch: 9 | loss: 2.2900901
	speed: 0.0673s/iter; left time: 2892.2517s
	iters: 300, epoch: 9 | loss: 2.2963383
	speed: 0.0685s/iter; left time: 2936.3303s
	iters: 400, epoch: 9 | loss: 2.2908607
	speed: 0.0699s/iter; left time: 2987.8891s
Epoch: 9 cost time: 31.29229497909546
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3061669
	speed: 0.2479s/iter; left time: 10556.1325s
	iters: 200, epoch: 10 | loss: 2.3222816
	speed: 0.0643s/iter; left time: 2730.1010s
	iters: 300, epoch: 10 | loss: 2.3151038
	speed: 0.0646s/iter; left time: 2737.0845s
	iters: 400, epoch: 10 | loss: 2.3137326
	speed: 0.0641s/iter; left time: 2711.0089s
Epoch: 10 cost time: 29.8258273601532
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2840662
	speed: 0.2483s/iter; left time: 10456.7980s
	iters: 200, epoch: 11 | loss: 2.3196955
	speed: 0.0692s/iter; left time: 2908.8009s
	iters: 300, epoch: 11 | loss: 2.2941318
	speed: 0.0670s/iter; left time: 2809.2246s
	iters: 400, epoch: 11 | loss: 2.3055575
	speed: 0.0659s/iter; left time: 2755.8817s
Epoch: 11 cost time: 31.505648612976074
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.2899921
	speed: 0.2378s/iter; left time: 9904.2638s
	iters: 200, epoch: 12 | loss: 2.3223388
	speed: 0.0656s/iter; left time: 2727.1332s
	iters: 300, epoch: 12 | loss: 2.3040791
	speed: 0.0661s/iter; left time: 2739.2135s
	iters: 400, epoch: 12 | loss: 2.3024175
	speed: 0.0670s/iter; left time: 2768.0289s
Epoch: 12 cost time: 30.694725513458252
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3192620
	speed: 0.2319s/iter; left time: 9549.2764s
	iters: 200, epoch: 13 | loss: 2.3020744
	speed: 0.0616s/iter; left time: 2528.7389s
	iters: 300, epoch: 13 | loss: 2.3044283
	speed: 0.0635s/iter; left time: 2603.8191s
	iters: 400, epoch: 13 | loss: 2.2854412
	speed: 0.0608s/iter; left time: 2483.8431s
Epoch: 13 cost time: 29.198291063308716
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.2996750
	speed: 0.2345s/iter; left time: 9545.6962s
	iters: 200, epoch: 14 | loss: 2.2994924
	speed: 0.0703s/iter; left time: 2853.8193s
	iters: 300, epoch: 14 | loss: 2.3193438
	speed: 0.0643s/iter; left time: 2603.6630s
	iters: 400, epoch: 14 | loss: 2.3004692
	speed: 0.0630s/iter; left time: 2547.2686s
Epoch: 14 cost time: 31.05436086654663
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.2969699
	speed: 0.2440s/iter; left time: 9815.9752s
	iters: 200, epoch: 15 | loss: 2.3119192
	speed: 0.0607s/iter; left time: 2436.8577s
	iters: 300, epoch: 15 | loss: 2.2922127
	speed: 0.0575s/iter; left time: 2301.4065s
	iters: 400, epoch: 15 | loss: 2.2882032
	speed: 0.0596s/iter; left time: 2381.0779s
Epoch: 15 cost time: 28.290327787399292
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.2906573
	speed: 0.2652s/iter; left time: 10545.4581s
	iters: 200, epoch: 16 | loss: 2.3086405
	speed: 0.0580s/iter; left time: 2299.6270s
	iters: 300, epoch: 16 | loss: 2.2992260
	speed: 0.0577s/iter; left time: 2281.6023s
	iters: 400, epoch: 16 | loss: 2.3041458
	speed: 0.0581s/iter; left time: 2294.2527s
Epoch: 16 cost time: 27.986268043518066
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.2932267
	speed: 0.2557s/iter; left time: 10046.7935s
	iters: 200, epoch: 17 | loss: 2.2871556
	speed: 0.0518s/iter; left time: 2031.6533s
	iters: 300, epoch: 17 | loss: 2.2886369
	speed: 0.0534s/iter; left time: 2085.8684s
	iters: 400, epoch: 17 | loss: 2.3160744
	speed: 0.0478s/iter; left time: 1863.5702s
Epoch: 17 cost time: 25.75952434539795
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.2877662
	speed: 0.1741s/iter; left time: 6758.2875s
	iters: 200, epoch: 18 | loss: 2.3107841
	speed: 0.0657s/iter; left time: 2545.1253s
	iters: 300, epoch: 18 | loss: 2.2983811
	speed: 0.0612s/iter; left time: 2364.4333s
	iters: 400, epoch: 18 | loss: 2.3096004
	speed: 0.0629s/iter; left time: 2423.2939s
Epoch: 18 cost time: 28.98421597480774
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3115730
	speed: 0.2403s/iter; left time: 9216.6068s
	iters: 200, epoch: 19 | loss: 2.2927427
	speed: 0.0644s/iter; left time: 2465.1803s
	iters: 300, epoch: 19 | loss: 2.3004797
	speed: 0.0636s/iter; left time: 2427.5485s
	iters: 400, epoch: 19 | loss: 2.2946301
	speed: 0.0612s/iter; left time: 2327.3106s
Epoch: 19 cost time: 29.38987636566162
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 1410826
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8280113
	speed: 0.0719s/iter; left time: 3366.9946s
	iters: 200, epoch: 1 | loss: 0.1530250
	speed: 0.0582s/iter; left time: 2717.6665s
	iters: 300, epoch: 1 | loss: 0.0372974
	speed: 0.0593s/iter; left time: 2761.3032s
	iters: 400, epoch: 1 | loss: 0.0524245
	speed: 0.0602s/iter; left time: 2797.2313s
Epoch: 1 cost time: 29.2198748588562
Epoch: 1, Steps: 469 | Train Loss: 0.487 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2712742
	speed: 0.2589s/iter; left time: 11994.0963s
	iters: 200, epoch: 2 | loss: 0.2839207
	speed: 0.0611s/iter; left time: 2824.9489s
	iters: 300, epoch: 2 | loss: 0.0225006
	speed: 0.0577s/iter; left time: 2663.5975s
	iters: 400, epoch: 2 | loss: 0.0606820
	speed: 0.0601s/iter; left time: 2766.1753s
Epoch: 2 cost time: 29.14307928085327
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039524
	speed: 0.2620s/iter; left time: 12017.3947s
	iters: 200, epoch: 3 | loss: 0.0075653
	speed: 0.0553s/iter; left time: 2531.1897s
	iters: 300, epoch: 3 | loss: 0.2918789
	speed: 0.0549s/iter; left time: 2505.5840s
	iters: 400, epoch: 3 | loss: 0.0202766
	speed: 0.0596s/iter; left time: 2717.0234s
Epoch: 3 cost time: 27.47237491607666
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.951685 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0104051
	speed: 0.2373s/iter; left time: 10771.0277s
	iters: 200, epoch: 4 | loss: 0.0186080
	speed: 0.0622s/iter; left time: 2818.1698s
	iters: 300, epoch: 4 | loss: 0.1520989
	speed: 0.0619s/iter; left time: 2796.3898s
	iters: 400, epoch: 4 | loss: 0.0132031
	speed: 0.0638s/iter; left time: 2877.4453s
Epoch: 4 cost time: 29.50793218612671
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2914944
	speed: 0.2464s/iter; left time: 11067.6264s
	iters: 200, epoch: 5 | loss: 0.0640050
	speed: 0.0630s/iter; left time: 2825.8734s
	iters: 300, epoch: 5 | loss: 0.0212302
	speed: 0.0648s/iter; left time: 2899.6209s
	iters: 400, epoch: 5 | loss: 0.0936639
	speed: 0.0613s/iter; left time: 2733.9591s
Epoch: 5 cost time: 29.42825174331665
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.171 Vali Acc: 0.945 Test Loss: 0.171 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0940152
	speed: 0.2602s/iter; left time: 11567.5647s
	iters: 200, epoch: 6 | loss: 0.0127623
	speed: 0.0646s/iter; left time: 2867.2784s
	iters: 300, epoch: 6 | loss: 0.4448649
	speed: 0.0561s/iter; left time: 2483.0364s
	iters: 400, epoch: 6 | loss: 0.0200192
	speed: 0.0569s/iter; left time: 2512.6974s
Epoch: 6 cost time: 28.78164029121399
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0041412
	speed: 0.2505s/iter; left time: 11020.0306s
	iters: 200, epoch: 7 | loss: 0.0072869
	speed: 0.0568s/iter; left time: 2490.9622s
	iters: 300, epoch: 7 | loss: 0.1641898
	speed: 0.0602s/iter; left time: 2634.1230s
	iters: 400, epoch: 7 | loss: 0.0003411
	speed: 0.0609s/iter; left time: 2661.6194s
Epoch: 7 cost time: 28.584567308425903
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.969696 --> -0.975985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0053509
	speed: 0.2601s/iter; left time: 11321.1955s
	iters: 200, epoch: 8 | loss: 0.0007292
	speed: 0.0477s/iter; left time: 2069.1695s
	iters: 300, epoch: 8 | loss: 0.0069560
	speed: 0.0521s/iter; left time: 2255.1810s
	iters: 400, epoch: 8 | loss: 0.0026479
	speed: 0.0496s/iter; left time: 2144.0826s
Epoch: 8 cost time: 24.772573947906494
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0050643
	speed: 0.2466s/iter; left time: 10614.3882s
	iters: 200, epoch: 9 | loss: 0.0986886
	speed: 0.0630s/iter; left time: 2704.9543s
	iters: 300, epoch: 9 | loss: 0.0026690
	speed: 0.0557s/iter; left time: 2388.4368s
	iters: 400, epoch: 9 | loss: 0.0035965
	speed: 0.0603s/iter; left time: 2576.9953s
Epoch: 9 cost time: 29.06194257736206
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976843).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0059714
	speed: 0.2457s/iter; left time: 10460.7534s
	iters: 200, epoch: 10 | loss: 0.0141705
	speed: 0.0611s/iter; left time: 2596.1706s
	iters: 300, epoch: 10 | loss: 0.0479388
	speed: 0.0584s/iter; left time: 2473.6694s
	iters: 400, epoch: 10 | loss: 0.0089691
	speed: 0.0553s/iter; left time: 2340.0567s
Epoch: 10 cost time: 27.566864013671875
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0060395
	speed: 0.2482s/iter; left time: 10451.3584s
	iters: 200, epoch: 11 | loss: 0.0170793
	speed: 0.0620s/iter; left time: 2605.0733s
	iters: 300, epoch: 11 | loss: 0.0006636
	speed: 0.0551s/iter; left time: 2310.6444s
	iters: 400, epoch: 11 | loss: 0.0930387
	speed: 0.0571s/iter; left time: 2386.4945s
Epoch: 11 cost time: 28.721301794052124
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0055331
	speed: 0.2605s/iter; left time: 10846.4186s
	iters: 200, epoch: 12 | loss: 0.0211373
	speed: 0.0646s/iter; left time: 2683.8428s
	iters: 300, epoch: 12 | loss: 0.0394853
	speed: 0.0613s/iter; left time: 2542.0321s
	iters: 400, epoch: 12 | loss: 0.0065523
	speed: 0.0615s/iter; left time: 2541.5390s
Epoch: 12 cost time: 29.844969987869263
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977701).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2383789
	speed: 0.2410s/iter; left time: 9922.3579s
	iters: 200, epoch: 13 | loss: 0.0012464
	speed: 0.0614s/iter; left time: 2520.9180s
	iters: 300, epoch: 13 | loss: 0.0303692
	speed: 0.0560s/iter; left time: 2294.0256s
	iters: 400, epoch: 13 | loss: 0.0814623
	speed: 0.0545s/iter; left time: 2226.2055s
Epoch: 13 cost time: 28.00311827659607
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0011527
	speed: 0.2589s/iter; left time: 10538.8369s
	iters: 200, epoch: 14 | loss: 0.0018493
	speed: 0.0548s/iter; left time: 2226.2215s
	iters: 300, epoch: 14 | loss: 0.0138090
	speed: 0.0610s/iter; left time: 2472.7385s
	iters: 400, epoch: 14 | loss: 0.0031752
	speed: 0.0582s/iter; left time: 2351.8266s
Epoch: 14 cost time: 28.01297402381897
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0186704
	speed: 0.2432s/iter; left time: 9786.8448s
	iters: 200, epoch: 15 | loss: 0.0002510
	speed: 0.0581s/iter; left time: 2333.2508s
	iters: 300, epoch: 15 | loss: 0.1425166
	speed: 0.0624s/iter; left time: 2498.6437s
	iters: 400, epoch: 15 | loss: 0.8877741
	speed: 0.0619s/iter; left time: 2472.0418s
Epoch: 15 cost time: 28.67235231399536
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0017776
	speed: 0.2470s/iter; left time: 9821.3938s
	iters: 200, epoch: 16 | loss: 0.2463360
	speed: 0.0607s/iter; left time: 2408.9173s
	iters: 300, epoch: 16 | loss: 0.0054973
	speed: 0.0524s/iter; left time: 2071.6363s
	iters: 400, epoch: 16 | loss: 0.0017382
	speed: 0.0583s/iter; left time: 2299.8725s
Epoch: 16 cost time: 27.741163730621338
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0068066
	speed: 0.2377s/iter; left time: 9341.7601s
	iters: 200, epoch: 17 | loss: 0.0015107
	speed: 0.0634s/iter; left time: 2484.7363s
	iters: 300, epoch: 17 | loss: 0.0018636
	speed: 0.0615s/iter; left time: 2405.2179s
	iters: 400, epoch: 17 | loss: 0.0015755
	speed: 0.0598s/iter; left time: 2330.0809s
Epoch: 17 cost time: 28.681052684783936
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.977701 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0008370
	speed: 0.2095s/iter; left time: 8132.6244s
	iters: 200, epoch: 18 | loss: 0.0002937
	speed: 0.0527s/iter; left time: 2042.7183s
	iters: 300, epoch: 18 | loss: 0.0023879
	speed: 0.0569s/iter; left time: 2198.5155s
	iters: 400, epoch: 18 | loss: 0.0020927
	speed: 0.0584s/iter; left time: 2249.6292s
Epoch: 18 cost time: 26.71773362159729
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0057581
	speed: 0.2415s/iter; left time: 9262.2407s
	iters: 200, epoch: 19 | loss: 0.0003317
	speed: 0.0648s/iter; left time: 2478.2583s
	iters: 300, epoch: 19 | loss: 0.0018450
	speed: 0.0644s/iter; left time: 2457.6043s
	iters: 400, epoch: 19 | loss: 0.0252282
	speed: 0.0586s/iter; left time: 2228.6898s
Epoch: 19 cost time: 29.09827446937561
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0007492
	speed: 0.2380s/iter; left time: 9018.4747s
	iters: 200, epoch: 20 | loss: 0.0002122
	speed: 0.0602s/iter; left time: 2276.1784s
	iters: 300, epoch: 20 | loss: 0.0011580
	speed: 0.0653s/iter; left time: 2460.8384s
	iters: 400, epoch: 20 | loss: 0.1687251
	speed: 0.0647s/iter; left time: 2431.7349s
Epoch: 20 cost time: 29.257041215896606
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0007395
	speed: 0.2479s/iter; left time: 9278.1362s
	iters: 200, epoch: 21 | loss: 0.0112476
	speed: 0.0659s/iter; left time: 2459.2528s
	iters: 300, epoch: 21 | loss: 0.0004813
	speed: 0.0680s/iter; left time: 2532.6977s
	iters: 400, epoch: 21 | loss: 0.0008765
	speed: 0.0578s/iter; left time: 2146.3835s
Epoch: 21 cost time: 30.108097553253174
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0153011
	speed: 0.2514s/iter; left time: 9291.0874s
	iters: 200, epoch: 22 | loss: 0.0109418
	speed: 0.0628s/iter; left time: 2315.3682s
	iters: 300, epoch: 22 | loss: 0.0004190
	speed: 0.0604s/iter; left time: 2220.2003s
	iters: 400, epoch: 22 | loss: 0.0003442
	speed: 0.0609s/iter; left time: 2230.7104s
Epoch: 22 cost time: 28.794600248336792
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0158470
	speed: 0.2308s/iter; left time: 8419.4194s
	iters: 200, epoch: 23 | loss: 0.0008247
	speed: 0.0628s/iter; left time: 2283.6655s
	iters: 300, epoch: 23 | loss: 0.0040907
	speed: 0.0602s/iter; left time: 2184.6426s
	iters: 400, epoch: 23 | loss: 0.0482116
	speed: 0.0621s/iter; left time: 2248.0590s
Epoch: 23 cost time: 29.447004079818726
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0008658
	speed: 0.2514s/iter; left time: 9054.3929s
	iters: 200, epoch: 24 | loss: 0.0001015
	speed: 0.0654s/iter; left time: 2348.5255s
	iters: 300, epoch: 24 | loss: 0.0000860
	speed: 0.0644s/iter; left time: 2306.9492s
	iters: 400, epoch: 24 | loss: 0.0003138
	speed: 0.0656s/iter; left time: 2341.2951s
Epoch: 24 cost time: 30.195533990859985
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0006161
	speed: 0.2311s/iter; left time: 8212.9940s
	iters: 200, epoch: 25 | loss: 0.0014443
	speed: 0.0625s/iter; left time: 2214.4899s
	iters: 300, epoch: 25 | loss: 0.0001974
	speed: 0.0591s/iter; left time: 2089.6853s
	iters: 400, epoch: 25 | loss: 0.0002275
	speed: 0.0572s/iter; left time: 2014.9994s
Epoch: 25 cost time: 28.48157238960266
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0124240
	speed: 0.2333s/iter; left time: 8184.2371s
	iters: 200, epoch: 26 | loss: 0.0005485
	speed: 0.0632s/iter; left time: 2210.3361s
	iters: 300, epoch: 26 | loss: 0.0003176
	speed: 0.0612s/iter; left time: 2132.8986s
	iters: 400, epoch: 26 | loss: 0.2156394
	speed: 0.0610s/iter; left time: 2122.3904s
Epoch: 26 cost time: 28.377994537353516
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0010602
	speed: 0.2378s/iter; left time: 8230.2152s
	iters: 200, epoch: 27 | loss: 0.0008528
	speed: 0.0639s/iter; left time: 2203.5291s
	iters: 300, epoch: 27 | loss: 0.0055999
	speed: 0.0594s/iter; left time: 2042.7564s
	iters: 400, epoch: 27 | loss: 0.0029879
	speed: 0.0664s/iter; left time: 2279.6377s
Epoch: 27 cost time: 30.074116230010986
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 1885066
model size : 12.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9357734
	speed: 0.0838s/iter; left time: 3923.4824s
	iters: 200, epoch: 1 | loss: 0.2774949
	speed: 0.0671s/iter; left time: 3133.4910s
	iters: 300, epoch: 1 | loss: 0.1094759
	speed: 0.0638s/iter; left time: 2975.0194s
	iters: 400, epoch: 1 | loss: 0.0752358
	speed: 0.0597s/iter; left time: 2777.3244s
Epoch: 1 cost time: 31.61223340034485
Epoch: 1, Steps: 469 | Train Loss: 0.579 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
Validation loss decreased (inf --> -0.946539).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2572088
	speed: 0.2411s/iter; left time: 11172.0498s
	iters: 200, epoch: 2 | loss: 0.1734041
	speed: 0.0628s/iter; left time: 2903.5997s
	iters: 300, epoch: 2 | loss: 0.0530351
	speed: 0.0615s/iter; left time: 2837.9050s
	iters: 400, epoch: 2 | loss: 0.0645228
	speed: 0.0600s/iter; left time: 2762.3174s
Epoch: 2 cost time: 29.154306888580322
Epoch: 2, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0144375
	speed: 0.2527s/iter; left time: 11591.3284s
	iters: 200, epoch: 3 | loss: 0.0243260
	speed: 0.0612s/iter; left time: 2799.5469s
	iters: 300, epoch: 3 | loss: 0.3532638
	speed: 0.0629s/iter; left time: 2873.9792s
	iters: 400, epoch: 3 | loss: 0.1796197
	speed: 0.0623s/iter; left time: 2839.0934s
Epoch: 3 cost time: 29.74071216583252
Epoch: 3, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.946539 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0106185
	speed: 0.2418s/iter; left time: 10975.9355s
	iters: 200, epoch: 4 | loss: 0.0341820
	speed: 0.0654s/iter; left time: 2963.2424s
	iters: 300, epoch: 4 | loss: 0.0221502
	speed: 0.0661s/iter; left time: 2987.2462s
	iters: 400, epoch: 4 | loss: 0.0191742
	speed: 0.0614s/iter; left time: 2768.0955s
Epoch: 4 cost time: 29.81807565689087
Epoch: 4, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1614616
	speed: 0.2450s/iter; left time: 11004.4535s
	iters: 200, epoch: 5 | loss: 0.1853401
	speed: 0.0572s/iter; left time: 2564.2020s
	iters: 300, epoch: 5 | loss: 0.5737835
	speed: 0.0543s/iter; left time: 2428.4894s
	iters: 400, epoch: 5 | loss: 0.0070959
	speed: 0.0527s/iter; left time: 2352.3299s
Epoch: 5 cost time: 26.277703285217285
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0587599
	speed: 0.1930s/iter; left time: 8579.9937s
	iters: 200, epoch: 6 | loss: 0.1867604
	speed: 0.0649s/iter; left time: 2879.9769s
	iters: 300, epoch: 6 | loss: 0.4631879
	speed: 0.0645s/iter; left time: 2852.5178s
	iters: 400, epoch: 6 | loss: 0.0844570
	speed: 0.0612s/iter; left time: 2701.1928s
Epoch: 6 cost time: 29.856695652008057
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.962263 --> -0.963978).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0074081
	speed: 0.2469s/iter; left time: 10861.5055s
	iters: 200, epoch: 7 | loss: 0.0017601
	speed: 0.0634s/iter; left time: 2780.9594s
	iters: 300, epoch: 7 | loss: 0.3400380
	speed: 0.0663s/iter; left time: 2904.0913s
	iters: 400, epoch: 7 | loss: 0.0025637
	speed: 0.0687s/iter; left time: 3000.2485s
Epoch: 7 cost time: 30.13752055168152
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0738871
	speed: 0.2273s/iter; left time: 9891.6038s
	iters: 200, epoch: 8 | loss: 0.0004733
	speed: 0.0586s/iter; left time: 2546.1112s
	iters: 300, epoch: 8 | loss: 0.0241645
	speed: 0.0549s/iter; left time: 2376.6116s
	iters: 400, epoch: 8 | loss: 0.0421421
	speed: 0.0621s/iter; left time: 2682.8025s
Epoch: 8 cost time: 28.409241676330566
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.953 Test Loss: 0.256 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0010681
	speed: 0.2335s/iter; left time: 10053.0064s
	iters: 200, epoch: 9 | loss: 0.2020961
	speed: 0.0636s/iter; left time: 2732.0348s
	iters: 300, epoch: 9 | loss: 0.2465680
	speed: 0.0652s/iter; left time: 2792.3935s
	iters: 400, epoch: 9 | loss: 0.0056175
	speed: 0.0583s/iter; left time: 2494.2940s
Epoch: 9 cost time: 29.937493801116943
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0104158
	speed: 0.2464s/iter; left time: 10490.7432s
	iters: 200, epoch: 10 | loss: 0.0148481
	speed: 0.0674s/iter; left time: 2861.6938s
	iters: 300, epoch: 10 | loss: 0.0042647
	speed: 0.0661s/iter; left time: 2801.6775s
	iters: 400, epoch: 10 | loss: 0.0030876
	speed: 0.0673s/iter; left time: 2846.5042s
Epoch: 10 cost time: 30.682239532470703
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.963978 --> -0.967408).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0011230
	speed: 0.2381s/iter; left time: 10027.4206s
	iters: 200, epoch: 11 | loss: 0.0263066
	speed: 0.0594s/iter; left time: 2496.4769s
	iters: 300, epoch: 11 | loss: 0.0901798
	speed: 0.0611s/iter; left time: 2560.4942s
	iters: 400, epoch: 11 | loss: 0.0780360
	speed: 0.0611s/iter; left time: 2554.7531s
Epoch: 11 cost time: 28.961349964141846
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.967408 --> -0.969410).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0152848
	speed: 0.2323s/iter; left time: 9671.9111s
	iters: 200, epoch: 12 | loss: 0.1812581
	speed: 0.0681s/iter; left time: 2827.1751s
	iters: 300, epoch: 12 | loss: 0.0365737
	speed: 0.0622s/iter; left time: 2575.8401s
	iters: 400, epoch: 12 | loss: 0.1083414
	speed: 0.0634s/iter; left time: 2619.4276s
Epoch: 12 cost time: 30.369492292404175
Epoch: 12, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0201530
	speed: 0.2497s/iter; left time: 10279.4444s
	iters: 200, epoch: 13 | loss: 0.0018933
	speed: 0.0658s/iter; left time: 2700.6761s
	iters: 300, epoch: 13 | loss: 0.0111859
	speed: 0.0666s/iter; left time: 2730.3803s
	iters: 400, epoch: 13 | loss: 0.0486837
	speed: 0.0637s/iter; left time: 2601.6757s
Epoch: 13 cost time: 29.912930488586426
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0013457
	speed: 0.2425s/iter; left time: 9869.5270s
	iters: 200, epoch: 14 | loss: 0.0008340
	speed: 0.0603s/iter; left time: 2447.2052s
	iters: 300, epoch: 14 | loss: 0.0018817
	speed: 0.0637s/iter; left time: 2580.5396s
	iters: 400, epoch: 14 | loss: 0.0126189
	speed: 0.0648s/iter; left time: 2616.9262s
Epoch: 14 cost time: 29.759926795959473
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0972910
	speed: 0.2303s/iter; left time: 9264.4913s
	iters: 200, epoch: 15 | loss: 0.0066979
	speed: 0.0630s/iter; left time: 2528.5820s
	iters: 300, epoch: 15 | loss: 0.0547639
	speed: 0.0621s/iter; left time: 2487.6234s
	iters: 400, epoch: 15 | loss: 0.0484464
	speed: 0.0649s/iter; left time: 2590.8900s
Epoch: 15 cost time: 29.832540273666382
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0010908
	speed: 0.2451s/iter; left time: 9745.4461s
	iters: 200, epoch: 16 | loss: 0.0523834
	speed: 0.0656s/iter; left time: 2602.6005s
	iters: 300, epoch: 16 | loss: 0.0036765
	speed: 0.0652s/iter; left time: 2580.8617s
	iters: 400, epoch: 16 | loss: 0.0026869
	speed: 0.0658s/iter; left time: 2595.5609s
Epoch: 16 cost time: 29.6309757232666
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.969410 --> -0.979988).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0016007
	speed: 0.1932s/iter; left time: 7591.1076s
	iters: 200, epoch: 17 | loss: 0.0002990
	speed: 0.0599s/iter; left time: 2348.9651s
	iters: 300, epoch: 17 | loss: 0.0029718
	speed: 0.0616s/iter; left time: 2407.5986s
	iters: 400, epoch: 17 | loss: 0.0005602
	speed: 0.0635s/iter; left time: 2477.3688s
Epoch: 17 cost time: 29.13241147994995
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0262121
	speed: 0.2339s/iter; left time: 9081.9258s
	iters: 200, epoch: 18 | loss: 0.0006734
	speed: 0.0590s/iter; left time: 2284.5814s
	iters: 300, epoch: 18 | loss: 0.0013139
	speed: 0.0595s/iter; left time: 2299.9377s
	iters: 400, epoch: 18 | loss: 0.0045628
	speed: 0.0653s/iter; left time: 2514.1573s
Epoch: 18 cost time: 29.360427618026733
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0040028
	speed: 0.2562s/iter; left time: 9827.4615s
	iters: 200, epoch: 19 | loss: 0.0003841
	speed: 0.0627s/iter; left time: 2399.3549s
	iters: 300, epoch: 19 | loss: 0.0017624
	speed: 0.0712s/iter; left time: 2715.6566s
	iters: 400, epoch: 19 | loss: 0.0220619
	speed: 0.0639s/iter; left time: 2433.5856s
Epoch: 19 cost time: 30.462571382522583
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003257
	speed: 0.2460s/iter; left time: 9322.1309s
	iters: 200, epoch: 20 | loss: 0.0064814
	speed: 0.0643s/iter; left time: 2429.9864s
	iters: 300, epoch: 20 | loss: 0.0062401
	speed: 0.0661s/iter; left time: 2491.5868s
	iters: 400, epoch: 20 | loss: 0.1126904
	speed: 0.0688s/iter; left time: 2586.6928s
Epoch: 20 cost time: 30.41758441925049
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0317234
	speed: 0.2353s/iter; left time: 8806.3766s
	iters: 200, epoch: 21 | loss: 0.0030032
	speed: 0.0579s/iter; left time: 2161.2588s
	iters: 300, epoch: 21 | loss: 0.1303695
	speed: 0.0631s/iter; left time: 2347.0105s
	iters: 400, epoch: 21 | loss: 0.0502645
	speed: 0.0644s/iter; left time: 2391.3566s
Epoch: 21 cost time: 29.407572269439697
Epoch: 21, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0346930
	speed: 0.2411s/iter; left time: 8910.2994s
	iters: 200, epoch: 22 | loss: 0.0217466
	speed: 0.0620s/iter; left time: 2286.4373s
	iters: 300, epoch: 22 | loss: 0.1451882
	speed: 0.0596s/iter; left time: 2190.3074s
	iters: 400, epoch: 22 | loss: 0.0041260
	speed: 0.0667s/iter; left time: 2443.3557s
Epoch: 22 cost time: 30.169050216674805
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3071846
	speed: 0.2460s/iter; left time: 8976.6053s
	iters: 200, epoch: 23 | loss: 0.0007247
	speed: 0.0664s/iter; left time: 2417.1035s
	iters: 300, epoch: 23 | loss: 0.0003164
	speed: 0.0659s/iter; left time: 2391.3955s
	iters: 400, epoch: 23 | loss: 0.0065849
	speed: 0.0654s/iter; left time: 2364.8599s
Epoch: 23 cost time: 30.009556770324707
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0137308
	speed: 0.2376s/iter; left time: 8557.2868s
	iters: 200, epoch: 24 | loss: 0.0001957
	speed: 0.0612s/iter; left time: 2196.9673s
	iters: 300, epoch: 24 | loss: 0.0002650
	speed: 0.0619s/iter; left time: 2216.3607s
	iters: 400, epoch: 24 | loss: 0.0020526
	speed: 0.0647s/iter; left time: 2309.3511s
Epoch: 24 cost time: 29.162736654281616
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.949 Test Loss: 0.247 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0103170
	speed: 0.2420s/iter; left time: 8602.9175s
	iters: 200, epoch: 25 | loss: 0.0032524
	speed: 0.0564s/iter; left time: 1999.9562s
	iters: 300, epoch: 25 | loss: 0.0190402
	speed: 0.0639s/iter; left time: 2257.2354s
	iters: 400, epoch: 25 | loss: 0.0089327
	speed: 0.0637s/iter; left time: 2245.5936s
Epoch: 25 cost time: 29.55813241004944
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0017906
	speed: 0.2415s/iter; left time: 8471.9707s
	iters: 200, epoch: 26 | loss: 0.0018831
	speed: 0.0632s/iter; left time: 2211.3953s
	iters: 300, epoch: 26 | loss: 0.0002724
	speed: 0.0614s/iter; left time: 2140.8145s
	iters: 400, epoch: 26 | loss: 0.0161226
	speed: 0.0600s/iter; left time: 2087.9169s
Epoch: 26 cost time: 28.870681762695312
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 1885066
model size : 12.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8380438
	speed: 0.0742s/iter; left time: 3471.0580s
	iters: 200, epoch: 1 | loss: 0.2442493
	speed: 0.0604s/iter; left time: 2822.2841s
	iters: 300, epoch: 1 | loss: 0.0691149
	speed: 0.0667s/iter; left time: 3109.6419s
	iters: 400, epoch: 1 | loss: 0.0506031
	speed: 0.0602s/iter; left time: 2798.4808s
Epoch: 1 cost time: 30.720231533050537
Epoch: 1, Steps: 469 | Train Loss: 0.530 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
Validation loss decreased (inf --> -0.954544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3064619
	speed: 0.2385s/iter; left time: 11049.0483s
	iters: 200, epoch: 2 | loss: 0.1644826
	speed: 0.0705s/iter; left time: 3257.1641s
	iters: 300, epoch: 2 | loss: 0.1345779
	speed: 0.0619s/iter; left time: 2857.6347s
	iters: 400, epoch: 2 | loss: 0.0612122
	speed: 0.0557s/iter; left time: 2565.7997s
Epoch: 2 cost time: 29.66637921333313
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
Validation loss decreased (-0.954544 --> -0.955116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0102655
	speed: 0.2309s/iter; left time: 10588.9931s
	iters: 200, epoch: 3 | loss: 0.0075262
	speed: 0.0493s/iter; left time: 2253.9010s
	iters: 300, epoch: 3 | loss: 0.5195462
	speed: 0.0446s/iter; left time: 2036.8745s
	iters: 400, epoch: 3 | loss: 0.0397641
	speed: 0.0528s/iter; left time: 2403.8028s
Epoch: 3 cost time: 24.795400619506836
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.955116 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0088364
	speed: 0.2489s/iter; left time: 11298.1915s
	iters: 200, epoch: 4 | loss: 0.0441260
	speed: 0.0639s/iter; left time: 2895.8408s
	iters: 300, epoch: 4 | loss: 0.0686199
	speed: 0.0636s/iter; left time: 2872.3220s
	iters: 400, epoch: 4 | loss: 0.0017255
	speed: 0.0625s/iter; left time: 2817.5020s
Epoch: 4 cost time: 29.970609426498413
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0713308
	speed: 0.2631s/iter; left time: 11818.2493s
	iters: 200, epoch: 5 | loss: 0.0415941
	speed: 0.0674s/iter; left time: 3020.0449s
	iters: 300, epoch: 5 | loss: 0.1221798
	speed: 0.0655s/iter; left time: 2929.5866s
	iters: 400, epoch: 5 | loss: 0.0247339
	speed: 0.0612s/iter; left time: 2731.4146s
Epoch: 5 cost time: 30.675383806228638
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0322558
	speed: 0.2599s/iter; left time: 11556.1611s
	iters: 200, epoch: 6 | loss: 0.0061634
	speed: 0.0692s/iter; left time: 3067.7035s
	iters: 300, epoch: 6 | loss: 0.4700204
	speed: 0.0658s/iter; left time: 2910.9350s
	iters: 400, epoch: 6 | loss: 0.0502497
	speed: 0.0628s/iter; left time: 2772.5361s
Epoch: 6 cost time: 31.529875993728638
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2001925
	speed: 0.2558s/iter; left time: 11254.0630s
	iters: 200, epoch: 7 | loss: 0.0063555
	speed: 0.0633s/iter; left time: 2776.5415s
	iters: 300, epoch: 7 | loss: 0.1016952
	speed: 0.0625s/iter; left time: 2734.8295s
	iters: 400, epoch: 7 | loss: 0.0001165
	speed: 0.0576s/iter; left time: 2518.4806s
Epoch: 7 cost time: 29.38407588005066
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0033381
	speed: 0.2743s/iter; left time: 11935.5664s
	iters: 200, epoch: 8 | loss: 0.0004023
	speed: 0.0650s/iter; left time: 2821.0904s
	iters: 300, epoch: 8 | loss: 0.0021764
	speed: 0.0612s/iter; left time: 2652.2935s
	iters: 400, epoch: 8 | loss: 0.0013365
	speed: 0.0629s/iter; left time: 2720.4091s
Epoch: 8 cost time: 30.29203748703003
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0085836
	speed: 0.2624s/iter; left time: 11298.0279s
	iters: 200, epoch: 9 | loss: 0.0183363
	speed: 0.0647s/iter; left time: 2778.4248s
	iters: 300, epoch: 9 | loss: 0.0033543
	speed: 0.0625s/iter; left time: 2680.0676s
	iters: 400, epoch: 9 | loss: 0.0098515
	speed: 0.0650s/iter; left time: 2780.0330s
Epoch: 9 cost time: 30.711211919784546
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.970268 --> -0.971983).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0145263
	speed: 0.2694s/iter; left time: 11471.2992s
	iters: 200, epoch: 10 | loss: 0.0083725
	speed: 0.0630s/iter; left time: 2676.6275s
	iters: 300, epoch: 10 | loss: 0.0055049
	speed: 0.0609s/iter; left time: 2580.5571s
	iters: 400, epoch: 10 | loss: 0.0157640
	speed: 0.0620s/iter; left time: 2621.0458s
Epoch: 10 cost time: 29.883793592453003
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.971983 --> -0.975699).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0006636
	speed: 0.2729s/iter; left time: 11492.3658s
	iters: 200, epoch: 11 | loss: 0.0197269
	speed: 0.0594s/iter; left time: 2497.2066s
	iters: 300, epoch: 11 | loss: 0.0008037
	speed: 0.0595s/iter; left time: 2495.1273s
	iters: 400, epoch: 11 | loss: 0.0044820
	speed: 0.0587s/iter; left time: 2453.7722s
Epoch: 11 cost time: 28.887362003326416
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1322704
	speed: 0.2783s/iter; left time: 11588.7379s
	iters: 200, epoch: 12 | loss: 0.0051752
	speed: 0.0621s/iter; left time: 2580.0850s
	iters: 300, epoch: 12 | loss: 0.0159372
	speed: 0.0603s/iter; left time: 2497.9637s
	iters: 400, epoch: 12 | loss: 0.1720006
	speed: 0.0628s/iter; left time: 2596.3577s
Epoch: 12 cost time: 30.148398876190186
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0118518
	speed: 0.2599s/iter; left time: 10701.5727s
	iters: 200, epoch: 13 | loss: 0.0090193
	speed: 0.0583s/iter; left time: 2394.3273s
	iters: 300, epoch: 13 | loss: 0.0024654
	speed: 0.0590s/iter; left time: 2416.8262s
	iters: 400, epoch: 13 | loss: 0.0627068
	speed: 0.0606s/iter; left time: 2476.9619s
Epoch: 13 cost time: 28.621808290481567
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0010571
	speed: 0.2696s/iter; left time: 10974.9904s
	iters: 200, epoch: 14 | loss: 0.0002516
	speed: 0.0614s/iter; left time: 2493.2562s
	iters: 300, epoch: 14 | loss: 0.0148317
	speed: 0.0592s/iter; left time: 2396.3692s
	iters: 400, epoch: 14 | loss: 0.1712019
	speed: 0.0624s/iter; left time: 2521.7762s
Epoch: 14 cost time: 29.382188081741333
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0285513
	speed: 0.2735s/iter; left time: 11003.1249s
	iters: 200, epoch: 15 | loss: 0.0070967
	speed: 0.0610s/iter; left time: 2446.3022s
	iters: 300, epoch: 15 | loss: 0.0354548
	speed: 0.0620s/iter; left time: 2480.3364s
	iters: 400, epoch: 15 | loss: 0.1356849
	speed: 0.0663s/iter; left time: 2647.1276s
Epoch: 15 cost time: 30.071616411209106
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0066263
	speed: 0.2639s/iter; left time: 10492.8664s
	iters: 200, epoch: 16 | loss: 0.0175325
	speed: 0.0576s/iter; left time: 2286.2677s
	iters: 300, epoch: 16 | loss: 0.0016776
	speed: 0.0590s/iter; left time: 2334.9180s
	iters: 400, epoch: 16 | loss: 0.0005823
	speed: 0.0628s/iter; left time: 2477.4100s
Epoch: 16 cost time: 28.692148685455322
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.978272).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0036733
	speed: 0.2486s/iter; left time: 9767.7122s
	iters: 200, epoch: 17 | loss: 0.0002407
	speed: 0.0575s/iter; left time: 2254.8715s
	iters: 300, epoch: 17 | loss: 0.0005403
	speed: 0.0608s/iter; left time: 2377.6656s
	iters: 400, epoch: 17 | loss: 0.0003848
	speed: 0.0619s/iter; left time: 2413.9488s
Epoch: 17 cost time: 28.31029748916626
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001088
	speed: 0.2636s/iter; left time: 10236.5357s
	iters: 200, epoch: 18 | loss: 0.0001358
	speed: 0.0615s/iter; left time: 2380.9634s
	iters: 300, epoch: 18 | loss: 0.0005641
	speed: 0.0668s/iter; left time: 2578.7328s
	iters: 400, epoch: 18 | loss: 0.0447253
	speed: 0.0666s/iter; left time: 2567.7369s
Epoch: 18 cost time: 30.63930630683899
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.979416).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0008167
	speed: 0.2693s/iter; left time: 10331.3802s
	iters: 200, epoch: 19 | loss: 0.0008146
	speed: 0.0660s/iter; left time: 2525.8865s
	iters: 300, epoch: 19 | loss: 0.0000888
	speed: 0.0677s/iter; left time: 2583.5758s
	iters: 400, epoch: 19 | loss: 0.0052599
	speed: 0.0704s/iter; left time: 2679.0904s
Epoch: 19 cost time: 31.647839069366455
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0004989
	speed: 0.2484s/iter; left time: 9413.1866s
	iters: 200, epoch: 20 | loss: 0.0008082
	speed: 0.0635s/iter; left time: 2398.3470s
	iters: 300, epoch: 20 | loss: 0.0016663
	speed: 0.0615s/iter; left time: 2319.5062s
	iters: 400, epoch: 20 | loss: 0.0867840
	speed: 0.0623s/iter; left time: 2342.8282s
Epoch: 20 cost time: 29.319483995437622
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0006069
	speed: 0.2638s/iter; left time: 9870.0224s
	iters: 200, epoch: 21 | loss: 0.0007396
	speed: 0.0651s/iter; left time: 2427.9146s
	iters: 300, epoch: 21 | loss: 0.0029462
	speed: 0.0654s/iter; left time: 2434.1946s
	iters: 400, epoch: 21 | loss: 0.0022127
	speed: 0.0643s/iter; left time: 2388.1622s
Epoch: 21 cost time: 31.14679765701294
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0773979
	speed: 0.2663s/iter; left time: 9840.9082s
	iters: 200, epoch: 22 | loss: 0.0165024
	speed: 0.0651s/iter; left time: 2398.5751s
	iters: 300, epoch: 22 | loss: 0.0006995
	speed: 0.0679s/iter; left time: 2497.1389s
	iters: 400, epoch: 22 | loss: 0.0140111
	speed: 0.0638s/iter; left time: 2338.2006s
Epoch: 22 cost time: 31.22376561164856
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0287660
	speed: 0.2394s/iter; left time: 8735.2341s
	iters: 200, epoch: 23 | loss: 0.0003372
	speed: 0.0622s/iter; left time: 2264.0559s
	iters: 300, epoch: 23 | loss: 0.0003423
	speed: 0.0597s/iter; left time: 2167.7913s
	iters: 400, epoch: 23 | loss: 0.0738541
	speed: 0.0649s/iter; left time: 2349.1196s
Epoch: 23 cost time: 29.583333730697632
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980273).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0003086
	speed: 0.2604s/iter; left time: 9376.9304s
	iters: 200, epoch: 24 | loss: 0.0001793
	speed: 0.0663s/iter; left time: 2381.3504s
	iters: 300, epoch: 24 | loss: 0.0004369
	speed: 0.0657s/iter; left time: 2352.1165s
	iters: 400, epoch: 24 | loss: 0.0035200
	speed: 0.0652s/iter; left time: 2329.1666s
Epoch: 24 cost time: 31.203728675842285
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0009214
	speed: 0.2570s/iter; left time: 9136.6187s
	iters: 200, epoch: 25 | loss: 0.0004930
	speed: 0.0659s/iter; left time: 2335.2182s
	iters: 300, epoch: 25 | loss: 0.0036194
	speed: 0.0646s/iter; left time: 2284.8023s
	iters: 400, epoch: 25 | loss: 0.0036739
	speed: 0.0654s/iter; left time: 2304.0193s
Epoch: 25 cost time: 30.555453062057495
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0093403
	speed: 0.2454s/iter; left time: 8607.1841s
	iters: 200, epoch: 26 | loss: 0.0217273
	speed: 0.0544s/iter; left time: 1904.1731s
	iters: 300, epoch: 26 | loss: 0.0405434
	speed: 0.0575s/iter; left time: 2006.2817s
	iters: 400, epoch: 26 | loss: 0.0010508
	speed: 0.0637s/iter; left time: 2214.8945s
Epoch: 26 cost time: 28.321113348007202
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0002893
	speed: 0.2732s/iter; left time: 9455.2023s
	iters: 200, epoch: 27 | loss: 0.0000280
	speed: 0.0629s/iter; left time: 2171.4743s
	iters: 300, epoch: 27 | loss: 0.0275036
	speed: 0.0633s/iter; left time: 2179.2967s
	iters: 400, epoch: 27 | loss: 0.0004152
	speed: 0.0656s/iter; left time: 2252.1994s
Epoch: 27 cost time: 30.796062231063843
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0003973
	speed: 0.2806s/iter; left time: 9578.7524s
	iters: 200, epoch: 28 | loss: 0.0024075
	speed: 0.0621s/iter; left time: 2115.2448s
	iters: 300, epoch: 28 | loss: 0.0002727
	speed: 0.0595s/iter; left time: 2018.8297s
	iters: 400, epoch: 28 | loss: 0.2642029
	speed: 0.0687s/iter; left time: 2325.1534s
Epoch: 28 cost time: 30.111605167388916
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0001137
	speed: 0.2636s/iter; left time: 8876.4985s
	iters: 200, epoch: 29 | loss: 0.0012327
	speed: 0.0571s/iter; left time: 1916.5289s
	iters: 300, epoch: 29 | loss: 0.0000506
	speed: 0.0598s/iter; left time: 2000.7076s
	iters: 400, epoch: 29 | loss: 0.0001608
	speed: 0.0590s/iter; left time: 1970.3777s
Epoch: 29 cost time: 28.42514419555664
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0008760
	speed: 0.2694s/iter; left time: 8943.9750s
	iters: 200, epoch: 30 | loss: 0.0001340
	speed: 0.0599s/iter; left time: 1982.3392s
	iters: 300, epoch: 30 | loss: 0.0020662
	speed: 0.0634s/iter; left time: 2093.7312s
	iters: 400, epoch: 30 | loss: 0.0021336
	speed: 0.0662s/iter; left time: 2176.4346s
Epoch: 30 cost time: 30.581111669540405
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.964 Test Loss: 0.204 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000738
	speed: 0.2826s/iter; left time: 9248.6988s
	iters: 200, epoch: 31 | loss: 0.0019215
	speed: 0.0627s/iter; left time: 2045.1378s
	iters: 300, epoch: 31 | loss: 0.6764488
	speed: 0.0623s/iter; left time: 2027.1158s
	iters: 400, epoch: 31 | loss: 0.0001709
	speed: 0.0669s/iter; left time: 2171.0027s
Epoch: 31 cost time: 29.969064712524414
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.969 Test Loss: 0.224 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000249
	speed: 0.2565s/iter; left time: 8273.9452s
	iters: 200, epoch: 32 | loss: 0.0018842
	speed: 0.0593s/iter; left time: 1907.0839s
	iters: 300, epoch: 32 | loss: 0.0491100
	speed: 0.0604s/iter; left time: 1936.1272s
	iters: 400, epoch: 32 | loss: 0.0024450
	speed: 0.0609s/iter; left time: 1946.3750s
Epoch: 32 cost time: 28.96246027946472
Epoch: 32, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0144447
	speed: 0.2667s/iter; left time: 8480.7664s
	iters: 200, epoch: 33 | loss: 0.0002709
	speed: 0.0633s/iter; left time: 2005.3210s
	iters: 300, epoch: 33 | loss: 0.0000142
	speed: 0.0649s/iter; left time: 2048.8162s
	iters: 400, epoch: 33 | loss: 0.0137489
	speed: 0.0642s/iter; left time: 2021.2906s
Epoch: 33 cost time: 30.452838897705078
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 1885066
model size : 12.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3049264
	speed: 0.0802s/iter; left time: 3755.2149s
	iters: 200, epoch: 1 | loss: 2.3067029
	speed: 0.0648s/iter; left time: 3024.3615s
	iters: 300, epoch: 1 | loss: 2.3026085
	speed: 0.0630s/iter; left time: 2938.1390s
	iters: 400, epoch: 1 | loss: 2.2940955
	speed: 0.0632s/iter; left time: 2940.6345s
Epoch: 1 cost time: 31.5027334690094
Epoch: 1, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2986867
	speed: 0.2556s/iter; left time: 11843.1767s
	iters: 200, epoch: 2 | loss: 2.3105621
	speed: 0.0685s/iter; left time: 3166.5045s
	iters: 300, epoch: 2 | loss: 2.3079004
	speed: 0.0688s/iter; left time: 3172.5166s
	iters: 400, epoch: 2 | loss: 2.3124804
	speed: 0.0681s/iter; left time: 3135.6211s
Epoch: 2 cost time: 31.59098744392395
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3131187
	speed: 0.2553s/iter; left time: 11707.9953s
	iters: 200, epoch: 3 | loss: 2.2995596
	speed: 0.0654s/iter; left time: 2991.2926s
	iters: 300, epoch: 3 | loss: 2.3094845
	speed: 0.0656s/iter; left time: 2994.9158s
	iters: 400, epoch: 3 | loss: 2.3078713
	speed: 0.0635s/iter; left time: 2892.5085s
Epoch: 3 cost time: 30.595449209213257
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3062420
	speed: 0.2613s/iter; left time: 11863.6467s
	iters: 200, epoch: 4 | loss: 2.3137619
	speed: 0.0660s/iter; left time: 2987.2167s
	iters: 300, epoch: 4 | loss: 2.3067918
	speed: 0.0621s/iter; left time: 2805.8637s
	iters: 400, epoch: 4 | loss: 2.2982991
	speed: 0.0589s/iter; left time: 2657.6757s
Epoch: 4 cost time: 30.087677001953125
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3129759
	speed: 0.2648s/iter; left time: 11896.4914s
	iters: 200, epoch: 5 | loss: 2.3099937
	speed: 0.0679s/iter; left time: 3042.9772s
	iters: 300, epoch: 5 | loss: 2.2903550
	speed: 0.0655s/iter; left time: 2929.0534s
	iters: 400, epoch: 5 | loss: 2.2982693
	speed: 0.0660s/iter; left time: 2947.1546s
Epoch: 5 cost time: 31.455272436141968
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2852788
	speed: 0.2560s/iter; left time: 11379.4063s
	iters: 200, epoch: 6 | loss: 2.2905474
	speed: 0.0662s/iter; left time: 2936.2034s
	iters: 300, epoch: 6 | loss: 2.2983272
	speed: 0.0607s/iter; left time: 2687.2035s
	iters: 400, epoch: 6 | loss: 2.2839091
	speed: 0.0632s/iter; left time: 2788.6703s
Epoch: 6 cost time: 29.828075170516968
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3198717
	speed: 0.2535s/iter; left time: 11152.2614s
	iters: 200, epoch: 7 | loss: 2.2991478
	speed: 0.0599s/iter; left time: 2629.8924s
	iters: 300, epoch: 7 | loss: 2.3047440
	speed: 0.0639s/iter; left time: 2799.5607s
	iters: 400, epoch: 7 | loss: 2.2985446
	speed: 0.0633s/iter; left time: 2767.2651s
Epoch: 7 cost time: 29.459742784500122
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2995481
	speed: 0.2541s/iter; left time: 11057.9690s
	iters: 200, epoch: 8 | loss: 2.3052924
	speed: 0.0672s/iter; left time: 2917.0717s
	iters: 300, epoch: 8 | loss: 2.3065591
	speed: 0.0680s/iter; left time: 2946.8096s
	iters: 400, epoch: 8 | loss: 2.3137405
	speed: 0.0658s/iter; left time: 2842.6255s
Epoch: 8 cost time: 31.159085273742676
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3027184
	speed: 0.2604s/iter; left time: 11208.2422s
	iters: 200, epoch: 9 | loss: 2.3037274
	speed: 0.0674s/iter; left time: 2893.4946s
	iters: 300, epoch: 9 | loss: 2.3153477
	speed: 0.0668s/iter; left time: 2863.4009s
	iters: 400, epoch: 9 | loss: 2.2933888
	speed: 0.0645s/iter; left time: 2756.2368s
Epoch: 9 cost time: 31.141486644744873
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.2900209
	speed: 0.2353s/iter; left time: 10020.9517s
	iters: 200, epoch: 10 | loss: 2.3159540
	speed: 0.0648s/iter; left time: 2751.3629s
	iters: 300, epoch: 10 | loss: 2.3292725
	speed: 0.0653s/iter; left time: 2768.8117s
	iters: 400, epoch: 10 | loss: 2.2873621
	speed: 0.0642s/iter; left time: 2713.6469s
Epoch: 10 cost time: 30.344341278076172
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.3187582
	speed: 0.2611s/iter; left time: 10994.8454s
	iters: 200, epoch: 11 | loss: 2.2961171
	speed: 0.0663s/iter; left time: 2784.1084s
	iters: 300, epoch: 11 | loss: 2.2930212
	speed: 0.0663s/iter; left time: 2776.7526s
	iters: 400, epoch: 11 | loss: 2.2950768
	speed: 0.0681s/iter; left time: 2845.9476s
Epoch: 11 cost time: 31.234017848968506
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.2943296
	speed: 0.2636s/iter; left time: 10976.4199s
	iters: 200, epoch: 12 | loss: 2.3084397
	speed: 0.0684s/iter; left time: 2841.8141s
	iters: 300, epoch: 12 | loss: 2.3016987
	speed: 0.0660s/iter; left time: 2735.5765s
	iters: 400, epoch: 12 | loss: 2.3124125
	speed: 0.0641s/iter; left time: 2648.2689s
Epoch: 12 cost time: 31.18692684173584
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3166664
	speed: 0.2426s/iter; left time: 9988.1021s
	iters: 200, epoch: 13 | loss: 2.3141215
	speed: 0.0623s/iter; left time: 2558.8851s
	iters: 300, epoch: 13 | loss: 2.2961535
	speed: 0.0635s/iter; left time: 2603.1216s
	iters: 400, epoch: 13 | loss: 2.2929130
	speed: 0.0627s/iter; left time: 2561.5508s
Epoch: 13 cost time: 29.596126794815063
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3023691
	speed: 0.2648s/iter; left time: 10780.0271s
	iters: 200, epoch: 14 | loss: 2.3062243
	speed: 0.0620s/iter; left time: 2518.6642s
	iters: 300, epoch: 14 | loss: 2.3240666
	speed: 0.0619s/iter; left time: 2505.9451s
	iters: 400, epoch: 14 | loss: 2.2806654
	speed: 0.0675s/iter; left time: 2727.8535s
Epoch: 14 cost time: 30.876670122146606
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3038266
	speed: 0.2641s/iter; left time: 10625.8599s
	iters: 200, epoch: 15 | loss: 2.3078685
	speed: 0.0662s/iter; left time: 2658.2134s
	iters: 300, epoch: 15 | loss: 2.3031685
	speed: 0.0663s/iter; left time: 2655.3791s
	iters: 400, epoch: 15 | loss: 2.3071868
	speed: 0.0621s/iter; left time: 2481.5670s
Epoch: 15 cost time: 30.50906467437744
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.2916608
	speed: 0.2544s/iter; left time: 10118.3177s
	iters: 200, epoch: 16 | loss: 2.2945042
	speed: 0.0640s/iter; left time: 2539.1160s
	iters: 300, epoch: 16 | loss: 2.2901464
	speed: 0.0638s/iter; left time: 2524.0798s
	iters: 400, epoch: 16 | loss: 2.3009121
	speed: 0.0652s/iter; left time: 2572.5867s
Epoch: 16 cost time: 30.186108827590942
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3205850
	speed: 0.2536s/iter; left time: 9965.4199s
	iters: 200, epoch: 17 | loss: 2.3035088
	speed: 0.0663s/iter; left time: 2599.3591s
	iters: 300, epoch: 17 | loss: 2.2989156
	speed: 0.0688s/iter; left time: 2688.3037s
	iters: 400, epoch: 17 | loss: 2.3029621
	speed: 0.0678s/iter; left time: 2645.3611s
Epoch: 17 cost time: 31.14379572868347
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.3081021
	speed: 0.2645s/iter; left time: 10271.8857s
	iters: 200, epoch: 18 | loss: 2.2885778
	speed: 0.0638s/iter; left time: 2470.0814s
	iters: 300, epoch: 18 | loss: 2.2980232
	speed: 0.0653s/iter; left time: 2523.6007s
	iters: 400, epoch: 18 | loss: 2.2973139
	speed: 0.0639s/iter; left time: 2460.2910s
Epoch: 18 cost time: 30.25830888748169
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.3135731
	speed: 0.2529s/iter; left time: 9701.4620s
	iters: 200, epoch: 19 | loss: 2.2947598
	speed: 0.0607s/iter; left time: 2324.0947s
	iters: 300, epoch: 19 | loss: 2.2986400
	speed: 0.0683s/iter; left time: 2607.1011s
	iters: 400, epoch: 19 | loss: 2.3001125
	speed: 0.0647s/iter; left time: 2462.7808s
Epoch: 19 cost time: 30.270050525665283
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3141677
	speed: 0.2605s/iter; left time: 9869.4444s
	iters: 200, epoch: 20 | loss: 2.3072684
	speed: 0.0625s/iter; left time: 2361.8572s
	iters: 300, epoch: 20 | loss: 2.2946241
	speed: 0.0673s/iter; left time: 2537.9336s
	iters: 400, epoch: 20 | loss: 2.3096790
	speed: 0.0644s/iter; left time: 2422.4427s
Epoch: 20 cost time: 30.346370935440063
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.2980330
	speed: 0.2691s/iter; left time: 10069.7016s
	iters: 200, epoch: 21 | loss: 2.3114882
	speed: 0.0613s/iter; left time: 2289.4848s
	iters: 300, epoch: 21 | loss: 2.2911372
	speed: 0.0653s/iter; left time: 2429.7731s
	iters: 400, epoch: 21 | loss: 2.3034332
	speed: 0.0625s/iter; left time: 2321.7776s
Epoch: 21 cost time: 29.879900693893433
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.3065143
	speed: 0.2546s/iter; left time: 9406.3995s
	iters: 200, epoch: 22 | loss: 2.3166909
	speed: 0.0587s/iter; left time: 2164.2045s
	iters: 300, epoch: 22 | loss: 2.3068557
	speed: 0.0606s/iter; left time: 2227.1471s
	iters: 400, epoch: 22 | loss: 2.2983608
	speed: 0.0653s/iter; left time: 2394.3141s
Epoch: 22 cost time: 29.439331769943237
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 1885066
model size : 12.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5520387
	speed: 0.0812s/iter; left time: 3801.3817s
	iters: 200, epoch: 1 | loss: 0.1275328
	speed: 0.0687s/iter; left time: 3207.6258s
	iters: 300, epoch: 1 | loss: 0.1230729
	speed: 0.0651s/iter; left time: 3033.1077s
	iters: 400, epoch: 1 | loss: 0.2662328
	speed: 0.0625s/iter; left time: 2906.9900s
Epoch: 1 cost time: 31.30725383758545
Epoch: 1, Steps: 469 | Train Loss: 0.527 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (inf --> -0.954830).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0770418
	speed: 0.1691s/iter; left time: 7833.1976s
	iters: 200, epoch: 2 | loss: 0.0274679
	speed: 0.0515s/iter; left time: 2379.4687s
	iters: 300, epoch: 2 | loss: 0.1667683
	speed: 0.0532s/iter; left time: 2455.6851s
	iters: 400, epoch: 2 | loss: 0.0459690
	speed: 0.0512s/iter; left time: 2357.3381s
Epoch: 2 cost time: 24.44570231437683
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
Validation loss decreased (-0.954830 --> -0.962549).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0130468
	speed: 0.1941s/iter; left time: 8902.9820s
	iters: 200, epoch: 3 | loss: 0.0336958
	speed: 0.0644s/iter; left time: 2945.9339s
	iters: 300, epoch: 3 | loss: 0.0553344
	speed: 0.0664s/iter; left time: 3032.5959s
	iters: 400, epoch: 3 | loss: 0.2364411
	speed: 0.0695s/iter; left time: 3165.6892s
Epoch: 3 cost time: 31.504648208618164
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0024686
	speed: 0.2687s/iter; left time: 12199.5159s
	iters: 200, epoch: 4 | loss: 0.0283536
	speed: 0.0646s/iter; left time: 2926.8175s
	iters: 300, epoch: 4 | loss: 0.0066101
	speed: 0.0658s/iter; left time: 2974.9634s
	iters: 400, epoch: 4 | loss: 0.0093074
	speed: 0.0663s/iter; left time: 2991.4815s
Epoch: 4 cost time: 30.569281339645386
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0041390
	speed: 0.2593s/iter; left time: 11648.1245s
	iters: 200, epoch: 5 | loss: 0.0399483
	speed: 0.0630s/iter; left time: 2823.1228s
	iters: 300, epoch: 5 | loss: 0.0023301
	speed: 0.0660s/iter; left time: 2949.9870s
	iters: 400, epoch: 5 | loss: 0.0036733
	speed: 0.0655s/iter; left time: 2921.7468s
Epoch: 5 cost time: 29.987791538238525
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0015567
	speed: 0.2541s/iter; left time: 11297.9675s
	iters: 200, epoch: 6 | loss: 0.0128850
	speed: 0.0671s/iter; left time: 2974.5978s
	iters: 300, epoch: 6 | loss: 0.1221361
	speed: 0.0685s/iter; left time: 3030.0332s
	iters: 400, epoch: 6 | loss: 0.0511998
	speed: 0.0673s/iter; left time: 2973.1358s
Epoch: 6 cost time: 31.434573888778687
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0118923
	speed: 0.2561s/iter; left time: 11265.3114s
	iters: 200, epoch: 7 | loss: 0.0182019
	speed: 0.0641s/iter; left time: 2812.3223s
	iters: 300, epoch: 7 | loss: 0.0036275
	speed: 0.0685s/iter; left time: 2999.4562s
	iters: 400, epoch: 7 | loss: 0.0078304
	speed: 0.0717s/iter; left time: 3132.9562s
Epoch: 7 cost time: 31.3768572807312
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0077745
	speed: 0.2727s/iter; left time: 11868.3972s
	iters: 200, epoch: 8 | loss: 0.0063133
	speed: 0.0639s/iter; left time: 2774.0063s
	iters: 300, epoch: 8 | loss: 0.0003480
	speed: 0.0640s/iter; left time: 2772.8638s
	iters: 400, epoch: 8 | loss: 0.0009983
	speed: 0.0631s/iter; left time: 2725.0967s
Epoch: 8 cost time: 29.959898710250854
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.962549 --> -0.970553).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020672
	speed: 0.2487s/iter; left time: 10705.0490s
	iters: 200, epoch: 9 | loss: 0.0101194
	speed: 0.0600s/iter; left time: 2579.0167s
	iters: 300, epoch: 9 | loss: 0.0003194
	speed: 0.0689s/iter; left time: 2951.7046s
	iters: 400, epoch: 9 | loss: 0.0552927
	speed: 0.0697s/iter; left time: 2977.5022s
Epoch: 9 cost time: 30.667354822158813
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.970553 --> -0.973698).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0072617
	speed: 0.2703s/iter; left time: 11510.4483s
	iters: 200, epoch: 10 | loss: 0.0001810
	speed: 0.0612s/iter; left time: 2599.6623s
	iters: 300, epoch: 10 | loss: 0.0106384
	speed: 0.0688s/iter; left time: 2917.1975s
	iters: 400, epoch: 10 | loss: 0.4734283
	speed: 0.0681s/iter; left time: 2878.1306s
Epoch: 10 cost time: 30.802788496017456
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.973984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0666009
	speed: 0.2662s/iter; left time: 11209.7793s
	iters: 200, epoch: 11 | loss: 0.0004348
	speed: 0.0598s/iter; left time: 2513.2613s
	iters: 300, epoch: 11 | loss: 0.1212927
	speed: 0.0650s/iter; left time: 2723.3380s
	iters: 400, epoch: 11 | loss: 0.0002159
	speed: 0.0618s/iter; left time: 2582.0789s
Epoch: 11 cost time: 29.172027111053467
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.974270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0044632
	speed: 0.2597s/iter; left time: 10815.6343s
	iters: 200, epoch: 12 | loss: 0.0149402
	speed: 0.0650s/iter; left time: 2700.0966s
	iters: 300, epoch: 12 | loss: 0.0001270
	speed: 0.0682s/iter; left time: 2825.3672s
	iters: 400, epoch: 12 | loss: 0.3088918
	speed: 0.0662s/iter; left time: 2734.8586s
Epoch: 12 cost time: 30.957508087158203
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.974270 --> -0.979988).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0009549
	speed: 0.2711s/iter; left time: 11163.9366s
	iters: 200, epoch: 13 | loss: 0.0053086
	speed: 0.0609s/iter; left time: 2501.4732s
	iters: 300, epoch: 13 | loss: 0.0034406
	speed: 0.0656s/iter; left time: 2687.3745s
	iters: 400, epoch: 13 | loss: 0.0002671
	speed: 0.0632s/iter; left time: 2584.1872s
Epoch: 13 cost time: 30.063947439193726
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0005545
	speed: 0.2629s/iter; left time: 10701.9073s
	iters: 200, epoch: 14 | loss: 0.1327031
	speed: 0.0626s/iter; left time: 2543.3045s
	iters: 300, epoch: 14 | loss: 0.0072055
	speed: 0.0635s/iter; left time: 2571.6807s
	iters: 400, epoch: 14 | loss: 0.0004953
	speed: 0.0646s/iter; left time: 2609.4163s
Epoch: 14 cost time: 29.78618621826172
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0198761
	speed: 0.2678s/iter; left time: 10773.7262s
	iters: 200, epoch: 15 | loss: 0.0009464
	speed: 0.0634s/iter; left time: 2543.6308s
	iters: 300, epoch: 15 | loss: 0.0013019
	speed: 0.0654s/iter; left time: 2617.7379s
	iters: 400, epoch: 15 | loss: 0.0048877
	speed: 0.0698s/iter; left time: 2785.5458s
Epoch: 15 cost time: 31.015326023101807
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0020010
	speed: 0.2636s/iter; left time: 10480.6297s
	iters: 200, epoch: 16 | loss: 0.0004610
	speed: 0.0617s/iter; left time: 2449.1234s
	iters: 300, epoch: 16 | loss: 0.0020351
	speed: 0.0692s/iter; left time: 2737.4122s
	iters: 400, epoch: 16 | loss: 0.1312605
	speed: 0.0687s/iter; left time: 2709.3910s
Epoch: 16 cost time: 31.16811203956604
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1898887
	speed: 0.2692s/iter; left time: 10579.8840s
	iters: 200, epoch: 17 | loss: 0.0019028
	speed: 0.0616s/iter; left time: 2415.0244s
	iters: 300, epoch: 17 | loss: 0.0024144
	speed: 0.0609s/iter; left time: 2380.2552s
	iters: 400, epoch: 17 | loss: 0.1402720
	speed: 0.0589s/iter; left time: 2296.0286s
Epoch: 17 cost time: 28.121880292892456
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4215955
	speed: 0.2485s/iter; left time: 9649.1184s
	iters: 200, epoch: 18 | loss: 0.0001555
	speed: 0.0610s/iter; left time: 2363.9434s
	iters: 300, epoch: 18 | loss: 0.0007556
	speed: 0.0640s/iter; left time: 2472.2851s
	iters: 400, epoch: 18 | loss: 0.0011765
	speed: 0.0624s/iter; left time: 2404.8130s
Epoch: 18 cost time: 30.0116868019104
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1640661
	speed: 0.2691s/iter; left time: 10322.9515s
	iters: 200, epoch: 19 | loss: 0.0012461
	speed: 0.0644s/iter; left time: 2464.6034s
	iters: 300, epoch: 19 | loss: 0.0036580
	speed: 0.0635s/iter; left time: 2424.6898s
	iters: 400, epoch: 19 | loss: 0.0620522
	speed: 0.0635s/iter; left time: 2416.5648s
Epoch: 19 cost time: 30.249053239822388
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1457851
	speed: 0.2664s/iter; left time: 10092.7760s
	iters: 200, epoch: 20 | loss: 0.0001887
	speed: 0.0623s/iter; left time: 2353.3155s
	iters: 300, epoch: 20 | loss: 0.0001119
	speed: 0.0604s/iter; left time: 2276.7709s
	iters: 400, epoch: 20 | loss: 0.0160663
	speed: 0.0592s/iter; left time: 2223.5918s
Epoch: 20 cost time: 28.965105533599854
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.980273).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0008136
	speed: 0.2538s/iter; left time: 9498.1344s
	iters: 200, epoch: 21 | loss: 0.0027770
	speed: 0.0684s/iter; left time: 2551.7310s
	iters: 300, epoch: 21 | loss: 0.6910375
	speed: 0.0658s/iter; left time: 2449.8415s
	iters: 400, epoch: 21 | loss: 0.0000828
	speed: 0.0632s/iter; left time: 2346.2639s
Epoch: 21 cost time: 31.353639364242554
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.980273 --> -0.981703).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0030141
	speed: 0.2770s/iter; left time: 10237.1729s
	iters: 200, epoch: 22 | loss: 0.0025841
	speed: 0.0655s/iter; left time: 2413.1335s
	iters: 300, epoch: 22 | loss: 0.0028750
	speed: 0.0632s/iter; left time: 2322.7868s
	iters: 400, epoch: 22 | loss: 0.3143422
	speed: 0.0609s/iter; left time: 2232.8258s
Epoch: 22 cost time: 30.46217632293701
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0008053
	speed: 0.2608s/iter; left time: 9515.5610s
	iters: 200, epoch: 23 | loss: 0.0002307
	speed: 0.0628s/iter; left time: 2283.5020s
	iters: 300, epoch: 23 | loss: 0.0002122
	speed: 0.0581s/iter; left time: 2108.4028s
	iters: 400, epoch: 23 | loss: 0.5797592
	speed: 0.0564s/iter; left time: 2039.5124s
Epoch: 23 cost time: 28.444226503372192
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0013543
	speed: 0.2600s/iter; left time: 9364.9462s
	iters: 200, epoch: 24 | loss: 0.0000707
	speed: 0.0670s/iter; left time: 2405.0552s
	iters: 300, epoch: 24 | loss: 0.0019600
	speed: 0.0649s/iter; left time: 2323.2497s
	iters: 400, epoch: 24 | loss: 0.0007007
	speed: 0.0611s/iter; left time: 2181.2561s
Epoch: 24 cost time: 30.470045804977417
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0169867
	speed: 0.2716s/iter; left time: 9653.2113s
	iters: 200, epoch: 25 | loss: 0.0086866
	speed: 0.0679s/iter; left time: 2408.4450s
	iters: 300, epoch: 25 | loss: 0.0004503
	speed: 0.0617s/iter; left time: 2182.0339s
	iters: 400, epoch: 25 | loss: 0.0015407
	speed: 0.0604s/iter; left time: 2130.4502s
Epoch: 25 cost time: 30.1285297870636
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0010194
	speed: 0.2454s/iter; left time: 8607.8526s
	iters: 200, epoch: 26 | loss: 0.0006026
	speed: 0.0626s/iter; left time: 2188.5545s
	iters: 300, epoch: 26 | loss: 0.0001464
	speed: 0.0608s/iter; left time: 2120.3514s
	iters: 400, epoch: 26 | loss: 0.0091752
	speed: 0.0611s/iter; left time: 2125.1863s
Epoch: 26 cost time: 29.09809970855713
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0004642
	speed: 0.2619s/iter; left time: 9064.4566s
	iters: 200, epoch: 27 | loss: 0.0344536
	speed: 0.0676s/iter; left time: 2331.5625s
	iters: 300, epoch: 27 | loss: 0.0048068
	speed: 0.0671s/iter; left time: 2310.3144s
	iters: 400, epoch: 27 | loss: 0.0005468
	speed: 0.0639s/iter; left time: 2192.2422s
Epoch: 27 cost time: 31.07789182662964
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0032255
	speed: 0.2643s/iter; left time: 9022.6927s
	iters: 200, epoch: 28 | loss: 0.0010208
	speed: 0.0686s/iter; left time: 2333.8827s
	iters: 300, epoch: 28 | loss: 0.0007729
	speed: 0.0679s/iter; left time: 2302.7511s
	iters: 400, epoch: 28 | loss: 0.0000371
	speed: 0.0622s/iter; left time: 2103.5393s
Epoch: 28 cost time: 30.889934539794922
Epoch: 28, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0001939
	speed: 0.2493s/iter; left time: 8392.0281s
	iters: 200, epoch: 29 | loss: 0.0002637
	speed: 0.0626s/iter; left time: 2101.0734s
	iters: 300, epoch: 29 | loss: 0.0011640
	speed: 0.0623s/iter; left time: 2085.2646s
	iters: 400, epoch: 29 | loss: 0.0041751
	speed: 0.0601s/iter; left time: 2004.9322s
Epoch: 29 cost time: 29.463883876800537
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0336233
	speed: 0.2583s/iter; left time: 8575.8135s
	iters: 200, epoch: 30 | loss: 0.0001256
	speed: 0.0664s/iter; left time: 2197.8622s
	iters: 300, epoch: 30 | loss: 0.0037301
	speed: 0.0669s/iter; left time: 2209.0838s
	iters: 400, epoch: 30 | loss: 0.0002199
	speed: 0.0620s/iter; left time: 2041.1438s
Epoch: 30 cost time: 31.1575984954834
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0010761
	speed: 0.2595s/iter; left time: 8492.1175s
	iters: 200, epoch: 31 | loss: 0.0100379
	speed: 0.0639s/iter; left time: 2084.3570s
	iters: 300, epoch: 31 | loss: 0.0004785
	speed: 0.0643s/iter; left time: 2091.6887s
	iters: 400, epoch: 31 | loss: 0.0004834
	speed: 0.0614s/iter; left time: 1990.5036s
Epoch: 31 cost time: 29.87469506263733
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 1098634
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6987880
	speed: 0.0792s/iter; left time: 3707.6107s
	iters: 200, epoch: 1 | loss: 0.1525076
	speed: 0.0618s/iter; left time: 2885.4103s
	iters: 300, epoch: 1 | loss: 0.1958329
	speed: 0.0623s/iter; left time: 2900.9346s
	iters: 400, epoch: 1 | loss: 0.2414801
	speed: 0.0609s/iter; left time: 2832.5542s
Epoch: 1 cost time: 30.926984786987305
Epoch: 1, Steps: 469 | Train Loss: 0.616 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (inf --> -0.941393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1033423
	speed: 0.2779s/iter; left time: 12873.9997s
	iters: 200, epoch: 2 | loss: 0.0708672
	speed: 0.0621s/iter; left time: 2869.7760s
	iters: 300, epoch: 2 | loss: 0.0790454
	speed: 0.0607s/iter; left time: 2799.2876s
	iters: 400, epoch: 2 | loss: 0.0483356
	speed: 0.0603s/iter; left time: 2774.1457s
Epoch: 2 cost time: 29.121582508087158
Epoch: 2, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.142 Vali Acc: 0.956 Test Loss: 0.142 Test Acc: 0.956
Validation loss decreased (-0.941393 --> -0.955973).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1133865
	speed: 0.2753s/iter; left time: 12624.8732s
	iters: 200, epoch: 3 | loss: 0.0423607
	speed: 0.0631s/iter; left time: 2885.7740s
	iters: 300, epoch: 3 | loss: 0.1604858
	speed: 0.0611s/iter; left time: 2790.6088s
	iters: 400, epoch: 3 | loss: 0.3565927
	speed: 0.0597s/iter; left time: 2720.1285s
Epoch: 3 cost time: 29.416948080062866
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0114132
	speed: 0.2602s/iter; left time: 11812.0498s
	iters: 200, epoch: 4 | loss: 0.0605469
	speed: 0.0617s/iter; left time: 2793.1183s
	iters: 300, epoch: 4 | loss: 0.0122342
	speed: 0.0609s/iter; left time: 2752.7290s
	iters: 400, epoch: 4 | loss: 0.0095343
	speed: 0.0617s/iter; left time: 2784.1964s
Epoch: 4 cost time: 29.45813775062561
Epoch: 4, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0031695
	speed: 0.2669s/iter; left time: 11991.7555s
	iters: 200, epoch: 5 | loss: 0.3241982
	speed: 0.0650s/iter; left time: 2912.2156s
	iters: 300, epoch: 5 | loss: 0.0009928
	speed: 0.0608s/iter; left time: 2720.5403s
	iters: 400, epoch: 5 | loss: 0.0475616
	speed: 0.0628s/iter; left time: 2800.5739s
Epoch: 5 cost time: 29.847015142440796
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0029170
	speed: 0.2778s/iter; left time: 12349.2422s
	iters: 200, epoch: 6 | loss: 0.0012051
	speed: 0.0679s/iter; left time: 3009.9246s
	iters: 300, epoch: 6 | loss: 0.0951517
	speed: 0.0640s/iter; left time: 2833.3214s
	iters: 400, epoch: 6 | loss: 0.2413976
	speed: 0.0590s/iter; left time: 2604.8265s
Epoch: 6 cost time: 30.422194957733154
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955973 --> -0.956259).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0112974
	speed: 0.2650s/iter; left time: 11657.7288s
	iters: 200, epoch: 7 | loss: 0.0167672
	speed: 0.0620s/iter; left time: 2721.7051s
	iters: 300, epoch: 7 | loss: 0.0114089
	speed: 0.0614s/iter; left time: 2688.5290s
	iters: 400, epoch: 7 | loss: 0.0593503
	speed: 0.0611s/iter; left time: 2667.1350s
Epoch: 7 cost time: 29.175713300704956
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0066650
	speed: 0.2721s/iter; left time: 11841.3116s
	iters: 200, epoch: 8 | loss: 0.0058810
	speed: 0.0666s/iter; left time: 2891.4599s
	iters: 300, epoch: 8 | loss: 0.0015243
	speed: 0.0647s/iter; left time: 2803.4158s
	iters: 400, epoch: 8 | loss: 0.0020123
	speed: 0.0623s/iter; left time: 2693.3715s
Epoch: 8 cost time: 30.880815505981445
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.956259 --> -0.971411).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020866
	speed: 0.2714s/iter; left time: 11685.1425s
	iters: 200, epoch: 9 | loss: 0.0191506
	speed: 0.0649s/iter; left time: 2787.3050s
	iters: 300, epoch: 9 | loss: 0.0019466
	speed: 0.0626s/iter; left time: 2680.6809s
	iters: 400, epoch: 9 | loss: 0.0673596
	speed: 0.0597s/iter; left time: 2550.6505s
Epoch: 9 cost time: 29.661924123764038
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0017653
	speed: 0.2652s/iter; left time: 11291.7590s
	iters: 200, epoch: 10 | loss: 0.0242246
	speed: 0.0606s/iter; left time: 2574.8147s
	iters: 300, epoch: 10 | loss: 0.0854959
	speed: 0.0573s/iter; left time: 2427.6253s
	iters: 400, epoch: 10 | loss: 0.3534327
	speed: 0.0586s/iter; left time: 2478.9061s
Epoch: 10 cost time: 28.40180468559265
Epoch: 10, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2504971
	speed: 0.2681s/iter; left time: 11288.4282s
	iters: 200, epoch: 11 | loss: 0.0107987
	speed: 0.0645s/iter; left time: 2708.0552s
	iters: 300, epoch: 11 | loss: 0.1820393
	speed: 0.0618s/iter; left time: 2592.1208s
	iters: 400, epoch: 11 | loss: 0.0018363
	speed: 0.0642s/iter; left time: 2684.1802s
Epoch: 11 cost time: 30.093215465545654
Epoch: 11, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0091924
	speed: 0.2771s/iter; left time: 11538.1473s
	iters: 200, epoch: 12 | loss: 0.1093523
	speed: 0.0643s/iter; left time: 2670.6739s
	iters: 300, epoch: 12 | loss: 0.0028612
	speed: 0.0619s/iter; left time: 2564.4122s
	iters: 400, epoch: 12 | loss: 0.2554019
	speed: 0.0591s/iter; left time: 2444.7571s
Epoch: 12 cost time: 29.66426157951355
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0005932
	speed: 0.2624s/iter; left time: 10805.7080s
	iters: 200, epoch: 13 | loss: 0.0170579
	speed: 0.0594s/iter; left time: 2440.7733s
	iters: 300, epoch: 13 | loss: 0.0629083
	speed: 0.0580s/iter; left time: 2374.5244s
	iters: 400, epoch: 13 | loss: 0.0170124
	speed: 0.0628s/iter; left time: 2568.4281s
Epoch: 13 cost time: 28.618547677993774
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0181373
	speed: 0.2827s/iter; left time: 11508.1958s
	iters: 200, epoch: 14 | loss: 0.0123673
	speed: 0.0660s/iter; left time: 2681.3103s
	iters: 300, epoch: 14 | loss: 0.0007523
	speed: 0.0638s/iter; left time: 2583.9691s
	iters: 400, epoch: 14 | loss: 0.0822656
	speed: 0.0601s/iter; left time: 2426.6102s
Epoch: 14 cost time: 30.774079084396362
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0006251
	speed: 0.2822s/iter; left time: 11353.4072s
	iters: 200, epoch: 15 | loss: 0.0456792
	speed: 0.0641s/iter; left time: 2572.5244s
	iters: 300, epoch: 15 | loss: 0.1831214
	speed: 0.0631s/iter; left time: 2525.8803s
	iters: 400, epoch: 15 | loss: 0.0105864
	speed: 0.0634s/iter; left time: 2529.9782s
Epoch: 15 cost time: 30.632505655288696
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0010643
	speed: 0.2582s/iter; left time: 10265.6649s
	iters: 200, epoch: 16 | loss: 0.0106364
	speed: 0.0608s/iter; left time: 2411.1772s
	iters: 300, epoch: 16 | loss: 0.0572792
	speed: 0.0615s/iter; left time: 2432.3479s
	iters: 400, epoch: 16 | loss: 0.0753901
	speed: 0.0651s/iter; left time: 2568.3968s
Epoch: 16 cost time: 29.640373706817627
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1700390
	speed: 0.2766s/iter; left time: 10868.3253s
	iters: 200, epoch: 17 | loss: 0.0233496
	speed: 0.0635s/iter; left time: 2487.5850s
	iters: 300, epoch: 17 | loss: 0.0244694
	speed: 0.0598s/iter; left time: 2338.9292s
	iters: 400, epoch: 17 | loss: 0.0014892
	speed: 0.0652s/iter; left time: 2542.9385s
Epoch: 17 cost time: 30.00616765022278
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0026241
	speed: 0.2839s/iter; left time: 11025.1744s
	iters: 200, epoch: 18 | loss: 0.0203480
	speed: 0.0620s/iter; left time: 2401.6257s
	iters: 300, epoch: 18 | loss: 0.0497302
	speed: 0.0593s/iter; left time: 2289.2792s
	iters: 400, epoch: 18 | loss: 0.0281680
	speed: 0.0613s/iter; left time: 2363.3176s
Epoch: 18 cost time: 29.155030965805054
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 1098634
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7047911
	speed: 0.0775s/iter; left time: 3626.4665s
	iters: 200, epoch: 1 | loss: 0.1215674
	speed: 0.0634s/iter; left time: 2961.7134s
	iters: 300, epoch: 1 | loss: 0.1696673
	speed: 0.0579s/iter; left time: 2697.7521s
	iters: 400, epoch: 1 | loss: 0.3028010
	speed: 0.0578s/iter; left time: 2685.4499s
Epoch: 1 cost time: 29.870569944381714
Epoch: 1, Steps: 469 | Train Loss: 0.570 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
Validation loss decreased (inf --> -0.946253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0630173
	speed: 0.2609s/iter; left time: 12089.9692s
	iters: 200, epoch: 2 | loss: 0.0389551
	speed: 0.0695s/iter; left time: 3215.0770s
	iters: 300, epoch: 2 | loss: 0.0324345
	speed: 0.0686s/iter; left time: 3166.4564s
	iters: 400, epoch: 2 | loss: 0.0730823
	speed: 0.0652s/iter; left time: 2999.9571s
Epoch: 2 cost time: 31.5433509349823
Epoch: 2, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.946253 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0484241
	speed: 0.2555s/iter; left time: 11719.7866s
	iters: 200, epoch: 3 | loss: 0.0622337
	speed: 0.0652s/iter; left time: 2983.9382s
	iters: 300, epoch: 3 | loss: 0.1627622
	speed: 0.0653s/iter; left time: 2982.3690s
	iters: 400, epoch: 3 | loss: 0.1205340
	speed: 0.0688s/iter; left time: 3133.7204s
Epoch: 3 cost time: 31.361072778701782
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0047899
	speed: 0.2626s/iter; left time: 11919.0942s
	iters: 200, epoch: 4 | loss: 0.0504102
	speed: 0.0649s/iter; left time: 2941.7388s
	iters: 300, epoch: 4 | loss: 0.0311955
	speed: 0.0624s/iter; left time: 2820.4905s
	iters: 400, epoch: 4 | loss: 0.0050150
	speed: 0.0611s/iter; left time: 2756.1351s
Epoch: 4 cost time: 29.648316144943237
Epoch: 4, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018421
	speed: 0.2662s/iter; left time: 11957.5656s
	iters: 200, epoch: 5 | loss: 0.0220594
	speed: 0.0652s/iter; left time: 2924.7337s
	iters: 300, epoch: 5 | loss: 0.0014088
	speed: 0.0654s/iter; left time: 2925.0696s
	iters: 400, epoch: 5 | loss: 0.0122467
	speed: 0.0615s/iter; left time: 2743.3846s
Epoch: 5 cost time: 30.412174463272095
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002634
	speed: 0.2030s/iter; left time: 9026.3599s
	iters: 200, epoch: 6 | loss: 0.0044426
	speed: 0.0526s/iter; left time: 2334.7868s
	iters: 300, epoch: 6 | loss: 0.0085515
	speed: 0.0610s/iter; left time: 2699.3621s
	iters: 400, epoch: 6 | loss: 0.0901391
	speed: 0.0665s/iter; left time: 2935.2451s
Epoch: 6 cost time: 28.037434577941895
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0048858
	speed: 0.2577s/iter; left time: 11336.9630s
	iters: 200, epoch: 7 | loss: 0.3391100
	speed: 0.0634s/iter; left time: 2782.5092s
	iters: 300, epoch: 7 | loss: 0.0022768
	speed: 0.0651s/iter; left time: 2850.8987s
	iters: 400, epoch: 7 | loss: 0.0048993
	speed: 0.0642s/iter; left time: 2806.1581s
Epoch: 7 cost time: 30.161981344223022
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.295 Vali Acc: 0.923 Test Loss: 0.295 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0064621
	speed: 0.2430s/iter; left time: 10574.6182s
	iters: 200, epoch: 8 | loss: 0.0030167
	speed: 0.0674s/iter; left time: 2924.5921s
	iters: 300, epoch: 8 | loss: 0.0027682
	speed: 0.0640s/iter; left time: 2772.8836s
	iters: 400, epoch: 8 | loss: 0.0036103
	speed: 0.0670s/iter; left time: 2897.5210s
Epoch: 8 cost time: 30.991726398468018
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0019721
	speed: 0.2629s/iter; left time: 11317.9927s
	iters: 200, epoch: 9 | loss: 0.0493465
	speed: 0.0661s/iter; left time: 2837.7831s
	iters: 300, epoch: 9 | loss: 0.0008561
	speed: 0.0665s/iter; left time: 2847.9886s
	iters: 400, epoch: 9 | loss: 0.1670132
	speed: 0.0649s/iter; left time: 2775.7091s
Epoch: 9 cost time: 31.066187858581543
Epoch: 9, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.963978 --> -0.971125).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0018097
	speed: 0.2413s/iter; left time: 10274.2971s
	iters: 200, epoch: 10 | loss: 0.0109438
	speed: 0.0641s/iter; left time: 2724.3705s
	iters: 300, epoch: 10 | loss: 0.0111496
	speed: 0.0649s/iter; left time: 2750.3956s
	iters: 400, epoch: 10 | loss: 0.0161698
	speed: 0.0632s/iter; left time: 2670.0205s
Epoch: 10 cost time: 29.983876705169678
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0902329
	speed: 0.2619s/iter; left time: 11027.2475s
	iters: 200, epoch: 11 | loss: 0.0004943
	speed: 0.0653s/iter; left time: 2744.9565s
	iters: 300, epoch: 11 | loss: 0.0060086
	speed: 0.0645s/iter; left time: 2704.9053s
	iters: 400, epoch: 11 | loss: 0.0005103
	speed: 0.0627s/iter; left time: 2619.5172s
Epoch: 11 cost time: 30.675988912582397
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011249
	speed: 0.2665s/iter; left time: 11097.6462s
	iters: 200, epoch: 12 | loss: 0.0673464
	speed: 0.0667s/iter; left time: 2769.8783s
	iters: 300, epoch: 12 | loss: 0.0004557
	speed: 0.0661s/iter; left time: 2740.3049s
	iters: 400, epoch: 12 | loss: 0.3728031
	speed: 0.0647s/iter; left time: 2675.6280s
Epoch: 12 cost time: 31.51954936981201
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000214
	speed: 0.2619s/iter; left time: 10783.0981s
	iters: 200, epoch: 13 | loss: 0.0057052
	speed: 0.0610s/iter; left time: 2505.7371s
	iters: 300, epoch: 13 | loss: 0.0217550
	speed: 0.0618s/iter; left time: 2530.5075s
	iters: 400, epoch: 13 | loss: 0.0027889
	speed: 0.0653s/iter; left time: 2669.2452s
Epoch: 13 cost time: 29.699079275131226
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0009340
	speed: 0.2666s/iter; left time: 10851.5460s
	iters: 200, epoch: 14 | loss: 0.0013947
	speed: 0.0653s/iter; left time: 2653.3522s
	iters: 300, epoch: 14 | loss: 0.0004691
	speed: 0.0678s/iter; left time: 2745.3429s
	iters: 400, epoch: 14 | loss: 0.0007786
	speed: 0.0667s/iter; left time: 2695.0923s
Epoch: 14 cost time: 31.043562412261963
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.977415).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0147535
	speed: 0.2562s/iter; left time: 10308.8259s
	iters: 200, epoch: 15 | loss: 0.0054918
	speed: 0.0645s/iter; left time: 2588.4303s
	iters: 300, epoch: 15 | loss: 0.0020970
	speed: 0.0657s/iter; left time: 2629.6852s
	iters: 400, epoch: 15 | loss: 0.0558931
	speed: 0.0655s/iter; left time: 2615.5652s
Epoch: 15 cost time: 30.308616399765015
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0570688
	speed: 0.2666s/iter; left time: 10600.6922s
	iters: 200, epoch: 16 | loss: 0.0019912
	speed: 0.0640s/iter; left time: 2538.8247s
	iters: 300, epoch: 16 | loss: 0.0615999
	speed: 0.0658s/iter; left time: 2602.3161s
	iters: 400, epoch: 16 | loss: 0.0367132
	speed: 0.0635s/iter; left time: 2507.7951s
Epoch: 16 cost time: 30.332746982574463
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7794436
	speed: 0.2474s/iter; left time: 9720.7897s
	iters: 200, epoch: 17 | loss: 0.0008252
	speed: 0.0607s/iter; left time: 2377.5820s
	iters: 300, epoch: 17 | loss: 0.1326454
	speed: 0.0688s/iter; left time: 2690.8553s
	iters: 400, epoch: 17 | loss: 0.0035360
	speed: 0.0665s/iter; left time: 2591.9263s
Epoch: 17 cost time: 30.74755835533142
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0002585
	speed: 0.2739s/iter; left time: 10633.1294s
	iters: 200, epoch: 18 | loss: 0.0012926
	speed: 0.0612s/iter; left time: 2371.8570s
	iters: 300, epoch: 18 | loss: 0.0057672
	speed: 0.0649s/iter; left time: 2507.0757s
	iters: 400, epoch: 18 | loss: 0.0002814
	speed: 0.0697s/iter; left time: 2685.0257s
Epoch: 18 cost time: 30.859243631362915
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0012328
	speed: 0.2524s/iter; left time: 9680.6383s
	iters: 200, epoch: 19 | loss: 0.0015817
	speed: 0.0605s/iter; left time: 2315.1307s
	iters: 300, epoch: 19 | loss: 0.0049994
	speed: 0.0622s/iter; left time: 2372.6499s
	iters: 400, epoch: 19 | loss: 0.0024688
	speed: 0.0676s/iter; left time: 2574.5823s
Epoch: 19 cost time: 29.948296785354614
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0388568
	speed: 0.2691s/iter; left time: 10197.5178s
	iters: 200, epoch: 20 | loss: 0.0004287
	speed: 0.0618s/iter; left time: 2335.5370s
	iters: 300, epoch: 20 | loss: 0.0457940
	speed: 0.0650s/iter; left time: 2449.0193s
	iters: 400, epoch: 20 | loss: 0.0018317
	speed: 0.0687s/iter; left time: 2582.1621s
Epoch: 20 cost time: 30.683513164520264
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0021385
	speed: 0.2603s/iter; left time: 9740.3545s
	iters: 200, epoch: 21 | loss: 0.0019331
	speed: 0.0614s/iter; left time: 2289.7346s
	iters: 300, epoch: 21 | loss: 0.0847827
	speed: 0.0671s/iter; left time: 2498.5478s
	iters: 400, epoch: 21 | loss: 0.0003358
	speed: 0.0690s/iter; left time: 2562.5118s
Epoch: 21 cost time: 31.081389904022217
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0003396
	speed: 0.2697s/iter; left time: 9966.7487s
	iters: 200, epoch: 22 | loss: 0.0592974
	speed: 0.0602s/iter; left time: 2217.5013s
	iters: 300, epoch: 22 | loss: 0.0321042
	speed: 0.0623s/iter; left time: 2290.8872s
	iters: 400, epoch: 22 | loss: 0.4707498
	speed: 0.0616s/iter; left time: 2258.7816s
Epoch: 22 cost time: 29.29757523536682
Epoch: 22, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0529844
	speed: 0.2569s/iter; left time: 9373.8020s
	iters: 200, epoch: 23 | loss: 0.0097294
	speed: 0.0624s/iter; left time: 2269.2242s
	iters: 300, epoch: 23 | loss: 0.0031072
	speed: 0.0648s/iter; left time: 2351.2561s
	iters: 400, epoch: 23 | loss: 0.5022749
	speed: 0.0644s/iter; left time: 2329.4444s
Epoch: 23 cost time: 30.57829761505127
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0010355
	speed: 0.2782s/iter; left time: 10020.3118s
	iters: 200, epoch: 24 | loss: 0.0001082
	speed: 0.0633s/iter; left time: 2271.6906s
	iters: 300, epoch: 24 | loss: 0.0041769
	speed: 0.0653s/iter; left time: 2337.7518s
	iters: 400, epoch: 24 | loss: 0.0013233
	speed: 0.0657s/iter; left time: 2347.1295s
Epoch: 24 cost time: 30.202389001846313
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0064087
	speed: 0.2557s/iter; left time: 9087.6475s
	iters: 200, epoch: 25 | loss: 0.0018106
	speed: 0.0596s/iter; left time: 2113.9428s
	iters: 300, epoch: 25 | loss: 0.0000978
	speed: 0.0609s/iter; left time: 2150.9593s
	iters: 400, epoch: 25 | loss: 0.0011740
	speed: 0.0680s/iter; left time: 2396.3477s
Epoch: 25 cost time: 29.906648874282837
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 1098634
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3082640
	speed: 0.0753s/iter; left time: 3524.0384s
	iters: 200, epoch: 1 | loss: 2.3004856
	speed: 0.0655s/iter; left time: 3056.6546s
	iters: 300, epoch: 1 | loss: 2.2997367
	speed: 0.0683s/iter; left time: 3183.3237s
	iters: 400, epoch: 1 | loss: 2.3068383
	speed: 0.0619s/iter; left time: 2876.8178s
Epoch: 1 cost time: 31.26756262779236
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3033020
	speed: 0.2461s/iter; left time: 11402.7718s
	iters: 200, epoch: 2 | loss: 2.3045979
	speed: 0.0644s/iter; left time: 2977.3743s
	iters: 300, epoch: 2 | loss: 2.2959943
	speed: 0.0656s/iter; left time: 3024.6568s
	iters: 400, epoch: 2 | loss: 2.3014736
	speed: 0.0632s/iter; left time: 2910.7510s
Epoch: 2 cost time: 30.273513793945312
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3090463
	speed: 0.2568s/iter; left time: 11778.0680s
	iters: 200, epoch: 3 | loss: 2.3030062
	speed: 0.0697s/iter; left time: 3188.5114s
	iters: 300, epoch: 3 | loss: 2.3026717
	speed: 0.0701s/iter; left time: 3203.2396s
	iters: 400, epoch: 3 | loss: 2.2912865
	speed: 0.0645s/iter; left time: 2938.1790s
Epoch: 3 cost time: 32.188541889190674
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2917886
	speed: 0.2612s/iter; left time: 11855.0597s
	iters: 200, epoch: 4 | loss: 2.3028910
	speed: 0.0672s/iter; left time: 3043.9568s
	iters: 300, epoch: 4 | loss: 2.3028152
	speed: 0.0665s/iter; left time: 3004.6050s
	iters: 400, epoch: 4 | loss: 2.3002391
	speed: 0.0669s/iter; left time: 3015.2901s
Epoch: 4 cost time: 31.23370623588562
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2981553
	speed: 0.2550s/iter; left time: 11457.2649s
	iters: 200, epoch: 5 | loss: 2.3074610
	speed: 0.0619s/iter; left time: 2774.3369s
	iters: 300, epoch: 5 | loss: 2.2966459
	speed: 0.0604s/iter; left time: 2700.0059s
	iters: 400, epoch: 5 | loss: 2.2910461
	speed: 0.0631s/iter; left time: 2818.0602s
Epoch: 5 cost time: 29.015921115875244
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3031232
	speed: 0.2386s/iter; left time: 10606.1850s
	iters: 200, epoch: 6 | loss: 2.3026419
	speed: 0.0616s/iter; left time: 2732.0815s
	iters: 300, epoch: 6 | loss: 2.3148923
	speed: 0.0624s/iter; left time: 2759.9634s
	iters: 400, epoch: 6 | loss: 2.3037937
	speed: 0.0576s/iter; left time: 2544.5917s
Epoch: 6 cost time: 28.839616537094116
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3089128
	speed: 0.2736s/iter; left time: 12033.4702s
	iters: 200, epoch: 7 | loss: 2.3045232
	speed: 0.0647s/iter; left time: 2837.7124s
	iters: 300, epoch: 7 | loss: 2.3132463
	speed: 0.0608s/iter; left time: 2663.8700s
	iters: 400, epoch: 7 | loss: 2.2956953
	speed: 0.0616s/iter; left time: 2689.5529s
Epoch: 7 cost time: 29.768954038619995
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2913818
	speed: 0.2486s/iter; left time: 10819.5014s
	iters: 200, epoch: 8 | loss: 2.2882965
	speed: 0.0596s/iter; left time: 2586.7592s
	iters: 300, epoch: 8 | loss: 2.2963347
	speed: 0.0475s/iter; left time: 2059.3180s
	iters: 400, epoch: 8 | loss: 2.3182464
	speed: 0.0438s/iter; left time: 1892.1382s
Epoch: 8 cost time: 24.840665102005005
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3027792
	speed: 0.1954s/iter; left time: 8412.6645s
	iters: 200, epoch: 9 | loss: 2.3103919
	speed: 0.0641s/iter; left time: 2754.8331s
	iters: 300, epoch: 9 | loss: 2.3114974
	speed: 0.0614s/iter; left time: 2632.7800s
	iters: 400, epoch: 9 | loss: 2.3035443
	speed: 0.0615s/iter; left time: 2627.3282s
Epoch: 9 cost time: 29.584638118743896
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3189104
	speed: 0.2611s/iter; left time: 11117.0506s
	iters: 200, epoch: 10 | loss: 2.2925477
	speed: 0.0617s/iter; left time: 2622.6752s
	iters: 300, epoch: 10 | loss: 2.3169136
	speed: 0.0608s/iter; left time: 2576.4664s
	iters: 400, epoch: 10 | loss: 2.3004591
	speed: 0.0615s/iter; left time: 2601.5356s
Epoch: 10 cost time: 29.141433477401733
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3209498
	speed: 0.2699s/iter; left time: 11365.9901s
	iters: 200, epoch: 11 | loss: 2.3161891
	speed: 0.0605s/iter; left time: 2539.6019s
	iters: 300, epoch: 11 | loss: 2.3115115
	speed: 0.0566s/iter; left time: 2370.7005s
	iters: 400, epoch: 11 | loss: 2.3032932
	speed: 0.0568s/iter; left time: 2375.5020s
Epoch: 11 cost time: 28.190919637680054
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3188114
	speed: 0.2515s/iter; left time: 10471.6369s
	iters: 200, epoch: 12 | loss: 2.2960820
	speed: 0.0619s/iter; left time: 2572.6042s
	iters: 300, epoch: 12 | loss: 2.2863193
	speed: 0.0610s/iter; left time: 2525.9089s
	iters: 400, epoch: 12 | loss: 2.2949591
	speed: 0.0601s/iter; left time: 2484.2068s
Epoch: 12 cost time: 29.171635150909424
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2885678
	speed: 0.2565s/iter; left time: 10559.8245s
	iters: 200, epoch: 13 | loss: 2.2955077
	speed: 0.0626s/iter; left time: 2571.8201s
	iters: 300, epoch: 13 | loss: 2.2943888
	speed: 0.0635s/iter; left time: 2600.5015s
	iters: 400, epoch: 13 | loss: 2.3067441
	speed: 0.0626s/iter; left time: 2557.9869s
Epoch: 13 cost time: 30.197387218475342
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2754393
	speed: 0.2759s/iter; left time: 11230.5199s
	iters: 200, epoch: 14 | loss: 2.2960184
	speed: 0.0612s/iter; left time: 2486.6410s
	iters: 300, epoch: 14 | loss: 2.2983887
	speed: 0.0600s/iter; left time: 2428.8939s
	iters: 400, epoch: 14 | loss: 2.2940392
	speed: 0.0625s/iter; left time: 2525.1629s
Epoch: 14 cost time: 29.360567092895508
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3063667
	speed: 0.2608s/iter; left time: 10493.5368s
	iters: 200, epoch: 15 | loss: 2.3203793
	speed: 0.0608s/iter; left time: 2438.8666s
	iters: 300, epoch: 15 | loss: 2.3037374
	speed: 0.0615s/iter; left time: 2463.8985s
	iters: 400, epoch: 15 | loss: 2.3231890
	speed: 0.0596s/iter; left time: 2380.2685s
Epoch: 15 cost time: 29.257563829421997
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3152950
	speed: 0.2609s/iter; left time: 10376.1433s
	iters: 200, epoch: 16 | loss: 2.3053348
	speed: 0.0621s/iter; left time: 2462.5775s
	iters: 300, epoch: 16 | loss: 2.2995977
	speed: 0.0582s/iter; left time: 2302.9597s
	iters: 400, epoch: 16 | loss: 2.2974854
	speed: 0.0605s/iter; left time: 2389.6027s
Epoch: 16 cost time: 28.982268810272217
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3081236
	speed: 0.2612s/iter; left time: 10262.9733s
	iters: 200, epoch: 17 | loss: 2.2944987
	speed: 0.0555s/iter; left time: 2174.6789s
	iters: 300, epoch: 17 | loss: 2.3050227
	speed: 0.0598s/iter; left time: 2336.7714s
	iters: 400, epoch: 17 | loss: 2.3035073
	speed: 0.0594s/iter; left time: 2315.2725s
Epoch: 17 cost time: 28.386706113815308
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.2975786
	speed: 0.2600s/iter; left time: 10095.6261s
	iters: 200, epoch: 18 | loss: 2.3101737
	speed: 0.0568s/iter; left time: 2201.3537s
	iters: 300, epoch: 18 | loss: 2.3043602
	speed: 0.0559s/iter; left time: 2157.8803s
	iters: 400, epoch: 18 | loss: 2.2974539
	speed: 0.0605s/iter; left time: 2331.1979s
Epoch: 18 cost time: 28.016944885253906
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.2936120
	speed: 0.2599s/iter; left time: 9971.2139s
	iters: 200, epoch: 19 | loss: 2.3209565
	speed: 0.0591s/iter; left time: 2260.6473s
	iters: 300, epoch: 19 | loss: 2.3090320
	speed: 0.0600s/iter; left time: 2291.1488s
	iters: 400, epoch: 19 | loss: 2.3127158
	speed: 0.0601s/iter; left time: 2288.9526s
Epoch: 19 cost time: 29.02833604812622
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.2845325
	speed: 0.2675s/iter; left time: 10135.6740s
	iters: 200, epoch: 20 | loss: 2.3130355
	speed: 0.0546s/iter; left time: 2063.4300s
	iters: 300, epoch: 20 | loss: 2.2984571
	speed: 0.0581s/iter; left time: 2190.6196s
	iters: 400, epoch: 20 | loss: 2.3107522
	speed: 0.0597s/iter; left time: 2245.1425s
Epoch: 20 cost time: 27.783122539520264
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.2932012
	speed: 0.2543s/iter; left time: 9516.4545s
	iters: 200, epoch: 21 | loss: 2.3065686
	speed: 0.0574s/iter; left time: 2143.9078s
	iters: 300, epoch: 21 | loss: 2.3022115
	speed: 0.0594s/iter; left time: 2210.3334s
	iters: 400, epoch: 21 | loss: 2.3068357
	speed: 0.0604s/iter; left time: 2242.6313s
Epoch: 21 cost time: 28.536348581314087
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.3188829
	speed: 0.2575s/iter; left time: 9514.8010s
	iters: 200, epoch: 22 | loss: 2.2928529
	speed: 0.0604s/iter; left time: 2227.0202s
	iters: 300, epoch: 22 | loss: 2.2988513
	speed: 0.0618s/iter; left time: 2270.2091s
	iters: 400, epoch: 22 | loss: 2.3068142
	speed: 0.0585s/iter; left time: 2145.8542s
Epoch: 22 cost time: 29.550148725509644
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.3162866
	speed: 0.2755s/iter; left time: 10051.0426s
	iters: 200, epoch: 23 | loss: 2.3136418
	speed: 0.0615s/iter; left time: 2237.5073s
	iters: 300, epoch: 23 | loss: 2.3125942
	speed: 0.0592s/iter; left time: 2147.0885s
	iters: 400, epoch: 23 | loss: 2.3065372
	speed: 0.0563s/iter; left time: 2038.6510s
Epoch: 23 cost time: 29.018423795700073
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 1098634
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1025119
	speed: 0.0729s/iter; left time: 3412.2326s
	iters: 200, epoch: 1 | loss: 0.1967905
	speed: 0.0648s/iter; left time: 3025.5374s
	iters: 300, epoch: 1 | loss: 0.1137500
	speed: 0.0703s/iter; left time: 3275.1810s
	iters: 400, epoch: 1 | loss: 0.1326126
	speed: 0.0667s/iter; left time: 3099.6469s
Epoch: 1 cost time: 32.24108004570007
Epoch: 1, Steps: 469 | Train Loss: 0.539 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (inf --> -0.956831).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0730309
	speed: 0.2472s/iter; left time: 11455.0341s
	iters: 200, epoch: 2 | loss: 0.0287273
	speed: 0.0662s/iter; left time: 3062.8648s
	iters: 300, epoch: 2 | loss: 0.0213267
	speed: 0.0650s/iter; left time: 3000.4301s
	iters: 400, epoch: 2 | loss: 0.0298430
	speed: 0.0626s/iter; left time: 2883.1595s
Epoch: 2 cost time: 29.841352462768555
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0301621
	speed: 0.2463s/iter; left time: 11295.4733s
	iters: 200, epoch: 3 | loss: 0.0195123
	speed: 0.0592s/iter; left time: 2709.0516s
	iters: 300, epoch: 3 | loss: 0.0089346
	speed: 0.0614s/iter; left time: 2805.0041s
	iters: 400, epoch: 3 | loss: 0.0410783
	speed: 0.0611s/iter; left time: 2784.4081s
Epoch: 3 cost time: 28.45199990272522
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
Validation loss decreased (-0.956831 --> -0.963692).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0227835
	speed: 0.2382s/iter; left time: 10814.8819s
	iters: 200, epoch: 4 | loss: 0.0206487
	speed: 0.0628s/iter; left time: 2845.4811s
	iters: 300, epoch: 4 | loss: 0.0100317
	speed: 0.0658s/iter; left time: 2974.2117s
	iters: 400, epoch: 4 | loss: 0.0145795
	speed: 0.0596s/iter; left time: 2687.9325s
Epoch: 4 cost time: 29.314220666885376
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.963692 --> -0.974556).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0057352
	speed: 0.2441s/iter; left time: 10965.7892s
	iters: 200, epoch: 5 | loss: 0.0263077
	speed: 0.0666s/iter; left time: 2983.5111s
	iters: 300, epoch: 5 | loss: 0.0129788
	speed: 0.0670s/iter; left time: 2996.8165s
	iters: 400, epoch: 5 | loss: 0.0038389
	speed: 0.0649s/iter; left time: 2894.9630s
Epoch: 5 cost time: 31.090686559677124
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0245391
	speed: 0.2569s/iter; left time: 11420.4950s
	iters: 200, epoch: 6 | loss: 0.0096722
	speed: 0.0646s/iter; left time: 2865.0360s
	iters: 300, epoch: 6 | loss: 0.0254518
	speed: 0.0628s/iter; left time: 2777.1558s
	iters: 400, epoch: 6 | loss: 0.0011840
	speed: 0.0608s/iter; left time: 2683.3678s
Epoch: 6 cost time: 29.132325172424316
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.975128).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0388435
	speed: 0.2409s/iter; left time: 10594.8235s
	iters: 200, epoch: 7 | loss: 0.0166097
	speed: 0.0626s/iter; left time: 2745.8002s
	iters: 300, epoch: 7 | loss: 0.1027962
	speed: 0.0631s/iter; left time: 2764.9897s
	iters: 400, epoch: 7 | loss: 0.0031322
	speed: 0.0666s/iter; left time: 2908.1387s
Epoch: 7 cost time: 29.90837574005127
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0015373
	speed: 0.2527s/iter; left time: 10998.4891s
	iters: 200, epoch: 8 | loss: 0.1479347
	speed: 0.0628s/iter; left time: 2725.4428s
	iters: 300, epoch: 8 | loss: 0.0216715
	speed: 0.0662s/iter; left time: 2866.6240s
	iters: 400, epoch: 8 | loss: 0.0064360
	speed: 0.0641s/iter; left time: 2772.0339s
Epoch: 8 cost time: 30.022815465927124
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.975128 --> -0.979988).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0045001
	speed: 0.2673s/iter; left time: 11505.6313s
	iters: 200, epoch: 9 | loss: 0.0759576
	speed: 0.0626s/iter; left time: 2687.1905s
	iters: 300, epoch: 9 | loss: 0.3623937
	speed: 0.0650s/iter; left time: 2784.6283s
	iters: 400, epoch: 9 | loss: 0.0890670
	speed: 0.0606s/iter; left time: 2591.6346s
Epoch: 9 cost time: 29.117740631103516
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2053367
	speed: 0.2404s/iter; left time: 10237.3167s
	iters: 200, epoch: 10 | loss: 0.0017637
	speed: 0.0616s/iter; left time: 2614.7564s
	iters: 300, epoch: 10 | loss: 0.0122627
	speed: 0.0595s/iter; left time: 2522.5369s
	iters: 400, epoch: 10 | loss: 0.0010858
	speed: 0.0582s/iter; left time: 2458.7676s
Epoch: 10 cost time: 28.605441093444824
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0024912
	speed: 0.2702s/iter; left time: 11379.9370s
	iters: 200, epoch: 11 | loss: 0.0037047
	speed: 0.0593s/iter; left time: 2490.7497s
	iters: 300, epoch: 11 | loss: 0.0068467
	speed: 0.0602s/iter; left time: 2522.9275s
	iters: 400, epoch: 11 | loss: 0.0004902
	speed: 0.0627s/iter; left time: 2620.3038s
Epoch: 11 cost time: 29.48229742050171
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0011645
	speed: 0.2683s/iter; left time: 11172.5115s
	iters: 200, epoch: 12 | loss: 0.1135326
	speed: 0.0644s/iter; left time: 2674.2624s
	iters: 300, epoch: 12 | loss: 0.0087266
	speed: 0.0641s/iter; left time: 2655.2072s
	iters: 400, epoch: 12 | loss: 0.0008103
	speed: 0.0623s/iter; left time: 2575.9592s
Epoch: 12 cost time: 30.135096788406372
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0016343
	speed: 0.2398s/iter; left time: 9873.7753s
	iters: 200, epoch: 13 | loss: 0.0050334
	speed: 0.0604s/iter; left time: 2481.9863s
	iters: 300, epoch: 13 | loss: 0.0065469
	speed: 0.0585s/iter; left time: 2398.2742s
	iters: 400, epoch: 13 | loss: 0.0003453
	speed: 0.0632s/iter; left time: 2585.1879s
Epoch: 13 cost time: 29.0320246219635
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0059682
	speed: 0.2729s/iter; left time: 11106.3567s
	iters: 200, epoch: 14 | loss: 0.0084121
	speed: 0.0611s/iter; left time: 2481.4357s
	iters: 300, epoch: 14 | loss: 0.3237266
	speed: 0.0584s/iter; left time: 2365.3670s
	iters: 400, epoch: 14 | loss: 0.0059664
	speed: 0.0612s/iter; left time: 2474.1045s
Epoch: 14 cost time: 28.88900351524353
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0011688
	speed: 0.2710s/iter; left time: 10904.9879s
	iters: 200, epoch: 15 | loss: 0.0021319
	speed: 0.0613s/iter; left time: 2459.2643s
	iters: 300, epoch: 15 | loss: 0.0165224
	speed: 0.0632s/iter; left time: 2528.8621s
	iters: 400, epoch: 15 | loss: 0.1119574
	speed: 0.0601s/iter; left time: 2401.6150s
Epoch: 15 cost time: 29.69974446296692
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0027530
	speed: 0.2519s/iter; left time: 10017.4642s
	iters: 200, epoch: 16 | loss: 0.0760233
	speed: 0.0595s/iter; left time: 2360.9574s
	iters: 300, epoch: 16 | loss: 0.0038599
	speed: 0.0630s/iter; left time: 2491.2002s
	iters: 400, epoch: 16 | loss: 0.0075493
	speed: 0.0628s/iter; left time: 2478.0524s
Epoch: 16 cost time: 29.258890628814697
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000673
	speed: 0.2742s/iter; left time: 10774.3584s
	iters: 200, epoch: 17 | loss: 0.0592370
	speed: 0.0623s/iter; left time: 2443.9025s
	iters: 300, epoch: 17 | loss: 0.0358527
	speed: 0.0630s/iter; left time: 2463.0529s
	iters: 400, epoch: 17 | loss: 0.0046171
	speed: 0.0678s/iter; left time: 2644.4501s
Epoch: 17 cost time: 30.36907148361206
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0007837
	speed: 0.2561s/iter; left time: 9944.2646s
	iters: 200, epoch: 18 | loss: 0.2107957
	speed: 0.0625s/iter; left time: 2419.0790s
	iters: 300, epoch: 18 | loss: 0.0284767
	speed: 0.0605s/iter; left time: 2335.0860s
	iters: 400, epoch: 18 | loss: 0.0005378
	speed: 0.0629s/iter; left time: 2421.5498s
Epoch: 18 cost time: 29.534448623657227
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0136747
	speed: 0.2542s/iter; left time: 9751.1138s
	iters: 200, epoch: 19 | loss: 0.0045214
	speed: 0.0585s/iter; left time: 2239.7494s
	iters: 300, epoch: 19 | loss: 0.1684236
	speed: 0.0554s/iter; left time: 2113.9345s
	iters: 400, epoch: 19 | loss: 0.0007898
	speed: 0.0667s/iter; left time: 2540.2487s
Epoch: 19 cost time: 29.234620332717896
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0312141
	speed: 0.2697s/iter; left time: 10218.4213s
	iters: 200, epoch: 20 | loss: 0.1753342
	speed: 0.0617s/iter; left time: 2332.1016s
	iters: 300, epoch: 20 | loss: 0.4859438
	speed: 0.0644s/iter; left time: 2425.8560s
	iters: 400, epoch: 20 | loss: 0.0006366
	speed: 0.0639s/iter; left time: 2403.4732s
Epoch: 20 cost time: 30.129148721694946
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000553
	speed: 0.2588s/iter; left time: 9683.8114s
	iters: 200, epoch: 21 | loss: 0.0022930
	speed: 0.0581s/iter; left time: 2167.1196s
	iters: 300, epoch: 21 | loss: 0.0125537
	speed: 0.0600s/iter; left time: 2234.2392s
	iters: 400, epoch: 21 | loss: 0.0081317
	speed: 0.0630s/iter; left time: 2339.4362s
Epoch: 21 cost time: 29.136585474014282
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0565491
	speed: 0.2494s/iter; left time: 9216.0374s
	iters: 200, epoch: 22 | loss: 0.0003265
	speed: 0.0642s/iter; left time: 2366.6176s
	iters: 300, epoch: 22 | loss: 0.2475561
	speed: 0.0595s/iter; left time: 2187.0695s
	iters: 400, epoch: 22 | loss: 0.0319833
	speed: 0.0652s/iter; left time: 2388.9479s
Epoch: 22 cost time: 29.366885662078857
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0081683
	speed: 0.2609s/iter; left time: 9518.5416s
	iters: 200, epoch: 23 | loss: 0.0070549
	speed: 0.0605s/iter; left time: 2200.9357s
	iters: 300, epoch: 23 | loss: 0.0008775
	speed: 0.0650s/iter; left time: 2359.0370s
	iters: 400, epoch: 23 | loss: 0.0139178
	speed: 0.0630s/iter; left time: 2279.5524s
Epoch: 23 cost time: 29.304542541503906
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0043018
	speed: 0.2611s/iter; left time: 9404.8188s
	iters: 200, epoch: 24 | loss: 0.0008207
	speed: 0.0551s/iter; left time: 1978.3943s
	iters: 300, epoch: 24 | loss: 0.0002864
	speed: 0.0621s/iter; left time: 2225.3439s
	iters: 400, epoch: 24 | loss: 0.0000268
	speed: 0.0615s/iter; left time: 2194.7508s
Epoch: 24 cost time: 28.46901035308838
Epoch: 24, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0006945
	speed: 0.2545s/iter; left time: 9044.7807s
	iters: 200, epoch: 25 | loss: 0.0089515
	speed: 0.0633s/iter; left time: 2243.7623s
	iters: 300, epoch: 25 | loss: 0.0004286
	speed: 0.0615s/iter; left time: 2174.0670s
	iters: 400, epoch: 25 | loss: 0.0019823
	speed: 0.0651s/iter; left time: 2293.1517s
Epoch: 25 cost time: 29.584311485290527
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0001252
	speed: 0.2630s/iter; left time: 9223.5134s
	iters: 200, epoch: 26 | loss: 0.0071996
	speed: 0.0647s/iter; left time: 2263.5944s
	iters: 300, epoch: 26 | loss: 0.0017314
	speed: 0.0676s/iter; left time: 2356.2750s
	iters: 400, epoch: 26 | loss: 0.0054104
	speed: 0.0694s/iter; left time: 2413.5755s
Epoch: 26 cost time: 31.42272424697876
Epoch: 26, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0018652
	speed: 0.2703s/iter; left time: 9355.2750s
	iters: 200, epoch: 27 | loss: 0.0112224
	speed: 0.0580s/iter; left time: 2003.0164s
	iters: 300, epoch: 27 | loss: 0.0327571
	speed: 0.0617s/iter; left time: 2123.2369s
	iters: 400, epoch: 27 | loss: 0.0401028
	speed: 0.0654s/iter; left time: 2244.4037s
Epoch: 27 cost time: 29.61888027191162
Epoch: 27, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 705418
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2184402
	speed: 0.0750s/iter; left time: 3511.9082s
	iters: 200, epoch: 1 | loss: 0.1874032
	speed: 0.0605s/iter; left time: 2824.3279s
	iters: 300, epoch: 1 | loss: 0.0963688
	speed: 0.0599s/iter; left time: 2789.4407s
	iters: 400, epoch: 1 | loss: 0.1644872
	speed: 0.0574s/iter; left time: 2668.6296s
Epoch: 1 cost time: 29.58469295501709
Epoch: 1, Steps: 469 | Train Loss: 0.622 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
Validation loss decreased (inf --> -0.947111).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1140547
	speed: 0.2592s/iter; left time: 12007.9480s
	iters: 200, epoch: 2 | loss: 0.0592687
	speed: 0.0673s/iter; left time: 3110.8279s
	iters: 300, epoch: 2 | loss: 0.0408977
	speed: 0.0709s/iter; left time: 3270.5237s
	iters: 400, epoch: 2 | loss: 0.0490530
	speed: 0.0632s/iter; left time: 2909.3455s
Epoch: 2 cost time: 31.43464493751526
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.185 Vali Acc: 0.945 Test Loss: 0.185 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0304348
	speed: 0.2399s/iter; left time: 11001.7232s
	iters: 200, epoch: 3 | loss: 0.0580739
	speed: 0.0528s/iter; left time: 2414.5759s
	iters: 300, epoch: 3 | loss: 0.0103300
	speed: 0.0485s/iter; left time: 2213.8647s
	iters: 400, epoch: 3 | loss: 0.2071648
	speed: 0.0496s/iter; left time: 2258.2026s
Epoch: 3 cost time: 25.112409114837646
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.947111 --> -0.965408).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0062043
	speed: 0.2172s/iter; left time: 9858.5564s
	iters: 200, epoch: 4 | loss: 0.0333812
	speed: 0.0633s/iter; left time: 2868.7556s
	iters: 300, epoch: 4 | loss: 0.0709068
	speed: 0.0618s/iter; left time: 2794.8865s
	iters: 400, epoch: 4 | loss: 0.1785163
	speed: 0.0596s/iter; left time: 2688.5855s
Epoch: 4 cost time: 29.1330668926239
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0414181
	speed: 0.2509s/iter; left time: 11270.6828s
	iters: 200, epoch: 5 | loss: 0.1437218
	speed: 0.0650s/iter; left time: 2913.8299s
	iters: 300, epoch: 5 | loss: 0.0942394
	speed: 0.0629s/iter; left time: 2814.6250s
	iters: 400, epoch: 5 | loss: 0.0066127
	speed: 0.0631s/iter; left time: 2817.0117s
Epoch: 5 cost time: 29.992828369140625
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.965408 --> -0.967123).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0891254
	speed: 0.2552s/iter; left time: 11346.7248s
	iters: 200, epoch: 6 | loss: 0.0019413
	speed: 0.0680s/iter; left time: 3014.6774s
	iters: 300, epoch: 6 | loss: 0.1380128
	speed: 0.0610s/iter; left time: 2701.6369s
	iters: 400, epoch: 6 | loss: 0.0184223
	speed: 0.0644s/iter; left time: 2843.8486s
Epoch: 6 cost time: 30.7203369140625
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.967123 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0611778
	speed: 0.2563s/iter; left time: 11274.1383s
	iters: 200, epoch: 7 | loss: 0.1267166
	speed: 0.0580s/iter; left time: 2545.6653s
	iters: 300, epoch: 7 | loss: 0.3091708
	speed: 0.0589s/iter; left time: 2579.6739s
	iters: 400, epoch: 7 | loss: 0.0074854
	speed: 0.0638s/iter; left time: 2786.4396s
Epoch: 7 cost time: 28.8281569480896
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0021559
	speed: 0.2510s/iter; left time: 10922.0628s
	iters: 200, epoch: 8 | loss: 0.1425130
	speed: 0.0609s/iter; left time: 2643.8258s
	iters: 300, epoch: 8 | loss: 0.0018950
	speed: 0.0618s/iter; left time: 2678.3410s
	iters: 400, epoch: 8 | loss: 0.0064459
	speed: 0.0664s/iter; left time: 2870.6595s
Epoch: 8 cost time: 29.933485507965088
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0163567
	speed: 0.2543s/iter; left time: 10948.5671s
	iters: 200, epoch: 9 | loss: 0.0975904
	speed: 0.0604s/iter; left time: 2595.7029s
	iters: 300, epoch: 9 | loss: 0.0187932
	speed: 0.0590s/iter; left time: 2528.6201s
	iters: 400, epoch: 9 | loss: 0.0036833
	speed: 0.0662s/iter; left time: 2830.8362s
Epoch: 9 cost time: 29.122869968414307
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.939 Test Loss: 0.256 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2877957
	speed: 0.2453s/iter; left time: 10442.9977s
	iters: 200, epoch: 10 | loss: 0.0063080
	speed: 0.0562s/iter; left time: 2386.4781s
	iters: 300, epoch: 10 | loss: 0.0840015
	speed: 0.0550s/iter; left time: 2329.7742s
	iters: 400, epoch: 10 | loss: 0.0049511
	speed: 0.0566s/iter; left time: 2391.8494s
Epoch: 10 cost time: 27.258147478103638
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0435262
	speed: 0.2670s/iter; left time: 11243.5413s
	iters: 200, epoch: 11 | loss: 0.0882755
	speed: 0.0548s/iter; left time: 2303.1283s
	iters: 300, epoch: 11 | loss: 0.0278612
	speed: 0.0601s/iter; left time: 2517.2467s
	iters: 400, epoch: 11 | loss: 0.0027600
	speed: 0.0617s/iter; left time: 2578.3187s
Epoch: 11 cost time: 28.886351346969604
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0026866
	speed: 0.2727s/iter; left time: 11356.4588s
	iters: 200, epoch: 12 | loss: 0.0899012
	speed: 0.0563s/iter; left time: 2337.6648s
	iters: 300, epoch: 12 | loss: 0.0220038
	speed: 0.0588s/iter; left time: 2434.7518s
	iters: 400, epoch: 12 | loss: 0.0006039
	speed: 0.0637s/iter; left time: 2632.9188s
Epoch: 12 cost time: 29.10878825187683
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0058134
	speed: 0.2596s/iter; left time: 10689.7065s
	iters: 200, epoch: 13 | loss: 0.0009348
	speed: 0.0553s/iter; left time: 2269.5428s
	iters: 300, epoch: 13 | loss: 0.0393634
	speed: 0.0582s/iter; left time: 2384.2768s
	iters: 400, epoch: 13 | loss: 0.0262394
	speed: 0.0614s/iter; left time: 2508.5330s
Epoch: 13 cost time: 27.94865894317627
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0219231
	speed: 0.2650s/iter; left time: 10787.2010s
	iters: 200, epoch: 14 | loss: 0.0412469
	speed: 0.0604s/iter; left time: 2453.6601s
	iters: 300, epoch: 14 | loss: 0.0275853
	speed: 0.0576s/iter; left time: 2333.8455s
	iters: 400, epoch: 14 | loss: 0.0008737
	speed: 0.0638s/iter; left time: 2577.9149s
Epoch: 14 cost time: 29.282352209091187
Epoch: 14, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0023197
	speed: 0.2724s/iter; left time: 10961.3340s
	iters: 200, epoch: 15 | loss: 0.0131807
	speed: 0.0602s/iter; left time: 2416.9683s
	iters: 300, epoch: 15 | loss: 0.0084272
	speed: 0.0592s/iter; left time: 2371.9223s
	iters: 400, epoch: 15 | loss: 0.1617595
	speed: 0.0607s/iter; left time: 2422.4607s
Epoch: 15 cost time: 29.197994470596313
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0404099
	speed: 0.2550s/iter; left time: 10141.6793s
	iters: 200, epoch: 16 | loss: 0.1161481
	speed: 0.0581s/iter; left time: 2303.8756s
	iters: 300, epoch: 16 | loss: 0.0004901
	speed: 0.0581s/iter; left time: 2297.6974s
	iters: 400, epoch: 16 | loss: 0.0036630
	speed: 0.0579s/iter; left time: 2286.2581s
Epoch: 16 cost time: 28.122544288635254
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 705418
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1931243
	speed: 0.0722s/iter; left time: 3380.8748s
	iters: 200, epoch: 1 | loss: 0.1686185
	speed: 0.0599s/iter; left time: 2795.7317s
	iters: 300, epoch: 1 | loss: 0.0914045
	speed: 0.0652s/iter; left time: 3037.4301s
	iters: 400, epoch: 1 | loss: 0.0789702
	speed: 0.0642s/iter; left time: 2987.5097s
Epoch: 1 cost time: 30.516599416732788
Epoch: 1, Steps: 469 | Train Loss: 0.604 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (inf --> -0.955115).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1134487
	speed: 0.2575s/iter; left time: 11928.5051s
	iters: 200, epoch: 2 | loss: 0.1019091
	speed: 0.0624s/iter; left time: 2887.0254s
	iters: 300, epoch: 2 | loss: 0.0456177
	speed: 0.0596s/iter; left time: 2748.1391s
	iters: 400, epoch: 2 | loss: 0.0175046
	speed: 0.0619s/iter; left time: 2849.5908s
Epoch: 2 cost time: 28.857090950012207
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0430255
	speed: 0.2402s/iter; left time: 11017.3084s
	iters: 200, epoch: 3 | loss: 0.0246757
	speed: 0.0599s/iter; left time: 2743.1433s
	iters: 300, epoch: 3 | loss: 0.0164880
	speed: 0.0613s/iter; left time: 2798.6703s
	iters: 400, epoch: 3 | loss: 0.0241859
	speed: 0.0608s/iter; left time: 2769.1285s
Epoch: 3 cost time: 28.938771963119507
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.955115 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0021093
	speed: 0.2575s/iter; left time: 11688.4298s
	iters: 200, epoch: 4 | loss: 0.0092849
	speed: 0.0632s/iter; left time: 2860.5655s
	iters: 300, epoch: 4 | loss: 0.0261221
	speed: 0.0601s/iter; left time: 2716.7129s
	iters: 400, epoch: 4 | loss: 0.0381450
	speed: 0.0599s/iter; left time: 2701.2751s
Epoch: 4 cost time: 29.180211067199707
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0071858
	speed: 0.2552s/iter; left time: 11465.3387s
	iters: 200, epoch: 5 | loss: 0.0566515
	speed: 0.0624s/iter; left time: 2797.5493s
	iters: 300, epoch: 5 | loss: 0.0882748
	speed: 0.0608s/iter; left time: 2719.9626s
	iters: 400, epoch: 5 | loss: 0.0049320
	speed: 0.0557s/iter; left time: 2484.4192s
Epoch: 5 cost time: 28.393863916397095
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0181092
	speed: 0.2479s/iter; left time: 11021.4625s
	iters: 200, epoch: 6 | loss: 0.0066370
	speed: 0.0643s/iter; left time: 2851.1577s
	iters: 300, epoch: 6 | loss: 0.0085834
	speed: 0.0612s/iter; left time: 2710.1730s
	iters: 400, epoch: 6 | loss: 0.0373180
	speed: 0.0550s/iter; left time: 2430.5022s
Epoch: 6 cost time: 28.745829105377197
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0040953
	speed: 0.2584s/iter; left time: 11364.1084s
	iters: 200, epoch: 7 | loss: 0.0026997
	speed: 0.0656s/iter; left time: 2879.7697s
	iters: 300, epoch: 7 | loss: 0.0324645
	speed: 0.0634s/iter; left time: 2777.8719s
	iters: 400, epoch: 7 | loss: 0.0516954
	speed: 0.0567s/iter; left time: 2476.9585s
Epoch: 7 cost time: 28.974600553512573
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0042342
	speed: 0.2542s/iter; left time: 11062.0408s
	iters: 200, epoch: 8 | loss: 0.0068235
	speed: 0.0615s/iter; left time: 2668.3510s
	iters: 300, epoch: 8 | loss: 0.0231101
	speed: 0.0605s/iter; left time: 2621.1825s
	iters: 400, epoch: 8 | loss: 0.0094614
	speed: 0.0546s/iter; left time: 2358.5403s
Epoch: 8 cost time: 27.931728839874268
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0052651
	speed: 0.2374s/iter; left time: 10217.9746s
	iters: 200, epoch: 9 | loss: 0.2335503
	speed: 0.0633s/iter; left time: 2720.5632s
	iters: 300, epoch: 9 | loss: 0.0399477
	speed: 0.0621s/iter; left time: 2661.4314s
	iters: 400, epoch: 9 | loss: 0.0013667
	speed: 0.0592s/iter; left time: 2529.6863s
Epoch: 9 cost time: 28.878819942474365
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1453765
	speed: 0.2465s/iter; left time: 10497.3033s
	iters: 200, epoch: 10 | loss: 0.0018189
	speed: 0.0629s/iter; left time: 2670.8391s
	iters: 300, epoch: 10 | loss: 0.0601414
	speed: 0.0617s/iter; left time: 2613.2330s
	iters: 400, epoch: 10 | loss: 0.0102060
	speed: 0.0589s/iter; left time: 2490.5465s
Epoch: 10 cost time: 28.85534954071045
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0134959
	speed: 0.2389s/iter; left time: 10060.8827s
	iters: 200, epoch: 11 | loss: 0.0067991
	speed: 0.0632s/iter; left time: 2655.7978s
	iters: 300, epoch: 11 | loss: 0.0027468
	speed: 0.0633s/iter; left time: 2653.8051s
	iters: 400, epoch: 11 | loss: 0.0012267
	speed: 0.0584s/iter; left time: 2440.8781s
Epoch: 11 cost time: 28.848885536193848
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0007371
	speed: 0.2217s/iter; left time: 9230.7738s
	iters: 200, epoch: 12 | loss: 0.0003134
	speed: 0.0511s/iter; left time: 2123.7133s
	iters: 300, epoch: 12 | loss: 0.0349587
	speed: 0.0483s/iter; left time: 2002.2008s
	iters: 400, epoch: 12 | loss: 0.0030107
	speed: 0.0461s/iter; left time: 1904.8067s
Epoch: 12 cost time: 23.959259271621704
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0028361
	speed: 0.1589s/iter; left time: 6542.7753s
	iters: 200, epoch: 13 | loss: 0.0005759
	speed: 0.0451s/iter; left time: 1851.2566s
	iters: 300, epoch: 13 | loss: 0.0019282
	speed: 0.0514s/iter; left time: 2105.4301s
	iters: 400, epoch: 13 | loss: 0.0065106
	speed: 0.0643s/iter; left time: 2626.5559s
Epoch: 13 cost time: 25.162081241607666
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 705418
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3047729
	speed: 0.0828s/iter; left time: 3876.9675s
	iters: 200, epoch: 1 | loss: 2.2988908
	speed: 0.0653s/iter; left time: 3050.1235s
	iters: 300, epoch: 1 | loss: 2.3021414
	speed: 0.0597s/iter; left time: 2780.3156s
	iters: 400, epoch: 1 | loss: 2.3042307
	speed: 0.0546s/iter; left time: 2537.9306s
Epoch: 1 cost time: 30.343076944351196
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3011122
	speed: 0.2419s/iter; left time: 11206.4957s
	iters: 200, epoch: 2 | loss: 2.3075902
	speed: 0.0626s/iter; left time: 2893.2953s
	iters: 300, epoch: 2 | loss: 2.3056874
	speed: 0.0626s/iter; left time: 2889.8617s
	iters: 400, epoch: 2 | loss: 2.3054798
	speed: 0.0626s/iter; left time: 2882.6656s
Epoch: 2 cost time: 29.02978754043579
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2944217
	speed: 0.2475s/iter; left time: 11352.1739s
	iters: 200, epoch: 3 | loss: 2.3056488
	speed: 0.0671s/iter; left time: 3068.6266s
	iters: 300, epoch: 3 | loss: 2.3023670
	speed: 0.0652s/iter; left time: 2975.4957s
	iters: 400, epoch: 3 | loss: 2.2924943
	speed: 0.0586s/iter; left time: 2668.0420s
Epoch: 3 cost time: 30.01814556121826
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2938228
	speed: 0.2607s/iter; left time: 11832.9955s
	iters: 200, epoch: 4 | loss: 2.3026674
	speed: 0.0661s/iter; left time: 2992.4227s
	iters: 300, epoch: 4 | loss: 2.3133972
	speed: 0.0602s/iter; left time: 2720.8942s
	iters: 400, epoch: 4 | loss: 2.2992857
	speed: 0.0602s/iter; left time: 2715.9790s
Epoch: 4 cost time: 29.498091459274292
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3013017
	speed: 0.2405s/iter; left time: 10805.3289s
	iters: 200, epoch: 5 | loss: 2.3056896
	speed: 0.0600s/iter; left time: 2689.2092s
	iters: 300, epoch: 5 | loss: 2.3004489
	speed: 0.0595s/iter; left time: 2660.3210s
	iters: 400, epoch: 5 | loss: 2.3145978
	speed: 0.0626s/iter; left time: 2792.7343s
Epoch: 5 cost time: 28.698336124420166
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3091140
	speed: 0.2438s/iter; left time: 10836.6826s
	iters: 200, epoch: 6 | loss: 2.2920094
	speed: 0.0642s/iter; left time: 2846.4219s
	iters: 300, epoch: 6 | loss: 2.3082895
	speed: 0.0662s/iter; left time: 2931.9388s
	iters: 400, epoch: 6 | loss: 2.3185351
	speed: 0.0616s/iter; left time: 2718.4330s
Epoch: 6 cost time: 30.243962049484253
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2930551
	speed: 0.2567s/iter; left time: 11293.4720s
	iters: 200, epoch: 7 | loss: 2.3136299
	speed: 0.0712s/iter; left time: 3126.2688s
	iters: 300, epoch: 7 | loss: 2.2985458
	speed: 0.0599s/iter; left time: 2623.7869s
	iters: 400, epoch: 7 | loss: 2.2933831
	speed: 0.0639s/iter; left time: 2792.6212s
Epoch: 7 cost time: 30.849188089370728
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3087289
	speed: 0.2471s/iter; left time: 10753.0443s
	iters: 200, epoch: 8 | loss: 2.2912717
	speed: 0.0588s/iter; left time: 2553.1615s
	iters: 300, epoch: 8 | loss: 2.2991855
	speed: 0.0645s/iter; left time: 2794.3136s
	iters: 400, epoch: 8 | loss: 2.2896836
	speed: 0.0639s/iter; left time: 2759.6645s
Epoch: 8 cost time: 29.075680017471313
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3014269
	speed: 0.2411s/iter; left time: 10378.3590s
	iters: 200, epoch: 9 | loss: 2.2853045
	speed: 0.0684s/iter; left time: 2935.7056s
	iters: 300, epoch: 9 | loss: 2.2853446
	speed: 0.0624s/iter; left time: 2675.2083s
	iters: 400, epoch: 9 | loss: 2.3014367
	speed: 0.0646s/iter; left time: 2760.9678s
Epoch: 9 cost time: 30.680289268493652
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3180027
	speed: 0.2431s/iter; left time: 10349.9528s
	iters: 200, epoch: 10 | loss: 2.3091562
	speed: 0.0684s/iter; left time: 2907.4201s
	iters: 300, epoch: 10 | loss: 2.2918794
	speed: 0.0589s/iter; left time: 2497.0119s
	iters: 400, epoch: 10 | loss: 2.3007500
	speed: 0.0590s/iter; left time: 2496.3702s
Epoch: 10 cost time: 29.699490785598755
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2960694
	speed: 0.2436s/iter; left time: 10257.9852s
	iters: 200, epoch: 11 | loss: 2.2877846
	speed: 0.0623s/iter; left time: 2615.3765s
	iters: 300, epoch: 11 | loss: 2.2994041
	speed: 0.0581s/iter; left time: 2435.3244s
	iters: 400, epoch: 11 | loss: 2.2936053
	speed: 0.0634s/iter; left time: 2651.6624s
Epoch: 11 cost time: 29.020121097564697
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3030803
	speed: 0.2563s/iter; left time: 10672.9763s
	iters: 200, epoch: 12 | loss: 2.3125701
	speed: 0.0611s/iter; left time: 2539.6264s
	iters: 300, epoch: 12 | loss: 2.2961185
	speed: 0.0659s/iter; left time: 2730.0349s
	iters: 400, epoch: 12 | loss: 2.2959487
	speed: 0.0673s/iter; left time: 2783.9803s
Epoch: 12 cost time: 30.997581243515015
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3062770
	speed: 0.2400s/iter; left time: 9883.5523s
	iters: 200, epoch: 13 | loss: 2.3007784
	speed: 0.0635s/iter; left time: 2606.2828s
	iters: 300, epoch: 13 | loss: 2.3025644
	speed: 0.0647s/iter; left time: 2651.5417s
	iters: 400, epoch: 13 | loss: 2.2804713
	speed: 0.0602s/iter; left time: 2460.9989s
Epoch: 13 cost time: 29.103837966918945
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3052468
	speed: 0.2175s/iter; left time: 8854.4628s
	iters: 200, epoch: 14 | loss: 2.3143771
	speed: 0.0598s/iter; left time: 2430.1398s
	iters: 300, epoch: 14 | loss: 2.2881110
	speed: 0.0617s/iter; left time: 2498.8624s
	iters: 400, epoch: 14 | loss: 2.2928603
	speed: 0.0626s/iter; left time: 2530.0859s
Epoch: 14 cost time: 28.873164415359497
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2980783
	speed: 0.2361s/iter; left time: 9498.3223s
	iters: 200, epoch: 15 | loss: 2.3100429
	speed: 0.0664s/iter; left time: 2662.9958s
	iters: 300, epoch: 15 | loss: 2.2943776
	speed: 0.0657s/iter; left time: 2632.0740s
	iters: 400, epoch: 15 | loss: 2.2942731
	speed: 0.0591s/iter; left time: 2360.6939s
Epoch: 15 cost time: 29.696722269058228
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.3057911
	speed: 0.2489s/iter; left time: 9898.0556s
	iters: 200, epoch: 16 | loss: 2.2889380
	speed: 0.0640s/iter; left time: 2537.4787s
	iters: 300, epoch: 16 | loss: 2.2761047
	speed: 0.0578s/iter; left time: 2288.1719s
	iters: 400, epoch: 16 | loss: 2.2995102
	speed: 0.0590s/iter; left time: 2328.3521s
Epoch: 16 cost time: 28.963265419006348
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.2988129
	speed: 0.2441s/iter; left time: 9592.5564s
	iters: 200, epoch: 17 | loss: 2.2982607
	speed: 0.0571s/iter; left time: 2239.9586s
	iters: 300, epoch: 17 | loss: 2.3028264
	speed: 0.0615s/iter; left time: 2405.5009s
	iters: 400, epoch: 17 | loss: 2.3108368
	speed: 0.0643s/iter; left time: 2506.6972s
Epoch: 17 cost time: 28.759594678878784
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.3162286
	speed: 0.2353s/iter; left time: 9135.6954s
	iters: 200, epoch: 18 | loss: 2.3028698
	speed: 0.0678s/iter; left time: 2627.6885s
	iters: 300, epoch: 18 | loss: 2.2859592
	speed: 0.0638s/iter; left time: 2464.0900s
	iters: 400, epoch: 18 | loss: 2.2873588
	speed: 0.0641s/iter; left time: 2469.4833s
Epoch: 18 cost time: 30.350588083267212
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.3043890
	speed: 0.2366s/iter; left time: 9074.2913s
	iters: 200, epoch: 19 | loss: 2.3142715
	speed: 0.0610s/iter; left time: 2334.2234s
	iters: 300, epoch: 19 | loss: 2.3073297
	speed: 0.0601s/iter; left time: 2295.2003s
	iters: 400, epoch: 19 | loss: 2.3135595
	speed: 0.0563s/iter; left time: 2142.0411s
Epoch: 19 cost time: 27.872603178024292
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.2892635
	speed: 0.2480s/iter; left time: 9397.0726s
	iters: 200, epoch: 20 | loss: 2.3010979
	speed: 0.0580s/iter; left time: 2190.4084s
	iters: 300, epoch: 20 | loss: 2.3071768
	speed: 0.0519s/iter; left time: 1956.2904s
	iters: 400, epoch: 20 | loss: 2.3188071
	speed: 0.0581s/iter; left time: 2183.6129s
Epoch: 20 cost time: 27.745488166809082
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.2867994
	speed: 0.2682s/iter; left time: 10036.6003s
	iters: 200, epoch: 21 | loss: 2.2925496
	speed: 0.0524s/iter; left time: 1954.0889s
	iters: 300, epoch: 21 | loss: 2.3022094
	speed: 0.0523s/iter; left time: 1946.2536s
	iters: 400, epoch: 21 | loss: 2.3043089
	speed: 0.0493s/iter; left time: 1829.9976s
Epoch: 21 cost time: 24.81121039390564
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.2880635
	speed: 0.1547s/iter; left time: 5716.8636s
	iters: 200, epoch: 22 | loss: 2.2904191
	speed: 0.0495s/iter; left time: 1825.3233s
	iters: 300, epoch: 22 | loss: 2.2979155
	speed: 0.0474s/iter; left time: 1741.6114s
	iters: 400, epoch: 22 | loss: 2.3031600
	speed: 0.0475s/iter; left time: 1741.8166s
Epoch: 22 cost time: 22.431217670440674
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 2.2971797
	speed: 0.1602s/iter; left time: 5843.4326s
	iters: 200, epoch: 23 | loss: 2.2911112
	speed: 0.0594s/iter; left time: 2162.9338s
	iters: 300, epoch: 23 | loss: 2.2980468
	speed: 0.0594s/iter; left time: 2153.6483s
	iters: 400, epoch: 23 | loss: 2.3179846
	speed: 0.0607s/iter; left time: 2196.9480s
Epoch: 23 cost time: 27.10623812675476
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 2.3178513
	speed: 0.2258s/iter; left time: 8133.2030s
	iters: 200, epoch: 24 | loss: 2.2835040
	speed: 0.0629s/iter; left time: 2258.3489s
	iters: 300, epoch: 24 | loss: 2.3017926
	speed: 0.0586s/iter; left time: 2098.8153s
	iters: 400, epoch: 24 | loss: 2.2971535
	speed: 0.0602s/iter; left time: 2150.8656s
Epoch: 24 cost time: 29.02634358406067
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 2.2939863
	speed: 0.2361s/iter; left time: 8392.4231s
	iters: 200, epoch: 25 | loss: 2.3073828
	speed: 0.0682s/iter; left time: 2417.8891s
	iters: 300, epoch: 25 | loss: 2.2940392
	speed: 0.0651s/iter; left time: 2300.5130s
	iters: 400, epoch: 25 | loss: 2.2918863
	speed: 0.0653s/iter; left time: 2302.6378s
Epoch: 25 cost time: 29.9390766620636
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.3259795
	speed: 0.2399s/iter; left time: 8416.1329s
	iters: 200, epoch: 26 | loss: 2.3049867
	speed: 0.0628s/iter; left time: 2195.5061s
	iters: 300, epoch: 26 | loss: 2.2826614
	speed: 0.0560s/iter; left time: 1954.4139s
	iters: 400, epoch: 26 | loss: 2.3028224
	speed: 0.0537s/iter; left time: 1866.0722s
Epoch: 26 cost time: 28.15441656112671
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 2.2832816
	speed: 0.2365s/iter; left time: 8184.0023s
	iters: 200, epoch: 27 | loss: 2.3097222
	speed: 0.0673s/iter; left time: 2322.4508s
	iters: 300, epoch: 27 | loss: 2.2815166
	speed: 0.0666s/iter; left time: 2289.8874s
	iters: 400, epoch: 27 | loss: 2.2931609
	speed: 0.0658s/iter; left time: 2257.4755s
Epoch: 27 cost time: 30.266284942626953
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.2949610
	speed: 0.2402s/iter; left time: 8199.7551s
	iters: 200, epoch: 28 | loss: 2.2924645
	speed: 0.0660s/iter; left time: 2247.7394s
	iters: 300, epoch: 28 | loss: 2.2981455
	speed: 0.0641s/iter; left time: 2174.0447s
	iters: 400, epoch: 28 | loss: 2.3111675
	speed: 0.0611s/iter; left time: 2067.9304s
Epoch: 28 cost time: 30.484153032302856
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.3144290
	speed: 0.2546s/iter; left time: 8573.3684s
	iters: 200, epoch: 29 | loss: 2.3070133
	speed: 0.0603s/iter; left time: 2025.2222s
	iters: 300, epoch: 29 | loss: 2.2991152
	speed: 0.0632s/iter; left time: 2113.6300s
	iters: 400, epoch: 29 | loss: 2.3078084
	speed: 0.0655s/iter; left time: 2184.4999s
Epoch: 29 cost time: 29.441844701766968
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.3032272
	speed: 0.2287s/iter; left time: 7591.4092s
	iters: 200, epoch: 30 | loss: 2.3043778
	speed: 0.0667s/iter; left time: 2209.1757s
	iters: 300, epoch: 30 | loss: 2.2961657
	speed: 0.0628s/iter; left time: 2072.3897s
	iters: 400, epoch: 30 | loss: 2.2993376
	speed: 0.0628s/iter; left time: 2065.2995s
Epoch: 30 cost time: 30.272445678710938
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 2.3278735
	speed: 0.2571s/iter; left time: 8416.4374s
	iters: 200, epoch: 31 | loss: 2.3112049
	speed: 0.0626s/iter; left time: 2043.7383s
	iters: 300, epoch: 31 | loss: 2.3042641
	speed: 0.0642s/iter; left time: 2090.0391s
	iters: 400, epoch: 31 | loss: 2.2988362
	speed: 0.0640s/iter; left time: 2075.2949s
Epoch: 31 cost time: 30.075103521347046
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 2.2898974
	speed: 0.2274s/iter; left time: 7337.7750s
	iters: 200, epoch: 32 | loss: 2.3168142
	speed: 0.0508s/iter; left time: 1632.2643s
	iters: 300, epoch: 32 | loss: 2.3009458
	speed: 0.0535s/iter; left time: 1713.9201s
	iters: 400, epoch: 32 | loss: 2.3053927
	speed: 0.0534s/iter; left time: 1705.8597s
Epoch: 32 cost time: 25.023737907409668
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 2.2983389
	speed: 0.2294s/iter; left time: 7292.2204s
	iters: 200, epoch: 33 | loss: 2.2970901
	speed: 0.0607s/iter; left time: 1922.5463s
	iters: 300, epoch: 33 | loss: 2.3094337
	speed: 0.0593s/iter; left time: 1872.6108s
	iters: 400, epoch: 33 | loss: 2.3055472
	speed: 0.0633s/iter; left time: 1993.8945s
Epoch: 33 cost time: 29.531254291534424
Epoch: 33, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 2.2985494
	speed: 0.2500s/iter; left time: 7831.1745s
	iters: 200, epoch: 34 | loss: 2.3019898
	speed: 0.0657s/iter; left time: 2051.4033s
	iters: 300, epoch: 34 | loss: 2.3185899
	speed: 0.0626s/iter; left time: 1948.0308s
	iters: 400, epoch: 34 | loss: 2.3098350
	speed: 0.0603s/iter; left time: 1871.6875s
Epoch: 34 cost time: 29.542539834976196
Epoch: 34, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 2.2937181
	speed: 0.2681s/iter; left time: 8273.1926s
	iters: 200, epoch: 35 | loss: 2.3006046
	speed: 0.0545s/iter; left time: 1675.2559s
	iters: 300, epoch: 35 | loss: 2.3024111
	speed: 0.0567s/iter; left time: 1738.0475s
	iters: 400, epoch: 35 | loss: 2.2894921
	speed: 0.0581s/iter; left time: 1774.9271s
Epoch: 35 cost time: 27.612196683883667
Epoch: 35, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 2.3208144
	speed: 0.2199s/iter; left time: 6681.3789s
	iters: 200, epoch: 36 | loss: 2.2939677
	speed: 0.0626s/iter; left time: 1897.1417s
	iters: 300, epoch: 36 | loss: 2.3028221
	speed: 0.0579s/iter; left time: 1748.7219s
	iters: 400, epoch: 36 | loss: 2.2991881
	speed: 0.0543s/iter; left time: 1633.6196s
Epoch: 36 cost time: 28.262213230133057
Epoch: 36, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 2.3043222
	speed: 0.2264s/iter; left time: 6773.9613s
	iters: 200, epoch: 37 | loss: 2.2974370
	speed: 0.0603s/iter; left time: 1796.9355s
	iters: 300, epoch: 37 | loss: 2.2970092
	speed: 0.0566s/iter; left time: 1681.5357s
	iters: 400, epoch: 37 | loss: 2.2935264
	speed: 0.0573s/iter; left time: 1695.6994s
Epoch: 37 cost time: 26.77067518234253
Epoch: 37, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 705418
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9135010
	speed: 0.0806s/iter; left time: 3770.0305s
	iters: 200, epoch: 1 | loss: 0.2129832
	speed: 0.0616s/iter; left time: 2875.5873s
	iters: 300, epoch: 1 | loss: 0.0978228
	speed: 0.0612s/iter; left time: 2852.7204s
	iters: 400, epoch: 1 | loss: 0.1019389
	speed: 0.0575s/iter; left time: 2671.9162s
Epoch: 1 cost time: 30.623136281967163
Epoch: 1, Steps: 469 | Train Loss: 0.586 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (inf --> -0.952828).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0403589
	speed: 0.2675s/iter; left time: 12392.6708s
	iters: 200, epoch: 2 | loss: 0.0157783
	speed: 0.0536s/iter; left time: 2479.1268s
	iters: 300, epoch: 2 | loss: 0.0594312
	speed: 0.0617s/iter; left time: 2845.7859s
	iters: 400, epoch: 2 | loss: 0.0216974
	speed: 0.0649s/iter; left time: 2986.4286s
Epoch: 2 cost time: 28.904850482940674
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.952828 --> -0.955402).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0116709
	speed: 0.2398s/iter; left time: 10998.5407s
	iters: 200, epoch: 3 | loss: 0.0325115
	speed: 0.0645s/iter; left time: 2950.8086s
	iters: 300, epoch: 3 | loss: 0.0082129
	speed: 0.0581s/iter; left time: 2651.6198s
	iters: 400, epoch: 3 | loss: 0.0452530
	speed: 0.0653s/iter; left time: 2973.5515s
Epoch: 3 cost time: 30.08627676963806
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.955402 --> -0.975128).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0470895
	speed: 0.2566s/iter; left time: 11648.1522s
	iters: 200, epoch: 4 | loss: 0.0144706
	speed: 0.0580s/iter; left time: 2629.0978s
	iters: 300, epoch: 4 | loss: 0.0345310
	speed: 0.0580s/iter; left time: 2622.0071s
	iters: 400, epoch: 4 | loss: 0.0432642
	speed: 0.0618s/iter; left time: 2787.2494s
Epoch: 4 cost time: 28.03252148628235
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0046774
	speed: 0.2585s/iter; left time: 11611.0094s
	iters: 200, epoch: 5 | loss: 0.0009199
	speed: 0.0589s/iter; left time: 2638.9284s
	iters: 300, epoch: 5 | loss: 0.0133037
	speed: 0.0525s/iter; left time: 2346.6814s
	iters: 400, epoch: 5 | loss: 0.0111976
	speed: 0.0503s/iter; left time: 2245.6208s
Epoch: 5 cost time: 26.316270351409912
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1112504
	speed: 0.1678s/iter; left time: 7458.7726s
	iters: 200, epoch: 6 | loss: 0.0665067
	speed: 0.0583s/iter; left time: 2584.9180s
	iters: 300, epoch: 6 | loss: 0.0111554
	speed: 0.0590s/iter; left time: 2610.7241s
	iters: 400, epoch: 6 | loss: 0.0066340
	speed: 0.0577s/iter; left time: 2549.7456s
Epoch: 6 cost time: 27.074178457260132
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0436879
	speed: 0.2561s/iter; left time: 11263.7289s
	iters: 200, epoch: 7 | loss: 0.0140815
	speed: 0.0544s/iter; left time: 2388.8516s
	iters: 300, epoch: 7 | loss: 0.0070098
	speed: 0.0576s/iter; left time: 2521.2485s
	iters: 400, epoch: 7 | loss: 0.0020775
	speed: 0.0601s/iter; left time: 2627.3032s
Epoch: 7 cost time: 27.942981004714966
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0040944
	speed: 0.2457s/iter; left time: 10693.3753s
	iters: 200, epoch: 8 | loss: 0.0019823
	speed: 0.0636s/iter; left time: 2762.8353s
	iters: 300, epoch: 8 | loss: 0.5235841
	speed: 0.0590s/iter; left time: 2556.4818s
	iters: 400, epoch: 8 | loss: 0.1094972
	speed: 0.0577s/iter; left time: 2493.7064s
Epoch: 8 cost time: 28.534002780914307
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.975128 --> -0.979702).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0006906
	speed: 0.2393s/iter; left time: 10300.5749s
	iters: 200, epoch: 9 | loss: 0.0223076
	speed: 0.0628s/iter; left time: 2695.2733s
	iters: 300, epoch: 9 | loss: 0.0093651
	speed: 0.0574s/iter; left time: 2457.4123s
	iters: 400, epoch: 9 | loss: 0.0146553
	speed: 0.0523s/iter; left time: 2233.9506s
Epoch: 9 cost time: 27.979339361190796
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0051519
	speed: 0.2523s/iter; left time: 10743.9802s
	iters: 200, epoch: 10 | loss: 0.0172831
	speed: 0.0598s/iter; left time: 2541.4002s
	iters: 300, epoch: 10 | loss: 0.0108734
	speed: 0.0627s/iter; left time: 2658.0058s
	iters: 400, epoch: 10 | loss: 0.0018959
	speed: 0.0599s/iter; left time: 2533.8754s
Epoch: 10 cost time: 28.114574193954468
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0372514
	speed: 0.2559s/iter; left time: 10775.5671s
	iters: 200, epoch: 11 | loss: 0.0015407
	speed: 0.0587s/iter; left time: 2465.7757s
	iters: 300, epoch: 11 | loss: 0.0002873
	speed: 0.0616s/iter; left time: 2579.9366s
	iters: 400, epoch: 11 | loss: 0.0084135
	speed: 0.0588s/iter; left time: 2459.9884s
Epoch: 11 cost time: 28.922565937042236
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0075356
	speed: 0.2309s/iter; left time: 9613.2061s
	iters: 200, epoch: 12 | loss: 0.0031780
	speed: 0.0593s/iter; left time: 2463.3195s
	iters: 300, epoch: 12 | loss: 0.0020209
	speed: 0.0549s/iter; left time: 2276.3304s
	iters: 400, epoch: 12 | loss: 0.0102085
	speed: 0.0566s/iter; left time: 2340.8709s
Epoch: 12 cost time: 27.550092697143555
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0112607
	speed: 0.2336s/iter; left time: 9618.7970s
	iters: 200, epoch: 13 | loss: 0.0687306
	speed: 0.0621s/iter; left time: 2551.3396s
	iters: 300, epoch: 13 | loss: 0.0104499
	speed: 0.0588s/iter; left time: 2407.7413s
	iters: 400, epoch: 13 | loss: 0.0027341
	speed: 0.0610s/iter; left time: 2491.2628s
Epoch: 13 cost time: 28.32309579849243
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0005404
	speed: 0.2456s/iter; left time: 9998.2532s
	iters: 200, epoch: 14 | loss: 0.0071331
	speed: 0.0588s/iter; left time: 2385.5214s
	iters: 300, epoch: 14 | loss: 0.0006788
	speed: 0.0621s/iter; left time: 2514.5331s
	iters: 400, epoch: 14 | loss: 0.1373826
	speed: 0.0634s/iter; left time: 2563.6317s
Epoch: 14 cost time: 28.936143159866333
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0115582
	speed: 0.2320s/iter; left time: 9335.2573s
	iters: 200, epoch: 15 | loss: 0.0688388
	speed: 0.0608s/iter; left time: 2439.6667s
	iters: 300, epoch: 15 | loss: 0.6779763
	speed: 0.0530s/iter; left time: 2122.5964s
	iters: 400, epoch: 15 | loss: 0.2700463
	speed: 0.0602s/iter; left time: 2403.6829s
Epoch: 15 cost time: 27.64334726333618
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0025515
	speed: 0.2238s/iter; left time: 8898.1646s
	iters: 200, epoch: 16 | loss: 0.0525278
	speed: 0.0624s/iter; left time: 2476.2836s
	iters: 300, epoch: 16 | loss: 0.0067338
	speed: 0.0611s/iter; left time: 2418.8211s
	iters: 400, epoch: 16 | loss: 0.0054820
	speed: 0.0612s/iter; left time: 2413.7112s
Epoch: 16 cost time: 28.778695106506348
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979988).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0019169
	speed: 0.2447s/iter; left time: 9617.7557s
	iters: 200, epoch: 17 | loss: 0.0073297
	speed: 0.0616s/iter; left time: 2414.1467s
	iters: 300, epoch: 17 | loss: 0.0191009
	speed: 0.0628s/iter; left time: 2456.4814s
	iters: 400, epoch: 17 | loss: 0.0004426
	speed: 0.0627s/iter; left time: 2445.3634s
Epoch: 17 cost time: 28.65348243713379
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001275
	speed: 0.2379s/iter; left time: 9235.3234s
	iters: 200, epoch: 18 | loss: 0.5404138
	speed: 0.0684s/iter; left time: 2648.2279s
	iters: 300, epoch: 18 | loss: 0.0013655
	speed: 0.0567s/iter; left time: 2189.8128s
	iters: 400, epoch: 18 | loss: 0.0054914
	speed: 0.0650s/iter; left time: 2503.0343s
Epoch: 18 cost time: 29.899160623550415
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3100926
	speed: 0.2315s/iter; left time: 8879.2948s
	iters: 200, epoch: 19 | loss: 0.0063860
	speed: 0.0645s/iter; left time: 2466.7831s
	iters: 300, epoch: 19 | loss: 0.0446637
	speed: 0.0633s/iter; left time: 2417.2364s
	iters: 400, epoch: 19 | loss: 0.0173893
	speed: 0.0592s/iter; left time: 2252.8955s
Epoch: 19 cost time: 28.676908016204834
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0012185
	speed: 0.1711s/iter; left time: 6481.1730s
	iters: 200, epoch: 20 | loss: 0.0048826
	speed: 0.0493s/iter; left time: 1861.9470s
	iters: 300, epoch: 20 | loss: 0.1522244
	speed: 0.0477s/iter; left time: 1799.0779s
	iters: 400, epoch: 20 | loss: 0.3024561
	speed: 0.0622s/iter; left time: 2338.0958s
Epoch: 20 cost time: 25.52117609977722
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0409486
	speed: 0.2472s/iter; left time: 9249.0113s
	iters: 200, epoch: 21 | loss: 0.0002773
	speed: 0.0592s/iter; left time: 2210.4772s
	iters: 300, epoch: 21 | loss: 0.0805298
	speed: 0.0584s/iter; left time: 2173.9431s
	iters: 400, epoch: 21 | loss: 0.0056449
	speed: 0.0588s/iter; left time: 2183.2499s
Epoch: 21 cost time: 27.559322834014893
Epoch: 21, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0003260
	speed: 0.2421s/iter; left time: 8947.6090s
	iters: 200, epoch: 22 | loss: 0.0143246
	speed: 0.0586s/iter; left time: 2159.5702s
	iters: 300, epoch: 22 | loss: 0.3997000
	speed: 0.0578s/iter; left time: 2124.9233s
	iters: 400, epoch: 22 | loss: 0.0003469
	speed: 0.0568s/iter; left time: 2082.0723s
Epoch: 22 cost time: 27.344964265823364
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0005979
	speed: 0.2597s/iter; left time: 9475.0157s
	iters: 200, epoch: 23 | loss: 0.0000685
	speed: 0.0590s/iter; left time: 2145.7997s
	iters: 300, epoch: 23 | loss: 0.0090564
	speed: 0.0607s/iter; left time: 2203.9944s
	iters: 400, epoch: 23 | loss: 0.0633668
	speed: 0.0621s/iter; left time: 2248.3915s
Epoch: 23 cost time: 27.98038935661316
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0006835
	speed: 0.2453s/iter; left time: 8833.8333s
	iters: 200, epoch: 24 | loss: 0.0005983
	speed: 0.0594s/iter; left time: 2133.4734s
	iters: 300, epoch: 24 | loss: 0.0123297
	speed: 0.0570s/iter; left time: 2042.1627s
	iters: 400, epoch: 24 | loss: 0.0290370
	speed: 0.0637s/iter; left time: 2276.6348s
Epoch: 24 cost time: 28.734178066253662
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0007485
	speed: 0.2313s/iter; left time: 8221.8723s
	iters: 200, epoch: 25 | loss: 0.0019026
	speed: 0.0561s/iter; left time: 1987.4653s
	iters: 300, epoch: 25 | loss: 0.0002723
	speed: 0.0531s/iter; left time: 1876.1800s
	iters: 400, epoch: 25 | loss: 0.0015114
	speed: 0.0558s/iter; left time: 1967.4187s
Epoch: 25 cost time: 26.899372577667236
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0004486
	speed: 0.2489s/iter; left time: 8729.5087s
	iters: 200, epoch: 26 | loss: 0.0019941
	speed: 0.0588s/iter; left time: 2058.1638s
	iters: 300, epoch: 26 | loss: 0.0054847
	speed: 0.0596s/iter; left time: 2077.1181s
	iters: 400, epoch: 26 | loss: 0.0007820
	speed: 0.0536s/iter; left time: 1863.6347s
Epoch: 26 cost time: 27.3245906829834
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 508810
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0611583
	speed: 0.0774s/iter; left time: 3620.3356s
	iters: 200, epoch: 1 | loss: 0.3070367
	speed: 0.0613s/iter; left time: 2865.0734s
	iters: 300, epoch: 1 | loss: 0.1636209
	speed: 0.0589s/iter; left time: 2746.8302s
	iters: 400, epoch: 1 | loss: 0.1074550
	speed: 0.0595s/iter; left time: 2764.7209s
Epoch: 1 cost time: 29.913238286972046
Epoch: 1, Steps: 469 | Train Loss: 0.653 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
Validation loss decreased (inf --> -0.931673).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0308404
	speed: 0.2272s/iter; left time: 10528.3482s
	iters: 200, epoch: 2 | loss: 0.0127973
	speed: 0.0644s/iter; left time: 2976.7328s
	iters: 300, epoch: 2 | loss: 0.0371998
	speed: 0.0600s/iter; left time: 2765.6206s
	iters: 400, epoch: 2 | loss: 0.0548609
	speed: 0.0626s/iter; left time: 2883.3835s
Epoch: 2 cost time: 29.27635908126831
Epoch: 2, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.931673 --> -0.941679).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0273524
	speed: 0.2436s/iter; left time: 11173.0030s
	iters: 200, epoch: 3 | loss: 0.0857710
	speed: 0.0627s/iter; left time: 2870.5092s
	iters: 300, epoch: 3 | loss: 0.0231858
	speed: 0.0639s/iter; left time: 2916.4224s
	iters: 400, epoch: 3 | loss: 0.0153170
	speed: 0.0590s/iter; left time: 2686.7805s
Epoch: 3 cost time: 29.106863975524902
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.941679 --> -0.961977).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0174880
	speed: 0.2410s/iter; left time: 10941.6612s
	iters: 200, epoch: 4 | loss: 0.0089606
	speed: 0.0587s/iter; left time: 2659.4435s
	iters: 300, epoch: 4 | loss: 0.1360471
	speed: 0.0626s/iter; left time: 2827.3840s
	iters: 400, epoch: 4 | loss: 0.0063495
	speed: 0.0594s/iter; left time: 2677.6720s
Epoch: 4 cost time: 27.631129026412964
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0184314
	speed: 0.2322s/iter; left time: 10432.9000s
	iters: 200, epoch: 5 | loss: 0.0067385
	speed: 0.0531s/iter; left time: 2382.3544s
	iters: 300, epoch: 5 | loss: 0.0418704
	speed: 0.0594s/iter; left time: 2654.6386s
	iters: 400, epoch: 5 | loss: 0.0928337
	speed: 0.0599s/iter; left time: 2674.1575s
Epoch: 5 cost time: 27.559617519378662
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0276719
	speed: 0.2340s/iter; left time: 10401.7762s
	iters: 200, epoch: 6 | loss: 0.0261141
	speed: 0.0602s/iter; left time: 2668.9588s
	iters: 300, epoch: 6 | loss: 0.0031111
	speed: 0.0548s/iter; left time: 2424.6217s
	iters: 400, epoch: 6 | loss: 0.0155333
	speed: 0.0524s/iter; left time: 2313.0354s
Epoch: 6 cost time: 25.85219717025757
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0102551
	speed: 0.1591s/iter; left time: 6998.8834s
	iters: 200, epoch: 7 | loss: 0.0141241
	speed: 0.0495s/iter; left time: 2172.3698s
	iters: 300, epoch: 7 | loss: 0.2663704
	speed: 0.0518s/iter; left time: 2269.3614s
	iters: 400, epoch: 7 | loss: 0.0032412
	speed: 0.0594s/iter; left time: 2595.5610s
Epoch: 7 cost time: 25.247491121292114
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
Validation loss decreased (-0.961977 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0198586
	speed: 0.2597s/iter; left time: 11302.0812s
	iters: 200, epoch: 8 | loss: 0.0019265
	speed: 0.0591s/iter; left time: 2566.5057s
	iters: 300, epoch: 8 | loss: 0.1189943
	speed: 0.0569s/iter; left time: 2464.8669s
	iters: 400, epoch: 8 | loss: 0.0860853
	speed: 0.0578s/iter; left time: 2496.3506s
Epoch: 8 cost time: 27.41495370864868
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0004221
	speed: 0.2532s/iter; left time: 10902.0144s
	iters: 200, epoch: 9 | loss: 0.0136573
	speed: 0.0631s/iter; left time: 2708.3728s
	iters: 300, epoch: 9 | loss: 0.0049003
	speed: 0.0604s/iter; left time: 2585.9656s
	iters: 400, epoch: 9 | loss: 0.0003799
	speed: 0.0609s/iter; left time: 2604.7432s
Epoch: 9 cost time: 29.627355575561523
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.966265 --> -0.967695).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0204295
	speed: 0.2547s/iter; left time: 10845.7330s
	iters: 200, epoch: 10 | loss: 0.0453896
	speed: 0.0640s/iter; left time: 2717.7768s
	iters: 300, epoch: 10 | loss: 0.0267676
	speed: 0.0603s/iter; left time: 2553.6784s
	iters: 400, epoch: 10 | loss: 0.0343667
	speed: 0.0617s/iter; left time: 2610.6266s
Epoch: 10 cost time: 29.46447992324829
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.967695 --> -0.981131).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1563824
	speed: 0.2671s/iter; left time: 11246.1551s
	iters: 200, epoch: 11 | loss: 0.0163774
	speed: 0.0567s/iter; left time: 2382.8824s
	iters: 300, epoch: 11 | loss: 0.0008393
	speed: 0.0580s/iter; left time: 2432.1227s
	iters: 400, epoch: 11 | loss: 0.0201881
	speed: 0.0553s/iter; left time: 2314.1971s
Epoch: 11 cost time: 27.783982515335083
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.262 Vali Acc: 0.936 Test Loss: 0.262 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0222581
	speed: 0.2612s/iter; left time: 10878.6611s
	iters: 200, epoch: 12 | loss: 0.1166778
	speed: 0.0628s/iter; left time: 2610.1673s
	iters: 300, epoch: 12 | loss: 0.0032292
	speed: 0.0609s/iter; left time: 2522.0733s
	iters: 400, epoch: 12 | loss: 0.4465499
	speed: 0.0600s/iter; left time: 2480.2913s
Epoch: 12 cost time: 29.001079559326172
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0004546
	speed: 0.2515s/iter; left time: 10352.9926s
	iters: 200, epoch: 13 | loss: 0.0926156
	speed: 0.0625s/iter; left time: 2566.1052s
	iters: 300, epoch: 13 | loss: 0.0657596
	speed: 0.0613s/iter; left time: 2511.2099s
	iters: 400, epoch: 13 | loss: 0.0032510
	speed: 0.0611s/iter; left time: 2495.8681s
Epoch: 13 cost time: 29.547902822494507
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0071031
	speed: 0.2644s/iter; left time: 10763.3317s
	iters: 200, epoch: 14 | loss: 0.0798764
	speed: 0.0574s/iter; left time: 2328.7941s
	iters: 300, epoch: 14 | loss: 0.0027262
	speed: 0.0557s/iter; left time: 2255.7427s
	iters: 400, epoch: 14 | loss: 0.0028096
	speed: 0.0578s/iter; left time: 2335.8641s
Epoch: 14 cost time: 27.49627423286438
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0414670
	speed: 0.2586s/iter; left time: 10405.5881s
	iters: 200, epoch: 15 | loss: 0.0177921
	speed: 0.0595s/iter; left time: 2386.8023s
	iters: 300, epoch: 15 | loss: 0.4595814
	speed: 0.0556s/iter; left time: 2225.7155s
	iters: 400, epoch: 15 | loss: 0.0011839
	speed: 0.0609s/iter; left time: 2432.7900s
Epoch: 15 cost time: 28.844367027282715
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0006254
	speed: 0.2655s/iter; left time: 10557.2733s
	iters: 200, epoch: 16 | loss: 0.0081407
	speed: 0.0595s/iter; left time: 2360.9301s
	iters: 300, epoch: 16 | loss: 0.0172215
	speed: 0.0627s/iter; left time: 2482.0057s
	iters: 400, epoch: 16 | loss: 0.0021495
	speed: 0.0646s/iter; left time: 2547.9860s
Epoch: 16 cost time: 29.237770557403564
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0789436
	speed: 0.2556s/iter; left time: 10046.0921s
	iters: 200, epoch: 17 | loss: 0.0538005
	speed: 0.0606s/iter; left time: 2375.9876s
	iters: 300, epoch: 17 | loss: 0.0421402
	speed: 0.0598s/iter; left time: 2336.0507s
	iters: 400, epoch: 17 | loss: 0.0437442
	speed: 0.0599s/iter; left time: 2334.3569s
Epoch: 17 cost time: 28.359598636627197
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0009984
	speed: 0.2365s/iter; left time: 9184.3352s
	iters: 200, epoch: 18 | loss: 0.7028252
	speed: 0.0619s/iter; left time: 2395.9089s
	iters: 300, epoch: 18 | loss: 0.0030568
	speed: 0.0608s/iter; left time: 2347.2065s
	iters: 400, epoch: 18 | loss: 0.0002571
	speed: 0.0642s/iter; left time: 2474.2053s
Epoch: 18 cost time: 29.319157600402832
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8359587
	speed: 0.2539s/iter; left time: 9741.1087s
	iters: 200, epoch: 19 | loss: 0.0000446
	speed: 0.0635s/iter; left time: 2427.9169s
	iters: 300, epoch: 19 | loss: 0.0084039
	speed: 0.0647s/iter; left time: 2467.9011s
	iters: 400, epoch: 19 | loss: 0.0628363
	speed: 0.0657s/iter; left time: 2499.3780s
Epoch: 19 cost time: 30.099441528320312
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0608822
	speed: 0.2331s/iter; left time: 8831.9844s
	iters: 200, epoch: 20 | loss: 0.3450266
	speed: 0.0620s/iter; left time: 2343.1883s
	iters: 300, epoch: 20 | loss: 0.1375768
	speed: 0.0624s/iter; left time: 2352.7066s
	iters: 400, epoch: 20 | loss: 0.2585845
	speed: 0.0613s/iter; left time: 2305.5449s
Epoch: 20 cost time: 28.955761909484863
Epoch: 20, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 508810
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9459820
	speed: 0.0860s/iter; left time: 4025.2492s
	iters: 200, epoch: 1 | loss: 0.2538767
	speed: 0.0679s/iter; left time: 3173.0250s
	iters: 300, epoch: 1 | loss: 0.1311034
	speed: 0.0653s/iter; left time: 3043.8834s
	iters: 400, epoch: 1 | loss: 0.0951307
	speed: 0.0631s/iter; left time: 2935.0454s
Epoch: 1 cost time: 32.76895880699158
Epoch: 1, Steps: 469 | Train Loss: 0.635 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (inf --> -0.946253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0299192
	speed: 0.2718s/iter; left time: 12591.6286s
	iters: 200, epoch: 2 | loss: 0.0140397
	speed: 0.0648s/iter; left time: 2997.0534s
	iters: 300, epoch: 2 | loss: 0.0354666
	speed: 0.0613s/iter; left time: 2827.0460s
	iters: 400, epoch: 2 | loss: 0.0895434
	speed: 0.0593s/iter; left time: 2731.1333s
Epoch: 2 cost time: 29.444895267486572
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.946253 --> -0.954544).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0205281
	speed: 0.2648s/iter; left time: 12143.3293s
	iters: 200, epoch: 3 | loss: 0.0663390
	speed: 0.0624s/iter; left time: 2855.9459s
	iters: 300, epoch: 3 | loss: 0.0113600
	speed: 0.0599s/iter; left time: 2736.6742s
	iters: 400, epoch: 3 | loss: 0.0144197
	speed: 0.0596s/iter; left time: 2716.6255s
Epoch: 3 cost time: 28.941943883895874
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.954544 --> -0.971697).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0465023
	speed: 0.2433s/iter; left time: 11045.4955s
	iters: 200, epoch: 4 | loss: 0.0053142
	speed: 0.0688s/iter; left time: 3117.0654s
	iters: 300, epoch: 4 | loss: 0.0250747
	speed: 0.0633s/iter; left time: 2861.7065s
	iters: 400, epoch: 4 | loss: 0.0059784
	speed: 0.0622s/iter; left time: 2803.1595s
Epoch: 4 cost time: 30.750889539718628
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0036490
	speed: 0.2710s/iter; left time: 12175.5936s
	iters: 200, epoch: 5 | loss: 0.0019709
	speed: 0.0653s/iter; left time: 2929.1064s
	iters: 300, epoch: 5 | loss: 0.0572840
	speed: 0.0626s/iter; left time: 2800.6271s
	iters: 400, epoch: 5 | loss: 0.0153520
	speed: 0.0581s/iter; left time: 2592.1524s
Epoch: 5 cost time: 29.58938455581665
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0496792
	speed: 0.2551s/iter; left time: 11338.8130s
	iters: 200, epoch: 6 | loss: 0.1180049
	speed: 0.0643s/iter; left time: 2852.6083s
	iters: 300, epoch: 6 | loss: 0.0061970
	speed: 0.0622s/iter; left time: 2750.8608s
	iters: 400, epoch: 6 | loss: 0.0123814
	speed: 0.0640s/iter; left time: 2824.7787s
Epoch: 6 cost time: 29.749573945999146
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0280253
	speed: 0.2598s/iter; left time: 11427.7277s
	iters: 200, epoch: 7 | loss: 0.0020204
	speed: 0.0634s/iter; left time: 2783.5549s
	iters: 300, epoch: 7 | loss: 0.0023415
	speed: 0.0613s/iter; left time: 2682.3427s
	iters: 400, epoch: 7 | loss: 0.0045499
	speed: 0.0620s/iter; left time: 2707.1542s
Epoch: 7 cost time: 29.70714497566223
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.973412).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0336884
	speed: 0.2689s/iter; left time: 11700.3553s
	iters: 200, epoch: 8 | loss: 0.0009578
	speed: 0.0675s/iter; left time: 2929.0047s
	iters: 300, epoch: 8 | loss: 0.5477475
	speed: 0.0638s/iter; left time: 2761.5242s
	iters: 400, epoch: 8 | loss: 0.2128647
	speed: 0.0608s/iter; left time: 2629.4224s
Epoch: 8 cost time: 30.823145389556885
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0026757
	speed: 0.2515s/iter; left time: 10828.2999s
	iters: 200, epoch: 9 | loss: 0.0642812
	speed: 0.0644s/iter; left time: 2766.3310s
	iters: 300, epoch: 9 | loss: 0.0021350
	speed: 0.0620s/iter; left time: 2657.2634s
	iters: 400, epoch: 9 | loss: 0.0036543
	speed: 0.0597s/iter; left time: 2550.9528s
Epoch: 9 cost time: 29.019984006881714
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0194209
	speed: 0.2662s/iter; left time: 11333.8985s
	iters: 200, epoch: 10 | loss: 0.1376682
	speed: 0.0635s/iter; left time: 2695.7739s
	iters: 300, epoch: 10 | loss: 0.0073841
	speed: 0.0650s/iter; left time: 2752.9211s
	iters: 400, epoch: 10 | loss: 0.0720460
	speed: 0.0610s/iter; left time: 2578.1960s
Epoch: 10 cost time: 30.325924396514893
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0117840
	speed: 0.2668s/iter; left time: 11233.9425s
	iters: 200, epoch: 11 | loss: 0.0075615
	speed: 0.0645s/iter; left time: 2709.8429s
	iters: 300, epoch: 11 | loss: 0.0006739
	speed: 0.0594s/iter; left time: 2489.3155s
	iters: 400, epoch: 11 | loss: 0.0079457
	speed: 0.0618s/iter; left time: 2582.7834s
Epoch: 11 cost time: 29.80762267112732
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0037972
	speed: 0.2742s/iter; left time: 11418.6752s
	iters: 200, epoch: 12 | loss: 0.1340078
	speed: 0.0576s/iter; left time: 2392.2305s
	iters: 300, epoch: 12 | loss: 0.0012909
	speed: 0.0577s/iter; left time: 2391.6046s
	iters: 400, epoch: 12 | loss: 0.0716550
	speed: 0.0601s/iter; left time: 2485.6877s
Epoch: 12 cost time: 28.350841760635376
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0010758
	speed: 0.2649s/iter; left time: 10905.4623s
	iters: 200, epoch: 13 | loss: 0.3330054
	speed: 0.0635s/iter; left time: 2607.1145s
	iters: 300, epoch: 13 | loss: 0.0111232
	speed: 0.0610s/iter; left time: 2499.3936s
	iters: 400, epoch: 13 | loss: 0.5927039
	speed: 0.0606s/iter; left time: 2476.4662s
Epoch: 13 cost time: 29.583837032318115
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0112242
	speed: 0.2549s/iter; left time: 10376.5478s
	iters: 200, epoch: 14 | loss: 0.0077879
	speed: 0.0630s/iter; left time: 2556.4781s
	iters: 300, epoch: 14 | loss: 0.0007213
	speed: 0.0610s/iter; left time: 2469.1736s
	iters: 400, epoch: 14 | loss: 0.0369104
	speed: 0.0588s/iter; left time: 2376.2592s
Epoch: 14 cost time: 29.138386487960815
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1759867
	speed: 0.2723s/iter; left time: 10957.9730s
	iters: 200, epoch: 15 | loss: 0.0572644
	speed: 0.0631s/iter; left time: 2532.9845s
	iters: 300, epoch: 15 | loss: 0.0146913
	speed: 0.0586s/iter; left time: 2345.6045s
	iters: 400, epoch: 15 | loss: 0.1349656
	speed: 0.0594s/iter; left time: 2371.9474s
Epoch: 15 cost time: 28.53475546836853
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0021658
	speed: 0.2022s/iter; left time: 8041.6359s
	iters: 200, epoch: 16 | loss: 0.0094770
	speed: 0.0501s/iter; left time: 1987.7178s
	iters: 300, epoch: 16 | loss: 0.0039794
	speed: 0.0556s/iter; left time: 2199.8679s
	iters: 400, epoch: 16 | loss: 0.0014226
	speed: 0.0603s/iter; left time: 2380.0703s
Epoch: 16 cost time: 26.158223628997803
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0015292
	speed: 0.2612s/iter; left time: 10266.1293s
	iters: 200, epoch: 17 | loss: 0.0044464
	speed: 0.0649s/iter; left time: 2544.3714s
	iters: 300, epoch: 17 | loss: 0.1652621
	speed: 0.0622s/iter; left time: 2430.4760s
	iters: 400, epoch: 17 | loss: 0.0021645
	speed: 0.0574s/iter; left time: 2238.7073s
Epoch: 17 cost time: 29.262701749801636
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.973412 --> -0.982561).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0016208
	speed: 0.2528s/iter; left time: 9816.1553s
	iters: 200, epoch: 18 | loss: 0.7424110
	speed: 0.0624s/iter; left time: 2417.6342s
	iters: 300, epoch: 18 | loss: 0.0019041
	speed: 0.0620s/iter; left time: 2393.2692s
	iters: 400, epoch: 18 | loss: 0.0057785
	speed: 0.0588s/iter; left time: 2264.3602s
Epoch: 18 cost time: 28.820728540420532
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0497732
	speed: 0.2396s/iter; left time: 9188.9195s
	iters: 200, epoch: 19 | loss: 0.0008101
	speed: 0.0624s/iter; left time: 2388.9743s
	iters: 300, epoch: 19 | loss: 0.2933674
	speed: 0.0632s/iter; left time: 2413.2605s
	iters: 400, epoch: 19 | loss: 0.0175886
	speed: 0.0596s/iter; left time: 2267.3391s
Epoch: 19 cost time: 28.998525142669678
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4477739
	speed: 0.2459s/iter; left time: 9315.9223s
	iters: 200, epoch: 20 | loss: 0.0029869
	speed: 0.0648s/iter; left time: 2448.7313s
	iters: 300, epoch: 20 | loss: 0.2773520
	speed: 0.0664s/iter; left time: 2502.6860s
	iters: 400, epoch: 20 | loss: 0.0336321
	speed: 0.0649s/iter; left time: 2438.2453s
Epoch: 20 cost time: 30.48011016845703
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0003955
	speed: 0.2345s/iter; left time: 8774.0265s
	iters: 200, epoch: 21 | loss: 0.0001411
	speed: 0.0642s/iter; left time: 2397.2812s
	iters: 300, epoch: 21 | loss: 0.1136304
	speed: 0.0633s/iter; left time: 2357.1834s
	iters: 400, epoch: 21 | loss: 0.0595827
	speed: 0.0645s/iter; left time: 2395.1190s
Epoch: 21 cost time: 29.833498001098633
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0009218
	speed: 0.2399s/iter; left time: 8865.2841s
	iters: 200, epoch: 22 | loss: 0.0639489
	speed: 0.0601s/iter; left time: 2213.8140s
	iters: 300, epoch: 22 | loss: 0.0696956
	speed: 0.0576s/iter; left time: 2116.9850s
	iters: 400, epoch: 22 | loss: 0.0838271
	speed: 0.0626s/iter; left time: 2294.2839s
Epoch: 22 cost time: 28.24988102912903
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0029126
	speed: 0.2514s/iter; left time: 9170.0326s
	iters: 200, epoch: 23 | loss: 0.1023869
	speed: 0.0610s/iter; left time: 2218.8110s
	iters: 300, epoch: 23 | loss: 0.0027103
	speed: 0.0627s/iter; left time: 2274.4268s
	iters: 400, epoch: 23 | loss: 0.0108796
	speed: 0.0662s/iter; left time: 2395.5979s
Epoch: 23 cost time: 29.858169317245483
Epoch: 23, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000876
	speed: 0.2554s/iter; left time: 9199.2234s
	iters: 200, epoch: 24 | loss: 0.0019278
	speed: 0.0649s/iter; left time: 2329.1111s
	iters: 300, epoch: 24 | loss: 0.0036137
	speed: 0.0641s/iter; left time: 2296.6610s
	iters: 400, epoch: 24 | loss: 0.0005711
	speed: 0.0604s/iter; left time: 2158.0878s
Epoch: 24 cost time: 29.266441583633423
Epoch: 24, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0005077
	speed: 0.2461s/iter; left time: 8747.9970s
	iters: 200, epoch: 25 | loss: 0.0048234
	speed: 0.0607s/iter; left time: 2151.0094s
	iters: 300, epoch: 25 | loss: 0.0001890
	speed: 0.0596s/iter; left time: 2107.0626s
	iters: 400, epoch: 25 | loss: 0.0031600
	speed: 0.0599s/iter; left time: 2111.8588s
Epoch: 25 cost time: 28.10757827758789
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0017051
	speed: 0.2382s/iter; left time: 8356.6453s
	iters: 200, epoch: 26 | loss: 0.0052394
	speed: 0.0611s/iter; left time: 2136.1388s
	iters: 300, epoch: 26 | loss: 0.0096456
	speed: 0.0626s/iter; left time: 2184.7188s
	iters: 400, epoch: 26 | loss: 0.0001906
	speed: 0.0631s/iter; left time: 2193.5464s
Epoch: 26 cost time: 29.540589332580566
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0117753
	speed: 0.2528s/iter; left time: 8749.9379s
	iters: 200, epoch: 27 | loss: 0.0001104
	speed: 0.0628s/iter; left time: 2166.8179s
	iters: 300, epoch: 27 | loss: 0.0000796
	speed: 0.0659s/iter; left time: 2265.9205s
	iters: 400, epoch: 27 | loss: 0.0007153
	speed: 0.0696s/iter; left time: 2386.2072s
Epoch: 27 cost time: 30.948363542556763
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 508810
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2967672
	speed: 0.0790s/iter; left time: 3699.3663s
	iters: 200, epoch: 1 | loss: 2.2980981
	speed: 0.0623s/iter; left time: 2909.4102s
	iters: 300, epoch: 1 | loss: 2.3039327
	speed: 0.0607s/iter; left time: 2827.8646s
	iters: 400, epoch: 1 | loss: 2.2983842
	speed: 0.0602s/iter; left time: 2798.9648s
Epoch: 1 cost time: 30.359453439712524
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2953782
	speed: 0.2487s/iter; left time: 11524.9407s
	iters: 200, epoch: 2 | loss: 2.3142412
	speed: 0.0621s/iter; left time: 2872.2206s
	iters: 300, epoch: 2 | loss: 2.3002367
	speed: 0.0635s/iter; left time: 2928.1544s
	iters: 400, epoch: 2 | loss: 2.3055687
	speed: 0.0668s/iter; left time: 3074.5949s
Epoch: 2 cost time: 30.165217638015747
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3087993
	speed: 0.2645s/iter; left time: 12131.7359s
	iters: 200, epoch: 3 | loss: 2.3009303
	speed: 0.0655s/iter; left time: 2998.8967s
	iters: 300, epoch: 3 | loss: 2.3005702
	speed: 0.0623s/iter; left time: 2843.0847s
	iters: 400, epoch: 3 | loss: 2.2997046
	speed: 0.0633s/iter; left time: 2885.8916s
Epoch: 3 cost time: 29.985373497009277
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3089063
	speed: 0.2512s/iter; left time: 11402.9236s
	iters: 200, epoch: 4 | loss: 2.3035653
	speed: 0.0616s/iter; left time: 2790.0370s
	iters: 300, epoch: 4 | loss: 2.3039622
	speed: 0.0618s/iter; left time: 2793.9350s
	iters: 400, epoch: 4 | loss: 2.3098865
	speed: 0.0604s/iter; left time: 2723.6995s
Epoch: 4 cost time: 29.133641242980957
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2969351
	speed: 0.2390s/iter; left time: 10737.7810s
	iters: 200, epoch: 5 | loss: 2.3055162
	speed: 0.0667s/iter; left time: 2989.4839s
	iters: 300, epoch: 5 | loss: 2.2960355
	speed: 0.0643s/iter; left time: 2878.0506s
	iters: 400, epoch: 5 | loss: 2.2976301
	speed: 0.0642s/iter; left time: 2867.0609s
Epoch: 5 cost time: 30.604827642440796
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2959423
	speed: 0.2554s/iter; left time: 11352.7914s
	iters: 200, epoch: 6 | loss: 2.3032999
	speed: 0.0638s/iter; left time: 2831.3483s
	iters: 300, epoch: 6 | loss: 2.2942586
	speed: 0.0642s/iter; left time: 2843.1709s
	iters: 400, epoch: 6 | loss: 2.3061471
	speed: 0.0640s/iter; left time: 2825.4987s
Epoch: 6 cost time: 30.366120100021362
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2949791
	speed: 0.2541s/iter; left time: 11178.2176s
	iters: 200, epoch: 7 | loss: 2.2994175
	speed: 0.0599s/iter; left time: 2627.2752s
	iters: 300, epoch: 7 | loss: 2.2978916
	speed: 0.0621s/iter; left time: 2719.7852s
	iters: 400, epoch: 7 | loss: 2.3094065
	speed: 0.0631s/iter; left time: 2757.2848s
Epoch: 7 cost time: 29.56734585762024
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2995429
	speed: 0.2545s/iter; left time: 11073.9300s
	iters: 200, epoch: 8 | loss: 2.3121593
	speed: 0.0633s/iter; left time: 2749.7416s
	iters: 300, epoch: 8 | loss: 2.3028646
	speed: 0.0637s/iter; left time: 2760.3334s
	iters: 400, epoch: 8 | loss: 2.3097050
	speed: 0.0690s/iter; left time: 2981.3852s
Epoch: 8 cost time: 30.951525926589966
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3194008
	speed: 0.2542s/iter; left time: 10943.8670s
	iters: 200, epoch: 9 | loss: 2.2911501
	speed: 0.0628s/iter; left time: 2697.8817s
	iters: 300, epoch: 9 | loss: 2.2817576
	speed: 0.0606s/iter; left time: 2597.5257s
	iters: 400, epoch: 9 | loss: 2.3102150
	speed: 0.0659s/iter; left time: 2818.5575s
Epoch: 9 cost time: 29.59192967414856
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.2887900
	speed: 0.2561s/iter; left time: 10904.2839s
	iters: 200, epoch: 10 | loss: 2.3032429
	speed: 0.0625s/iter; left time: 2656.8499s
	iters: 300, epoch: 10 | loss: 2.2922442
	speed: 0.0638s/iter; left time: 2705.2881s
	iters: 400, epoch: 10 | loss: 2.2953641
	speed: 0.0620s/iter; left time: 2620.9264s
Epoch: 10 cost time: 29.430362462997437
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2937124
	speed: 0.2477s/iter; left time: 10428.9362s
	iters: 200, epoch: 11 | loss: 2.2896314
	speed: 0.0660s/iter; left time: 2774.0141s
	iters: 300, epoch: 11 | loss: 2.2988715
	speed: 0.0650s/iter; left time: 2724.3030s
	iters: 400, epoch: 11 | loss: 2.3165061
	speed: 0.0665s/iter; left time: 2778.5530s
Epoch: 11 cost time: 30.758780241012573
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3027496
	speed: 0.2542s/iter; left time: 10587.4313s
	iters: 200, epoch: 12 | loss: 2.2919753
	speed: 0.0632s/iter; left time: 2623.8759s
	iters: 300, epoch: 12 | loss: 2.2981448
	speed: 0.0664s/iter; left time: 2751.9300s
	iters: 400, epoch: 12 | loss: 2.3195198
	speed: 0.0708s/iter; left time: 2927.1555s
Epoch: 12 cost time: 30.954336881637573
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.2937403
	speed: 0.2607s/iter; left time: 10733.3784s
	iters: 200, epoch: 13 | loss: 2.2928843
	speed: 0.0609s/iter; left time: 2499.5691s
	iters: 300, epoch: 13 | loss: 2.3134942
	speed: 0.0625s/iter; left time: 2560.5638s
	iters: 400, epoch: 13 | loss: 2.3030040
	speed: 0.0592s/iter; left time: 2420.3417s
Epoch: 13 cost time: 28.990148782730103
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.2997284
	speed: 0.2591s/iter; left time: 10546.1256s
	iters: 200, epoch: 14 | loss: 2.3127627
	speed: 0.0662s/iter; left time: 2686.5104s
	iters: 300, epoch: 14 | loss: 2.2927287
	speed: 0.0638s/iter; left time: 2586.1401s
	iters: 400, epoch: 14 | loss: 2.3058558
	speed: 0.0635s/iter; left time: 2564.2186s
Epoch: 14 cost time: 30.429776668548584
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.3024786
	speed: 0.2443s/iter; left time: 9831.3146s
	iters: 200, epoch: 15 | loss: 2.3025451
	speed: 0.0637s/iter; left time: 2558.2890s
	iters: 300, epoch: 15 | loss: 2.3013701
	speed: 0.0655s/iter; left time: 2622.2350s
	iters: 400, epoch: 15 | loss: 2.3136122
	speed: 0.0639s/iter; left time: 2549.9157s
Epoch: 15 cost time: 30.0529944896698
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.3116024
	speed: 0.2594s/iter; left time: 10314.8498s
	iters: 200, epoch: 16 | loss: 2.3030634
	speed: 0.0596s/iter; left time: 2365.9917s
	iters: 300, epoch: 16 | loss: 2.2970057
	speed: 0.0593s/iter; left time: 2347.9692s
	iters: 400, epoch: 16 | loss: 2.3242888
	speed: 0.0651s/iter; left time: 2569.1745s
Epoch: 16 cost time: 29.232276439666748
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.3128171
	speed: 0.2588s/iter; left time: 10169.1033s
	iters: 200, epoch: 17 | loss: 2.2947607
	speed: 0.0643s/iter; left time: 2522.1323s
	iters: 300, epoch: 17 | loss: 2.2900932
	speed: 0.0639s/iter; left time: 2500.1075s
	iters: 400, epoch: 17 | loss: 2.2975967
	speed: 0.0640s/iter; left time: 2493.9711s
Epoch: 17 cost time: 29.911028146743774
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 2.3051426
	speed: 0.2456s/iter; left time: 9535.6475s
	iters: 200, epoch: 18 | loss: 2.2922392
	speed: 0.0597s/iter; left time: 2310.4584s
	iters: 300, epoch: 18 | loss: 2.3047228
	speed: 0.0616s/iter; left time: 2379.8539s
	iters: 400, epoch: 18 | loss: 2.2880516
	speed: 0.0600s/iter; left time: 2313.4936s
Epoch: 18 cost time: 28.704659700393677
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.2805207
	speed: 0.2593s/iter; left time: 9944.9818s
	iters: 200, epoch: 19 | loss: 2.3063622
	speed: 0.0589s/iter; left time: 2254.0916s
	iters: 300, epoch: 19 | loss: 2.2958772
	speed: 0.0603s/iter; left time: 2299.4813s
	iters: 400, epoch: 19 | loss: 2.3068771
	speed: 0.0600s/iter; left time: 2282.6849s
Epoch: 19 cost time: 28.4444797039032
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 2.3010821
	speed: 0.2548s/iter; left time: 9654.6400s
	iters: 200, epoch: 20 | loss: 2.3046663
	speed: 0.0645s/iter; left time: 2435.8887s
	iters: 300, epoch: 20 | loss: 2.2946107
	speed: 0.0575s/iter; left time: 2165.4668s
	iters: 400, epoch: 20 | loss: 2.2882109
	speed: 0.0580s/iter; left time: 2181.6343s
Epoch: 20 cost time: 28.438239336013794
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 21 | loss: 2.3062849
	speed: 0.2424s/iter; left time: 9070.5499s
	iters: 200, epoch: 21 | loss: 2.2818677
	speed: 0.0585s/iter; left time: 2184.1411s
	iters: 300, epoch: 21 | loss: 2.2897940
	speed: 0.0613s/iter; left time: 2281.8532s
	iters: 400, epoch: 21 | loss: 2.3149030
	speed: 0.0558s/iter; left time: 2072.1600s
Epoch: 21 cost time: 28.259344577789307
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.3109586
	speed: 0.2554s/iter; left time: 9436.5016s
	iters: 200, epoch: 22 | loss: 2.3194788
	speed: 0.0669s/iter; left time: 2463.7670s
	iters: 300, epoch: 22 | loss: 2.3050830
	speed: 0.0634s/iter; left time: 2331.7675s
	iters: 400, epoch: 22 | loss: 2.2891347
	speed: 0.0642s/iter; left time: 2351.6566s
Epoch: 22 cost time: 30.691754579544067
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.2965293
	speed: 0.2610s/iter; left time: 9523.5493s
	iters: 200, epoch: 23 | loss: 2.2814167
	speed: 0.0650s/iter; left time: 2366.1158s
	iters: 300, epoch: 23 | loss: 2.3023019
	speed: 0.0623s/iter; left time: 2261.8851s
	iters: 400, epoch: 23 | loss: 2.2983398
	speed: 0.0601s/iter; left time: 2174.7105s
Epoch: 23 cost time: 29.839354276657104
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.2910202
	speed: 0.2667s/iter; left time: 9605.5670s
	iters: 200, epoch: 24 | loss: 2.2977703
	speed: 0.0618s/iter; left time: 2219.3999s
	iters: 300, epoch: 24 | loss: 2.3081138
	speed: 0.0565s/iter; left time: 2022.7798s
	iters: 400, epoch: 24 | loss: 2.2843521
	speed: 0.0562s/iter; left time: 2007.2322s
Epoch: 24 cost time: 28.116013288497925
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 2.2843902
	speed: 0.2633s/iter; left time: 9358.4349s
	iters: 200, epoch: 25 | loss: 2.2922916
	speed: 0.0619s/iter; left time: 2195.3331s
	iters: 300, epoch: 25 | loss: 2.2985032
	speed: 0.0587s/iter; left time: 2074.3353s
	iters: 400, epoch: 25 | loss: 2.3006508
	speed: 0.0586s/iter; left time: 2066.1293s
Epoch: 25 cost time: 28.905170440673828
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.2995417
	speed: 0.2611s/iter; left time: 9159.1498s
	iters: 200, epoch: 26 | loss: 2.2975745
	speed: 0.0649s/iter; left time: 2271.4796s
	iters: 300, epoch: 26 | loss: 2.2891543
	speed: 0.0622s/iter; left time: 2169.5282s
	iters: 400, epoch: 26 | loss: 2.3027973
	speed: 0.0593s/iter; left time: 2063.0179s
Epoch: 26 cost time: 29.976069688796997
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 2.3063836
	speed: 0.2769s/iter; left time: 9581.4792s
	iters: 200, epoch: 27 | loss: 2.2846153
	speed: 0.0596s/iter; left time: 2057.1610s
	iters: 300, epoch: 27 | loss: 2.2929976
	speed: 0.0584s/iter; left time: 2011.0501s
	iters: 400, epoch: 27 | loss: 2.2983012
	speed: 0.0575s/iter; left time: 1973.7389s
Epoch: 27 cost time: 28.420416355133057
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 2.2948401
	speed: 0.2605s/iter; left time: 8892.0958s
	iters: 200, epoch: 28 | loss: 2.2876787
	speed: 0.0579s/iter; left time: 1970.0293s
	iters: 300, epoch: 28 | loss: 2.2834766
	speed: 0.0620s/iter; left time: 2102.9339s
	iters: 400, epoch: 28 | loss: 2.2993369
	speed: 0.0616s/iter; left time: 2083.2569s
Epoch: 28 cost time: 29.236101865768433
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 2.3163362
	speed: 0.2471s/iter; left time: 8318.3141s
	iters: 200, epoch: 29 | loss: 2.3108582
	speed: 0.0576s/iter; left time: 1935.2059s
	iters: 300, epoch: 29 | loss: 2.3139453
	speed: 0.0634s/iter; left time: 2123.5998s
	iters: 400, epoch: 29 | loss: 2.2980235
	speed: 0.0630s/iter; left time: 2103.3194s
Epoch: 29 cost time: 29.41290044784546
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 2.2923913
	speed: 0.2686s/iter; left time: 8915.9479s
	iters: 200, epoch: 30 | loss: 2.2886457
	speed: 0.0578s/iter; left time: 1913.4343s
	iters: 300, epoch: 30 | loss: 2.2998765
	speed: 0.0556s/iter; left time: 1835.2453s
	iters: 400, epoch: 30 | loss: 2.3041978
	speed: 0.0568s/iter; left time: 1868.3930s
Epoch: 30 cost time: 27.981569290161133
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 2.2788672
	speed: 0.2517s/iter; left time: 8239.1048s
	iters: 200, epoch: 31 | loss: 2.3093922
	speed: 0.0620s/iter; left time: 2024.6869s
	iters: 300, epoch: 31 | loss: 2.2832305
	speed: 0.0574s/iter; left time: 1866.9918s
	iters: 400, epoch: 31 | loss: 2.3142633
	speed: 0.0591s/iter; left time: 1915.7803s
Epoch: 31 cost time: 28.377342462539673
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 508810
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8783802
	speed: 0.0799s/iter; left time: 3738.2140s
	iters: 200, epoch: 1 | loss: 0.3919842
	speed: 0.0676s/iter; left time: 3156.2830s
	iters: 300, epoch: 1 | loss: 0.1865348
	speed: 0.0677s/iter; left time: 3153.8836s
	iters: 400, epoch: 1 | loss: 0.0931506
	speed: 0.0650s/iter; left time: 3023.0969s
Epoch: 1 cost time: 32.508825063705444
Epoch: 1, Steps: 469 | Train Loss: 0.600 Vali Loss: 0.244 Vali Acc: 0.929 Test Loss: 0.244 Test Acc: 0.929
Validation loss decreased (inf --> -0.929100).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1289105
	speed: 0.2310s/iter; left time: 10703.4916s
	iters: 200, epoch: 2 | loss: 0.0295798
	speed: 0.0485s/iter; left time: 2241.3170s
	iters: 300, epoch: 2 | loss: 0.0437684
	speed: 0.0442s/iter; left time: 2037.5636s
	iters: 400, epoch: 2 | loss: 0.0171753
	speed: 0.0499s/iter; left time: 2297.6387s
Epoch: 2 cost time: 23.68906283378601
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.929100 --> -0.973126).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0464700
	speed: 0.2365s/iter; left time: 10846.9227s
	iters: 200, epoch: 3 | loss: 0.0460157
	speed: 0.0672s/iter; left time: 3073.4275s
	iters: 300, epoch: 3 | loss: 0.0444418
	speed: 0.0675s/iter; left time: 3083.9891s
	iters: 400, epoch: 3 | loss: 0.0113447
	speed: 0.0636s/iter; left time: 2895.9672s
Epoch: 3 cost time: 30.335824489593506
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0616388
	speed: 0.2440s/iter; left time: 11073.9790s
	iters: 200, epoch: 4 | loss: 0.1580705
	speed: 0.0661s/iter; left time: 2995.3158s
	iters: 300, epoch: 4 | loss: 0.0078539
	speed: 0.0621s/iter; left time: 2805.9892s
	iters: 400, epoch: 4 | loss: 0.2829360
	speed: 0.0587s/iter; left time: 2645.3989s
Epoch: 4 cost time: 29.0415940284729
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0220393
	speed: 0.2468s/iter; left time: 11087.2936s
	iters: 200, epoch: 5 | loss: 0.0068227
	speed: 0.0617s/iter; left time: 2765.3174s
	iters: 300, epoch: 5 | loss: 0.0590933
	speed: 0.0588s/iter; left time: 2631.5479s
	iters: 400, epoch: 5 | loss: 0.0031896
	speed: 0.0574s/iter; left time: 2559.6761s
Epoch: 5 cost time: 27.97329306602478
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0822699
	speed: 0.2373s/iter; left time: 10549.7503s
	iters: 200, epoch: 6 | loss: 0.0097808
	speed: 0.0646s/iter; left time: 2864.9851s
	iters: 300, epoch: 6 | loss: 0.0174313
	speed: 0.0594s/iter; left time: 2628.5628s
	iters: 400, epoch: 6 | loss: 0.0591783
	speed: 0.0613s/iter; left time: 2705.3330s
Epoch: 6 cost time: 29.09906268119812
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0053150
	speed: 0.2514s/iter; left time: 11058.4152s
	iters: 200, epoch: 7 | loss: 0.0090952
	speed: 0.0631s/iter; left time: 2771.2085s
	iters: 300, epoch: 7 | loss: 0.0073709
	speed: 0.0607s/iter; left time: 2659.6985s
	iters: 400, epoch: 7 | loss: 0.0456402
	speed: 0.0646s/iter; left time: 2823.1758s
Epoch: 7 cost time: 29.436228275299072
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973698).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1095630
	speed: 0.2645s/iter; left time: 11510.8595s
	iters: 200, epoch: 8 | loss: 0.2291249
	speed: 0.0674s/iter; left time: 2927.8136s
	iters: 300, epoch: 8 | loss: 0.0006511
	speed: 0.0616s/iter; left time: 2668.3545s
	iters: 400, epoch: 8 | loss: 0.0007180
	speed: 0.0637s/iter; left time: 2753.0764s
Epoch: 8 cost time: 30.171698570251465
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975128).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0033684
	speed: 0.2482s/iter; left time: 10685.3711s
	iters: 200, epoch: 9 | loss: 0.0358773
	speed: 0.0586s/iter; left time: 2515.9961s
	iters: 300, epoch: 9 | loss: 0.0010251
	speed: 0.0620s/iter; left time: 2656.9080s
	iters: 400, epoch: 9 | loss: 0.0061462
	speed: 0.0700s/iter; left time: 2991.9507s
Epoch: 9 cost time: 29.974772214889526
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003248
	speed: 0.2626s/iter; left time: 11181.5242s
	iters: 200, epoch: 10 | loss: 0.0004467
	speed: 0.0607s/iter; left time: 2580.6543s
	iters: 300, epoch: 10 | loss: 0.0012068
	speed: 0.0642s/iter; left time: 2718.7985s
	iters: 400, epoch: 10 | loss: 0.0140169
	speed: 0.0673s/iter; left time: 2845.1151s
Epoch: 10 cost time: 30.76534938812256
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0344415
	speed: 0.2576s/iter; left time: 10845.9320s
	iters: 200, epoch: 11 | loss: 0.0005254
	speed: 0.0646s/iter; left time: 2713.9030s
	iters: 300, epoch: 11 | loss: 0.0025847
	speed: 0.0605s/iter; left time: 2535.5151s
	iters: 400, epoch: 11 | loss: 0.0021482
	speed: 0.0652s/iter; left time: 2724.1991s
Epoch: 11 cost time: 30.504429817199707
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1211222
	speed: 0.2542s/iter; left time: 10586.2391s
	iters: 200, epoch: 12 | loss: 0.0079856
	speed: 0.0630s/iter; left time: 2618.0228s
	iters: 300, epoch: 12 | loss: 0.0044473
	speed: 0.0610s/iter; left time: 2527.0857s
	iters: 400, epoch: 12 | loss: 0.0040903
	speed: 0.0616s/iter; left time: 2545.4263s
Epoch: 12 cost time: 30.28699231147766
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0032425
	speed: 0.2699s/iter; left time: 11112.1415s
	iters: 200, epoch: 13 | loss: 0.0307568
	speed: 0.0653s/iter; left time: 2683.9810s
	iters: 300, epoch: 13 | loss: 0.2658087
	speed: 0.0657s/iter; left time: 2691.0493s
	iters: 400, epoch: 13 | loss: 0.0021742
	speed: 0.0584s/iter; left time: 2387.8269s
Epoch: 13 cost time: 30.693938493728638
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003350
	speed: 0.2732s/iter; left time: 11120.9278s
	iters: 200, epoch: 14 | loss: 0.0019744
	speed: 0.0658s/iter; left time: 2671.4770s
	iters: 300, epoch: 14 | loss: 0.0032332
	speed: 0.0627s/iter; left time: 2540.1135s
	iters: 400, epoch: 14 | loss: 0.0013570
	speed: 0.0596s/iter; left time: 2407.7228s
Epoch: 14 cost time: 29.64703679084778
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0009829
	speed: 0.2526s/iter; left time: 10164.2533s
	iters: 200, epoch: 15 | loss: 0.0000555
	speed: 0.0645s/iter; left time: 2587.4155s
	iters: 300, epoch: 15 | loss: 0.0016922
	speed: 0.0609s/iter; left time: 2436.6173s
	iters: 400, epoch: 15 | loss: 0.0010707
	speed: 0.0605s/iter; left time: 2417.4718s
Epoch: 15 cost time: 29.2527174949646
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0009800
	speed: 0.2572s/iter; left time: 10227.7441s
	iters: 200, epoch: 16 | loss: 0.0028020
	speed: 0.0668s/iter; left time: 2649.5281s
	iters: 300, epoch: 16 | loss: 0.0004100
	speed: 0.0643s/iter; left time: 2542.3682s
	iters: 400, epoch: 16 | loss: 0.0101684
	speed: 0.0612s/iter; left time: 2415.5904s
Epoch: 16 cost time: 30.729326486587524
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.975128 --> -0.976271).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1072232
	speed: 0.2583s/iter; left time: 10151.0808s
	iters: 200, epoch: 17 | loss: 0.0468818
	speed: 0.0640s/iter; left time: 2510.4017s
	iters: 300, epoch: 17 | loss: 0.0177668
	speed: 0.0628s/iter; left time: 2454.9082s
	iters: 400, epoch: 17 | loss: 0.0018203
	speed: 0.0641s/iter; left time: 2498.0697s
Epoch: 17 cost time: 30.615775108337402
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0062867
	speed: 0.2581s/iter; left time: 10021.2869s
	iters: 200, epoch: 18 | loss: 0.0001763
	speed: 0.0589s/iter; left time: 2279.1665s
	iters: 300, epoch: 18 | loss: 0.0008952
	speed: 0.0613s/iter; left time: 2367.0871s
	iters: 400, epoch: 18 | loss: 0.0312323
	speed: 0.0614s/iter; left time: 2365.9929s
Epoch: 18 cost time: 28.600773811340332
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0002652
	speed: 0.2690s/iter; left time: 10318.7720s
	iters: 200, epoch: 19 | loss: 0.0000681
	speed: 0.0612s/iter; left time: 2342.6545s
	iters: 300, epoch: 19 | loss: 0.1093077
	speed: 0.0648s/iter; left time: 2470.8735s
	iters: 400, epoch: 19 | loss: 0.0614941
	speed: 0.0653s/iter; left time: 2486.3166s
Epoch: 19 cost time: 30.072672367095947
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976843).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0007943
	speed: 0.2740s/iter; left time: 10380.8002s
	iters: 200, epoch: 20 | loss: 0.0004504
	speed: 0.0564s/iter; left time: 2130.4079s
	iters: 300, epoch: 20 | loss: 0.0028282
	speed: 0.0552s/iter; left time: 2079.8105s
	iters: 400, epoch: 20 | loss: 0.0046202
	speed: 0.0623s/iter; left time: 2340.0389s
Epoch: 20 cost time: 28.175068140029907
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0004186
	speed: 0.2612s/iter; left time: 9776.0973s
	iters: 200, epoch: 21 | loss: 0.0010845
	speed: 0.0572s/iter; left time: 2135.5080s
	iters: 300, epoch: 21 | loss: 0.0011272
	speed: 0.0567s/iter; left time: 2111.4669s
	iters: 400, epoch: 21 | loss: 0.4186286
	speed: 0.0570s/iter; left time: 2116.5645s
Epoch: 21 cost time: 27.073965311050415
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0002951
	speed: 0.2552s/iter; left time: 9431.0422s
	iters: 200, epoch: 22 | loss: 0.0015508
	speed: 0.0604s/iter; left time: 2225.1750s
	iters: 300, epoch: 22 | loss: 0.0929348
	speed: 0.0589s/iter; left time: 2165.9766s
	iters: 400, epoch: 22 | loss: 0.0045730
	speed: 0.0628s/iter; left time: 2300.0202s
Epoch: 22 cost time: 28.7553071975708
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0002244
	speed: 0.2520s/iter; left time: 9192.2725s
	iters: 200, epoch: 23 | loss: 0.0000269
	speed: 0.0591s/iter; left time: 2151.9312s
	iters: 300, epoch: 23 | loss: 0.0001815
	speed: 0.0607s/iter; left time: 2201.6563s
	iters: 400, epoch: 23 | loss: 0.0974282
	speed: 0.0652s/iter; left time: 2359.6066s
Epoch: 23 cost time: 28.998993635177612
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0016536
	speed: 0.2485s/iter; left time: 8949.2486s
	iters: 200, epoch: 24 | loss: 0.0039584
	speed: 0.0580s/iter; left time: 2082.3855s
	iters: 300, epoch: 24 | loss: 0.1040837
	speed: 0.0566s/iter; left time: 2028.1501s
	iters: 400, epoch: 24 | loss: 0.0005462
	speed: 0.0582s/iter; left time: 2080.3220s
Epoch: 24 cost time: 27.611435890197754
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979416).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0022130
	speed: 0.2201s/iter; left time: 7824.5041s
	iters: 200, epoch: 25 | loss: 0.0011039
	speed: 0.0647s/iter; left time: 2291.9899s
	iters: 300, epoch: 25 | loss: 0.0191914
	speed: 0.0653s/iter; left time: 2309.2901s
	iters: 400, epoch: 25 | loss: 0.0004899
	speed: 0.0608s/iter; left time: 2143.6222s
Epoch: 25 cost time: 29.50897717475891
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0021011
	speed: 0.2544s/iter; left time: 8924.6941s
	iters: 200, epoch: 26 | loss: 0.0160774
	speed: 0.0596s/iter; left time: 2085.3143s
	iters: 300, epoch: 26 | loss: 0.0338012
	speed: 0.0614s/iter; left time: 2141.2933s
	iters: 400, epoch: 26 | loss: 0.0006545
	speed: 0.0616s/iter; left time: 2140.9278s
Epoch: 26 cost time: 29.116043090820312
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0058753
	speed: 0.2525s/iter; left time: 8736.8488s
	iters: 200, epoch: 27 | loss: 0.0014992
	speed: 0.0653s/iter; left time: 2253.4561s
	iters: 300, epoch: 27 | loss: 0.0005191
	speed: 0.0614s/iter; left time: 2111.2267s
	iters: 400, epoch: 27 | loss: 0.0000517
	speed: 0.0579s/iter; left time: 1987.9025s
Epoch: 27 cost time: 29.13182306289673
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0002160
	speed: 0.2361s/iter; left time: 8059.4049s
	iters: 200, epoch: 28 | loss: 0.0002330
	speed: 0.0623s/iter; left time: 2119.4123s
	iters: 300, epoch: 28 | loss: 0.0001255
	speed: 0.0572s/iter; left time: 1940.9852s
	iters: 400, epoch: 28 | loss: 0.0466822
	speed: 0.0593s/iter; left time: 2006.5818s
Epoch: 28 cost time: 28.37336492538452
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0268266
	speed: 0.2573s/iter; left time: 8661.6413s
	iters: 200, epoch: 29 | loss: 0.0001738
	speed: 0.0661s/iter; left time: 2217.4273s
	iters: 300, epoch: 29 | loss: 0.0007071
	speed: 0.0651s/iter; left time: 2180.1995s
	iters: 400, epoch: 29 | loss: 0.0016681
	speed: 0.0648s/iter; left time: 2162.2194s
Epoch: 29 cost time: 30.110600233078003
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0017666
	speed: 0.2336s/iter; left time: 7754.3621s
	iters: 200, epoch: 30 | loss: 0.0015711
	speed: 0.0641s/iter; left time: 2121.9511s
	iters: 300, epoch: 30 | loss: 0.0615414
	speed: 0.0649s/iter; left time: 2142.3238s
	iters: 400, epoch: 30 | loss: 0.0004297
	speed: 0.0647s/iter; left time: 2130.0655s
Epoch: 30 cost time: 30.27109980583191
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0863362
	speed: 0.2291s/iter; left time: 7497.5457s
	iters: 200, epoch: 31 | loss: 0.0067801
	speed: 0.0624s/iter; left time: 2037.5237s
	iters: 300, epoch: 31 | loss: 0.1012638
	speed: 0.0630s/iter; left time: 2049.1310s
	iters: 400, epoch: 31 | loss: 0.2131704
	speed: 0.0621s/iter; left time: 2014.2328s
Epoch: 31 cost time: 28.905714988708496
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0040529
	speed: 0.2460s/iter; left time: 7936.6967s
	iters: 200, epoch: 32 | loss: 0.0000137
	speed: 0.0652s/iter; left time: 2096.3328s
	iters: 300, epoch: 32 | loss: 0.0142127
	speed: 0.0676s/iter; left time: 2168.2970s
	iters: 400, epoch: 32 | loss: 0.0003913
	speed: 0.0681s/iter; left time: 2177.9522s
Epoch: 32 cost time: 30.831668853759766
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0003108
	speed: 0.2637s/iter; left time: 8382.9753s
	iters: 200, epoch: 33 | loss: 0.0003504
	speed: 0.0638s/iter; left time: 2020.8513s
	iters: 300, epoch: 33 | loss: 0.0655884
	speed: 0.0596s/iter; left time: 1882.6315s
	iters: 400, epoch: 33 | loss: 0.0015329
	speed: 0.0648s/iter; left time: 2042.2602s
Epoch: 33 cost time: 30.125715970993042
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0002247
	speed: 0.2432s/iter; left time: 7616.9101s
	iters: 200, epoch: 34 | loss: 0.0051477
	speed: 0.0605s/iter; left time: 1890.1651s
	iters: 300, epoch: 34 | loss: 0.0026688
	speed: 0.0594s/iter; left time: 1847.6543s
	iters: 400, epoch: 34 | loss: 0.0003463
	speed: 0.0580s/iter; left time: 1800.7738s
Epoch: 34 cost time: 27.857039213180542
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.202 Vali Acc: 0.961 Test Loss: 0.202 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 410506
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9513598
	speed: 0.0845s/iter; left time: 3952.5588s
	iters: 200, epoch: 1 | loss: 0.3961115
	speed: 0.0626s/iter; left time: 2922.3704s
	iters: 300, epoch: 1 | loss: 0.1943731
	speed: 0.0645s/iter; left time: 3005.6103s
	iters: 400, epoch: 1 | loss: 0.0975095
	speed: 0.0596s/iter; left time: 2772.2778s
Epoch: 1 cost time: 31.496392965316772
Epoch: 1, Steps: 469 | Train Loss: 0.665 Vali Loss: 0.275 Vali Acc: 0.918 Test Loss: 0.275 Test Acc: 0.918
Validation loss decreased (inf --> -0.917664).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1598204
	speed: 0.2667s/iter; left time: 12354.9091s
	iters: 200, epoch: 2 | loss: 0.1316641
	speed: 0.0672s/iter; left time: 3105.3031s
	iters: 300, epoch: 2 | loss: 0.0630530
	speed: 0.0606s/iter; left time: 2795.6906s
	iters: 400, epoch: 2 | loss: 0.0285172
	speed: 0.0580s/iter; left time: 2669.8290s
Epoch: 2 cost time: 29.624807119369507
Epoch: 2, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.917664 --> -0.967123).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1255443
	speed: 0.2530s/iter; left time: 11603.2514s
	iters: 200, epoch: 3 | loss: 0.0960755
	speed: 0.0610s/iter; left time: 2793.2119s
	iters: 300, epoch: 3 | loss: 0.0543507
	speed: 0.0625s/iter; left time: 2856.1406s
	iters: 400, epoch: 3 | loss: 0.0079989
	speed: 0.0580s/iter; left time: 2643.6241s
Epoch: 3 cost time: 28.936323404312134
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0734518
	speed: 0.2669s/iter; left time: 12116.7046s
	iters: 200, epoch: 4 | loss: 0.1655204
	speed: 0.0667s/iter; left time: 3021.9185s
	iters: 300, epoch: 4 | loss: 0.0056223
	speed: 0.0650s/iter; left time: 2936.2971s
	iters: 400, epoch: 4 | loss: 0.1747956
	speed: 0.0629s/iter; left time: 2834.3802s
Epoch: 4 cost time: 30.8036470413208
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1238335
	speed: 0.2602s/iter; left time: 11690.1084s
	iters: 200, epoch: 5 | loss: 0.0043422
	speed: 0.0664s/iter; left time: 2975.3576s
	iters: 300, epoch: 5 | loss: 0.0617985
	speed: 0.0639s/iter; left time: 2856.5228s
	iters: 400, epoch: 5 | loss: 0.2168017
	speed: 0.0597s/iter; left time: 2661.9263s
Epoch: 5 cost time: 30.122371673583984
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967123 --> -0.967695).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0945237
	speed: 0.2332s/iter; left time: 10367.4025s
	iters: 200, epoch: 6 | loss: 0.0191725
	speed: 0.0633s/iter; left time: 2806.6258s
	iters: 300, epoch: 6 | loss: 0.0031340
	speed: 0.0618s/iter; left time: 2736.6486s
	iters: 400, epoch: 6 | loss: 0.3497117
	speed: 0.0608s/iter; left time: 2685.1215s
Epoch: 6 cost time: 29.252497911453247
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.967695 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0061123
	speed: 0.2507s/iter; left time: 11027.8284s
	iters: 200, epoch: 7 | loss: 0.0023850
	speed: 0.0673s/iter; left time: 2951.9115s
	iters: 300, epoch: 7 | loss: 0.0108751
	speed: 0.0657s/iter; left time: 2878.1499s
	iters: 400, epoch: 7 | loss: 0.0049705
	speed: 0.0622s/iter; left time: 2715.1601s
Epoch: 7 cost time: 30.43431329727173
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0039128
	speed: 0.2617s/iter; left time: 11390.3724s
	iters: 200, epoch: 8 | loss: 0.0711542
	speed: 0.0648s/iter; left time: 2811.6033s
	iters: 300, epoch: 8 | loss: 0.0027657
	speed: 0.0653s/iter; left time: 2830.3640s
	iters: 400, epoch: 8 | loss: 0.0019987
	speed: 0.0627s/iter; left time: 2711.0971s
Epoch: 8 cost time: 30.13331627845764
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0064609
	speed: 0.2517s/iter; left time: 10837.1322s
	iters: 200, epoch: 9 | loss: 0.0007122
	speed: 0.0607s/iter; left time: 2608.9871s
	iters: 300, epoch: 9 | loss: 0.0009062
	speed: 0.0590s/iter; left time: 2529.5724s
	iters: 400, epoch: 9 | loss: 0.0023367
	speed: 0.0554s/iter; left time: 2368.2011s
Epoch: 9 cost time: 27.577943086624146
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0184726
	speed: 0.1817s/iter; left time: 7735.8178s
	iters: 200, epoch: 10 | loss: 0.0008535
	speed: 0.0649s/iter; left time: 2758.5207s
	iters: 300, epoch: 10 | loss: 0.0055844
	speed: 0.0678s/iter; left time: 2872.8578s
	iters: 400, epoch: 10 | loss: 0.0074714
	speed: 0.0656s/iter; left time: 2774.7222s
Epoch: 10 cost time: 29.634689331054688
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0355867
	speed: 0.2347s/iter; left time: 9884.6713s
	iters: 200, epoch: 11 | loss: 0.0026111
	speed: 0.0643s/iter; left time: 2701.5501s
	iters: 300, epoch: 11 | loss: 0.0024240
	speed: 0.0644s/iter; left time: 2701.1229s
	iters: 400, epoch: 11 | loss: 0.0135527
	speed: 0.0671s/iter; left time: 2807.4223s
Epoch: 11 cost time: 30.226213216781616
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2349121
	speed: 0.2320s/iter; left time: 9659.7546s
	iters: 200, epoch: 12 | loss: 0.0005030
	speed: 0.0658s/iter; left time: 2732.4061s
	iters: 300, epoch: 12 | loss: 0.0124481
	speed: 0.0606s/iter; left time: 2510.3012s
	iters: 400, epoch: 12 | loss: 0.1007842
	speed: 0.0597s/iter; left time: 2467.5141s
Epoch: 12 cost time: 29.72163677215576
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0037530
	speed: 0.2405s/iter; left time: 9903.5134s
	iters: 200, epoch: 13 | loss: 0.0565865
	speed: 0.0576s/iter; left time: 2367.7560s
	iters: 300, epoch: 13 | loss: 0.0617821
	speed: 0.0624s/iter; left time: 2554.9530s
	iters: 400, epoch: 13 | loss: 0.0028814
	speed: 0.0671s/iter; left time: 2743.0445s
Epoch: 13 cost time: 29.428067445755005
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0009458
	speed: 0.2503s/iter; left time: 10189.3601s
	iters: 200, epoch: 14 | loss: 0.0007235
	speed: 0.0656s/iter; left time: 2662.4802s
	iters: 300, epoch: 14 | loss: 0.0011089
	speed: 0.0677s/iter; left time: 2740.4869s
	iters: 400, epoch: 14 | loss: 0.0006825
	speed: 0.0664s/iter; left time: 2684.5311s
Epoch: 14 cost time: 30.85133671760559
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0027943
	speed: 0.2435s/iter; left time: 9797.2316s
	iters: 200, epoch: 15 | loss: 0.0006408
	speed: 0.0640s/iter; left time: 2570.4914s
	iters: 300, epoch: 15 | loss: 0.0025339
	speed: 0.0659s/iter; left time: 2639.7951s
	iters: 400, epoch: 15 | loss: 0.0021538
	speed: 0.0619s/iter; left time: 2469.9897s
Epoch: 15 cost time: 30.191193103790283
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002423
	speed: 0.2444s/iter; left time: 9719.4734s
	iters: 200, epoch: 16 | loss: 0.0116919
	speed: 0.0606s/iter; left time: 2404.2020s
	iters: 300, epoch: 16 | loss: 0.0043379
	speed: 0.0598s/iter; left time: 2364.7288s
	iters: 400, epoch: 16 | loss: 0.0101854
	speed: 0.0658s/iter; left time: 2596.3075s
Epoch: 16 cost time: 29.256762981414795
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 410506
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9555284
	speed: 0.0809s/iter; left time: 3787.9409s
	iters: 200, epoch: 1 | loss: 0.3174248
	speed: 0.0604s/iter; left time: 2818.8547s
	iters: 300, epoch: 1 | loss: 0.1848367
	speed: 0.0630s/iter; left time: 2937.7294s
	iters: 400, epoch: 1 | loss: 0.0778309
	speed: 0.0596s/iter; left time: 2770.7536s
Epoch: 1 cost time: 30.671348333358765
Epoch: 1, Steps: 469 | Train Loss: 0.656 Vali Loss: 0.235 Vali Acc: 0.929 Test Loss: 0.235 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1854882
	speed: 0.2664s/iter; left time: 12345.0928s
	iters: 200, epoch: 2 | loss: 0.0324799
	speed: 0.0617s/iter; left time: 2852.3655s
	iters: 300, epoch: 2 | loss: 0.0435129
	speed: 0.0597s/iter; left time: 2753.0156s
	iters: 400, epoch: 2 | loss: 0.0228920
	speed: 0.0568s/iter; left time: 2616.7384s
Epoch: 2 cost time: 29.131844520568848
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.928814 --> -0.971125).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1143465
	speed: 0.2500s/iter; left time: 11464.5725s
	iters: 200, epoch: 3 | loss: 0.0208996
	speed: 0.0581s/iter; left time: 2658.5487s
	iters: 300, epoch: 3 | loss: 0.0154071
	speed: 0.0585s/iter; left time: 2669.5210s
	iters: 400, epoch: 3 | loss: 0.0077914
	speed: 0.0625s/iter; left time: 2845.6358s
Epoch: 3 cost time: 28.787050485610962
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0584715
	speed: 0.2754s/iter; left time: 12499.3361s
	iters: 200, epoch: 4 | loss: 0.2988892
	speed: 0.0565s/iter; left time: 2557.2582s
	iters: 300, epoch: 4 | loss: 0.0363642
	speed: 0.0641s/iter; left time: 2899.0478s
	iters: 400, epoch: 4 | loss: 0.1984347
	speed: 0.0602s/iter; left time: 2714.6179s
Epoch: 4 cost time: 29.448304653167725
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0153994
	speed: 0.2691s/iter; left time: 12089.6106s
	iters: 200, epoch: 5 | loss: 0.0117445
	speed: 0.0608s/iter; left time: 2726.9091s
	iters: 300, epoch: 5 | loss: 0.0717346
	speed: 0.0588s/iter; left time: 2631.3296s
	iters: 400, epoch: 5 | loss: 0.0505379
	speed: 0.0618s/iter; left time: 2759.4076s
Epoch: 5 cost time: 28.627235412597656
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.976271).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0376549
	speed: 0.2449s/iter; left time: 10885.6666s
	iters: 200, epoch: 6 | loss: 0.0043949
	speed: 0.0597s/iter; left time: 2647.3342s
	iters: 300, epoch: 6 | loss: 0.0757732
	speed: 0.0591s/iter; left time: 2616.9775s
	iters: 400, epoch: 6 | loss: 0.0487688
	speed: 0.0612s/iter; left time: 2700.3030s
Epoch: 6 cost time: 28.852393865585327
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0049161
	speed: 0.2447s/iter; left time: 10762.3474s
	iters: 200, epoch: 7 | loss: 0.0483628
	speed: 0.0514s/iter; left time: 2255.2083s
	iters: 300, epoch: 7 | loss: 0.0137709
	speed: 0.0508s/iter; left time: 2222.4847s
	iters: 400, epoch: 7 | loss: 0.0213294
	speed: 0.0498s/iter; left time: 2173.4796s
Epoch: 7 cost time: 24.255796432495117
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0396438
	speed: 0.1947s/iter; left time: 8472.2833s
	iters: 200, epoch: 8 | loss: 0.0229887
	speed: 0.0661s/iter; left time: 2870.6170s
	iters: 300, epoch: 8 | loss: 0.0034841
	speed: 0.0601s/iter; left time: 2605.4446s
	iters: 400, epoch: 8 | loss: 0.0007623
	speed: 0.0539s/iter; left time: 2331.2278s
Epoch: 8 cost time: 28.884655952453613
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0026510
	speed: 0.2444s/iter; left time: 10521.5150s
	iters: 200, epoch: 9 | loss: 0.0707939
	speed: 0.0586s/iter; left time: 2516.6219s
	iters: 300, epoch: 9 | loss: 0.0020912
	speed: 0.0571s/iter; left time: 2447.5061s
	iters: 400, epoch: 9 | loss: 0.0016702
	speed: 0.0587s/iter; left time: 2509.8947s
Epoch: 9 cost time: 27.247684001922607
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0071129
	speed: 0.2504s/iter; left time: 10663.3046s
	iters: 200, epoch: 10 | loss: 0.0009742
	speed: 0.0583s/iter; left time: 2475.2721s
	iters: 300, epoch: 10 | loss: 0.0008572
	speed: 0.0585s/iter; left time: 2479.9111s
	iters: 400, epoch: 10 | loss: 0.0589802
	speed: 0.0595s/iter; left time: 2515.6091s
Epoch: 10 cost time: 28.65688157081604
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0033729
	speed: 0.2412s/iter; left time: 10157.9373s
	iters: 200, epoch: 11 | loss: 0.0015228
	speed: 0.0662s/iter; left time: 2782.9098s
	iters: 300, epoch: 11 | loss: 0.0002640
	speed: 0.0615s/iter; left time: 2577.1370s
	iters: 400, epoch: 11 | loss: 0.0175284
	speed: 0.0553s/iter; left time: 2312.5163s
Epoch: 11 cost time: 29.325069189071655
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0788131
	speed: 0.2509s/iter; left time: 10447.1130s
	iters: 200, epoch: 12 | loss: 0.0372800
	speed: 0.0591s/iter; left time: 2453.2098s
	iters: 300, epoch: 12 | loss: 0.0188858
	speed: 0.0562s/iter; left time: 2328.8338s
	iters: 400, epoch: 12 | loss: 0.0002980
	speed: 0.0559s/iter; left time: 2310.9666s
Epoch: 12 cost time: 27.108409881591797
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0002269
	speed: 0.2435s/iter; left time: 10024.3584s
	iters: 200, epoch: 13 | loss: 0.0560809
	speed: 0.0644s/iter; left time: 2643.3655s
	iters: 300, epoch: 13 | loss: 0.2095755
	speed: 0.0547s/iter; left time: 2240.3936s
	iters: 400, epoch: 13 | loss: 0.0077583
	speed: 0.0550s/iter; left time: 2247.9361s
Epoch: 13 cost time: 28.5181987285614
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0002434
	speed: 0.2475s/iter; left time: 10072.2364s
	iters: 200, epoch: 14 | loss: 0.0001594
	speed: 0.0651s/iter; left time: 2641.7310s
	iters: 300, epoch: 14 | loss: 0.0018908
	speed: 0.0622s/iter; left time: 2519.6636s
	iters: 400, epoch: 14 | loss: 0.0019568
	speed: 0.0561s/iter; left time: 2267.2928s
Epoch: 14 cost time: 28.699668169021606
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0014481
	speed: 0.2484s/iter; left time: 9994.4812s
	iters: 200, epoch: 15 | loss: 0.0000561
	speed: 0.0591s/iter; left time: 2370.1034s
	iters: 300, epoch: 15 | loss: 0.0005809
	speed: 0.0571s/iter; left time: 2286.5636s
	iters: 400, epoch: 15 | loss: 0.0013125
	speed: 0.0563s/iter; left time: 2248.6467s
Epoch: 15 cost time: 27.79641580581665
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 410506
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3019164
	speed: 0.0670s/iter; left time: 3134.3292s
	iters: 200, epoch: 1 | loss: 2.2963769
	speed: 0.0542s/iter; left time: 2532.6519s
	iters: 300, epoch: 1 | loss: 2.3070250
	speed: 0.0576s/iter; left time: 2684.8232s
	iters: 400, epoch: 1 | loss: 2.2996814
	speed: 0.0583s/iter; left time: 2708.8798s
Epoch: 1 cost time: 27.67566227912903
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3046765
	speed: 0.1938s/iter; left time: 8978.8042s
	iters: 200, epoch: 2 | loss: 2.2896719
	speed: 0.0511s/iter; left time: 2360.9971s
	iters: 300, epoch: 2 | loss: 2.2946763
	speed: 0.0501s/iter; left time: 2311.9348s
	iters: 400, epoch: 2 | loss: 2.3121924
	speed: 0.0488s/iter; left time: 2247.8292s
Epoch: 2 cost time: 23.788584232330322
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3015316
	speed: 0.1741s/iter; left time: 7984.6757s
	iters: 200, epoch: 3 | loss: 2.2964222
	speed: 0.0494s/iter; left time: 2260.8145s
	iters: 300, epoch: 3 | loss: 2.2979426
	speed: 0.0487s/iter; left time: 2225.2710s
	iters: 400, epoch: 3 | loss: 2.3159914
	speed: 0.0467s/iter; left time: 2129.9160s
Epoch: 3 cost time: 23.043206214904785
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2926760
	speed: 0.2337s/iter; left time: 10610.5485s
	iters: 200, epoch: 4 | loss: 2.3170445
	speed: 0.0593s/iter; left time: 2687.3775s
	iters: 300, epoch: 4 | loss: 2.3091190
	speed: 0.0621s/iter; left time: 2808.5863s
	iters: 400, epoch: 4 | loss: 2.3067265
	speed: 0.0627s/iter; left time: 2827.4371s
Epoch: 4 cost time: 28.113518714904785
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3083160
	speed: 0.2203s/iter; left time: 9896.1687s
	iters: 200, epoch: 5 | loss: 2.2891521
	speed: 0.0513s/iter; left time: 2300.4843s
	iters: 300, epoch: 5 | loss: 2.2942886
	speed: 0.0594s/iter; left time: 2656.2385s
	iters: 400, epoch: 5 | loss: 2.2981174
	speed: 0.0568s/iter; left time: 2536.5643s
Epoch: 5 cost time: 26.396788835525513
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2953825
	speed: 0.2167s/iter; left time: 9634.3605s
	iters: 200, epoch: 6 | loss: 2.2940979
	speed: 0.0569s/iter; left time: 2522.7197s
	iters: 300, epoch: 6 | loss: 2.2879856
	speed: 0.0611s/iter; left time: 2702.2296s
	iters: 400, epoch: 6 | loss: 2.3027432
	speed: 0.0630s/iter; left time: 2780.4101s
Epoch: 6 cost time: 28.41093158721924
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3000436
	speed: 0.2221s/iter; left time: 9769.6450s
	iters: 200, epoch: 7 | loss: 2.3044732
	speed: 0.0563s/iter; left time: 2471.0553s
	iters: 300, epoch: 7 | loss: 2.3180952
	speed: 0.0585s/iter; left time: 2563.1681s
	iters: 400, epoch: 7 | loss: 2.3070908
	speed: 0.0653s/iter; left time: 2853.3333s
Epoch: 7 cost time: 28.604936361312866
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3161585
	speed: 0.2200s/iter; left time: 9571.8397s
	iters: 200, epoch: 8 | loss: 2.3091829
	speed: 0.0573s/iter; left time: 2485.9145s
	iters: 300, epoch: 8 | loss: 2.2972465
	speed: 0.0565s/iter; left time: 2447.6573s
	iters: 400, epoch: 8 | loss: 2.3095405
	speed: 0.0568s/iter; left time: 2454.5597s
Epoch: 8 cost time: 27.461815357208252
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2938762
	speed: 0.2246s/iter; left time: 9670.6144s
	iters: 200, epoch: 9 | loss: 2.3045170
	speed: 0.0600s/iter; left time: 2577.5520s
	iters: 300, epoch: 9 | loss: 2.2949195
	speed: 0.0588s/iter; left time: 2519.0635s
	iters: 400, epoch: 9 | loss: 2.3044794
	speed: 0.0545s/iter; left time: 2330.9520s
Epoch: 9 cost time: 27.373457193374634
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3027132
	speed: 0.2445s/iter; left time: 10409.6959s
	iters: 200, epoch: 10 | loss: 2.2883286
	speed: 0.0578s/iter; left time: 2456.0471s
	iters: 300, epoch: 10 | loss: 2.3082669
	speed: 0.0590s/iter; left time: 2501.2558s
	iters: 400, epoch: 10 | loss: 2.2996414
	speed: 0.0577s/iter; left time: 2439.4412s
Epoch: 10 cost time: 26.754700660705566
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.3046327
	speed: 0.2513s/iter; left time: 10583.0875s
	iters: 200, epoch: 11 | loss: 2.2952900
	speed: 0.0571s/iter; left time: 2397.0959s
	iters: 300, epoch: 11 | loss: 2.3002741
	speed: 0.0579s/iter; left time: 2427.9361s
	iters: 400, epoch: 11 | loss: 2.2879615
	speed: 0.0612s/iter; left time: 2560.6581s
Epoch: 11 cost time: 27.435178995132446
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.2976446
	speed: 0.2322s/iter; left time: 9669.6999s
	iters: 200, epoch: 12 | loss: 2.2983623
	speed: 0.0497s/iter; left time: 2065.6141s
	iters: 300, epoch: 12 | loss: 2.2998066
	speed: 0.0546s/iter; left time: 2263.1974s
	iters: 400, epoch: 12 | loss: 2.3009603
	speed: 0.0577s/iter; left time: 2386.7775s
Epoch: 12 cost time: 26.447293519973755
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3203382
	speed: 0.2357s/iter; left time: 9704.7175s
	iters: 200, epoch: 13 | loss: 2.3129020
	speed: 0.0570s/iter; left time: 2340.5349s
	iters: 300, epoch: 13 | loss: 2.3053744
	speed: 0.0509s/iter; left time: 2083.7217s
	iters: 400, epoch: 13 | loss: 2.3091593
	speed: 0.0602s/iter; left time: 2461.9099s
Epoch: 13 cost time: 27.512487173080444
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2985280
	speed: 0.2394s/iter; left time: 9743.7677s
	iters: 200, epoch: 14 | loss: 2.3063271
	speed: 0.0577s/iter; left time: 2342.2149s
	iters: 300, epoch: 14 | loss: 2.3281963
	speed: 0.0581s/iter; left time: 2351.9157s
	iters: 400, epoch: 14 | loss: 2.2817752
	speed: 0.0571s/iter; left time: 2305.6272s
Epoch: 14 cost time: 27.581058740615845
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3074684
	speed: 0.2508s/iter; left time: 10089.9106s
	iters: 200, epoch: 15 | loss: 2.2946460
	speed: 0.0531s/iter; left time: 2129.5399s
	iters: 300, epoch: 15 | loss: 2.3129106
	speed: 0.0553s/iter; left time: 2214.2953s
	iters: 400, epoch: 15 | loss: 2.2972310
	speed: 0.0523s/iter; left time: 2088.4139s
Epoch: 15 cost time: 25.517730474472046
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3157949
	speed: 0.2392s/iter; left time: 9511.0324s
	iters: 200, epoch: 16 | loss: 2.3157661
	speed: 0.0507s/iter; left time: 2010.1636s
	iters: 300, epoch: 16 | loss: 2.3141737
	speed: 0.0557s/iter; left time: 2205.5208s
	iters: 400, epoch: 16 | loss: 2.3150363
	speed: 0.0584s/iter; left time: 2304.0733s
Epoch: 16 cost time: 27.430086374282837
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.2855322
	speed: 0.2373s/iter; left time: 9325.7454s
	iters: 200, epoch: 17 | loss: 2.2956512
	speed: 0.0586s/iter; left time: 2295.1791s
	iters: 300, epoch: 17 | loss: 2.3086071
	speed: 0.0524s/iter; left time: 2049.4373s
	iters: 400, epoch: 17 | loss: 2.3201733
	speed: 0.0572s/iter; left time: 2231.3706s
Epoch: 17 cost time: 27.454408884048462
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.2939298
	speed: 0.2393s/iter; left time: 9289.9268s
	iters: 200, epoch: 18 | loss: 2.2994866
	speed: 0.0494s/iter; left time: 1914.3543s
	iters: 300, epoch: 18 | loss: 2.3095512
	speed: 0.0462s/iter; left time: 1783.4198s
	iters: 400, epoch: 18 | loss: 2.3027356
	speed: 0.0450s/iter; left time: 1733.2630s
Epoch: 18 cost time: 22.694899559020996
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3027277
	speed: 0.1604s/iter; left time: 6152.8238s
	iters: 200, epoch: 19 | loss: 2.3002419
	speed: 0.0468s/iter; left time: 1792.4333s
	iters: 300, epoch: 19 | loss: 2.2942464
	speed: 0.0482s/iter; left time: 1838.9630s
	iters: 400, epoch: 19 | loss: 2.3094783
	speed: 0.0560s/iter; left time: 2130.7791s
Epoch: 19 cost time: 24.18470525741577
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.2981455
	speed: 0.2213s/iter; left time: 8386.1535s
	iters: 200, epoch: 20 | loss: 2.3001504
	speed: 0.0598s/iter; left time: 2259.3748s
	iters: 300, epoch: 20 | loss: 2.3139408
	speed: 0.0567s/iter; left time: 2137.4911s
	iters: 400, epoch: 20 | loss: 2.3074439
	speed: 0.0653s/iter; left time: 2455.6316s
Epoch: 20 cost time: 28.83876323699951
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.3055046
	speed: 0.2346s/iter; left time: 8780.4414s
	iters: 200, epoch: 21 | loss: 2.3243561
	speed: 0.0573s/iter; left time: 2137.2057s
	iters: 300, epoch: 21 | loss: 2.2936702
	speed: 0.0582s/iter; left time: 2166.8394s
	iters: 400, epoch: 21 | loss: 2.3045969
	speed: 0.0617s/iter; left time: 2289.4525s
Epoch: 21 cost time: 28.729297161102295
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.2885432
	speed: 0.2246s/iter; left time: 8300.4119s
	iters: 200, epoch: 22 | loss: 2.3146448
	speed: 0.0557s/iter; left time: 2053.4367s
	iters: 300, epoch: 22 | loss: 2.2863648
	speed: 0.0548s/iter; left time: 2014.8083s
	iters: 400, epoch: 22 | loss: 2.3032873
	speed: 0.0564s/iter; left time: 2068.4731s
Epoch: 22 cost time: 26.986194849014282
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.3208566
	speed: 0.2150s/iter; left time: 7842.8902s
	iters: 200, epoch: 23 | loss: 2.2982001
	speed: 0.0512s/iter; left time: 1863.2106s
	iters: 300, epoch: 23 | loss: 2.3127701
	speed: 0.0642s/iter; left time: 2329.3102s
	iters: 400, epoch: 23 | loss: 2.2869437
	speed: 0.0627s/iter; left time: 2268.1382s
Epoch: 23 cost time: 28.055118322372437
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 2.3157754
	speed: 0.2220s/iter; left time: 7995.7650s
	iters: 200, epoch: 24 | loss: 2.2774513
	speed: 0.0521s/iter; left time: 1871.8915s
	iters: 300, epoch: 24 | loss: 2.3221493
	speed: 0.0592s/iter; left time: 2119.4848s
	iters: 400, epoch: 24 | loss: 2.3014970
	speed: 0.0630s/iter; left time: 2250.2352s
Epoch: 24 cost time: 27.878480672836304
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 2.3171949
	speed: 0.2264s/iter; left time: 8047.9702s
	iters: 200, epoch: 25 | loss: 2.2911792
	speed: 0.0563s/iter; left time: 1997.1000s
	iters: 300, epoch: 25 | loss: 2.2934756
	speed: 0.0528s/iter; left time: 1864.4879s
	iters: 400, epoch: 25 | loss: 2.3052607
	speed: 0.0446s/iter; left time: 1570.7572s
Epoch: 25 cost time: 24.847061157226562
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 2.3037968
	speed: 0.1554s/iter; left time: 5452.2789s
	iters: 200, epoch: 26 | loss: 2.3026750
	speed: 0.0469s/iter; left time: 1640.6931s
	iters: 300, epoch: 26 | loss: 2.3026357
	speed: 0.0464s/iter; left time: 1619.6153s
	iters: 400, epoch: 26 | loss: 2.2978859
	speed: 0.0544s/iter; left time: 1892.9544s
Epoch: 26 cost time: 23.195820808410645
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 2.3041592
	speed: 0.2253s/iter; left time: 7795.3306s
	iters: 200, epoch: 27 | loss: 2.3008256
	speed: 0.0573s/iter; left time: 1977.0139s
	iters: 300, epoch: 27 | loss: 2.3126924
	speed: 0.0536s/iter; left time: 1844.6275s
	iters: 400, epoch: 27 | loss: 2.3139858
	speed: 0.0582s/iter; left time: 1995.6430s
Epoch: 27 cost time: 27.439575910568237
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 2.2916217
	speed: 0.2370s/iter; left time: 8091.9065s
	iters: 200, epoch: 28 | loss: 2.3091290
	speed: 0.0570s/iter; left time: 1939.5015s
	iters: 300, epoch: 28 | loss: 2.3017700
	speed: 0.0594s/iter; left time: 2015.4181s
	iters: 400, epoch: 28 | loss: 2.3055794
	speed: 0.0552s/iter; left time: 1867.5793s
Epoch: 28 cost time: 27.36966300010681
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 2.2907460
	speed: 0.2293s/iter; left time: 7721.1194s
	iters: 200, epoch: 29 | loss: 2.2865686
	speed: 0.0574s/iter; left time: 1925.5592s
	iters: 300, epoch: 29 | loss: 2.3028767
	speed: 0.0616s/iter; left time: 2060.6204s
	iters: 400, epoch: 29 | loss: 2.3035619
	speed: 0.0574s/iter; left time: 1914.5646s
Epoch: 29 cost time: 27.14538288116455
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 410506
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8083134
	speed: 0.0760s/iter; left time: 3558.1718s
	iters: 200, epoch: 1 | loss: 0.2685938
	speed: 0.0620s/iter; left time: 2894.3563s
	iters: 300, epoch: 1 | loss: 0.4945855
	speed: 0.0593s/iter; left time: 2764.3762s
	iters: 400, epoch: 1 | loss: 0.1541247
	speed: 0.0524s/iter; left time: 2437.7790s
Epoch: 1 cost time: 29.28737449645996
Epoch: 1, Steps: 469 | Train Loss: 0.692 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (inf --> -0.946253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0531446
	speed: 0.2501s/iter; left time: 11588.6486s
	iters: 200, epoch: 2 | loss: 0.0498992
	speed: 0.0618s/iter; left time: 2859.1932s
	iters: 300, epoch: 2 | loss: 0.0446762
	speed: 0.0565s/iter; left time: 2604.6792s
	iters: 400, epoch: 2 | loss: 0.1102413
	speed: 0.0528s/iter; left time: 2428.5392s
Epoch: 2 cost time: 27.68293285369873
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.946253 --> -0.959690).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2452874
	speed: 0.2521s/iter; left time: 11563.1930s
	iters: 200, epoch: 3 | loss: 0.0138981
	speed: 0.0628s/iter; left time: 2871.9663s
	iters: 300, epoch: 3 | loss: 0.0425285
	speed: 0.0590s/iter; left time: 2694.0834s
	iters: 400, epoch: 3 | loss: 0.0646275
	speed: 0.0573s/iter; left time: 2610.4594s
Epoch: 3 cost time: 28.663699865341187
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.959690 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0176485
	speed: 0.2371s/iter; left time: 10764.1269s
	iters: 200, epoch: 4 | loss: 0.1839451
	speed: 0.0596s/iter; left time: 2699.3107s
	iters: 300, epoch: 4 | loss: 0.0275178
	speed: 0.0565s/iter; left time: 2551.4504s
	iters: 400, epoch: 4 | loss: 0.0226465
	speed: 0.0626s/iter; left time: 2824.6830s
Epoch: 4 cost time: 28.835370302200317
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0360256
	speed: 0.2467s/iter; left time: 11082.2074s
	iters: 200, epoch: 5 | loss: 0.0399205
	speed: 0.0637s/iter; left time: 2855.4879s
	iters: 300, epoch: 5 | loss: 0.0075540
	speed: 0.0608s/iter; left time: 2720.9039s
	iters: 400, epoch: 5 | loss: 0.1119835
	speed: 0.0581s/iter; left time: 2594.7740s
Epoch: 5 cost time: 28.581367015838623
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.970839).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0469023
	speed: 0.2519s/iter; left time: 11199.9083s
	iters: 200, epoch: 6 | loss: 0.1672347
	speed: 0.0502s/iter; left time: 2224.4733s
	iters: 300, epoch: 6 | loss: 0.0037933
	speed: 0.0511s/iter; left time: 2263.5942s
	iters: 400, epoch: 6 | loss: 0.0092561
	speed: 0.0495s/iter; left time: 2185.6279s
Epoch: 6 cost time: 24.973671436309814
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.973126).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2388169
	speed: 0.1982s/iter; left time: 8717.1083s
	iters: 200, epoch: 7 | loss: 0.0170726
	speed: 0.0593s/iter; left time: 2604.6251s
	iters: 300, epoch: 7 | loss: 0.0056030
	speed: 0.0581s/iter; left time: 2544.9963s
	iters: 400, epoch: 7 | loss: 0.0029327
	speed: 0.0591s/iter; left time: 2580.4578s
Epoch: 7 cost time: 28.195254802703857
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3680739
	speed: 0.2164s/iter; left time: 9415.3307s
	iters: 200, epoch: 8 | loss: 0.0016561
	speed: 0.0604s/iter; left time: 2624.0128s
	iters: 300, epoch: 8 | loss: 0.0011598
	speed: 0.0653s/iter; left time: 2826.8254s
	iters: 400, epoch: 8 | loss: 0.0020433
	speed: 0.0653s/iter; left time: 2821.9126s
Epoch: 8 cost time: 29.1068058013916
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.973126 --> -0.982561).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0183827
	speed: 0.2371s/iter; left time: 10204.9696s
	iters: 200, epoch: 9 | loss: 0.0445066
	speed: 0.0638s/iter; left time: 2739.9857s
	iters: 300, epoch: 9 | loss: 0.0009521
	speed: 0.0641s/iter; left time: 2747.4338s
	iters: 400, epoch: 9 | loss: 0.0046996
	speed: 0.0587s/iter; left time: 2510.6885s
Epoch: 9 cost time: 29.180338859558105
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0046377
	speed: 0.2399s/iter; left time: 10214.1389s
	iters: 200, epoch: 10 | loss: 0.0005658
	speed: 0.0634s/iter; left time: 2691.7792s
	iters: 300, epoch: 10 | loss: 0.0397256
	speed: 0.0562s/iter; left time: 2380.3946s
	iters: 400, epoch: 10 | loss: 0.0201747
	speed: 0.0592s/iter; left time: 2504.8605s
Epoch: 10 cost time: 28.934372186660767
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0012400
	speed: 0.2247s/iter; left time: 9460.8779s
	iters: 200, epoch: 11 | loss: 0.0099940
	speed: 0.0605s/iter; left time: 2542.1446s
	iters: 300, epoch: 11 | loss: 0.0093453
	speed: 0.0642s/iter; left time: 2690.2893s
	iters: 400, epoch: 11 | loss: 0.4218873
	speed: 0.0638s/iter; left time: 2666.3433s
Epoch: 11 cost time: 29.292001247406006
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0035793
	speed: 0.1810s/iter; left time: 7537.7621s
	iters: 200, epoch: 12 | loss: 0.0079641
	speed: 0.0491s/iter; left time: 2039.2297s
	iters: 300, epoch: 12 | loss: 0.0420423
	speed: 0.0571s/iter; left time: 2367.4822s
	iters: 400, epoch: 12 | loss: 0.0028132
	speed: 0.0668s/iter; left time: 2761.9091s
Epoch: 12 cost time: 27.076318740844727
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0013579
	speed: 0.2382s/iter; left time: 9806.9607s
	iters: 200, epoch: 13 | loss: 0.0005172
	speed: 0.0541s/iter; left time: 2221.7098s
	iters: 300, epoch: 13 | loss: 0.0808620
	speed: 0.0593s/iter; left time: 2428.0790s
	iters: 400, epoch: 13 | loss: 0.0096386
	speed: 0.0561s/iter; left time: 2292.0513s
Epoch: 13 cost time: 26.824477434158325
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0226775
	speed: 0.2239s/iter; left time: 9114.5841s
	iters: 200, epoch: 14 | loss: 0.0012356
	speed: 0.0596s/iter; left time: 2421.2343s
	iters: 300, epoch: 14 | loss: 0.0214047
	speed: 0.0544s/iter; left time: 2203.0333s
	iters: 400, epoch: 14 | loss: 0.0134045
	speed: 0.0590s/iter; left time: 2382.3455s
Epoch: 14 cost time: 27.42937707901001
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0018705
	speed: 0.2237s/iter; left time: 9000.3670s
	iters: 200, epoch: 15 | loss: 0.0018869
	speed: 0.0616s/iter; left time: 2473.8186s
	iters: 300, epoch: 15 | loss: 0.0242146
	speed: 0.0631s/iter; left time: 2527.4527s
	iters: 400, epoch: 15 | loss: 0.0041213
	speed: 0.0528s/iter; left time: 2107.1464s
Epoch: 15 cost time: 27.785899877548218
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0291996
	speed: 0.2321s/iter; left time: 9231.6492s
	iters: 200, epoch: 16 | loss: 0.0015369
	speed: 0.0626s/iter; left time: 2483.6238s
	iters: 300, epoch: 16 | loss: 0.0002645
	speed: 0.0592s/iter; left time: 2340.7523s
	iters: 400, epoch: 16 | loss: 0.0277809
	speed: 0.0595s/iter; left time: 2347.6383s
Epoch: 16 cost time: 28.4283926486969
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0932243
	speed: 0.2206s/iter; left time: 8668.2534s
	iters: 200, epoch: 17 | loss: 0.0784298
	speed: 0.0580s/iter; left time: 2273.8766s
	iters: 300, epoch: 17 | loss: 0.0972817
	speed: 0.0603s/iter; left time: 2358.9752s
	iters: 400, epoch: 17 | loss: 0.0058593
	speed: 0.0510s/iter; left time: 1989.6194s
Epoch: 17 cost time: 26.83039116859436
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0288181
	speed: 0.2171s/iter; left time: 8430.6544s
	iters: 200, epoch: 18 | loss: 0.0003371
	speed: 0.0563s/iter; left time: 2178.6397s
	iters: 300, epoch: 18 | loss: 0.0018835
	speed: 0.0610s/iter; left time: 2355.7675s
	iters: 400, epoch: 18 | loss: 0.0187127
	speed: 0.0620s/iter; left time: 2388.9684s
Epoch: 18 cost time: 28.31548547744751
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0067312
	speed: 0.2326s/iter; left time: 8921.3353s
	iters: 200, epoch: 19 | loss: 0.0032379
	speed: 0.0554s/iter; left time: 2119.9124s
	iters: 300, epoch: 19 | loss: 0.1128059
	speed: 0.0608s/iter; left time: 2321.3319s
	iters: 400, epoch: 19 | loss: 0.0061850
	speed: 0.0567s/iter; left time: 2158.8946s
Epoch: 19 cost time: 27.7255277633667
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0011255
	speed: 0.2311s/iter; left time: 8755.8785s
	iters: 200, epoch: 20 | loss: 0.0016744
	speed: 0.0579s/iter; left time: 2186.8176s
	iters: 300, epoch: 20 | loss: 0.0003827
	speed: 0.0580s/iter; left time: 2186.2383s
	iters: 400, epoch: 20 | loss: 0.0056360
	speed: 0.0620s/iter; left time: 2331.2657s
Epoch: 20 cost time: 28.072466135025024
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0050840
	speed: 0.1850s/iter; left time: 6924.6782s
	iters: 200, epoch: 21 | loss: 0.0007328
	speed: 0.0521s/iter; left time: 1943.1295s
	iters: 300, epoch: 21 | loss: 0.0699525
	speed: 0.0517s/iter; left time: 1924.3761s
	iters: 400, epoch: 21 | loss: 0.0029575
	speed: 0.0535s/iter; left time: 1986.2858s
Epoch: 21 cost time: 25.36264419555664
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000646
	speed: 0.2447s/iter; left time: 9043.8010s
	iters: 200, epoch: 22 | loss: 0.0024072
	speed: 0.0635s/iter; left time: 2341.1602s
	iters: 300, epoch: 22 | loss: 0.0881657
	speed: 0.0618s/iter; left time: 2271.4378s
	iters: 400, epoch: 22 | loss: 0.0064653
	speed: 0.0582s/iter; left time: 2132.6757s
Epoch: 22 cost time: 28.96690034866333
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 868810
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1674780
	speed: 0.0729s/iter; left time: 3410.4917s
	iters: 200, epoch: 1 | loss: 0.4592411
	speed: 0.0599s/iter; left time: 2797.4912s
	iters: 300, epoch: 1 | loss: 0.7396853
	speed: 0.0562s/iter; left time: 2620.3983s
	iters: 400, epoch: 1 | loss: 0.3032617
	speed: 0.0552s/iter; left time: 2566.6658s
Epoch: 1 cost time: 28.36971402168274
Epoch: 1, Steps: 469 | Train Loss: 0.836 Vali Loss: 0.293 Vali Acc: 0.915 Test Loss: 0.293 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0552508
	speed: 0.2372s/iter; left time: 10987.9722s
	iters: 200, epoch: 2 | loss: 0.0862196
	speed: 0.0572s/iter; left time: 2643.1871s
	iters: 300, epoch: 2 | loss: 0.0383662
	speed: 0.0561s/iter; left time: 2589.6799s
	iters: 400, epoch: 2 | loss: 0.1741067
	speed: 0.0586s/iter; left time: 2699.3177s
Epoch: 2 cost time: 27.079581260681152
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.190 Vali Acc: 0.945 Test Loss: 0.190 Test Acc: 0.945
Validation loss decreased (-0.914520 --> -0.945110).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1422546
	speed: 0.2280s/iter; left time: 10458.6827s
	iters: 200, epoch: 3 | loss: 0.0244420
	speed: 0.0580s/iter; left time: 2655.4159s
	iters: 300, epoch: 3 | loss: 0.1724072
	speed: 0.0599s/iter; left time: 2733.2182s
	iters: 400, epoch: 3 | loss: 0.1234599
	speed: 0.0584s/iter; left time: 2659.7038s
Epoch: 3 cost time: 27.80903959274292
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.945110 --> -0.964836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0431525
	speed: 0.2368s/iter; left time: 10751.4158s
	iters: 200, epoch: 4 | loss: 0.0965879
	speed: 0.0607s/iter; left time: 2750.3368s
	iters: 300, epoch: 4 | loss: 0.0816964
	speed: 0.0623s/iter; left time: 2816.5408s
	iters: 400, epoch: 4 | loss: 0.0197165
	speed: 0.0577s/iter; left time: 2603.4845s
Epoch: 4 cost time: 28.37593650817871
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0813028
	speed: 0.2590s/iter; left time: 11636.2904s
	iters: 200, epoch: 5 | loss: 0.0345304
	speed: 0.0603s/iter; left time: 2703.2512s
	iters: 300, epoch: 5 | loss: 0.0294704
	speed: 0.0585s/iter; left time: 2614.7658s
	iters: 400, epoch: 5 | loss: 0.0721508
	speed: 0.0592s/iter; left time: 2642.3608s
Epoch: 5 cost time: 28.659042358398438
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966551).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0089920
	speed: 0.2493s/iter; left time: 11082.0174s
	iters: 200, epoch: 6 | loss: 0.0234841
	speed: 0.0626s/iter; left time: 2777.7154s
	iters: 300, epoch: 6 | loss: 0.0075691
	speed: 0.0596s/iter; left time: 2636.4793s
	iters: 400, epoch: 6 | loss: 0.0062469
	speed: 0.0620s/iter; left time: 2739.5359s
Epoch: 6 cost time: 28.83735728263855
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2566354
	speed: 0.2587s/iter; left time: 11377.9835s
	iters: 200, epoch: 7 | loss: 0.0795654
	speed: 0.0641s/iter; left time: 2814.5183s
	iters: 300, epoch: 7 | loss: 0.0069644
	speed: 0.0655s/iter; left time: 2869.9539s
	iters: 400, epoch: 7 | loss: 0.0079320
	speed: 0.0614s/iter; left time: 2682.4233s
Epoch: 7 cost time: 30.002980947494507
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4969762
	speed: 0.2358s/iter; left time: 10262.1041s
	iters: 200, epoch: 8 | loss: 0.0214144
	speed: 0.0628s/iter; left time: 2725.0787s
	iters: 300, epoch: 8 | loss: 0.0009955
	speed: 0.0631s/iter; left time: 2731.7297s
	iters: 400, epoch: 8 | loss: 0.0028341
	speed: 0.0610s/iter; left time: 2635.6494s
Epoch: 8 cost time: 29.26007628440857
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0527993
	speed: 0.2351s/iter; left time: 10121.2564s
	iters: 200, epoch: 9 | loss: 0.2081484
	speed: 0.0605s/iter; left time: 2597.8179s
	iters: 300, epoch: 9 | loss: 0.0091818
	speed: 0.0612s/iter; left time: 2621.3690s
	iters: 400, epoch: 9 | loss: 0.0045557
	speed: 0.0611s/iter; left time: 2610.2723s
Epoch: 9 cost time: 28.41461753845215
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0324862
	speed: 0.2572s/iter; left time: 10950.6775s
	iters: 200, epoch: 10 | loss: 0.0008723
	speed: 0.0600s/iter; left time: 2547.7320s
	iters: 300, epoch: 10 | loss: 0.0499564
	speed: 0.0560s/iter; left time: 2374.3733s
	iters: 400, epoch: 10 | loss: 0.0246728
	speed: 0.0623s/iter; left time: 2634.6639s
Epoch: 10 cost time: 28.551857233047485
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.966551 --> -0.973126).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0447780
	speed: 0.2524s/iter; left time: 10629.6261s
	iters: 200, epoch: 11 | loss: 0.0221443
	speed: 0.0639s/iter; left time: 2684.0055s
	iters: 300, epoch: 11 | loss: 0.0012212
	speed: 0.0586s/iter; left time: 2458.0047s
	iters: 400, epoch: 11 | loss: 0.3842768
	speed: 0.0587s/iter; left time: 2453.9130s
Epoch: 11 cost time: 28.3247332572937
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0034778
	speed: 0.2334s/iter; left time: 9719.8672s
	iters: 200, epoch: 12 | loss: 0.0461675
	speed: 0.0576s/iter; left time: 2392.8500s
	iters: 300, epoch: 12 | loss: 0.0172807
	speed: 0.0553s/iter; left time: 2291.4349s
	iters: 400, epoch: 12 | loss: 0.0166934
	speed: 0.0569s/iter; left time: 2352.6172s
Epoch: 12 cost time: 27.266955375671387
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0342705
	speed: 0.2407s/iter; left time: 9908.3494s
	iters: 200, epoch: 13 | loss: 0.0010710
	speed: 0.0575s/iter; left time: 2360.4383s
	iters: 300, epoch: 13 | loss: 0.2578136
	speed: 0.0590s/iter; left time: 2418.8437s
	iters: 400, epoch: 13 | loss: 0.0759240
	speed: 0.0574s/iter; left time: 2347.7356s
Epoch: 13 cost time: 27.59122109413147
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0023016
	speed: 0.2460s/iter; left time: 10014.5491s
	iters: 200, epoch: 14 | loss: 0.0051271
	speed: 0.0591s/iter; left time: 2401.7169s
	iters: 300, epoch: 14 | loss: 0.0052308
	speed: 0.0559s/iter; left time: 2264.2393s
	iters: 400, epoch: 14 | loss: 0.0204117
	speed: 0.0553s/iter; left time: 2234.2031s
Epoch: 14 cost time: 27.03868055343628
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0114667
	speed: 0.2034s/iter; left time: 8184.2316s
	iters: 200, epoch: 15 | loss: 0.0040676
	speed: 0.0537s/iter; left time: 2153.3005s
	iters: 300, epoch: 15 | loss: 0.0076174
	speed: 0.0621s/iter; left time: 2487.0020s
	iters: 400, epoch: 15 | loss: 0.0150345
	speed: 0.0616s/iter; left time: 2458.0430s
Epoch: 15 cost time: 27.633491277694702
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0112311
	speed: 0.2061s/iter; left time: 8196.0539s
	iters: 200, epoch: 16 | loss: 0.0262695
	speed: 0.0545s/iter; left time: 2162.8887s
	iters: 300, epoch: 16 | loss: 0.0150262
	speed: 0.0544s/iter; left time: 2153.9478s
	iters: 400, epoch: 16 | loss: 0.4737181
	speed: 0.0495s/iter; left time: 1954.5779s
Epoch: 16 cost time: 24.796393871307373
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0736208
	speed: 0.1948s/iter; left time: 7654.0482s
	iters: 200, epoch: 17 | loss: 0.0416378
	speed: 0.0571s/iter; left time: 2236.3062s
	iters: 300, epoch: 17 | loss: 0.0224063
	speed: 0.0584s/iter; left time: 2283.8997s
	iters: 400, epoch: 17 | loss: 0.0197030
	speed: 0.0687s/iter; left time: 2677.8478s
Epoch: 17 cost time: 29.38253116607666
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.1679502
	speed: 0.2576s/iter; left time: 10003.7672s
	iters: 200, epoch: 18 | loss: 0.0065799
	speed: 0.0595s/iter; left time: 2302.6055s
	iters: 300, epoch: 18 | loss: 0.0041913
	speed: 0.0589s/iter; left time: 2276.6196s
	iters: 400, epoch: 18 | loss: 0.0068708
	speed: 0.0593s/iter; left time: 2285.7028s
Epoch: 18 cost time: 28.381598949432373
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0080644
	speed: 0.2503s/iter; left time: 9602.8593s
	iters: 200, epoch: 19 | loss: 0.0010381
	speed: 0.0552s/iter; left time: 2112.1038s
	iters: 300, epoch: 19 | loss: 0.0184760
	speed: 0.0568s/iter; left time: 2167.6764s
	iters: 400, epoch: 19 | loss: 0.0002021
	speed: 0.0604s/iter; left time: 2300.3438s
Epoch: 19 cost time: 27.58409309387207
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.973126 --> -0.978558).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0064438
	speed: 0.2434s/iter; left time: 9222.7516s
	iters: 200, epoch: 20 | loss: 0.0097485
	speed: 0.0554s/iter; left time: 2092.2950s
	iters: 300, epoch: 20 | loss: 0.0017490
	speed: 0.0556s/iter; left time: 2096.0073s
	iters: 400, epoch: 20 | loss: 0.0013137
	speed: 0.0626s/iter; left time: 2352.2114s
Epoch: 20 cost time: 27.733516931533813
Epoch: 20, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0009388
	speed: 0.2488s/iter; left time: 9311.0352s
	iters: 200, epoch: 21 | loss: 0.0006132
	speed: 0.0567s/iter; left time: 2117.7442s
	iters: 300, epoch: 21 | loss: 0.0122409
	speed: 0.0560s/iter; left time: 2083.4993s
	iters: 400, epoch: 21 | loss: 0.0008396
	speed: 0.0591s/iter; left time: 2193.6578s
Epoch: 21 cost time: 27.752752780914307
Epoch: 21, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0556028
	speed: 0.2598s/iter; left time: 9599.1936s
	iters: 200, epoch: 22 | loss: 0.0861399
	speed: 0.0575s/iter; left time: 2119.2853s
	iters: 300, epoch: 22 | loss: 0.0085798
	speed: 0.0610s/iter; left time: 2243.4847s
	iters: 400, epoch: 22 | loss: 0.0573542
	speed: 0.0629s/iter; left time: 2303.7440s
Epoch: 22 cost time: 28.900633811950684
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3567079
	speed: 0.2725s/iter; left time: 9939.9750s
	iters: 200, epoch: 23 | loss: 0.0702248
	speed: 0.0572s/iter; left time: 2081.1191s
	iters: 300, epoch: 23 | loss: 0.0232520
	speed: 0.0574s/iter; left time: 2081.8359s
	iters: 400, epoch: 23 | loss: 0.0018326
	speed: 0.0594s/iter; left time: 2149.4718s
Epoch: 23 cost time: 28.363888025283813
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0889320
	speed: 0.2439s/iter; left time: 8783.6193s
	iters: 200, epoch: 24 | loss: 0.0045098
	speed: 0.0580s/iter; left time: 2083.3910s
	iters: 300, epoch: 24 | loss: 0.0032030
	speed: 0.0533s/iter; left time: 1908.3370s
	iters: 400, epoch: 24 | loss: 0.0010907
	speed: 0.0578s/iter; left time: 2063.7882s
Epoch: 24 cost time: 27.09953737258911
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0114972
	speed: 0.2558s/iter; left time: 9093.9963s
	iters: 200, epoch: 25 | loss: 0.0012832
	speed: 0.0592s/iter; left time: 2097.0382s
	iters: 300, epoch: 25 | loss: 0.0002644
	speed: 0.0587s/iter; left time: 2073.7877s
	iters: 400, epoch: 25 | loss: 0.2634011
	speed: 0.0597s/iter; left time: 2104.2326s
Epoch: 25 cost time: 28.64090394973755
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0009615
	speed: 0.2671s/iter; left time: 9369.0192s
	iters: 200, epoch: 26 | loss: 0.0011614
	speed: 0.0594s/iter; left time: 2076.7815s
	iters: 300, epoch: 26 | loss: 0.0009570
	speed: 0.0569s/iter; left time: 1984.7065s
	iters: 400, epoch: 26 | loss: 0.0041693
	speed: 0.0587s/iter; left time: 2039.6495s
Epoch: 26 cost time: 28.203585386276245
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0005182
	speed: 0.2550s/iter; left time: 8823.6362s
	iters: 200, epoch: 27 | loss: 0.0005620
	speed: 0.0581s/iter; left time: 2005.0797s
	iters: 300, epoch: 27 | loss: 0.0001352
	speed: 0.0574s/iter; left time: 1974.7562s
	iters: 400, epoch: 27 | loss: 0.0811674
	speed: 0.0540s/iter; left time: 1851.2544s
Epoch: 27 cost time: 27.21407675743103
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0002735
	speed: 0.2557s/iter; left time: 8727.8389s
	iters: 200, epoch: 28 | loss: 0.0006815
	speed: 0.0646s/iter; left time: 2199.1376s
	iters: 300, epoch: 28 | loss: 0.3792372
	speed: 0.0621s/iter; left time: 2106.8377s
	iters: 400, epoch: 28 | loss: 0.0030987
	speed: 0.0624s/iter; left time: 2111.1205s
Epoch: 28 cost time: 29.54231071472168
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0755510
	speed: 0.2648s/iter; left time: 8914.2798s
	iters: 200, epoch: 29 | loss: 0.0035303
	speed: 0.0617s/iter; left time: 2070.5207s
	iters: 300, epoch: 29 | loss: 0.1755958
	speed: 0.0604s/iter; left time: 2020.8420s
	iters: 400, epoch: 29 | loss: 0.0006510
	speed: 0.0642s/iter; left time: 2143.5180s
Epoch: 29 cost time: 29.076844930648804
Epoch: 29, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0004462
	speed: 0.2384s/iter; left time: 7914.8972s
	iters: 200, epoch: 30 | loss: 0.0057369
	speed: 0.0571s/iter; left time: 1890.2899s
	iters: 300, epoch: 30 | loss: 0.0011194
	speed: 0.0579s/iter; left time: 1911.2887s
	iters: 400, epoch: 30 | loss: 0.0696431
	speed: 0.0586s/iter; left time: 1927.9490s
Epoch: 30 cost time: 27.568286657333374
Epoch: 30, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.3152044
	speed: 0.2245s/iter; left time: 7347.2103s
	iters: 200, epoch: 31 | loss: 0.0118453
	speed: 0.0563s/iter; left time: 1838.3526s
	iters: 300, epoch: 31 | loss: 0.0001071
	speed: 0.0590s/iter; left time: 1917.9836s
	iters: 400, epoch: 31 | loss: 0.0007476
	speed: 0.0573s/iter; left time: 1859.4707s
Epoch: 31 cost time: 27.25566053390503
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980559).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0011062
	speed: 0.2499s/iter; left time: 8061.9671s
	iters: 200, epoch: 32 | loss: 0.0107251
	speed: 0.0545s/iter; left time: 1753.4783s
	iters: 300, epoch: 32 | loss: 0.0004548
	speed: 0.0561s/iter; left time: 1797.1751s
	iters: 400, epoch: 32 | loss: 0.0016540
	speed: 0.0592s/iter; left time: 1891.4865s
Epoch: 32 cost time: 27.406601190567017
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.982275).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0210440
	speed: 0.2583s/iter; left time: 8212.9783s
	iters: 200, epoch: 33 | loss: 0.0008384
	speed: 0.0590s/iter; left time: 1869.3549s
	iters: 300, epoch: 33 | loss: 0.0004289
	speed: 0.0555s/iter; left time: 1754.4493s
	iters: 400, epoch: 33 | loss: 0.0003827
	speed: 0.0541s/iter; left time: 1704.7245s
Epoch: 33 cost time: 27.238585233688354
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0010214
	speed: 0.2518s/iter; left time: 7888.6379s
	iters: 200, epoch: 34 | loss: 0.5459091
	speed: 0.0591s/iter; left time: 1844.4639s
	iters: 300, epoch: 34 | loss: 0.0001896
	speed: 0.0561s/iter; left time: 1747.5060s
	iters: 400, epoch: 34 | loss: 0.0026204
	speed: 0.0592s/iter; left time: 1835.6022s
Epoch: 34 cost time: 27.862720012664795
Epoch: 34, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0008093
	speed: 0.2232s/iter; left time: 6886.9611s
	iters: 200, epoch: 35 | loss: 0.0465230
	speed: 0.0618s/iter; left time: 1899.8934s
	iters: 300, epoch: 35 | loss: 0.3675222
	speed: 0.0619s/iter; left time: 1898.3750s
	iters: 400, epoch: 35 | loss: 0.0012317
	speed: 0.0589s/iter; left time: 1799.9870s
Epoch: 35 cost time: 28.162757396697998
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0544860
	speed: 0.2213s/iter; left time: 6724.9141s
	iters: 200, epoch: 36 | loss: 0.0130026
	speed: 0.0600s/iter; left time: 1817.4958s
	iters: 300, epoch: 36 | loss: 0.0038569
	speed: 0.0599s/iter; left time: 1806.8814s
	iters: 400, epoch: 36 | loss: 0.0002508
	speed: 0.0583s/iter; left time: 1755.2367s
Epoch: 36 cost time: 27.73656988143921
Epoch: 36, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0002196
	speed: 0.2578s/iter; left time: 7712.5508s
	iters: 200, epoch: 37 | loss: 0.0065075
	speed: 0.0652s/iter; left time: 1944.1171s
	iters: 300, epoch: 37 | loss: 0.0020129
	speed: 0.0645s/iter; left time: 1915.5664s
	iters: 400, epoch: 37 | loss: 0.0000489
	speed: 0.0623s/iter; left time: 1846.1648s
Epoch: 37 cost time: 30.47608733177185
Epoch: 37, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0057147
	speed: 0.2641s/iter; left time: 7778.6876s
	iters: 200, epoch: 38 | loss: 0.0091927
	speed: 0.0645s/iter; left time: 1893.3016s
	iters: 300, epoch: 38 | loss: 0.0002932
	speed: 0.0645s/iter; left time: 1885.3613s
	iters: 400, epoch: 38 | loss: 0.0125558
	speed: 0.0621s/iter; left time: 1808.6414s
Epoch: 38 cost time: 30.089972019195557
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0007633
	speed: 0.2742s/iter; left time: 7947.0912s
	iters: 200, epoch: 39 | loss: 0.0238708
	speed: 0.0620s/iter; left time: 1789.5102s
	iters: 300, epoch: 39 | loss: 0.0024271
	speed: 0.0603s/iter; left time: 1736.2712s
	iters: 400, epoch: 39 | loss: 0.2133731
	speed: 0.0585s/iter; left time: 1677.3501s
Epoch: 39 cost time: 29.09790015220642
Epoch: 39, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0425005
	speed: 0.2626s/iter; left time: 7485.5873s
	iters: 200, epoch: 40 | loss: 0.1001129
	speed: 0.0656s/iter; left time: 1863.2995s
	iters: 300, epoch: 40 | loss: 0.0023834
	speed: 0.0615s/iter; left time: 1739.7652s
	iters: 400, epoch: 40 | loss: 0.0048848
	speed: 0.0601s/iter; left time: 1694.2486s
Epoch: 40 cost time: 29.354281902313232
Epoch: 40, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0466006
	speed: 0.2446s/iter; left time: 6859.1388s
	iters: 200, epoch: 41 | loss: 0.0019817
	speed: 0.0624s/iter; left time: 1744.0426s
	iters: 300, epoch: 41 | loss: 0.0008744
	speed: 0.0613s/iter; left time: 1705.3855s
	iters: 400, epoch: 41 | loss: 0.0035694
	speed: 0.0652s/iter; left time: 1809.2797s
Epoch: 41 cost time: 29.995220184326172
Epoch: 41, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0001380
	speed: 0.2452s/iter; left time: 6761.6886s
	iters: 200, epoch: 42 | loss: 0.0001134
	speed: 0.0611s/iter; left time: 1678.7253s
	iters: 300, epoch: 42 | loss: 0.0000892
	speed: 0.0629s/iter; left time: 1721.7526s
	iters: 400, epoch: 42 | loss: 0.0006464
	speed: 0.0597s/iter; left time: 1628.8100s
Epoch: 42 cost time: 28.65661859512329
Epoch: 42, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 868810
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0690248
	speed: 0.0772s/iter; left time: 3612.9341s
	iters: 200, epoch: 1 | loss: 0.3461224
	speed: 0.0623s/iter; left time: 2909.4297s
	iters: 300, epoch: 1 | loss: 0.5197911
	speed: 0.0626s/iter; left time: 2917.8582s
	iters: 400, epoch: 1 | loss: 0.1876461
	speed: 0.0622s/iter; left time: 2894.1917s
Epoch: 1 cost time: 30.908306121826172
Epoch: 1, Steps: 469 | Train Loss: 0.753 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
Validation loss decreased (inf --> -0.931959).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0440597
	speed: 0.2491s/iter; left time: 11541.0326s
	iters: 200, epoch: 2 | loss: 0.0657502
	speed: 0.0649s/iter; left time: 3002.1631s
	iters: 300, epoch: 2 | loss: 0.0252095
	speed: 0.0637s/iter; left time: 2940.2282s
	iters: 400, epoch: 2 | loss: 0.0779764
	speed: 0.0620s/iter; left time: 2856.0862s
Epoch: 2 cost time: 29.82827877998352
Epoch: 2, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.931959 --> -0.960833).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1758337
	speed: 0.2626s/iter; left time: 12044.3971s
	iters: 200, epoch: 3 | loss: 0.0068729
	speed: 0.0607s/iter; left time: 2776.3462s
	iters: 300, epoch: 3 | loss: 0.1654220
	speed: 0.0623s/iter; left time: 2842.8913s
	iters: 400, epoch: 3 | loss: 0.1017836
	speed: 0.0650s/iter; left time: 2961.3556s
Epoch: 3 cost time: 29.59432029724121
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.960833 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0217913
	speed: 0.2532s/iter; left time: 11495.5064s
	iters: 200, epoch: 4 | loss: 0.0820962
	speed: 0.0632s/iter; left time: 2862.5722s
	iters: 300, epoch: 4 | loss: 0.0478478
	speed: 0.0551s/iter; left time: 2491.8823s
	iters: 400, epoch: 4 | loss: 0.0222071
	speed: 0.0531s/iter; left time: 2393.5020s
Epoch: 4 cost time: 27.281818866729736
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0958003
	speed: 0.1793s/iter; left time: 8053.4825s
	iters: 200, epoch: 5 | loss: 0.0073021
	speed: 0.0492s/iter; left time: 2206.8282s
	iters: 300, epoch: 5 | loss: 0.0061042
	speed: 0.0485s/iter; left time: 2167.8696s
	iters: 400, epoch: 5 | loss: 0.0319097
	speed: 0.0548s/iter; left time: 2444.9407s
Epoch: 5 cost time: 24.357122898101807
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1064013
	speed: 0.2537s/iter; left time: 11278.8916s
	iters: 200, epoch: 6 | loss: 0.1762198
	speed: 0.0611s/iter; left time: 2709.6785s
	iters: 300, epoch: 6 | loss: 0.0013519
	speed: 0.0604s/iter; left time: 2673.5137s
	iters: 400, epoch: 6 | loss: 0.0994745
	speed: 0.0629s/iter; left time: 2775.8976s
Epoch: 6 cost time: 29.44546627998352
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3232934
	speed: 0.2542s/iter; left time: 11183.2844s
	iters: 200, epoch: 7 | loss: 0.0320965
	speed: 0.0581s/iter; left time: 2549.4468s
	iters: 300, epoch: 7 | loss: 0.0141925
	speed: 0.0601s/iter; left time: 2630.1759s
	iters: 400, epoch: 7 | loss: 0.0060135
	speed: 0.0603s/iter; left time: 2635.0882s
Epoch: 7 cost time: 28.087969064712524
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3462899
	speed: 0.2310s/iter; left time: 10052.7450s
	iters: 200, epoch: 8 | loss: 0.0119884
	speed: 0.0600s/iter; left time: 2603.4136s
	iters: 300, epoch: 8 | loss: 0.0016026
	speed: 0.0614s/iter; left time: 2660.6746s
	iters: 400, epoch: 8 | loss: 0.0183289
	speed: 0.0623s/iter; left time: 2693.8219s
Epoch: 8 cost time: 28.981144666671753
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0953763
	speed: 0.2513s/iter; left time: 10819.4055s
	iters: 200, epoch: 9 | loss: 0.0477054
	speed: 0.0604s/iter; left time: 2593.8647s
	iters: 300, epoch: 9 | loss: 0.0060383
	speed: 0.0605s/iter; left time: 2594.1920s
	iters: 400, epoch: 9 | loss: 0.0038209
	speed: 0.0581s/iter; left time: 2485.1877s
Epoch: 9 cost time: 28.552902221679688
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0093365
	speed: 0.2608s/iter; left time: 11106.0836s
	iters: 200, epoch: 10 | loss: 0.0029663
	speed: 0.0604s/iter; left time: 2567.6022s
	iters: 300, epoch: 10 | loss: 0.1866527
	speed: 0.0567s/iter; left time: 2402.5148s
	iters: 400, epoch: 10 | loss: 0.1296991
	speed: 0.0593s/iter; left time: 2505.6958s
Epoch: 10 cost time: 28.519360303878784
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.971983 --> -0.971983).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0002769
	speed: 0.2532s/iter; left time: 10660.7043s
	iters: 200, epoch: 11 | loss: 0.3441306
	speed: 0.0567s/iter; left time: 2380.7786s
	iters: 300, epoch: 11 | loss: 0.0180513
	speed: 0.0579s/iter; left time: 2427.2665s
	iters: 400, epoch: 11 | loss: 0.3433813
	speed: 0.0598s/iter; left time: 2498.9360s
Epoch: 11 cost time: 27.894700050354004
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0067751
	speed: 0.2465s/iter; left time: 10265.6681s
	iters: 200, epoch: 12 | loss: 0.0332641
	speed: 0.0605s/iter; left time: 2512.9451s
	iters: 300, epoch: 12 | loss: 0.0223256
	speed: 0.0609s/iter; left time: 2522.2926s
	iters: 400, epoch: 12 | loss: 0.0034762
	speed: 0.0608s/iter; left time: 2514.4771s
Epoch: 12 cost time: 28.58716869354248
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.974270).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0026519
	speed: 0.2589s/iter; left time: 10659.4162s
	iters: 200, epoch: 13 | loss: 0.0011263
	speed: 0.0629s/iter; left time: 2581.5670s
	iters: 300, epoch: 13 | loss: 0.0103872
	speed: 0.0639s/iter; left time: 2616.7067s
	iters: 400, epoch: 13 | loss: 0.2722798
	speed: 0.0627s/iter; left time: 2562.3123s
Epoch: 13 cost time: 30.229730129241943
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0102510
	speed: 0.2497s/iter; left time: 10164.1597s
	iters: 200, epoch: 14 | loss: 0.0243109
	speed: 0.0602s/iter; left time: 2446.0388s
	iters: 300, epoch: 14 | loss: 0.0047816
	speed: 0.0598s/iter; left time: 2421.3327s
	iters: 400, epoch: 14 | loss: 0.0232922
	speed: 0.0618s/iter; left time: 2495.5680s
Epoch: 14 cost time: 28.600355863571167
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1345886
	speed: 0.2371s/iter; left time: 9539.7781s
	iters: 200, epoch: 15 | loss: 0.0116573
	speed: 0.0604s/iter; left time: 2423.3509s
	iters: 300, epoch: 15 | loss: 0.0017262
	speed: 0.0610s/iter; left time: 2440.3924s
	iters: 400, epoch: 15 | loss: 0.0069778
	speed: 0.0573s/iter; left time: 2287.1629s
Epoch: 15 cost time: 28.074329614639282
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0019885
	speed: 0.2414s/iter; left time: 9600.3320s
	iters: 200, epoch: 16 | loss: 0.0003202
	speed: 0.0594s/iter; left time: 2356.4106s
	iters: 300, epoch: 16 | loss: 0.0009241
	speed: 0.0594s/iter; left time: 2348.4514s
	iters: 400, epoch: 16 | loss: 0.0223280
	speed: 0.0607s/iter; left time: 2394.8574s
Epoch: 16 cost time: 28.263916730880737
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0081698
	speed: 0.2457s/iter; left time: 9657.0466s
	iters: 200, epoch: 17 | loss: 0.0017814
	speed: 0.0575s/iter; left time: 2253.8275s
	iters: 300, epoch: 17 | loss: 0.0080457
	speed: 0.0600s/iter; left time: 2344.7203s
	iters: 400, epoch: 17 | loss: 0.0065821
	speed: 0.0611s/iter; left time: 2383.7259s
Epoch: 17 cost time: 28.334407806396484
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1096889
	speed: 0.2518s/iter; left time: 9778.5819s
	iters: 200, epoch: 18 | loss: 0.0003347
	speed: 0.0598s/iter; left time: 2314.6522s
	iters: 300, epoch: 18 | loss: 0.0009150
	speed: 0.0619s/iter; left time: 2390.1139s
	iters: 400, epoch: 18 | loss: 0.0564422
	speed: 0.0611s/iter; left time: 2353.8107s
Epoch: 18 cost time: 29.0642032623291
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0774288
	speed: 0.2627s/iter; left time: 10078.5158s
	iters: 200, epoch: 19 | loss: 0.0297881
	speed: 0.0618s/iter; left time: 2363.7414s
	iters: 300, epoch: 19 | loss: 0.0011396
	speed: 0.0603s/iter; left time: 2299.1999s
	iters: 400, epoch: 19 | loss: 0.0015284
	speed: 0.0591s/iter; left time: 2250.1311s
Epoch: 19 cost time: 29.01010036468506
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0008597
	speed: 0.2689s/iter; left time: 10190.0301s
	iters: 200, epoch: 20 | loss: 0.0015158
	speed: 0.0607s/iter; left time: 2292.5622s
	iters: 300, epoch: 20 | loss: 0.0026704
	speed: 0.0604s/iter; left time: 2278.1250s
	iters: 400, epoch: 20 | loss: 0.0013535
	speed: 0.0595s/iter; left time: 2236.2921s
Epoch: 20 cost time: 29.084482192993164
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0012627
	speed: 0.2577s/iter; left time: 9643.7961s
	iters: 200, epoch: 21 | loss: 0.0006058
	speed: 0.0620s/iter; left time: 2315.0681s
	iters: 300, epoch: 21 | loss: 0.0003290
	speed: 0.0599s/iter; left time: 2229.8158s
	iters: 400, epoch: 21 | loss: 0.0159923
	speed: 0.0567s/iter; left time: 2105.7718s
Epoch: 21 cost time: 28.559529304504395
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.974270 --> -0.980274).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001309
	speed: 0.2621s/iter; left time: 9686.1120s
	iters: 200, epoch: 22 | loss: 0.0083512
	speed: 0.0585s/iter; left time: 2154.9392s
	iters: 300, epoch: 22 | loss: 0.0095254
	speed: 0.0575s/iter; left time: 2114.0892s
	iters: 400, epoch: 22 | loss: 0.0078658
	speed: 0.0568s/iter; left time: 2082.5511s
Epoch: 22 cost time: 27.875526905059814
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0529070
	speed: 0.2596s/iter; left time: 9471.7863s
	iters: 200, epoch: 23 | loss: 0.0016151
	speed: 0.0622s/iter; left time: 2263.8460s
	iters: 300, epoch: 23 | loss: 0.0183823
	speed: 0.0572s/iter; left time: 2074.4955s
	iters: 400, epoch: 23 | loss: 0.0006714
	speed: 0.0584s/iter; left time: 2113.2928s
Epoch: 23 cost time: 28.31644320487976
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0220612
	speed: 0.2577s/iter; left time: 9282.2108s
	iters: 200, epoch: 24 | loss: 0.0415007
	speed: 0.0646s/iter; left time: 2321.4072s
	iters: 300, epoch: 24 | loss: 0.0153426
	speed: 0.0629s/iter; left time: 2253.4540s
	iters: 400, epoch: 24 | loss: 0.0004988
	speed: 0.0631s/iter; left time: 2254.2209s
Epoch: 24 cost time: 29.7047598361969
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0330201
	speed: 0.2087s/iter; left time: 7418.8035s
	iters: 200, epoch: 25 | loss: 0.0038371
	speed: 0.0536s/iter; left time: 1898.3289s
	iters: 300, epoch: 25 | loss: 0.0006482
	speed: 0.0610s/iter; left time: 2155.8448s
	iters: 400, epoch: 25 | loss: 0.0457436
	speed: 0.0627s/iter; left time: 2209.1686s
Epoch: 25 cost time: 27.975143432617188
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0305957
	speed: 0.2526s/iter; left time: 8859.4718s
	iters: 200, epoch: 26 | loss: 0.0019749
	speed: 0.0640s/iter; left time: 2238.4270s
	iters: 300, epoch: 26 | loss: 0.0005362
	speed: 0.0637s/iter; left time: 2222.7171s
	iters: 400, epoch: 26 | loss: 0.0016503
	speed: 0.0608s/iter; left time: 2115.8312s
Epoch: 26 cost time: 29.890650033950806
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0004426
	speed: 0.2433s/iter; left time: 8418.2901s
	iters: 200, epoch: 27 | loss: 0.0024064
	speed: 0.0577s/iter; left time: 1992.6063s
	iters: 300, epoch: 27 | loss: 0.0001445
	speed: 0.0610s/iter; left time: 2099.7534s
	iters: 400, epoch: 27 | loss: 0.0002002
	speed: 0.0602s/iter; left time: 2064.0987s
Epoch: 27 cost time: 28.155507564544678
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0012948
	speed: 0.2391s/iter; left time: 8163.7161s
	iters: 200, epoch: 28 | loss: 0.0007188
	speed: 0.0610s/iter; left time: 2076.5458s
	iters: 300, epoch: 28 | loss: 0.1731533
	speed: 0.0632s/iter; left time: 2143.8294s
	iters: 400, epoch: 28 | loss: 0.0019807
	speed: 0.0572s/iter; left time: 1935.1869s
Epoch: 28 cost time: 28.44537854194641
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0724797
	speed: 0.2474s/iter; left time: 8328.3448s
	iters: 200, epoch: 29 | loss: 0.1143888
	speed: 0.0582s/iter; left time: 1954.7404s
	iters: 300, epoch: 29 | loss: 0.0004168
	speed: 0.0598s/iter; left time: 2002.8300s
	iters: 400, epoch: 29 | loss: 0.0044822
	speed: 0.0598s/iter; left time: 1994.0954s
Epoch: 29 cost time: 27.930911540985107
Epoch: 29, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0799928
	speed: 0.2306s/iter; left time: 7656.9940s
	iters: 200, epoch: 30 | loss: 0.0402569
	speed: 0.0586s/iter; left time: 1941.1377s
	iters: 300, epoch: 30 | loss: 0.1522821
	speed: 0.0600s/iter; left time: 1978.7806s
	iters: 400, epoch: 30 | loss: 0.0625462
	speed: 0.0562s/iter; left time: 1849.5955s
Epoch: 30 cost time: 27.64958167076111
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0219134
	speed: 0.2606s/iter; left time: 8529.7044s
	iters: 200, epoch: 31 | loss: 0.0090543
	speed: 0.0588s/iter; left time: 1919.0860s
	iters: 300, epoch: 31 | loss: 0.0047452
	speed: 0.0635s/iter; left time: 2066.8652s
	iters: 400, epoch: 31 | loss: 0.0007474
	speed: 0.0609s/iter; left time: 1975.2992s
Epoch: 31 cost time: 29.007237195968628
Epoch: 31, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 868810
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2905879
	speed: 0.0753s/iter; left time: 3524.0123s
	iters: 200, epoch: 1 | loss: 2.2977936
	speed: 0.0579s/iter; left time: 2702.3368s
	iters: 300, epoch: 1 | loss: 2.3103521
	speed: 0.0614s/iter; left time: 2859.1633s
	iters: 400, epoch: 1 | loss: 2.3069658
	speed: 0.0603s/iter; left time: 2806.3250s
Epoch: 1 cost time: 29.654699325561523
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2989972
	speed: 0.2361s/iter; left time: 10937.4750s
	iters: 200, epoch: 2 | loss: 2.3122306
	speed: 0.0631s/iter; left time: 2915.9405s
	iters: 300, epoch: 2 | loss: 2.3047652
	speed: 0.0624s/iter; left time: 2877.3170s
	iters: 400, epoch: 2 | loss: 2.3018298
	speed: 0.0601s/iter; left time: 2766.8417s
Epoch: 2 cost time: 29.22431254386902
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2935097
	speed: 0.2264s/iter; left time: 10381.1936s
	iters: 200, epoch: 3 | loss: 2.3003955
	speed: 0.0610s/iter; left time: 2792.8632s
	iters: 300, epoch: 3 | loss: 2.3047881
	speed: 0.0630s/iter; left time: 2876.7690s
	iters: 400, epoch: 3 | loss: 2.2980385
	speed: 0.0596s/iter; left time: 2714.2388s
Epoch: 3 cost time: 28.68656826019287
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3168004
	speed: 0.2498s/iter; left time: 11339.2612s
	iters: 200, epoch: 4 | loss: 2.3112721
	speed: 0.0623s/iter; left time: 2824.0033s
	iters: 300, epoch: 4 | loss: 2.3018296
	speed: 0.0578s/iter; left time: 2612.2805s
	iters: 400, epoch: 4 | loss: 2.3035860
	speed: 0.0628s/iter; left time: 2830.0611s
Epoch: 4 cost time: 28.890488386154175
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2983117
	speed: 0.2474s/iter; left time: 11114.9358s
	iters: 200, epoch: 5 | loss: 2.2971311
	speed: 0.0583s/iter; left time: 2614.5594s
	iters: 300, epoch: 5 | loss: 2.2971129
	speed: 0.0604s/iter; left time: 2700.3999s
	iters: 400, epoch: 5 | loss: 2.2894769
	speed: 0.0623s/iter; left time: 2780.3968s
Epoch: 5 cost time: 28.593767166137695
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3073027
	speed: 0.2448s/iter; left time: 10881.4010s
	iters: 200, epoch: 6 | loss: 2.3110971
	speed: 0.0629s/iter; left time: 2791.6628s
	iters: 300, epoch: 6 | loss: 2.3069530
	speed: 0.0613s/iter; left time: 2711.5577s
	iters: 400, epoch: 6 | loss: 2.3078926
	speed: 0.0615s/iter; left time: 2716.9368s
Epoch: 6 cost time: 29.163745403289795
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2965937
	speed: 0.2384s/iter; left time: 10488.1325s
	iters: 200, epoch: 7 | loss: 2.3152041
	speed: 0.0618s/iter; left time: 2711.7435s
	iters: 300, epoch: 7 | loss: 2.2856095
	speed: 0.0617s/iter; left time: 2700.6638s
	iters: 400, epoch: 7 | loss: 2.3067322
	speed: 0.0552s/iter; left time: 2413.2221s
Epoch: 7 cost time: 28.682008028030396
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3072312
	speed: 0.2485s/iter; left time: 10812.9043s
	iters: 200, epoch: 8 | loss: 2.2974679
	speed: 0.0554s/iter; left time: 2403.5435s
	iters: 300, epoch: 8 | loss: 2.3032722
	speed: 0.0579s/iter; left time: 2506.9393s
	iters: 400, epoch: 8 | loss: 2.2995174
	speed: 0.0604s/iter; left time: 2608.4751s
Epoch: 8 cost time: 27.752692461013794
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2973058
	speed: 0.2405s/iter; left time: 10352.4516s
	iters: 200, epoch: 9 | loss: 2.2789135
	speed: 0.0589s/iter; left time: 2531.3093s
	iters: 300, epoch: 9 | loss: 2.2960181
	speed: 0.0608s/iter; left time: 2604.7602s
	iters: 400, epoch: 9 | loss: 2.3105600
	speed: 0.0605s/iter; left time: 2584.8762s
Epoch: 9 cost time: 28.06576681137085
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3188601
	speed: 0.2355s/iter; left time: 10029.5330s
	iters: 200, epoch: 10 | loss: 2.3024902
	speed: 0.0639s/iter; left time: 2714.6779s
	iters: 300, epoch: 10 | loss: 2.3099027
	speed: 0.0631s/iter; left time: 2672.5030s
	iters: 400, epoch: 10 | loss: 2.2846527
	speed: 0.0621s/iter; left time: 2627.2509s
Epoch: 10 cost time: 29.69395685195923
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2975330
	speed: 0.2044s/iter; left time: 8609.1739s
	iters: 200, epoch: 11 | loss: 2.3110569
	speed: 0.0530s/iter; left time: 2225.3969s
	iters: 300, epoch: 11 | loss: 2.2919087
	speed: 0.0504s/iter; left time: 2110.4626s
	iters: 400, epoch: 11 | loss: 2.2894316
	speed: 0.0517s/iter; left time: 2160.7473s
Epoch: 11 cost time: 25.215721368789673
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2902808
	speed: 0.2402s/iter; left time: 10004.3515s
	iters: 200, epoch: 12 | loss: 2.3009245
	speed: 0.0606s/iter; left time: 2516.9306s
	iters: 300, epoch: 12 | loss: 2.3006949
	speed: 0.0613s/iter; left time: 2538.9989s
	iters: 400, epoch: 12 | loss: 2.2956085
	speed: 0.0570s/iter; left time: 2356.5054s
Epoch: 12 cost time: 28.065000295639038
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2882910
	speed: 0.2370s/iter; left time: 9758.0991s
	iters: 200, epoch: 13 | loss: 2.3214374
	speed: 0.0600s/iter; left time: 2464.1267s
	iters: 300, epoch: 13 | loss: 2.2885451
	speed: 0.0602s/iter; left time: 2468.5549s
	iters: 400, epoch: 13 | loss: 2.3323860
	speed: 0.0589s/iter; left time: 2406.7965s
Epoch: 13 cost time: 28.062410354614258
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2901733
	speed: 0.2458s/iter; left time: 10003.4663s
	iters: 200, epoch: 14 | loss: 2.2957270
	speed: 0.0605s/iter; left time: 2456.3731s
	iters: 300, epoch: 14 | loss: 2.2940545
	speed: 0.0605s/iter; left time: 2450.7134s
	iters: 400, epoch: 14 | loss: 2.2965069
	speed: 0.0597s/iter; left time: 2412.7013s
Epoch: 14 cost time: 28.431915521621704
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3132226
	speed: 0.2401s/iter; left time: 9662.0296s
	iters: 200, epoch: 15 | loss: 2.3091304
	speed: 0.0612s/iter; left time: 2454.7528s
	iters: 300, epoch: 15 | loss: 2.3062079
	speed: 0.0615s/iter; left time: 2463.7856s
	iters: 400, epoch: 15 | loss: 2.3000088
	speed: 0.0587s/iter; left time: 2344.5180s
Epoch: 15 cost time: 28.404799699783325
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3156483
	speed: 0.2478s/iter; left time: 9855.7006s
	iters: 200, epoch: 16 | loss: 2.3020473
	speed: 0.0635s/iter; left time: 2518.7050s
	iters: 300, epoch: 16 | loss: 2.3143752
	speed: 0.0622s/iter; left time: 2459.8540s
	iters: 400, epoch: 16 | loss: 2.3006516
	speed: 0.0607s/iter; left time: 2396.5562s
Epoch: 16 cost time: 29.465837240219116
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3018301
	speed: 0.2500s/iter; left time: 9824.6314s
	iters: 200, epoch: 17 | loss: 2.3066945
	speed: 0.0594s/iter; left time: 2329.9111s
	iters: 300, epoch: 17 | loss: 2.2986033
	speed: 0.0597s/iter; left time: 2333.6846s
	iters: 400, epoch: 17 | loss: 2.3088868
	speed: 0.0557s/iter; left time: 2173.2786s
Epoch: 17 cost time: 27.96266794204712
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.3001804
	speed: 0.2522s/iter; left time: 9791.5300s
	iters: 200, epoch: 18 | loss: 2.3065350
	speed: 0.0612s/iter; left time: 2368.6394s
	iters: 300, epoch: 18 | loss: 2.3032885
	speed: 0.0597s/iter; left time: 2307.9929s
	iters: 400, epoch: 18 | loss: 2.2937608
	speed: 0.0602s/iter; left time: 2319.7619s
Epoch: 18 cost time: 27.99596667289734
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.3134964
	speed: 0.2503s/iter; left time: 9601.6662s
	iters: 200, epoch: 19 | loss: 2.3075104
	speed: 0.0607s/iter; left time: 2321.0101s
	iters: 300, epoch: 19 | loss: 2.2993002
	speed: 0.0635s/iter; left time: 2422.7871s
	iters: 400, epoch: 19 | loss: 2.2986183
	speed: 0.0627s/iter; left time: 2386.0598s
Epoch: 19 cost time: 29.369306564331055
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3200419
	speed: 0.2565s/iter; left time: 9720.0079s
	iters: 200, epoch: 20 | loss: 2.2987080
	speed: 0.0552s/iter; left time: 2086.8919s
	iters: 300, epoch: 20 | loss: 2.3025267
	speed: 0.0508s/iter; left time: 1915.5365s
	iters: 400, epoch: 20 | loss: 2.3042340
	speed: 0.0510s/iter; left time: 1916.1774s
Epoch: 20 cost time: 26.217840433120728
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.3065052
	speed: 0.1812s/iter; left time: 6779.6220s
	iters: 200, epoch: 21 | loss: 2.3093369
	speed: 0.0616s/iter; left time: 2299.3540s
	iters: 300, epoch: 21 | loss: 2.2895751
	speed: 0.0585s/iter; left time: 2176.5113s
	iters: 400, epoch: 21 | loss: 2.3221297
	speed: 0.0554s/iter; left time: 2055.7723s
Epoch: 21 cost time: 28.043302536010742
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.3160233
	speed: 0.2363s/iter; left time: 8731.3321s
	iters: 200, epoch: 22 | loss: 2.3084793
	speed: 0.0568s/iter; left time: 2092.2189s
	iters: 300, epoch: 22 | loss: 2.2989244
	speed: 0.0599s/iter; left time: 2200.8002s
	iters: 400, epoch: 22 | loss: 2.3129439
	speed: 0.0608s/iter; left time: 2230.0329s
Epoch: 22 cost time: 28.25237274169922
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 868810
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2996677
	speed: 0.0759s/iter; left time: 3554.0672s
	iters: 200, epoch: 1 | loss: 0.6012238
	speed: 0.0583s/iter; left time: 2721.6971s
	iters: 300, epoch: 1 | loss: 0.6486973
	speed: 0.0536s/iter; left time: 2500.1073s
	iters: 400, epoch: 1 | loss: 0.1862441
	speed: 0.0570s/iter; left time: 2649.6793s
Epoch: 1 cost time: 28.577547311782837
Epoch: 1, Steps: 469 | Train Loss: 0.748 Vali Loss: 0.226 Vali Acc: 0.940 Test Loss: 0.226 Test Acc: 0.940
Validation loss decreased (inf --> -0.939963).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0382799
	speed: 0.2319s/iter; left time: 10742.9711s
	iters: 200, epoch: 2 | loss: 0.0619276
	speed: 0.0568s/iter; left time: 2625.1673s
	iters: 300, epoch: 2 | loss: 0.1147353
	speed: 0.0595s/iter; left time: 2744.6349s
	iters: 400, epoch: 2 | loss: 0.0703304
	speed: 0.0572s/iter; left time: 2631.3193s
Epoch: 2 cost time: 26.958085536956787
Epoch: 2, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.939963 --> -0.946253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0556775
	speed: 0.2411s/iter; left time: 11057.5607s
	iters: 200, epoch: 3 | loss: 0.0188959
	speed: 0.0608s/iter; left time: 2782.0642s
	iters: 300, epoch: 3 | loss: 0.0156634
	speed: 0.0603s/iter; left time: 2751.8425s
	iters: 400, epoch: 3 | loss: 0.0095810
	speed: 0.0548s/iter; left time: 2497.6330s
Epoch: 3 cost time: 28.090625047683716
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.946253 --> -0.949398).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0181345
	speed: 0.2286s/iter; left time: 10375.6481s
	iters: 200, epoch: 4 | loss: 0.0752936
	speed: 0.0524s/iter; left time: 2371.4489s
	iters: 300, epoch: 4 | loss: 0.0686857
	speed: 0.0524s/iter; left time: 2366.1226s
	iters: 400, epoch: 4 | loss: 0.0125030
	speed: 0.0541s/iter; left time: 2439.3839s
Epoch: 4 cost time: 25.668642282485962
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
Validation loss decreased (-0.949398 --> -0.957689).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0447977
	speed: 0.2343s/iter; left time: 10526.1690s
	iters: 200, epoch: 5 | loss: 0.0128849
	speed: 0.0543s/iter; left time: 2435.1248s
	iters: 300, epoch: 5 | loss: 0.1408438
	speed: 0.0607s/iter; left time: 2715.1338s
	iters: 400, epoch: 5 | loss: 0.0663284
	speed: 0.0574s/iter; left time: 2561.3405s
Epoch: 5 cost time: 27.262014627456665
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
Validation loss decreased (-0.957689 --> -0.965693).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0061429
	speed: 0.2384s/iter; left time: 10597.4845s
	iters: 200, epoch: 6 | loss: 0.0551337
	speed: 0.0609s/iter; left time: 2699.1810s
	iters: 300, epoch: 6 | loss: 0.0136732
	speed: 0.0579s/iter; left time: 2563.1595s
	iters: 400, epoch: 6 | loss: 0.0322129
	speed: 0.0611s/iter; left time: 2698.9673s
Epoch: 6 cost time: 28.699657440185547
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.965693 --> -0.970554).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0038318
	speed: 0.2348s/iter; left time: 10326.7507s
	iters: 200, epoch: 7 | loss: 0.0009568
	speed: 0.0624s/iter; left time: 2740.5619s
	iters: 300, epoch: 7 | loss: 0.0130235
	speed: 0.0598s/iter; left time: 2618.9045s
	iters: 400, epoch: 7 | loss: 0.0014764
	speed: 0.0583s/iter; left time: 2548.3187s
Epoch: 7 cost time: 28.365450859069824
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0098234
	speed: 0.2372s/iter; left time: 10323.2522s
	iters: 200, epoch: 8 | loss: 0.0143184
	speed: 0.0558s/iter; left time: 2422.8525s
	iters: 300, epoch: 8 | loss: 0.0099573
	speed: 0.0612s/iter; left time: 2649.3660s
	iters: 400, epoch: 8 | loss: 0.7976316
	speed: 0.0566s/iter; left time: 2445.5317s
Epoch: 8 cost time: 27.561346769332886
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0342709
	speed: 0.2146s/iter; left time: 9237.0704s
	iters: 200, epoch: 9 | loss: 0.0596212
	speed: 0.0496s/iter; left time: 2129.2155s
	iters: 300, epoch: 9 | loss: 0.0030341
	speed: 0.0512s/iter; left time: 2193.6943s
	iters: 400, epoch: 9 | loss: 0.0042472
	speed: 0.0508s/iter; left time: 2170.7126s
Epoch: 9 cost time: 24.318084716796875
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.970554 --> -0.980560).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011922
	speed: 0.2231s/iter; left time: 9500.9812s
	iters: 200, epoch: 10 | loss: 0.0016129
	speed: 0.0609s/iter; left time: 2588.7514s
	iters: 300, epoch: 10 | loss: 0.0180453
	speed: 0.0546s/iter; left time: 2313.2867s
	iters: 400, epoch: 10 | loss: 0.0662760
	speed: 0.0603s/iter; left time: 2548.5605s
Epoch: 10 cost time: 27.63892126083374
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0049059
	speed: 0.2249s/iter; left time: 9469.7724s
	iters: 200, epoch: 11 | loss: 0.0010208
	speed: 0.0573s/iter; left time: 2409.0221s
	iters: 300, epoch: 11 | loss: 0.0282645
	speed: 0.0572s/iter; left time: 2398.1279s
	iters: 400, epoch: 11 | loss: 0.0197326
	speed: 0.0534s/iter; left time: 2231.3638s
Epoch: 11 cost time: 26.69707441329956
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0055551
	speed: 0.2147s/iter; left time: 8941.4884s
	iters: 200, epoch: 12 | loss: 0.0094501
	speed: 0.0553s/iter; left time: 2298.1453s
	iters: 300, epoch: 12 | loss: 0.0287540
	speed: 0.0587s/iter; left time: 2430.6502s
	iters: 400, epoch: 12 | loss: 0.0042415
	speed: 0.0562s/iter; left time: 2325.4247s
Epoch: 12 cost time: 27.058751106262207
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011642
	speed: 0.2248s/iter; left time: 9256.0834s
	iters: 200, epoch: 13 | loss: 0.0361262
	speed: 0.0572s/iter; left time: 2348.1767s
	iters: 300, epoch: 13 | loss: 0.0407537
	speed: 0.0547s/iter; left time: 2241.3790s
	iters: 400, epoch: 13 | loss: 0.0624130
	speed: 0.0603s/iter; left time: 2462.6337s
Epoch: 13 cost time: 27.34909462928772
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2263957
	speed: 0.1869s/iter; left time: 7606.1723s
	iters: 200, epoch: 14 | loss: 0.0004663
	speed: 0.0471s/iter; left time: 1913.0205s
	iters: 300, epoch: 14 | loss: 0.0002911
	speed: 0.0496s/iter; left time: 2010.6558s
	iters: 400, epoch: 14 | loss: 0.0247930
	speed: 0.0496s/iter; left time: 2004.6453s
Epoch: 14 cost time: 23.863368272781372
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0262262
	speed: 0.2293s/iter; left time: 9227.7833s
	iters: 200, epoch: 15 | loss: 0.0304837
	speed: 0.0554s/iter; left time: 2222.8633s
	iters: 300, epoch: 15 | loss: 0.0623708
	speed: 0.0565s/iter; left time: 2260.2982s
	iters: 400, epoch: 15 | loss: 0.0005506
	speed: 0.0556s/iter; left time: 2218.7458s
Epoch: 15 cost time: 26.492308139801025
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0022983
	speed: 0.2147s/iter; left time: 8535.8775s
	iters: 200, epoch: 16 | loss: 0.0026891
	speed: 0.0556s/iter; left time: 2205.6920s
	iters: 300, epoch: 16 | loss: 0.0002075
	speed: 0.0593s/iter; left time: 2347.7823s
	iters: 400, epoch: 16 | loss: 0.0143165
	speed: 0.0571s/iter; left time: 2255.4514s
Epoch: 16 cost time: 26.80970048904419
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0014521
	speed: 0.2287s/iter; left time: 8986.9920s
	iters: 200, epoch: 17 | loss: 0.2498744
	speed: 0.0591s/iter; left time: 2316.2394s
	iters: 300, epoch: 17 | loss: 0.0086747
	speed: 0.0536s/iter; left time: 2095.0745s
	iters: 400, epoch: 17 | loss: 0.0834059
	speed: 0.0570s/iter; left time: 2220.9095s
Epoch: 17 cost time: 26.749123573303223
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0002255
	speed: 0.2206s/iter; left time: 8564.5123s
	iters: 200, epoch: 18 | loss: 0.0003580
	speed: 0.0595s/iter; left time: 2304.1441s
	iters: 300, epoch: 18 | loss: 0.0057802
	speed: 0.0563s/iter; left time: 2174.2436s
	iters: 400, epoch: 18 | loss: 0.0045599
	speed: 0.0513s/iter; left time: 1976.7896s
Epoch: 18 cost time: 25.682760000228882
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1897476
	speed: 0.1629s/iter; left time: 6249.1492s
	iters: 200, epoch: 19 | loss: 0.0055838
	speed: 0.0455s/iter; left time: 1740.7431s
	iters: 300, epoch: 19 | loss: 0.2390341
	speed: 0.0484s/iter; left time: 1846.1979s
	iters: 400, epoch: 19 | loss: 0.0022725
	speed: 0.0476s/iter; left time: 1809.7323s
Epoch: 19 cost time: 22.497135162353516
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 475594
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5836178
	speed: 0.0756s/iter; left time: 3536.3713s
	iters: 200, epoch: 1 | loss: 0.8077490
	speed: 0.0600s/iter; left time: 2799.9523s
	iters: 300, epoch: 1 | loss: 0.8733550
	speed: 0.0551s/iter; left time: 2567.5484s
	iters: 400, epoch: 1 | loss: 0.2291641
	speed: 0.0608s/iter; left time: 2828.7663s
Epoch: 1 cost time: 29.475707530975342
Epoch: 1, Steps: 469 | Train Loss: 0.872 Vali Loss: 0.311 Vali Acc: 0.923 Test Loss: 0.311 Test Acc: 0.923
Validation loss decreased (inf --> -0.922810).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0548430
	speed: 0.2347s/iter; left time: 10872.8556s
	iters: 200, epoch: 2 | loss: 0.1186960
	speed: 0.0597s/iter; left time: 2759.5826s
	iters: 300, epoch: 2 | loss: 0.1607363
	speed: 0.0552s/iter; left time: 2544.3648s
	iters: 400, epoch: 2 | loss: 0.1399694
	speed: 0.0628s/iter; left time: 2891.4422s
Epoch: 2 cost time: 27.873591423034668
Epoch: 2, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.208 Vali Acc: 0.936 Test Loss: 0.208 Test Acc: 0.936
Validation loss decreased (-0.922810 --> -0.936247).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0466456
	speed: 0.2253s/iter; left time: 10331.0908s
	iters: 200, epoch: 3 | loss: 0.0379415
	speed: 0.0583s/iter; left time: 2665.8105s
	iters: 300, epoch: 3 | loss: 0.0186872
	speed: 0.0561s/iter; left time: 2563.5607s
	iters: 400, epoch: 3 | loss: 0.0524043
	speed: 0.0555s/iter; left time: 2527.5087s
Epoch: 3 cost time: 26.580472469329834
Epoch: 3, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
Validation loss decreased (-0.936247 --> -0.942537).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0222445
	speed: 0.2332s/iter; left time: 10583.7940s
	iters: 200, epoch: 4 | loss: 0.0423075
	speed: 0.0635s/iter; left time: 2877.3841s
	iters: 300, epoch: 4 | loss: 0.0232064
	speed: 0.0592s/iter; left time: 2674.0368s
	iters: 400, epoch: 4 | loss: 0.0300106
	speed: 0.0557s/iter; left time: 2509.6758s
Epoch: 4 cost time: 27.709599018096924
Epoch: 4, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.942537 --> -0.959118).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0147672
	speed: 0.1956s/iter; left time: 8787.4718s
	iters: 200, epoch: 5 | loss: 0.0179906
	speed: 0.0632s/iter; left time: 2830.9928s
	iters: 300, epoch: 5 | loss: 0.0067936
	speed: 0.0628s/iter; left time: 2810.3702s
	iters: 400, epoch: 5 | loss: 0.0533529
	speed: 0.0633s/iter; left time: 2824.2172s
Epoch: 5 cost time: 29.565630435943604
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
Validation loss decreased (-0.959118 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0221116
	speed: 0.2544s/iter; left time: 11308.9745s
	iters: 200, epoch: 6 | loss: 0.1160301
	speed: 0.0629s/iter; left time: 2789.9609s
	iters: 300, epoch: 6 | loss: 0.0111042
	speed: 0.0614s/iter; left time: 2715.4597s
	iters: 400, epoch: 6 | loss: 0.0034201
	speed: 0.0584s/iter; left time: 2578.3045s
Epoch: 6 cost time: 28.784789085388184
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.963406 --> -0.970554).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0020923
	speed: 0.2428s/iter; left time: 10680.4157s
	iters: 200, epoch: 7 | loss: 0.0028309
	speed: 0.0575s/iter; left time: 2522.6158s
	iters: 300, epoch: 7 | loss: 0.0022190
	speed: 0.0590s/iter; left time: 2583.1160s
	iters: 400, epoch: 7 | loss: 0.0224929
	speed: 0.0607s/iter; left time: 2652.9639s
Epoch: 7 cost time: 28.035860538482666
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.970554 --> -0.971411).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0135409
	speed: 0.2507s/iter; left time: 10909.5464s
	iters: 200, epoch: 8 | loss: 0.0285232
	speed: 0.0620s/iter; left time: 2690.3510s
	iters: 300, epoch: 8 | loss: 0.0034486
	speed: 0.0597s/iter; left time: 2587.8803s
	iters: 400, epoch: 8 | loss: 0.8533130
	speed: 0.0606s/iter; left time: 2618.5658s
Epoch: 8 cost time: 28.79854679107666
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0129394
	speed: 0.2503s/iter; left time: 10773.9556s
	iters: 200, epoch: 9 | loss: 0.0257126
	speed: 0.0628s/iter; left time: 2697.4306s
	iters: 300, epoch: 9 | loss: 0.0144081
	speed: 0.0596s/iter; left time: 2554.6184s
	iters: 400, epoch: 9 | loss: 0.0422490
	speed: 0.0576s/iter; left time: 2462.9488s
Epoch: 9 cost time: 28.492603540420532
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.971411 --> -0.974270).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011036
	speed: 0.2356s/iter; left time: 10030.4261s
	iters: 200, epoch: 10 | loss: 0.0032871
	speed: 0.0587s/iter; left time: 2492.6614s
	iters: 300, epoch: 10 | loss: 0.0177638
	speed: 0.0590s/iter; left time: 2501.1133s
	iters: 400, epoch: 10 | loss: 0.0395241
	speed: 0.0589s/iter; left time: 2490.5514s
Epoch: 10 cost time: 27.480743885040283
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0088729
	speed: 0.2388s/iter; left time: 10056.6529s
	iters: 200, epoch: 11 | loss: 0.0024541
	speed: 0.0604s/iter; left time: 2535.3863s
	iters: 300, epoch: 11 | loss: 0.0098932
	speed: 0.0608s/iter; left time: 2546.2614s
	iters: 400, epoch: 11 | loss: 0.1624845
	speed: 0.0620s/iter; left time: 2592.5543s
Epoch: 11 cost time: 28.773789882659912
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0059662
	speed: 0.2437s/iter; left time: 10147.8682s
	iters: 200, epoch: 12 | loss: 0.0468070
	speed: 0.0608s/iter; left time: 2525.3147s
	iters: 300, epoch: 12 | loss: 0.0005538
	speed: 0.0612s/iter; left time: 2538.3052s
	iters: 400, epoch: 12 | loss: 0.0029151
	speed: 0.0629s/iter; left time: 2602.1442s
Epoch: 12 cost time: 29.26475167274475
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0198932
	speed: 0.2433s/iter; left time: 10017.0112s
	iters: 200, epoch: 13 | loss: 0.0055957
	speed: 0.0603s/iter; left time: 2476.9745s
	iters: 300, epoch: 13 | loss: 0.0756288
	speed: 0.0612s/iter; left time: 2507.3182s
	iters: 400, epoch: 13 | loss: 0.0241651
	speed: 0.0597s/iter; left time: 2438.1705s
Epoch: 13 cost time: 28.258097648620605
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0270051
	speed: 0.2465s/iter; left time: 10034.5444s
	iters: 200, epoch: 14 | loss: 0.0022627
	speed: 0.0594s/iter; left time: 2411.8265s
	iters: 300, epoch: 14 | loss: 0.0016999
	speed: 0.0608s/iter; left time: 2463.4570s
	iters: 400, epoch: 14 | loss: 0.0573730
	speed: 0.0608s/iter; left time: 2458.3897s
Epoch: 14 cost time: 28.42650556564331
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0702084
	speed: 0.2566s/iter; left time: 10324.6408s
	iters: 200, epoch: 15 | loss: 0.1932945
	speed: 0.0635s/iter; left time: 2546.7477s
	iters: 300, epoch: 15 | loss: 0.0985923
	speed: 0.0614s/iter; left time: 2457.3304s
	iters: 400, epoch: 15 | loss: 0.0003958
	speed: 0.0591s/iter; left time: 2358.1887s
Epoch: 15 cost time: 29.17244529724121
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0030126
	speed: 0.2569s/iter; left time: 10217.4036s
	iters: 200, epoch: 16 | loss: 0.0301206
	speed: 0.0612s/iter; left time: 2425.9886s
	iters: 300, epoch: 16 | loss: 0.0144671
	speed: 0.0604s/iter; left time: 2391.0607s
	iters: 400, epoch: 16 | loss: 0.0330739
	speed: 0.0614s/iter; left time: 2422.7647s
Epoch: 16 cost time: 29.05165696144104
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0014270
	speed: 0.2438s/iter; left time: 9581.1116s
	iters: 200, epoch: 17 | loss: 0.0364104
	speed: 0.0613s/iter; left time: 2403.8285s
	iters: 300, epoch: 17 | loss: 0.0088965
	speed: 0.0627s/iter; left time: 2450.0889s
	iters: 400, epoch: 17 | loss: 0.0807449
	speed: 0.0643s/iter; left time: 2506.9223s
Epoch: 17 cost time: 29.517020225524902
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0037113
	speed: 0.2491s/iter; left time: 9673.1148s
	iters: 200, epoch: 18 | loss: 0.0011703
	speed: 0.0596s/iter; left time: 2307.8268s
	iters: 300, epoch: 18 | loss: 0.0513870
	speed: 0.0630s/iter; left time: 2433.4293s
	iters: 400, epoch: 18 | loss: 0.0346727
	speed: 0.0636s/iter; left time: 2448.4977s
Epoch: 18 cost time: 29.40600061416626
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0022128
	speed: 0.2660s/iter; left time: 10205.3250s
	iters: 200, epoch: 19 | loss: 0.0215667
	speed: 0.0607s/iter; left time: 2323.2903s
	iters: 300, epoch: 19 | loss: 0.1065489
	speed: 0.0651s/iter; left time: 2483.2206s
	iters: 400, epoch: 19 | loss: 0.0530714
	speed: 0.0648s/iter; left time: 2466.0284s
Epoch: 19 cost time: 29.923020362854004
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976843).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0030285
	speed: 0.2611s/iter; left time: 9891.3303s
	iters: 200, epoch: 20 | loss: 0.0146072
	speed: 0.0618s/iter; left time: 2335.0537s
	iters: 300, epoch: 20 | loss: 0.0882298
	speed: 0.0573s/iter; left time: 2161.1713s
	iters: 400, epoch: 20 | loss: 0.0033314
	speed: 0.0580s/iter; left time: 2182.0671s
Epoch: 20 cost time: 28.14055871963501
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0042851
	speed: 0.1924s/iter; left time: 7200.0878s
	iters: 200, epoch: 21 | loss: 0.0020876
	speed: 0.0500s/iter; left time: 1867.4029s
	iters: 300, epoch: 21 | loss: 0.0007552
	speed: 0.0538s/iter; left time: 2001.9885s
	iters: 400, epoch: 21 | loss: 0.0002460
	speed: 0.0626s/iter; left time: 2323.3410s
Epoch: 21 cost time: 26.294426679611206
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
Validation loss decreased (-0.976843 --> -0.981989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0122443
	speed: 0.2578s/iter; left time: 9525.5196s
	iters: 200, epoch: 22 | loss: 0.0091722
	speed: 0.0584s/iter; left time: 2153.9871s
	iters: 300, epoch: 22 | loss: 0.0020295
	speed: 0.0609s/iter; left time: 2238.8333s
	iters: 400, epoch: 22 | loss: 0.2210491
	speed: 0.0617s/iter; left time: 2260.6415s
Epoch: 22 cost time: 28.529364585876465
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2778955
	speed: 0.2527s/iter; left time: 9218.8464s
	iters: 200, epoch: 23 | loss: 0.0019525
	speed: 0.0574s/iter; left time: 2088.0402s
	iters: 300, epoch: 23 | loss: 0.0549707
	speed: 0.0573s/iter; left time: 2080.6650s
	iters: 400, epoch: 23 | loss: 0.0006032
	speed: 0.0611s/iter; left time: 2210.6757s
Epoch: 23 cost time: 28.105769395828247
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0080745
	speed: 0.2472s/iter; left time: 8903.4900s
	iters: 200, epoch: 24 | loss: 0.0049031
	speed: 0.0585s/iter; left time: 2100.0283s
	iters: 300, epoch: 24 | loss: 0.0089023
	speed: 0.0598s/iter; left time: 2143.3192s
	iters: 400, epoch: 24 | loss: 0.0100888
	speed: 0.0632s/iter; left time: 2256.9465s
Epoch: 24 cost time: 28.4601993560791
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0025517
	speed: 0.2458s/iter; left time: 8737.6242s
	iters: 200, epoch: 25 | loss: 0.0004689
	speed: 0.0579s/iter; left time: 2051.8891s
	iters: 300, epoch: 25 | loss: 0.0088957
	speed: 0.0620s/iter; left time: 2192.5612s
	iters: 400, epoch: 25 | loss: 0.1339329
	speed: 0.0625s/iter; left time: 2202.2097s
Epoch: 25 cost time: 28.262590885162354
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0084356
	speed: 0.2545s/iter; left time: 8928.5867s
	iters: 200, epoch: 26 | loss: 0.0001795
	speed: 0.0598s/iter; left time: 2091.6300s
	iters: 300, epoch: 26 | loss: 0.0215119
	speed: 0.0605s/iter; left time: 2111.6755s
	iters: 400, epoch: 26 | loss: 0.0026415
	speed: 0.0621s/iter; left time: 2160.6700s
Epoch: 26 cost time: 28.721790313720703
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0004031
	speed: 0.2439s/iter; left time: 8439.3499s
	iters: 200, epoch: 27 | loss: 0.0262615
	speed: 0.0578s/iter; left time: 1994.7170s
	iters: 300, epoch: 27 | loss: 0.0025978
	speed: 0.0624s/iter; left time: 2146.7692s
	iters: 400, epoch: 27 | loss: 0.0035901
	speed: 0.0603s/iter; left time: 2069.5246s
Epoch: 27 cost time: 28.51439118385315
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0030188
	speed: 0.2546s/iter; left time: 8689.8450s
	iters: 200, epoch: 28 | loss: 0.0033973
	speed: 0.0614s/iter; left time: 2090.0972s
	iters: 300, epoch: 28 | loss: 0.0005262
	speed: 0.0606s/iter; left time: 2057.5565s
	iters: 400, epoch: 28 | loss: 0.0002175
	speed: 0.0630s/iter; left time: 2133.4747s
Epoch: 28 cost time: 29.06466317176819
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0610539
	speed: 0.2529s/iter; left time: 8516.3004s
	iters: 200, epoch: 29 | loss: 0.0006063
	speed: 0.0592s/iter; left time: 1987.1652s
	iters: 300, epoch: 29 | loss: 0.0046360
	speed: 0.0633s/iter; left time: 2117.9209s
	iters: 400, epoch: 29 | loss: 0.1560636
	speed: 0.0631s/iter; left time: 2105.2040s
Epoch: 29 cost time: 29.007834911346436
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0108232
	speed: 0.2515s/iter; left time: 8348.2906s
	iters: 200, epoch: 30 | loss: 0.0520564
	speed: 0.0597s/iter; left time: 1975.9032s
	iters: 300, epoch: 30 | loss: 0.0003041
	speed: 0.0598s/iter; left time: 1974.5735s
	iters: 400, epoch: 30 | loss: 0.0095804
	speed: 0.0601s/iter; left time: 1977.5427s
Epoch: 30 cost time: 28.51490569114685
Epoch: 30, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0013946
	speed: 0.2568s/iter; left time: 8404.5099s
	iters: 200, epoch: 31 | loss: 0.0111264
	speed: 0.0589s/iter; left time: 1922.3836s
	iters: 300, epoch: 31 | loss: 0.2427905
	speed: 0.0601s/iter; left time: 1954.5965s
	iters: 400, epoch: 31 | loss: 0.0125307
	speed: 0.0620s/iter; left time: 2011.5236s
Epoch: 31 cost time: 28.694034576416016
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 475594
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4087586
	speed: 0.0762s/iter; left time: 3566.7926s
	iters: 200, epoch: 1 | loss: 0.6567343
	speed: 0.0606s/iter; left time: 2832.2013s
	iters: 300, epoch: 1 | loss: 0.8087878
	speed: 0.0626s/iter; left time: 2916.4920s
	iters: 400, epoch: 1 | loss: 0.1536506
	speed: 0.0595s/iter; left time: 2767.0274s
Epoch: 1 cost time: 30.192610025405884
Epoch: 1, Steps: 469 | Train Loss: 0.817 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (inf --> -0.927670).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0593714
	speed: 0.2444s/iter; left time: 11324.7844s
	iters: 200, epoch: 2 | loss: 0.0619000
	speed: 0.0629s/iter; left time: 2906.7417s
	iters: 300, epoch: 2 | loss: 0.0726709
	speed: 0.0640s/iter; left time: 2952.4072s
	iters: 400, epoch: 2 | loss: 0.1007604
	speed: 0.0617s/iter; left time: 2842.2738s
Epoch: 2 cost time: 29.22017741203308
Epoch: 2, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.927670 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0288087
	speed: 0.2551s/iter; left time: 11698.6804s
	iters: 200, epoch: 3 | loss: 0.0124916
	speed: 0.0627s/iter; left time: 2868.3945s
	iters: 300, epoch: 3 | loss: 0.0515154
	speed: 0.0619s/iter; left time: 2825.2403s
	iters: 400, epoch: 3 | loss: 0.0251011
	speed: 0.0650s/iter; left time: 2963.0094s
Epoch: 3 cost time: 29.40030527114868
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.953114 --> -0.967695).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0594299
	speed: 0.2585s/iter; left time: 11735.8617s
	iters: 200, epoch: 4 | loss: 0.0218739
	speed: 0.0598s/iter; left time: 2708.2475s
	iters: 300, epoch: 4 | loss: 0.0391202
	speed: 0.0572s/iter; left time: 2585.8944s
	iters: 400, epoch: 4 | loss: 0.0104179
	speed: 0.0589s/iter; left time: 2654.0450s
Epoch: 4 cost time: 28.430440425872803
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0136746
	speed: 0.2495s/iter; left time: 11208.3065s
	iters: 200, epoch: 5 | loss: 0.0087254
	speed: 0.0601s/iter; left time: 2694.5282s
	iters: 300, epoch: 5 | loss: 0.0223849
	speed: 0.0601s/iter; left time: 2686.4085s
	iters: 400, epoch: 5 | loss: 0.0778962
	speed: 0.0595s/iter; left time: 2653.1843s
Epoch: 5 cost time: 28.118757009506226
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0123000
	speed: 0.2521s/iter; left time: 11206.8007s
	iters: 200, epoch: 6 | loss: 0.0697740
	speed: 0.0615s/iter; left time: 2727.1319s
	iters: 300, epoch: 6 | loss: 0.0064708
	speed: 0.0622s/iter; left time: 2754.6558s
	iters: 400, epoch: 6 | loss: 0.0152916
	speed: 0.0640s/iter; left time: 2825.6032s
Epoch: 6 cost time: 29.121694326400757
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.967695 --> -0.969982).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0071730
	speed: 0.2044s/iter; left time: 8989.4944s
	iters: 200, epoch: 7 | loss: 0.0141595
	speed: 0.0478s/iter; left time: 2098.6564s
	iters: 300, epoch: 7 | loss: 0.0037622
	speed: 0.0503s/iter; left time: 2201.3875s
	iters: 400, epoch: 7 | loss: 0.0181438
	speed: 0.0522s/iter; left time: 2279.7273s
Epoch: 7 cost time: 24.690002918243408
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.969982 --> -0.970554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0042810
	speed: 0.2449s/iter; left time: 10656.7796s
	iters: 200, epoch: 8 | loss: 0.1267771
	speed: 0.0565s/iter; left time: 2452.6211s
	iters: 300, epoch: 8 | loss: 0.0049520
	speed: 0.0555s/iter; left time: 2404.4934s
	iters: 400, epoch: 8 | loss: 0.5366758
	speed: 0.0594s/iter; left time: 2569.1701s
Epoch: 8 cost time: 27.771230459213257
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.961 Test Loss: 0.225 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0469821
	speed: 0.2378s/iter; left time: 10238.7253s
	iters: 200, epoch: 9 | loss: 0.0586630
	speed: 0.0653s/iter; left time: 2804.2179s
	iters: 300, epoch: 9 | loss: 0.0043223
	speed: 0.0614s/iter; left time: 2629.9940s
	iters: 400, epoch: 9 | loss: 0.0056399
	speed: 0.0618s/iter; left time: 2640.8996s
Epoch: 9 cost time: 29.443137407302856
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0153884
	speed: 0.2515s/iter; left time: 10709.8819s
	iters: 200, epoch: 10 | loss: 0.0113699
	speed: 0.0643s/iter; left time: 2730.4630s
	iters: 300, epoch: 10 | loss: 0.0052499
	speed: 0.0623s/iter; left time: 2640.0643s
	iters: 400, epoch: 10 | loss: 0.0072216
	speed: 0.0587s/iter; left time: 2481.8445s
Epoch: 10 cost time: 29.407633781433105
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0020802
	speed: 0.2614s/iter; left time: 11009.8941s
	iters: 200, epoch: 11 | loss: 0.0022662
	speed: 0.0632s/iter; left time: 2656.9634s
	iters: 300, epoch: 11 | loss: 0.1148617
	speed: 0.0615s/iter; left time: 2576.4831s
	iters: 400, epoch: 11 | loss: 0.0731036
	speed: 0.0629s/iter; left time: 2630.3491s
Epoch: 11 cost time: 29.52634906768799
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0055083
	speed: 0.2378s/iter; left time: 9903.7165s
	iters: 200, epoch: 12 | loss: 0.0167412
	speed: 0.0621s/iter; left time: 2579.3547s
	iters: 300, epoch: 12 | loss: 0.0023099
	speed: 0.0594s/iter; left time: 2462.2997s
	iters: 400, epoch: 12 | loss: 0.0014688
	speed: 0.0621s/iter; left time: 2565.6631s
Epoch: 12 cost time: 28.824876070022583
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.974270).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0069432
	speed: 0.2436s/iter; left time: 10028.8999s
	iters: 200, epoch: 13 | loss: 0.0008298
	speed: 0.0613s/iter; left time: 2516.2453s
	iters: 300, epoch: 13 | loss: 0.0018576
	speed: 0.0610s/iter; left time: 2499.0167s
	iters: 400, epoch: 13 | loss: 0.0104633
	speed: 0.0596s/iter; left time: 2435.0300s
Epoch: 13 cost time: 28.7581889629364
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0045151
	speed: 0.2429s/iter; left time: 9885.5554s
	iters: 200, epoch: 14 | loss: 0.0291065
	speed: 0.0608s/iter; left time: 2469.6282s
	iters: 300, epoch: 14 | loss: 0.0005111
	speed: 0.0579s/iter; left time: 2343.6739s
	iters: 400, epoch: 14 | loss: 0.0069965
	speed: 0.0586s/iter; left time: 2368.4727s
Epoch: 14 cost time: 28.165987014770508
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975985).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002842
	speed: 0.2484s/iter; left time: 9995.5830s
	iters: 200, epoch: 15 | loss: 0.0264517
	speed: 0.0598s/iter; left time: 2399.1383s
	iters: 300, epoch: 15 | loss: 0.0009328
	speed: 0.0592s/iter; left time: 2368.2827s
	iters: 400, epoch: 15 | loss: 0.0007762
	speed: 0.0568s/iter; left time: 2269.3279s
Epoch: 15 cost time: 28.218282222747803
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0064176
	speed: 0.2668s/iter; left time: 10608.8523s
	iters: 200, epoch: 16 | loss: 0.0366512
	speed: 0.0609s/iter; left time: 2417.2785s
	iters: 300, epoch: 16 | loss: 0.0146472
	speed: 0.0566s/iter; left time: 2239.2716s
	iters: 400, epoch: 16 | loss: 0.0021396
	speed: 0.0584s/iter; left time: 2303.0875s
Epoch: 16 cost time: 28.599024057388306
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0009072
	speed: 0.2561s/iter; left time: 10062.6658s
	iters: 200, epoch: 17 | loss: 0.1779279
	speed: 0.0595s/iter; left time: 2332.9594s
	iters: 300, epoch: 17 | loss: 0.0036882
	speed: 0.0556s/iter; left time: 2173.8643s
	iters: 400, epoch: 17 | loss: 0.0003961
	speed: 0.0593s/iter; left time: 2310.7393s
Epoch: 17 cost time: 28.124993324279785
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0055270
	speed: 0.2619s/iter; left time: 10167.8667s
	iters: 200, epoch: 18 | loss: 0.0023755
	speed: 0.0553s/iter; left time: 2140.9156s
	iters: 300, epoch: 18 | loss: 0.0015230
	speed: 0.0562s/iter; left time: 2170.7157s
	iters: 400, epoch: 18 | loss: 0.0106059
	speed: 0.0608s/iter; left time: 2342.1252s
Epoch: 18 cost time: 27.863069772720337
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.979130).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0004956
	speed: 0.2471s/iter; left time: 9479.1693s
	iters: 200, epoch: 19 | loss: 0.0286677
	speed: 0.0556s/iter; left time: 2129.0949s
	iters: 300, epoch: 19 | loss: 0.0547053
	speed: 0.0548s/iter; left time: 2092.3166s
	iters: 400, epoch: 19 | loss: 0.0014268
	speed: 0.0520s/iter; left time: 1978.8305s
Epoch: 19 cost time: 26.00471305847168
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0041586
	speed: 0.1737s/iter; left time: 6582.0154s
	iters: 200, epoch: 20 | loss: 0.0417859
	speed: 0.0585s/iter; left time: 2209.0900s
	iters: 300, epoch: 20 | loss: 0.0129208
	speed: 0.0605s/iter; left time: 2279.3592s
	iters: 400, epoch: 20 | loss: 0.0033700
	speed: 0.0584s/iter; left time: 2195.3439s
Epoch: 20 cost time: 26.882585763931274
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0103588
	speed: 0.2274s/iter; left time: 8510.7804s
	iters: 200, epoch: 21 | loss: 0.0062933
	speed: 0.0608s/iter; left time: 2268.5177s
	iters: 300, epoch: 21 | loss: 0.1130593
	speed: 0.0605s/iter; left time: 2252.3074s
	iters: 400, epoch: 21 | loss: 0.0027648
	speed: 0.0573s/iter; left time: 2125.2710s
Epoch: 21 cost time: 28.460397005081177
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0018061
	speed: 0.2465s/iter; left time: 9109.6023s
	iters: 200, epoch: 22 | loss: 0.0013763
	speed: 0.0612s/iter; left time: 2256.0038s
	iters: 300, epoch: 22 | loss: 0.0050876
	speed: 0.0597s/iter; left time: 2192.6695s
	iters: 400, epoch: 22 | loss: 0.0012851
	speed: 0.0593s/iter; left time: 2175.2278s
Epoch: 22 cost time: 27.976097106933594
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0098104
	speed: 0.2409s/iter; left time: 8790.0949s
	iters: 200, epoch: 23 | loss: 0.0008757
	speed: 0.0553s/iter; left time: 2012.4225s
	iters: 300, epoch: 23 | loss: 0.0011999
	speed: 0.0586s/iter; left time: 2125.3725s
	iters: 400, epoch: 23 | loss: 0.0076597
	speed: 0.0565s/iter; left time: 2044.2329s
Epoch: 23 cost time: 27.430469512939453
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0042072
	speed: 0.2279s/iter; left time: 8207.2878s
	iters: 200, epoch: 24 | loss: 0.0061621
	speed: 0.0606s/iter; left time: 2178.1129s
	iters: 300, epoch: 24 | loss: 0.0013537
	speed: 0.0561s/iter; left time: 2008.9539s
	iters: 400, epoch: 24 | loss: 0.0001584
	speed: 0.0588s/iter; left time: 2099.2780s
Epoch: 24 cost time: 28.24785304069519
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0071269
	speed: 0.2529s/iter; left time: 8987.9508s
	iters: 200, epoch: 25 | loss: 0.2415855
	speed: 0.0619s/iter; left time: 2194.2885s
	iters: 300, epoch: 25 | loss: 0.0047696
	speed: 0.0643s/iter; left time: 2273.5779s
	iters: 400, epoch: 25 | loss: 0.0904878
	speed: 0.0627s/iter; left time: 2210.8253s
Epoch: 25 cost time: 29.529822826385498
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0017545
	speed: 0.2490s/iter; left time: 8733.4067s
	iters: 200, epoch: 26 | loss: 0.0011339
	speed: 0.0608s/iter; left time: 2126.0151s
	iters: 300, epoch: 26 | loss: 0.0289775
	speed: 0.0583s/iter; left time: 2031.9989s
	iters: 400, epoch: 26 | loss: 0.0535748
	speed: 0.0610s/iter; left time: 2120.8632s
Epoch: 26 cost time: 28.791497707366943
Epoch: 26, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0001625
	speed: 0.2305s/iter; left time: 7977.6434s
	iters: 200, epoch: 27 | loss: 0.1466184
	speed: 0.0578s/iter; left time: 1993.8883s
	iters: 300, epoch: 27 | loss: 0.0001277
	speed: 0.0595s/iter; left time: 2046.5644s
	iters: 400, epoch: 27 | loss: 0.0121179
	speed: 0.0577s/iter; left time: 1980.2792s
Epoch: 27 cost time: 27.272197008132935
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0206522
	speed: 0.2040s/iter; left time: 6964.3991s
	iters: 200, epoch: 28 | loss: 0.0389425
	speed: 0.0531s/iter; left time: 1808.1620s
	iters: 300, epoch: 28 | loss: 0.0043931
	speed: 0.0505s/iter; left time: 1712.9925s
	iters: 400, epoch: 28 | loss: 0.0014614
	speed: 0.0527s/iter; left time: 1784.2166s
Epoch: 28 cost time: 24.66476535797119
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.971 Test Loss: 0.189 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 475594
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3124323
	speed: 0.0784s/iter; left time: 3668.8174s
	iters: 200, epoch: 1 | loss: 2.2989228
	speed: 0.0585s/iter; left time: 2732.9698s
	iters: 300, epoch: 1 | loss: 2.3098931
	speed: 0.0627s/iter; left time: 2920.3478s
	iters: 400, epoch: 1 | loss: 2.3039751
	speed: 0.0633s/iter; left time: 2942.9256s
Epoch: 1 cost time: 30.251084804534912
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3018665
	speed: 0.2376s/iter; left time: 11009.3830s
	iters: 200, epoch: 2 | loss: 2.3016577
	speed: 0.0584s/iter; left time: 2700.3383s
	iters: 300, epoch: 2 | loss: 2.3018847
	speed: 0.0602s/iter; left time: 2776.7933s
	iters: 400, epoch: 2 | loss: 2.3049095
	speed: 0.0554s/iter; left time: 2550.7831s
Epoch: 2 cost time: 27.59882879257202
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3012934
	speed: 0.2367s/iter; left time: 10857.7000s
	iters: 200, epoch: 3 | loss: 2.3024461
	speed: 0.0608s/iter; left time: 2781.4757s
	iters: 300, epoch: 3 | loss: 2.3055341
	speed: 0.0622s/iter; left time: 2839.5815s
	iters: 400, epoch: 3 | loss: 2.2988336
	speed: 0.0554s/iter; left time: 2524.1650s
Epoch: 3 cost time: 28.32819390296936
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2991738
	speed: 0.2456s/iter; left time: 11149.3302s
	iters: 200, epoch: 4 | loss: 2.3082614
	speed: 0.0621s/iter; left time: 2814.4817s
	iters: 300, epoch: 4 | loss: 2.3118906
	speed: 0.0612s/iter; left time: 2767.2704s
	iters: 400, epoch: 4 | loss: 2.2862849
	speed: 0.0598s/iter; left time: 2695.1614s
Epoch: 4 cost time: 29.112279653549194
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2996690
	speed: 0.2533s/iter; left time: 11378.4703s
	iters: 200, epoch: 5 | loss: 2.3005915
	speed: 0.0628s/iter; left time: 2816.8029s
	iters: 300, epoch: 5 | loss: 2.2842200
	speed: 0.0629s/iter; left time: 2815.2657s
	iters: 400, epoch: 5 | loss: 2.2990413
	speed: 0.0605s/iter; left time: 2701.1121s
Epoch: 5 cost time: 29.844866275787354
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3049994
	speed: 0.2374s/iter; left time: 10553.7580s
	iters: 200, epoch: 6 | loss: 2.2965629
	speed: 0.0616s/iter; left time: 2733.7974s
	iters: 300, epoch: 6 | loss: 2.2904954
	speed: 0.0551s/iter; left time: 2437.6328s
	iters: 400, epoch: 6 | loss: 2.2919369
	speed: 0.0585s/iter; left time: 2585.1160s
Epoch: 6 cost time: 28.471585988998413
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2988863
	speed: 0.2389s/iter; left time: 10507.7583s
	iters: 200, epoch: 7 | loss: 2.3010867
	speed: 0.0631s/iter; left time: 2768.4069s
	iters: 300, epoch: 7 | loss: 2.3077216
	speed: 0.0595s/iter; left time: 2606.9656s
	iters: 400, epoch: 7 | loss: 2.3096125
	speed: 0.0588s/iter; left time: 2568.2427s
Epoch: 7 cost time: 29.44815683364868
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3071249
	speed: 0.2484s/iter; left time: 10807.7135s
	iters: 200, epoch: 8 | loss: 2.2964132
	speed: 0.0657s/iter; left time: 2853.3098s
	iters: 300, epoch: 8 | loss: 2.3075440
	speed: 0.0641s/iter; left time: 2775.8440s
	iters: 400, epoch: 8 | loss: 2.2952490
	speed: 0.0591s/iter; left time: 2553.6298s
Epoch: 8 cost time: 29.8360595703125
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2978098
	speed: 0.2396s/iter; left time: 10312.6728s
	iters: 200, epoch: 9 | loss: 2.3022692
	speed: 0.0603s/iter; left time: 2588.1027s
	iters: 300, epoch: 9 | loss: 2.3034325
	speed: 0.0605s/iter; left time: 2590.6696s
	iters: 400, epoch: 9 | loss: 2.3044469
	speed: 0.0549s/iter; left time: 2346.4151s
Epoch: 9 cost time: 27.24373459815979
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2830787
	speed: 0.1883s/iter; left time: 8016.3009s
	iters: 200, epoch: 10 | loss: 2.2836022
	speed: 0.0450s/iter; left time: 1912.8234s
	iters: 300, epoch: 10 | loss: 2.3166091
	speed: 0.0512s/iter; left time: 2169.5023s
	iters: 400, epoch: 10 | loss: 2.3168316
	speed: 0.0502s/iter; left time: 2122.6277s
Epoch: 10 cost time: 24.362534284591675
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2965729
	speed: 0.2380s/iter; left time: 10022.5416s
	iters: 200, epoch: 11 | loss: 2.3267503
	speed: 0.0595s/iter; left time: 2500.8386s
	iters: 300, epoch: 11 | loss: 2.3038669
	speed: 0.0573s/iter; left time: 2402.2874s
	iters: 400, epoch: 11 | loss: 2.3039644
	speed: 0.0604s/iter; left time: 2523.4580s
Epoch: 11 cost time: 28.35516047477722
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3057401
	speed: 0.2370s/iter; left time: 9869.0289s
	iters: 200, epoch: 12 | loss: 2.3094678
	speed: 0.0607s/iter; left time: 2520.8516s
	iters: 300, epoch: 12 | loss: 2.2991064
	speed: 0.0621s/iter; left time: 2574.4734s
	iters: 400, epoch: 12 | loss: 2.3029854
	speed: 0.0610s/iter; left time: 2521.6497s
Epoch: 12 cost time: 28.907686710357666
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.3031840
	speed: 0.2313s/iter; left time: 9522.7080s
	iters: 200, epoch: 13 | loss: 2.3033881
	speed: 0.0557s/iter; left time: 2288.4045s
	iters: 300, epoch: 13 | loss: 2.3032107
	speed: 0.0606s/iter; left time: 2482.5670s
	iters: 400, epoch: 13 | loss: 2.2976511
	speed: 0.0575s/iter; left time: 2351.2588s
Epoch: 13 cost time: 27.60567545890808
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.2938619
	speed: 0.2379s/iter; left time: 9682.4724s
	iters: 200, epoch: 14 | loss: 2.3092813
	speed: 0.0586s/iter; left time: 2380.4624s
	iters: 300, epoch: 14 | loss: 2.2888689
	speed: 0.0574s/iter; left time: 2324.3809s
	iters: 400, epoch: 14 | loss: 2.3105817
	speed: 0.0595s/iter; left time: 2403.4646s
Epoch: 14 cost time: 28.226691246032715
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.2948899
	speed: 0.1952s/iter; left time: 7852.2148s
	iters: 200, epoch: 15 | loss: 2.3111951
	speed: 0.0481s/iter; left time: 1932.1539s
	iters: 300, epoch: 15 | loss: 2.3038733
	speed: 0.0523s/iter; left time: 2092.9156s
	iters: 400, epoch: 15 | loss: 2.2995498
	speed: 0.0525s/iter; left time: 2095.1094s
Epoch: 15 cost time: 24.658960103988647
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3183746
	speed: 0.2322s/iter; left time: 9234.7376s
	iters: 200, epoch: 16 | loss: 2.3020711
	speed: 0.0574s/iter; left time: 2275.5310s
	iters: 300, epoch: 16 | loss: 2.3140059
	speed: 0.0578s/iter; left time: 2286.4108s
	iters: 400, epoch: 16 | loss: 2.3140688
	speed: 0.0561s/iter; left time: 2213.7771s
Epoch: 16 cost time: 27.36386275291443
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.3064239
	speed: 0.2304s/iter; left time: 9054.3020s
	iters: 200, epoch: 17 | loss: 2.3038032
	speed: 0.0545s/iter; left time: 2137.8160s
	iters: 300, epoch: 17 | loss: 2.3063140
	speed: 0.0613s/iter; left time: 2396.7301s
	iters: 400, epoch: 17 | loss: 2.2992990
	speed: 0.0567s/iter; left time: 2211.8848s
Epoch: 17 cost time: 27.328276872634888
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.2840376
	speed: 0.2313s/iter; left time: 8979.1223s
	iters: 200, epoch: 18 | loss: 2.3222184
	speed: 0.0569s/iter; left time: 2201.9169s
	iters: 300, epoch: 18 | loss: 2.3207340
	speed: 0.0572s/iter; left time: 2209.8412s
	iters: 400, epoch: 18 | loss: 2.3032768
	speed: 0.0591s/iter; left time: 2275.5330s
Epoch: 18 cost time: 27.642908573150635
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.2990432
	speed: 0.2262s/iter; left time: 8678.2033s
	iters: 200, epoch: 19 | loss: 2.2800622
	speed: 0.0609s/iter; left time: 2330.9069s
	iters: 300, epoch: 19 | loss: 2.3146164
	speed: 0.0566s/iter; left time: 2158.9476s
	iters: 400, epoch: 19 | loss: 2.3017061
	speed: 0.0601s/iter; left time: 2286.5030s
Epoch: 19 cost time: 27.873586177825928
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.3099022
	speed: 0.2235s/iter; left time: 8468.4291s
	iters: 200, epoch: 20 | loss: 2.3207197
	speed: 0.0601s/iter; left time: 2272.4186s
	iters: 300, epoch: 20 | loss: 2.3036039
	speed: 0.0573s/iter; left time: 2161.1675s
	iters: 400, epoch: 20 | loss: 2.2931576
	speed: 0.0561s/iter; left time: 2107.3785s
Epoch: 20 cost time: 26.86161160469055
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 2.3034699
	speed: 0.1835s/iter; left time: 6866.1018s
	iters: 200, epoch: 21 | loss: 2.3083370
	speed: 0.0516s/iter; left time: 1925.2462s
	iters: 300, epoch: 21 | loss: 2.3116035
	speed: 0.0599s/iter; left time: 2229.8607s
	iters: 400, epoch: 21 | loss: 2.2990789
	speed: 0.0607s/iter; left time: 2252.5828s
Epoch: 21 cost time: 26.897866010665894
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 2.2990458
	speed: 0.2280s/iter; left time: 8424.3297s
	iters: 200, epoch: 22 | loss: 2.2922778
	speed: 0.0565s/iter; left time: 2083.1506s
	iters: 300, epoch: 22 | loss: 2.2916517
	speed: 0.0581s/iter; left time: 2135.9873s
	iters: 400, epoch: 22 | loss: 2.3058004
	speed: 0.0620s/iter; left time: 2272.9032s
Epoch: 22 cost time: 27.850285530090332
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 2.3156917
	speed: 0.2263s/iter; left time: 8254.7070s
	iters: 200, epoch: 23 | loss: 2.3011165
	speed: 0.0557s/iter; left time: 2026.6474s
	iters: 300, epoch: 23 | loss: 2.2999165
	speed: 0.0556s/iter; left time: 2017.3794s
	iters: 400, epoch: 23 | loss: 2.3038447
	speed: 0.0573s/iter; left time: 2073.9149s
Epoch: 23 cost time: 26.722380876541138
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 2.3099406
	speed: 0.2224s/iter; left time: 8010.8180s
	iters: 200, epoch: 24 | loss: 2.2987714
	speed: 0.0570s/iter; left time: 2046.2358s
	iters: 300, epoch: 24 | loss: 2.2917712
	speed: 0.0592s/iter; left time: 2121.5576s
	iters: 400, epoch: 24 | loss: 2.3001282
	speed: 0.0586s/iter; left time: 2091.5951s
Epoch: 24 cost time: 27.624609231948853
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 2.3024218
	speed: 0.2308s/iter; left time: 8205.5218s
	iters: 200, epoch: 25 | loss: 2.2863255
	speed: 0.0578s/iter; left time: 2047.4135s
	iters: 300, epoch: 25 | loss: 2.3258495
	speed: 0.0555s/iter; left time: 1962.4101s
	iters: 400, epoch: 25 | loss: 2.3087935
	speed: 0.0598s/iter; left time: 2107.0931s
Epoch: 25 cost time: 27.431174516677856
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 475594
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3666275
	speed: 0.0685s/iter; left time: 3208.1901s
	iters: 200, epoch: 1 | loss: 0.7688298
	speed: 0.0497s/iter; left time: 2319.3723s
	iters: 300, epoch: 1 | loss: 0.3374125
	speed: 0.0513s/iter; left time: 2391.5264s
	iters: 400, epoch: 1 | loss: 0.3348499
	speed: 0.0498s/iter; left time: 2314.0912s
Epoch: 1 cost time: 25.84431505203247
Epoch: 1, Steps: 469 | Train Loss: 0.804 Vali Loss: 0.264 Vali Acc: 0.923 Test Loss: 0.264 Test Acc: 0.923
Validation loss decreased (inf --> -0.923096).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1521197
	speed: 0.2253s/iter; left time: 10440.0067s
	iters: 200, epoch: 2 | loss: 0.3318714
	speed: 0.0546s/iter; left time: 2525.0934s
	iters: 300, epoch: 2 | loss: 0.1494776
	speed: 0.0588s/iter; left time: 2714.3163s
	iters: 400, epoch: 2 | loss: 0.0512520
	speed: 0.0567s/iter; left time: 2612.1638s
Epoch: 2 cost time: 27.478644847869873
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.923096 --> -0.969410).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0111084
	speed: 0.2356s/iter; left time: 10807.3284s
	iters: 200, epoch: 3 | loss: 0.0555831
	speed: 0.0549s/iter; left time: 2511.8336s
	iters: 300, epoch: 3 | loss: 0.0506811
	speed: 0.0616s/iter; left time: 2811.2729s
	iters: 400, epoch: 3 | loss: 0.0900820
	speed: 0.0574s/iter; left time: 2614.3393s
Epoch: 3 cost time: 27.642746210098267
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0160226
	speed: 0.2355s/iter; left time: 10691.0575s
	iters: 200, epoch: 4 | loss: 0.0795266
	speed: 0.0588s/iter; left time: 2662.2030s
	iters: 300, epoch: 4 | loss: 0.0106216
	speed: 0.0589s/iter; left time: 2662.9691s
	iters: 400, epoch: 4 | loss: 0.0190254
	speed: 0.0557s/iter; left time: 2512.2289s
Epoch: 4 cost time: 27.6120867729187
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0053272
	speed: 0.2273s/iter; left time: 10210.8797s
	iters: 200, epoch: 5 | loss: 0.0100101
	speed: 0.0577s/iter; left time: 2585.2546s
	iters: 300, epoch: 5 | loss: 0.0133579
	speed: 0.0565s/iter; left time: 2525.2495s
	iters: 400, epoch: 5 | loss: 0.0066550
	speed: 0.0551s/iter; left time: 2456.9701s
Epoch: 5 cost time: 27.140646934509277
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0057336
	speed: 0.2254s/iter; left time: 10022.4492s
	iters: 200, epoch: 6 | loss: 0.0994973
	speed: 0.0617s/iter; left time: 2738.4712s
	iters: 300, epoch: 6 | loss: 0.0211107
	speed: 0.0535s/iter; left time: 2369.7551s
	iters: 400, epoch: 6 | loss: 0.0494646
	speed: 0.0569s/iter; left time: 2514.3753s
Epoch: 6 cost time: 27.755961418151855
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.971125).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0758686
	speed: 0.2268s/iter; left time: 9975.0742s
	iters: 200, epoch: 7 | loss: 0.0022075
	speed: 0.0598s/iter; left time: 2625.5925s
	iters: 300, epoch: 7 | loss: 0.0035618
	speed: 0.0572s/iter; left time: 2504.7932s
	iters: 400, epoch: 7 | loss: 0.0132860
	speed: 0.0576s/iter; left time: 2515.0626s
Epoch: 7 cost time: 27.67862343788147
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0035176
	speed: 0.2326s/iter; left time: 10121.8122s
	iters: 200, epoch: 8 | loss: 0.0043155
	speed: 0.0637s/iter; left time: 2763.9137s
	iters: 300, epoch: 8 | loss: 0.0212952
	speed: 0.0583s/iter; left time: 2525.5316s
	iters: 400, epoch: 8 | loss: 0.0016429
	speed: 0.0639s/iter; left time: 2762.8395s
Epoch: 8 cost time: 29.062167167663574
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0147625
	speed: 0.2272s/iter; left time: 9778.8032s
	iters: 200, epoch: 9 | loss: 0.0408274
	speed: 0.0559s/iter; left time: 2401.2717s
	iters: 300, epoch: 9 | loss: 0.0159036
	speed: 0.0503s/iter; left time: 2154.2850s
	iters: 400, epoch: 9 | loss: 0.0080739
	speed: 0.0548s/iter; left time: 2343.2471s
Epoch: 9 cost time: 26.01741623878479
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0130149
	speed: 0.2327s/iter; left time: 9907.3063s
	iters: 200, epoch: 10 | loss: 0.0006384
	speed: 0.0561s/iter; left time: 2384.7410s
	iters: 300, epoch: 10 | loss: 0.0144043
	speed: 0.0603s/iter; left time: 2555.8495s
	iters: 400, epoch: 10 | loss: 0.0063410
	speed: 0.0575s/iter; left time: 2429.8599s
Epoch: 10 cost time: 27.929510831832886
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0537877
	speed: 0.2367s/iter; left time: 9969.0909s
	iters: 200, epoch: 11 | loss: 0.1081548
	speed: 0.0583s/iter; left time: 2447.1474s
	iters: 300, epoch: 11 | loss: 0.0022223
	speed: 0.0627s/iter; left time: 2626.8310s
	iters: 400, epoch: 11 | loss: 0.2293455
	speed: 0.0589s/iter; left time: 2462.8332s
Epoch: 11 cost time: 28.529481410980225
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.975699).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1368796
	speed: 0.2358s/iter; left time: 9817.4967s
	iters: 200, epoch: 12 | loss: 0.0703968
	speed: 0.0629s/iter; left time: 2611.1412s
	iters: 300, epoch: 12 | loss: 0.0003827
	speed: 0.0562s/iter; left time: 2329.3992s
	iters: 400, epoch: 12 | loss: 0.0032010
	speed: 0.0592s/iter; left time: 2446.7076s
Epoch: 12 cost time: 28.457948446273804
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0045727
	speed: 0.2285s/iter; left time: 9406.6340s
	iters: 200, epoch: 13 | loss: 0.0005411
	speed: 0.0605s/iter; left time: 2483.1751s
	iters: 300, epoch: 13 | loss: 0.0015769
	speed: 0.0563s/iter; left time: 2305.3427s
	iters: 400, epoch: 13 | loss: 0.0053115
	speed: 0.0610s/iter; left time: 2492.5681s
Epoch: 13 cost time: 27.851688385009766
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0022797
	speed: 0.2322s/iter; left time: 9451.0514s
	iters: 200, epoch: 14 | loss: 0.0069167
	speed: 0.0540s/iter; left time: 2194.0788s
	iters: 300, epoch: 14 | loss: 0.0486730
	speed: 0.0596s/iter; left time: 2415.0335s
	iters: 400, epoch: 14 | loss: 0.0434222
	speed: 0.0599s/iter; left time: 2421.6889s
Epoch: 14 cost time: 27.667283058166504
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0002046
	speed: 0.2071s/iter; left time: 8333.5770s
	iters: 200, epoch: 15 | loss: 0.2105636
	speed: 0.0527s/iter; left time: 2113.4300s
	iters: 300, epoch: 15 | loss: 0.0006583
	speed: 0.0504s/iter; left time: 2018.9694s
	iters: 400, epoch: 15 | loss: 0.0012644
	speed: 0.0522s/iter; left time: 2084.6285s
Epoch: 15 cost time: 24.62662959098816
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0007057
	speed: 0.2182s/iter; left time: 8675.5130s
	iters: 200, epoch: 16 | loss: 0.0104344
	speed: 0.0594s/iter; left time: 2354.6931s
	iters: 300, epoch: 16 | loss: 0.0028302
	speed: 0.0639s/iter; left time: 2527.5304s
	iters: 400, epoch: 16 | loss: 0.0020048
	speed: 0.0609s/iter; left time: 2404.4513s
Epoch: 16 cost time: 29.020177841186523
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5282031
	speed: 0.2393s/iter; left time: 9402.6681s
	iters: 200, epoch: 17 | loss: 0.0037215
	speed: 0.0624s/iter; left time: 2446.8177s
	iters: 300, epoch: 17 | loss: 0.0113982
	speed: 0.0639s/iter; left time: 2496.5299s
	iters: 400, epoch: 17 | loss: 0.0006317
	speed: 0.0636s/iter; left time: 2481.0899s
Epoch: 17 cost time: 29.605023860931396
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0075306
	speed: 0.2404s/iter; left time: 9333.8273s
	iters: 200, epoch: 18 | loss: 0.0048613
	speed: 0.0622s/iter; left time: 2410.7615s
	iters: 300, epoch: 18 | loss: 0.0005596
	speed: 0.0610s/iter; left time: 2354.4640s
	iters: 400, epoch: 18 | loss: 0.0066290
	speed: 0.0628s/iter; left time: 2420.6185s
Epoch: 18 cost time: 29.401070594787598
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0075364
	speed: 0.2506s/iter; left time: 9610.8944s
	iters: 200, epoch: 19 | loss: 0.0048498
	speed: 0.0611s/iter; left time: 2337.9687s
	iters: 300, epoch: 19 | loss: 0.0003838
	speed: 0.0601s/iter; left time: 2294.3943s
	iters: 400, epoch: 19 | loss: 0.0119789
	speed: 0.0593s/iter; left time: 2257.8249s
Epoch: 19 cost time: 28.54195785522461
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0156296
	speed: 0.2468s/iter; left time: 9352.3393s
	iters: 200, epoch: 20 | loss: 0.0067392
	speed: 0.0616s/iter; left time: 2329.6575s
	iters: 300, epoch: 20 | loss: 0.0121160
	speed: 0.0640s/iter; left time: 2411.3670s
	iters: 400, epoch: 20 | loss: 0.0001782
	speed: 0.0618s/iter; left time: 2324.5383s
Epoch: 20 cost time: 29.360881090164185
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0005114
	speed: 0.2546s/iter; left time: 9525.8082s
	iters: 200, epoch: 21 | loss: 0.0027725
	speed: 0.0580s/iter; left time: 2163.1829s
	iters: 300, epoch: 21 | loss: 0.0040406
	speed: 0.0624s/iter; left time: 2323.1363s
	iters: 400, epoch: 21 | loss: 0.0029949
	speed: 0.0632s/iter; left time: 2347.6982s
Epoch: 21 cost time: 28.703492879867554
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.978558).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0090451
	speed: 0.2542s/iter; left time: 9392.4860s
	iters: 200, epoch: 22 | loss: 0.0005051
	speed: 0.0599s/iter; left time: 2208.8859s
	iters: 300, epoch: 22 | loss: 0.0002782
	speed: 0.0588s/iter; left time: 2159.6620s
	iters: 400, epoch: 22 | loss: 0.0021890
	speed: 0.0625s/iter; left time: 2290.6064s
Epoch: 22 cost time: 28.897377490997314
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0452504
	speed: 0.2437s/iter; left time: 8889.2343s
	iters: 200, epoch: 23 | loss: 0.0012254
	speed: 0.0582s/iter; left time: 2118.2564s
	iters: 300, epoch: 23 | loss: 0.0175665
	speed: 0.0553s/iter; left time: 2007.1543s
	iters: 400, epoch: 23 | loss: 0.0175232
	speed: 0.0563s/iter; left time: 2035.4846s
Epoch: 23 cost time: 27.24651575088501
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0257739
	speed: 0.2538s/iter; left time: 9139.4774s
	iters: 200, epoch: 24 | loss: 0.0095774
	speed: 0.0610s/iter; left time: 2191.2640s
	iters: 300, epoch: 24 | loss: 0.0010092
	speed: 0.0616s/iter; left time: 2205.3094s
	iters: 400, epoch: 24 | loss: 0.0005683
	speed: 0.0592s/iter; left time: 2113.2267s
Epoch: 24 cost time: 29.220872163772583
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0074645
	speed: 0.2535s/iter; left time: 9009.0016s
	iters: 200, epoch: 25 | loss: 0.0143490
	speed: 0.0601s/iter; left time: 2131.7588s
	iters: 300, epoch: 25 | loss: 0.0005083
	speed: 0.0603s/iter; left time: 2131.4560s
	iters: 400, epoch: 25 | loss: 0.0026365
	speed: 0.0609s/iter; left time: 2148.1059s
Epoch: 25 cost time: 28.738610982894897
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0025335
	speed: 0.2394s/iter; left time: 8397.8685s
	iters: 200, epoch: 26 | loss: 0.0051249
	speed: 0.0619s/iter; left time: 2163.9425s
	iters: 300, epoch: 26 | loss: 0.0007918
	speed: 0.0587s/iter; left time: 2048.4669s
	iters: 400, epoch: 26 | loss: 0.0004447
	speed: 0.0600s/iter; left time: 2086.0219s
Epoch: 26 cost time: 28.485053300857544
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1380147
	speed: 0.2422s/iter; left time: 8382.3937s
	iters: 200, epoch: 27 | loss: 0.0006541
	speed: 0.0615s/iter; left time: 2122.1559s
	iters: 300, epoch: 27 | loss: 0.0024402
	speed: 0.0597s/iter; left time: 2055.3835s
	iters: 400, epoch: 27 | loss: 0.0016903
	speed: 0.0590s/iter; left time: 2023.8169s
Epoch: 27 cost time: 28.56430220603943
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0005671
	speed: 0.2628s/iter; left time: 8970.2711s
	iters: 200, epoch: 28 | loss: 0.0258783
	speed: 0.0613s/iter; left time: 2084.9337s
	iters: 300, epoch: 28 | loss: 0.0010372
	speed: 0.0611s/iter; left time: 2073.7401s
	iters: 400, epoch: 28 | loss: 0.0000221
	speed: 0.0618s/iter; left time: 2089.9830s
Epoch: 28 cost time: 29.2700834274292
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0010318
	speed: 0.2630s/iter; left time: 8854.5382s
	iters: 200, epoch: 29 | loss: 0.0001694
	speed: 0.0602s/iter; left time: 2020.0910s
	iters: 300, epoch: 29 | loss: 0.0068681
	speed: 0.0573s/iter; left time: 1918.3510s
	iters: 400, epoch: 29 | loss: 0.0012515
	speed: 0.0561s/iter; left time: 1872.5349s
Epoch: 29 cost time: 28.075982332229614
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0036021
	speed: 0.2455s/iter; left time: 8150.1472s
	iters: 200, epoch: 30 | loss: 0.0007885
	speed: 0.0586s/iter; left time: 1939.2823s
	iters: 300, epoch: 30 | loss: 0.0001010
	speed: 0.0619s/iter; left time: 2043.1350s
	iters: 400, epoch: 30 | loss: 0.0002954
	speed: 0.0592s/iter; left time: 1948.3676s
Epoch: 30 cost time: 28.272334575653076
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0005259
	speed: 0.2482s/iter; left time: 8123.9629s
	iters: 200, epoch: 31 | loss: 0.0025078
	speed: 0.0622s/iter; left time: 2029.0935s
	iters: 300, epoch: 31 | loss: 0.0400591
	speed: 0.0609s/iter; left time: 1982.0621s
	iters: 400, epoch: 31 | loss: 0.0002123
	speed: 0.0604s/iter; left time: 1957.8246s
Epoch: 31 cost time: 29.017970085144043
Epoch: 31, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1141974
	speed: 0.2561s/iter; left time: 8261.6202s
	iters: 200, epoch: 32 | loss: 0.0017657
	speed: 0.0608s/iter; left time: 1954.2995s
	iters: 300, epoch: 32 | loss: 0.0004800
	speed: 0.0606s/iter; left time: 1942.8652s
	iters: 400, epoch: 32 | loss: 0.0603987
	speed: 0.0605s/iter; left time: 1934.8503s
Epoch: 32 cost time: 28.894277811050415
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980559).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0007504
	speed: 0.2582s/iter; left time: 8207.4755s
	iters: 200, epoch: 33 | loss: 0.0106633
	speed: 0.0558s/iter; left time: 1767.9881s
	iters: 300, epoch: 33 | loss: 0.0094689
	speed: 0.0588s/iter; left time: 1858.3823s
	iters: 400, epoch: 33 | loss: 0.0250068
	speed: 0.0561s/iter; left time: 1768.2198s
Epoch: 33 cost time: 27.762817859649658
Epoch: 33, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.980559 --> -0.983990).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.3400632
	speed: 0.2520s/iter; left time: 7895.2073s
	iters: 200, epoch: 34 | loss: 0.0011285
	speed: 0.0602s/iter; left time: 1880.7653s
	iters: 300, epoch: 34 | loss: 0.0064813
	speed: 0.0588s/iter; left time: 1830.2674s
	iters: 400, epoch: 34 | loss: 0.0017846
	speed: 0.0591s/iter; left time: 1832.5404s
Epoch: 34 cost time: 28.090371131896973
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0001522
	speed: 0.2184s/iter; left time: 6739.3266s
	iters: 200, epoch: 35 | loss: 0.0094591
	speed: 0.0505s/iter; left time: 1554.5733s
	iters: 300, epoch: 35 | loss: 0.0000654
	speed: 0.0478s/iter; left time: 1466.3669s
	iters: 400, epoch: 35 | loss: 0.0003572
	speed: 0.0504s/iter; left time: 1540.9584s
Epoch: 35 cost time: 23.828176498413086
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0107699
	speed: 0.1691s/iter; left time: 5137.7849s
	iters: 200, epoch: 36 | loss: 0.0033309
	speed: 0.0489s/iter; left time: 1481.4732s
	iters: 300, epoch: 36 | loss: 0.2654764
	speed: 0.0457s/iter; left time: 1379.1245s
	iters: 400, epoch: 36 | loss: 0.0012931
	speed: 0.0491s/iter; left time: 1477.3048s
Epoch: 36 cost time: 22.804341554641724
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0024226
	speed: 0.2353s/iter; left time: 7038.1211s
	iters: 200, epoch: 37 | loss: 0.0203424
	speed: 0.0608s/iter; left time: 1814.0560s
	iters: 300, epoch: 37 | loss: 0.0001160
	speed: 0.0606s/iter; left time: 1800.3927s
	iters: 400, epoch: 37 | loss: 0.0002287
	speed: 0.0539s/iter; left time: 1596.1389s
Epoch: 37 cost time: 27.75684380531311
Epoch: 37, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0003584
	speed: 0.2433s/iter; left time: 7164.3885s
	iters: 200, epoch: 38 | loss: 0.0001071
	speed: 0.0593s/iter; left time: 1740.1570s
	iters: 300, epoch: 38 | loss: 0.0185793
	speed: 0.0586s/iter; left time: 1713.0012s
	iters: 400, epoch: 38 | loss: 0.0002181
	speed: 0.0587s/iter; left time: 1710.6810s
Epoch: 38 cost time: 28.268691062927246
Epoch: 38, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0001824
	speed: 0.2459s/iter; left time: 7125.1875s
	iters: 200, epoch: 39 | loss: 0.0330267
	speed: 0.0596s/iter; left time: 1720.8910s
	iters: 300, epoch: 39 | loss: 0.3277228
	speed: 0.0608s/iter; left time: 1750.3662s
	iters: 400, epoch: 39 | loss: 0.1720311
	speed: 0.0584s/iter; left time: 1675.3814s
Epoch: 39 cost time: 28.141876935958862
Epoch: 39, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0022767
	speed: 0.2471s/iter; left time: 7043.4138s
	iters: 200, epoch: 40 | loss: 0.0008508
	speed: 0.0613s/iter; left time: 1742.2375s
	iters: 300, epoch: 40 | loss: 0.0000236
	speed: 0.0593s/iter; left time: 1678.2682s
	iters: 400, epoch: 40 | loss: 0.0028664
	speed: 0.0553s/iter; left time: 1560.0505s
Epoch: 40 cost time: 28.129282474517822
Epoch: 40, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0021934
	speed: 0.2453s/iter; left time: 6879.0139s
	iters: 200, epoch: 41 | loss: 0.1210200
	speed: 0.0586s/iter; left time: 1638.5434s
	iters: 300, epoch: 41 | loss: 0.0004792
	speed: 0.0579s/iter; left time: 1613.2360s
	iters: 400, epoch: 41 | loss: 0.0024036
	speed: 0.0599s/iter; left time: 1662.8439s
Epoch: 41 cost time: 28.1481614112854
Epoch: 41, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0015135
	speed: 0.2580s/iter; left time: 7113.1890s
	iters: 200, epoch: 42 | loss: 0.0001241
	speed: 0.0586s/iter; left time: 1611.1672s
	iters: 300, epoch: 42 | loss: 0.0006138
	speed: 0.0581s/iter; left time: 1589.6270s
	iters: 400, epoch: 42 | loss: 0.0101608
	speed: 0.0605s/iter; left time: 1649.1392s
Epoch: 42 cost time: 28.387709856033325
Epoch: 42, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0021338
	speed: 0.2508s/iter; left time: 6796.8494s
	iters: 200, epoch: 43 | loss: 0.0017776
	speed: 0.0591s/iter; left time: 1597.1280s
	iters: 300, epoch: 43 | loss: 0.2126366
	speed: 0.0618s/iter; left time: 1662.5417s
	iters: 400, epoch: 43 | loss: 0.0000789
	speed: 0.0624s/iter; left time: 1671.2541s
Epoch: 43 cost time: 28.75264549255371
Epoch: 43, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
Validation loss decreased (-0.983990 --> -0.985991).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0015573
	speed: 0.2508s/iter; left time: 6678.9730s
	iters: 200, epoch: 44 | loss: 0.0019068
	speed: 0.0574s/iter; left time: 1523.2660s
	iters: 300, epoch: 44 | loss: 0.0006075
	speed: 0.0600s/iter; left time: 1587.3128s
	iters: 400, epoch: 44 | loss: 0.0003521
	speed: 0.0616s/iter; left time: 1621.1168s
Epoch: 44 cost time: 28.019375324249268
Epoch: 44, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0007125
	speed: 0.2507s/iter; left time: 6560.3665s
	iters: 200, epoch: 45 | loss: 0.0287552
	speed: 0.0601s/iter; left time: 1566.9641s
	iters: 300, epoch: 45 | loss: 0.0030962
	speed: 0.0626s/iter; left time: 1625.3200s
	iters: 400, epoch: 45 | loss: 0.0005098
	speed: 0.0612s/iter; left time: 1583.9262s
Epoch: 45 cost time: 28.63102388381958
Epoch: 45, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0000594
	speed: 0.2402s/iter; left time: 6173.4190s
	iters: 200, epoch: 46 | loss: 0.0000343
	speed: 0.0585s/iter; left time: 1498.6187s
	iters: 300, epoch: 46 | loss: 0.0025803
	speed: 0.0577s/iter; left time: 1470.7621s
	iters: 400, epoch: 46 | loss: 0.0132779
	speed: 0.0614s/iter; left time: 1559.3831s
Epoch: 46 cost time: 28.268205165863037
Epoch: 46, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.0017546
	speed: 0.2511s/iter; left time: 6333.2697s
	iters: 200, epoch: 47 | loss: 0.0000220
	speed: 0.0563s/iter; left time: 1415.5485s
	iters: 300, epoch: 47 | loss: 0.0001303
	speed: 0.0557s/iter; left time: 1393.2667s
	iters: 400, epoch: 47 | loss: 0.0001663
	speed: 0.0584s/iter; left time: 1456.3506s
Epoch: 47 cost time: 27.36073327064514
Epoch: 47, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.0011878
	speed: 0.2411s/iter; left time: 5967.9802s
	iters: 200, epoch: 48 | loss: 0.0002430
	speed: 0.0588s/iter; left time: 1449.0556s
	iters: 300, epoch: 48 | loss: 0.0005105
	speed: 0.0578s/iter; left time: 1419.6410s
	iters: 400, epoch: 48 | loss: 0.0001368
	speed: 0.0588s/iter; left time: 1439.0018s
Epoch: 48 cost time: 27.859166860580444
Epoch: 48, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.0092800
	speed: 0.2511s/iter; left time: 6099.2766s
	iters: 200, epoch: 49 | loss: 0.0006418
	speed: 0.0596s/iter; left time: 1440.6882s
	iters: 300, epoch: 49 | loss: 0.0007452
	speed: 0.0618s/iter; left time: 1488.1162s
	iters: 400, epoch: 49 | loss: 0.0963907
	speed: 0.0558s/iter; left time: 1339.7607s
Epoch: 49 cost time: 27.906486988067627
Epoch: 49, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.0005303
	speed: 0.1952s/iter; left time: 4649.7185s
	iters: 200, epoch: 50 | loss: 0.0237008
	speed: 0.0492s/iter; left time: 1167.2476s
	iters: 300, epoch: 50 | loss: 0.0144905
	speed: 0.0499s/iter; left time: 1178.3979s
	iters: 400, epoch: 50 | loss: 0.0155475
	speed: 0.0526s/iter; left time: 1237.5445s
Epoch: 50 cost time: 24.195775985717773
Epoch: 50, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.0001845
	speed: 0.1852s/iter; left time: 4325.1257s
	iters: 200, epoch: 51 | loss: 0.0822387
	speed: 0.0524s/iter; left time: 1218.8801s
	iters: 300, epoch: 51 | loss: 0.0003043
	speed: 0.0530s/iter; left time: 1228.1510s
	iters: 400, epoch: 51 | loss: 0.3233821
	speed: 0.0520s/iter; left time: 1199.1991s
Epoch: 51 cost time: 25.338884353637695
Epoch: 51, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.0006240
	speed: 0.2571s/iter; left time: 5882.5376s
	iters: 200, epoch: 52 | loss: 0.0881801
	speed: 0.0582s/iter; left time: 1326.7345s
	iters: 300, epoch: 52 | loss: 0.0002763
	speed: 0.0548s/iter; left time: 1242.3115s
	iters: 400, epoch: 52 | loss: 0.0005269
	speed: 0.0592s/iter; left time: 1337.9004s
Epoch: 52 cost time: 27.874696731567383
Epoch: 52, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.0044720
	speed: 0.2464s/iter; left time: 5523.2829s
	iters: 200, epoch: 53 | loss: 0.0026608
	speed: 0.0596s/iter; left time: 1329.3501s
	iters: 300, epoch: 53 | loss: 0.0002984
	speed: 0.0600s/iter; left time: 1333.3442s
	iters: 400, epoch: 53 | loss: 0.0087109
	speed: 0.0591s/iter; left time: 1306.5471s
Epoch: 53 cost time: 28.262479066848755
Epoch: 53, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9859919954259577
model parameter : 278986
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4720728
	speed: 0.0807s/iter; left time: 3779.1333s
	iters: 200, epoch: 1 | loss: 0.8144469
	speed: 0.0572s/iter; left time: 2673.1077s
	iters: 300, epoch: 1 | loss: 0.4267292
	speed: 0.0597s/iter; left time: 2781.8871s
	iters: 400, epoch: 1 | loss: 0.4749344
	speed: 0.0643s/iter; left time: 2990.3948s
Epoch: 1 cost time: 30.66135859489441
Epoch: 1, Steps: 469 | Train Loss: 0.907 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
Validation loss decreased (inf --> -0.899368).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3204398
	speed: 0.2427s/iter; left time: 11243.3472s
	iters: 200, epoch: 2 | loss: 0.4052854
	speed: 0.0624s/iter; left time: 2883.3288s
	iters: 300, epoch: 2 | loss: 0.1724956
	speed: 0.0603s/iter; left time: 2781.8950s
	iters: 400, epoch: 2 | loss: 0.1747751
	speed: 0.0605s/iter; left time: 2783.1218s
Epoch: 2 cost time: 28.4628005027771
Epoch: 2, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.899368 --> -0.952543).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0203557
	speed: 0.2495s/iter; left time: 11445.0248s
	iters: 200, epoch: 3 | loss: 0.0552971
	speed: 0.0612s/iter; left time: 2799.4622s
	iters: 300, epoch: 3 | loss: 0.0642888
	speed: 0.0613s/iter; left time: 2801.2329s
	iters: 400, epoch: 3 | loss: 0.0303700
	speed: 0.0604s/iter; left time: 2752.9971s
Epoch: 3 cost time: 29.56364107131958
Epoch: 3, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.952543 --> -0.958546).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0274501
	speed: 0.2561s/iter; left time: 11625.2728s
	iters: 200, epoch: 4 | loss: 0.1829087
	speed: 0.0621s/iter; left time: 2811.1908s
	iters: 300, epoch: 4 | loss: 0.0708004
	speed: 0.0588s/iter; left time: 2656.9543s
	iters: 400, epoch: 4 | loss: 0.0281475
	speed: 0.0596s/iter; left time: 2688.5559s
Epoch: 4 cost time: 29.05386757850647
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
Validation loss decreased (-0.958546 --> -0.965693).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0097302
	speed: 0.2529s/iter; left time: 11361.4278s
	iters: 200, epoch: 5 | loss: 0.0621917
	speed: 0.0579s/iter; left time: 2596.6178s
	iters: 300, epoch: 5 | loss: 0.0570988
	speed: 0.0628s/iter; left time: 2807.7087s
	iters: 400, epoch: 5 | loss: 0.0979581
	speed: 0.0624s/iter; left time: 2783.0676s
Epoch: 5 cost time: 29.19995880126953
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.965693 --> -0.967695).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0101659
	speed: 0.2556s/iter; left time: 11365.1586s
	iters: 200, epoch: 6 | loss: 0.2088250
	speed: 0.0623s/iter; left time: 2762.7936s
	iters: 300, epoch: 6 | loss: 0.1351825
	speed: 0.0649s/iter; left time: 2873.3311s
	iters: 400, epoch: 6 | loss: 0.0233094
	speed: 0.0634s/iter; left time: 2798.6079s
Epoch: 6 cost time: 29.93128490447998
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0196430
	speed: 0.2458s/iter; left time: 10811.2275s
	iters: 200, epoch: 7 | loss: 0.0055685
	speed: 0.0630s/iter; left time: 2763.5135s
	iters: 300, epoch: 7 | loss: 0.0126096
	speed: 0.0624s/iter; left time: 2731.6744s
	iters: 400, epoch: 7 | loss: 0.0094561
	speed: 0.0623s/iter; left time: 2721.0908s
Epoch: 7 cost time: 29.981513023376465
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.967695 --> -0.970839).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0041761
	speed: 0.2342s/iter; left time: 10192.4380s
	iters: 200, epoch: 8 | loss: 0.0099860
	speed: 0.0585s/iter; left time: 2539.9138s
	iters: 300, epoch: 8 | loss: 0.0610461
	speed: 0.0588s/iter; left time: 2548.1823s
	iters: 400, epoch: 8 | loss: 0.0052554
	speed: 0.0574s/iter; left time: 2479.9335s
Epoch: 8 cost time: 27.479520559310913
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.970839 --> -0.972269).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0151764
	speed: 0.1873s/iter; left time: 8064.7967s
	iters: 200, epoch: 9 | loss: 0.0163847
	speed: 0.0506s/iter; left time: 2175.0944s
	iters: 300, epoch: 9 | loss: 0.0104589
	speed: 0.0528s/iter; left time: 2263.7290s
	iters: 400, epoch: 9 | loss: 0.0063455
	speed: 0.0538s/iter; left time: 2299.1127s
Epoch: 9 cost time: 25.012807607650757
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.956 Test Loss: 0.141 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0377991
	speed: 0.1882s/iter; left time: 8012.6273s
	iters: 200, epoch: 10 | loss: 0.0133928
	speed: 0.0524s/iter; left time: 2227.6427s
	iters: 300, epoch: 10 | loss: 0.1974680
	speed: 0.0541s/iter; left time: 2294.6836s
	iters: 400, epoch: 10 | loss: 0.0382586
	speed: 0.0552s/iter; left time: 2332.9107s
Epoch: 10 cost time: 25.342050552368164
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0942532
	speed: 0.2453s/iter; left time: 10329.2134s
	iters: 200, epoch: 11 | loss: 0.0097739
	speed: 0.0631s/iter; left time: 2652.7178s
	iters: 300, epoch: 11 | loss: 0.0315663
	speed: 0.0624s/iter; left time: 2617.2225s
	iters: 400, epoch: 11 | loss: 0.2105657
	speed: 0.0641s/iter; left time: 2681.3463s
Epoch: 11 cost time: 29.85029911994934
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.977129).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0580627
	speed: 0.2337s/iter; left time: 9732.9047s
	iters: 200, epoch: 12 | loss: 0.0065516
	speed: 0.0581s/iter; left time: 2411.7445s
	iters: 300, epoch: 12 | loss: 0.0087214
	speed: 0.0558s/iter; left time: 2312.8733s
	iters: 400, epoch: 12 | loss: 0.0250063
	speed: 0.0547s/iter; left time: 2259.9769s
Epoch: 12 cost time: 27.170649766921997
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0846181
	speed: 0.2427s/iter; left time: 9993.7012s
	iters: 200, epoch: 13 | loss: 0.0003811
	speed: 0.0594s/iter; left time: 2438.4858s
	iters: 300, epoch: 13 | loss: 0.0021094
	speed: 0.0566s/iter; left time: 2320.5358s
	iters: 400, epoch: 13 | loss: 0.0212800
	speed: 0.0535s/iter; left time: 2187.6694s
Epoch: 13 cost time: 26.474683046340942
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.977129 --> -0.981703).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0015491
	speed: 0.2338s/iter; left time: 9516.2516s
	iters: 200, epoch: 14 | loss: 0.0041493
	speed: 0.0539s/iter; left time: 2189.4968s
	iters: 300, epoch: 14 | loss: 0.0092797
	speed: 0.0572s/iter; left time: 2316.7503s
	iters: 400, epoch: 14 | loss: 0.1260696
	speed: 0.0568s/iter; left time: 2294.8875s
Epoch: 14 cost time: 26.480794191360474
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006167
	speed: 0.2334s/iter; left time: 9390.9311s
	iters: 200, epoch: 15 | loss: 0.0377639
	speed: 0.0579s/iter; left time: 2324.6936s
	iters: 300, epoch: 15 | loss: 0.1682415
	speed: 0.0544s/iter; left time: 2176.1192s
	iters: 400, epoch: 15 | loss: 0.0042616
	speed: 0.0578s/iter; left time: 2306.8778s
Epoch: 15 cost time: 27.42778992652893
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0100156
	speed: 0.2415s/iter; left time: 9603.2583s
	iters: 200, epoch: 16 | loss: 0.0095738
	speed: 0.0622s/iter; left time: 2468.8051s
	iters: 300, epoch: 16 | loss: 0.0146104
	speed: 0.0641s/iter; left time: 2535.1096s
	iters: 400, epoch: 16 | loss: 0.0007467
	speed: 0.0636s/iter; left time: 2509.4853s
Epoch: 16 cost time: 29.253183364868164
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3777931
	speed: 0.2454s/iter; left time: 9642.3823s
	iters: 200, epoch: 17 | loss: 0.0051930
	speed: 0.0616s/iter; left time: 2414.6760s
	iters: 300, epoch: 17 | loss: 0.0281632
	speed: 0.0563s/iter; left time: 2201.1311s
	iters: 400, epoch: 17 | loss: 0.1402021
	speed: 0.0578s/iter; left time: 2252.8669s
Epoch: 17 cost time: 28.355559825897217
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0065664
	speed: 0.2497s/iter; left time: 9696.3699s
	iters: 200, epoch: 18 | loss: 0.0109846
	speed: 0.0605s/iter; left time: 2342.7661s
	iters: 300, epoch: 18 | loss: 0.0012984
	speed: 0.0613s/iter; left time: 2366.0621s
	iters: 400, epoch: 18 | loss: 0.0006738
	speed: 0.0625s/iter; left time: 2409.0370s
Epoch: 18 cost time: 28.877329111099243
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0037655
	speed: 0.2406s/iter; left time: 9227.5373s
	iters: 200, epoch: 19 | loss: 0.0014057
	speed: 0.0604s/iter; left time: 2312.4845s
	iters: 300, epoch: 19 | loss: 0.0015980
	speed: 0.0620s/iter; left time: 2363.9883s
	iters: 400, epoch: 19 | loss: 0.0521936
	speed: 0.0560s/iter; left time: 2129.7570s
Epoch: 19 cost time: 28.496536254882812
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0188249
	speed: 0.2564s/iter; left time: 9716.5665s
	iters: 200, epoch: 20 | loss: 0.0004243
	speed: 0.0580s/iter; left time: 2190.4347s
	iters: 300, epoch: 20 | loss: 0.0517733
	speed: 0.0614s/iter; left time: 2314.9077s
	iters: 400, epoch: 20 | loss: 0.0037431
	speed: 0.0624s/iter; left time: 2344.0376s
Epoch: 20 cost time: 29.013278245925903
Epoch: 20, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0316670
	speed: 0.2456s/iter; left time: 9190.1899s
	iters: 200, epoch: 21 | loss: 0.0387266
	speed: 0.0602s/iter; left time: 2246.9079s
	iters: 300, epoch: 21 | loss: 0.0004526
	speed: 0.0608s/iter; left time: 2263.2351s
	iters: 400, epoch: 21 | loss: 0.0008805
	speed: 0.0606s/iter; left time: 2251.2847s
Epoch: 21 cost time: 28.59879994392395
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0135879
	speed: 0.2366s/iter; left time: 8742.9993s
	iters: 200, epoch: 22 | loss: 0.0090554
	speed: 0.0618s/iter; left time: 2278.7028s
	iters: 300, epoch: 22 | loss: 0.0001624
	speed: 0.0553s/iter; left time: 2032.5338s
	iters: 400, epoch: 22 | loss: 0.0121807
	speed: 0.0581s/iter; left time: 2128.7232s
Epoch: 22 cost time: 27.86059331893921
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0056545
	speed: 0.2494s/iter; left time: 9099.1923s
	iters: 200, epoch: 23 | loss: 0.0028750
	speed: 0.0532s/iter; left time: 1935.0484s
	iters: 300, epoch: 23 | loss: 0.0015464
	speed: 0.0524s/iter; left time: 1900.9889s
	iters: 400, epoch: 23 | loss: 0.0172138
	speed: 0.0519s/iter; left time: 1878.1419s
Epoch: 23 cost time: 25.33927035331726
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 278986
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2996999
	speed: 0.0711s/iter; left time: 3327.3151s
	iters: 200, epoch: 1 | loss: 0.8005322
	speed: 0.0614s/iter; left time: 2866.2525s
	iters: 300, epoch: 1 | loss: 0.3878514
	speed: 0.0607s/iter; left time: 2830.2798s
	iters: 400, epoch: 1 | loss: 0.3744362
	speed: 0.0566s/iter; left time: 2633.3423s
Epoch: 1 cost time: 29.33649778366089
Epoch: 1, Steps: 469 | Train Loss: 0.854 Vali Loss: 0.285 Vali Acc: 0.918 Test Loss: 0.285 Test Acc: 0.918
Validation loss decreased (inf --> -0.917950).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1566352
	speed: 0.2280s/iter; left time: 10563.3355s
	iters: 200, epoch: 2 | loss: 0.3308410
	speed: 0.0604s/iter; left time: 2794.1061s
	iters: 300, epoch: 2 | loss: 0.1059887
	speed: 0.0566s/iter; left time: 2612.9170s
	iters: 400, epoch: 2 | loss: 0.1468980
	speed: 0.0628s/iter; left time: 2891.1845s
Epoch: 2 cost time: 28.85033369064331
Epoch: 2, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
Validation loss decreased (-0.917950 --> -0.963120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0097543
	speed: 0.2381s/iter; left time: 10920.0600s
	iters: 200, epoch: 3 | loss: 0.1100124
	speed: 0.0594s/iter; left time: 2716.9646s
	iters: 300, epoch: 3 | loss: 0.0251579
	speed: 0.0619s/iter; left time: 2824.7615s
	iters: 400, epoch: 3 | loss: 0.1161591
	speed: 0.0619s/iter; left time: 2818.8848s
Epoch: 3 cost time: 28.972936153411865
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0175879
	speed: 0.2405s/iter; left time: 10918.2643s
	iters: 200, epoch: 4 | loss: 0.1401222
	speed: 0.0611s/iter; left time: 2766.5635s
	iters: 300, epoch: 4 | loss: 0.0526869
	speed: 0.0633s/iter; left time: 2859.5710s
	iters: 400, epoch: 4 | loss: 0.0243176
	speed: 0.0617s/iter; left time: 2784.2963s
Epoch: 4 cost time: 28.534682750701904
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.963120 --> -0.966265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0293442
	speed: 0.2400s/iter; left time: 10783.9755s
	iters: 200, epoch: 5 | loss: 0.0346050
	speed: 0.0574s/iter; left time: 2572.8499s
	iters: 300, epoch: 5 | loss: 0.0100610
	speed: 0.0567s/iter; left time: 2535.4810s
	iters: 400, epoch: 5 | loss: 0.0181906
	speed: 0.0542s/iter; left time: 2418.6486s
Epoch: 5 cost time: 26.735982418060303
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.966265 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0189644
	speed: 0.2360s/iter; left time: 10489.8162s
	iters: 200, epoch: 6 | loss: 0.0812791
	speed: 0.0560s/iter; left time: 2483.9662s
	iters: 300, epoch: 6 | loss: 0.0752888
	speed: 0.0566s/iter; left time: 2503.8981s
	iters: 400, epoch: 6 | loss: 0.0061065
	speed: 0.0526s/iter; left time: 2321.5636s
Epoch: 6 cost time: 26.737098932266235
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0200211
	speed: 0.2369s/iter; left time: 10422.4131s
	iters: 200, epoch: 7 | loss: 0.0042176
	speed: 0.0591s/iter; left time: 2595.0261s
	iters: 300, epoch: 7 | loss: 0.0032961
	speed: 0.0568s/iter; left time: 2486.3315s
	iters: 400, epoch: 7 | loss: 0.0311452
	speed: 0.0534s/iter; left time: 2335.0493s
Epoch: 7 cost time: 26.67496109008789
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.968552 --> -0.972555).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0028391
	speed: 0.2441s/iter; left time: 10623.1274s
	iters: 200, epoch: 8 | loss: 0.0022040
	speed: 0.0589s/iter; left time: 2556.0107s
	iters: 300, epoch: 8 | loss: 0.0428224
	speed: 0.0584s/iter; left time: 2527.9897s
	iters: 400, epoch: 8 | loss: 0.0013413
	speed: 0.0551s/iter; left time: 2382.5225s
Epoch: 8 cost time: 26.869173765182495
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0069489
	speed: 0.1721s/iter; left time: 7409.7555s
	iters: 200, epoch: 9 | loss: 0.0048213
	speed: 0.0470s/iter; left time: 2018.5873s
	iters: 300, epoch: 9 | loss: 0.0979538
	speed: 0.0474s/iter; left time: 2029.9005s
	iters: 400, epoch: 9 | loss: 0.0078782
	speed: 0.0481s/iter; left time: 2054.4812s
Epoch: 9 cost time: 22.665504455566406
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0107829
	speed: 0.2157s/iter; left time: 9183.4516s
	iters: 200, epoch: 10 | loss: 0.0083530
	speed: 0.0595s/iter; left time: 2528.4559s
	iters: 300, epoch: 10 | loss: 0.0897968
	speed: 0.0551s/iter; left time: 2333.3879s
	iters: 400, epoch: 10 | loss: 0.0276622
	speed: 0.0585s/iter; left time: 2474.2986s
Epoch: 10 cost time: 27.589322566986084
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0787579
	speed: 0.2254s/iter; left time: 9491.6760s
	iters: 200, epoch: 11 | loss: 0.1033288
	speed: 0.0526s/iter; left time: 2208.9236s
	iters: 300, epoch: 11 | loss: 0.0146472
	speed: 0.0562s/iter; left time: 2353.5502s
	iters: 400, epoch: 11 | loss: 0.4746000
	speed: 0.0598s/iter; left time: 2499.3359s
Epoch: 11 cost time: 26.675403118133545
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.972555 --> -0.979416).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0216351
	speed: 0.2323s/iter; left time: 9671.4420s
	iters: 200, epoch: 12 | loss: 0.0082519
	speed: 0.0572s/iter; left time: 2376.4854s
	iters: 300, epoch: 12 | loss: 0.0029142
	speed: 0.0542s/iter; left time: 2246.2891s
	iters: 400, epoch: 12 | loss: 0.1130910
	speed: 0.0585s/iter; left time: 2419.2413s
Epoch: 12 cost time: 27.241536378860474
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0050499
	speed: 0.2258s/iter; left time: 9295.9099s
	iters: 200, epoch: 13 | loss: 0.0006555
	speed: 0.0546s/iter; left time: 2241.5896s
	iters: 300, epoch: 13 | loss: 0.0017863
	speed: 0.0587s/iter; left time: 2406.7419s
	iters: 400, epoch: 13 | loss: 0.0081870
	speed: 0.0536s/iter; left time: 2189.3818s
Epoch: 13 cost time: 26.878790855407715
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0064845
	speed: 0.2182s/iter; left time: 8880.8755s
	iters: 200, epoch: 14 | loss: 0.0276702
	speed: 0.0480s/iter; left time: 1947.4079s
	iters: 300, epoch: 14 | loss: 0.0019338
	speed: 0.0486s/iter; left time: 1966.5081s
	iters: 400, epoch: 14 | loss: 0.2145150
	speed: 0.0499s/iter; left time: 2015.2886s
Epoch: 14 cost time: 23.112663745880127
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0057694
	speed: 0.1709s/iter; left time: 6876.2523s
	iters: 200, epoch: 15 | loss: 0.1268167
	speed: 0.0588s/iter; left time: 2358.8795s
	iters: 300, epoch: 15 | loss: 0.0084379
	speed: 0.0538s/iter; left time: 2155.1540s
	iters: 400, epoch: 15 | loss: 0.0024151
	speed: 0.0577s/iter; left time: 2304.1013s
Epoch: 15 cost time: 26.941362857818604
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0073114
	speed: 0.2140s/iter; left time: 8508.2384s
	iters: 200, epoch: 16 | loss: 0.0033925
	speed: 0.0591s/iter; left time: 2344.0412s
	iters: 300, epoch: 16 | loss: 0.0302039
	speed: 0.0556s/iter; left time: 2198.5761s
	iters: 400, epoch: 16 | loss: 0.0004071
	speed: 0.0560s/iter; left time: 2210.4663s
Epoch: 16 cost time: 26.847702026367188
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5232227
	speed: 0.2168s/iter; left time: 8520.2781s
	iters: 200, epoch: 17 | loss: 0.0036266
	speed: 0.0567s/iter; left time: 2223.1177s
	iters: 300, epoch: 17 | loss: 0.0012293
	speed: 0.0555s/iter; left time: 2170.5252s
	iters: 400, epoch: 17 | loss: 0.0040035
	speed: 0.0543s/iter; left time: 2118.9415s
Epoch: 17 cost time: 26.53287100791931
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0180254
	speed: 0.2350s/iter; left time: 9124.8684s
	iters: 200, epoch: 18 | loss: 0.0137593
	speed: 0.0556s/iter; left time: 2154.1309s
	iters: 300, epoch: 18 | loss: 0.0263851
	speed: 0.0600s/iter; left time: 2318.2661s
	iters: 400, epoch: 18 | loss: 0.0557557
	speed: 0.0557s/iter; left time: 2147.8498s
Epoch: 18 cost time: 27.164915084838867
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0021808
	speed: 0.2203s/iter; left time: 8449.2825s
	iters: 200, epoch: 19 | loss: 0.0046872
	speed: 0.0522s/iter; left time: 1997.9787s
	iters: 300, epoch: 19 | loss: 0.0001221
	speed: 0.0573s/iter; left time: 2186.9650s
	iters: 400, epoch: 19 | loss: 0.1733277
	speed: 0.0609s/iter; left time: 2317.4348s
Epoch: 19 cost time: 27.057158708572388
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0754447
	speed: 0.2357s/iter; left time: 8931.9042s
	iters: 200, epoch: 20 | loss: 0.0208262
	speed: 0.0594s/iter; left time: 2245.3865s
	iters: 300, epoch: 20 | loss: 0.0005956
	speed: 0.0564s/iter; left time: 2124.2268s
	iters: 400, epoch: 20 | loss: 0.0002195
	speed: 0.0580s/iter; left time: 2181.9941s
Epoch: 20 cost time: 27.556325674057007
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0012737
	speed: 0.2319s/iter; left time: 8677.4233s
	iters: 200, epoch: 21 | loss: 0.0057815
	speed: 0.0581s/iter; left time: 2169.7159s
	iters: 300, epoch: 21 | loss: 0.0008000
	speed: 0.0545s/iter; left time: 2027.2939s
	iters: 400, epoch: 21 | loss: 0.0005365
	speed: 0.0593s/iter; left time: 2199.7300s
Epoch: 21 cost time: 27.326128482818604
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 278986
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3004084
	speed: 0.0720s/iter; left time: 3369.7186s
	iters: 200, epoch: 1 | loss: 2.2948008
	speed: 0.0567s/iter; left time: 2650.2733s
	iters: 300, epoch: 1 | loss: 2.3047075
	speed: 0.0566s/iter; left time: 2636.3409s
	iters: 400, epoch: 1 | loss: 2.3054338
	speed: 0.0580s/iter; left time: 2697.2157s
Epoch: 1 cost time: 28.411097764968872
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3063631
	speed: 0.2187s/iter; left time: 10130.5867s
	iters: 200, epoch: 2 | loss: 2.3098884
	speed: 0.0543s/iter; left time: 2509.3486s
	iters: 300, epoch: 2 | loss: 2.3063011
	speed: 0.0503s/iter; left time: 2319.8810s
	iters: 400, epoch: 2 | loss: 2.2991076
	speed: 0.0470s/iter; left time: 2161.2823s
Epoch: 2 cost time: 24.449185609817505
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3119075
	speed: 0.1740s/iter; left time: 7979.0902s
	iters: 200, epoch: 3 | loss: 2.2989798
	speed: 0.0557s/iter; left time: 2548.8377s
	iters: 300, epoch: 3 | loss: 2.2955327
	speed: 0.0528s/iter; left time: 2411.7207s
	iters: 400, epoch: 3 | loss: 2.3054776
	speed: 0.0535s/iter; left time: 2438.2012s
Epoch: 3 cost time: 25.73776602745056
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2975018
	speed: 0.2166s/iter; left time: 9832.5659s
	iters: 200, epoch: 4 | loss: 2.2911155
	speed: 0.0583s/iter; left time: 2641.2885s
	iters: 300, epoch: 4 | loss: 2.3013167
	speed: 0.0583s/iter; left time: 2632.7683s
	iters: 400, epoch: 4 | loss: 2.2850022
	speed: 0.0559s/iter; left time: 2521.4879s
Epoch: 4 cost time: 26.985339403152466
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3002746
	speed: 0.2207s/iter; left time: 9913.4765s
	iters: 200, epoch: 5 | loss: 2.2998030
	speed: 0.0603s/iter; left time: 2703.1612s
	iters: 300, epoch: 5 | loss: 2.3015382
	speed: 0.0576s/iter; left time: 2574.6631s
	iters: 400, epoch: 5 | loss: 2.3122959
	speed: 0.0581s/iter; left time: 2593.5308s
Epoch: 5 cost time: 27.775988340377808
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3225467
	speed: 0.2248s/iter; left time: 9994.3951s
	iters: 200, epoch: 6 | loss: 2.3170319
	speed: 0.0564s/iter; left time: 2501.4053s
	iters: 300, epoch: 6 | loss: 2.3079343
	speed: 0.0589s/iter; left time: 2606.6430s
	iters: 400, epoch: 6 | loss: 2.3042567
	speed: 0.0544s/iter; left time: 2403.3715s
Epoch: 6 cost time: 27.428355932235718
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3024867
	speed: 0.2264s/iter; left time: 9960.1286s
	iters: 200, epoch: 7 | loss: 2.3073065
	speed: 0.0587s/iter; left time: 2576.1266s
	iters: 300, epoch: 7 | loss: 2.2991419
	speed: 0.0592s/iter; left time: 2594.1494s
	iters: 400, epoch: 7 | loss: 2.3036854
	speed: 0.0594s/iter; left time: 2594.0624s
Epoch: 7 cost time: 27.98998212814331
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2881241
	speed: 0.2279s/iter; left time: 9919.7019s
	iters: 200, epoch: 8 | loss: 2.3041079
	speed: 0.0580s/iter; left time: 2519.7680s
	iters: 300, epoch: 8 | loss: 2.3284903
	speed: 0.0615s/iter; left time: 2665.8841s
	iters: 400, epoch: 8 | loss: 2.3067012
	speed: 0.0590s/iter; left time: 2550.8382s
Epoch: 8 cost time: 28.334980487823486
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2903144
	speed: 0.2336s/iter; left time: 10056.3965s
	iters: 200, epoch: 9 | loss: 2.2903814
	speed: 0.0583s/iter; left time: 2501.8077s
	iters: 300, epoch: 9 | loss: 2.2924659
	speed: 0.0611s/iter; left time: 2616.2465s
	iters: 400, epoch: 9 | loss: 2.3233333
	speed: 0.0543s/iter; left time: 2322.8479s
Epoch: 9 cost time: 27.62154483795166
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3084695
	speed: 0.2320s/iter; left time: 9878.3638s
	iters: 200, epoch: 10 | loss: 2.3159459
	speed: 0.0555s/iter; left time: 2358.3942s
	iters: 300, epoch: 10 | loss: 2.3080826
	speed: 0.0619s/iter; left time: 2623.7355s
	iters: 400, epoch: 10 | loss: 2.3306847
	speed: 0.0540s/iter; left time: 2284.9579s
Epoch: 10 cost time: 27.53605031967163
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3040056
	speed: 0.2302s/iter; left time: 9694.9933s
	iters: 200, epoch: 11 | loss: 2.3120129
	speed: 0.0609s/iter; left time: 2559.3739s
	iters: 300, epoch: 11 | loss: 2.3106556
	speed: 0.0587s/iter; left time: 2461.2731s
	iters: 400, epoch: 11 | loss: 2.2941260
	speed: 0.0564s/iter; left time: 2357.1344s
Epoch: 11 cost time: 28.112515926361084
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3185546
	speed: 0.2075s/iter; left time: 8640.7370s
	iters: 200, epoch: 12 | loss: 2.3065898
	speed: 0.0488s/iter; left time: 2028.3680s
	iters: 300, epoch: 12 | loss: 2.2863843
	speed: 0.0554s/iter; left time: 2296.3300s
	iters: 400, epoch: 12 | loss: 2.3085248
	speed: 0.0511s/iter; left time: 2113.4568s
Epoch: 12 cost time: 24.555928468704224
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2998047
	speed: 0.2183s/iter; left time: 8987.9224s
	iters: 200, epoch: 13 | loss: 2.3125367
	speed: 0.0621s/iter; left time: 2548.7409s
	iters: 300, epoch: 13 | loss: 2.3088365
	speed: 0.0558s/iter; left time: 2285.6338s
	iters: 400, epoch: 13 | loss: 2.2929628
	speed: 0.0611s/iter; left time: 2496.9722s
Epoch: 13 cost time: 27.84545063972473
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.2949855
	speed: 0.2178s/iter; left time: 8863.5120s
	iters: 200, epoch: 14 | loss: 2.2926724
	speed: 0.0556s/iter; left time: 2258.9519s
	iters: 300, epoch: 14 | loss: 2.3063381
	speed: 0.0551s/iter; left time: 2230.3138s
	iters: 400, epoch: 14 | loss: 2.3008821
	speed: 0.0589s/iter; left time: 2379.8299s
Epoch: 14 cost time: 26.88242816925049
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.3088970
	speed: 0.2297s/iter; left time: 9242.3945s
	iters: 200, epoch: 15 | loss: 2.2944374
	speed: 0.0569s/iter; left time: 2283.3733s
	iters: 300, epoch: 15 | loss: 2.2935395
	speed: 0.0552s/iter; left time: 2208.6843s
	iters: 400, epoch: 15 | loss: 2.3083124
	speed: 0.0584s/iter; left time: 2330.4738s
Epoch: 15 cost time: 27.289071559906006
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.2953308
	speed: 0.2234s/iter; left time: 8882.8647s
	iters: 200, epoch: 16 | loss: 2.2971246
	speed: 0.0590s/iter; left time: 2341.0391s
	iters: 300, epoch: 16 | loss: 2.3138556
	speed: 0.0583s/iter; left time: 2305.5669s
	iters: 400, epoch: 16 | loss: 2.3068635
	speed: 0.0589s/iter; left time: 2324.1436s
Epoch: 16 cost time: 27.89046597480774
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.3148420
	speed: 0.2175s/iter; left time: 8548.3829s
	iters: 200, epoch: 17 | loss: 2.2793293
	speed: 0.0519s/iter; left time: 2035.1194s
	iters: 300, epoch: 17 | loss: 2.2976761
	speed: 0.0508s/iter; left time: 1987.5653s
	iters: 400, epoch: 17 | loss: 2.2895296
	speed: 0.0520s/iter; left time: 2027.1331s
Epoch: 17 cost time: 24.630842924118042
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 2.3066704
	speed: 0.2221s/iter; left time: 8623.6116s
	iters: 200, epoch: 18 | loss: 2.2859869
	speed: 0.0575s/iter; left time: 2227.4954s
	iters: 300, epoch: 18 | loss: 2.2893116
	speed: 0.0580s/iter; left time: 2242.0257s
	iters: 400, epoch: 18 | loss: 2.3096600
	speed: 0.0586s/iter; left time: 2257.4010s
Epoch: 18 cost time: 27.73773980140686
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3143542
	speed: 0.2297s/iter; left time: 8812.1920s
	iters: 200, epoch: 19 | loss: 2.3131962
	speed: 0.0560s/iter; left time: 2141.2992s
	iters: 300, epoch: 19 | loss: 2.2880368
	speed: 0.0615s/iter; left time: 2346.9707s
	iters: 400, epoch: 19 | loss: 2.2970498
	speed: 0.0519s/iter; left time: 1974.2144s
Epoch: 19 cost time: 27.249330520629883
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.2977705
	speed: 0.2290s/iter; left time: 8677.2140s
	iters: 200, epoch: 20 | loss: 2.3048749
	speed: 0.0580s/iter; left time: 2190.5227s
	iters: 300, epoch: 20 | loss: 2.3094127
	speed: 0.0612s/iter; left time: 2305.9044s
	iters: 400, epoch: 20 | loss: 2.3011694
	speed: 0.0583s/iter; left time: 2192.5633s
Epoch: 20 cost time: 28.18118906021118
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.2947814
	speed: 0.2312s/iter; left time: 8652.6076s
	iters: 200, epoch: 21 | loss: 2.3069503
	speed: 0.0577s/iter; left time: 2154.8287s
	iters: 300, epoch: 21 | loss: 2.2907143
	speed: 0.0571s/iter; left time: 2126.4756s
	iters: 400, epoch: 21 | loss: 2.3151264
	speed: 0.0616s/iter; left time: 2284.9067s
Epoch: 21 cost time: 27.96692442893982
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.2969863
	speed: 0.2288s/iter; left time: 8454.3878s
	iters: 200, epoch: 22 | loss: 2.2857533
	speed: 0.0602s/iter; left time: 2218.5746s
	iters: 300, epoch: 22 | loss: 2.3138750
	speed: 0.0612s/iter; left time: 2250.6398s
	iters: 400, epoch: 22 | loss: 2.2974274
	speed: 0.0549s/iter; left time: 2010.5950s
Epoch: 22 cost time: 27.972641944885254
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.2848268
	speed: 0.1848s/iter; left time: 6740.8551s
	iters: 200, epoch: 23 | loss: 2.2946398
	speed: 0.0500s/iter; left time: 1818.1316s
	iters: 300, epoch: 23 | loss: 2.2819419
	speed: 0.0512s/iter; left time: 1856.6441s
	iters: 400, epoch: 23 | loss: 2.2968543
	speed: 0.0507s/iter; left time: 1835.8647s
Epoch: 23 cost time: 24.4281485080719
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3250537
	speed: 0.1751s/iter; left time: 6304.3693s
	iters: 200, epoch: 24 | loss: 2.2945492
	speed: 0.0503s/iter; left time: 1804.7508s
	iters: 300, epoch: 24 | loss: 2.2998056
	speed: 0.0484s/iter; left time: 1732.3338s
	iters: 400, epoch: 24 | loss: 2.2938011
	speed: 0.0482s/iter; left time: 1720.1897s
Epoch: 24 cost time: 23.70923089981079
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.3067768
	speed: 0.2423s/iter; left time: 8612.1429s
	iters: 200, epoch: 25 | loss: 2.2835796
	speed: 0.0606s/iter; left time: 2148.5422s
	iters: 300, epoch: 25 | loss: 2.3202996
	speed: 0.0596s/iter; left time: 2106.3111s
	iters: 400, epoch: 25 | loss: 2.3135743
	speed: 0.0605s/iter; left time: 2133.6527s
Epoch: 25 cost time: 28.841596603393555
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.3209686
	speed: 0.2630s/iter; left time: 9225.7687s
	iters: 200, epoch: 26 | loss: 2.3000193
	speed: 0.0622s/iter; left time: 2175.5758s
	iters: 300, epoch: 26 | loss: 2.2976556
	speed: 0.0627s/iter; left time: 2187.7308s
	iters: 400, epoch: 26 | loss: 2.3124306
	speed: 0.0613s/iter; left time: 2132.3128s
Epoch: 26 cost time: 30.170183897018433
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3036869
	speed: 0.2622s/iter; left time: 9074.5204s
	iters: 200, epoch: 27 | loss: 2.3121750
	speed: 0.0601s/iter; left time: 2072.8987s
	iters: 300, epoch: 27 | loss: 2.3153033
	speed: 0.0624s/iter; left time: 2147.5031s
	iters: 400, epoch: 27 | loss: 2.3069630
	speed: 0.0590s/iter; left time: 2024.6866s
Epoch: 27 cost time: 28.602559804916382
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.3088398
	speed: 0.2347s/iter; left time: 8010.5502s
	iters: 200, epoch: 28 | loss: 2.2973790
	speed: 0.0580s/iter; left time: 1972.9307s
	iters: 300, epoch: 28 | loss: 2.2835517
	speed: 0.0577s/iter; left time: 1958.0790s
	iters: 400, epoch: 28 | loss: 2.2979631
	speed: 0.0614s/iter; left time: 2076.4637s
Epoch: 28 cost time: 27.681280612945557
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 278986
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3741419
	speed: 0.0812s/iter; left time: 3800.1229s
	iters: 200, epoch: 1 | loss: 1.1510370
	speed: 0.0616s/iter; left time: 2874.7630s
	iters: 300, epoch: 1 | loss: 0.4747646
	speed: 0.0613s/iter; left time: 2855.6828s
	iters: 400, epoch: 1 | loss: 0.1858456
	speed: 0.0588s/iter; left time: 2733.2622s
Epoch: 1 cost time: 30.753902912139893
Epoch: 1, Steps: 469 | Train Loss: 0.835 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (inf --> -0.933388).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1118970
	speed: 0.2531s/iter; left time: 11727.8522s
	iters: 200, epoch: 2 | loss: 0.1006996
	speed: 0.0648s/iter; left time: 2996.0477s
	iters: 300, epoch: 2 | loss: 0.0848820
	speed: 0.0638s/iter; left time: 2944.6727s
	iters: 400, epoch: 2 | loss: 0.1360406
	speed: 0.0614s/iter; left time: 2828.2308s
Epoch: 2 cost time: 29.567771673202515
Epoch: 2, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.933388 --> -0.964836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0791944
	speed: 0.2380s/iter; left time: 10915.4223s
	iters: 200, epoch: 3 | loss: 0.0161171
	speed: 0.0613s/iter; left time: 2807.3813s
	iters: 300, epoch: 3 | loss: 0.0232806
	speed: 0.0608s/iter; left time: 2776.1697s
	iters: 400, epoch: 3 | loss: 0.0154831
	speed: 0.0614s/iter; left time: 2799.2013s
Epoch: 3 cost time: 28.968672037124634
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.967123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2070960
	speed: 0.2454s/iter; left time: 11140.6772s
	iters: 200, epoch: 4 | loss: 0.0104656
	speed: 0.0622s/iter; left time: 2817.4922s
	iters: 300, epoch: 4 | loss: 0.0149271
	speed: 0.0662s/iter; left time: 2993.7994s
	iters: 400, epoch: 4 | loss: 0.0454476
	speed: 0.0630s/iter; left time: 2843.1618s
Epoch: 4 cost time: 30.325536727905273
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0043490
	speed: 0.2378s/iter; left time: 10684.5819s
	iters: 200, epoch: 5 | loss: 0.0111659
	speed: 0.0631s/iter; left time: 2830.6096s
	iters: 300, epoch: 5 | loss: 0.0449462
	speed: 0.0645s/iter; left time: 2883.0431s
	iters: 400, epoch: 5 | loss: 0.0323650
	speed: 0.0605s/iter; left time: 2700.5738s
Epoch: 5 cost time: 29.72642469406128
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.967123 --> -0.975128).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0118022
	speed: 0.2452s/iter; left time: 10900.1605s
	iters: 200, epoch: 6 | loss: 0.0377209
	speed: 0.0604s/iter; left time: 2678.0791s
	iters: 300, epoch: 6 | loss: 0.0159203
	speed: 0.0592s/iter; left time: 2621.7959s
	iters: 400, epoch: 6 | loss: 0.1474331
	speed: 0.0607s/iter; left time: 2681.3273s
Epoch: 6 cost time: 28.365267038345337
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0620167
	speed: 0.2440s/iter; left time: 10734.1971s
	iters: 200, epoch: 7 | loss: 0.0066156
	speed: 0.0607s/iter; left time: 2664.8288s
	iters: 300, epoch: 7 | loss: 0.0581714
	speed: 0.0620s/iter; left time: 2716.9832s
	iters: 400, epoch: 7 | loss: 0.0014086
	speed: 0.0613s/iter; left time: 2678.3904s
Epoch: 7 cost time: 28.408616542816162
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.962 Test Loss: 0.220 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0095387
	speed: 0.2455s/iter; left time: 10685.3691s
	iters: 200, epoch: 8 | loss: 0.0599745
	speed: 0.0573s/iter; left time: 2487.4187s
	iters: 300, epoch: 8 | loss: 0.2234580
	speed: 0.0564s/iter; left time: 2443.4462s
	iters: 400, epoch: 8 | loss: 0.0015293
	speed: 0.0589s/iter; left time: 2545.3412s
Epoch: 8 cost time: 27.48555326461792
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0087636
	speed: 0.2376s/iter; left time: 10226.3584s
	iters: 200, epoch: 9 | loss: 0.0024467
	speed: 0.0565s/iter; left time: 2428.7135s
	iters: 300, epoch: 9 | loss: 0.0069072
	speed: 0.0578s/iter; left time: 2476.4076s
	iters: 400, epoch: 9 | loss: 0.0209859
	speed: 0.0640s/iter; left time: 2735.0339s
Epoch: 9 cost time: 28.353715419769287
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0569964
	speed: 0.2643s/iter; left time: 11252.6160s
	iters: 200, epoch: 10 | loss: 0.0336588
	speed: 0.0630s/iter; left time: 2676.3946s
	iters: 300, epoch: 10 | loss: 0.0080059
	speed: 0.0640s/iter; left time: 2711.5121s
	iters: 400, epoch: 10 | loss: 0.0074437
	speed: 0.0606s/iter; left time: 2564.2715s
Epoch: 10 cost time: 29.407982349395752
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0053064
	speed: 0.2044s/iter; left time: 8605.8510s
	iters: 200, epoch: 11 | loss: 0.0019598
	speed: 0.0506s/iter; left time: 2127.0010s
	iters: 300, epoch: 11 | loss: 0.0078422
	speed: 0.0512s/iter; left time: 2146.8617s
	iters: 400, epoch: 11 | loss: 0.0112186
	speed: 0.0513s/iter; left time: 2145.4635s
Epoch: 11 cost time: 24.268498420715332
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976843).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0158231
	speed: 0.1797s/iter; left time: 7483.0549s
	iters: 200, epoch: 12 | loss: 0.0065010
	speed: 0.0531s/iter; left time: 2203.8556s
	iters: 300, epoch: 12 | loss: 0.0155137
	speed: 0.0540s/iter; left time: 2236.7601s
	iters: 400, epoch: 12 | loss: 0.0101952
	speed: 0.0516s/iter; left time: 2134.6367s
Epoch: 12 cost time: 24.757377862930298
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006707
	speed: 0.2205s/iter; left time: 9077.6775s
	iters: 200, epoch: 13 | loss: 0.0689659
	speed: 0.0632s/iter; left time: 2594.4571s
	iters: 300, epoch: 13 | loss: 0.0036937
	speed: 0.0609s/iter; left time: 2496.4865s
	iters: 400, epoch: 13 | loss: 0.0464495
	speed: 0.0604s/iter; left time: 2469.4074s
Epoch: 13 cost time: 29.062658309936523
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003994
	speed: 0.2523s/iter; left time: 10267.9385s
	iters: 200, epoch: 14 | loss: 0.0028111
	speed: 0.0598s/iter; left time: 2427.3432s
	iters: 300, epoch: 14 | loss: 0.4280542
	speed: 0.0605s/iter; left time: 2450.3426s
	iters: 400, epoch: 14 | loss: 0.0011480
	speed: 0.0590s/iter; left time: 2385.4229s
Epoch: 14 cost time: 28.387170553207397
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0008568
	speed: 0.2482s/iter; left time: 9987.1031s
	iters: 200, epoch: 15 | loss: 0.0795758
	speed: 0.0612s/iter; left time: 2455.8947s
	iters: 300, epoch: 15 | loss: 0.0052920
	speed: 0.0584s/iter; left time: 2336.2797s
	iters: 400, epoch: 15 | loss: 0.0029955
	speed: 0.0563s/iter; left time: 2247.6629s
Epoch: 15 cost time: 27.93433380126953
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0009687
	speed: 0.2462s/iter; left time: 9789.3293s
	iters: 200, epoch: 16 | loss: 0.0030225
	speed: 0.0632s/iter; left time: 2507.4176s
	iters: 300, epoch: 16 | loss: 0.0033276
	speed: 0.0601s/iter; left time: 2377.1618s
	iters: 400, epoch: 16 | loss: 0.0002771
	speed: 0.0626s/iter; left time: 2471.2639s
Epoch: 16 cost time: 29.407744884490967
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0016444
	speed: 0.2607s/iter; left time: 10244.2357s
	iters: 200, epoch: 17 | loss: 0.0017395
	speed: 0.0603s/iter; left time: 2361.8558s
	iters: 300, epoch: 17 | loss: 0.0008171
	speed: 0.0590s/iter; left time: 2304.8222s
	iters: 400, epoch: 17 | loss: 0.0019834
	speed: 0.0636s/iter; left time: 2481.7050s
Epoch: 17 cost time: 29.077842712402344
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0012122
	speed: 0.2612s/iter; left time: 10142.7847s
	iters: 200, epoch: 18 | loss: 0.0634570
	speed: 0.0598s/iter; left time: 2314.7553s
	iters: 300, epoch: 18 | loss: 0.0227536
	speed: 0.0618s/iter; left time: 2387.1476s
	iters: 400, epoch: 18 | loss: 0.0160784
	speed: 0.0630s/iter; left time: 2426.2664s
Epoch: 18 cost time: 29.142317533493042
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0043976
	speed: 0.2435s/iter; left time: 9339.8666s
	iters: 200, epoch: 19 | loss: 0.0208768
	speed: 0.0598s/iter; left time: 2287.3612s
	iters: 300, epoch: 19 | loss: 0.0543703
	speed: 0.0606s/iter; left time: 2312.2745s
	iters: 400, epoch: 19 | loss: 0.0018394
	speed: 0.0608s/iter; left time: 2312.3064s
Epoch: 19 cost time: 28.466548442840576
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0010178
	speed: 0.2565s/iter; left time: 9718.2363s
	iters: 200, epoch: 20 | loss: 0.0201408
	speed: 0.0613s/iter; left time: 2318.3639s
	iters: 300, epoch: 20 | loss: 0.0019344
	speed: 0.0602s/iter; left time: 2267.3151s
	iters: 400, epoch: 20 | loss: 0.0052477
	speed: 0.0623s/iter; left time: 2342.9142s
Epoch: 20 cost time: 28.97508454322815
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0006313
	speed: 0.2473s/iter; left time: 9253.6917s
	iters: 200, epoch: 21 | loss: 0.2324714
	speed: 0.0608s/iter; left time: 2267.5855s
	iters: 300, epoch: 21 | loss: 0.0063086
	speed: 0.0606s/iter; left time: 2256.8456s
	iters: 400, epoch: 21 | loss: 0.0027816
	speed: 0.0621s/iter; left time: 2305.7525s
Epoch: 21 cost time: 28.882152557373047
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0875555
	speed: 0.2463s/iter; left time: 9101.9082s
	iters: 200, epoch: 22 | loss: 0.0012248
	speed: 0.0602s/iter; left time: 2218.3834s
	iters: 300, epoch: 22 | loss: 0.0000287
	speed: 0.0603s/iter; left time: 2215.6427s
	iters: 400, epoch: 22 | loss: 0.0051069
	speed: 0.0616s/iter; left time: 2256.1863s
Epoch: 22 cost time: 28.59519624710083
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0035887
	speed: 0.2439s/iter; left time: 8898.3861s
	iters: 200, epoch: 23 | loss: 0.0195323
	speed: 0.0598s/iter; left time: 2176.8504s
	iters: 300, epoch: 23 | loss: 0.0158756
	speed: 0.0582s/iter; left time: 2112.0436s
	iters: 400, epoch: 23 | loss: 0.0003804
	speed: 0.0627s/iter; left time: 2269.0979s
Epoch: 23 cost time: 28.367563247680664
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 180682
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6563200
	speed: 0.0642s/iter; left time: 3006.8786s
	iters: 200, epoch: 1 | loss: 1.2748504
	speed: 0.0481s/iter; left time: 2244.3160s
	iters: 300, epoch: 1 | loss: 0.5699117
	speed: 0.0481s/iter; left time: 2242.1765s
	iters: 400, epoch: 1 | loss: 0.1805082
	speed: 0.0498s/iter; left time: 2316.6533s
Epoch: 1 cost time: 24.627131700515747
Epoch: 1, Steps: 469 | Train Loss: 0.927 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
Validation loss decreased (inf --> -0.898510).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1190809
	speed: 0.1764s/iter; left time: 8172.4785s
	iters: 200, epoch: 2 | loss: 0.1304794
	speed: 0.0480s/iter; left time: 2218.6734s
	iters: 300, epoch: 2 | loss: 0.1668306
	speed: 0.0509s/iter; left time: 2346.1872s
	iters: 400, epoch: 2 | loss: 0.1156457
	speed: 0.0576s/iter; left time: 2651.7876s
Epoch: 2 cost time: 25.4225435256958
Epoch: 2, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.898510 --> -0.962548).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0704290
	speed: 0.2410s/iter; left time: 11054.0492s
	iters: 200, epoch: 3 | loss: 0.0310226
	speed: 0.0586s/iter; left time: 2680.2487s
	iters: 300, epoch: 3 | loss: 0.0082810
	speed: 0.0618s/iter; left time: 2821.2717s
	iters: 400, epoch: 3 | loss: 0.0212236
	speed: 0.0619s/iter; left time: 2820.6270s
Epoch: 3 cost time: 28.604392528533936
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1900633
	speed: 0.2328s/iter; left time: 10569.3928s
	iters: 200, epoch: 4 | loss: 0.0151670
	speed: 0.0618s/iter; left time: 2799.6643s
	iters: 300, epoch: 4 | loss: 0.0495412
	speed: 0.0608s/iter; left time: 2747.2339s
	iters: 400, epoch: 4 | loss: 0.0828503
	speed: 0.0582s/iter; left time: 2625.6148s
Epoch: 4 cost time: 28.392255306243896
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0068140
	speed: 0.2556s/iter; left time: 11481.3561s
	iters: 200, epoch: 5 | loss: 0.0300215
	speed: 0.0582s/iter; left time: 2609.6669s
	iters: 300, epoch: 5 | loss: 0.1510791
	speed: 0.0572s/iter; left time: 2557.5006s
	iters: 400, epoch: 5 | loss: 0.0376064
	speed: 0.0592s/iter; left time: 2640.2747s
Epoch: 5 cost time: 28.208866596221924
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.953 Test Loss: 0.133 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0112106
	speed: 0.2543s/iter; left time: 11306.4418s
	iters: 200, epoch: 6 | loss: 0.0259253
	speed: 0.0603s/iter; left time: 2676.4244s
	iters: 300, epoch: 6 | loss: 0.1406025
	speed: 0.0605s/iter; left time: 2676.0382s
	iters: 400, epoch: 6 | loss: 0.0792454
	speed: 0.0584s/iter; left time: 2579.8166s
Epoch: 6 cost time: 28.44257426261902
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962548 --> -0.964836).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0113256
	speed: 0.2373s/iter; left time: 10436.4978s
	iters: 200, epoch: 7 | loss: 0.0514835
	speed: 0.0628s/iter; left time: 2757.5878s
	iters: 300, epoch: 7 | loss: 0.0684284
	speed: 0.0595s/iter; left time: 2604.2897s
	iters: 400, epoch: 7 | loss: 0.0191871
	speed: 0.0577s/iter; left time: 2520.9337s
Epoch: 7 cost time: 28.675304651260376
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0042332
	speed: 0.2555s/iter; left time: 11117.0352s
	iters: 200, epoch: 8 | loss: 0.0255683
	speed: 0.0603s/iter; left time: 2617.4983s
	iters: 300, epoch: 8 | loss: 0.2037128
	speed: 0.0574s/iter; left time: 2488.5209s
	iters: 400, epoch: 8 | loss: 0.0486424
	speed: 0.0620s/iter; left time: 2679.1195s
Epoch: 8 cost time: 28.65354633331299
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0091846
	speed: 0.2497s/iter; left time: 10748.5320s
	iters: 200, epoch: 9 | loss: 0.0039171
	speed: 0.0554s/iter; left time: 2378.9358s
	iters: 300, epoch: 9 | loss: 0.0123556
	speed: 0.0577s/iter; left time: 2471.9849s
	iters: 400, epoch: 9 | loss: 0.0071105
	speed: 0.0600s/iter; left time: 2566.9174s
Epoch: 9 cost time: 27.737313747406006
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.964836 --> -0.974270).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0707122
	speed: 0.2451s/iter; left time: 10437.2583s
	iters: 200, epoch: 10 | loss: 0.0320775
	speed: 0.0608s/iter; left time: 2581.3330s
	iters: 300, epoch: 10 | loss: 0.0055614
	speed: 0.0622s/iter; left time: 2637.7375s
	iters: 400, epoch: 10 | loss: 0.0384275
	speed: 0.0633s/iter; left time: 2677.9746s
Epoch: 10 cost time: 29.29184627532959
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0029062
	speed: 0.2378s/iter; left time: 10013.4571s
	iters: 200, epoch: 11 | loss: 0.0255486
	speed: 0.0596s/iter; left time: 2503.7652s
	iters: 300, epoch: 11 | loss: 0.0364610
	speed: 0.0587s/iter; left time: 2458.6020s
	iters: 400, epoch: 11 | loss: 0.2695020
	speed: 0.0622s/iter; left time: 2600.1897s
Epoch: 11 cost time: 28.274629831314087
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975985).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0758892
	speed: 0.2401s/iter; left time: 9999.1008s
	iters: 200, epoch: 12 | loss: 0.0018239
	speed: 0.0630s/iter; left time: 2616.0009s
	iters: 300, epoch: 12 | loss: 0.0034370
	speed: 0.0617s/iter; left time: 2557.3016s
	iters: 400, epoch: 12 | loss: 0.0075927
	speed: 0.0608s/iter; left time: 2515.1991s
Epoch: 12 cost time: 29.068683624267578
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0228522
	speed: 0.2287s/iter; left time: 9416.9740s
	iters: 200, epoch: 13 | loss: 0.0204316
	speed: 0.0609s/iter; left time: 2502.6403s
	iters: 300, epoch: 13 | loss: 0.0199532
	speed: 0.0643s/iter; left time: 2636.4309s
	iters: 400, epoch: 13 | loss: 0.0114703
	speed: 0.0623s/iter; left time: 2545.7427s
Epoch: 13 cost time: 29.06921148300171
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0016241
	speed: 0.2551s/iter; left time: 10384.7117s
	iters: 200, epoch: 14 | loss: 0.0012418
	speed: 0.0633s/iter; left time: 2568.9365s
	iters: 300, epoch: 14 | loss: 0.0735160
	speed: 0.0636s/iter; left time: 2576.5912s
	iters: 400, epoch: 14 | loss: 0.0180129
	speed: 0.0623s/iter; left time: 2517.3202s
Epoch: 14 cost time: 29.840851068496704
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0371347
	speed: 0.2573s/iter; left time: 10352.4796s
	iters: 200, epoch: 15 | loss: 0.0351717
	speed: 0.0598s/iter; left time: 2399.2323s
	iters: 300, epoch: 15 | loss: 0.0021438
	speed: 0.0599s/iter; left time: 2397.4872s
	iters: 400, epoch: 15 | loss: 0.0270215
	speed: 0.0555s/iter; left time: 2216.6771s
Epoch: 15 cost time: 28.129271268844604
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977415).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0023654
	speed: 0.2574s/iter; left time: 10235.3968s
	iters: 200, epoch: 16 | loss: 0.0015045
	speed: 0.0580s/iter; left time: 2299.4418s
	iters: 300, epoch: 16 | loss: 0.0078406
	speed: 0.0543s/iter; left time: 2149.6290s
	iters: 400, epoch: 16 | loss: 0.0004876
	speed: 0.0525s/iter; left time: 2073.0817s
Epoch: 16 cost time: 26.769076108932495
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000916
	speed: 0.2481s/iter; left time: 9749.2568s
	iters: 200, epoch: 17 | loss: 0.0061367
	speed: 0.0594s/iter; left time: 2326.7935s
	iters: 300, epoch: 17 | loss: 0.0078745
	speed: 0.0565s/iter; left time: 2210.5464s
	iters: 400, epoch: 17 | loss: 0.0036622
	speed: 0.0579s/iter; left time: 2256.1276s
Epoch: 17 cost time: 27.881073236465454
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0086121
	speed: 0.2586s/iter; left time: 10041.3411s
	iters: 200, epoch: 18 | loss: 0.0010273
	speed: 0.0597s/iter; left time: 2311.3095s
	iters: 300, epoch: 18 | loss: 0.0060120
	speed: 0.0592s/iter; left time: 2287.2074s
	iters: 400, epoch: 18 | loss: 0.1159896
	speed: 0.0620s/iter; left time: 2390.5967s
Epoch: 18 cost time: 28.974594831466675
Epoch: 18, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0005388
	speed: 0.2574s/iter; left time: 9872.7532s
	iters: 200, epoch: 19 | loss: 0.0053050
	speed: 0.0588s/iter; left time: 2248.1373s
	iters: 300, epoch: 19 | loss: 0.0017658
	speed: 0.0539s/iter; left time: 2055.3622s
	iters: 400, epoch: 19 | loss: 0.0004835
	speed: 0.0623s/iter; left time: 2371.5021s
Epoch: 19 cost time: 28.14945125579834
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0029326
	speed: 0.2415s/iter; left time: 9149.2735s
	iters: 200, epoch: 20 | loss: 0.0417779
	speed: 0.0550s/iter; left time: 2078.8361s
	iters: 300, epoch: 20 | loss: 0.0051266
	speed: 0.0603s/iter; left time: 2271.9117s
	iters: 400, epoch: 20 | loss: 0.0707577
	speed: 0.0599s/iter; left time: 2250.7727s
Epoch: 20 cost time: 28.23156762123108
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0041618
	speed: 0.2604s/iter; left time: 9743.2577s
	iters: 200, epoch: 21 | loss: 0.0157883
	speed: 0.0583s/iter; left time: 2175.1539s
	iters: 300, epoch: 21 | loss: 0.0074779
	speed: 0.0591s/iter; left time: 2198.2744s
	iters: 400, epoch: 21 | loss: 0.0643590
	speed: 0.0611s/iter; left time: 2267.2272s
Epoch: 21 cost time: 28.492988348007202
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0165025
	speed: 0.2545s/iter; left time: 9402.6909s
	iters: 200, epoch: 22 | loss: 0.0002203
	speed: 0.0585s/iter; left time: 2155.0663s
	iters: 300, epoch: 22 | loss: 0.0007128
	speed: 0.0596s/iter; left time: 2189.2084s
	iters: 400, epoch: 22 | loss: 0.0040868
	speed: 0.0615s/iter; left time: 2254.2600s
Epoch: 22 cost time: 28.621360778808594
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0044810
	speed: 0.2482s/iter; left time: 9054.9702s
	iters: 200, epoch: 23 | loss: 0.0678051
	speed: 0.0569s/iter; left time: 2068.5279s
	iters: 300, epoch: 23 | loss: 0.0557445
	speed: 0.0563s/iter; left time: 2041.9579s
	iters: 400, epoch: 23 | loss: 0.0176845
	speed: 0.0606s/iter; left time: 2193.8597s
Epoch: 23 cost time: 27.308512449264526
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.4994546
	speed: 0.2518s/iter; left time: 9066.8507s
	iters: 200, epoch: 24 | loss: 0.1341754
	speed: 0.0584s/iter; left time: 2097.6677s
	iters: 300, epoch: 24 | loss: 0.0018321
	speed: 0.0583s/iter; left time: 2088.5232s
	iters: 400, epoch: 24 | loss: 0.0209670
	speed: 0.0613s/iter; left time: 2189.1031s
Epoch: 24 cost time: 28.162306785583496
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0049619
	speed: 0.2535s/iter; left time: 9011.7931s
	iters: 200, epoch: 25 | loss: 0.0112166
	speed: 0.0587s/iter; left time: 2079.3631s
	iters: 300, epoch: 25 | loss: 0.0597660
	speed: 0.0584s/iter; left time: 2065.4736s
	iters: 400, epoch: 25 | loss: 0.0012875
	speed: 0.0606s/iter; left time: 2136.9267s
Epoch: 25 cost time: 27.94150471687317
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 180682
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5953997
	speed: 0.0772s/iter; left time: 3613.4494s
	iters: 200, epoch: 1 | loss: 1.1328868
	speed: 0.0583s/iter; left time: 2721.4717s
	iters: 300, epoch: 1 | loss: 0.5657960
	speed: 0.0597s/iter; left time: 2781.0683s
	iters: 400, epoch: 1 | loss: 0.1714733
	speed: 0.0549s/iter; left time: 2553.6419s
Epoch: 1 cost time: 29.027886629104614
Epoch: 1, Steps: 469 | Train Loss: 0.894 Vali Loss: 0.307 Vali Acc: 0.912 Test Loss: 0.307 Test Acc: 0.912
Validation loss decreased (inf --> -0.911661).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1836562
	speed: 0.2498s/iter; left time: 11574.7526s
	iters: 200, epoch: 2 | loss: 0.1397731
	speed: 0.0624s/iter; left time: 2884.4929s
	iters: 300, epoch: 2 | loss: 0.2501432
	speed: 0.0590s/iter; left time: 2720.0683s
	iters: 400, epoch: 2 | loss: 0.1005460
	speed: 0.0584s/iter; left time: 2688.4967s
Epoch: 2 cost time: 28.534289836883545
Epoch: 2, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.911661 --> -0.964835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1875614
	speed: 0.2460s/iter; left time: 11282.8921s
	iters: 200, epoch: 3 | loss: 0.0162826
	speed: 0.0615s/iter; left time: 2813.0761s
	iters: 300, epoch: 3 | loss: 0.0120896
	speed: 0.0615s/iter; left time: 2809.0745s
	iters: 400, epoch: 3 | loss: 0.0347276
	speed: 0.0548s/iter; left time: 2497.3910s
Epoch: 3 cost time: 28.443477153778076
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1163450
	speed: 0.2465s/iter; left time: 11187.8463s
	iters: 200, epoch: 4 | loss: 0.0076930
	speed: 0.0613s/iter; left time: 2774.6926s
	iters: 300, epoch: 4 | loss: 0.0513241
	speed: 0.0593s/iter; left time: 2682.2207s
	iters: 400, epoch: 4 | loss: 0.1340788
	speed: 0.0614s/iter; left time: 2768.2853s
Epoch: 4 cost time: 28.714518785476685
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0043170
	speed: 0.2502s/iter; left time: 11238.0154s
	iters: 200, epoch: 5 | loss: 0.0059515
	speed: 0.0613s/iter; left time: 2745.5392s
	iters: 300, epoch: 5 | loss: 0.0545553
	speed: 0.0574s/iter; left time: 2567.2926s
	iters: 400, epoch: 5 | loss: 0.0248456
	speed: 0.0541s/iter; left time: 2415.5495s
Epoch: 5 cost time: 27.704143285751343
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0036593
	speed: 0.1814s/iter; left time: 8065.2049s
	iters: 200, epoch: 6 | loss: 0.0169863
	speed: 0.0522s/iter; left time: 2317.5525s
	iters: 300, epoch: 6 | loss: 0.1168676
	speed: 0.0538s/iter; left time: 2379.7055s
	iters: 400, epoch: 6 | loss: 0.0948857
	speed: 0.0624s/iter; left time: 2753.4143s
Epoch: 6 cost time: 26.659547805786133
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.964835 --> -0.969410).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0069460
	speed: 0.2399s/iter; left time: 10550.3184s
	iters: 200, epoch: 7 | loss: 0.0039339
	speed: 0.0610s/iter; left time: 2677.9380s
	iters: 300, epoch: 7 | loss: 0.0081957
	speed: 0.0622s/iter; left time: 2723.3467s
	iters: 400, epoch: 7 | loss: 0.0146790
	speed: 0.0599s/iter; left time: 2616.9294s
Epoch: 7 cost time: 29.496124505996704
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0029814
	speed: 0.2525s/iter; left time: 10987.0803s
	iters: 200, epoch: 8 | loss: 0.0254236
	speed: 0.0598s/iter; left time: 2594.7475s
	iters: 300, epoch: 8 | loss: 0.0444870
	speed: 0.0602s/iter; left time: 2605.8530s
	iters: 400, epoch: 8 | loss: 0.0393029
	speed: 0.0589s/iter; left time: 2547.4478s
Epoch: 8 cost time: 28.135374546051025
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971983).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0205179
	speed: 0.2383s/iter; left time: 10257.2237s
	iters: 200, epoch: 9 | loss: 0.1674367
	speed: 0.0594s/iter; left time: 2549.2197s
	iters: 300, epoch: 9 | loss: 0.0094971
	speed: 0.0622s/iter; left time: 2666.5412s
	iters: 400, epoch: 9 | loss: 0.6030231
	speed: 0.0623s/iter; left time: 2663.9026s
Epoch: 9 cost time: 29.163681745529175
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0500313
	speed: 0.2388s/iter; left time: 10167.7484s
	iters: 200, epoch: 10 | loss: 0.0843966
	speed: 0.0609s/iter; left time: 2585.3400s
	iters: 300, epoch: 10 | loss: 0.0018200
	speed: 0.0584s/iter; left time: 2475.8739s
	iters: 400, epoch: 10 | loss: 0.0010915
	speed: 0.0600s/iter; left time: 2537.8627s
Epoch: 10 cost time: 28.23467206954956
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.971983 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0046430
	speed: 0.2407s/iter; left time: 10137.9053s
	iters: 200, epoch: 11 | loss: 0.0163352
	speed: 0.0586s/iter; left time: 2463.4310s
	iters: 300, epoch: 11 | loss: 0.0155763
	speed: 0.0593s/iter; left time: 2485.9906s
	iters: 400, epoch: 11 | loss: 0.4402110
	speed: 0.0596s/iter; left time: 2491.6273s
Epoch: 11 cost time: 27.836686849594116
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0017328
	speed: 0.2320s/iter; left time: 9662.8799s
	iters: 200, epoch: 12 | loss: 0.0007547
	speed: 0.0603s/iter; left time: 2505.7860s
	iters: 300, epoch: 12 | loss: 0.0073703
	speed: 0.0576s/iter; left time: 2388.9289s
	iters: 400, epoch: 12 | loss: 0.0007002
	speed: 0.0608s/iter; left time: 2514.3109s
Epoch: 12 cost time: 28.435004711151123
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0268449
	speed: 0.2549s/iter; left time: 10494.3215s
	iters: 200, epoch: 13 | loss: 0.0456425
	speed: 0.0626s/iter; left time: 2572.8276s
	iters: 300, epoch: 13 | loss: 0.0006592
	speed: 0.0638s/iter; left time: 2614.6047s
	iters: 400, epoch: 13 | loss: 0.0048178
	speed: 0.0646s/iter; left time: 2641.1907s
Epoch: 13 cost time: 29.48216485977173
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002882
	speed: 0.2513s/iter; left time: 10229.6173s
	iters: 200, epoch: 14 | loss: 0.0102807
	speed: 0.0615s/iter; left time: 2496.3230s
	iters: 300, epoch: 14 | loss: 0.0013683
	speed: 0.0596s/iter; left time: 2414.6300s
	iters: 400, epoch: 14 | loss: 0.0364466
	speed: 0.0591s/iter; left time: 2388.5779s
Epoch: 14 cost time: 28.77734923362732
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0828905
	speed: 0.2374s/iter; left time: 9552.7044s
	iters: 200, epoch: 15 | loss: 0.0100023
	speed: 0.0518s/iter; left time: 2080.1198s
	iters: 300, epoch: 15 | loss: 0.0012847
	speed: 0.0476s/iter; left time: 1903.9984s
	iters: 400, epoch: 15 | loss: 0.0087444
	speed: 0.0474s/iter; left time: 1892.9831s
Epoch: 15 cost time: 24.120015144348145
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0007578
	speed: 0.2172s/iter; left time: 8635.5907s
	iters: 200, epoch: 16 | loss: 0.0104169
	speed: 0.0559s/iter; left time: 2218.2327s
	iters: 300, epoch: 16 | loss: 0.0126056
	speed: 0.0613s/iter; left time: 2426.4672s
	iters: 400, epoch: 16 | loss: 0.0013368
	speed: 0.0580s/iter; left time: 2289.5654s
Epoch: 16 cost time: 27.86583375930786
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0009001
	speed: 0.2404s/iter; left time: 9447.2176s
	iters: 200, epoch: 17 | loss: 0.0016200
	speed: 0.0569s/iter; left time: 2230.9914s
	iters: 300, epoch: 17 | loss: 0.0642229
	speed: 0.0576s/iter; left time: 2252.1793s
	iters: 400, epoch: 17 | loss: 0.0047394
	speed: 0.0593s/iter; left time: 2314.3190s
Epoch: 17 cost time: 27.338647603988647
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0065596
	speed: 0.2403s/iter; left time: 9329.0184s
	iters: 200, epoch: 18 | loss: 0.0157249
	speed: 0.0568s/iter; left time: 2198.6336s
	iters: 300, epoch: 18 | loss: 0.0010016
	speed: 0.0583s/iter; left time: 2252.2352s
	iters: 400, epoch: 18 | loss: 0.1479222
	speed: 0.0565s/iter; left time: 2175.8865s
Epoch: 18 cost time: 27.157928705215454
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0029083
	speed: 0.2318s/iter; left time: 8890.6808s
	iters: 200, epoch: 19 | loss: 0.0009930
	speed: 0.0602s/iter; left time: 2304.6326s
	iters: 300, epoch: 19 | loss: 0.0011612
	speed: 0.0549s/iter; left time: 2095.7384s
	iters: 400, epoch: 19 | loss: 0.0023816
	speed: 0.0609s/iter; left time: 2318.0857s
Epoch: 19 cost time: 28.508978605270386
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0016051
	speed: 0.2378s/iter; left time: 9009.9433s
	iters: 200, epoch: 20 | loss: 0.0269359
	speed: 0.0596s/iter; left time: 2250.4602s
	iters: 300, epoch: 20 | loss: 0.0019916
	speed: 0.0557s/iter; left time: 2099.4212s
	iters: 400, epoch: 20 | loss: 0.0017111
	speed: 0.0615s/iter; left time: 2310.8040s
Epoch: 20 cost time: 28.260282278060913
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 180682
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2945013
	speed: 0.0761s/iter; left time: 3559.3009s
	iters: 200, epoch: 1 | loss: 2.2949355
	speed: 0.0581s/iter; left time: 2713.1376s
	iters: 300, epoch: 1 | loss: 2.2964604
	speed: 0.0580s/iter; left time: 2704.2580s
	iters: 400, epoch: 1 | loss: 2.3106163
	speed: 0.0608s/iter; left time: 2826.3954s
Epoch: 1 cost time: 29.639604568481445
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3016031
	speed: 0.2110s/iter; left time: 9777.9984s
	iters: 200, epoch: 2 | loss: 2.3070481
	speed: 0.0524s/iter; left time: 2423.9544s
	iters: 300, epoch: 2 | loss: 2.3000078
	speed: 0.0482s/iter; left time: 2223.5806s
	iters: 400, epoch: 2 | loss: 2.3022990
	speed: 0.0532s/iter; left time: 2450.0980s
Epoch: 2 cost time: 25.15733051300049
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3018308
	speed: 0.2188s/iter; left time: 10035.3198s
	iters: 200, epoch: 3 | loss: 2.3022571
	speed: 0.0554s/iter; left time: 2536.9911s
	iters: 300, epoch: 3 | loss: 2.2935810
	speed: 0.0604s/iter; left time: 2759.8057s
	iters: 400, epoch: 3 | loss: 2.2928100
	speed: 0.0613s/iter; left time: 2795.1153s
Epoch: 3 cost time: 27.786848068237305
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3017566
	speed: 0.2347s/iter; left time: 10656.0587s
	iters: 200, epoch: 4 | loss: 2.3149853
	speed: 0.0608s/iter; left time: 2754.0553s
	iters: 300, epoch: 4 | loss: 2.3042054
	speed: 0.0629s/iter; left time: 2844.7811s
	iters: 400, epoch: 4 | loss: 2.3065791
	speed: 0.0596s/iter; left time: 2688.7547s
Epoch: 4 cost time: 29.05944323539734
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.103751).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3071275
	speed: 0.2427s/iter; left time: 10904.7500s
	iters: 200, epoch: 5 | loss: 2.3085108
	speed: 0.0587s/iter; left time: 2629.9219s
	iters: 300, epoch: 5 | loss: 2.3090734
	speed: 0.0635s/iter; left time: 2840.1536s
	iters: 400, epoch: 5 | loss: 2.3045101
	speed: 0.0598s/iter; left time: 2667.6416s
Epoch: 5 cost time: 29.13999581336975
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2953587
	speed: 0.2338s/iter; left time: 10394.2783s
	iters: 200, epoch: 6 | loss: 2.2968197
	speed: 0.0617s/iter; left time: 2736.3176s
	iters: 300, epoch: 6 | loss: 2.3058443
	speed: 0.0588s/iter; left time: 2600.9676s
	iters: 400, epoch: 6 | loss: 2.3130500
	speed: 0.0645s/iter; left time: 2849.9317s
Epoch: 6 cost time: 28.661267280578613
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3020906
	speed: 0.1933s/iter; left time: 8504.1110s
	iters: 200, epoch: 7 | loss: 2.3049550
	speed: 0.0567s/iter; left time: 2489.4394s
	iters: 300, epoch: 7 | loss: 2.2986610
	speed: 0.0590s/iter; left time: 2583.7794s
	iters: 400, epoch: 7 | loss: 2.3033328
	speed: 0.0614s/iter; left time: 2683.2594s
Epoch: 7 cost time: 27.29749321937561
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3130996
	speed: 0.2356s/iter; left time: 10250.7786s
	iters: 200, epoch: 8 | loss: 2.3012419
	speed: 0.0612s/iter; left time: 2655.1200s
	iters: 300, epoch: 8 | loss: 2.3070350
	speed: 0.0600s/iter; left time: 2598.5613s
	iters: 400, epoch: 8 | loss: 2.2882247
	speed: 0.0618s/iter; left time: 2672.0419s
Epoch: 8 cost time: 28.74488067626953
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3051229
	speed: 0.2389s/iter; left time: 10284.4778s
	iters: 200, epoch: 9 | loss: 2.3016782
	speed: 0.0574s/iter; left time: 2465.7152s
	iters: 300, epoch: 9 | loss: 2.3121419
	speed: 0.0605s/iter; left time: 2591.0087s
	iters: 400, epoch: 9 | loss: 2.3007665
	speed: 0.0623s/iter; left time: 2664.7252s
Epoch: 9 cost time: 28.829579830169678
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3035276
	speed: 0.2322s/iter; left time: 9888.6300s
	iters: 200, epoch: 10 | loss: 2.3035102
	speed: 0.0570s/iter; left time: 2421.9809s
	iters: 300, epoch: 10 | loss: 2.3100429
	speed: 0.0591s/iter; left time: 2504.0630s
	iters: 400, epoch: 10 | loss: 2.3119862
	speed: 0.0599s/iter; left time: 2534.6194s
Epoch: 10 cost time: 28.401718378067017
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3082020
	speed: 0.2382s/iter; left time: 10029.7481s
	iters: 200, epoch: 11 | loss: 2.3063977
	speed: 0.0581s/iter; left time: 2442.1451s
	iters: 300, epoch: 11 | loss: 2.3084202
	speed: 0.0626s/iter; left time: 2621.9020s
	iters: 400, epoch: 11 | loss: 2.3190322
	speed: 0.0594s/iter; left time: 2482.0655s
Epoch: 11 cost time: 28.275725603103638
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2940826
	speed: 0.1880s/iter; left time: 7827.7711s
	iters: 200, epoch: 12 | loss: 2.3025672
	speed: 0.0534s/iter; left time: 2218.5227s
	iters: 300, epoch: 12 | loss: 2.2900422
	speed: 0.0592s/iter; left time: 2454.1410s
	iters: 400, epoch: 12 | loss: 2.3115699
	speed: 0.0595s/iter; left time: 2461.4942s
Epoch: 12 cost time: 26.9360830783844
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2956829
	speed: 0.2321s/iter; left time: 9555.3585s
	iters: 200, epoch: 13 | loss: 2.3004966
	speed: 0.0613s/iter; left time: 2519.0246s
	iters: 300, epoch: 13 | loss: 2.3046379
	speed: 0.0582s/iter; left time: 2386.5754s
	iters: 400, epoch: 13 | loss: 2.3178873
	speed: 0.0547s/iter; left time: 2237.5604s
Epoch: 13 cost time: 27.926518440246582
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2977524
	speed: 0.2143s/iter; left time: 8723.3906s
	iters: 200, epoch: 14 | loss: 2.3058217
	speed: 0.0536s/iter; left time: 2176.2017s
	iters: 300, epoch: 14 | loss: 2.2961934
	speed: 0.0612s/iter; left time: 2477.3787s
	iters: 400, epoch: 14 | loss: 2.3130820
	speed: 0.0581s/iter; left time: 2347.3910s
Epoch: 14 cost time: 27.86711812019348
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2846651
	speed: 0.2329s/iter; left time: 9371.5645s
	iters: 200, epoch: 15 | loss: 2.2950239
	speed: 0.0547s/iter; left time: 2197.1102s
	iters: 300, epoch: 15 | loss: 2.3054783
	speed: 0.0619s/iter; left time: 2477.1039s
	iters: 400, epoch: 15 | loss: 2.2983441
	speed: 0.0582s/iter; left time: 2322.2924s
Epoch: 15 cost time: 28.31007480621338
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3042703
	speed: 0.2295s/iter; left time: 9124.7994s
	iters: 200, epoch: 16 | loss: 2.3028674
	speed: 0.0586s/iter; left time: 2323.2009s
	iters: 300, epoch: 16 | loss: 2.3067925
	speed: 0.0607s/iter; left time: 2401.4961s
	iters: 400, epoch: 16 | loss: 2.2823844
	speed: 0.0565s/iter; left time: 2229.8779s
Epoch: 16 cost time: 28.098532915115356
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.2963824
	speed: 0.2271s/iter; left time: 8924.7236s
	iters: 200, epoch: 17 | loss: 2.3045728
	speed: 0.0570s/iter; left time: 2233.0993s
	iters: 300, epoch: 17 | loss: 2.2931235
	speed: 0.0595s/iter; left time: 2327.6541s
	iters: 400, epoch: 17 | loss: 2.3106759
	speed: 0.0556s/iter; left time: 2168.0712s
Epoch: 17 cost time: 27.724088191986084
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.3037200
	speed: 0.2318s/iter; left time: 9000.1757s
	iters: 200, epoch: 18 | loss: 2.3029385
	speed: 0.0543s/iter; left time: 2102.4868s
	iters: 300, epoch: 18 | loss: 2.3031330
	speed: 0.0528s/iter; left time: 2039.9185s
	iters: 400, epoch: 18 | loss: 2.3045714
	speed: 0.0477s/iter; left time: 1838.2446s
Epoch: 18 cost time: 25.71408438682556
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.3039460
	speed: 0.1884s/iter; left time: 7225.9928s
	iters: 200, epoch: 19 | loss: 2.2993569
	speed: 0.0542s/iter; left time: 2072.1058s
	iters: 300, epoch: 19 | loss: 2.3034673
	speed: 0.0532s/iter; left time: 2030.5833s
	iters: 400, epoch: 19 | loss: 2.3084512
	speed: 0.0575s/iter; left time: 2188.3290s
Epoch: 19 cost time: 26.616287231445312
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.3075387
	speed: 0.2407s/iter; left time: 9121.7096s
	iters: 200, epoch: 20 | loss: 2.2994075
	speed: 0.0599s/iter; left time: 2262.2246s
	iters: 300, epoch: 20 | loss: 2.2953694
	speed: 0.0610s/iter; left time: 2299.2759s
	iters: 400, epoch: 20 | loss: 2.3077588
	speed: 0.0601s/iter; left time: 2259.1057s
Epoch: 20 cost time: 28.86185336112976
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.2878792
	speed: 0.2205s/iter; left time: 8252.2696s
	iters: 200, epoch: 21 | loss: 2.3040469
	speed: 0.0596s/iter; left time: 2224.7577s
	iters: 300, epoch: 21 | loss: 2.2992754
	speed: 0.0532s/iter; left time: 1980.8768s
	iters: 400, epoch: 21 | loss: 2.3089063
	speed: 0.0565s/iter; left time: 2098.0341s
Epoch: 21 cost time: 26.887160062789917
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.3129587
	speed: 0.2116s/iter; left time: 7817.8695s
	iters: 200, epoch: 22 | loss: 2.2890937
	speed: 0.0591s/iter; left time: 2179.7024s
	iters: 300, epoch: 22 | loss: 2.3106117
	speed: 0.0543s/iter; left time: 1995.3722s
	iters: 400, epoch: 22 | loss: 2.2877898
	speed: 0.0545s/iter; left time: 1997.3145s
Epoch: 22 cost time: 26.266428232192993
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.2862177
	speed: 0.2140s/iter; left time: 7807.8206s
	iters: 200, epoch: 23 | loss: 2.2924418
	speed: 0.0581s/iter; left time: 2112.6330s
	iters: 300, epoch: 23 | loss: 2.3037646
	speed: 0.0529s/iter; left time: 1919.9286s
	iters: 400, epoch: 23 | loss: 2.3188787
	speed: 0.0548s/iter; left time: 1981.0893s
Epoch: 23 cost time: 26.258660554885864
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 180682
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3587973
	speed: 0.0763s/iter; left time: 3573.1914s
	iters: 200, epoch: 1 | loss: 0.7041723
	speed: 0.0590s/iter; left time: 2756.2678s
	iters: 300, epoch: 1 | loss: 0.6089451
	speed: 0.0592s/iter; left time: 2758.2076s
	iters: 400, epoch: 1 | loss: 0.2416735
	speed: 0.0572s/iter; left time: 2659.3256s
Epoch: 1 cost time: 29.185345888137817
Epoch: 1, Steps: 469 | Train Loss: 0.879 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (inf --> -0.930529).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2857126
	speed: 0.2277s/iter; left time: 10549.8199s
	iters: 200, epoch: 2 | loss: 0.1069279
	speed: 0.0541s/iter; left time: 2501.7090s
	iters: 300, epoch: 2 | loss: 0.1390535
	speed: 0.0640s/iter; left time: 2950.8972s
	iters: 400, epoch: 2 | loss: 0.1065968
	speed: 0.0554s/iter; left time: 2550.5583s
Epoch: 2 cost time: 28.3491849899292
Epoch: 2, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.930529 --> -0.950256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0874237
	speed: 0.2361s/iter; left time: 10829.6858s
	iters: 200, epoch: 3 | loss: 0.0306496
	speed: 0.0571s/iter; left time: 2612.8357s
	iters: 300, epoch: 3 | loss: 0.0310934
	speed: 0.0612s/iter; left time: 2796.5928s
	iters: 400, epoch: 3 | loss: 0.5029746
	speed: 0.0558s/iter; left time: 2544.4677s
Epoch: 3 cost time: 28.14912724494934
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.950256 --> -0.961977).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0380237
	speed: 0.2323s/iter; left time: 10545.9470s
	iters: 200, epoch: 4 | loss: 0.0040884
	speed: 0.0615s/iter; left time: 2786.3703s
	iters: 300, epoch: 4 | loss: 0.0066057
	speed: 0.0572s/iter; left time: 2582.9544s
	iters: 400, epoch: 4 | loss: 0.0186174
	speed: 0.0554s/iter; left time: 2498.5911s
Epoch: 4 cost time: 27.422818660736084
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.961977 --> -0.967981).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0458230
	speed: 0.1880s/iter; left time: 8446.4143s
	iters: 200, epoch: 5 | loss: 0.0370633
	speed: 0.0559s/iter; left time: 2506.2480s
	iters: 300, epoch: 5 | loss: 0.0214031
	speed: 0.0572s/iter; left time: 2558.0023s
	iters: 400, epoch: 5 | loss: 0.0782759
	speed: 0.0596s/iter; left time: 2657.5788s
Epoch: 5 cost time: 27.110142469406128
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.967981 --> -0.977701).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0742731
	speed: 0.2229s/iter; left time: 9911.2590s
	iters: 200, epoch: 6 | loss: 0.0117209
	speed: 0.0617s/iter; left time: 2736.5598s
	iters: 300, epoch: 6 | loss: 0.0154096
	speed: 0.0606s/iter; left time: 2682.4311s
	iters: 400, epoch: 6 | loss: 0.0028536
	speed: 0.0627s/iter; left time: 2767.0853s
Epoch: 6 cost time: 28.91976046562195
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0100473
	speed: 0.2347s/iter; left time: 10323.7982s
	iters: 200, epoch: 7 | loss: 0.1637968
	speed: 0.0589s/iter; left time: 2582.9428s
	iters: 300, epoch: 7 | loss: 0.0157003
	speed: 0.0610s/iter; left time: 2673.1897s
	iters: 400, epoch: 7 | loss: 0.0506075
	speed: 0.0558s/iter; left time: 2437.9728s
Epoch: 7 cost time: 28.163599014282227
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0855426
	speed: 0.2278s/iter; left time: 9914.1634s
	iters: 200, epoch: 8 | loss: 0.0592755
	speed: 0.0595s/iter; left time: 2584.0209s
	iters: 300, epoch: 8 | loss: 0.0086186
	speed: 0.0573s/iter; left time: 2483.4591s
	iters: 400, epoch: 8 | loss: 0.0028755
	speed: 0.0592s/iter; left time: 2559.4673s
Epoch: 8 cost time: 28.05097460746765
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0136356
	speed: 0.2229s/iter; left time: 9596.5174s
	iters: 200, epoch: 9 | loss: 0.0053134
	speed: 0.0644s/iter; left time: 2766.4216s
	iters: 300, epoch: 9 | loss: 0.0114537
	speed: 0.0574s/iter; left time: 2461.3158s
	iters: 400, epoch: 9 | loss: 0.0025887
	speed: 0.0623s/iter; left time: 2662.4035s
Epoch: 9 cost time: 28.284382820129395
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0008621
	speed: 0.2181s/iter; left time: 9288.3397s
	iters: 200, epoch: 10 | loss: 0.0008598
	speed: 0.0525s/iter; left time: 2231.5438s
	iters: 300, epoch: 10 | loss: 0.0033967
	speed: 0.0570s/iter; left time: 2416.0257s
	iters: 400, epoch: 10 | loss: 0.0028870
	speed: 0.0560s/iter; left time: 2368.4659s
Epoch: 10 cost time: 26.20621967315674
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0512887
	speed: 0.1996s/iter; left time: 8403.8356s
	iters: 200, epoch: 11 | loss: 0.0427711
	speed: 0.0606s/iter; left time: 2546.0476s
	iters: 300, epoch: 11 | loss: 0.1821503
	speed: 0.0645s/iter; left time: 2704.5141s
	iters: 400, epoch: 11 | loss: 0.0017010
	speed: 0.0600s/iter; left time: 2509.2079s
Epoch: 11 cost time: 29.132875204086304
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0006463
	speed: 0.2549s/iter; left time: 10613.7668s
	iters: 200, epoch: 12 | loss: 0.0017884
	speed: 0.0586s/iter; left time: 2434.5318s
	iters: 300, epoch: 12 | loss: 0.0088633
	speed: 0.0649s/iter; left time: 2690.1618s
	iters: 400, epoch: 12 | loss: 0.0151474
	speed: 0.0642s/iter; left time: 2653.8560s
Epoch: 12 cost time: 29.84779691696167
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0125535
	speed: 0.2476s/iter; left time: 10193.8976s
	iters: 200, epoch: 13 | loss: 0.0358233
	speed: 0.0619s/iter; left time: 2543.7464s
	iters: 300, epoch: 13 | loss: 0.7149053
	speed: 0.0597s/iter; left time: 2446.8529s
	iters: 400, epoch: 13 | loss: 0.0084694
	speed: 0.0583s/iter; left time: 2381.9620s
Epoch: 13 cost time: 28.759562730789185
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0071907
	speed: 0.2494s/iter; left time: 10152.9273s
	iters: 200, epoch: 14 | loss: 0.0023035
	speed: 0.0608s/iter; left time: 2469.4634s
	iters: 300, epoch: 14 | loss: 0.0135345
	speed: 0.0623s/iter; left time: 2525.2889s
	iters: 400, epoch: 14 | loss: 0.0004596
	speed: 0.0635s/iter; left time: 2566.7367s
Epoch: 14 cost time: 29.28052830696106
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0057926
	speed: 0.2443s/iter; left time: 9829.8548s
	iters: 200, epoch: 15 | loss: 0.0005185
	speed: 0.0617s/iter; left time: 2474.7787s
	iters: 300, epoch: 15 | loss: 0.0084265
	speed: 0.0607s/iter; left time: 2430.2505s
	iters: 400, epoch: 15 | loss: 0.0040335
	speed: 0.0596s/iter; left time: 2379.0389s
Epoch: 15 cost time: 29.311707019805908
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 131530
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6498917
	speed: 0.0729s/iter; left time: 3410.0264s
	iters: 200, epoch: 1 | loss: 0.7810317
	speed: 0.0610s/iter; left time: 2847.6319s
	iters: 300, epoch: 1 | loss: 0.6640711
	speed: 0.0562s/iter; left time: 2619.5600s
	iters: 400, epoch: 1 | loss: 0.2343786
	speed: 0.0617s/iter; left time: 2870.5844s
Epoch: 1 cost time: 29.605144500732422
Epoch: 1, Steps: 469 | Train Loss: 0.953 Vali Loss: 0.337 Vali Acc: 0.897 Test Loss: 0.337 Test Acc: 0.897
Validation loss decreased (inf --> -0.896509).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3288280
	speed: 0.2401s/iter; left time: 11122.2907s
	iters: 200, epoch: 2 | loss: 0.0945452
	speed: 0.0590s/iter; left time: 2729.0855s
	iters: 300, epoch: 2 | loss: 0.1477186
	speed: 0.0624s/iter; left time: 2876.8567s
	iters: 400, epoch: 2 | loss: 0.1114035
	speed: 0.0605s/iter; left time: 2785.5878s
Epoch: 2 cost time: 28.30050301551819
Epoch: 2, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.896509 --> -0.949684).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0749985
	speed: 0.2358s/iter; left time: 10812.7516s
	iters: 200, epoch: 3 | loss: 0.0514073
	speed: 0.0621s/iter; left time: 2842.2167s
	iters: 300, epoch: 3 | loss: 0.0310685
	speed: 0.0593s/iter; left time: 2707.4496s
	iters: 400, epoch: 3 | loss: 0.7091738
	speed: 0.0572s/iter; left time: 2606.8657s
Epoch: 3 cost time: 28.50047731399536
Epoch: 3, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.142 Vali Acc: 0.956 Test Loss: 0.142 Test Acc: 0.956
Validation loss decreased (-0.949684 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0687188
	speed: 0.2529s/iter; left time: 11481.0186s
	iters: 200, epoch: 4 | loss: 0.0093091
	speed: 0.0603s/iter; left time: 2730.5626s
	iters: 300, epoch: 4 | loss: 0.0110423
	speed: 0.0607s/iter; left time: 2745.0732s
	iters: 400, epoch: 4 | loss: 0.0724859
	speed: 0.0620s/iter; left time: 2796.2999s
Epoch: 4 cost time: 28.655810594558716
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.956259 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1960344
	speed: 0.2362s/iter; left time: 10609.6145s
	iters: 200, epoch: 5 | loss: 0.1511754
	speed: 0.0609s/iter; left time: 2729.3574s
	iters: 300, epoch: 5 | loss: 0.0167276
	speed: 0.0605s/iter; left time: 2706.4882s
	iters: 400, epoch: 5 | loss: 0.1413754
	speed: 0.0570s/iter; left time: 2545.7231s
Epoch: 5 cost time: 28.053897857666016
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.967123 --> -0.978272).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1794085
	speed: 0.2501s/iter; left time: 11117.4215s
	iters: 200, epoch: 6 | loss: 0.0271956
	speed: 0.0578s/iter; left time: 2561.6836s
	iters: 300, epoch: 6 | loss: 0.0530519
	speed: 0.0549s/iter; left time: 2429.8881s
	iters: 400, epoch: 6 | loss: 0.0092393
	speed: 0.0532s/iter; left time: 2350.0941s
Epoch: 6 cost time: 26.82221746444702
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0101961
	speed: 0.1829s/iter; left time: 8044.8165s
	iters: 200, epoch: 7 | loss: 0.2067102
	speed: 0.0548s/iter; left time: 2406.0058s
	iters: 300, epoch: 7 | loss: 0.0183181
	speed: 0.0617s/iter; left time: 2703.8302s
	iters: 400, epoch: 7 | loss: 0.0144907
	speed: 0.0607s/iter; left time: 2653.2184s
Epoch: 7 cost time: 27.316609144210815
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1749726
	speed: 0.2388s/iter; left time: 10393.7279s
	iters: 200, epoch: 8 | loss: 0.0276744
	speed: 0.0601s/iter; left time: 2609.3337s
	iters: 300, epoch: 8 | loss: 0.0120195
	speed: 0.0568s/iter; left time: 2459.6685s
	iters: 400, epoch: 8 | loss: 0.0033765
	speed: 0.0592s/iter; left time: 2559.4327s
Epoch: 8 cost time: 28.098207473754883
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1864204
	speed: 0.2325s/iter; left time: 10007.0415s
	iters: 200, epoch: 9 | loss: 0.0039481
	speed: 0.0594s/iter; left time: 2551.1890s
	iters: 300, epoch: 9 | loss: 0.0328378
	speed: 0.0594s/iter; left time: 2545.9235s
	iters: 400, epoch: 9 | loss: 0.0116661
	speed: 0.0547s/iter; left time: 2336.7544s
Epoch: 9 cost time: 27.68226432800293
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0018967
	speed: 0.2468s/iter; left time: 10509.4242s
	iters: 200, epoch: 10 | loss: 0.0061740
	speed: 0.0615s/iter; left time: 2611.8724s
	iters: 300, epoch: 10 | loss: 0.0023492
	speed: 0.0627s/iter; left time: 2657.2671s
	iters: 400, epoch: 10 | loss: 0.0122495
	speed: 0.0610s/iter; left time: 2580.1967s
Epoch: 10 cost time: 28.635780811309814
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0059195
	speed: 0.2560s/iter; left time: 10782.4449s
	iters: 200, epoch: 11 | loss: 0.0223429
	speed: 0.0603s/iter; left time: 2534.9526s
	iters: 300, epoch: 11 | loss: 0.0692240
	speed: 0.0618s/iter; left time: 2591.3586s
	iters: 400, epoch: 11 | loss: 0.0014643
	speed: 0.0630s/iter; left time: 2635.3159s
Epoch: 11 cost time: 29.238609313964844
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0045060
	speed: 0.2448s/iter; left time: 10195.0912s
	iters: 200, epoch: 12 | loss: 0.0034311
	speed: 0.0583s/iter; left time: 2420.1312s
	iters: 300, epoch: 12 | loss: 0.0518450
	speed: 0.0526s/iter; left time: 2180.7873s
	iters: 400, epoch: 12 | loss: 0.0222626
	speed: 0.0567s/iter; left time: 2343.4260s
Epoch: 12 cost time: 27.439197540283203
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0216018
	speed: 0.2370s/iter; left time: 9759.9281s
	iters: 200, epoch: 13 | loss: 0.0496104
	speed: 0.0611s/iter; left time: 2508.9619s
	iters: 300, epoch: 13 | loss: 0.5902871
	speed: 0.0591s/iter; left time: 2420.7945s
	iters: 400, epoch: 13 | loss: 0.0024975
	speed: 0.0572s/iter; left time: 2338.7548s
Epoch: 13 cost time: 28.138059377670288
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0143762
	speed: 0.2591s/iter; left time: 10544.8530s
	iters: 200, epoch: 14 | loss: 0.0082692
	speed: 0.0605s/iter; left time: 2455.0427s
	iters: 300, epoch: 14 | loss: 0.0330733
	speed: 0.0610s/iter; left time: 2469.6390s
	iters: 400, epoch: 14 | loss: 0.0004169
	speed: 0.0617s/iter; left time: 2493.8981s
Epoch: 14 cost time: 28.85399889945984
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0005796
	speed: 0.2524s/iter; left time: 10156.2620s
	iters: 200, epoch: 15 | loss: 0.0002916
	speed: 0.0583s/iter; left time: 2339.2168s
	iters: 300, epoch: 15 | loss: 0.0011627
	speed: 0.0618s/iter; left time: 2472.7885s
	iters: 400, epoch: 15 | loss: 0.0094708
	speed: 0.0597s/iter; left time: 2384.8744s
Epoch: 15 cost time: 28.7717387676239
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 131530
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7158024
	speed: 0.0759s/iter; left time: 3552.5280s
	iters: 200, epoch: 1 | loss: 0.7867542
	speed: 0.0611s/iter; left time: 2851.2630s
	iters: 300, epoch: 1 | loss: 0.7228414
	speed: 0.0625s/iter; left time: 2911.1405s
	iters: 400, epoch: 1 | loss: 0.3221573
	speed: 0.0613s/iter; left time: 2850.7107s
Epoch: 1 cost time: 30.429200887680054
Epoch: 1, Steps: 469 | Train Loss: 0.941 Vali Loss: 0.317 Vali Acc: 0.909 Test Loss: 0.317 Test Acc: 0.909
Validation loss decreased (inf --> -0.909088).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3006870
	speed: 0.2072s/iter; left time: 9599.6320s
	iters: 200, epoch: 2 | loss: 0.1324634
	speed: 0.0533s/iter; left time: 2464.8945s
	iters: 300, epoch: 2 | loss: 0.1201919
	speed: 0.0513s/iter; left time: 2368.3245s
	iters: 400, epoch: 2 | loss: 0.0937484
	speed: 0.0576s/iter; left time: 2653.2025s
Epoch: 2 cost time: 26.314046382904053
Epoch: 2, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.909088 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0718196
	speed: 0.2447s/iter; left time: 11220.8427s
	iters: 200, epoch: 3 | loss: 0.0193517
	speed: 0.0620s/iter; left time: 2838.6285s
	iters: 300, epoch: 3 | loss: 0.0542417
	speed: 0.0614s/iter; left time: 2801.8729s
	iters: 400, epoch: 3 | loss: 0.5849540
	speed: 0.0616s/iter; left time: 2807.3624s
Epoch: 3 cost time: 28.642768144607544
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.948826 --> -0.959976).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0831261
	speed: 0.2460s/iter; left time: 11165.9354s
	iters: 200, epoch: 4 | loss: 0.0075212
	speed: 0.0566s/iter; left time: 2565.0201s
	iters: 300, epoch: 4 | loss: 0.0532993
	speed: 0.0586s/iter; left time: 2647.0656s
	iters: 400, epoch: 4 | loss: 0.0276594
	speed: 0.0601s/iter; left time: 2712.1174s
Epoch: 4 cost time: 28.62646508216858
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.959976 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0197709
	speed: 0.2306s/iter; left time: 10358.2214s
	iters: 200, epoch: 5 | loss: 0.0212701
	speed: 0.0643s/iter; left time: 2880.5663s
	iters: 300, epoch: 5 | loss: 0.1626374
	speed: 0.0612s/iter; left time: 2735.0007s
	iters: 400, epoch: 5 | loss: 0.1027842
	speed: 0.0667s/iter; left time: 2976.7290s
Epoch: 5 cost time: 30.283494472503662
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.965979 --> -0.975985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0553197
	speed: 0.2397s/iter; left time: 10654.0823s
	iters: 200, epoch: 6 | loss: 0.0550558
	speed: 0.0596s/iter; left time: 2642.0864s
	iters: 300, epoch: 6 | loss: 0.0369439
	speed: 0.0580s/iter; left time: 2567.9788s
	iters: 400, epoch: 6 | loss: 0.0039509
	speed: 0.0592s/iter; left time: 2615.1446s
Epoch: 6 cost time: 28.588063716888428
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0607603
	speed: 0.2431s/iter; left time: 10694.9545s
	iters: 200, epoch: 7 | loss: 0.4803241
	speed: 0.0585s/iter; left time: 2566.8109s
	iters: 300, epoch: 7 | loss: 0.0537198
	speed: 0.0551s/iter; left time: 2411.0508s
	iters: 400, epoch: 7 | loss: 0.0116457
	speed: 0.0574s/iter; left time: 2509.5637s
Epoch: 7 cost time: 27.460055351257324
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1468729
	speed: 0.2291s/iter; left time: 9970.3246s
	iters: 200, epoch: 8 | loss: 0.0159492
	speed: 0.0603s/iter; left time: 2616.3160s
	iters: 300, epoch: 8 | loss: 0.0210096
	speed: 0.0574s/iter; left time: 2485.3468s
	iters: 400, epoch: 8 | loss: 0.0026821
	speed: 0.0609s/iter; left time: 2633.0161s
Epoch: 8 cost time: 28.307475566864014
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1576983
	speed: 0.2562s/iter; left time: 11027.5712s
	iters: 200, epoch: 9 | loss: 0.0030986
	speed: 0.0587s/iter; left time: 2523.1313s
	iters: 300, epoch: 9 | loss: 0.0141274
	speed: 0.0607s/iter; left time: 2598.9902s
	iters: 400, epoch: 9 | loss: 0.0034962
	speed: 0.0591s/iter; left time: 2526.2708s
Epoch: 9 cost time: 29.17431330680847
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0006339
	speed: 0.2534s/iter; left time: 10791.1045s
	iters: 200, epoch: 10 | loss: 0.0035859
	speed: 0.0616s/iter; left time: 2614.7480s
	iters: 300, epoch: 10 | loss: 0.0045840
	speed: 0.0601s/iter; left time: 2548.9351s
	iters: 400, epoch: 10 | loss: 0.0014371
	speed: 0.0573s/iter; left time: 2424.6005s
Epoch: 10 cost time: 28.613734483718872
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0027759
	speed: 0.2438s/iter; left time: 10267.1988s
	iters: 200, epoch: 11 | loss: 0.0040523
	speed: 0.0590s/iter; left time: 2476.6663s
	iters: 300, epoch: 11 | loss: 0.0029395
	speed: 0.0591s/iter; left time: 2477.8938s
	iters: 400, epoch: 11 | loss: 0.0175919
	speed: 0.0547s/iter; left time: 2285.4116s
Epoch: 11 cost time: 26.982603788375854
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0915592
	speed: 0.2429s/iter; left time: 10113.5932s
	iters: 200, epoch: 12 | loss: 0.0109695
	speed: 0.0570s/iter; left time: 2367.9621s
	iters: 300, epoch: 12 | loss: 0.0126240
	speed: 0.0585s/iter; left time: 2423.4952s
	iters: 400, epoch: 12 | loss: 0.0038241
	speed: 0.0595s/iter; left time: 2459.8656s
Epoch: 12 cost time: 27.820060968399048
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0043515
	speed: 0.2386s/iter; left time: 9824.1983s
	iters: 200, epoch: 13 | loss: 0.0016384
	speed: 0.0574s/iter; left time: 2359.3747s
	iters: 300, epoch: 13 | loss: 0.6562505
	speed: 0.0554s/iter; left time: 2268.5826s
	iters: 400, epoch: 13 | loss: 0.0117277
	speed: 0.0513s/iter; left time: 2097.4862s
Epoch: 13 cost time: 26.178720474243164
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0280629
	speed: 0.1683s/iter; left time: 6849.3417s
	iters: 200, epoch: 14 | loss: 0.0011183
	speed: 0.0478s/iter; left time: 1941.8083s
	iters: 300, epoch: 14 | loss: 0.0012390
	speed: 0.0468s/iter; left time: 1896.0579s
	iters: 400, epoch: 14 | loss: 0.0012088
	speed: 0.0460s/iter; left time: 1856.7196s
Epoch: 14 cost time: 22.693418264389038
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976843).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0352712
	speed: 0.2133s/iter; left time: 8580.8233s
	iters: 200, epoch: 15 | loss: 0.0266225
	speed: 0.0561s/iter; left time: 2249.7967s
	iters: 300, epoch: 15 | loss: 0.0074866
	speed: 0.0580s/iter; left time: 2321.2059s
	iters: 400, epoch: 15 | loss: 0.0064338
	speed: 0.0549s/iter; left time: 2192.4687s
Epoch: 15 cost time: 26.725038528442383
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0017266
	speed: 0.2352s/iter; left time: 9354.3360s
	iters: 200, epoch: 16 | loss: 0.0036404
	speed: 0.0593s/iter; left time: 2351.0173s
	iters: 300, epoch: 16 | loss: 0.0008423
	speed: 0.0567s/iter; left time: 2244.8504s
	iters: 400, epoch: 16 | loss: 0.0004954
	speed: 0.0573s/iter; left time: 2262.7052s
Epoch: 16 cost time: 27.808673620224
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0015381
	speed: 0.2321s/iter; left time: 9121.0803s
	iters: 200, epoch: 17 | loss: 0.0006807
	speed: 0.0573s/iter; left time: 2246.1500s
	iters: 300, epoch: 17 | loss: 0.0006869
	speed: 0.0553s/iter; left time: 2163.4765s
	iters: 400, epoch: 17 | loss: 0.0063846
	speed: 0.0596s/iter; left time: 2325.9780s
Epoch: 17 cost time: 27.628013372421265
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.966 Test Loss: 0.165 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0004457
	speed: 0.2309s/iter; left time: 8966.3083s
	iters: 200, epoch: 18 | loss: 0.0586476
	speed: 0.0550s/iter; left time: 2128.1563s
	iters: 300, epoch: 18 | loss: 0.0011982
	speed: 0.0572s/iter; left time: 2209.5918s
	iters: 400, epoch: 18 | loss: 0.0043084
	speed: 0.0564s/iter; left time: 2173.1371s
Epoch: 18 cost time: 26.372408151626587
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0005690
	speed: 0.2283s/iter; left time: 8756.4855s
	iters: 200, epoch: 19 | loss: 0.0314443
	speed: 0.0582s/iter; left time: 2227.9794s
	iters: 300, epoch: 19 | loss: 0.2166491
	speed: 0.0572s/iter; left time: 2184.4791s
	iters: 400, epoch: 19 | loss: 0.0042452
	speed: 0.0537s/iter; left time: 2044.7635s
Epoch: 19 cost time: 26.452502250671387
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002522
	speed: 0.1823s/iter; left time: 6907.2660s
	iters: 200, epoch: 20 | loss: 0.0010037
	speed: 0.0517s/iter; left time: 1955.1147s
	iters: 300, epoch: 20 | loss: 0.0049706
	speed: 0.0574s/iter; left time: 2161.7623s
	iters: 400, epoch: 20 | loss: 0.0012850
	speed: 0.0573s/iter; left time: 2153.7376s
Epoch: 20 cost time: 25.967809677124023
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0134374
	speed: 0.2326s/iter; left time: 8704.2236s
	iters: 200, epoch: 21 | loss: 0.0001263
	speed: 0.0628s/iter; left time: 2344.3453s
	iters: 300, epoch: 21 | loss: 0.0009775
	speed: 0.0593s/iter; left time: 2207.4594s
	iters: 400, epoch: 21 | loss: 0.0216084
	speed: 0.0595s/iter; left time: 2207.7292s
Epoch: 21 cost time: 28.328493118286133
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0294388
	speed: 0.2280s/iter; left time: 8425.5409s
	iters: 200, epoch: 22 | loss: 0.0054043
	speed: 0.0583s/iter; left time: 2146.6651s
	iters: 300, epoch: 22 | loss: 0.0724525
	speed: 0.0537s/iter; left time: 1973.8099s
	iters: 400, epoch: 22 | loss: 0.0033977
	speed: 0.0580s/iter; left time: 2127.4613s
Epoch: 22 cost time: 26.802818298339844
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0047242
	speed: 0.2141s/iter; left time: 7811.3583s
	iters: 200, epoch: 23 | loss: 0.0052866
	speed: 0.0568s/iter; left time: 2066.7970s
	iters: 300, epoch: 23 | loss: 0.0028343
	speed: 0.0554s/iter; left time: 2008.4771s
	iters: 400, epoch: 23 | loss: 0.0015437
	speed: 0.0541s/iter; left time: 1958.9999s
Epoch: 23 cost time: 26.134920835494995
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0009757
	speed: 0.2038s/iter; left time: 7340.3954s
	iters: 200, epoch: 24 | loss: 0.0247787
	speed: 0.0573s/iter; left time: 2058.1543s
	iters: 300, epoch: 24 | loss: 0.0057957
	speed: 0.0514s/iter; left time: 1839.5462s
	iters: 400, epoch: 24 | loss: 0.0000564
	speed: 0.0564s/iter; left time: 2015.9174s
Epoch: 24 cost time: 25.978806257247925
Epoch: 24, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
Validation loss decreased (-0.978272 --> -0.985419).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0270652
	speed: 0.2003s/iter; left time: 7118.6270s
	iters: 200, epoch: 25 | loss: 0.0002389
	speed: 0.0512s/iter; left time: 1815.6211s
	iters: 300, epoch: 25 | loss: 0.0226900
	speed: 0.0500s/iter; left time: 1768.2279s
	iters: 400, epoch: 25 | loss: 0.0142131
	speed: 0.0515s/iter; left time: 1815.1067s
Epoch: 25 cost time: 24.282559871673584
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0004719
	speed: 0.1868s/iter; left time: 6550.6575s
	iters: 200, epoch: 26 | loss: 0.0002399
	speed: 0.0524s/iter; left time: 1834.3386s
	iters: 300, epoch: 26 | loss: 0.0385162
	speed: 0.0497s/iter; left time: 1733.2985s
	iters: 400, epoch: 26 | loss: 0.0136275
	speed: 0.0511s/iter; left time: 1778.5763s
Epoch: 26 cost time: 24.15308451652527
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0154423
	speed: 0.1808s/iter; left time: 6257.1603s
	iters: 200, epoch: 27 | loss: 0.1028586
	speed: 0.0577s/iter; left time: 1992.4351s
	iters: 300, epoch: 27 | loss: 0.2207659
	speed: 0.0563s/iter; left time: 1938.7162s
	iters: 400, epoch: 27 | loss: 0.0040673
	speed: 0.0586s/iter; left time: 2010.9718s
Epoch: 27 cost time: 27.156682014465332
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0469582
	speed: 0.2255s/iter; left time: 7698.6387s
	iters: 200, epoch: 28 | loss: 0.0189003
	speed: 0.0550s/iter; left time: 1871.3090s
	iters: 300, epoch: 28 | loss: 0.0001006
	speed: 0.0566s/iter; left time: 1920.7787s
	iters: 400, epoch: 28 | loss: 0.0166621
	speed: 0.0573s/iter; left time: 1937.9602s
Epoch: 28 cost time: 26.71369767189026
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0545344
	speed: 0.2120s/iter; left time: 7137.6567s
	iters: 200, epoch: 29 | loss: 0.0001511
	speed: 0.0575s/iter; left time: 1930.0504s
	iters: 300, epoch: 29 | loss: 0.0002862
	speed: 0.0524s/iter; left time: 1752.8856s
	iters: 400, epoch: 29 | loss: 0.0014113
	speed: 0.0569s/iter; left time: 1900.2541s
Epoch: 29 cost time: 26.413512706756592
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0052680
	speed: 0.2318s/iter; left time: 7695.5541s
	iters: 200, epoch: 30 | loss: 0.0003937
	speed: 0.0614s/iter; left time: 2032.8989s
	iters: 300, epoch: 30 | loss: 0.0004526
	speed: 0.0578s/iter; left time: 1906.3909s
	iters: 400, epoch: 30 | loss: 0.0018234
	speed: 0.0602s/iter; left time: 1981.7782s
Epoch: 30 cost time: 28.304412603378296
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0010651
	speed: 0.2281s/iter; left time: 7465.4463s
	iters: 200, epoch: 31 | loss: 0.0002664
	speed: 0.0621s/iter; left time: 2026.6719s
	iters: 300, epoch: 31 | loss: 0.0004111
	speed: 0.0586s/iter; left time: 1905.8433s
	iters: 400, epoch: 31 | loss: 0.1426092
	speed: 0.0608s/iter; left time: 1970.9358s
Epoch: 31 cost time: 28.44313097000122
Epoch: 31, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0041900
	speed: 0.2218s/iter; left time: 7155.8686s
	iters: 200, epoch: 32 | loss: 0.0017314
	speed: 0.0565s/iter; left time: 1817.7004s
	iters: 300, epoch: 32 | loss: 0.0006447
	speed: 0.0588s/iter; left time: 1886.6927s
	iters: 400, epoch: 32 | loss: 0.0029467
	speed: 0.0578s/iter; left time: 1846.2064s
Epoch: 32 cost time: 27.62647819519043
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0090670
	speed: 0.2336s/iter; left time: 7426.7812s
	iters: 200, epoch: 33 | loss: 0.6187353
	speed: 0.0549s/iter; left time: 1739.7594s
	iters: 300, epoch: 33 | loss: 0.0005718
	speed: 0.0585s/iter; left time: 1849.3035s
	iters: 400, epoch: 33 | loss: 0.0003016
	speed: 0.0554s/iter; left time: 1745.8436s
Epoch: 33 cost time: 27.13630962371826
Epoch: 33, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0042280
	speed: 0.2177s/iter; left time: 6818.3931s
	iters: 200, epoch: 34 | loss: 0.0001529
	speed: 0.0529s/iter; left time: 1651.2831s
	iters: 300, epoch: 34 | loss: 0.0013509
	speed: 0.0528s/iter; left time: 1643.7466s
	iters: 400, epoch: 34 | loss: 0.0182863
	speed: 0.0522s/iter; left time: 1619.7605s
Epoch: 34 cost time: 25.84271240234375
Epoch: 34, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 131530
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3020048
	speed: 0.0665s/iter; left time: 3110.5969s
	iters: 200, epoch: 1 | loss: 2.2994764
	speed: 0.0477s/iter; left time: 2225.8162s
	iters: 300, epoch: 1 | loss: 2.2989936
	speed: 0.0478s/iter; left time: 2228.3730s
	iters: 400, epoch: 1 | loss: 2.2956762
	speed: 0.0518s/iter; left time: 2410.8927s
Epoch: 1 cost time: 25.07848882675171
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.103751).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3006263
	speed: 0.2108s/iter; left time: 9767.1305s
	iters: 200, epoch: 2 | loss: 2.3001122
	speed: 0.0523s/iter; left time: 2415.8047s
	iters: 300, epoch: 2 | loss: 2.2995851
	speed: 0.0566s/iter; left time: 2613.0137s
	iters: 400, epoch: 2 | loss: 2.2958622
	speed: 0.0523s/iter; left time: 2405.7677s
Epoch: 2 cost time: 25.79005217552185
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.103751 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3039563
	speed: 0.2128s/iter; left time: 9761.7341s
	iters: 200, epoch: 3 | loss: 2.2925239
	speed: 0.0515s/iter; left time: 2355.3829s
	iters: 300, epoch: 3 | loss: 2.2918844
	speed: 0.0562s/iter; left time: 2564.6555s
	iters: 400, epoch: 3 | loss: 2.3039334
	speed: 0.0511s/iter; left time: 2329.1799s
Epoch: 3 cost time: 25.693474531173706
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3107650
	speed: 0.2121s/iter; left time: 9628.3761s
	iters: 200, epoch: 4 | loss: 2.2978222
	speed: 0.0525s/iter; left time: 2378.3888s
	iters: 300, epoch: 4 | loss: 2.3044121
	speed: 0.0595s/iter; left time: 2688.0232s
	iters: 400, epoch: 4 | loss: 2.3059132
	speed: 0.0515s/iter; left time: 2323.4798s
Epoch: 4 cost time: 26.226278066635132
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3087769
	speed: 0.2104s/iter; left time: 9451.5527s
	iters: 200, epoch: 5 | loss: 2.2999001
	speed: 0.0516s/iter; left time: 2311.9805s
	iters: 300, epoch: 5 | loss: 2.3131211
	speed: 0.0483s/iter; left time: 2161.6009s
	iters: 400, epoch: 5 | loss: 2.2962811
	speed: 0.0493s/iter; left time: 2198.7912s
Epoch: 5 cost time: 24.323200941085815
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2900620
	speed: 0.1726s/iter; left time: 7674.2089s
	iters: 200, epoch: 6 | loss: 2.3094187
	speed: 0.0489s/iter; left time: 2169.1772s
	iters: 300, epoch: 6 | loss: 2.2779639
	speed: 0.0489s/iter; left time: 2166.0306s
	iters: 400, epoch: 6 | loss: 2.2938857
	speed: 0.0475s/iter; left time: 2095.9475s
Epoch: 6 cost time: 22.803293466567993
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2926295
	speed: 0.1651s/iter; left time: 7263.4789s
	iters: 200, epoch: 7 | loss: 2.2948947
	speed: 0.0455s/iter; left time: 1997.0691s
	iters: 300, epoch: 7 | loss: 2.2956619
	speed: 0.0484s/iter; left time: 2121.4124s
	iters: 400, epoch: 7 | loss: 2.3018503
	speed: 0.0544s/iter; left time: 2378.5802s
Epoch: 7 cost time: 23.687070846557617
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3038161
	speed: 0.2172s/iter; left time: 9454.0336s
	iters: 200, epoch: 8 | loss: 2.2972298
	speed: 0.0553s/iter; left time: 2401.7151s
	iters: 300, epoch: 8 | loss: 2.2971640
	speed: 0.0526s/iter; left time: 2278.7672s
	iters: 400, epoch: 8 | loss: 2.3054881
	speed: 0.0544s/iter; left time: 2350.3155s
Epoch: 8 cost time: 26.01911163330078
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3139067
	speed: 0.2062s/iter; left time: 8875.4871s
	iters: 200, epoch: 9 | loss: 2.3225665
	speed: 0.0514s/iter; left time: 2206.9113s
	iters: 300, epoch: 9 | loss: 2.3017683
	speed: 0.0539s/iter; left time: 2311.1371s
	iters: 400, epoch: 9 | loss: 2.3145344
	speed: 0.0500s/iter; left time: 2137.6502s
Epoch: 9 cost time: 25.110635995864868
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3038328
	speed: 0.2045s/iter; left time: 8708.3266s
	iters: 200, epoch: 10 | loss: 2.3061886
	speed: 0.0542s/iter; left time: 2304.2379s
	iters: 300, epoch: 10 | loss: 2.2980905
	speed: 0.0565s/iter; left time: 2393.3714s
	iters: 400, epoch: 10 | loss: 2.2898192
	speed: 0.0583s/iter; left time: 2466.1833s
Epoch: 10 cost time: 26.543583393096924
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3126392
	speed: 0.2149s/iter; left time: 9050.4740s
	iters: 200, epoch: 11 | loss: 2.3179886
	speed: 0.0567s/iter; left time: 2382.6953s
	iters: 300, epoch: 11 | loss: 2.2829676
	speed: 0.0522s/iter; left time: 2187.3687s
	iters: 400, epoch: 11 | loss: 2.2992582
	speed: 0.0554s/iter; left time: 2316.6004s
Epoch: 11 cost time: 26.10804033279419
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3423824
	speed: 0.2107s/iter; left time: 8774.1044s
	iters: 200, epoch: 12 | loss: 2.3031046
	speed: 0.0514s/iter; left time: 2135.5905s
	iters: 300, epoch: 12 | loss: 2.3123047
	speed: 0.0501s/iter; left time: 2076.8427s
	iters: 400, epoch: 12 | loss: 2.2930148
	speed: 0.0508s/iter; left time: 2100.1174s
Epoch: 12 cost time: 24.15165662765503
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2999783
	speed: 0.1752s/iter; left time: 7212.0355s
	iters: 200, epoch: 13 | loss: 2.3068850
	speed: 0.0504s/iter; left time: 2069.9634s
	iters: 300, epoch: 13 | loss: 2.3035100
	speed: 0.0496s/iter; left time: 2032.3088s
	iters: 400, epoch: 13 | loss: 2.2906373
	speed: 0.0498s/iter; left time: 2034.1260s
Epoch: 13 cost time: 23.687178373336792
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2883675
	speed: 0.1706s/iter; left time: 6946.1291s
	iters: 200, epoch: 14 | loss: 2.3060508
	speed: 0.0596s/iter; left time: 2421.1557s
	iters: 300, epoch: 14 | loss: 2.2995675
	speed: 0.0529s/iter; left time: 2143.5874s
	iters: 400, epoch: 14 | loss: 2.2827935
	speed: 0.0558s/iter; left time: 2253.8954s
Epoch: 14 cost time: 25.752787590026855
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.2965219
	speed: 0.2089s/iter; left time: 8405.5686s
	iters: 200, epoch: 15 | loss: 2.3076725
	speed: 0.0552s/iter; left time: 2215.1676s
	iters: 300, epoch: 15 | loss: 2.2829938
	speed: 0.0582s/iter; left time: 2331.9468s
	iters: 400, epoch: 15 | loss: 2.3102944
	speed: 0.0565s/iter; left time: 2254.7882s
Epoch: 15 cost time: 26.882192611694336
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3111947
	speed: 0.2210s/iter; left time: 8786.8586s
	iters: 200, epoch: 16 | loss: 2.2997975
	speed: 0.0577s/iter; left time: 2289.9639s
	iters: 300, epoch: 16 | loss: 2.3143423
	speed: 0.0569s/iter; left time: 2252.2273s
	iters: 400, epoch: 16 | loss: 2.2993300
	speed: 0.0569s/iter; left time: 2247.2019s
Epoch: 16 cost time: 26.961784601211548
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3024898
	speed: 0.2209s/iter; left time: 8680.8595s
	iters: 200, epoch: 17 | loss: 2.3023484
	speed: 0.0543s/iter; left time: 2129.1139s
	iters: 300, epoch: 17 | loss: 2.3148022
	speed: 0.0550s/iter; left time: 2148.4587s
	iters: 400, epoch: 17 | loss: 2.3180535
	speed: 0.0545s/iter; left time: 2126.1089s
Epoch: 17 cost time: 26.357860326766968
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.2885139
	speed: 0.2222s/iter; left time: 8625.8637s
	iters: 200, epoch: 18 | loss: 2.3001170
	speed: 0.0529s/iter; left time: 2047.2280s
	iters: 300, epoch: 18 | loss: 2.3185265
	speed: 0.0576s/iter; left time: 2226.4187s
	iters: 400, epoch: 18 | loss: 2.2939460
	speed: 0.0550s/iter; left time: 2120.8179s
Epoch: 18 cost time: 26.52327823638916
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.3107290
	speed: 0.2230s/iter; left time: 8553.8649s
	iters: 200, epoch: 19 | loss: 2.2946734
	speed: 0.0577s/iter; left time: 2208.4830s
	iters: 300, epoch: 19 | loss: 2.2957857
	speed: 0.0537s/iter; left time: 2049.1344s
	iters: 400, epoch: 19 | loss: 2.3207953
	speed: 0.0603s/iter; left time: 2294.6656s
Epoch: 19 cost time: 26.82898759841919
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.2944317
	speed: 0.2213s/iter; left time: 8384.2365s
	iters: 200, epoch: 20 | loss: 2.3017988
	speed: 0.0511s/iter; left time: 1930.0370s
	iters: 300, epoch: 20 | loss: 2.2903728
	speed: 0.0554s/iter; left time: 2089.5992s
	iters: 400, epoch: 20 | loss: 2.3077636
	speed: 0.0537s/iter; left time: 2020.1240s
Epoch: 20 cost time: 25.92651867866516
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.3027694
	speed: 0.1712s/iter; left time: 6406.6531s
	iters: 200, epoch: 21 | loss: 2.2786384
	speed: 0.0500s/iter; left time: 1864.7657s
	iters: 300, epoch: 21 | loss: 2.2893267
	speed: 0.0499s/iter; left time: 1857.0967s
	iters: 400, epoch: 21 | loss: 2.3042173
	speed: 0.0512s/iter; left time: 1899.4437s
Epoch: 21 cost time: 23.559043169021606
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.3089423
	speed: 0.2142s/iter; left time: 7914.9788s
	iters: 200, epoch: 22 | loss: 2.2931881
	speed: 0.0567s/iter; left time: 2090.2621s
	iters: 300, epoch: 22 | loss: 2.2916064
	speed: 0.0610s/iter; left time: 2241.1289s
	iters: 400, epoch: 22 | loss: 2.3086321
	speed: 0.0600s/iter; left time: 2199.4741s
Epoch: 22 cost time: 27.51338529586792
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 23 | loss: 2.2843792
	speed: 0.2091s/iter; left time: 7630.1650s
	iters: 200, epoch: 23 | loss: 2.2885933
	speed: 0.0531s/iter; left time: 1932.5420s
	iters: 300, epoch: 23 | loss: 2.3033917
	speed: 0.0572s/iter; left time: 2074.5867s
	iters: 400, epoch: 23 | loss: 2.3044012
	speed: 0.0546s/iter; left time: 1976.5290s
Epoch: 23 cost time: 26.367026567459106
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 2.3128800
	speed: 0.2113s/iter; left time: 7608.0881s
	iters: 200, epoch: 24 | loss: 2.3191895
	speed: 0.0554s/iter; left time: 1988.4056s
	iters: 300, epoch: 24 | loss: 2.3111401
	speed: 0.0598s/iter; left time: 2140.2516s
	iters: 400, epoch: 24 | loss: 2.2939692
	speed: 0.0556s/iter; left time: 1987.3290s
Epoch: 24 cost time: 27.067747354507446
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 2.2935433
	speed: 0.2146s/iter; left time: 7626.9108s
	iters: 200, epoch: 25 | loss: 2.2996192
	speed: 0.0564s/iter; left time: 1998.1898s
	iters: 300, epoch: 25 | loss: 2.3069322
	speed: 0.0556s/iter; left time: 1965.0228s
	iters: 400, epoch: 25 | loss: 2.2987540
	speed: 0.0541s/iter; left time: 1907.4794s
Epoch: 25 cost time: 26.64580512046814
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 2.2922921
	speed: 0.2184s/iter; left time: 7661.0203s
	iters: 200, epoch: 26 | loss: 2.3285203
	speed: 0.0580s/iter; left time: 2027.5547s
	iters: 300, epoch: 26 | loss: 2.3086727
	speed: 0.0559s/iter; left time: 1949.3664s
	iters: 400, epoch: 26 | loss: 2.2800272
	speed: 0.0576s/iter; left time: 2001.8950s
Epoch: 26 cost time: 26.690658807754517
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 2.3031974
	speed: 0.2149s/iter; left time: 7438.5585s
	iters: 200, epoch: 27 | loss: 2.2928205
	speed: 0.0544s/iter; left time: 1878.2833s
	iters: 300, epoch: 27 | loss: 2.3105907
	speed: 0.0555s/iter; left time: 1910.7953s
	iters: 400, epoch: 27 | loss: 2.2894216
	speed: 0.0540s/iter; left time: 1854.0846s
Epoch: 27 cost time: 26.080043077468872
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 2.3159623
	speed: 0.2030s/iter; left time: 6930.3417s
	iters: 200, epoch: 28 | loss: 2.3106291
	speed: 0.0525s/iter; left time: 1787.2668s
	iters: 300, epoch: 28 | loss: 2.2970970
	speed: 0.0565s/iter; left time: 1918.8926s
	iters: 400, epoch: 28 | loss: 2.2945356
	speed: 0.0551s/iter; left time: 1864.9647s
Epoch: 28 cost time: 26.21939253807068
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 2.2977221
	speed: 0.2158s/iter; left time: 7264.8897s
	iters: 200, epoch: 29 | loss: 2.2998815
	speed: 0.0500s/iter; left time: 1678.1348s
	iters: 300, epoch: 29 | loss: 2.3157623
	speed: 0.0510s/iter; left time: 1705.8376s
	iters: 400, epoch: 29 | loss: 2.3262279
	speed: 0.0521s/iter; left time: 1737.0192s
Epoch: 29 cost time: 24.651121377944946
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 2.3014367
	speed: 0.2355s/iter; left time: 7819.0058s
	iters: 200, epoch: 30 | loss: 2.3056490
	speed: 0.0594s/iter; left time: 1967.3164s
	iters: 300, epoch: 30 | loss: 2.2984622
	speed: 0.0584s/iter; left time: 1926.7834s
	iters: 400, epoch: 30 | loss: 2.3087616
	speed: 0.0614s/iter; left time: 2019.4537s
Epoch: 30 cost time: 28.251060485839844
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 2.2800372
	speed: 0.2493s/iter; left time: 8159.3872s
	iters: 200, epoch: 31 | loss: 2.3032808
	speed: 0.0598s/iter; left time: 1949.7903s
	iters: 300, epoch: 31 | loss: 2.2915006
	speed: 0.0626s/iter; left time: 2035.2981s
	iters: 400, epoch: 31 | loss: 2.3138418
	speed: 0.0578s/iter; left time: 1875.1209s
Epoch: 31 cost time: 28.215023517608643
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 2.3061509
	speed: 0.2426s/iter; left time: 7825.3238s
	iters: 200, epoch: 32 | loss: 2.3084698
	speed: 0.0586s/iter; left time: 1884.6893s
	iters: 300, epoch: 32 | loss: 2.3032424
	speed: 0.0599s/iter; left time: 1919.9601s
	iters: 400, epoch: 32 | loss: 2.2938597
	speed: 0.0605s/iter; left time: 1935.0176s
Epoch: 32 cost time: 27.913482904434204
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 131530
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4694433
	speed: 0.0798s/iter; left time: 3735.9252s
	iters: 200, epoch: 1 | loss: 0.9666862
	speed: 0.0613s/iter; left time: 2862.3157s
	iters: 300, epoch: 1 | loss: 0.4269237
	speed: 0.0637s/iter; left time: 2967.9256s
	iters: 400, epoch: 1 | loss: 0.5475224
	speed: 0.0597s/iter; left time: 2776.9757s
Epoch: 1 cost time: 30.807373762130737
Epoch: 1, Steps: 469 | Train Loss: 0.969 Vali Loss: 0.322 Vali Acc: 0.904 Test Loss: 0.322 Test Acc: 0.904
Validation loss decreased (inf --> -0.904228).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5383492
	speed: 0.2540s/iter; left time: 11770.3587s
	iters: 200, epoch: 2 | loss: 0.1391289
	speed: 0.0607s/iter; left time: 2808.5091s
	iters: 300, epoch: 2 | loss: 0.1536171
	speed: 0.0633s/iter; left time: 2917.8796s
	iters: 400, epoch: 2 | loss: 0.5297278
	speed: 0.0616s/iter; left time: 2835.2754s
Epoch: 2 cost time: 29.18118119239807
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.904228 --> -0.961977).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1601546
	speed: 0.2389s/iter; left time: 10956.9019s
	iters: 200, epoch: 3 | loss: 0.0296031
	speed: 0.0594s/iter; left time: 2718.9048s
	iters: 300, epoch: 3 | loss: 0.0504330
	speed: 0.0552s/iter; left time: 2520.5400s
	iters: 400, epoch: 3 | loss: 0.0385338
	speed: 0.0574s/iter; left time: 2614.2080s
Epoch: 3 cost time: 27.624029874801636
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2294297
	speed: 0.2334s/iter; left time: 10593.7010s
	iters: 200, epoch: 4 | loss: 0.0195800
	speed: 0.0483s/iter; left time: 2189.5812s
	iters: 300, epoch: 4 | loss: 0.0729823
	speed: 0.0496s/iter; left time: 2243.2649s
	iters: 400, epoch: 4 | loss: 0.0546706
	speed: 0.0501s/iter; left time: 2259.8661s
Epoch: 4 cost time: 24.152917861938477
Epoch: 4, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.961977 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0266569
	speed: 0.1993s/iter; left time: 8951.9012s
	iters: 200, epoch: 5 | loss: 0.0308196
	speed: 0.0615s/iter; left time: 2756.5312s
	iters: 300, epoch: 5 | loss: 0.0092344
	speed: 0.0571s/iter; left time: 2553.2057s
	iters: 400, epoch: 5 | loss: 0.0553798
	speed: 0.0590s/iter; left time: 2634.0658s
Epoch: 5 cost time: 28.244488954544067
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.970840).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0118190
	speed: 0.2303s/iter; left time: 10239.1692s
	iters: 200, epoch: 6 | loss: 0.0149766
	speed: 0.0581s/iter; left time: 2577.2208s
	iters: 300, epoch: 6 | loss: 0.0394459
	speed: 0.0609s/iter; left time: 2694.4903s
	iters: 400, epoch: 6 | loss: 0.0592300
	speed: 0.0577s/iter; left time: 2549.3765s
Epoch: 6 cost time: 27.503384828567505
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.970840 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0506494
	speed: 0.2336s/iter; left time: 10276.5462s
	iters: 200, epoch: 7 | loss: 0.0134876
	speed: 0.0595s/iter; left time: 2612.0887s
	iters: 300, epoch: 7 | loss: 0.0102871
	speed: 0.0581s/iter; left time: 2545.5435s
	iters: 400, epoch: 7 | loss: 0.0666342
	speed: 0.0548s/iter; left time: 2393.6703s
Epoch: 7 cost time: 26.83780312538147
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0044072
	speed: 0.2414s/iter; left time: 10503.8620s
	iters: 200, epoch: 8 | loss: 0.0213730
	speed: 0.0581s/iter; left time: 2522.0570s
	iters: 300, epoch: 8 | loss: 0.0017588
	speed: 0.0607s/iter; left time: 2627.5540s
	iters: 400, epoch: 8 | loss: 0.0072279
	speed: 0.0592s/iter; left time: 2560.0042s
Epoch: 8 cost time: 27.961838722229004
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0060158
	speed: 0.2422s/iter; left time: 10426.0068s
	iters: 200, epoch: 9 | loss: 0.0072315
	speed: 0.0582s/iter; left time: 2497.8224s
	iters: 300, epoch: 9 | loss: 0.0913989
	speed: 0.0576s/iter; left time: 2466.1697s
	iters: 400, epoch: 9 | loss: 0.0077150
	speed: 0.0601s/iter; left time: 2567.7865s
Epoch: 9 cost time: 28.44806170463562
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.971697 --> -0.981131).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0023658
	speed: 0.2373s/iter; left time: 10105.9570s
	iters: 200, epoch: 10 | loss: 0.0077848
	speed: 0.0617s/iter; left time: 2620.7309s
	iters: 300, epoch: 10 | loss: 0.0168344
	speed: 0.0581s/iter; left time: 2463.7085s
	iters: 400, epoch: 10 | loss: 0.1733264
	speed: 0.0591s/iter; left time: 2499.4206s
Epoch: 10 cost time: 28.499945878982544
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0246395
	speed: 0.2362s/iter; left time: 9945.8648s
	iters: 200, epoch: 11 | loss: 0.0019090
	speed: 0.0621s/iter; left time: 2607.8398s
	iters: 300, epoch: 11 | loss: 0.0462277
	speed: 0.0595s/iter; left time: 2492.8025s
	iters: 400, epoch: 11 | loss: 0.0196275
	speed: 0.0557s/iter; left time: 2326.8319s
Epoch: 11 cost time: 28.875516176223755
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0778116
	speed: 0.2480s/iter; left time: 10326.3794s
	iters: 200, epoch: 12 | loss: 0.0030075
	speed: 0.0612s/iter; left time: 2544.0740s
	iters: 300, epoch: 12 | loss: 0.0239044
	speed: 0.0622s/iter; left time: 2576.7774s
	iters: 400, epoch: 12 | loss: 0.0144557
	speed: 0.0603s/iter; left time: 2494.2353s
Epoch: 12 cost time: 28.41744112968445
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0496670
	speed: 0.2488s/iter; left time: 10244.3829s
	iters: 200, epoch: 13 | loss: 0.0004898
	speed: 0.0577s/iter; left time: 2371.8217s
	iters: 300, epoch: 13 | loss: 0.0082096
	speed: 0.0585s/iter; left time: 2398.7887s
	iters: 400, epoch: 13 | loss: 0.0088919
	speed: 0.0605s/iter; left time: 2470.7965s
Epoch: 13 cost time: 28.396711587905884
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0108038
	speed: 0.2211s/iter; left time: 9001.1827s
	iters: 200, epoch: 14 | loss: 0.0025340
	speed: 0.0594s/iter; left time: 2411.7458s
	iters: 300, epoch: 14 | loss: 0.1670668
	speed: 0.0581s/iter; left time: 2352.2783s
	iters: 400, epoch: 14 | loss: 0.0117823
	speed: 0.0552s/iter; left time: 2229.6638s
Epoch: 14 cost time: 27.430007934570312
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1762460
	speed: 0.2400s/iter; left time: 9654.4354s
	iters: 200, epoch: 15 | loss: 0.0040822
	speed: 0.0545s/iter; left time: 2188.1747s
	iters: 300, epoch: 15 | loss: 0.0034479
	speed: 0.0533s/iter; left time: 2133.1664s
	iters: 400, epoch: 15 | loss: 0.0051726
	speed: 0.0521s/iter; left time: 2078.9109s
Epoch: 15 cost time: 25.787653923034668
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0012771
	speed: 0.2398s/iter; left time: 9536.8205s
	iters: 200, epoch: 16 | loss: 0.0003452
	speed: 0.0627s/iter; left time: 2487.2536s
	iters: 300, epoch: 16 | loss: 0.0669545
	speed: 0.0590s/iter; left time: 2333.7290s
	iters: 400, epoch: 16 | loss: 0.0114999
	speed: 0.0561s/iter; left time: 2214.2071s
Epoch: 16 cost time: 27.98617148399353
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0217719
	speed: 0.2433s/iter; left time: 9561.1059s
	iters: 200, epoch: 17 | loss: 0.0091589
	speed: 0.0594s/iter; left time: 2327.2321s
	iters: 300, epoch: 17 | loss: 0.1476788
	speed: 0.0564s/iter; left time: 2205.2013s
	iters: 400, epoch: 17 | loss: 0.0013349
	speed: 0.0561s/iter; left time: 2186.7787s
Epoch: 17 cost time: 27.576208353042603
Epoch: 17, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0064163
	speed: 0.2288s/iter; left time: 8883.9032s
	iters: 200, epoch: 18 | loss: 0.0003213
	speed: 0.0610s/iter; left time: 2361.3253s
	iters: 300, epoch: 18 | loss: 0.0100493
	speed: 0.0562s/iter; left time: 2169.3591s
	iters: 400, epoch: 18 | loss: 0.0183586
	speed: 0.0589s/iter; left time: 2270.8860s
Epoch: 18 cost time: 27.733914136886597
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0125934
	speed: 0.2243s/iter; left time: 8602.1357s
	iters: 200, epoch: 19 | loss: 0.0018403
	speed: 0.0596s/iter; left time: 2279.8158s
	iters: 300, epoch: 19 | loss: 0.0085345
	speed: 0.0568s/iter; left time: 2168.8759s
	iters: 400, epoch: 19 | loss: 0.1121962
	speed: 0.0595s/iter; left time: 2263.3742s
Epoch: 19 cost time: 27.760127305984497
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0505422
	speed: 0.2333s/iter; left time: 8839.0919s
	iters: 200, epoch: 20 | loss: 0.0448164
	speed: 0.0597s/iter; left time: 2256.7962s
	iters: 300, epoch: 20 | loss: 0.0028139
	speed: 0.0572s/iter; left time: 2155.3128s
	iters: 400, epoch: 20 | loss: 0.0009157
	speed: 0.0593s/iter; left time: 2228.1068s
Epoch: 20 cost time: 28.054373502731323
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 415978
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6463777
	speed: 0.0767s/iter; left time: 3589.1413s
	iters: 200, epoch: 1 | loss: 1.2537047
	speed: 0.0570s/iter; left time: 2660.2360s
	iters: 300, epoch: 1 | loss: 0.7044621
	speed: 0.0568s/iter; left time: 2647.0745s
	iters: 400, epoch: 1 | loss: 0.7460585
	speed: 0.0607s/iter; left time: 2821.3976s
Epoch: 1 cost time: 29.394649028778076
Epoch: 1, Steps: 469 | Train Loss: 1.185 Vali Loss: 0.458 Vali Acc: 0.860 Test Loss: 0.458 Test Acc: 0.860
Validation loss decreased (inf --> -0.860201).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6804135
	speed: 0.2378s/iter; left time: 11016.6224s
	iters: 200, epoch: 2 | loss: 0.2571553
	speed: 0.0594s/iter; left time: 2746.6339s
	iters: 300, epoch: 2 | loss: 0.1968018
	speed: 0.0554s/iter; left time: 2557.9035s
	iters: 400, epoch: 2 | loss: 0.5813382
	speed: 0.0493s/iter; left time: 2270.8827s
Epoch: 2 cost time: 26.035828351974487
Epoch: 2, Steps: 469 | Train Loss: 0.277 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.860201 --> -0.952257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1494566
	speed: 0.1770s/iter; left time: 8118.3248s
	iters: 200, epoch: 3 | loss: 0.0363868
	speed: 0.0465s/iter; left time: 2128.3788s
	iters: 300, epoch: 3 | loss: 0.0465670
	speed: 0.0490s/iter; left time: 2236.8914s
	iters: 400, epoch: 3 | loss: 0.0506429
	speed: 0.0456s/iter; left time: 2075.7741s
Epoch: 3 cost time: 22.76323652267456
Epoch: 3, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2816027
	speed: 0.1693s/iter; left time: 7686.3728s
	iters: 200, epoch: 4 | loss: 0.0721080
	speed: 0.0481s/iter; left time: 2177.4941s
	iters: 300, epoch: 4 | loss: 0.0793930
	speed: 0.0566s/iter; left time: 2556.5347s
	iters: 400, epoch: 4 | loss: 0.1016943
	speed: 0.0596s/iter; left time: 2685.8994s
Epoch: 4 cost time: 25.75518226623535
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.952257 --> -0.959404).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0268209
	speed: 0.2222s/iter; left time: 9980.8440s
	iters: 200, epoch: 5 | loss: 0.0331233
	speed: 0.0569s/iter; left time: 2549.4508s
	iters: 300, epoch: 5 | loss: 0.0120896
	speed: 0.0560s/iter; left time: 2503.6581s
	iters: 400, epoch: 5 | loss: 0.0350565
	speed: 0.0532s/iter; left time: 2372.5461s
Epoch: 5 cost time: 26.151821613311768
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0246268
	speed: 0.2257s/iter; left time: 10032.0363s
	iters: 200, epoch: 6 | loss: 0.0152648
	speed: 0.0570s/iter; left time: 2529.7377s
	iters: 300, epoch: 6 | loss: 0.0235130
	speed: 0.0550s/iter; left time: 2435.8873s
	iters: 400, epoch: 6 | loss: 0.0276758
	speed: 0.0596s/iter; left time: 2633.2349s
Epoch: 6 cost time: 27.633442878723145
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.959404 --> -0.968838).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1039984
	speed: 0.2245s/iter; left time: 9872.8861s
	iters: 200, epoch: 7 | loss: 0.0161132
	speed: 0.0580s/iter; left time: 2544.2788s
	iters: 300, epoch: 7 | loss: 0.0062181
	speed: 0.0593s/iter; left time: 2597.8730s
	iters: 400, epoch: 7 | loss: 0.0948579
	speed: 0.0561s/iter; left time: 2452.3698s
Epoch: 7 cost time: 26.994922876358032
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0440700
	speed: 0.2261s/iter; left time: 9839.1092s
	iters: 200, epoch: 8 | loss: 0.0884422
	speed: 0.0566s/iter; left time: 2456.4702s
	iters: 300, epoch: 8 | loss: 0.0087757
	speed: 0.0529s/iter; left time: 2290.8766s
	iters: 400, epoch: 8 | loss: 0.0761826
	speed: 0.0588s/iter; left time: 2542.6573s
Epoch: 8 cost time: 26.91220498085022
Epoch: 8, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0146566
	speed: 0.2206s/iter; left time: 9498.1080s
	iters: 200, epoch: 9 | loss: 0.0087788
	speed: 0.0562s/iter; left time: 2414.9401s
	iters: 300, epoch: 9 | loss: 0.0851966
	speed: 0.0596s/iter; left time: 2555.2210s
	iters: 400, epoch: 9 | loss: 0.0075896
	speed: 0.0557s/iter; left time: 2381.2144s
Epoch: 9 cost time: 27.4607515335083
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.968838 --> -0.969696).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0117229
	speed: 0.2339s/iter; left time: 9959.9151s
	iters: 200, epoch: 10 | loss: 0.0028599
	speed: 0.0609s/iter; left time: 2585.4192s
	iters: 300, epoch: 10 | loss: 0.0584458
	speed: 0.0555s/iter; left time: 2350.4807s
	iters: 400, epoch: 10 | loss: 0.0068151
	speed: 0.0586s/iter; left time: 2477.8541s
Epoch: 10 cost time: 27.828953504562378
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0037173
	speed: 0.2300s/iter; left time: 9687.3849s
	iters: 200, epoch: 11 | loss: 0.0058562
	speed: 0.0563s/iter; left time: 2364.7613s
	iters: 300, epoch: 11 | loss: 0.0566000
	speed: 0.0566s/iter; left time: 2372.9735s
	iters: 400, epoch: 11 | loss: 0.0152933
	speed: 0.0590s/iter; left time: 2468.6084s
Epoch: 11 cost time: 27.706267833709717
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0473694
	speed: 0.2248s/iter; left time: 9363.1698s
	iters: 200, epoch: 12 | loss: 0.0190704
	speed: 0.0562s/iter; left time: 2336.0225s
	iters: 300, epoch: 12 | loss: 0.0034231
	speed: 0.0605s/iter; left time: 2506.8094s
	iters: 400, epoch: 12 | loss: 0.0192971
	speed: 0.0576s/iter; left time: 2381.3210s
Epoch: 12 cost time: 27.39749836921692
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0331850
	speed: 0.2281s/iter; left time: 9390.2394s
	iters: 200, epoch: 13 | loss: 0.0020450
	speed: 0.0609s/iter; left time: 2503.2523s
	iters: 300, epoch: 13 | loss: 0.0059831
	speed: 0.0561s/iter; left time: 2297.4528s
	iters: 400, epoch: 13 | loss: 0.0010011
	speed: 0.0585s/iter; left time: 2392.9441s
Epoch: 13 cost time: 28.032334327697754
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.970839).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0055448
	speed: 0.2188s/iter; left time: 8904.7445s
	iters: 200, epoch: 14 | loss: 0.0085503
	speed: 0.0524s/iter; left time: 2128.2092s
	iters: 300, epoch: 14 | loss: 0.0161109
	speed: 0.0494s/iter; left time: 2000.8380s
	iters: 400, epoch: 14 | loss: 0.0059750
	speed: 0.0504s/iter; left time: 2035.4821s
Epoch: 14 cost time: 24.20403242111206
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0072734
	speed: 0.1836s/iter; left time: 7387.0827s
	iters: 200, epoch: 15 | loss: 0.0188223
	speed: 0.0573s/iter; left time: 2298.4922s
	iters: 300, epoch: 15 | loss: 0.0024405
	speed: 0.0544s/iter; left time: 2177.5305s
	iters: 400, epoch: 15 | loss: 0.0312293
	speed: 0.0615s/iter; left time: 2456.8894s
Epoch: 15 cost time: 27.260801553726196
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.970839 --> -0.974270).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0189539
	speed: 0.2252s/iter; left time: 8955.8445s
	iters: 200, epoch: 16 | loss: 0.0009527
	speed: 0.0560s/iter; left time: 2220.7265s
	iters: 300, epoch: 16 | loss: 0.0976417
	speed: 0.0552s/iter; left time: 2183.6773s
	iters: 400, epoch: 16 | loss: 0.0078822
	speed: 0.0584s/iter; left time: 2303.7804s
Epoch: 16 cost time: 26.74883198738098
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0033050
	speed: 0.2169s/iter; left time: 8525.1478s
	iters: 200, epoch: 17 | loss: 0.0096081
	speed: 0.0572s/iter; left time: 2240.2530s
	iters: 300, epoch: 17 | loss: 0.0332192
	speed: 0.0601s/iter; left time: 2350.2881s
	iters: 400, epoch: 17 | loss: 0.0067818
	speed: 0.0553s/iter; left time: 2155.6656s
Epoch: 17 cost time: 27.834710359573364
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.974270 --> -0.982847).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0164819
	speed: 0.2197s/iter; left time: 8531.8410s
	iters: 200, epoch: 18 | loss: 0.0014186
	speed: 0.0584s/iter; left time: 2263.3683s
	iters: 300, epoch: 18 | loss: 0.0009892
	speed: 0.0579s/iter; left time: 2236.6161s
	iters: 400, epoch: 18 | loss: 0.0106705
	speed: 0.0545s/iter; left time: 2099.9050s
Epoch: 18 cost time: 26.686667680740356
Epoch: 18, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1645028
	speed: 0.1742s/iter; left time: 6683.3509s
	iters: 200, epoch: 19 | loss: 0.0010610
	speed: 0.0509s/iter; left time: 1947.4313s
	iters: 300, epoch: 19 | loss: 0.0341319
	speed: 0.0509s/iter; left time: 1941.5708s
	iters: 400, epoch: 19 | loss: 0.0020325
	speed: 0.0579s/iter; left time: 2203.7196s
Epoch: 19 cost time: 24.975369930267334
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0456094
	speed: 0.2154s/iter; left time: 8160.5738s
	iters: 200, epoch: 20 | loss: 0.0819425
	speed: 0.0541s/iter; left time: 2045.2377s
	iters: 300, epoch: 20 | loss: 0.0029993
	speed: 0.0562s/iter; left time: 2117.3377s
	iters: 400, epoch: 20 | loss: 0.0035564
	speed: 0.0538s/iter; left time: 2021.6424s
Epoch: 20 cost time: 26.564269304275513
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0077092
	speed: 0.2089s/iter; left time: 7818.1983s
	iters: 200, epoch: 21 | loss: 0.0581394
	speed: 0.0588s/iter; left time: 2196.0303s
	iters: 300, epoch: 21 | loss: 0.0017308
	speed: 0.0535s/iter; left time: 1989.7796s
	iters: 400, epoch: 21 | loss: 0.2375333
	speed: 0.0615s/iter; left time: 2282.9045s
Epoch: 21 cost time: 26.78759479522705
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0036367
	speed: 0.2141s/iter; left time: 7912.2087s
	iters: 200, epoch: 22 | loss: 0.0083830
	speed: 0.0553s/iter; left time: 2036.3060s
	iters: 300, epoch: 22 | loss: 0.0807515
	speed: 0.0592s/iter; left time: 2176.2262s
	iters: 400, epoch: 22 | loss: 0.0018091
	speed: 0.0533s/iter; left time: 1951.8360s
Epoch: 22 cost time: 26.184226036071777
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0226137
	speed: 0.1663s/iter; left time: 6065.9373s
	iters: 200, epoch: 23 | loss: 0.0021206
	speed: 0.0515s/iter; left time: 1873.6106s
	iters: 300, epoch: 23 | loss: 0.0686637
	speed: 0.0566s/iter; left time: 2052.5920s
	iters: 400, epoch: 23 | loss: 0.0058238
	speed: 0.0562s/iter; left time: 2032.6847s
Epoch: 23 cost time: 25.977203130722046
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0382965
	speed: 0.2137s/iter; left time: 7697.4824s
	iters: 200, epoch: 24 | loss: 0.0034568
	speed: 0.0549s/iter; left time: 1970.6109s
	iters: 300, epoch: 24 | loss: 0.0025779
	speed: 0.0547s/iter; left time: 1959.8831s
	iters: 400, epoch: 24 | loss: 0.0266844
	speed: 0.0551s/iter; left time: 1968.6996s
Epoch: 24 cost time: 26.19087243080139
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0007921
	speed: 0.2080s/iter; left time: 7393.9879s
	iters: 200, epoch: 25 | loss: 0.0074991
	speed: 0.0563s/iter; left time: 1997.2903s
	iters: 300, epoch: 25 | loss: 0.0022897
	speed: 0.0523s/iter; left time: 1848.9571s
	iters: 400, epoch: 25 | loss: 0.0007854
	speed: 0.0560s/iter; left time: 1974.1038s
Epoch: 25 cost time: 25.842311143875122
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0170030
	speed: 0.2005s/iter; left time: 7033.7044s
	iters: 200, epoch: 26 | loss: 0.0010729
	speed: 0.0525s/iter; left time: 1835.4889s
	iters: 300, epoch: 26 | loss: 0.0005524
	speed: 0.0523s/iter; left time: 1824.0945s
	iters: 400, epoch: 26 | loss: 0.0001963
	speed: 0.0503s/iter; left time: 1750.8736s
Epoch: 26 cost time: 24.609039068222046
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0141792
	speed: 0.1957s/iter; left time: 6773.7644s
	iters: 200, epoch: 27 | loss: 0.0193203
	speed: 0.0568s/iter; left time: 1958.5766s
	iters: 300, epoch: 27 | loss: 0.0367136
	speed: 0.0532s/iter; left time: 1831.8014s
	iters: 400, epoch: 27 | loss: 0.0157889
	speed: 0.0567s/iter; left time: 1944.5130s
Epoch: 27 cost time: 26.229784727096558
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 415978
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4544535
	speed: 0.0728s/iter; left time: 3407.6455s
	iters: 200, epoch: 1 | loss: 1.1585742
	speed: 0.0582s/iter; left time: 2716.1172s
	iters: 300, epoch: 1 | loss: 0.5695852
	speed: 0.0591s/iter; left time: 2754.9370s
	iters: 400, epoch: 1 | loss: 0.4971226
	speed: 0.0573s/iter; left time: 2662.3845s
Epoch: 1 cost time: 29.066644191741943
Epoch: 1, Steps: 469 | Train Loss: 1.069 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
Validation loss decreased (inf --> -0.883644).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6327394
	speed: 0.2155s/iter; left time: 9986.6305s
	iters: 200, epoch: 2 | loss: 0.1602500
	speed: 0.0603s/iter; left time: 2788.0568s
	iters: 300, epoch: 2 | loss: 0.1566219
	speed: 0.0581s/iter; left time: 2682.4026s
	iters: 400, epoch: 2 | loss: 0.5720169
	speed: 0.0537s/iter; left time: 2472.7724s
Epoch: 2 cost time: 27.217461109161377
Epoch: 2, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.883644 --> -0.948254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0946211
	speed: 0.1836s/iter; left time: 8421.9056s
	iters: 200, epoch: 3 | loss: 0.0628224
	speed: 0.0523s/iter; left time: 2393.9839s
	iters: 300, epoch: 3 | loss: 0.0599375
	speed: 0.0519s/iter; left time: 2371.9459s
	iters: 400, epoch: 3 | loss: 0.0606242
	speed: 0.0507s/iter; left time: 2311.6808s
Epoch: 3 cost time: 24.96355652809143
Epoch: 3, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
Validation loss decreased (-0.948254 --> -0.948255).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2007685
	speed: 0.2059s/iter; left time: 9345.5886s
	iters: 200, epoch: 4 | loss: 0.0300550
	speed: 0.0556s/iter; left time: 2518.8094s
	iters: 300, epoch: 4 | loss: 0.0562545
	speed: 0.0526s/iter; left time: 2378.8641s
	iters: 400, epoch: 4 | loss: 0.0228706
	speed: 0.0550s/iter; left time: 2478.3652s
Epoch: 4 cost time: 25.76080822944641
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.948255 --> -0.955687).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0138394
	speed: 0.2117s/iter; left time: 9509.6486s
	iters: 200, epoch: 5 | loss: 0.0089060
	speed: 0.0558s/iter; left time: 2499.0450s
	iters: 300, epoch: 5 | loss: 0.0050826
	speed: 0.0550s/iter; left time: 2460.6279s
	iters: 400, epoch: 5 | loss: 0.0197779
	speed: 0.0500s/iter; left time: 2230.7715s
Epoch: 5 cost time: 25.954626083374023
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.955687 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0329321
	speed: 0.2109s/iter; left time: 9377.4217s
	iters: 200, epoch: 6 | loss: 0.0085530
	speed: 0.0532s/iter; left time: 2360.2855s
	iters: 300, epoch: 6 | loss: 0.0207393
	speed: 0.0524s/iter; left time: 2319.1099s
	iters: 400, epoch: 6 | loss: 0.0338686
	speed: 0.0556s/iter; left time: 2452.9997s
Epoch: 6 cost time: 25.7333664894104
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0307030
	speed: 0.2127s/iter; left time: 9358.0577s
	iters: 200, epoch: 7 | loss: 0.1266281
	speed: 0.0567s/iter; left time: 2488.3367s
	iters: 300, epoch: 7 | loss: 0.0184457
	speed: 0.0543s/iter; left time: 2376.6465s
	iters: 400, epoch: 7 | loss: 0.1298805
	speed: 0.0521s/iter; left time: 2276.0517s
Epoch: 7 cost time: 25.597089767456055
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
Validation loss decreased (-0.969124 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0127050
	speed: 0.1734s/iter; left time: 7545.6584s
	iters: 200, epoch: 8 | loss: 0.3119116
	speed: 0.0489s/iter; left time: 2122.0000s
	iters: 300, epoch: 8 | loss: 0.0028199
	speed: 0.0473s/iter; left time: 2051.0186s
	iters: 400, epoch: 8 | loss: 0.0246209
	speed: 0.0541s/iter; left time: 2338.9615s
Epoch: 8 cost time: 24.21357822418213
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0096890
	speed: 0.2187s/iter; left time: 9416.4449s
	iters: 200, epoch: 9 | loss: 0.0034328
	speed: 0.0511s/iter; left time: 2194.1263s
	iters: 300, epoch: 9 | loss: 0.3309426
	speed: 0.0567s/iter; left time: 2431.0925s
	iters: 400, epoch: 9 | loss: 0.0027292
	speed: 0.0532s/iter; left time: 2275.4565s
Epoch: 9 cost time: 26.10693335533142
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0035717
	speed: 0.2130s/iter; left time: 9068.8507s
	iters: 200, epoch: 10 | loss: 0.0320896
	speed: 0.0540s/iter; left time: 2292.0930s
	iters: 300, epoch: 10 | loss: 0.1445883
	speed: 0.0551s/iter; left time: 2333.0516s
	iters: 400, epoch: 10 | loss: 0.0612194
	speed: 0.0525s/iter; left time: 2219.8897s
Epoch: 10 cost time: 25.708885192871094
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0071857
	speed: 0.2118s/iter; left time: 8920.0362s
	iters: 200, epoch: 11 | loss: 0.0622414
	speed: 0.0598s/iter; left time: 2513.1035s
	iters: 300, epoch: 11 | loss: 0.0176408
	speed: 0.0564s/iter; left time: 2363.1117s
	iters: 400, epoch: 11 | loss: 0.0160390
	speed: 0.0594s/iter; left time: 2482.8178s
Epoch: 11 cost time: 27.383768796920776
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0773094
	speed: 0.2169s/iter; left time: 9033.9851s
	iters: 200, epoch: 12 | loss: 0.0199654
	speed: 0.0557s/iter; left time: 2312.0679s
	iters: 300, epoch: 12 | loss: 0.0488582
	speed: 0.0526s/iter; left time: 2178.8297s
	iters: 400, epoch: 12 | loss: 0.0054880
	speed: 0.0588s/iter; left time: 2432.8781s
Epoch: 12 cost time: 26.148805379867554
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1719204
	speed: 0.2154s/iter; left time: 8867.0768s
	iters: 200, epoch: 13 | loss: 0.0006171
	speed: 0.0542s/iter; left time: 2228.0155s
	iters: 300, epoch: 13 | loss: 0.0050834
	speed: 0.0591s/iter; left time: 2422.8728s
	iters: 400, epoch: 13 | loss: 0.0137977
	speed: 0.0592s/iter; left time: 2418.4191s
Epoch: 13 cost time: 27.393715620040894
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1993726
	speed: 0.2195s/iter; left time: 8933.1842s
	iters: 200, epoch: 14 | loss: 0.0046503
	speed: 0.0518s/iter; left time: 2105.2576s
	iters: 300, epoch: 14 | loss: 0.0027831
	speed: 0.0544s/iter; left time: 2202.1714s
	iters: 400, epoch: 14 | loss: 0.1283290
	speed: 0.0551s/iter; left time: 2226.5042s
Epoch: 14 cost time: 26.407995223999023
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0389105
	speed: 0.2130s/iter; left time: 8568.8630s
	iters: 200, epoch: 15 | loss: 0.0049995
	speed: 0.0550s/iter; left time: 2206.1208s
	iters: 300, epoch: 15 | loss: 0.0033267
	speed: 0.0489s/iter; left time: 1959.3637s
	iters: 400, epoch: 15 | loss: 0.0108852
	speed: 0.0494s/iter; left time: 1971.1697s
Epoch: 15 cost time: 24.477307558059692
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.973984).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0031270
	speed: 0.1803s/iter; left time: 7169.3971s
	iters: 200, epoch: 16 | loss: 0.0059393
	speed: 0.0532s/iter; left time: 2111.2547s
	iters: 300, epoch: 16 | loss: 0.0260565
	speed: 0.0596s/iter; left time: 2358.9170s
	iters: 400, epoch: 16 | loss: 0.0028278
	speed: 0.0580s/iter; left time: 2287.2396s
Epoch: 16 cost time: 26.474656105041504
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0345456
	speed: 0.2378s/iter; left time: 9343.9394s
	iters: 200, epoch: 17 | loss: 0.0046654
	speed: 0.0603s/iter; left time: 2363.8683s
	iters: 300, epoch: 17 | loss: 0.0194611
	speed: 0.0600s/iter; left time: 2347.1440s
	iters: 400, epoch: 17 | loss: 0.0033381
	speed: 0.0569s/iter; left time: 2219.6418s
Epoch: 17 cost time: 28.26303744316101
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0247277
	speed: 0.2424s/iter; left time: 9413.1600s
	iters: 200, epoch: 18 | loss: 0.0021892
	speed: 0.0615s/iter; left time: 2382.4528s
	iters: 300, epoch: 18 | loss: 0.0128679
	speed: 0.0607s/iter; left time: 2345.3310s
	iters: 400, epoch: 18 | loss: 0.1169023
	speed: 0.0580s/iter; left time: 2235.7373s
Epoch: 18 cost time: 28.156765937805176
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0785872
	speed: 0.2508s/iter; left time: 9618.9737s
	iters: 200, epoch: 19 | loss: 0.0029596
	speed: 0.0586s/iter; left time: 2240.1569s
	iters: 300, epoch: 19 | loss: 0.0010355
	speed: 0.0619s/iter; left time: 2361.5390s
	iters: 400, epoch: 19 | loss: 0.0038221
	speed: 0.0605s/iter; left time: 2302.0348s
Epoch: 19 cost time: 28.71267819404602
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974842).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0860462
	speed: 0.2382s/iter; left time: 9025.9404s
	iters: 200, epoch: 20 | loss: 0.0858459
	speed: 0.0591s/iter; left time: 2231.7468s
	iters: 300, epoch: 20 | loss: 0.0012720
	speed: 0.0561s/iter; left time: 2112.9210s
	iters: 400, epoch: 20 | loss: 0.0021596
	speed: 0.0556s/iter; left time: 2088.4453s
Epoch: 20 cost time: 27.611894607543945
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0053373
	speed: 0.2476s/iter; left time: 9263.9488s
	iters: 200, epoch: 21 | loss: 0.0309772
	speed: 0.0591s/iter; left time: 2205.4872s
	iters: 300, epoch: 21 | loss: 0.0065603
	speed: 0.0615s/iter; left time: 2289.2901s
	iters: 400, epoch: 21 | loss: 0.0187751
	speed: 0.0605s/iter; left time: 2244.1830s
Epoch: 21 cost time: 28.39958357810974
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0024944
	speed: 0.2535s/iter; left time: 9367.4817s
	iters: 200, epoch: 22 | loss: 0.0037608
	speed: 0.0614s/iter; left time: 2263.3151s
	iters: 300, epoch: 22 | loss: 0.0382192
	speed: 0.0618s/iter; left time: 2270.0974s
	iters: 400, epoch: 22 | loss: 0.2710203
	speed: 0.0601s/iter; left time: 2201.5214s
Epoch: 22 cost time: 28.77748155593872
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0487405
	speed: 0.2470s/iter; left time: 9011.5636s
	iters: 200, epoch: 23 | loss: 0.0034138
	speed: 0.0605s/iter; left time: 2200.4721s
	iters: 300, epoch: 23 | loss: 0.1061746
	speed: 0.0572s/iter; left time: 2076.8938s
	iters: 400, epoch: 23 | loss: 0.0014376
	speed: 0.0558s/iter; left time: 2019.3798s
Epoch: 23 cost time: 28.00761604309082
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0512194
	speed: 0.2506s/iter; left time: 9025.5434s
	iters: 200, epoch: 24 | loss: 0.0011334
	speed: 0.0599s/iter; left time: 2151.5938s
	iters: 300, epoch: 24 | loss: 0.0010222
	speed: 0.0598s/iter; left time: 2141.3579s
	iters: 400, epoch: 24 | loss: 0.0287651
	speed: 0.0595s/iter; left time: 2125.4995s
Epoch: 24 cost time: 28.01998496055603
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977986).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0003756
	speed: 0.2306s/iter; left time: 8197.1972s
	iters: 200, epoch: 25 | loss: 0.0106132
	speed: 0.0591s/iter; left time: 2096.3048s
	iters: 300, epoch: 25 | loss: 0.0011460
	speed: 0.0570s/iter; left time: 2013.6549s
	iters: 400, epoch: 25 | loss: 0.0228206
	speed: 0.0590s/iter; left time: 2078.3828s
Epoch: 25 cost time: 27.839015245437622
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0012219
	speed: 0.2526s/iter; left time: 8859.7386s
	iters: 200, epoch: 26 | loss: 0.0398082
	speed: 0.0609s/iter; left time: 2130.5931s
	iters: 300, epoch: 26 | loss: 0.0162787
	speed: 0.0629s/iter; left time: 2194.8350s
	iters: 400, epoch: 26 | loss: 0.0004872
	speed: 0.0605s/iter; left time: 2104.5100s
Epoch: 26 cost time: 28.927833318710327
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0009449
	speed: 0.2435s/iter; left time: 8427.1520s
	iters: 200, epoch: 27 | loss: 0.0066261
	speed: 0.0616s/iter; left time: 2125.5129s
	iters: 300, epoch: 27 | loss: 0.0008473
	speed: 0.0620s/iter; left time: 2133.2968s
	iters: 400, epoch: 27 | loss: 0.0712897
	speed: 0.0549s/iter; left time: 1883.8495s
Epoch: 27 cost time: 28.271644830703735
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0002519
	speed: 0.1850s/iter; left time: 6316.4951s
	iters: 200, epoch: 28 | loss: 0.0013709
	speed: 0.0517s/iter; left time: 1760.4198s
	iters: 300, epoch: 28 | loss: 0.0026106
	speed: 0.0496s/iter; left time: 1684.3931s
	iters: 400, epoch: 28 | loss: 0.0002582
	speed: 0.0518s/iter; left time: 1753.7315s
Epoch: 28 cost time: 24.361496448516846
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0520034
	speed: 0.2384s/iter; left time: 8026.0730s
	iters: 200, epoch: 29 | loss: 0.0093832
	speed: 0.0571s/iter; left time: 1916.3865s
	iters: 300, epoch: 29 | loss: 0.0008709
	speed: 0.0601s/iter; left time: 2011.7343s
	iters: 400, epoch: 29 | loss: 0.5540752
	speed: 0.0615s/iter; left time: 2053.5809s
Epoch: 29 cost time: 28.113975286483765
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.977986 --> -0.981989).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0024064
	speed: 0.2466s/iter; left time: 8187.4673s
	iters: 200, epoch: 30 | loss: 0.0001715
	speed: 0.0553s/iter; left time: 1831.9023s
	iters: 300, epoch: 30 | loss: 0.0198886
	speed: 0.0625s/iter; left time: 2063.4725s
	iters: 400, epoch: 30 | loss: 0.0150917
	speed: 0.0623s/iter; left time: 2049.3651s
Epoch: 30 cost time: 28.73730969429016
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0005426
	speed: 0.2493s/iter; left time: 8161.2242s
	iters: 200, epoch: 31 | loss: 0.0012224
	speed: 0.0577s/iter; left time: 1884.1305s
	iters: 300, epoch: 31 | loss: 0.0274487
	speed: 0.0615s/iter; left time: 1999.8242s
	iters: 400, epoch: 31 | loss: 0.0016681
	speed: 0.0619s/iter; left time: 2008.8858s
Epoch: 31 cost time: 29.16846513748169
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0008285
	speed: 0.2507s/iter; left time: 8087.5927s
	iters: 200, epoch: 32 | loss: 0.0011324
	speed: 0.0572s/iter; left time: 1839.9167s
	iters: 300, epoch: 32 | loss: 0.0016461
	speed: 0.0579s/iter; left time: 1856.1637s
	iters: 400, epoch: 32 | loss: 0.0039376
	speed: 0.0619s/iter; left time: 1977.1716s
Epoch: 32 cost time: 28.52109456062317
Epoch: 32, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0139084
	speed: 0.2436s/iter; left time: 7743.9089s
	iters: 200, epoch: 33 | loss: 0.0029516
	speed: 0.0589s/iter; left time: 1865.9719s
	iters: 300, epoch: 33 | loss: 0.0001891
	speed: 0.0599s/iter; left time: 1893.8199s
	iters: 400, epoch: 33 | loss: 0.0023450
	speed: 0.0618s/iter; left time: 1944.9490s
Epoch: 33 cost time: 28.83489990234375
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0092663
	speed: 0.2339s/iter; left time: 7326.2293s
	iters: 200, epoch: 34 | loss: 0.0040594
	speed: 0.0591s/iter; left time: 1844.0582s
	iters: 300, epoch: 34 | loss: 0.0395023
	speed: 0.0572s/iter; left time: 1779.9141s
	iters: 400, epoch: 34 | loss: 0.0001023
	speed: 0.0583s/iter; left time: 1807.5073s
Epoch: 34 cost time: 27.9638614654541
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.1464956
	speed: 0.2441s/iter; left time: 7532.3682s
	iters: 200, epoch: 35 | loss: 0.0001910
	speed: 0.0589s/iter; left time: 1812.9083s
	iters: 300, epoch: 35 | loss: 0.0164287
	speed: 0.0599s/iter; left time: 1834.8411s
	iters: 400, epoch: 35 | loss: 0.2938761
	speed: 0.0590s/iter; left time: 1802.4524s
Epoch: 35 cost time: 28.22912096977234
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0005210
	speed: 0.2444s/iter; left time: 7425.2978s
	iters: 200, epoch: 36 | loss: 0.0099732
	speed: 0.0571s/iter; left time: 1727.9504s
	iters: 300, epoch: 36 | loss: 0.0002887
	speed: 0.0580s/iter; left time: 1752.1823s
	iters: 400, epoch: 36 | loss: 0.0001753
	speed: 0.0585s/iter; left time: 1761.3254s
Epoch: 36 cost time: 27.242257595062256
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0003764
	speed: 0.2492s/iter; left time: 7455.9462s
	iters: 200, epoch: 37 | loss: 0.0007439
	speed: 0.0564s/iter; left time: 1681.8068s
	iters: 300, epoch: 37 | loss: 0.0175650
	speed: 0.0561s/iter; left time: 1667.5081s
	iters: 400, epoch: 37 | loss: 0.2930663
	speed: 0.0580s/iter; left time: 1717.4446s
Epoch: 37 cost time: 27.076781034469604
Epoch: 37, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0039139
	speed: 0.2068s/iter; left time: 6090.4605s
	iters: 200, epoch: 38 | loss: 0.0047135
	speed: 0.0484s/iter; left time: 1421.5246s
	iters: 300, epoch: 38 | loss: 0.0003627
	speed: 0.0454s/iter; left time: 1328.9944s
	iters: 400, epoch: 38 | loss: 0.0129079
	speed: 0.0488s/iter; left time: 1423.4136s
Epoch: 38 cost time: 23.034849643707275
Epoch: 38, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0124538
	speed: 0.1676s/iter; left time: 4856.3136s
	iters: 200, epoch: 39 | loss: 0.0004653
	speed: 0.0522s/iter; left time: 1508.0379s
	iters: 300, epoch: 39 | loss: 0.0015617
	speed: 0.0581s/iter; left time: 1672.7473s
	iters: 400, epoch: 39 | loss: 0.0049401
	speed: 0.0600s/iter; left time: 1721.8468s
Epoch: 39 cost time: 25.996591091156006
Epoch: 39, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 415978
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3011396
	speed: 0.0750s/iter; left time: 3511.5293s
	iters: 200, epoch: 1 | loss: 2.2923236
	speed: 0.0597s/iter; left time: 2790.2366s
	iters: 300, epoch: 1 | loss: 2.2946501
	speed: 0.0615s/iter; left time: 2865.8929s
	iters: 400, epoch: 1 | loss: 2.2941816
	speed: 0.0606s/iter; left time: 2815.8849s
Epoch: 1 cost time: 29.79875898361206
Epoch: 1, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3077214
	speed: 0.2449s/iter; left time: 11344.9628s
	iters: 200, epoch: 2 | loss: 2.3142226
	speed: 0.0635s/iter; left time: 2937.0067s
	iters: 300, epoch: 2 | loss: 2.3065047
	speed: 0.0618s/iter; left time: 2852.6245s
	iters: 400, epoch: 2 | loss: 2.2994208
	speed: 0.0561s/iter; left time: 2581.5284s
Epoch: 2 cost time: 28.46670699119568
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2932675
	speed: 0.2368s/iter; left time: 10861.6641s
	iters: 200, epoch: 3 | loss: 2.2980101
	speed: 0.0580s/iter; left time: 2651.9985s
	iters: 300, epoch: 3 | loss: 2.3080032
	speed: 0.0564s/iter; left time: 2573.2179s
	iters: 400, epoch: 3 | loss: 2.2974699
	speed: 0.0533s/iter; left time: 2429.2647s
Epoch: 3 cost time: 26.802255868911743
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3001518
	speed: 0.2260s/iter; left time: 10256.9934s
	iters: 200, epoch: 4 | loss: 2.2992375
	speed: 0.0567s/iter; left time: 2566.0853s
	iters: 300, epoch: 4 | loss: 2.2816482
	speed: 0.0544s/iter; left time: 2457.2462s
	iters: 400, epoch: 4 | loss: 2.2963543
	speed: 0.0563s/iter; left time: 2540.7162s
Epoch: 4 cost time: 27.127589464187622
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3007622
	speed: 0.2380s/iter; left time: 10691.0639s
	iters: 200, epoch: 5 | loss: 2.2938619
	speed: 0.0605s/iter; left time: 2712.6175s
	iters: 300, epoch: 5 | loss: 2.2878773
	speed: 0.0552s/iter; left time: 2469.5271s
	iters: 400, epoch: 5 | loss: 2.2939546
	speed: 0.0604s/iter; left time: 2693.7942s
Epoch: 5 cost time: 28.197408437728882
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3062422
	speed: 0.2408s/iter; left time: 10706.2223s
	iters: 200, epoch: 6 | loss: 2.2933621
	speed: 0.0606s/iter; left time: 2687.4680s
	iters: 300, epoch: 6 | loss: 2.2840245
	speed: 0.0572s/iter; left time: 2533.0716s
	iters: 400, epoch: 6 | loss: 2.3035622
	speed: 0.0596s/iter; left time: 2633.2029s
Epoch: 6 cost time: 28.72709059715271
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3069539
	speed: 0.2429s/iter; left time: 10683.6761s
	iters: 200, epoch: 7 | loss: 2.3172960
	speed: 0.0549s/iter; left time: 2410.1677s
	iters: 300, epoch: 7 | loss: 2.3189511
	speed: 0.0569s/iter; left time: 2490.6622s
	iters: 400, epoch: 7 | loss: 2.2892187
	speed: 0.0598s/iter; left time: 2611.6206s
Epoch: 7 cost time: 27.764574766159058
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2967150
	speed: 0.2409s/iter; left time: 10481.5064s
	iters: 200, epoch: 8 | loss: 2.3136616
	speed: 0.0552s/iter; left time: 2394.5490s
	iters: 300, epoch: 8 | loss: 2.3056307
	speed: 0.0594s/iter; left time: 2571.1590s
	iters: 400, epoch: 8 | loss: 2.3000629
	speed: 0.0589s/iter; left time: 2544.5391s
Epoch: 8 cost time: 27.6515474319458
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2990990
	speed: 0.2336s/iter; left time: 10056.8545s
	iters: 200, epoch: 9 | loss: 2.2858250
	speed: 0.0579s/iter; left time: 2488.6909s
	iters: 300, epoch: 9 | loss: 2.2917981
	speed: 0.0595s/iter; left time: 2550.4578s
	iters: 400, epoch: 9 | loss: 2.3196335
	speed: 0.0619s/iter; left time: 2644.8828s
Epoch: 9 cost time: 28.629884243011475
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3045292
	speed: 0.2392s/iter; left time: 10184.8901s
	iters: 200, epoch: 10 | loss: 2.3087642
	speed: 0.0607s/iter; left time: 2578.1034s
	iters: 300, epoch: 10 | loss: 2.2865050
	speed: 0.0544s/iter; left time: 2306.6569s
	iters: 400, epoch: 10 | loss: 2.2974486
	speed: 0.0598s/iter; left time: 2527.1960s
Epoch: 10 cost time: 28.2385892868042
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3041232
	speed: 0.2431s/iter; left time: 10236.0384s
	iters: 200, epoch: 11 | loss: 2.3196363
	speed: 0.0608s/iter; left time: 2555.5766s
	iters: 300, epoch: 11 | loss: 2.2990885
	speed: 0.0560s/iter; left time: 2347.7027s
	iters: 400, epoch: 11 | loss: 2.3033724
	speed: 0.0601s/iter; left time: 2511.0773s
Epoch: 11 cost time: 28.357501745224
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2987735
	speed: 0.2431s/iter; left time: 10122.4065s
	iters: 200, epoch: 12 | loss: 2.3127542
	speed: 0.0628s/iter; left time: 2606.8368s
	iters: 300, epoch: 12 | loss: 2.2994053
	speed: 0.0633s/iter; left time: 2623.9683s
	iters: 400, epoch: 12 | loss: 2.3003018
	speed: 0.0540s/iter; left time: 2230.9173s
Epoch: 12 cost time: 29.01188635826111
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3008368
	speed: 0.2481s/iter; left time: 10215.8291s
	iters: 200, epoch: 13 | loss: 2.3014355
	speed: 0.0607s/iter; left time: 2494.0994s
	iters: 300, epoch: 13 | loss: 2.2896979
	speed: 0.0633s/iter; left time: 2595.2799s
	iters: 400, epoch: 13 | loss: 2.2956374
	speed: 0.0577s/iter; left time: 2358.1915s
Epoch: 13 cost time: 28.381284952163696
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3079271
	speed: 0.2459s/iter; left time: 10008.2287s
	iters: 200, epoch: 14 | loss: 2.3106174
	speed: 0.0580s/iter; left time: 2354.6736s
	iters: 300, epoch: 14 | loss: 2.3005087
	speed: 0.0616s/iter; left time: 2494.8850s
	iters: 400, epoch: 14 | loss: 2.3117781
	speed: 0.0619s/iter; left time: 2500.7037s
Epoch: 14 cost time: 28.184390544891357
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.2936084
	speed: 0.2404s/iter; left time: 9673.8022s
	iters: 200, epoch: 15 | loss: 2.2987967
	speed: 0.0575s/iter; left time: 2307.6812s
	iters: 300, epoch: 15 | loss: 2.3172696
	speed: 0.0531s/iter; left time: 2125.5316s
	iters: 400, epoch: 15 | loss: 2.3030877
	speed: 0.0509s/iter; left time: 2031.3428s
Epoch: 15 cost time: 25.787787437438965
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3002262
	speed: 0.1690s/iter; left time: 6721.3802s
	iters: 200, epoch: 16 | loss: 2.2992220
	speed: 0.0486s/iter; left time: 1928.2770s
	iters: 300, epoch: 16 | loss: 2.2815731
	speed: 0.0531s/iter; left time: 2100.5169s
	iters: 400, epoch: 16 | loss: 2.2863610
	speed: 0.0588s/iter; left time: 2320.7292s
Epoch: 16 cost time: 25.34355854988098
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3039033
	speed: 0.2268s/iter; left time: 8911.0193s
	iters: 200, epoch: 17 | loss: 2.2945540
	speed: 0.0537s/iter; left time: 2104.4636s
	iters: 300, epoch: 17 | loss: 2.3205111
	speed: 0.0555s/iter; left time: 2168.6871s
	iters: 400, epoch: 17 | loss: 2.3176253
	speed: 0.0546s/iter; left time: 2130.9653s
Epoch: 17 cost time: 26.18660020828247
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.2925718
	speed: 0.2224s/iter; left time: 8634.5484s
	iters: 200, epoch: 18 | loss: 2.3152575
	speed: 0.0589s/iter; left time: 2279.5357s
	iters: 300, epoch: 18 | loss: 2.3081841
	speed: 0.0562s/iter; left time: 2170.3360s
	iters: 400, epoch: 18 | loss: 2.3034878
	speed: 0.0592s/iter; left time: 2279.5233s
Epoch: 18 cost time: 27.7218816280365
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.2924995
	speed: 0.2322s/iter; left time: 8908.3838s
	iters: 200, epoch: 19 | loss: 2.2886047
	speed: 0.0563s/iter; left time: 2152.8897s
	iters: 300, epoch: 19 | loss: 2.3041000
	speed: 0.0579s/iter; left time: 2208.9385s
	iters: 400, epoch: 19 | loss: 2.2960317
	speed: 0.0551s/iter; left time: 2097.8569s
Epoch: 19 cost time: 26.921014070510864
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3030319
	speed: 0.2343s/iter; left time: 8875.9692s
	iters: 200, epoch: 20 | loss: 2.3070924
	speed: 0.0586s/iter; left time: 2212.7796s
	iters: 300, epoch: 20 | loss: 2.3091846
	speed: 0.0545s/iter; left time: 2052.8317s
	iters: 400, epoch: 20 | loss: 2.3031983
	speed: 0.0587s/iter; left time: 2204.8136s
Epoch: 20 cost time: 27.692328214645386
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.3276720
	speed: 0.2367s/iter; left time: 8858.6655s
	iters: 200, epoch: 21 | loss: 2.2792609
	speed: 0.0571s/iter; left time: 2129.8467s
	iters: 300, epoch: 21 | loss: 2.3011587
	speed: 0.0560s/iter; left time: 2084.1982s
	iters: 400, epoch: 21 | loss: 2.2939003
	speed: 0.0537s/iter; left time: 1994.1603s
Epoch: 21 cost time: 26.919959545135498
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.2991076
	speed: 0.2310s/iter; left time: 8534.1503s
	iters: 200, epoch: 22 | loss: 2.3120916
	speed: 0.0599s/iter; left time: 2208.5077s
	iters: 300, epoch: 22 | loss: 2.2961397
	speed: 0.0569s/iter; left time: 2092.7119s
	iters: 400, epoch: 22 | loss: 2.3030612
	speed: 0.0624s/iter; left time: 2286.4194s
Epoch: 22 cost time: 28.181901931762695
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 415978
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4339563
	speed: 0.0756s/iter; left time: 3537.1784s
	iters: 200, epoch: 1 | loss: 1.1496048
	speed: 0.0633s/iter; left time: 2955.2763s
	iters: 300, epoch: 1 | loss: 0.5108881
	speed: 0.0644s/iter; left time: 2999.0423s
	iters: 400, epoch: 1 | loss: 0.4907448
	speed: 0.0591s/iter; left time: 2749.0879s
Epoch: 1 cost time: 30.58958649635315
Epoch: 1, Steps: 469 | Train Loss: 1.058 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (inf --> -0.889076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2126522
	speed: 0.2455s/iter; left time: 11374.0214s
	iters: 200, epoch: 2 | loss: 0.1963310
	speed: 0.0598s/iter; left time: 2764.0557s
	iters: 300, epoch: 2 | loss: 0.1737858
	speed: 0.0627s/iter; left time: 2894.5388s
	iters: 400, epoch: 2 | loss: 0.0379561
	speed: 0.0634s/iter; left time: 2918.7059s
Epoch: 2 cost time: 29.326887130737305
Epoch: 2, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.889076 --> -0.959976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0740416
	speed: 0.2319s/iter; left time: 10635.4177s
	iters: 200, epoch: 3 | loss: 0.0189971
	speed: 0.0624s/iter; left time: 2857.0832s
	iters: 300, epoch: 3 | loss: 0.0200250
	speed: 0.0597s/iter; left time: 2725.4146s
	iters: 400, epoch: 3 | loss: 0.1160206
	speed: 0.0554s/iter; left time: 2523.1474s
Epoch: 3 cost time: 28.06421947479248
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0730514
	speed: 0.2308s/iter; left time: 10474.9304s
	iters: 200, epoch: 4 | loss: 0.0496057
	speed: 0.0610s/iter; left time: 2761.8986s
	iters: 300, epoch: 4 | loss: 0.0288566
	speed: 0.0589s/iter; left time: 2660.3061s
	iters: 400, epoch: 4 | loss: 0.0501402
	speed: 0.0533s/iter; left time: 2402.5675s
Epoch: 4 cost time: 27.225921630859375
Epoch: 4, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.959976 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0937004
	speed: 0.1792s/iter; left time: 8049.5865s
	iters: 200, epoch: 5 | loss: 0.1076084
	speed: 0.0614s/iter; left time: 2752.5404s
	iters: 300, epoch: 5 | loss: 0.0236750
	speed: 0.0585s/iter; left time: 2615.9791s
	iters: 400, epoch: 5 | loss: 0.0198437
	speed: 0.0606s/iter; left time: 2703.7477s
Epoch: 5 cost time: 27.943730115890503
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.977129).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0279049
	speed: 0.2217s/iter; left time: 9853.6972s
	iters: 200, epoch: 6 | loss: 0.0089453
	speed: 0.0566s/iter; left time: 2509.5812s
	iters: 300, epoch: 6 | loss: 0.0117199
	speed: 0.0593s/iter; left time: 2625.9718s
	iters: 400, epoch: 6 | loss: 0.0177514
	speed: 0.0555s/iter; left time: 2452.1039s
Epoch: 6 cost time: 27.255131483078003
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977987).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0200547
	speed: 0.2236s/iter; left time: 9836.2873s
	iters: 200, epoch: 7 | loss: 0.0045548
	speed: 0.0623s/iter; left time: 2732.7805s
	iters: 300, epoch: 7 | loss: 0.3324156
	speed: 0.0593s/iter; left time: 2595.1698s
	iters: 400, epoch: 7 | loss: 0.0139886
	speed: 0.0617s/iter; left time: 2696.9082s
Epoch: 7 cost time: 28.827855110168457
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2805635
	speed: 0.2309s/iter; left time: 10049.9814s
	iters: 200, epoch: 8 | loss: 0.0096656
	speed: 0.0581s/iter; left time: 2523.5250s
	iters: 300, epoch: 8 | loss: 0.0111328
	speed: 0.0575s/iter; left time: 2491.5871s
	iters: 400, epoch: 8 | loss: 0.0036382
	speed: 0.0614s/iter; left time: 2653.3009s
Epoch: 8 cost time: 27.972331047058105
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0057830
	speed: 0.2312s/iter; left time: 9950.7858s
	iters: 200, epoch: 9 | loss: 0.0072064
	speed: 0.0570s/iter; left time: 2448.8080s
	iters: 300, epoch: 9 | loss: 0.0076078
	speed: 0.0625s/iter; left time: 2679.5662s
	iters: 400, epoch: 9 | loss: 0.0124196
	speed: 0.0562s/iter; left time: 2401.9309s
Epoch: 9 cost time: 28.075448989868164
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1277654
	speed: 0.2257s/iter; left time: 9612.0523s
	iters: 200, epoch: 10 | loss: 0.3869122
	speed: 0.0596s/iter; left time: 2533.3864s
	iters: 300, epoch: 10 | loss: 0.0024085
	speed: 0.0587s/iter; left time: 2488.9622s
	iters: 400, epoch: 10 | loss: 0.0580074
	speed: 0.0598s/iter; left time: 2529.8696s
Epoch: 10 cost time: 28.06526827812195
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977987 --> -0.978272).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009026
	speed: 0.2355s/iter; left time: 9916.5522s
	iters: 200, epoch: 11 | loss: 0.0053167
	speed: 0.0598s/iter; left time: 2511.2488s
	iters: 300, epoch: 11 | loss: 0.0085548
	speed: 0.0579s/iter; left time: 2425.5465s
	iters: 400, epoch: 11 | loss: 0.0062795
	speed: 0.0606s/iter; left time: 2534.4739s
Epoch: 11 cost time: 28.257604598999023
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0045323
	speed: 0.2310s/iter; left time: 9621.3032s
	iters: 200, epoch: 12 | loss: 0.1202018
	speed: 0.0593s/iter; left time: 2461.8153s
	iters: 300, epoch: 12 | loss: 0.0056226
	speed: 0.0552s/iter; left time: 2289.1610s
	iters: 400, epoch: 12 | loss: 0.0028842
	speed: 0.0537s/iter; left time: 2219.9749s
Epoch: 12 cost time: 26.69727063179016
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0333981
	speed: 0.1823s/iter; left time: 7503.8339s
	iters: 200, epoch: 13 | loss: 0.0007961
	speed: 0.0564s/iter; left time: 2316.6384s
	iters: 300, epoch: 13 | loss: 0.0027342
	speed: 0.0562s/iter; left time: 2304.5217s
	iters: 400, epoch: 13 | loss: 0.0004819
	speed: 0.0553s/iter; left time: 2258.7281s
Epoch: 13 cost time: 26.70484757423401
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0015519
	speed: 0.2126s/iter; left time: 8654.1117s
	iters: 200, epoch: 14 | loss: 0.0103334
	speed: 0.0580s/iter; left time: 2356.3176s
	iters: 300, epoch: 14 | loss: 0.0862110
	speed: 0.0563s/iter; left time: 2281.8399s
	iters: 400, epoch: 14 | loss: 0.0024475
	speed: 0.0575s/iter; left time: 2323.0659s
Epoch: 14 cost time: 27.2606840133667
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0193703
	speed: 0.2297s/iter; left time: 9243.0701s
	iters: 200, epoch: 15 | loss: 0.0023350
	speed: 0.0552s/iter; left time: 2213.8885s
	iters: 300, epoch: 15 | loss: 0.0434004
	speed: 0.0576s/iter; left time: 2305.7582s
	iters: 400, epoch: 15 | loss: 0.0019248
	speed: 0.0554s/iter; left time: 2211.7656s
Epoch: 15 cost time: 27.304015636444092
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0038793
	speed: 0.2236s/iter; left time: 8890.6815s
	iters: 200, epoch: 16 | loss: 0.0274099
	speed: 0.0552s/iter; left time: 2188.7171s
	iters: 300, epoch: 16 | loss: 0.0112264
	speed: 0.0598s/iter; left time: 2365.1999s
	iters: 400, epoch: 16 | loss: 0.0037670
	speed: 0.0567s/iter; left time: 2237.9617s
Epoch: 16 cost time: 27.658498287200928
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.978272 --> -0.983418).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0037626
	speed: 0.2246s/iter; left time: 8826.9734s
	iters: 200, epoch: 17 | loss: 0.2258237
	speed: 0.0575s/iter; left time: 2252.2953s
	iters: 300, epoch: 17 | loss: 0.0043576
	speed: 0.0590s/iter; left time: 2306.4294s
	iters: 400, epoch: 17 | loss: 0.0024161
	speed: 0.0581s/iter; left time: 2266.7116s
Epoch: 17 cost time: 27.513109922409058
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0411424
	speed: 0.2182s/iter; left time: 8474.1886s
	iters: 200, epoch: 18 | loss: 0.0022671
	speed: 0.0518s/iter; left time: 2007.7649s
	iters: 300, epoch: 18 | loss: 0.0362932
	speed: 0.0548s/iter; left time: 2117.4231s
	iters: 400, epoch: 18 | loss: 0.0008045
	speed: 0.0591s/iter; left time: 2275.6860s
Epoch: 18 cost time: 26.8469021320343
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0026940
	speed: 0.2326s/iter; left time: 8920.5296s
	iters: 200, epoch: 19 | loss: 0.0202787
	speed: 0.0573s/iter; left time: 2190.4174s
	iters: 300, epoch: 19 | loss: 0.2686489
	speed: 0.0581s/iter; left time: 2217.9382s
	iters: 400, epoch: 19 | loss: 0.0136784
	speed: 0.0601s/iter; left time: 2287.0230s
Epoch: 19 cost time: 28.14678645133972
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0273483
	speed: 0.2329s/iter; left time: 8824.9388s
	iters: 200, epoch: 20 | loss: 0.0006686
	speed: 0.0568s/iter; left time: 2147.1465s
	iters: 300, epoch: 20 | loss: 0.0061189
	speed: 0.0559s/iter; left time: 2108.7346s
	iters: 400, epoch: 20 | loss: 0.0027809
	speed: 0.0567s/iter; left time: 2132.4392s
Epoch: 20 cost time: 27.36558699607849
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0027273
	speed: 0.2260s/iter; left time: 8456.3837s
	iters: 200, epoch: 21 | loss: 0.0010830
	speed: 0.0532s/iter; left time: 1985.1504s
	iters: 300, epoch: 21 | loss: 0.0079759
	speed: 0.0548s/iter; left time: 2040.9122s
	iters: 400, epoch: 21 | loss: 0.0002356
	speed: 0.0555s/iter; left time: 2060.9315s
Epoch: 21 cost time: 26.44889235496521
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0005347
	speed: 0.2246s/iter; left time: 8299.4943s
	iters: 200, epoch: 22 | loss: 0.0114135
	speed: 0.0554s/iter; left time: 2043.2884s
	iters: 300, epoch: 22 | loss: 0.3014334
	speed: 0.0588s/iter; left time: 2161.0715s
	iters: 400, epoch: 22 | loss: 0.0050275
	speed: 0.0597s/iter; left time: 2187.8831s
Epoch: 22 cost time: 27.645042181015015
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0324471
	speed: 0.2197s/iter; left time: 8016.6281s
	iters: 200, epoch: 23 | loss: 0.3299229
	speed: 0.0613s/iter; left time: 2230.2902s
	iters: 300, epoch: 23 | loss: 0.0003253
	speed: 0.0568s/iter; left time: 2062.4484s
	iters: 400, epoch: 23 | loss: 0.0135956
	speed: 0.0538s/iter; left time: 1946.4121s
Epoch: 23 cost time: 27.28439712524414
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0012553
	speed: 0.2203s/iter; left time: 7932.2129s
	iters: 200, epoch: 24 | loss: 0.0000629
	speed: 0.0584s/iter; left time: 2097.2551s
	iters: 300, epoch: 24 | loss: 0.0013230
	speed: 0.0564s/iter; left time: 2021.5011s
	iters: 400, epoch: 24 | loss: 0.0012679
	speed: 0.0534s/iter; left time: 1908.3872s
Epoch: 24 cost time: 27.04905414581299
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1043883
	speed: 0.2124s/iter; left time: 7551.3857s
	iters: 200, epoch: 25 | loss: 0.0677539
	speed: 0.0570s/iter; left time: 2021.6724s
	iters: 300, epoch: 25 | loss: 0.0424509
	speed: 0.0585s/iter; left time: 2066.6784s
	iters: 400, epoch: 25 | loss: 0.0780723
	speed: 0.0541s/iter; left time: 1905.5078s
Epoch: 25 cost time: 26.83648443222046
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0069577
	speed: 0.1863s/iter; left time: 6533.1872s
	iters: 200, epoch: 26 | loss: 0.0056412
	speed: 0.0543s/iter; left time: 1900.1249s
	iters: 300, epoch: 26 | loss: 0.0432144
	speed: 0.0473s/iter; left time: 1650.7449s
	iters: 400, epoch: 26 | loss: 0.0043612
	speed: 0.0498s/iter; left time: 1732.2772s
Epoch: 26 cost time: 24.137317419052124
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 219370
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6335422
	speed: 0.0634s/iter; left time: 2966.7953s
	iters: 200, epoch: 1 | loss: 1.1803119
	speed: 0.0579s/iter; left time: 2705.6204s
	iters: 300, epoch: 1 | loss: 0.6360061
	speed: 0.0562s/iter; left time: 2616.9315s
	iters: 400, epoch: 1 | loss: 0.5959381
	speed: 0.0593s/iter; left time: 2759.6963s
Epoch: 1 cost time: 27.405154705047607
Epoch: 1, Steps: 469 | Train Loss: 1.224 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
Validation loss decreased (inf --> -0.839046).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2688456
	speed: 0.2034s/iter; left time: 9426.0525s
	iters: 200, epoch: 2 | loss: 0.2718473
	speed: 0.0555s/iter; left time: 2566.0099s
	iters: 300, epoch: 2 | loss: 0.3516137
	speed: 0.0540s/iter; left time: 2492.4064s
	iters: 400, epoch: 2 | loss: 0.1189039
	speed: 0.0573s/iter; left time: 2638.9676s
Epoch: 2 cost time: 26.091002702713013
Epoch: 2, Steps: 469 | Train Loss: 0.324 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.839046 --> -0.933388).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0844766
	speed: 0.2077s/iter; left time: 9527.5255s
	iters: 200, epoch: 3 | loss: 0.0388829
	speed: 0.0542s/iter; left time: 2478.4492s
	iters: 300, epoch: 3 | loss: 0.0495179
	speed: 0.0533s/iter; left time: 2434.1673s
	iters: 400, epoch: 3 | loss: 0.0809796
	speed: 0.0529s/iter; left time: 2408.9265s
Epoch: 3 cost time: 25.74506139755249
Epoch: 3, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.933388 --> -0.953972).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1846645
	speed: 0.2043s/iter; left time: 9274.3330s
	iters: 200, epoch: 4 | loss: 0.2342927
	speed: 0.0486s/iter; left time: 2202.6203s
	iters: 300, epoch: 4 | loss: 0.1126064
	speed: 0.0511s/iter; left time: 2308.1306s
	iters: 400, epoch: 4 | loss: 0.2279878
	speed: 0.0472s/iter; left time: 2126.5792s
Epoch: 4 cost time: 24.078288078308105
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.953972 --> -0.969696).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0645494
	speed: 0.1750s/iter; left time: 7860.3863s
	iters: 200, epoch: 5 | loss: 0.0879596
	speed: 0.0530s/iter; left time: 2374.8738s
	iters: 300, epoch: 5 | loss: 0.0376324
	speed: 0.0540s/iter; left time: 2415.5250s
	iters: 400, epoch: 5 | loss: 0.0750903
	speed: 0.0532s/iter; left time: 2373.9202s
Epoch: 5 cost time: 25.274593114852905
Epoch: 5, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0453627
	speed: 0.2128s/iter; left time: 9460.6641s
	iters: 200, epoch: 6 | loss: 0.0640444
	speed: 0.0558s/iter; left time: 2473.8215s
	iters: 300, epoch: 6 | loss: 0.0576799
	speed: 0.0556s/iter; left time: 2462.5328s
	iters: 400, epoch: 6 | loss: 0.1014054
	speed: 0.0532s/iter; left time: 2348.2935s
Epoch: 6 cost time: 26.35893988609314
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.971983).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0559699
	speed: 0.2049s/iter; left time: 9012.4037s
	iters: 200, epoch: 7 | loss: 0.0292234
	speed: 0.0535s/iter; left time: 2347.8959s
	iters: 300, epoch: 7 | loss: 0.1323624
	speed: 0.0520s/iter; left time: 2276.9557s
	iters: 400, epoch: 7 | loss: 0.0200198
	speed: 0.0527s/iter; left time: 2301.4043s
Epoch: 7 cost time: 25.049965620040894
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3135317
	speed: 0.2079s/iter; left time: 9048.3772s
	iters: 200, epoch: 8 | loss: 0.0053449
	speed: 0.0540s/iter; left time: 2345.8776s
	iters: 300, epoch: 8 | loss: 0.0104955
	speed: 0.0538s/iter; left time: 2330.6482s
	iters: 400, epoch: 8 | loss: 0.0238356
	speed: 0.0514s/iter; left time: 2220.8383s
Epoch: 8 cost time: 25.45518398284912
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0161850
	speed: 0.1945s/iter; left time: 8373.3930s
	iters: 200, epoch: 9 | loss: 0.0067721
	speed: 0.0545s/iter; left time: 2342.4023s
	iters: 300, epoch: 9 | loss: 0.0044986
	speed: 0.0490s/iter; left time: 2100.6128s
	iters: 400, epoch: 9 | loss: 0.0435481
	speed: 0.0520s/iter; left time: 2222.7115s
Epoch: 9 cost time: 24.54657530784607
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2658107
	speed: 0.1922s/iter; left time: 8185.9074s
	iters: 200, epoch: 10 | loss: 0.2358861
	speed: 0.0503s/iter; left time: 2136.6308s
	iters: 300, epoch: 10 | loss: 0.0617838
	speed: 0.0558s/iter; left time: 2365.1489s
	iters: 400, epoch: 10 | loss: 0.0412901
	speed: 0.0504s/iter; left time: 2131.9185s
Epoch: 10 cost time: 25.126557111740112
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0020413
	speed: 0.1950s/iter; left time: 8212.4628s
	iters: 200, epoch: 11 | loss: 0.0159911
	speed: 0.0539s/iter; left time: 2266.0671s
	iters: 300, epoch: 11 | loss: 0.0304790
	speed: 0.0525s/iter; left time: 2202.2569s
	iters: 400, epoch: 11 | loss: 0.0033425
	speed: 0.0534s/iter; left time: 2233.9632s
Epoch: 11 cost time: 25.085183143615723
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0193735
	speed: 0.2015s/iter; left time: 8391.3871s
	iters: 200, epoch: 12 | loss: 0.0110104
	speed: 0.0520s/iter; left time: 2160.2505s
	iters: 300, epoch: 12 | loss: 0.0305919
	speed: 0.0506s/iter; left time: 2098.0084s
	iters: 400, epoch: 12 | loss: 0.0736574
	speed: 0.0517s/iter; left time: 2136.2665s
Epoch: 12 cost time: 24.655152320861816
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0642623
	speed: 0.1722s/iter; left time: 7090.3913s
	iters: 200, epoch: 13 | loss: 0.0388388
	speed: 0.0503s/iter; left time: 2067.8935s
	iters: 300, epoch: 13 | loss: 0.0067190
	speed: 0.0492s/iter; left time: 2015.4395s
	iters: 400, epoch: 13 | loss: 0.0541273
	speed: 0.0472s/iter; left time: 1927.6724s
Epoch: 13 cost time: 23.489357471466064
Epoch: 13, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.971983 --> -0.972841).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0046956
	speed: 0.1734s/iter; left time: 7057.8989s
	iters: 200, epoch: 14 | loss: 0.0299684
	speed: 0.0484s/iter; left time: 1966.4845s
	iters: 300, epoch: 14 | loss: 0.0050629
	speed: 0.0491s/iter; left time: 1988.1210s
	iters: 400, epoch: 14 | loss: 0.0044191
	speed: 0.0493s/iter; left time: 1993.7569s
Epoch: 14 cost time: 23.151600122451782
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0146551
	speed: 0.1970s/iter; left time: 7925.9029s
	iters: 200, epoch: 15 | loss: 0.0091432
	speed: 0.0575s/iter; left time: 2309.4748s
	iters: 300, epoch: 15 | loss: 0.0692219
	speed: 0.0550s/iter; left time: 2203.3959s
	iters: 400, epoch: 15 | loss: 0.0047369
	speed: 0.0549s/iter; left time: 2194.1019s
Epoch: 15 cost time: 27.364989042282104
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.972841 --> -0.979130).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0267715
	speed: 0.2409s/iter; left time: 9581.1643s
	iters: 200, epoch: 16 | loss: 0.0317802
	speed: 0.0586s/iter; left time: 2326.3253s
	iters: 300, epoch: 16 | loss: 0.0010893
	speed: 0.0611s/iter; left time: 2418.0368s
	iters: 400, epoch: 16 | loss: 0.0008208
	speed: 0.0587s/iter; left time: 2317.1354s
Epoch: 16 cost time: 27.77077054977417
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0093858
	speed: 0.2405s/iter; left time: 9452.6305s
	iters: 200, epoch: 17 | loss: 0.0459696
	speed: 0.0540s/iter; left time: 2116.8723s
	iters: 300, epoch: 17 | loss: 0.0245040
	speed: 0.0571s/iter; left time: 2230.9711s
	iters: 400, epoch: 17 | loss: 0.0169224
	speed: 0.0591s/iter; left time: 2306.5586s
Epoch: 17 cost time: 27.461024522781372
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0024517
	speed: 0.2302s/iter; left time: 8939.3435s
	iters: 200, epoch: 18 | loss: 0.0051617
	speed: 0.0598s/iter; left time: 2315.5217s
	iters: 300, epoch: 18 | loss: 0.0152465
	speed: 0.0595s/iter; left time: 2297.4944s
	iters: 400, epoch: 18 | loss: 0.0039206
	speed: 0.0549s/iter; left time: 2116.7321s
Epoch: 18 cost time: 27.596782445907593
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0189775
	speed: 0.2436s/iter; left time: 9343.2635s
	iters: 200, epoch: 19 | loss: 0.0080427
	speed: 0.0547s/iter; left time: 2091.0597s
	iters: 300, epoch: 19 | loss: 0.5398671
	speed: 0.0580s/iter; left time: 2214.3541s
	iters: 400, epoch: 19 | loss: 0.0035346
	speed: 0.0557s/iter; left time: 2119.4085s
Epoch: 19 cost time: 26.96588969230652
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0611432
	speed: 0.2306s/iter; left time: 8737.0555s
	iters: 200, epoch: 20 | loss: 0.0013201
	speed: 0.0581s/iter; left time: 2196.3831s
	iters: 300, epoch: 20 | loss: 0.0243671
	speed: 0.0539s/iter; left time: 2032.3940s
	iters: 400, epoch: 20 | loss: 0.0699703
	speed: 0.0582s/iter; left time: 2186.0353s
Epoch: 20 cost time: 27.342879056930542
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0047721
	speed: 0.2377s/iter; left time: 8894.2762s
	iters: 200, epoch: 21 | loss: 0.0013278
	speed: 0.0579s/iter; left time: 2161.3538s
	iters: 300, epoch: 21 | loss: 0.0039602
	speed: 0.0585s/iter; left time: 2177.0452s
	iters: 400, epoch: 21 | loss: 0.0026292
	speed: 0.0592s/iter; left time: 2197.0186s
Epoch: 21 cost time: 27.417885303497314
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0019537
	speed: 0.2385s/iter; left time: 8812.7204s
	iters: 200, epoch: 22 | loss: 0.0093414
	speed: 0.0586s/iter; left time: 2159.9974s
	iters: 300, epoch: 22 | loss: 0.1081027
	speed: 0.0566s/iter; left time: 2080.9140s
	iters: 400, epoch: 22 | loss: 0.0009011
	speed: 0.0600s/iter; left time: 2198.3331s
Epoch: 22 cost time: 27.98168158531189
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0502462
	speed: 0.2268s/iter; left time: 8274.9844s
	iters: 200, epoch: 23 | loss: 0.0025229
	speed: 0.0564s/iter; left time: 2052.2322s
	iters: 300, epoch: 23 | loss: 0.0043410
	speed: 0.0557s/iter; left time: 2021.5398s
	iters: 400, epoch: 23 | loss: 0.0022840
	speed: 0.0541s/iter; left time: 1957.9269s
Epoch: 23 cost time: 26.329647302627563
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0032331
	speed: 0.2322s/iter; left time: 8361.6720s
	iters: 200, epoch: 24 | loss: 0.0038732
	speed: 0.0567s/iter; left time: 2036.5579s
	iters: 300, epoch: 24 | loss: 0.0004931
	speed: 0.0558s/iter; left time: 1999.0293s
	iters: 400, epoch: 24 | loss: 0.0004768
	speed: 0.0593s/iter; left time: 2116.7451s
Epoch: 24 cost time: 27.452930450439453
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0040633
	speed: 0.2365s/iter; left time: 8407.5341s
	iters: 200, epoch: 25 | loss: 0.0117130
	speed: 0.0594s/iter; left time: 2105.4467s
	iters: 300, epoch: 25 | loss: 0.0118442
	speed: 0.0588s/iter; left time: 2076.9816s
	iters: 400, epoch: 25 | loss: 0.0063718
	speed: 0.0612s/iter; left time: 2157.3260s
Epoch: 25 cost time: 27.805405616760254
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 219370
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5646302
	speed: 0.0775s/iter; left time: 3625.9533s
	iters: 200, epoch: 1 | loss: 1.2038163
	speed: 0.0653s/iter; left time: 3047.5052s
	iters: 300, epoch: 1 | loss: 0.5363670
	speed: 0.0622s/iter; left time: 2897.7830s
	iters: 400, epoch: 1 | loss: 0.5442137
	speed: 0.0588s/iter; left time: 2736.3742s
Epoch: 1 cost time: 30.6545889377594
Epoch: 1, Steps: 469 | Train Loss: 1.109 Vali Loss: 0.403 Vali Acc: 0.894 Test Loss: 0.403 Test Acc: 0.894
Validation loss decreased (inf --> -0.894221).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2610837
	speed: 0.2563s/iter; left time: 11873.8172s
	iters: 200, epoch: 2 | loss: 0.1662363
	speed: 0.0577s/iter; left time: 2668.4837s
	iters: 300, epoch: 2 | loss: 0.2969787
	speed: 0.0623s/iter; left time: 2875.8284s
	iters: 400, epoch: 2 | loss: 0.0445022
	speed: 0.0651s/iter; left time: 2995.1739s
Epoch: 2 cost time: 29.375802993774414
Epoch: 2, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.894221 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0602601
	speed: 0.2409s/iter; left time: 11050.5668s
	iters: 200, epoch: 3 | loss: 0.0219106
	speed: 0.0627s/iter; left time: 2870.2385s
	iters: 300, epoch: 3 | loss: 0.0140355
	speed: 0.0617s/iter; left time: 2818.5299s
	iters: 400, epoch: 3 | loss: 0.1160207
	speed: 0.0595s/iter; left time: 2709.5372s
Epoch: 3 cost time: 28.94257164001465
Epoch: 3, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.948826 --> -0.952828).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0958333
	speed: 0.2506s/iter; left time: 11376.3203s
	iters: 200, epoch: 4 | loss: 0.1559533
	speed: 0.0557s/iter; left time: 2524.4906s
	iters: 300, epoch: 4 | loss: 0.0610423
	speed: 0.0568s/iter; left time: 2566.5914s
	iters: 400, epoch: 4 | loss: 0.0379429
	speed: 0.0606s/iter; left time: 2730.7990s
Epoch: 4 cost time: 27.7878360748291
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.952828 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0328156
	speed: 0.2369s/iter; left time: 10641.4293s
	iters: 200, epoch: 5 | loss: 0.0623769
	speed: 0.0610s/iter; left time: 2734.4380s
	iters: 300, epoch: 5 | loss: 0.0305994
	speed: 0.0602s/iter; left time: 2692.9384s
	iters: 400, epoch: 5 | loss: 0.0133973
	speed: 0.0637s/iter; left time: 2840.7602s
Epoch: 5 cost time: 28.975775241851807
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.967123 --> -0.967409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0086446
	speed: 0.2421s/iter; left time: 10762.3864s
	iters: 200, epoch: 6 | loss: 0.0383370
	speed: 0.0592s/iter; left time: 2626.9532s
	iters: 300, epoch: 6 | loss: 0.0076029
	speed: 0.0615s/iter; left time: 2720.4605s
	iters: 400, epoch: 6 | loss: 0.1177664
	speed: 0.0581s/iter; left time: 2565.3696s
Epoch: 6 cost time: 28.421717643737793
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0157114
	speed: 0.2583s/iter; left time: 11363.0896s
	iters: 200, epoch: 7 | loss: 0.0063913
	speed: 0.0559s/iter; left time: 2455.2451s
	iters: 300, epoch: 7 | loss: 0.0129622
	speed: 0.0580s/iter; left time: 2541.7419s
	iters: 400, epoch: 7 | loss: 0.0608739
	speed: 0.0600s/iter; left time: 2619.2391s
Epoch: 7 cost time: 27.919590711593628
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3170250
	speed: 0.2379s/iter; left time: 10354.0052s
	iters: 200, epoch: 8 | loss: 0.0220649
	speed: 0.0536s/iter; left time: 2327.9448s
	iters: 300, epoch: 8 | loss: 0.0365929
	speed: 0.0517s/iter; left time: 2237.7043s
	iters: 400, epoch: 8 | loss: 0.0139673
	speed: 0.0490s/iter; left time: 2117.6766s
Epoch: 8 cost time: 24.748414278030396
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.969696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0453804
	speed: 0.1791s/iter; left time: 7708.5840s
	iters: 200, epoch: 9 | loss: 0.0044792
	speed: 0.0493s/iter; left time: 2117.4050s
	iters: 300, epoch: 9 | loss: 0.0105090
	speed: 0.0488s/iter; left time: 2089.4905s
	iters: 400, epoch: 9 | loss: 0.0306064
	speed: 0.0479s/iter; left time: 2047.7355s
Epoch: 9 cost time: 23.55406904220581
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0102059
	speed: 0.2333s/iter; left time: 9935.7423s
	iters: 200, epoch: 10 | loss: 0.0953916
	speed: 0.0561s/iter; left time: 2381.8902s
	iters: 300, epoch: 10 | loss: 0.0185361
	speed: 0.0563s/iter; left time: 2386.4793s
	iters: 400, epoch: 10 | loss: 0.0472798
	speed: 0.0602s/iter; left time: 2544.3860s
Epoch: 10 cost time: 27.572116374969482
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0070449
	speed: 0.2461s/iter; left time: 10362.7912s
	iters: 200, epoch: 11 | loss: 0.0024445
	speed: 0.0571s/iter; left time: 2397.6384s
	iters: 300, epoch: 11 | loss: 0.0192058
	speed: 0.0581s/iter; left time: 2433.0147s
	iters: 400, epoch: 11 | loss: 0.0077766
	speed: 0.0598s/iter; left time: 2502.0177s
Epoch: 11 cost time: 28.01924204826355
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.972269).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0183607
	speed: 0.2391s/iter; left time: 9955.7361s
	iters: 200, epoch: 12 | loss: 0.0105279
	speed: 0.0579s/iter; left time: 2406.9352s
	iters: 300, epoch: 12 | loss: 0.1843412
	speed: 0.0624s/iter; left time: 2586.2644s
	iters: 400, epoch: 12 | loss: 0.0264286
	speed: 0.0616s/iter; left time: 2546.6526s
Epoch: 12 cost time: 28.93106770515442
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0213799
	speed: 0.2533s/iter; left time: 10430.0037s
	iters: 200, epoch: 13 | loss: 0.0005775
	speed: 0.0592s/iter; left time: 2430.7586s
	iters: 300, epoch: 13 | loss: 0.0036948
	speed: 0.0626s/iter; left time: 2563.7304s
	iters: 400, epoch: 13 | loss: 0.0328597
	speed: 0.0608s/iter; left time: 2485.7627s
Epoch: 13 cost time: 29.036603450775146
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0021994
	speed: 0.2399s/iter; left time: 9765.6570s
	iters: 200, epoch: 14 | loss: 0.0007142
	speed: 0.0584s/iter; left time: 2370.3204s
	iters: 300, epoch: 14 | loss: 0.0085593
	speed: 0.0577s/iter; left time: 2338.5348s
	iters: 400, epoch: 14 | loss: 0.0077440
	speed: 0.0598s/iter; left time: 2414.7993s
Epoch: 14 cost time: 28.24556589126587
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1548006
	speed: 0.2395s/iter; left time: 9634.3445s
	iters: 200, epoch: 15 | loss: 0.0051605
	speed: 0.0591s/iter; left time: 2371.4927s
	iters: 300, epoch: 15 | loss: 0.1746506
	speed: 0.0565s/iter; left time: 2262.5249s
	iters: 400, epoch: 15 | loss: 0.0072414
	speed: 0.0532s/iter; left time: 2125.4254s
Epoch: 15 cost time: 26.83827519416809
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0030108
	speed: 0.1864s/iter; left time: 7412.9109s
	iters: 200, epoch: 16 | loss: 0.0348693
	speed: 0.0522s/iter; left time: 2071.8684s
	iters: 300, epoch: 16 | loss: 0.0012000
	speed: 0.0512s/iter; left time: 2024.6150s
	iters: 400, epoch: 16 | loss: 0.0020257
	speed: 0.0507s/iter; left time: 1999.9021s
Epoch: 16 cost time: 24.927018880844116
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.972269 --> -0.976271).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0076212
	speed: 0.2407s/iter; left time: 9458.6553s
	iters: 200, epoch: 17 | loss: 0.0058937
	speed: 0.0577s/iter; left time: 2261.9415s
	iters: 300, epoch: 17 | loss: 0.0081793
	speed: 0.0566s/iter; left time: 2210.9785s
	iters: 400, epoch: 17 | loss: 0.0022964
	speed: 0.0558s/iter; left time: 2175.4972s
Epoch: 17 cost time: 27.654175996780396
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0398538
	speed: 0.2316s/iter; left time: 8993.6394s
	iters: 200, epoch: 18 | loss: 0.0012960
	speed: 0.0599s/iter; left time: 2318.4664s
	iters: 300, epoch: 18 | loss: 0.0035543
	speed: 0.0563s/iter; left time: 2175.9227s
	iters: 400, epoch: 18 | loss: 0.0012297
	speed: 0.0549s/iter; left time: 2115.0620s
Epoch: 18 cost time: 27.550939321517944
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0237310
	speed: 0.2242s/iter; left time: 8600.2751s
	iters: 200, epoch: 19 | loss: 0.0059982
	speed: 0.0573s/iter; left time: 2193.2539s
	iters: 300, epoch: 19 | loss: 0.2368618
	speed: 0.0553s/iter; left time: 2110.6685s
	iters: 400, epoch: 19 | loss: 0.0025656
	speed: 0.0617s/iter; left time: 2347.5787s
Epoch: 19 cost time: 27.842788696289062
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0023522
	speed: 0.2412s/iter; left time: 9138.8256s
	iters: 200, epoch: 20 | loss: 0.0008124
	speed: 0.0589s/iter; left time: 2224.7153s
	iters: 300, epoch: 20 | loss: 0.0025800
	speed: 0.0580s/iter; left time: 2187.6379s
	iters: 400, epoch: 20 | loss: 0.0030243
	speed: 0.0603s/iter; left time: 2266.9303s
Epoch: 20 cost time: 28.502377033233643
Epoch: 20, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0013947
	speed: 0.2374s/iter; left time: 8882.0046s
	iters: 200, epoch: 21 | loss: 0.1307773
	speed: 0.0574s/iter; left time: 2140.6763s
	iters: 300, epoch: 21 | loss: 0.0003529
	speed: 0.0597s/iter; left time: 2221.4432s
	iters: 400, epoch: 21 | loss: 0.0017947
	speed: 0.0602s/iter; left time: 2233.0109s
Epoch: 21 cost time: 28.338480949401855
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977415).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0043180
	speed: 0.2349s/iter; left time: 8681.4452s
	iters: 200, epoch: 22 | loss: 0.1038986
	speed: 0.0578s/iter; left time: 2130.0484s
	iters: 300, epoch: 22 | loss: 0.0879254
	speed: 0.0585s/iter; left time: 2150.6364s
	iters: 400, epoch: 22 | loss: 0.0006628
	speed: 0.0584s/iter; left time: 2139.1897s
Epoch: 22 cost time: 27.51297378540039
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0485012
	speed: 0.2459s/iter; left time: 8969.4096s
	iters: 200, epoch: 23 | loss: 0.0186062
	speed: 0.0614s/iter; left time: 2235.5400s
	iters: 300, epoch: 23 | loss: 0.0003378
	speed: 0.0598s/iter; left time: 2171.1243s
	iters: 400, epoch: 23 | loss: 0.0021253
	speed: 0.0559s/iter; left time: 2023.6566s
Epoch: 23 cost time: 28.36291480064392
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0013803
	speed: 0.2449s/iter; left time: 8820.9306s
	iters: 200, epoch: 24 | loss: 0.0108398
	speed: 0.0613s/iter; left time: 2202.9208s
	iters: 300, epoch: 24 | loss: 0.0004825
	speed: 0.0591s/iter; left time: 2117.3792s
	iters: 400, epoch: 24 | loss: 0.0107219
	speed: 0.0552s/iter; left time: 1971.5709s
Epoch: 24 cost time: 28.13142681121826
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0017937
	speed: 0.2423s/iter; left time: 8612.6222s
	iters: 200, epoch: 25 | loss: 0.0333751
	speed: 0.0601s/iter; left time: 2131.4995s
	iters: 300, epoch: 25 | loss: 0.0008725
	speed: 0.0583s/iter; left time: 2060.4437s
	iters: 400, epoch: 25 | loss: 0.0023915
	speed: 0.0545s/iter; left time: 1922.1577s
Epoch: 25 cost time: 27.691690683364868
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0391227
	speed: 0.2273s/iter; left time: 7972.7981s
	iters: 200, epoch: 26 | loss: 0.0012616
	speed: 0.0565s/iter; left time: 1977.6439s
	iters: 300, epoch: 26 | loss: 0.0079591
	speed: 0.0589s/iter; left time: 2054.1066s
	iters: 400, epoch: 26 | loss: 0.0076455
	speed: 0.0528s/iter; left time: 1837.4443s
Epoch: 26 cost time: 27.01015067100525
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0419647
	speed: 0.2468s/iter; left time: 8541.6342s
	iters: 200, epoch: 27 | loss: 0.0042113
	speed: 0.0611s/iter; left time: 2106.6778s
	iters: 300, epoch: 27 | loss: 0.0451445
	speed: 0.0588s/iter; left time: 2023.9092s
	iters: 400, epoch: 27 | loss: 0.0038370
	speed: 0.0577s/iter; left time: 1980.3443s
Epoch: 27 cost time: 27.644063472747803
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0028937
	speed: 0.1874s/iter; left time: 6395.9284s
	iters: 200, epoch: 28 | loss: 0.0711467
	speed: 0.0518s/iter; left time: 1761.8649s
	iters: 300, epoch: 28 | loss: 0.0022046
	speed: 0.0526s/iter; left time: 1785.1813s
	iters: 400, epoch: 28 | loss: 0.7369973
	speed: 0.0525s/iter; left time: 1775.2061s
Epoch: 28 cost time: 25.039085388183594
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0277402
	speed: 0.1935s/iter; left time: 6514.5287s
	iters: 200, epoch: 29 | loss: 0.0048190
	speed: 0.0537s/iter; left time: 1802.8413s
	iters: 300, epoch: 29 | loss: 0.0123737
	speed: 0.0589s/iter; left time: 1972.4566s
	iters: 400, epoch: 29 | loss: 0.0006834
	speed: 0.0556s/iter; left time: 1854.2872s
Epoch: 29 cost time: 26.440086126327515
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.978272).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0009649
	speed: 0.2220s/iter; left time: 7369.4278s
	iters: 200, epoch: 30 | loss: 0.0126461
	speed: 0.0579s/iter; left time: 1916.3098s
	iters: 300, epoch: 30 | loss: 0.0053350
	speed: 0.0569s/iter; left time: 1878.8419s
	iters: 400, epoch: 30 | loss: 0.0029479
	speed: 0.0603s/iter; left time: 1983.4420s
Epoch: 30 cost time: 27.668068408966064
Epoch: 30, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0057643
	speed: 0.2312s/iter; left time: 7567.2655s
	iters: 200, epoch: 31 | loss: 0.1075228
	speed: 0.0586s/iter; left time: 1911.2469s
	iters: 300, epoch: 31 | loss: 0.0047073
	speed: 0.0608s/iter; left time: 1978.9771s
	iters: 400, epoch: 31 | loss: 0.0064594
	speed: 0.0562s/iter; left time: 1821.8941s
Epoch: 31 cost time: 27.935739755630493
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0025885
	speed: 0.2439s/iter; left time: 7869.9069s
	iters: 200, epoch: 32 | loss: 0.0118147
	speed: 0.0570s/iter; left time: 1832.4995s
	iters: 300, epoch: 32 | loss: 0.0019319
	speed: 0.0596s/iter; left time: 1911.8393s
	iters: 400, epoch: 32 | loss: 0.0000987
	speed: 0.0620s/iter; left time: 1981.6397s
Epoch: 32 cost time: 28.08603286743164
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0041689
	speed: 0.2324s/iter; left time: 7390.0069s
	iters: 200, epoch: 33 | loss: 0.0050084
	speed: 0.0568s/iter; left time: 1800.2421s
	iters: 300, epoch: 33 | loss: 0.0013513
	speed: 0.0527s/iter; left time: 1664.2341s
	iters: 400, epoch: 33 | loss: 0.0017158
	speed: 0.0571s/iter; left time: 1798.7249s
Epoch: 33 cost time: 27.153778076171875
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0012203
	speed: 0.2276s/iter; left time: 7130.0649s
	iters: 200, epoch: 34 | loss: 0.0024261
	speed: 0.0571s/iter; left time: 1781.5481s
	iters: 300, epoch: 34 | loss: 0.0049884
	speed: 0.0611s/iter; left time: 1900.8449s
	iters: 400, epoch: 34 | loss: 0.0010453
	speed: 0.0560s/iter; left time: 1738.2733s
Epoch: 34 cost time: 27.53492546081543
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000817
	speed: 0.2309s/iter; left time: 7124.4018s
	iters: 200, epoch: 35 | loss: 0.0001454
	speed: 0.0571s/iter; left time: 1755.1880s
	iters: 300, epoch: 35 | loss: 0.0027400
	speed: 0.0556s/iter; left time: 1705.8291s
	iters: 400, epoch: 35 | loss: 0.0008829
	speed: 0.0600s/iter; left time: 1832.3375s
Epoch: 35 cost time: 27.54824948310852
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0003087
	speed: 0.2261s/iter; left time: 6871.6750s
	iters: 200, epoch: 36 | loss: 0.0144867
	speed: 0.0579s/iter; left time: 1752.7724s
	iters: 300, epoch: 36 | loss: 0.0018849
	speed: 0.0606s/iter; left time: 1828.5276s
	iters: 400, epoch: 36 | loss: 0.0029138
	speed: 0.0565s/iter; left time: 1699.1045s
Epoch: 36 cost time: 27.590678453445435
Epoch: 36, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0002968
	speed: 0.2268s/iter; left time: 6785.3960s
	iters: 200, epoch: 37 | loss: 0.0001828
	speed: 0.0568s/iter; left time: 1692.6740s
	iters: 300, epoch: 37 | loss: 0.0003358
	speed: 0.0581s/iter; left time: 1725.9581s
	iters: 400, epoch: 37 | loss: 0.0005472
	speed: 0.0600s/iter; left time: 1775.7881s
Epoch: 37 cost time: 27.59530782699585
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0488054
	speed: 0.2300s/iter; left time: 6773.1551s
	iters: 200, epoch: 38 | loss: 0.0007707
	speed: 0.0572s/iter; left time: 1679.7773s
	iters: 300, epoch: 38 | loss: 0.0013393
	speed: 0.0591s/iter; left time: 1727.1620s
	iters: 400, epoch: 38 | loss: 0.0001998
	speed: 0.0606s/iter; left time: 1765.3841s
Epoch: 38 cost time: 27.708033323287964
Epoch: 38, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0058259
	speed: 0.2373s/iter; left time: 6876.0259s
	iters: 200, epoch: 39 | loss: 0.0003724
	speed: 0.0534s/iter; left time: 1540.7650s
	iters: 300, epoch: 39 | loss: 0.0010449
	speed: 0.0473s/iter; left time: 1361.7785s
	iters: 400, epoch: 39 | loss: 0.0024526
	speed: 0.0486s/iter; left time: 1394.9477s
Epoch: 39 cost time: 24.337022066116333
Epoch: 39, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 219370
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3097537
	speed: 0.0678s/iter; left time: 3173.9777s
	iters: 200, epoch: 1 | loss: 2.3024533
	speed: 0.0518s/iter; left time: 2419.5592s
	iters: 300, epoch: 1 | loss: 2.2994182
	speed: 0.0528s/iter; left time: 2459.8272s
	iters: 400, epoch: 1 | loss: 2.3034439
	speed: 0.0542s/iter; left time: 2518.4020s
Epoch: 1 cost time: 26.833856344223022
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3032143
	speed: 0.2210s/iter; left time: 10239.5173s
	iters: 200, epoch: 2 | loss: 2.3060243
	speed: 0.0533s/iter; left time: 2465.2662s
	iters: 300, epoch: 2 | loss: 2.3093309
	speed: 0.0579s/iter; left time: 2672.1251s
	iters: 400, epoch: 2 | loss: 2.3029177
	speed: 0.0524s/iter; left time: 2413.6470s
Epoch: 2 cost time: 26.315614700317383
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3009429
	speed: 0.2240s/iter; left time: 10272.7452s
	iters: 200, epoch: 3 | loss: 2.2978654
	speed: 0.0539s/iter; left time: 2465.7443s
	iters: 300, epoch: 3 | loss: 2.3095922
	speed: 0.0606s/iter; left time: 2767.3172s
	iters: 400, epoch: 3 | loss: 2.2918568
	speed: 0.0533s/iter; left time: 2429.9445s
Epoch: 3 cost time: 27.15253210067749
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3069673
	speed: 0.2188s/iter; left time: 9933.7323s
	iters: 200, epoch: 4 | loss: 2.2954645
	speed: 0.0519s/iter; left time: 2351.7861s
	iters: 300, epoch: 4 | loss: 2.3030283
	speed: 0.0568s/iter; left time: 2567.0411s
	iters: 400, epoch: 4 | loss: 2.2967846
	speed: 0.0510s/iter; left time: 2299.2053s
Epoch: 4 cost time: 25.812114238739014
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3033512
	speed: 0.2127s/iter; left time: 9554.8404s
	iters: 200, epoch: 5 | loss: 2.3006260
	speed: 0.0531s/iter; left time: 2378.7984s
	iters: 300, epoch: 5 | loss: 2.2862782
	speed: 0.0556s/iter; left time: 2487.2116s
	iters: 400, epoch: 5 | loss: 2.2887800
	speed: 0.0532s/iter; left time: 2374.5044s
Epoch: 5 cost time: 26.279715538024902
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3098452
	speed: 0.2152s/iter; left time: 9567.3353s
	iters: 200, epoch: 6 | loss: 2.3027296
	speed: 0.0533s/iter; left time: 2364.4012s
	iters: 300, epoch: 6 | loss: 2.3078012
	speed: 0.0501s/iter; left time: 2217.8220s
	iters: 400, epoch: 6 | loss: 2.3004615
	speed: 0.0530s/iter; left time: 2341.0761s
Epoch: 6 cost time: 25.46010446548462
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2868967
	speed: 0.1748s/iter; left time: 7687.6132s
	iters: 200, epoch: 7 | loss: 2.2970741
	speed: 0.0481s/iter; left time: 2111.2151s
	iters: 300, epoch: 7 | loss: 2.2944419
	speed: 0.0536s/iter; left time: 2347.5205s
	iters: 400, epoch: 7 | loss: 2.3114583
	speed: 0.0484s/iter; left time: 2112.2819s
Epoch: 7 cost time: 23.698400259017944
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2919776
	speed: 0.1805s/iter; left time: 7854.7643s
	iters: 200, epoch: 8 | loss: 2.3069248
	speed: 0.0527s/iter; left time: 2289.0310s
	iters: 300, epoch: 8 | loss: 2.3065584
	speed: 0.0523s/iter; left time: 2267.6193s
	iters: 400, epoch: 8 | loss: 2.2969115
	speed: 0.0558s/iter; left time: 2410.6959s
Epoch: 8 cost time: 25.656527042388916
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2940795
	speed: 0.2223s/iter; left time: 9567.8844s
	iters: 200, epoch: 9 | loss: 2.3020351
	speed: 0.0594s/iter; left time: 2549.7258s
	iters: 300, epoch: 9 | loss: 2.2925296
	speed: 0.0551s/iter; left time: 2362.7096s
	iters: 400, epoch: 9 | loss: 2.2812138
	speed: 0.0586s/iter; left time: 2503.2106s
Epoch: 9 cost time: 27.387572526931763
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3063254
	speed: 0.2144s/iter; left time: 9129.0198s
	iters: 200, epoch: 10 | loss: 2.2876337
	speed: 0.0566s/iter; left time: 2403.1031s
	iters: 300, epoch: 10 | loss: 2.2839956
	speed: 0.0535s/iter; left time: 2266.4684s
	iters: 400, epoch: 10 | loss: 2.2873621
	speed: 0.0512s/iter; left time: 2166.7379s
Epoch: 10 cost time: 26.036778450012207
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3101969
	speed: 0.2046s/iter; left time: 8617.6308s
	iters: 200, epoch: 11 | loss: 2.3009062
	speed: 0.0564s/iter; left time: 2368.6957s
	iters: 300, epoch: 11 | loss: 2.3023434
	speed: 0.0544s/iter; left time: 2281.6292s
	iters: 400, epoch: 11 | loss: 2.2951884
	speed: 0.0567s/iter; left time: 2372.5018s
Epoch: 11 cost time: 26.018540859222412
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.2926810
	speed: 0.2067s/iter; left time: 8605.9375s
	iters: 200, epoch: 12 | loss: 2.3049600
	speed: 0.0556s/iter; left time: 2311.2360s
	iters: 300, epoch: 12 | loss: 2.2916152
	speed: 0.0556s/iter; left time: 2305.3500s
	iters: 400, epoch: 12 | loss: 2.2830763
	speed: 0.0549s/iter; left time: 2268.1706s
Epoch: 12 cost time: 26.540348768234253
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.3062890
	speed: 0.2111s/iter; left time: 8691.9051s
	iters: 200, epoch: 13 | loss: 2.2951214
	speed: 0.0565s/iter; left time: 2321.8472s
	iters: 300, epoch: 13 | loss: 2.2990544
	speed: 0.0560s/iter; left time: 2292.5164s
	iters: 400, epoch: 13 | loss: 2.2944241
	speed: 0.0522s/iter; left time: 2135.0964s
Epoch: 13 cost time: 25.733529567718506
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3143551
	speed: 0.1880s/iter; left time: 7652.5627s
	iters: 200, epoch: 14 | loss: 2.3026092
	speed: 0.0511s/iter; left time: 2074.7983s
	iters: 300, epoch: 14 | loss: 2.3137858
	speed: 0.0507s/iter; left time: 2052.6468s
	iters: 400, epoch: 14 | loss: 2.2922044
	speed: 0.0490s/iter; left time: 1981.7668s
Epoch: 14 cost time: 24.383006811141968
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3114955
	speed: 0.1764s/iter; left time: 7098.1313s
	iters: 200, epoch: 15 | loss: 2.2977154
	speed: 0.0485s/iter; left time: 1945.3015s
	iters: 300, epoch: 15 | loss: 2.3064914
	speed: 0.0505s/iter; left time: 2023.3334s
	iters: 400, epoch: 15 | loss: 2.3125026
	speed: 0.0488s/iter; left time: 1947.6543s
Epoch: 15 cost time: 23.203006505966187
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3044560
	speed: 0.1654s/iter; left time: 6578.1816s
	iters: 200, epoch: 16 | loss: 2.2998288
	speed: 0.0484s/iter; left time: 1920.2019s
	iters: 300, epoch: 16 | loss: 2.2847495
	speed: 0.0477s/iter; left time: 1885.3365s
	iters: 400, epoch: 16 | loss: 2.3315060
	speed: 0.0511s/iter; left time: 2016.2911s
Epoch: 16 cost time: 24.228001356124878
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.3031785
	speed: 0.2194s/iter; left time: 8620.2285s
	iters: 200, epoch: 17 | loss: 2.3070436
	speed: 0.0572s/iter; left time: 2240.1777s
	iters: 300, epoch: 17 | loss: 2.3158810
	speed: 0.0567s/iter; left time: 2218.6465s
	iters: 400, epoch: 17 | loss: 2.2948349
	speed: 0.0579s/iter; left time: 2259.2204s
Epoch: 17 cost time: 27.139599800109863
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.3094618
	speed: 0.2179s/iter; left time: 8461.0785s
	iters: 200, epoch: 18 | loss: 2.2839873
	speed: 0.0568s/iter; left time: 2199.9029s
	iters: 300, epoch: 18 | loss: 2.3030813
	speed: 0.0562s/iter; left time: 2171.7480s
	iters: 400, epoch: 18 | loss: 2.2905650
	speed: 0.0566s/iter; left time: 2181.1811s
Epoch: 18 cost time: 26.642666816711426
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.2889094
	speed: 0.2143s/iter; left time: 8218.4359s
	iters: 200, epoch: 19 | loss: 2.3177662
	speed: 0.0563s/iter; left time: 2155.0765s
	iters: 300, epoch: 19 | loss: 2.3250294
	speed: 0.0517s/iter; left time: 1974.1401s
	iters: 400, epoch: 19 | loss: 2.3119781
	speed: 0.0522s/iter; left time: 1984.9974s
Epoch: 19 cost time: 25.449915170669556
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.3158035
	speed: 0.1908s/iter; left time: 7227.9040s
	iters: 200, epoch: 20 | loss: 2.2979045
	speed: 0.0519s/iter; left time: 1960.7864s
	iters: 300, epoch: 20 | loss: 2.2957969
	speed: 0.0511s/iter; left time: 1924.2338s
	iters: 400, epoch: 20 | loss: 2.3102901
	speed: 0.0530s/iter; left time: 1992.5229s
Epoch: 20 cost time: 25.154540538787842
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.3086188
	speed: 0.2213s/iter; left time: 8281.3686s
	iters: 200, epoch: 21 | loss: 2.3063955
	speed: 0.0562s/iter; left time: 2097.3200s
	iters: 300, epoch: 21 | loss: 2.3101223
	speed: 0.0542s/iter; left time: 2017.3759s
	iters: 400, epoch: 21 | loss: 2.2850595
	speed: 0.0552s/iter; left time: 2047.6459s
Epoch: 21 cost time: 26.334065675735474
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.2783244
	speed: 0.2070s/iter; left time: 7649.0407s
	iters: 200, epoch: 22 | loss: 2.3054266
	speed: 0.0555s/iter; left time: 2043.4472s
	iters: 300, epoch: 22 | loss: 2.2835951
	speed: 0.0510s/iter; left time: 1874.6315s
	iters: 400, epoch: 22 | loss: 2.3046510
	speed: 0.0528s/iter; left time: 1936.9592s
Epoch: 22 cost time: 25.80272126197815
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 2.3082263
	speed: 0.2047s/iter; left time: 7469.2393s
	iters: 200, epoch: 23 | loss: 2.3039939
	speed: 0.0555s/iter; left time: 2019.7617s
	iters: 300, epoch: 23 | loss: 2.2948892
	speed: 0.0571s/iter; left time: 2070.3112s
	iters: 400, epoch: 23 | loss: 2.2892823
	speed: 0.0520s/iter; left time: 1880.4162s
Epoch: 23 cost time: 26.25729537010193
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.3001883
	speed: 0.2024s/iter; left time: 7287.6949s
	iters: 200, epoch: 24 | loss: 2.2960839
	speed: 0.0553s/iter; left time: 1985.8400s
	iters: 300, epoch: 24 | loss: 2.3000014
	speed: 0.0540s/iter; left time: 1932.6843s
	iters: 400, epoch: 24 | loss: 2.3273146
	speed: 0.0552s/iter; left time: 1971.0027s
Epoch: 24 cost time: 25.582728624343872
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.2915909
	speed: 0.2098s/iter; left time: 7457.6666s
	iters: 200, epoch: 25 | loss: 2.3115895
	speed: 0.0565s/iter; left time: 2003.6802s
	iters: 300, epoch: 25 | loss: 2.2868924
	speed: 0.0526s/iter; left time: 1858.7798s
	iters: 400, epoch: 25 | loss: 2.3109760
	speed: 0.0530s/iter; left time: 1868.9836s
Epoch: 25 cost time: 25.861138820648193
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 2.2921321
	speed: 0.1997s/iter; left time: 7005.6347s
	iters: 200, epoch: 26 | loss: 2.2994089
	speed: 0.0532s/iter; left time: 1860.2690s
	iters: 300, epoch: 26 | loss: 2.3137825
	speed: 0.0582s/iter; left time: 2031.2603s
	iters: 400, epoch: 26 | loss: 2.3283947
	speed: 0.0520s/iter; left time: 1809.4247s
Epoch: 26 cost time: 25.634068727493286
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 2.3118386
	speed: 0.1920s/iter; left time: 6646.2025s
	iters: 200, epoch: 27 | loss: 2.3037539
	speed: 0.0506s/iter; left time: 1747.1610s
	iters: 300, epoch: 27 | loss: 2.3072600
	speed: 0.0493s/iter; left time: 1695.9446s
	iters: 400, epoch: 27 | loss: 2.3067212
	speed: 0.0499s/iter; left time: 1712.0529s
Epoch: 27 cost time: 24.076606512069702
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 2.3099926
	speed: 0.1760s/iter; left time: 6008.0310s
	iters: 200, epoch: 28 | loss: 2.3243015
	speed: 0.0573s/iter; left time: 1949.0783s
	iters: 300, epoch: 28 | loss: 2.3055084
	speed: 0.0541s/iter; left time: 1837.4950s
	iters: 400, epoch: 28 | loss: 2.2890067
	speed: 0.0578s/iter; left time: 1956.2344s
Epoch: 28 cost time: 26.341371297836304
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 2.3061681
	speed: 0.2152s/iter; left time: 7246.4240s
	iters: 200, epoch: 29 | loss: 2.2920859
	speed: 0.0569s/iter; left time: 1909.4065s
	iters: 300, epoch: 29 | loss: 2.3069315
	speed: 0.0540s/iter; left time: 1807.3307s
	iters: 400, epoch: 29 | loss: 2.2986455
	speed: 0.0564s/iter; left time: 1882.0940s
Epoch: 29 cost time: 26.424569606781006
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 2.2939529
	speed: 0.2119s/iter; left time: 7034.1329s
	iters: 200, epoch: 30 | loss: 2.3122897
	speed: 0.0551s/iter; left time: 1823.7398s
	iters: 300, epoch: 30 | loss: 2.2923172
	speed: 0.0545s/iter; left time: 1797.1737s
	iters: 400, epoch: 30 | loss: 2.3021293
	speed: 0.0588s/iter; left time: 1935.5325s
Epoch: 30 cost time: 27.00090193748474
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 2.3082910
	speed: 0.2140s/iter; left time: 7003.2923s
	iters: 200, epoch: 31 | loss: 2.2908070
	speed: 0.0520s/iter; left time: 1697.7125s
	iters: 300, epoch: 31 | loss: 2.3001468
	speed: 0.0570s/iter; left time: 1853.3515s
	iters: 400, epoch: 31 | loss: 2.3113942
	speed: 0.0544s/iter; left time: 1764.7564s
Epoch: 31 cost time: 26.40578269958496
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 2.3235552
	speed: 0.2086s/iter; left time: 6729.6283s
	iters: 200, epoch: 32 | loss: 2.3006580
	speed: 0.0569s/iter; left time: 1829.7997s
	iters: 300, epoch: 32 | loss: 2.3090177
	speed: 0.0553s/iter; left time: 1774.4502s
	iters: 400, epoch: 32 | loss: 2.3133509
	speed: 0.0540s/iter; left time: 1726.6858s
Epoch: 32 cost time: 26.157994031906128
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 2.3220077
	speed: 0.1904s/iter; left time: 6053.8412s
	iters: 200, epoch: 33 | loss: 2.3118513
	speed: 0.0546s/iter; left time: 1731.5721s
	iters: 300, epoch: 33 | loss: 2.3149467
	speed: 0.0525s/iter; left time: 1659.9558s
	iters: 400, epoch: 33 | loss: 2.3027279
	speed: 0.0524s/iter; left time: 1649.8783s
Epoch: 33 cost time: 25.27100372314453
Epoch: 33, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 219370
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7986228
	speed: 0.0707s/iter; left time: 3307.3569s
	iters: 200, epoch: 1 | loss: 1.2842468
	speed: 0.0572s/iter; left time: 2672.9281s
	iters: 300, epoch: 1 | loss: 0.6130367
	speed: 0.0551s/iter; left time: 2567.9729s
	iters: 400, epoch: 1 | loss: 0.5084159
	speed: 0.0548s/iter; left time: 2549.2687s
Epoch: 1 cost time: 27.694159507751465
Epoch: 1, Steps: 469 | Train Loss: 1.109 Vali Loss: 0.412 Vali Acc: 0.888 Test Loss: 0.412 Test Acc: 0.888
Validation loss decreased (inf --> -0.888218).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3124685
	speed: 0.2063s/iter; left time: 9556.9371s
	iters: 200, epoch: 2 | loss: 0.3785037
	speed: 0.0577s/iter; left time: 2666.5337s
	iters: 300, epoch: 2 | loss: 0.0821031
	speed: 0.0554s/iter; left time: 2557.0167s
	iters: 400, epoch: 2 | loss: 0.0333255
	speed: 0.0550s/iter; left time: 2532.4143s
Epoch: 2 cost time: 26.234438180923462
Epoch: 2, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.888218 --> -0.959404).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0842594
	speed: 0.2066s/iter; left time: 9473.7896s
	iters: 200, epoch: 3 | loss: 0.1218237
	speed: 0.0605s/iter; left time: 2768.2468s
	iters: 300, epoch: 3 | loss: 0.0770946
	speed: 0.0565s/iter; left time: 2582.0178s
	iters: 400, epoch: 3 | loss: 0.0511750
	speed: 0.0567s/iter; left time: 2585.5778s
Epoch: 3 cost time: 26.852620363235474
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.959404 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0222819
	speed: 0.2138s/iter; left time: 9703.2859s
	iters: 200, epoch: 4 | loss: 0.0384319
	speed: 0.0589s/iter; left time: 2669.9688s
	iters: 300, epoch: 4 | loss: 0.0563630
	speed: 0.0577s/iter; left time: 2607.8437s
	iters: 400, epoch: 4 | loss: 0.4744198
	speed: 0.0554s/iter; left time: 2497.9453s
Epoch: 4 cost time: 27.350374221801758
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.962263 --> -0.974842).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0275352
	speed: 0.2026s/iter; left time: 9101.0825s
	iters: 200, epoch: 5 | loss: 0.0687022
	speed: 0.0515s/iter; left time: 2310.5196s
	iters: 300, epoch: 5 | loss: 0.0077256
	speed: 0.0558s/iter; left time: 2497.7703s
	iters: 400, epoch: 5 | loss: 0.0079838
	speed: 0.0576s/iter; left time: 2571.9755s
Epoch: 5 cost time: 26.22492289543152
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0649553
	speed: 0.1876s/iter; left time: 8341.0086s
	iters: 200, epoch: 6 | loss: 0.0169271
	speed: 0.0533s/iter; left time: 2362.3557s
	iters: 300, epoch: 6 | loss: 0.0024188
	speed: 0.0493s/iter; left time: 2181.5936s
	iters: 400, epoch: 6 | loss: 0.2113885
	speed: 0.0502s/iter; left time: 2216.7234s
Epoch: 6 cost time: 24.26433777809143
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975414).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0017583
	speed: 0.1795s/iter; left time: 7896.6663s
	iters: 200, epoch: 7 | loss: 0.0728104
	speed: 0.0521s/iter; left time: 2284.4439s
	iters: 300, epoch: 7 | loss: 0.0402684
	speed: 0.0538s/iter; left time: 2357.5229s
	iters: 400, epoch: 7 | loss: 0.0627404
	speed: 0.0528s/iter; left time: 2306.6206s
Epoch: 7 cost time: 25.43601107597351
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0075307
	speed: 0.2443s/iter; left time: 10633.4676s
	iters: 200, epoch: 8 | loss: 0.0080975
	speed: 0.0580s/iter; left time: 2519.2168s
	iters: 300, epoch: 8 | loss: 0.4355625
	speed: 0.0617s/iter; left time: 2673.2027s
	iters: 400, epoch: 8 | loss: 0.0304440
	speed: 0.0616s/iter; left time: 2660.8895s
Epoch: 8 cost time: 28.557971954345703
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0736370
	speed: 0.2510s/iter; left time: 10803.3724s
	iters: 200, epoch: 9 | loss: 0.0064719
	speed: 0.0588s/iter; left time: 2523.9629s
	iters: 300, epoch: 9 | loss: 0.0093573
	speed: 0.0584s/iter; left time: 2501.9111s
	iters: 400, epoch: 9 | loss: 0.2447519
	speed: 0.0610s/iter; left time: 2607.0123s
Epoch: 9 cost time: 28.85920262336731
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0468892
	speed: 0.2342s/iter; left time: 9971.1027s
	iters: 200, epoch: 10 | loss: 0.0012593
	speed: 0.0610s/iter; left time: 2590.2273s
	iters: 300, epoch: 10 | loss: 0.0267674
	speed: 0.0612s/iter; left time: 2595.3358s
	iters: 400, epoch: 10 | loss: 0.0493088
	speed: 0.0574s/iter; left time: 2425.6540s
Epoch: 10 cost time: 28.029186487197876
Epoch: 10, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0261290
	speed: 0.2512s/iter; left time: 10576.6558s
	iters: 200, epoch: 11 | loss: 0.0156813
	speed: 0.0582s/iter; left time: 2446.7610s
	iters: 300, epoch: 11 | loss: 0.0152447
	speed: 0.0612s/iter; left time: 2564.8113s
	iters: 400, epoch: 11 | loss: 0.0113228
	speed: 0.0626s/iter; left time: 2617.0961s
Epoch: 11 cost time: 28.716558694839478
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0047898
	speed: 0.2488s/iter; left time: 10362.1254s
	iters: 200, epoch: 12 | loss: 0.0015465
	speed: 0.0618s/iter; left time: 2565.9541s
	iters: 300, epoch: 12 | loss: 0.1137856
	speed: 0.0609s/iter; left time: 2523.1832s
	iters: 400, epoch: 12 | loss: 0.0003663
	speed: 0.0640s/iter; left time: 2647.4407s
Epoch: 12 cost time: 29.76935052871704
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0022908
	speed: 0.2461s/iter; left time: 10131.6849s
	iters: 200, epoch: 13 | loss: 0.0187119
	speed: 0.0612s/iter; left time: 2515.7185s
	iters: 300, epoch: 13 | loss: 0.0154544
	speed: 0.0614s/iter; left time: 2514.9445s
	iters: 400, epoch: 13 | loss: 0.0555240
	speed: 0.0572s/iter; left time: 2336.8450s
Epoch: 13 cost time: 28.376495122909546
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0103957
	speed: 0.2504s/iter; left time: 10193.3067s
	iters: 200, epoch: 14 | loss: 0.0107105
	speed: 0.0592s/iter; left time: 2402.0619s
	iters: 300, epoch: 14 | loss: 0.0085377
	speed: 0.0632s/iter; left time: 2557.9470s
	iters: 400, epoch: 14 | loss: 0.0374587
	speed: 0.0629s/iter; left time: 2540.0398s
Epoch: 14 cost time: 29.281033277511597
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1605074
	speed: 0.2387s/iter; left time: 9603.1911s
	iters: 200, epoch: 15 | loss: 0.0013433
	speed: 0.0586s/iter; left time: 2353.9016s
	iters: 300, epoch: 15 | loss: 0.0007512
	speed: 0.0540s/iter; left time: 2162.5594s
	iters: 400, epoch: 15 | loss: 0.2662988
	speed: 0.0613s/iter; left time: 2447.4367s
Epoch: 15 cost time: 27.82813000679016
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.975414 --> -0.979130).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0498150
	speed: 0.2360s/iter; left time: 9383.5889s
	iters: 200, epoch: 16 | loss: 0.0004706
	speed: 0.0523s/iter; left time: 2075.3790s
	iters: 300, epoch: 16 | loss: 0.0008045
	speed: 0.0505s/iter; left time: 1996.2875s
	iters: 400, epoch: 16 | loss: 0.1127905
	speed: 0.0503s/iter; left time: 1983.7417s
Epoch: 16 cost time: 24.829407930374146
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0006989
	speed: 0.1817s/iter; left time: 7138.5986s
	iters: 200, epoch: 17 | loss: 0.0026417
	speed: 0.0488s/iter; left time: 1911.4588s
	iters: 300, epoch: 17 | loss: 0.0004408
	speed: 0.0499s/iter; left time: 1952.0634s
	iters: 400, epoch: 17 | loss: 0.0014185
	speed: 0.0566s/iter; left time: 2206.5074s
Epoch: 17 cost time: 25.201074600219727
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0045357
	speed: 0.2295s/iter; left time: 8910.8341s
	iters: 200, epoch: 18 | loss: 0.0182817
	speed: 0.0596s/iter; left time: 2309.7147s
	iters: 300, epoch: 18 | loss: 0.0074914
	speed: 0.0590s/iter; left time: 2280.5604s
	iters: 400, epoch: 18 | loss: 0.0002113
	speed: 0.0603s/iter; left time: 2324.8881s
Epoch: 18 cost time: 28.301536798477173
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.980274).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0047859
	speed: 0.2455s/iter; left time: 9417.8886s
	iters: 200, epoch: 19 | loss: 0.0942873
	speed: 0.0630s/iter; left time: 2410.8793s
	iters: 300, epoch: 19 | loss: 0.0005691
	speed: 0.0607s/iter; left time: 2318.1500s
	iters: 400, epoch: 19 | loss: 0.0025891
	speed: 0.0609s/iter; left time: 2317.4668s
Epoch: 19 cost time: 29.659449100494385
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0107874
	speed: 0.2587s/iter; left time: 9802.7837s
	iters: 200, epoch: 20 | loss: 0.0004507
	speed: 0.0628s/iter; left time: 2371.7390s
	iters: 300, epoch: 20 | loss: 0.0006677
	speed: 0.0606s/iter; left time: 2284.7440s
	iters: 400, epoch: 20 | loss: 0.0005156
	speed: 0.0613s/iter; left time: 2304.3456s
Epoch: 20 cost time: 29.383147478103638
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2027866
	speed: 0.2499s/iter; left time: 9351.9369s
	iters: 200, epoch: 21 | loss: 0.1569999
	speed: 0.0620s/iter; left time: 2312.2134s
	iters: 300, epoch: 21 | loss: 0.0026797
	speed: 0.0633s/iter; left time: 2355.7261s
	iters: 400, epoch: 21 | loss: 0.0003183
	speed: 0.0611s/iter; left time: 2268.8041s
Epoch: 21 cost time: 29.640851974487305
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0066423
	speed: 0.2487s/iter; left time: 9191.7131s
	iters: 200, epoch: 22 | loss: 0.0003599
	speed: 0.0609s/iter; left time: 2243.5382s
	iters: 300, epoch: 22 | loss: 0.0156966
	speed: 0.0565s/iter; left time: 2077.7315s
	iters: 400, epoch: 22 | loss: 0.1231505
	speed: 0.0599s/iter; left time: 2194.6905s
Epoch: 22 cost time: 28.700584173202515
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0010671
	speed: 0.2373s/iter; left time: 8658.5580s
	iters: 200, epoch: 23 | loss: 0.0080587
	speed: 0.0548s/iter; left time: 1993.7005s
	iters: 300, epoch: 23 | loss: 0.0013395
	speed: 0.0528s/iter; left time: 1917.4764s
	iters: 400, epoch: 23 | loss: 0.1102179
	speed: 0.0540s/iter; left time: 1952.7290s
Epoch: 23 cost time: 25.828556537628174
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0554048
	speed: 0.1793s/iter; left time: 6456.5996s
	iters: 200, epoch: 24 | loss: 0.3587496
	speed: 0.0569s/iter; left time: 2042.9278s
	iters: 300, epoch: 24 | loss: 0.0053001
	speed: 0.0623s/iter; left time: 2231.8045s
	iters: 400, epoch: 24 | loss: 0.0005700
	speed: 0.0582s/iter; left time: 2080.3023s
Epoch: 24 cost time: 27.418535232543945
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002506
	speed: 0.2366s/iter; left time: 8411.3473s
	iters: 200, epoch: 25 | loss: 0.0020756
	speed: 0.0613s/iter; left time: 2173.6978s
	iters: 300, epoch: 25 | loss: 0.0006603
	speed: 0.0581s/iter; left time: 2055.0272s
	iters: 400, epoch: 25 | loss: 0.0003048
	speed: 0.0573s/iter; left time: 2020.7172s
Epoch: 25 cost time: 28.1063551902771
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0089202
	speed: 0.2292s/iter; left time: 8040.4840s
	iters: 200, epoch: 26 | loss: 0.0003202
	speed: 0.0587s/iter; left time: 2054.4849s
	iters: 300, epoch: 26 | loss: 0.0023255
	speed: 0.0578s/iter; left time: 2014.2656s
	iters: 400, epoch: 26 | loss: 0.0032012
	speed: 0.0584s/iter; left time: 2031.1874s
Epoch: 26 cost time: 27.728634357452393
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0006948
	speed: 0.2292s/iter; left time: 7931.5828s
	iters: 200, epoch: 27 | loss: 0.0025871
	speed: 0.0603s/iter; left time: 2081.1440s
	iters: 300, epoch: 27 | loss: 0.0031483
	speed: 0.0564s/iter; left time: 1941.1985s
	iters: 400, epoch: 27 | loss: 0.0154569
	speed: 0.0584s/iter; left time: 2002.3276s
Epoch: 27 cost time: 28.058940649032593
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0492455
	speed: 0.2262s/iter; left time: 7723.4174s
	iters: 200, epoch: 28 | loss: 0.1621605
	speed: 0.0606s/iter; left time: 2062.5407s
	iters: 300, epoch: 28 | loss: 0.0029220
	speed: 0.0547s/iter; left time: 1856.2575s
	iters: 400, epoch: 28 | loss: 0.0162407
	speed: 0.0618s/iter; left time: 2090.2852s
Epoch: 28 cost time: 28.447728872299194
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 121066
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9769363
	speed: 0.0792s/iter; left time: 3706.4118s
	iters: 200, epoch: 1 | loss: 1.3545232
	speed: 0.0575s/iter; left time: 2683.0476s
	iters: 300, epoch: 1 | loss: 0.7606207
	speed: 0.0603s/iter; left time: 2808.7349s
	iters: 400, epoch: 1 | loss: 0.5234134
	speed: 0.0597s/iter; left time: 2774.9881s
Epoch: 1 cost time: 29.626451015472412
Epoch: 1, Steps: 469 | Train Loss: 1.240 Vali Loss: 0.506 Vali Acc: 0.837 Test Loss: 0.506 Test Acc: 0.837
Validation loss decreased (inf --> -0.837045).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4300127
	speed: 0.2315s/iter; left time: 10727.7415s
	iters: 200, epoch: 2 | loss: 0.6427206
	speed: 0.0563s/iter; left time: 2603.7263s
	iters: 300, epoch: 2 | loss: 0.1282450
	speed: 0.0602s/iter; left time: 2775.1909s
	iters: 400, epoch: 2 | loss: 0.1085226
	speed: 0.0563s/iter; left time: 2593.8828s
Epoch: 2 cost time: 27.44534397125244
Epoch: 2, Steps: 469 | Train Loss: 0.313 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
Validation loss decreased (-0.837045 --> -0.925384).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0715310
	speed: 0.2273s/iter; left time: 10423.6454s
	iters: 200, epoch: 3 | loss: 0.2049823
	speed: 0.0552s/iter; left time: 2526.2862s
	iters: 300, epoch: 3 | loss: 0.0913249
	speed: 0.0585s/iter; left time: 2672.5812s
	iters: 400, epoch: 3 | loss: 0.1128572
	speed: 0.0575s/iter; left time: 2618.2265s
Epoch: 3 cost time: 26.617395401000977
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
Validation loss decreased (-0.925384 --> -0.954830).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0461621
	speed: 0.2250s/iter; left time: 10213.6095s
	iters: 200, epoch: 4 | loss: 0.1536558
	speed: 0.0540s/iter; left time: 2444.9910s
	iters: 300, epoch: 4 | loss: 0.0519475
	speed: 0.0579s/iter; left time: 2615.9572s
	iters: 400, epoch: 4 | loss: 0.6245732
	speed: 0.0594s/iter; left time: 2678.9462s
Epoch: 4 cost time: 26.750380754470825
Epoch: 4, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.954830 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0532986
	speed: 0.2352s/iter; left time: 10565.6491s
	iters: 200, epoch: 5 | loss: 0.0797912
	speed: 0.0579s/iter; left time: 2595.1833s
	iters: 300, epoch: 5 | loss: 0.0308275
	speed: 0.0600s/iter; left time: 2681.3134s
	iters: 400, epoch: 5 | loss: 0.0387833
	speed: 0.0602s/iter; left time: 2686.5094s
Epoch: 5 cost time: 27.394145965576172
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0259028
	speed: 0.2300s/iter; left time: 10226.5662s
	iters: 200, epoch: 6 | loss: 0.0218320
	speed: 0.0543s/iter; left time: 2408.9271s
	iters: 300, epoch: 6 | loss: 0.0217292
	speed: 0.0556s/iter; left time: 2458.6052s
	iters: 400, epoch: 6 | loss: 0.0930471
	speed: 0.0560s/iter; left time: 2471.2031s
Epoch: 6 cost time: 26.44596576690674
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.961977 --> -0.972841).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0025372
	speed: 0.2318s/iter; left time: 10197.5641s
	iters: 200, epoch: 7 | loss: 0.0134218
	speed: 0.0571s/iter; left time: 2506.8436s
	iters: 300, epoch: 7 | loss: 0.0252190
	speed: 0.0592s/iter; left time: 2593.8312s
	iters: 400, epoch: 7 | loss: 0.1097329
	speed: 0.0582s/iter; left time: 2541.1820s
Epoch: 7 cost time: 27.55214762687683
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.972841 --> -0.974556).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0080117
	speed: 0.2052s/iter; left time: 8927.7394s
	iters: 200, epoch: 8 | loss: 0.0790220
	speed: 0.0530s/iter; left time: 2301.5546s
	iters: 300, epoch: 8 | loss: 0.4195192
	speed: 0.0511s/iter; left time: 2214.1709s
	iters: 400, epoch: 8 | loss: 0.0093907
	speed: 0.0556s/iter; left time: 2404.2974s
Epoch: 8 cost time: 25.153318166732788
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0721642
	speed: 0.1865s/iter; left time: 8029.4203s
	iters: 200, epoch: 9 | loss: 0.0038775
	speed: 0.0537s/iter; left time: 2307.8872s
	iters: 300, epoch: 9 | loss: 0.0065935
	speed: 0.0587s/iter; left time: 2516.2274s
	iters: 400, epoch: 9 | loss: 0.1386101
	speed: 0.0619s/iter; left time: 2644.1767s
Epoch: 9 cost time: 27.060667514801025
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0293489
	speed: 0.2314s/iter; left time: 9853.6333s
	iters: 200, epoch: 10 | loss: 0.0034500
	speed: 0.0623s/iter; left time: 2645.1993s
	iters: 300, epoch: 10 | loss: 0.0945423
	speed: 0.0583s/iter; left time: 2472.3290s
	iters: 400, epoch: 10 | loss: 0.0114393
	speed: 0.0569s/iter; left time: 2404.8895s
Epoch: 10 cost time: 27.783118963241577
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0035279
	speed: 0.2218s/iter; left time: 9341.5376s
	iters: 200, epoch: 11 | loss: 0.0568844
	speed: 0.0547s/iter; left time: 2297.3726s
	iters: 300, epoch: 11 | loss: 0.0346232
	speed: 0.0569s/iter; left time: 2385.8875s
	iters: 400, epoch: 11 | loss: 0.0421378
	speed: 0.0536s/iter; left time: 2242.0538s
Epoch: 11 cost time: 26.553640127182007
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009461
	speed: 0.2253s/iter; left time: 9383.9569s
	iters: 200, epoch: 12 | loss: 0.0011653
	speed: 0.0546s/iter; left time: 2269.4848s
	iters: 300, epoch: 12 | loss: 0.0468708
	speed: 0.0569s/iter; left time: 2357.3766s
	iters: 400, epoch: 12 | loss: 0.0008388
	speed: 0.0612s/iter; left time: 2528.6633s
Epoch: 12 cost time: 27.102783203125
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0049434
	speed: 0.2334s/iter; left time: 9610.1894s
	iters: 200, epoch: 13 | loss: 0.2233874
	speed: 0.0585s/iter; left time: 2404.0125s
	iters: 300, epoch: 13 | loss: 0.0822896
	speed: 0.0570s/iter; left time: 2336.0381s
	iters: 400, epoch: 13 | loss: 0.0216918
	speed: 0.0586s/iter; left time: 2396.4227s
Epoch: 13 cost time: 27.430022716522217
Epoch: 13, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0143272
	speed: 0.2312s/iter; left time: 9411.6203s
	iters: 200, epoch: 14 | loss: 0.0323586
	speed: 0.0549s/iter; left time: 2228.5986s
	iters: 300, epoch: 14 | loss: 0.0075579
	speed: 0.0593s/iter; left time: 2400.0019s
	iters: 400, epoch: 14 | loss: 0.0051799
	speed: 0.0560s/iter; left time: 2264.0194s
Epoch: 14 cost time: 26.969844102859497
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2858581
	speed: 0.2331s/iter; left time: 9378.2436s
	iters: 200, epoch: 15 | loss: 0.0238747
	speed: 0.0573s/iter; left time: 2300.0026s
	iters: 300, epoch: 15 | loss: 0.0001857
	speed: 0.0590s/iter; left time: 2360.3616s
	iters: 400, epoch: 15 | loss: 0.1318627
	speed: 0.0577s/iter; left time: 2305.2706s
Epoch: 15 cost time: 27.51002836227417
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976843).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0217185
	speed: 0.2344s/iter; left time: 9322.9053s
	iters: 200, epoch: 16 | loss: 0.0077171
	speed: 0.0556s/iter; left time: 2207.3859s
	iters: 300, epoch: 16 | loss: 0.0492710
	speed: 0.0534s/iter; left time: 2113.7456s
	iters: 400, epoch: 16 | loss: 0.0037217
	speed: 0.0534s/iter; left time: 2108.9337s
Epoch: 16 cost time: 25.822378396987915
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.980845).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0027038
	speed: 0.1886s/iter; left time: 7409.9854s
	iters: 200, epoch: 17 | loss: 0.0035709
	speed: 0.0502s/iter; left time: 1966.2419s
	iters: 300, epoch: 17 | loss: 0.0006359
	speed: 0.0524s/iter; left time: 2049.6254s
	iters: 400, epoch: 17 | loss: 0.0082921
	speed: 0.0581s/iter; left time: 2267.2224s
Epoch: 17 cost time: 25.45054316520691
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3055808
	speed: 0.2258s/iter; left time: 8765.9344s
	iters: 200, epoch: 18 | loss: 0.0020762
	speed: 0.0562s/iter; left time: 2176.8823s
	iters: 300, epoch: 18 | loss: 0.0255663
	speed: 0.0542s/iter; left time: 2092.8568s
	iters: 400, epoch: 18 | loss: 0.0003672
	speed: 0.0556s/iter; left time: 2140.3364s
Epoch: 18 cost time: 26.49315047264099
Epoch: 18, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0047138
	speed: 0.2193s/iter; left time: 8414.0404s
	iters: 200, epoch: 19 | loss: 0.0024329
	speed: 0.0528s/iter; left time: 2021.0040s
	iters: 300, epoch: 19 | loss: 0.0004948
	speed: 0.0580s/iter; left time: 2211.4427s
	iters: 400, epoch: 19 | loss: 0.0450323
	speed: 0.0526s/iter; left time: 2001.7753s
Epoch: 19 cost time: 26.385936498641968
Epoch: 19, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0117244
	speed: 0.2205s/iter; left time: 8355.7619s
	iters: 200, epoch: 20 | loss: 0.0263286
	speed: 0.0573s/iter; left time: 2165.1697s
	iters: 300, epoch: 20 | loss: 0.0005975
	speed: 0.0590s/iter; left time: 2224.0006s
	iters: 400, epoch: 20 | loss: 0.0023375
	speed: 0.0553s/iter; left time: 2077.2555s
Epoch: 20 cost time: 27.423662900924683
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0070836
	speed: 0.2231s/iter; left time: 8348.3055s
	iters: 200, epoch: 21 | loss: 0.0853675
	speed: 0.0603s/iter; left time: 2248.7468s
	iters: 300, epoch: 21 | loss: 0.0007531
	speed: 0.0528s/iter; left time: 1963.9895s
	iters: 400, epoch: 21 | loss: 0.0060147
	speed: 0.0590s/iter; left time: 2190.0119s
Epoch: 21 cost time: 27.005165815353394
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0046875
	speed: 0.2304s/iter; left time: 8513.0312s
	iters: 200, epoch: 22 | loss: 0.0033726
	speed: 0.0537s/iter; left time: 1979.1180s
	iters: 300, epoch: 22 | loss: 0.0292970
	speed: 0.0514s/iter; left time: 1889.9403s
	iters: 400, epoch: 22 | loss: 0.0199276
	speed: 0.0518s/iter; left time: 1898.5377s
Epoch: 22 cost time: 25.686768770217896
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.982275).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0021553
	speed: 0.1995s/iter; left time: 7279.8894s
	iters: 200, epoch: 23 | loss: 0.1795920
	speed: 0.0604s/iter; left time: 2197.5373s
	iters: 300, epoch: 23 | loss: 0.0019008
	speed: 0.0578s/iter; left time: 2098.8966s
	iters: 400, epoch: 23 | loss: 0.0064780
	speed: 0.0575s/iter; left time: 2081.3994s
Epoch: 23 cost time: 27.99807572364807
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0002379
	speed: 0.2315s/iter; left time: 8335.7754s
	iters: 200, epoch: 24 | loss: 0.0089221
	speed: 0.0607s/iter; left time: 2179.0168s
	iters: 300, epoch: 24 | loss: 0.1446908
	speed: 0.0596s/iter; left time: 2135.8905s
	iters: 400, epoch: 24 | loss: 0.0117187
	speed: 0.0566s/iter; left time: 2022.0315s
Epoch: 24 cost time: 27.84656071662903
Epoch: 24, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0195112
	speed: 0.2239s/iter; left time: 7959.9935s
	iters: 200, epoch: 25 | loss: 0.0006583
	speed: 0.0568s/iter; left time: 2012.1147s
	iters: 300, epoch: 25 | loss: 0.0006584
	speed: 0.0569s/iter; left time: 2012.2201s
	iters: 400, epoch: 25 | loss: 0.0005593
	speed: 0.0580s/iter; left time: 2044.9089s
Epoch: 25 cost time: 27.51849889755249
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0086212
	speed: 0.2360s/iter; left time: 8277.7831s
	iters: 200, epoch: 26 | loss: 0.0013747
	speed: 0.0633s/iter; left time: 2215.5183s
	iters: 300, epoch: 26 | loss: 0.0011272
	speed: 0.0589s/iter; left time: 2054.8083s
	iters: 400, epoch: 26 | loss: 0.0019275
	speed: 0.0617s/iter; left time: 2146.4540s
Epoch: 26 cost time: 29.07407855987549
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1055333
	speed: 0.2384s/iter; left time: 8249.0070s
	iters: 200, epoch: 27 | loss: 0.0065273
	speed: 0.0596s/iter; left time: 2055.5815s
	iters: 300, epoch: 27 | loss: 0.0025010
	speed: 0.0585s/iter; left time: 2011.1369s
	iters: 400, epoch: 27 | loss: 0.0036169
	speed: 0.0567s/iter; left time: 1943.4994s
Epoch: 27 cost time: 27.49058437347412
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0026364
	speed: 0.2138s/iter; left time: 7297.8113s
	iters: 200, epoch: 28 | loss: 0.6653438
	speed: 0.0518s/iter; left time: 1763.3831s
	iters: 300, epoch: 28 | loss: 0.0377331
	speed: 0.0507s/iter; left time: 1720.6406s
	iters: 400, epoch: 28 | loss: 0.0184960
	speed: 0.0526s/iter; left time: 1778.6511s
Epoch: 28 cost time: 25.159727334976196
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0201078
	speed: 0.1818s/iter; left time: 6120.4494s
	iters: 200, epoch: 29 | loss: 0.3019781
	speed: 0.0569s/iter; left time: 1911.1781s
	iters: 300, epoch: 29 | loss: 0.1007680
	speed: 0.0566s/iter; left time: 1893.5604s
	iters: 400, epoch: 29 | loss: 0.0133346
	speed: 0.0566s/iter; left time: 1890.0145s
Epoch: 29 cost time: 26.74850583076477
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0042241
	speed: 0.2077s/iter; left time: 6896.2925s
	iters: 200, epoch: 30 | loss: 0.0003494
	speed: 0.0578s/iter; left time: 1913.4609s
	iters: 300, epoch: 30 | loss: 0.0113381
	speed: 0.0550s/iter; left time: 1815.3604s
	iters: 400, epoch: 30 | loss: 0.2669412
	speed: 0.0563s/iter; left time: 1850.6780s
Epoch: 30 cost time: 26.625245571136475
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0309747
	speed: 0.2092s/iter; left time: 6846.9274s
	iters: 200, epoch: 31 | loss: 0.0019752
	speed: 0.0535s/iter; left time: 1746.8182s
	iters: 300, epoch: 31 | loss: 0.0068400
	speed: 0.0541s/iter; left time: 1759.6576s
	iters: 400, epoch: 31 | loss: 0.0016358
	speed: 0.0552s/iter; left time: 1791.4460s
Epoch: 31 cost time: 25.83975839614868
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0001489
	speed: 0.2162s/iter; left time: 6973.4950s
	iters: 200, epoch: 32 | loss: 0.0231166
	speed: 0.0531s/iter; left time: 1706.2121s
	iters: 300, epoch: 32 | loss: 0.0366701
	speed: 0.0534s/iter; left time: 1711.8386s
	iters: 400, epoch: 32 | loss: 0.0034538
	speed: 0.0521s/iter; left time: 1666.7076s
Epoch: 32 cost time: 25.470069646835327
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 121066
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8886061
	speed: 0.0713s/iter; left time: 3336.4956s
	iters: 200, epoch: 1 | loss: 1.2989689
	speed: 0.0541s/iter; left time: 2527.4858s
	iters: 300, epoch: 1 | loss: 0.6123565
	speed: 0.0589s/iter; left time: 2742.7104s
	iters: 400, epoch: 1 | loss: 0.4528970
	speed: 0.0572s/iter; left time: 2659.1388s
Epoch: 1 cost time: 28.102720022201538
Epoch: 1, Steps: 469 | Train Loss: 1.170 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
Validation loss decreased (inf --> -0.876497).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2735655
	speed: 0.2141s/iter; left time: 9920.0053s
	iters: 200, epoch: 2 | loss: 0.3871595
	speed: 0.0536s/iter; left time: 2477.1526s
	iters: 300, epoch: 2 | loss: 0.0620246
	speed: 0.0573s/iter; left time: 2643.6797s
	iters: 400, epoch: 2 | loss: 0.0546886
	speed: 0.0532s/iter; left time: 2449.6743s
Epoch: 2 cost time: 26.099821090698242
Epoch: 2, Steps: 469 | Train Loss: 0.242 Vali Loss: 0.184 Vali Acc: 0.947 Test Loss: 0.184 Test Acc: 0.947
Validation loss decreased (-0.876497 --> -0.947111).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1157782
	speed: 0.2199s/iter; left time: 10085.5187s
	iters: 200, epoch: 3 | loss: 0.2885167
	speed: 0.0597s/iter; left time: 2729.8200s
	iters: 300, epoch: 3 | loss: 0.0989938
	speed: 0.0540s/iter; left time: 2464.0088s
	iters: 400, epoch: 3 | loss: 0.1072218
	speed: 0.0550s/iter; left time: 2507.5162s
Epoch: 3 cost time: 26.667283058166504
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.947111 --> -0.947968).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0346633
	speed: 0.2004s/iter; left time: 9096.5148s
	iters: 200, epoch: 4 | loss: 0.0316161
	speed: 0.0530s/iter; left time: 2400.9130s
	iters: 300, epoch: 4 | loss: 0.0754522
	speed: 0.0514s/iter; left time: 2324.3890s
	iters: 400, epoch: 4 | loss: 0.5026054
	speed: 0.0530s/iter; left time: 2388.6600s
Epoch: 4 cost time: 24.93612790107727
Epoch: 4, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.947968 --> -0.966837).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0395249
	speed: 0.1799s/iter; left time: 8080.9590s
	iters: 200, epoch: 5 | loss: 0.0589796
	speed: 0.0534s/iter; left time: 2394.0481s
	iters: 300, epoch: 5 | loss: 0.0831081
	speed: 0.0568s/iter; left time: 2542.1394s
	iters: 400, epoch: 5 | loss: 0.0333699
	speed: 0.0524s/iter; left time: 2338.5977s
Epoch: 5 cost time: 25.606800079345703
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0161588
	speed: 0.1945s/iter; left time: 8648.6116s
	iters: 200, epoch: 6 | loss: 0.0573143
	speed: 0.0499s/iter; left time: 2213.3913s
	iters: 300, epoch: 6 | loss: 0.0142908
	speed: 0.0497s/iter; left time: 2199.3236s
	iters: 400, epoch: 6 | loss: 0.1162039
	speed: 0.0488s/iter; left time: 2155.1572s
Epoch: 6 cost time: 23.74432897567749
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.966837 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0141272
	speed: 0.1811s/iter; left time: 7965.0375s
	iters: 200, epoch: 7 | loss: 0.0258910
	speed: 0.0511s/iter; left time: 2242.0858s
	iters: 300, epoch: 7 | loss: 0.0481617
	speed: 0.0511s/iter; left time: 2239.0387s
	iters: 400, epoch: 7 | loss: 0.0114243
	speed: 0.0538s/iter; left time: 2348.7368s
Epoch: 7 cost time: 24.14855408668518
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1855397
	speed: 0.1913s/iter; left time: 8323.8678s
	iters: 200, epoch: 8 | loss: 0.1379354
	speed: 0.0523s/iter; left time: 2270.7762s
	iters: 300, epoch: 8 | loss: 0.5247177
	speed: 0.0522s/iter; left time: 2262.7238s
	iters: 400, epoch: 8 | loss: 0.0081620
	speed: 0.0535s/iter; left time: 2310.6682s
Epoch: 8 cost time: 24.793776035308838
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0670322
	speed: 0.2021s/iter; left time: 8700.2075s
	iters: 200, epoch: 9 | loss: 0.0007680
	speed: 0.0530s/iter; left time: 2277.1318s
	iters: 300, epoch: 9 | loss: 0.0055162
	speed: 0.0526s/iter; left time: 2255.2468s
	iters: 400, epoch: 9 | loss: 0.2170390
	speed: 0.0562s/iter; left time: 2403.4599s
Epoch: 9 cost time: 25.19608736038208
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1725204
	speed: 0.1797s/iter; left time: 7650.1536s
	iters: 200, epoch: 10 | loss: 0.0569405
	speed: 0.0495s/iter; left time: 2103.9089s
	iters: 300, epoch: 10 | loss: 0.0044552
	speed: 0.0522s/iter; left time: 2210.5192s
	iters: 400, epoch: 10 | loss: 0.0061561
	speed: 0.0505s/iter; left time: 2135.2893s
Epoch: 10 cost time: 23.991795301437378
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0068426
	speed: 0.1812s/iter; left time: 7632.1845s
	iters: 200, epoch: 11 | loss: 0.0121376
	speed: 0.0522s/iter; left time: 2194.7393s
	iters: 300, epoch: 11 | loss: 0.0992422
	speed: 0.0551s/iter; left time: 2308.2501s
	iters: 400, epoch: 11 | loss: 0.0081390
	speed: 0.0520s/iter; left time: 2175.7990s
Epoch: 11 cost time: 25.108173847198486
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0012869
	speed: 0.2036s/iter; left time: 8477.8841s
	iters: 200, epoch: 12 | loss: 0.0022011
	speed: 0.0529s/iter; left time: 2198.4130s
	iters: 300, epoch: 12 | loss: 0.0699491
	speed: 0.0577s/iter; left time: 2390.2232s
	iters: 400, epoch: 12 | loss: 0.0014718
	speed: 0.0545s/iter; left time: 2251.7765s
Epoch: 12 cost time: 26.59926986694336
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1288054
	speed: 0.2072s/iter; left time: 8529.5023s
	iters: 200, epoch: 13 | loss: 0.1632302
	speed: 0.0551s/iter; left time: 2262.6808s
	iters: 300, epoch: 13 | loss: 0.0185666
	speed: 0.0557s/iter; left time: 2282.9075s
	iters: 400, epoch: 13 | loss: 0.0246361
	speed: 0.0518s/iter; left time: 2117.9427s
Epoch: 13 cost time: 25.94728374481201
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0091929
	speed: 0.2052s/iter; left time: 8352.6995s
	iters: 200, epoch: 14 | loss: 0.0404738
	speed: 0.0513s/iter; left time: 2081.9026s
	iters: 300, epoch: 14 | loss: 0.0473649
	speed: 0.0496s/iter; left time: 2010.0936s
	iters: 400, epoch: 14 | loss: 0.0048143
	speed: 0.0489s/iter; left time: 1975.3734s
Epoch: 14 cost time: 23.86082649230957
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0298855
	speed: 0.1790s/iter; left time: 7204.0238s
	iters: 200, epoch: 15 | loss: 0.0017301
	speed: 0.0558s/iter; left time: 2240.7391s
	iters: 300, epoch: 15 | loss: 0.0023968
	speed: 0.0564s/iter; left time: 2257.6068s
	iters: 400, epoch: 15 | loss: 0.1163020
	speed: 0.0533s/iter; left time: 2127.5015s
Epoch: 15 cost time: 25.717735290527344
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0031701
	speed: 0.2243s/iter; left time: 8919.4257s
	iters: 200, epoch: 16 | loss: 0.0057978
	speed: 0.0591s/iter; left time: 2343.3608s
	iters: 300, epoch: 16 | loss: 0.0006939
	speed: 0.0563s/iter; left time: 2227.3850s
	iters: 400, epoch: 16 | loss: 0.0085581
	speed: 0.0579s/iter; left time: 2286.6667s
Epoch: 16 cost time: 27.40320110321045
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 121066
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3006649
	speed: 0.0774s/iter; left time: 3623.1487s
	iters: 200, epoch: 1 | loss: 2.3226061
	speed: 0.0557s/iter; left time: 2601.8361s
	iters: 300, epoch: 1 | loss: 2.3059747
	speed: 0.0598s/iter; left time: 2786.9045s
	iters: 400, epoch: 1 | loss: 2.3014612
	speed: 0.0598s/iter; left time: 2782.1501s
Epoch: 1 cost time: 29.385892629623413
Epoch: 1, Steps: 469 | Train Loss: 2.304 Vali Loss: 2.303 Vali Acc: 0.096 Test Loss: 2.303 Test Acc: 0.096
Validation loss decreased (inf --> -0.096032).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3042719
	speed: 0.2283s/iter; left time: 10575.6743s
	iters: 200, epoch: 2 | loss: 2.3180892
	speed: 0.0560s/iter; left time: 2588.5832s
	iters: 300, epoch: 2 | loss: 2.2992373
	speed: 0.0572s/iter; left time: 2636.7216s
	iters: 400, epoch: 2 | loss: 2.3117282
	speed: 0.0545s/iter; left time: 2509.6903s
Epoch: 2 cost time: 26.727539539337158
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.096032 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3076625
	speed: 0.2255s/iter; left time: 10344.2994s
	iters: 200, epoch: 3 | loss: 2.3117311
	speed: 0.0595s/iter; left time: 2724.1487s
	iters: 300, epoch: 3 | loss: 2.3160777
	speed: 0.0578s/iter; left time: 2638.0789s
	iters: 400, epoch: 3 | loss: 2.3019493
	speed: 0.0558s/iter; left time: 2541.9125s
Epoch: 3 cost time: 27.537156105041504
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3099825
	speed: 0.2135s/iter; left time: 9690.7484s
	iters: 200, epoch: 4 | loss: 2.2961242
	speed: 0.0527s/iter; left time: 2386.0895s
	iters: 300, epoch: 4 | loss: 2.3078783
	speed: 0.0539s/iter; left time: 2436.7844s
	iters: 400, epoch: 4 | loss: 2.3059664
	speed: 0.0528s/iter; left time: 2380.7258s
Epoch: 4 cost time: 25.018064737319946
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3112473
	speed: 0.1761s/iter; left time: 7911.9548s
	iters: 200, epoch: 5 | loss: 2.3004067
	speed: 0.0539s/iter; left time: 2415.9149s
	iters: 300, epoch: 5 | loss: 2.3003922
	speed: 0.0539s/iter; left time: 2411.1026s
	iters: 400, epoch: 5 | loss: 2.2946792
	speed: 0.0540s/iter; left time: 2407.7012s
Epoch: 5 cost time: 25.562811613082886
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2979908
	speed: 0.1795s/iter; left time: 7981.9523s
	iters: 200, epoch: 6 | loss: 2.2975116
	speed: 0.0508s/iter; left time: 2253.8477s
	iters: 300, epoch: 6 | loss: 2.3031242
	speed: 0.0510s/iter; left time: 2257.2911s
	iters: 400, epoch: 6 | loss: 2.3094256
	speed: 0.0555s/iter; left time: 2451.7732s
Epoch: 6 cost time: 24.899128675460815
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3020053
	speed: 0.2208s/iter; left time: 9712.0448s
	iters: 200, epoch: 7 | loss: 2.2984059
	speed: 0.0566s/iter; left time: 2483.6964s
	iters: 300, epoch: 7 | loss: 2.3070617
	speed: 0.0633s/iter; left time: 2771.3737s
	iters: 400, epoch: 7 | loss: 2.2949476
	speed: 0.0597s/iter; left time: 2609.5958s
Epoch: 7 cost time: 28.343777418136597
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3108585
	speed: 0.2349s/iter; left time: 10221.9992s
	iters: 200, epoch: 8 | loss: 2.3101058
	speed: 0.0635s/iter; left time: 2758.8858s
	iters: 300, epoch: 8 | loss: 2.3099086
	speed: 0.0609s/iter; left time: 2638.9966s
	iters: 400, epoch: 8 | loss: 2.3237491
	speed: 0.0606s/iter; left time: 2621.1475s
Epoch: 8 cost time: 28.746051788330078
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2910204
	speed: 0.2311s/iter; left time: 9950.2834s
	iters: 200, epoch: 9 | loss: 2.3050981
	speed: 0.0593s/iter; left time: 2546.5013s
	iters: 300, epoch: 9 | loss: 2.3065524
	speed: 0.0575s/iter; left time: 2465.3007s
	iters: 400, epoch: 9 | loss: 2.2915115
	speed: 0.0565s/iter; left time: 2416.2314s
Epoch: 9 cost time: 27.431349992752075
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3029563
	speed: 0.2329s/iter; left time: 9917.6480s
	iters: 200, epoch: 10 | loss: 2.3068349
	speed: 0.0589s/iter; left time: 2501.1418s
	iters: 300, epoch: 10 | loss: 2.3100934
	speed: 0.0536s/iter; left time: 2271.1718s
	iters: 400, epoch: 10 | loss: 2.3049109
	speed: 0.0609s/iter; left time: 2574.7614s
Epoch: 10 cost time: 27.75471544265747
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3090181
	speed: 0.2243s/iter; left time: 9447.5244s
	iters: 200, epoch: 11 | loss: 2.3076062
	speed: 0.0572s/iter; left time: 2403.0560s
	iters: 300, epoch: 11 | loss: 2.2950749
	speed: 0.0607s/iter; left time: 2545.7102s
	iters: 400, epoch: 11 | loss: 2.2962098
	speed: 0.0566s/iter; left time: 2364.6471s
Epoch: 11 cost time: 27.229021310806274
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2911108
	speed: 0.1858s/iter; left time: 7738.8324s
	iters: 200, epoch: 12 | loss: 2.2970986
	speed: 0.0496s/iter; left time: 2059.1115s
	iters: 300, epoch: 12 | loss: 2.3037698
	speed: 0.0481s/iter; left time: 1994.3107s
	iters: 400, epoch: 12 | loss: 2.3015635
	speed: 0.0476s/iter; left time: 1969.4143s
Epoch: 12 cost time: 23.801130533218384
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3138180
	speed: 0.1724s/iter; left time: 7098.5554s
	iters: 200, epoch: 13 | loss: 2.3023934
	speed: 0.0492s/iter; left time: 2020.5904s
	iters: 300, epoch: 13 | loss: 2.3034611
	speed: 0.0606s/iter; left time: 2481.0157s
	iters: 400, epoch: 13 | loss: 2.2807620
	speed: 0.0559s/iter; left time: 2286.5998s
Epoch: 13 cost time: 25.90678071975708
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3108678
	speed: 0.2258s/iter; left time: 9190.8062s
	iters: 200, epoch: 14 | loss: 2.2924082
	speed: 0.0560s/iter; left time: 2275.3910s
	iters: 300, epoch: 14 | loss: 2.3117344
	speed: 0.0572s/iter; left time: 2315.4667s
	iters: 400, epoch: 14 | loss: 2.3040457
	speed: 0.0570s/iter; left time: 2302.3479s
Epoch: 14 cost time: 27.37262749671936
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3017192
	speed: 0.2330s/iter; left time: 9376.6814s
	iters: 200, epoch: 15 | loss: 2.3003531
	speed: 0.0567s/iter; left time: 2275.2942s
	iters: 300, epoch: 15 | loss: 2.3033123
	speed: 0.0578s/iter; left time: 2314.9024s
	iters: 400, epoch: 15 | loss: 2.2931283
	speed: 0.0612s/iter; left time: 2442.7491s
Epoch: 15 cost time: 27.76397728919983
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3086684
	speed: 0.2333s/iter; left time: 9275.7810s
	iters: 200, epoch: 16 | loss: 2.3018494
	speed: 0.0602s/iter; left time: 2387.1844s
	iters: 300, epoch: 16 | loss: 2.3013487
	speed: 0.0574s/iter; left time: 2270.8213s
	iters: 400, epoch: 16 | loss: 2.2997363
	speed: 0.0590s/iter; left time: 2328.3371s
Epoch: 16 cost time: 27.817243814468384
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3052535
	speed: 0.2272s/iter; left time: 8927.8932s
	iters: 200, epoch: 17 | loss: 2.3084340
	speed: 0.0599s/iter; left time: 2348.1066s
	iters: 300, epoch: 17 | loss: 2.3146315
	speed: 0.0565s/iter; left time: 2207.3533s
	iters: 400, epoch: 17 | loss: 2.3273308
	speed: 0.0593s/iter; left time: 2312.4282s
Epoch: 17 cost time: 28.05929708480835
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.2767944
	speed: 0.2306s/iter; left time: 8951.8298s
	iters: 200, epoch: 18 | loss: 2.2972410
	speed: 0.0624s/iter; left time: 2416.4246s
	iters: 300, epoch: 18 | loss: 2.2888451
	speed: 0.0563s/iter; left time: 2176.5731s
	iters: 400, epoch: 18 | loss: 2.3075235
	speed: 0.0580s/iter; left time: 2233.8016s
Epoch: 18 cost time: 27.81648564338684
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.2925134
	speed: 0.2218s/iter; left time: 8509.3249s
	iters: 200, epoch: 19 | loss: 2.3103073
	speed: 0.0592s/iter; left time: 2263.4437s
	iters: 300, epoch: 19 | loss: 2.3239589
	speed: 0.0592s/iter; left time: 2258.4989s
	iters: 400, epoch: 19 | loss: 2.2905517
	speed: 0.0528s/iter; left time: 2009.7823s
Epoch: 19 cost time: 27.24769878387451
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.3070018
	speed: 0.2213s/iter; left time: 8386.4221s
	iters: 200, epoch: 20 | loss: 2.3040118
	speed: 0.0546s/iter; left time: 2062.9344s
	iters: 300, epoch: 20 | loss: 2.2927251
	speed: 0.0578s/iter; left time: 2177.7678s
	iters: 400, epoch: 20 | loss: 2.2898085
	speed: 0.0555s/iter; left time: 2084.9431s
Epoch: 20 cost time: 27.140363693237305
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.3039665
	speed: 0.2249s/iter; left time: 8417.7261s
	iters: 200, epoch: 21 | loss: 2.3008497
	speed: 0.0556s/iter; left time: 2075.4463s
	iters: 300, epoch: 21 | loss: 2.2973392
	speed: 0.0587s/iter; left time: 2186.3147s
	iters: 400, epoch: 21 | loss: 2.3149390
	speed: 0.0597s/iter; left time: 2215.6853s
Epoch: 21 cost time: 27.773351430892944
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.2851777
	speed: 0.2263s/iter; left time: 8360.7806s
	iters: 200, epoch: 22 | loss: 2.3046234
	speed: 0.0623s/iter; left time: 2294.3726s
	iters: 300, epoch: 22 | loss: 2.2896223
	speed: 0.0640s/iter; left time: 2353.0749s
	iters: 400, epoch: 22 | loss: 2.3030121
	speed: 0.0597s/iter; left time: 2188.3056s
Epoch: 22 cost time: 29.027008295059204
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.2860937
	speed: 0.2403s/iter; left time: 8766.7997s
	iters: 200, epoch: 23 | loss: 2.3044391
	speed: 0.0620s/iter; left time: 2254.6318s
	iters: 300, epoch: 23 | loss: 2.2850387
	speed: 0.0577s/iter; left time: 2094.9413s
	iters: 400, epoch: 23 | loss: 2.3037241
	speed: 0.0594s/iter; left time: 2150.1727s
Epoch: 23 cost time: 28.64319372177124
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.3050766
	speed: 0.2296s/iter; left time: 8270.0697s
	iters: 200, epoch: 24 | loss: 2.2991791
	speed: 0.0575s/iter; left time: 2064.4582s
	iters: 300, epoch: 24 | loss: 2.3051820
	speed: 0.0597s/iter; left time: 2138.3281s
	iters: 400, epoch: 24 | loss: 2.3092592
	speed: 0.0565s/iter; left time: 2018.4273s
Epoch: 24 cost time: 27.331541061401367
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 2.3050294
	speed: 0.2332s/iter; left time: 8287.8646s
	iters: 200, epoch: 25 | loss: 2.3100162
	speed: 0.0552s/iter; left time: 1955.2878s
	iters: 300, epoch: 25 | loss: 2.3046987
	speed: 0.0533s/iter; left time: 1884.6530s
	iters: 400, epoch: 25 | loss: 2.3044913
	speed: 0.0538s/iter; left time: 1894.9626s
Epoch: 25 cost time: 26.059523582458496
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.3000894
	speed: 0.2197s/iter; left time: 7707.5083s
	iters: 200, epoch: 26 | loss: 2.2980340
	speed: 0.0582s/iter; left time: 2036.8737s
	iters: 300, epoch: 26 | loss: 2.3186545
	speed: 0.0591s/iter; left time: 2062.7253s
	iters: 400, epoch: 26 | loss: 2.3198886
	speed: 0.0589s/iter; left time: 2049.3882s
Epoch: 26 cost time: 27.970298528671265
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 27 | loss: 2.3028610
	speed: 0.2251s/iter; left time: 7791.0468s
	iters: 200, epoch: 27 | loss: 2.2971821
	speed: 0.0570s/iter; left time: 1968.2392s
	iters: 300, epoch: 27 | loss: 2.2941880
	speed: 0.0563s/iter; left time: 1936.9377s
	iters: 400, epoch: 27 | loss: 2.3162780
	speed: 0.0594s/iter; left time: 2039.4542s
Epoch: 27 cost time: 27.264630556106567
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.2972927
	speed: 0.2211s/iter; left time: 7547.6914s
	iters: 200, epoch: 28 | loss: 2.2851295
	speed: 0.0571s/iter; left time: 1942.5825s
	iters: 300, epoch: 28 | loss: 2.2941866
	speed: 0.0585s/iter; left time: 1984.6807s
	iters: 400, epoch: 28 | loss: 2.2934136
	speed: 0.0567s/iter; left time: 1919.9404s
Epoch: 28 cost time: 27.53050470352173
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 2.2843235
	speed: 0.2259s/iter; left time: 7607.4610s
	iters: 200, epoch: 29 | loss: 2.3153546
	speed: 0.0576s/iter; left time: 1933.2389s
	iters: 300, epoch: 29 | loss: 2.3157969
	speed: 0.0589s/iter; left time: 1972.5662s
	iters: 400, epoch: 29 | loss: 2.2930217
	speed: 0.0578s/iter; left time: 1927.8788s
Epoch: 29 cost time: 27.95965075492859
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 30 | loss: 2.2988424
	speed: 0.2346s/iter; left time: 7788.9492s
	iters: 200, epoch: 30 | loss: 2.2980797
	speed: 0.0566s/iter; left time: 1873.6624s
	iters: 300, epoch: 30 | loss: 2.2980599
	speed: 0.0596s/iter; left time: 1966.8633s
	iters: 400, epoch: 30 | loss: 2.3046324
	speed: 0.0587s/iter; left time: 1931.3410s
Epoch: 30 cost time: 28.031449556350708
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 2.2974241
	speed: 0.2284s/iter; left time: 7477.2024s
	iters: 200, epoch: 31 | loss: 2.2963703
	speed: 0.0601s/iter; left time: 1961.7081s
	iters: 300, epoch: 31 | loss: 2.3117015
	speed: 0.0574s/iter; left time: 1867.7644s
	iters: 400, epoch: 31 | loss: 2.3047588
	speed: 0.0515s/iter; left time: 1671.3369s
Epoch: 31 cost time: 27.018771409988403
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 2.3093812
	speed: 0.2040s/iter; left time: 6582.6502s
	iters: 200, epoch: 32 | loss: 2.3004241
	speed: 0.0575s/iter; left time: 1849.4467s
	iters: 300, epoch: 32 | loss: 2.2981536
	speed: 0.0580s/iter; left time: 1859.9014s
	iters: 400, epoch: 32 | loss: 2.3041887
	speed: 0.0561s/iter; left time: 1794.4759s
Epoch: 32 cost time: 27.59442925453186
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 33 | loss: 2.3106451
	speed: 0.2228s/iter; left time: 7082.7482s
	iters: 200, epoch: 33 | loss: 2.2884519
	speed: 0.0571s/iter; left time: 1808.2037s
	iters: 300, epoch: 33 | loss: 2.2971134
	speed: 0.0566s/iter; left time: 1787.1167s
	iters: 400, epoch: 33 | loss: 2.2995753
	speed: 0.0598s/iter; left time: 1884.5320s
Epoch: 33 cost time: 26.894818782806396
Epoch: 33, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 2.2973597
	speed: 0.2157s/iter; left time: 6755.1869s
	iters: 200, epoch: 34 | loss: 2.3052294
	speed: 0.0547s/iter; left time: 1706.5225s
	iters: 300, epoch: 34 | loss: 2.2815368
	speed: 0.0582s/iter; left time: 1812.8473s
	iters: 400, epoch: 34 | loss: 2.2996862
	speed: 0.0555s/iter; left time: 1722.9351s
Epoch: 34 cost time: 26.883346557617188
Epoch: 34, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 2.2977667
	speed: 0.2110s/iter; left time: 6509.0871s
	iters: 200, epoch: 35 | loss: 2.2874515
	speed: 0.0549s/iter; left time: 1688.9368s
	iters: 300, epoch: 35 | loss: 2.2919054
	speed: 0.0510s/iter; left time: 1563.2461s
	iters: 400, epoch: 35 | loss: 2.2990968
	speed: 0.0558s/iter; left time: 1705.9524s
Epoch: 35 cost time: 25.43174958229065
Epoch: 35, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 2.3046556
	speed: 0.2121s/iter; left time: 6443.4344s
	iters: 200, epoch: 36 | loss: 2.3245296
	speed: 0.0524s/iter; left time: 1587.6408s
	iters: 300, epoch: 36 | loss: 2.3010559
	speed: 0.0515s/iter; left time: 1554.7004s
	iters: 400, epoch: 36 | loss: 2.3008888
	speed: 0.0483s/iter; left time: 1454.4249s
Epoch: 36 cost time: 24.561835765838623
Epoch: 36, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 2.3191826
	speed: 0.1934s/iter; left time: 5785.3517s
	iters: 200, epoch: 37 | loss: 2.3091371
	speed: 0.0565s/iter; left time: 1683.2892s
	iters: 300, epoch: 37 | loss: 2.2881505
	speed: 0.0547s/iter; left time: 1624.1455s
	iters: 400, epoch: 37 | loss: 2.2762721
	speed: 0.0599s/iter; left time: 1773.3424s
Epoch: 37 cost time: 26.9671733379364
Epoch: 37, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 2.2866681
	speed: 0.2180s/iter; left time: 6418.2873s
	iters: 200, epoch: 38 | loss: 2.2845018
	speed: 0.0575s/iter; left time: 1688.3345s
	iters: 300, epoch: 38 | loss: 2.3175259
	speed: 0.0565s/iter; left time: 1653.1421s
	iters: 400, epoch: 38 | loss: 2.3034167
	speed: 0.0529s/iter; left time: 1540.9062s
Epoch: 38 cost time: 26.885154008865356
Epoch: 38, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 2.2902479
	speed: 0.2122s/iter; left time: 6150.3823s
	iters: 200, epoch: 39 | loss: 2.3084891
	speed: 0.0539s/iter; left time: 1556.5236s
	iters: 300, epoch: 39 | loss: 2.3078887
	speed: 0.0542s/iter; left time: 1559.5199s
	iters: 400, epoch: 39 | loss: 2.2973213
	speed: 0.0538s/iter; left time: 1543.5270s
Epoch: 39 cost time: 26.32550072669983
Epoch: 39, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 2.2849412
	speed: 0.2199s/iter; left time: 6269.7072s
	iters: 200, epoch: 40 | loss: 2.2996647
	speed: 0.0589s/iter; left time: 1672.8237s
	iters: 300, epoch: 40 | loss: 2.2927539
	speed: 0.0559s/iter; left time: 1582.3573s
	iters: 400, epoch: 40 | loss: 2.2817738
	speed: 0.0579s/iter; left time: 1633.7653s
Epoch: 40 cost time: 27.361435890197754
Epoch: 40, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 2.3140390
	speed: 0.2094s/iter; left time: 5872.9108s
	iters: 200, epoch: 41 | loss: 2.3116243
	speed: 0.0547s/iter; left time: 1527.4389s
	iters: 300, epoch: 41 | loss: 2.3061292
	speed: 0.0553s/iter; left time: 1539.1696s
	iters: 400, epoch: 41 | loss: 2.3149829
	speed: 0.0582s/iter; left time: 1614.1326s
Epoch: 41 cost time: 26.587306022644043
Epoch: 41, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 2.3102052
	speed: 0.1854s/iter; left time: 5112.6884s
	iters: 200, epoch: 42 | loss: 2.3049064
	speed: 0.0499s/iter; left time: 1371.9163s
	iters: 300, epoch: 42 | loss: 2.3020391
	speed: 0.0505s/iter; left time: 1380.9893s
	iters: 400, epoch: 42 | loss: 2.2926974
	speed: 0.0507s/iter; left time: 1383.0044s
Epoch: 42 cost time: 24.014509916305542
Epoch: 42, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 43 | loss: 2.3207119
	speed: 0.2032s/iter; left time: 5507.3185s
	iters: 200, epoch: 43 | loss: 2.3018534
	speed: 0.0524s/iter; left time: 1415.2862s
	iters: 300, epoch: 43 | loss: 2.2979004
	speed: 0.0526s/iter; left time: 1415.5953s
	iters: 400, epoch: 43 | loss: 2.2947106
	speed: 0.0524s/iter; left time: 1404.2283s
Epoch: 43 cost time: 25.118700742721558
Epoch: 43, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 2.3154936
	speed: 0.2044s/iter; left time: 5444.2482s
	iters: 200, epoch: 44 | loss: 2.3003345
	speed: 0.0516s/iter; left time: 1369.8092s
	iters: 300, epoch: 44 | loss: 2.2923555
	speed: 0.0536s/iter; left time: 1416.5498s
	iters: 400, epoch: 44 | loss: 2.2926133
	speed: 0.0530s/iter; left time: 1394.6660s
Epoch: 44 cost time: 25.67205834388733
Epoch: 44, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 2.2892146
	speed: 0.2063s/iter; left time: 5396.7673s
	iters: 200, epoch: 45 | loss: 2.3187842
	speed: 0.0550s/iter; left time: 1432.6143s
	iters: 300, epoch: 45 | loss: 2.3127418
	speed: 0.0550s/iter; left time: 1427.2470s
	iters: 400, epoch: 45 | loss: 2.3097131
	speed: 0.0543s/iter; left time: 1405.1133s
Epoch: 45 cost time: 26.121848106384277
Epoch: 45, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 2.3092432
	speed: 0.1945s/iter; left time: 4999.0675s
	iters: 200, epoch: 46 | loss: 2.3187361
	speed: 0.0486s/iter; left time: 1244.8108s
	iters: 300, epoch: 46 | loss: 2.2930126
	speed: 0.0516s/iter; left time: 1316.6938s
	iters: 400, epoch: 46 | loss: 2.3024924
	speed: 0.0520s/iter; left time: 1320.8125s
Epoch: 46 cost time: 24.52183771133423
Epoch: 46, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 2.3338625
	speed: 0.2058s/iter; left time: 5191.7797s
	iters: 200, epoch: 47 | loss: 2.2906103
	speed: 0.0544s/iter; left time: 1367.1955s
	iters: 300, epoch: 47 | loss: 2.3064630
	speed: 0.0539s/iter; left time: 1348.1450s
	iters: 400, epoch: 47 | loss: 2.3095000
	speed: 0.0551s/iter; left time: 1374.5332s
Epoch: 47 cost time: 25.9913330078125
Epoch: 47, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 2.3025486
	speed: 0.2149s/iter; left time: 5320.1115s
	iters: 200, epoch: 48 | loss: 2.3088102
	speed: 0.0568s/iter; left time: 1401.7605s
	iters: 300, epoch: 48 | loss: 2.3044276
	speed: 0.0534s/iter; left time: 1312.5190s
	iters: 400, epoch: 48 | loss: 2.2781420
	speed: 0.0577s/iter; left time: 1411.1988s
Epoch: 48 cost time: 26.235986709594727
Epoch: 48, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 49 | loss: 2.2961583
	speed: 0.2067s/iter; left time: 5021.2502s
	iters: 200, epoch: 49 | loss: 2.2978165
	speed: 0.0539s/iter; left time: 1302.8014s
	iters: 300, epoch: 49 | loss: 2.3089044
	speed: 0.0539s/iter; left time: 1299.5871s
	iters: 400, epoch: 49 | loss: 2.3197346
	speed: 0.0531s/iter; left time: 1274.4578s
Epoch: 49 cost time: 25.994222402572632
Epoch: 49, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 2.3155625
	speed: 0.2095s/iter; left time: 4990.3147s
	iters: 200, epoch: 50 | loss: 2.3077753
	speed: 0.0511s/iter; left time: 1213.2235s
	iters: 300, epoch: 50 | loss: 2.3011291
	speed: 0.0526s/iter; left time: 1242.8842s
	iters: 400, epoch: 50 | loss: 2.3258731
	speed: 0.0511s/iter; left time: 1202.1289s
Epoch: 50 cost time: 25.18533992767334
Epoch: 50, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 2.3031826
	speed: 0.1950s/iter; left time: 4552.7958s
	iters: 200, epoch: 51 | loss: 2.3075283
	speed: 0.0491s/iter; left time: 1140.5226s
	iters: 300, epoch: 51 | loss: 2.3052738
	speed: 0.0519s/iter; left time: 1202.0054s
	iters: 400, epoch: 51 | loss: 2.3026357
	speed: 0.0521s/iter; left time: 1201.2073s
Epoch: 51 cost time: 24.373725652694702
Epoch: 51, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 52 | loss: 2.2865343
	speed: 0.1995s/iter; left time: 4564.4713s
	iters: 200, epoch: 52 | loss: 2.3023477
	speed: 0.0546s/iter; left time: 1244.2245s
	iters: 300, epoch: 52 | loss: 2.3007591
	speed: 0.0513s/iter; left time: 1162.4863s
	iters: 400, epoch: 52 | loss: 2.3057740
	speed: 0.0530s/iter; left time: 1197.4773s
Epoch: 52 cost time: 25.092350244522095
Epoch: 52, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 53 | loss: 2.3139999
	speed: 0.2113s/iter; left time: 4736.1998s
	iters: 200, epoch: 53 | loss: 2.3103561
	speed: 0.0573s/iter; left time: 1277.8799s
	iters: 300, epoch: 53 | loss: 2.2986517
	speed: 0.0549s/iter; left time: 1219.2938s
	iters: 400, epoch: 53 | loss: 2.3173738
	speed: 0.0563s/iter; left time: 1245.1735s
Epoch: 53 cost time: 26.637476444244385
Epoch: 53, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 54 | loss: 2.2883661
	speed: 0.2121s/iter; left time: 4653.7094s
	iters: 200, epoch: 54 | loss: 2.2898874
	speed: 0.0559s/iter; left time: 1222.0770s
	iters: 300, epoch: 54 | loss: 2.2984958
	speed: 0.0533s/iter; left time: 1158.4885s
	iters: 400, epoch: 54 | loss: 2.3076892
	speed: 0.0549s/iter; left time: 1188.8489s
Epoch: 54 cost time: 26.24506950378418
Epoch: 54, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 55 | loss: 2.3018153
	speed: 0.2002s/iter; left time: 4300.0619s
	iters: 200, epoch: 55 | loss: 2.3041313
	speed: 0.0566s/iter; left time: 1210.3362s
	iters: 300, epoch: 55 | loss: 2.2930346
	speed: 0.0532s/iter; left time: 1131.9604s
	iters: 400, epoch: 55 | loss: 2.2932284
	speed: 0.0525s/iter; left time: 1111.8795s
Epoch: 55 cost time: 25.44140315055847
Epoch: 55, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 56 | loss: 2.3026550
	speed: 0.1931s/iter; left time: 4055.3781s
	iters: 200, epoch: 56 | loss: 2.3010080
	speed: 0.0517s/iter; left time: 1080.3952s
	iters: 300, epoch: 56 | loss: 2.3027377
	speed: 0.0554s/iter; left time: 1152.7107s
	iters: 400, epoch: 56 | loss: 2.3089228
	speed: 0.0549s/iter; left time: 1136.6175s
Epoch: 56 cost time: 25.847763776779175
Epoch: 56, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 57 | loss: 2.3029802
	speed: 0.2127s/iter; left time: 4367.2127s
	iters: 200, epoch: 57 | loss: 2.3114202
	speed: 0.0545s/iter; left time: 1114.6848s
	iters: 300, epoch: 57 | loss: 2.3091319
	speed: 0.0529s/iter; left time: 1074.9736s
	iters: 400, epoch: 57 | loss: 2.2888925
	speed: 0.0525s/iter; left time: 1061.7384s
Epoch: 57 cost time: 25.376587390899658
Epoch: 57, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 58 | loss: 2.3064036
	speed: 0.2087s/iter; left time: 4187.6821s
	iters: 200, epoch: 58 | loss: 2.2929921
	speed: 0.0553s/iter; left time: 1103.5931s
	iters: 300, epoch: 58 | loss: 2.3134580
	speed: 0.0515s/iter; left time: 1023.1115s
	iters: 400, epoch: 58 | loss: 2.3084750
	speed: 0.0546s/iter; left time: 1079.8683s
Epoch: 58 cost time: 25.66077470779419
Epoch: 58, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 121066
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7437992
	speed: 0.0695s/iter; left time: 3251.9531s
	iters: 200, epoch: 1 | loss: 1.1009148
	speed: 0.0572s/iter; left time: 2672.2214s
	iters: 300, epoch: 1 | loss: 0.7006605
	speed: 0.0572s/iter; left time: 2664.4424s
	iters: 400, epoch: 1 | loss: 0.5001034
	speed: 0.0535s/iter; left time: 2488.3188s
Epoch: 1 cost time: 27.6911563873291
Epoch: 1, Steps: 469 | Train Loss: 1.185 Vali Loss: 0.438 Vali Acc: 0.871 Test Loss: 0.438 Test Acc: 0.871
Validation loss decreased (inf --> -0.870779).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2404720
	speed: 0.1953s/iter; left time: 9049.4540s
	iters: 200, epoch: 2 | loss: 0.2571741
	speed: 0.0510s/iter; left time: 2358.2241s
	iters: 300, epoch: 2 | loss: 0.1514999
	speed: 0.0516s/iter; left time: 2382.2396s
	iters: 400, epoch: 2 | loss: 0.1045347
	speed: 0.0587s/iter; left time: 2703.0496s
Epoch: 2 cost time: 26.310357093811035
Epoch: 2, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
Validation loss decreased (-0.870779 --> -0.953686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0557934
	speed: 0.2308s/iter; left time: 10582.9605s
	iters: 200, epoch: 3 | loss: 0.1442741
	speed: 0.0584s/iter; left time: 2673.7039s
	iters: 300, epoch: 3 | loss: 0.2386713
	speed: 0.0581s/iter; left time: 2651.2403s
	iters: 400, epoch: 3 | loss: 0.0272017
	speed: 0.0595s/iter; left time: 2709.8319s
Epoch: 3 cost time: 27.80890130996704
Epoch: 3, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
Validation loss decreased (-0.953686 --> -0.964835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0680987
	speed: 0.2219s/iter; left time: 10070.8913s
	iters: 200, epoch: 4 | loss: 0.1229643
	speed: 0.0585s/iter; left time: 2649.2106s
	iters: 300, epoch: 4 | loss: 0.0254084
	speed: 0.0602s/iter; left time: 2720.8654s
	iters: 400, epoch: 4 | loss: 0.1218793
	speed: 0.0559s/iter; left time: 2520.4969s
Epoch: 4 cost time: 27.671031951904297
Epoch: 4, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.964835 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0191354
	speed: 0.2315s/iter; left time: 10399.3594s
	iters: 200, epoch: 5 | loss: 0.0280945
	speed: 0.0598s/iter; left time: 2680.5129s
	iters: 300, epoch: 5 | loss: 0.0956572
	speed: 0.0570s/iter; left time: 2549.6497s
	iters: 400, epoch: 5 | loss: 0.0942311
	speed: 0.0608s/iter; left time: 2711.6125s
Epoch: 5 cost time: 28.29318070411682
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0265271
	speed: 0.2336s/iter; left time: 10384.3234s
	iters: 200, epoch: 6 | loss: 0.0130213
	speed: 0.0572s/iter; left time: 2535.5729s
	iters: 300, epoch: 6 | loss: 0.0315179
	speed: 0.0584s/iter; left time: 2586.1778s
	iters: 400, epoch: 6 | loss: 0.0820208
	speed: 0.0548s/iter; left time: 2419.2447s
Epoch: 6 cost time: 27.545552253723145
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.975413).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0036442
	speed: 0.2314s/iter; left time: 10176.7630s
	iters: 200, epoch: 7 | loss: 0.0214916
	speed: 0.0582s/iter; left time: 2555.7918s
	iters: 300, epoch: 7 | loss: 0.0111421
	speed: 0.0548s/iter; left time: 2399.6143s
	iters: 400, epoch: 7 | loss: 0.2132431
	speed: 0.0599s/iter; left time: 2615.8462s
Epoch: 7 cost time: 27.60538411140442
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0042262
	speed: 0.2038s/iter; left time: 8869.2740s
	iters: 200, epoch: 8 | loss: 0.2837738
	speed: 0.0513s/iter; left time: 2226.8002s
	iters: 300, epoch: 8 | loss: 0.0189446
	speed: 0.0503s/iter; left time: 2179.0689s
	iters: 400, epoch: 8 | loss: 0.0026831
	speed: 0.0609s/iter; left time: 2631.9571s
Epoch: 8 cost time: 26.164632320404053
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.975413 --> -0.980559).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0243369
	speed: 0.2356s/iter; left time: 10142.9375s
	iters: 200, epoch: 9 | loss: 0.0034818
	speed: 0.0594s/iter; left time: 2550.1735s
	iters: 300, epoch: 9 | loss: 0.0113723
	speed: 0.0572s/iter; left time: 2452.9385s
	iters: 400, epoch: 9 | loss: 0.0110667
	speed: 0.0577s/iter; left time: 2466.5868s
Epoch: 9 cost time: 27.61727213859558
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0033515
	speed: 0.2357s/iter; left time: 10037.2129s
	iters: 200, epoch: 10 | loss: 0.0178559
	speed: 0.0596s/iter; left time: 2529.7441s
	iters: 300, epoch: 10 | loss: 0.2446747
	speed: 0.0587s/iter; left time: 2488.4027s
	iters: 400, epoch: 10 | loss: 0.0716073
	speed: 0.0550s/iter; left time: 2327.3474s
Epoch: 10 cost time: 27.6827335357666
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0019933
	speed: 0.2321s/iter; left time: 9775.1246s
	iters: 200, epoch: 11 | loss: 0.0245258
	speed: 0.0607s/iter; left time: 2548.4366s
	iters: 300, epoch: 11 | loss: 0.0158199
	speed: 0.0588s/iter; left time: 2466.0058s
	iters: 400, epoch: 11 | loss: 0.0056322
	speed: 0.0579s/iter; left time: 2419.9985s
Epoch: 11 cost time: 28.26406502723694
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1271016
	speed: 0.2395s/iter; left time: 9971.7909s
	iters: 200, epoch: 12 | loss: 0.0036935
	speed: 0.0565s/iter; left time: 2348.4859s
	iters: 300, epoch: 12 | loss: 0.0036362
	speed: 0.0585s/iter; left time: 2425.5274s
	iters: 400, epoch: 12 | loss: 0.0032854
	speed: 0.0578s/iter; left time: 2388.9768s
Epoch: 12 cost time: 27.684196949005127
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0101724
	speed: 0.2326s/iter; left time: 9578.5990s
	iters: 200, epoch: 13 | loss: 0.0013491
	speed: 0.0590s/iter; left time: 2425.3083s
	iters: 300, epoch: 13 | loss: 0.0156430
	speed: 0.0573s/iter; left time: 2349.3013s
	iters: 400, epoch: 13 | loss: 0.0357659
	speed: 0.0571s/iter; left time: 2332.9452s
Epoch: 13 cost time: 27.54992175102234
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0099405
	speed: 0.2214s/iter; left time: 9011.3295s
	iters: 200, epoch: 14 | loss: 0.0165933
	speed: 0.0551s/iter; left time: 2235.4298s
	iters: 300, epoch: 14 | loss: 0.0146012
	speed: 0.0601s/iter; left time: 2432.5475s
	iters: 400, epoch: 14 | loss: 0.0103242
	speed: 0.0533s/iter; left time: 2152.2587s
Epoch: 14 cost time: 26.875470399856567
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0045786
	speed: 0.2243s/iter; left time: 9024.0971s
	iters: 200, epoch: 15 | loss: 0.0123757
	speed: 0.0577s/iter; left time: 2316.3980s
	iters: 300, epoch: 15 | loss: 0.0021516
	speed: 0.0584s/iter; left time: 2339.6966s
	iters: 400, epoch: 15 | loss: 0.0607751
	speed: 0.0594s/iter; left time: 2372.7823s
Epoch: 15 cost time: 27.883018970489502
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4692418
	speed: 0.2270s/iter; left time: 9027.9950s
	iters: 200, epoch: 16 | loss: 0.0006915
	speed: 0.0600s/iter; left time: 2379.6525s
	iters: 300, epoch: 16 | loss: 0.0036559
	speed: 0.0555s/iter; left time: 2195.1788s
	iters: 400, epoch: 16 | loss: 0.0011187
	speed: 0.0579s/iter; left time: 2286.1917s
Epoch: 16 cost time: 27.91309380531311
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.980560).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0664644
	speed: 0.2312s/iter; left time: 9086.4809s
	iters: 200, epoch: 17 | loss: 0.0021127
	speed: 0.0583s/iter; left time: 2285.1407s
	iters: 300, epoch: 17 | loss: 0.0375817
	speed: 0.0621s/iter; left time: 2429.0542s
	iters: 400, epoch: 17 | loss: 0.0116019
	speed: 0.0584s/iter; left time: 2276.2808s
Epoch: 17 cost time: 28.26829957962036
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0006217
	speed: 0.2292s/iter; left time: 8897.9169s
	iters: 200, epoch: 18 | loss: 0.0003362
	speed: 0.0569s/iter; left time: 2205.5479s
	iters: 300, epoch: 18 | loss: 0.0038313
	speed: 0.0561s/iter; left time: 2168.6715s
	iters: 400, epoch: 18 | loss: 0.0173744
	speed: 0.0571s/iter; left time: 2199.0369s
Epoch: 18 cost time: 27.274970531463623
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0040648
	speed: 0.2281s/iter; left time: 8750.3219s
	iters: 200, epoch: 19 | loss: 0.0024856
	speed: 0.0545s/iter; left time: 2084.2266s
	iters: 300, epoch: 19 | loss: 0.0107851
	speed: 0.0546s/iter; left time: 2082.9172s
	iters: 400, epoch: 19 | loss: 0.0278408
	speed: 0.0509s/iter; left time: 1936.6694s
Epoch: 19 cost time: 25.801422119140625
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0454869
	speed: 0.1754s/iter; left time: 6647.0476s
	iters: 200, epoch: 20 | loss: 0.0849168
	speed: 0.0578s/iter; left time: 2184.1967s
	iters: 300, epoch: 20 | loss: 0.0024812
	speed: 0.0540s/iter; left time: 2035.9254s
	iters: 400, epoch: 20 | loss: 0.0002551
	speed: 0.0560s/iter; left time: 2106.4437s
Epoch: 20 cost time: 26.263967514038086
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0027314
	speed: 0.2189s/iter; left time: 8191.7925s
	iters: 200, epoch: 21 | loss: 0.0006428
	speed: 0.0575s/iter; left time: 2147.3839s
	iters: 300, epoch: 21 | loss: 0.0015245
	speed: 0.0541s/iter; left time: 2013.1787s
	iters: 400, epoch: 21 | loss: 0.0007371
	speed: 0.0562s/iter; left time: 2085.3925s
Epoch: 21 cost time: 27.102387189865112
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0227753
	speed: 0.2216s/iter; left time: 8188.9305s
	iters: 200, epoch: 22 | loss: 0.0005042
	speed: 0.0555s/iter; left time: 2043.8630s
	iters: 300, epoch: 22 | loss: 0.0020658
	speed: 0.0547s/iter; left time: 2008.8209s
	iters: 400, epoch: 22 | loss: 0.0124576
	speed: 0.0539s/iter; left time: 1973.7402s
Epoch: 22 cost time: 26.05443787574768
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0302923
	speed: 0.2081s/iter; left time: 7593.0027s
	iters: 200, epoch: 23 | loss: 0.3896191
	speed: 0.0573s/iter; left time: 2083.3752s
	iters: 300, epoch: 23 | loss: 0.0021052
	speed: 0.0554s/iter; left time: 2008.9028s
	iters: 400, epoch: 23 | loss: 0.0009513
	speed: 0.0567s/iter; left time: 2052.3162s
Epoch: 23 cost time: 26.156927585601807
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0003391
	speed: 0.1758s/iter; left time: 6331.9651s
	iters: 200, epoch: 24 | loss: 0.1784210
	speed: 0.0449s/iter; left time: 1611.6160s
	iters: 300, epoch: 24 | loss: 0.0001703
	speed: 0.0509s/iter; left time: 1821.4310s
	iters: 400, epoch: 24 | loss: 0.0004912
	speed: 0.0582s/iter; left time: 2077.5130s
Epoch: 24 cost time: 24.149535179138184
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0027163
	speed: 0.2107s/iter; left time: 7487.7232s
	iters: 200, epoch: 25 | loss: 0.0000868
	speed: 0.0535s/iter; left time: 1897.8350s
	iters: 300, epoch: 25 | loss: 0.0141073
	speed: 0.0571s/iter; left time: 2018.3290s
	iters: 400, epoch: 25 | loss: 0.0009053
	speed: 0.0534s/iter; left time: 1883.4607s
Epoch: 25 cost time: 26.560654878616333
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0056220
	speed: 0.2100s/iter; left time: 7365.8812s
	iters: 200, epoch: 26 | loss: 0.0004407
	speed: 0.0541s/iter; left time: 1893.0986s
	iters: 300, epoch: 26 | loss: 0.0092530
	speed: 0.0546s/iter; left time: 1903.7316s
	iters: 400, epoch: 26 | loss: 0.0777298
	speed: 0.0531s/iter; left time: 1845.2814s
Epoch: 26 cost time: 25.91621994972229
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 71914
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9984595
	speed: 0.0690s/iter; left time: 3230.4549s
	iters: 200, epoch: 1 | loss: 1.2140343
	speed: 0.0522s/iter; left time: 2440.0443s
	iters: 300, epoch: 1 | loss: 0.8646063
	speed: 0.0538s/iter; left time: 2506.3007s
	iters: 400, epoch: 1 | loss: 0.6124940
	speed: 0.0514s/iter; left time: 2390.4840s
Epoch: 1 cost time: 26.74843192100525
Epoch: 1, Steps: 469 | Train Loss: 1.295 Vali Loss: 0.518 Vali Acc: 0.846 Test Loss: 0.518 Test Acc: 0.846
Validation loss decreased (inf --> -0.845907).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2736577
	speed: 0.2030s/iter; left time: 9407.4579s
	iters: 200, epoch: 2 | loss: 0.3344598
	speed: 0.0560s/iter; left time: 2589.7403s
	iters: 300, epoch: 2 | loss: 0.2159020
	speed: 0.0502s/iter; left time: 2316.0552s
	iters: 400, epoch: 2 | loss: 0.2857235
	speed: 0.0550s/iter; left time: 2530.5243s
Epoch: 2 cost time: 25.721508741378784
Epoch: 2, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.262 Vali Acc: 0.921 Test Loss: 0.262 Test Acc: 0.921
Validation loss decreased (-0.845907 --> -0.920523).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1076922
	speed: 0.1696s/iter; left time: 7776.1886s
	iters: 200, epoch: 3 | loss: 0.1088803
	speed: 0.0489s/iter; left time: 2237.2017s
	iters: 300, epoch: 3 | loss: 0.2008965
	speed: 0.0492s/iter; left time: 2246.5429s
	iters: 400, epoch: 3 | loss: 0.0923681
	speed: 0.0533s/iter; left time: 2429.2421s
Epoch: 3 cost time: 23.648402452468872
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.920523 --> -0.951971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1962995
	speed: 0.1866s/iter; left time: 8469.2592s
	iters: 200, epoch: 4 | loss: 0.0872912
	speed: 0.0487s/iter; left time: 2207.7140s
	iters: 300, epoch: 4 | loss: 0.0507560
	speed: 0.0519s/iter; left time: 2346.8853s
	iters: 400, epoch: 4 | loss: 0.2297224
	speed: 0.0501s/iter; left time: 2257.1999s
Epoch: 4 cost time: 24.498084545135498
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.951971 --> -0.962549).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0225510
	speed: 0.1936s/iter; left time: 8697.8850s
	iters: 200, epoch: 5 | loss: 0.2112057
	speed: 0.0571s/iter; left time: 2560.4860s
	iters: 300, epoch: 5 | loss: 0.1257140
	speed: 0.0508s/iter; left time: 2270.3053s
	iters: 400, epoch: 5 | loss: 0.0618264
	speed: 0.0566s/iter; left time: 2527.2672s
Epoch: 5 cost time: 25.630105018615723
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.962549 --> -0.966837).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0447249
	speed: 0.1966s/iter; left time: 8740.5348s
	iters: 200, epoch: 6 | loss: 0.1739115
	speed: 0.0518s/iter; left time: 2298.6111s
	iters: 300, epoch: 6 | loss: 0.0246171
	speed: 0.0546s/iter; left time: 2414.6642s
	iters: 400, epoch: 6 | loss: 0.0446786
	speed: 0.0501s/iter; left time: 2211.2414s
Epoch: 6 cost time: 25.32283353805542
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.966837 --> -0.972269).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0073147
	speed: 0.1915s/iter; left time: 8423.9532s
	iters: 200, epoch: 7 | loss: 0.0143189
	speed: 0.0531s/iter; left time: 2332.0651s
	iters: 300, epoch: 7 | loss: 0.0601815
	speed: 0.0523s/iter; left time: 2290.8046s
	iters: 400, epoch: 7 | loss: 0.1039064
	speed: 0.0569s/iter; left time: 2483.6171s
Epoch: 7 cost time: 24.96186113357544
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.974842).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0054515
	speed: 0.1823s/iter; left time: 7931.1980s
	iters: 200, epoch: 8 | loss: 0.4426934
	speed: 0.0505s/iter; left time: 2191.9527s
	iters: 300, epoch: 8 | loss: 0.0186438
	speed: 0.0537s/iter; left time: 2324.5829s
	iters: 400, epoch: 8 | loss: 0.0016177
	speed: 0.0495s/iter; left time: 2137.3275s
Epoch: 8 cost time: 24.490880012512207
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0058068
	speed: 0.1901s/iter; left time: 8182.4724s
	iters: 200, epoch: 9 | loss: 0.0110911
	speed: 0.0526s/iter; left time: 2260.2421s
	iters: 300, epoch: 9 | loss: 0.0047917
	speed: 0.0503s/iter; left time: 2153.8037s
	iters: 400, epoch: 9 | loss: 0.1317638
	speed: 0.0551s/iter; left time: 2356.7040s
Epoch: 9 cost time: 24.84688973426819
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0606394
	speed: 0.1963s/iter; left time: 8357.9940s
	iters: 200, epoch: 10 | loss: 0.0121788
	speed: 0.0517s/iter; left time: 2197.4927s
	iters: 300, epoch: 10 | loss: 0.0404005
	speed: 0.0535s/iter; left time: 2266.5739s
	iters: 400, epoch: 10 | loss: 0.0350442
	speed: 0.0505s/iter; left time: 2134.8141s
Epoch: 10 cost time: 25.383135557174683
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0026839
	speed: 0.1961s/iter; left time: 8259.3989s
	iters: 200, epoch: 11 | loss: 0.0994336
	speed: 0.0561s/iter; left time: 2357.4903s
	iters: 300, epoch: 11 | loss: 0.0137447
	speed: 0.0524s/iter; left time: 2194.5820s
	iters: 400, epoch: 11 | loss: 0.0292512
	speed: 0.0484s/iter; left time: 2023.5565s
Epoch: 11 cost time: 24.789100646972656
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0851070
	speed: 0.1801s/iter; left time: 7499.7639s
	iters: 200, epoch: 12 | loss: 0.0091027
	speed: 0.0533s/iter; left time: 2214.3979s
	iters: 300, epoch: 12 | loss: 0.0037651
	speed: 0.0538s/iter; left time: 2229.8032s
	iters: 400, epoch: 12 | loss: 0.0108341
	speed: 0.0546s/iter; left time: 2258.9859s
Epoch: 12 cost time: 25.635046005249023
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0175154
	speed: 0.1911s/iter; left time: 7868.8448s
	iters: 200, epoch: 13 | loss: 0.0003994
	speed: 0.0538s/iter; left time: 2207.9208s
	iters: 300, epoch: 13 | loss: 0.0575611
	speed: 0.0534s/iter; left time: 2186.3356s
	iters: 400, epoch: 13 | loss: 0.0020499
	speed: 0.0529s/iter; left time: 2160.9184s
Epoch: 13 cost time: 24.970287322998047
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977129).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0013102
	speed: 0.1942s/iter; left time: 7906.3924s
	iters: 200, epoch: 14 | loss: 0.0116273
	speed: 0.0489s/iter; left time: 1987.3454s
	iters: 300, epoch: 14 | loss: 0.0057583
	speed: 0.0516s/iter; left time: 2091.9592s
	iters: 400, epoch: 14 | loss: 0.0151688
	speed: 0.0537s/iter; left time: 2171.4415s
Epoch: 14 cost time: 24.699087858200073
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1638028
	speed: 0.1868s/iter; left time: 7514.8259s
	iters: 200, epoch: 15 | loss: 0.1613470
	speed: 0.0525s/iter; left time: 2105.6396s
	iters: 300, epoch: 15 | loss: 0.0040485
	speed: 0.0426s/iter; left time: 1706.6032s
	iters: 400, epoch: 15 | loss: 0.0203072
	speed: 0.0476s/iter; left time: 1900.8035s
Epoch: 15 cost time: 22.817221879959106
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3342714
	speed: 0.1788s/iter; left time: 7110.8488s
	iters: 200, epoch: 16 | loss: 0.0151608
	speed: 0.0513s/iter; left time: 2036.5163s
	iters: 300, epoch: 16 | loss: 0.0064105
	speed: 0.0499s/iter; left time: 1973.6470s
	iters: 400, epoch: 16 | loss: 0.0004203
	speed: 0.0525s/iter; left time: 2070.5316s
Epoch: 16 cost time: 24.05685019493103
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978558).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1532291
	speed: 0.1834s/iter; left time: 7206.8208s
	iters: 200, epoch: 17 | loss: 0.0006076
	speed: 0.0515s/iter; left time: 2019.8402s
	iters: 300, epoch: 17 | loss: 0.0758713
	speed: 0.0515s/iter; left time: 2012.6349s
	iters: 400, epoch: 17 | loss: 0.0057925
	speed: 0.0576s/iter; left time: 2244.8614s
Epoch: 17 cost time: 24.61620831489563
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0050827
	speed: 0.1810s/iter; left time: 7029.5138s
	iters: 200, epoch: 18 | loss: 0.0028138
	speed: 0.0500s/iter; left time: 1936.2184s
	iters: 300, epoch: 18 | loss: 0.0119598
	speed: 0.0507s/iter; left time: 1956.5907s
	iters: 400, epoch: 18 | loss: 0.0018525
	speed: 0.0524s/iter; left time: 2017.7090s
Epoch: 18 cost time: 24.24734592437744
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0265451
	speed: 0.1910s/iter; left time: 7328.2671s
	iters: 200, epoch: 19 | loss: 0.0011310
	speed: 0.0496s/iter; left time: 1898.5528s
	iters: 300, epoch: 19 | loss: 0.1400384
	speed: 0.0525s/iter; left time: 2002.2818s
	iters: 400, epoch: 19 | loss: 0.0699036
	speed: 0.0492s/iter; left time: 1873.8140s
Epoch: 19 cost time: 24.331167697906494
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0458670
	speed: 0.1900s/iter; left time: 7197.7565s
	iters: 200, epoch: 20 | loss: 0.0062352
	speed: 0.0512s/iter; left time: 1935.0073s
	iters: 300, epoch: 20 | loss: 0.0065400
	speed: 0.0525s/iter; left time: 1980.3833s
	iters: 400, epoch: 20 | loss: 0.0011133
	speed: 0.0512s/iter; left time: 1924.3550s
Epoch: 20 cost time: 24.768991231918335
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0638306
	speed: 0.1933s/iter; left time: 7233.6247s
	iters: 200, epoch: 21 | loss: 0.0006751
	speed: 0.0494s/iter; left time: 1843.1993s
	iters: 300, epoch: 21 | loss: 0.0039229
	speed: 0.0510s/iter; left time: 1896.8662s
	iters: 400, epoch: 21 | loss: 0.1006440
	speed: 0.0474s/iter; left time: 1758.3093s
Epoch: 21 cost time: 23.564274311065674
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0019810
	speed: 0.1700s/iter; left time: 6281.9381s
	iters: 200, epoch: 22 | loss: 0.0082318
	speed: 0.0512s/iter; left time: 1886.5481s
	iters: 300, epoch: 22 | loss: 0.0004696
	speed: 0.0496s/iter; left time: 1822.3354s
	iters: 400, epoch: 22 | loss: 0.4039832
	speed: 0.0506s/iter; left time: 1854.7343s
Epoch: 22 cost time: 24.069814682006836
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0043936
	speed: 0.1814s/iter; left time: 6619.5814s
	iters: 200, epoch: 23 | loss: 0.0154001
	speed: 0.0516s/iter; left time: 1877.4286s
	iters: 300, epoch: 23 | loss: 0.0020023
	speed: 0.0506s/iter; left time: 1834.5062s
	iters: 400, epoch: 23 | loss: 0.0007939
	speed: 0.0475s/iter; left time: 1717.0106s
Epoch: 23 cost time: 23.859787464141846
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0068702
	speed: 0.1759s/iter; left time: 6333.2359s
	iters: 200, epoch: 24 | loss: 0.1711125
	speed: 0.0496s/iter; left time: 1782.1217s
	iters: 300, epoch: 24 | loss: 0.0005639
	speed: 0.0469s/iter; left time: 1681.3371s
	iters: 400, epoch: 24 | loss: 0.0017426
	speed: 0.0507s/iter; left time: 1810.2298s
Epoch: 24 cost time: 23.102242469787598
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0080379
	speed: 0.1799s/iter; left time: 6394.8660s
	iters: 200, epoch: 25 | loss: 0.0016326
	speed: 0.0513s/iter; left time: 1818.2785s
	iters: 300, epoch: 25 | loss: 0.0834032
	speed: 0.0507s/iter; left time: 1790.4060s
	iters: 400, epoch: 25 | loss: 0.0010029
	speed: 0.0531s/iter; left time: 1870.6872s
Epoch: 25 cost time: 24.29320740699768
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0602250
	speed: 0.1923s/iter; left time: 6745.4632s
	iters: 200, epoch: 26 | loss: 0.0003098
	speed: 0.0525s/iter; left time: 1837.3136s
	iters: 300, epoch: 26 | loss: 0.0033329
	speed: 0.0521s/iter; left time: 1817.2315s
	iters: 400, epoch: 26 | loss: 0.1474122
	speed: 0.0542s/iter; left time: 1885.0490s
Epoch: 26 cost time: 25.068814039230347
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 71914
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9639616
	speed: 0.0702s/iter; left time: 3284.7719s
	iters: 200, epoch: 1 | loss: 1.2022671
	speed: 0.0550s/iter; left time: 2567.6114s
	iters: 300, epoch: 1 | loss: 0.8505582
	speed: 0.0568s/iter; left time: 2646.1886s
	iters: 400, epoch: 1 | loss: 0.6670918
	speed: 0.0557s/iter; left time: 2589.4465s
Epoch: 1 cost time: 27.497154712677002
Epoch: 1, Steps: 469 | Train Loss: 1.244 Vali Loss: 0.502 Vali Acc: 0.863 Test Loss: 0.502 Test Acc: 0.863
Validation loss decreased (inf --> -0.863345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2876686
	speed: 0.1888s/iter; left time: 8749.0256s
	iters: 200, epoch: 2 | loss: 0.3069938
	speed: 0.0561s/iter; left time: 2591.5302s
	iters: 300, epoch: 2 | loss: 0.2663845
	speed: 0.0579s/iter; left time: 2670.6437s
	iters: 400, epoch: 2 | loss: 0.1244595
	speed: 0.0567s/iter; left time: 2610.4975s
Epoch: 2 cost time: 26.70121455192566
Epoch: 2, Steps: 469 | Train Loss: 0.278 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.863345 --> -0.938534).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1577608
	speed: 0.1954s/iter; left time: 8963.0222s
	iters: 200, epoch: 3 | loss: 0.1114842
	speed: 0.0572s/iter; left time: 2616.1038s
	iters: 300, epoch: 3 | loss: 0.1932909
	speed: 0.0557s/iter; left time: 2543.2819s
	iters: 400, epoch: 3 | loss: 0.0880949
	speed: 0.0553s/iter; left time: 2521.8091s
Epoch: 3 cost time: 27.12946391105652
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
Validation loss decreased (-0.938534 --> -0.960547).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1527982
	speed: 0.1965s/iter; left time: 8920.4533s
	iters: 200, epoch: 4 | loss: 0.1819690
	speed: 0.0549s/iter; left time: 2488.8856s
	iters: 300, epoch: 4 | loss: 0.0216547
	speed: 0.0572s/iter; left time: 2584.4038s
	iters: 400, epoch: 4 | loss: 0.1088421
	speed: 0.0572s/iter; left time: 2579.8376s
Epoch: 4 cost time: 26.705121994018555
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.960547 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0117341
	speed: 0.1974s/iter; left time: 8870.2791s
	iters: 200, epoch: 5 | loss: 0.0477756
	speed: 0.0529s/iter; left time: 2372.5093s
	iters: 300, epoch: 5 | loss: 0.0240216
	speed: 0.0556s/iter; left time: 2487.8676s
	iters: 400, epoch: 5 | loss: 0.0614088
	speed: 0.0568s/iter; left time: 2532.7716s
Epoch: 5 cost time: 26.472224950790405
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0211873
	speed: 0.1982s/iter; left time: 8810.0918s
	iters: 200, epoch: 6 | loss: 0.0303725
	speed: 0.0557s/iter; left time: 2471.4851s
	iters: 300, epoch: 6 | loss: 0.0058797
	speed: 0.0568s/iter; left time: 2514.7241s
	iters: 400, epoch: 6 | loss: 0.1848886
	speed: 0.0567s/iter; left time: 2501.7416s
Epoch: 6 cost time: 26.791897773742676
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.970268).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0060514
	speed: 0.2000s/iter; left time: 8797.8533s
	iters: 200, epoch: 7 | loss: 0.0185827
	speed: 0.0550s/iter; left time: 2412.1873s
	iters: 300, epoch: 7 | loss: 0.0700729
	speed: 0.0557s/iter; left time: 2438.8368s
	iters: 400, epoch: 7 | loss: 0.0779540
	speed: 0.0558s/iter; left time: 2437.3789s
Epoch: 7 cost time: 26.39999485015869
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.970268 --> -0.979702).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0069371
	speed: 0.1963s/iter; left time: 8543.6373s
	iters: 200, epoch: 8 | loss: 0.2518396
	speed: 0.0568s/iter; left time: 2465.7381s
	iters: 300, epoch: 8 | loss: 0.0123190
	speed: 0.0559s/iter; left time: 2421.4969s
	iters: 400, epoch: 8 | loss: 0.0068921
	speed: 0.0557s/iter; left time: 2408.0419s
Epoch: 8 cost time: 26.701032638549805
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0046239
	speed: 0.1900s/iter; left time: 8178.6043s
	iters: 200, epoch: 9 | loss: 0.0031841
	speed: 0.0535s/iter; left time: 2298.2882s
	iters: 300, epoch: 9 | loss: 0.0081302
	speed: 0.0535s/iter; left time: 2291.7845s
	iters: 400, epoch: 9 | loss: 0.1572236
	speed: 0.0573s/iter; left time: 2450.2729s
Epoch: 9 cost time: 26.19659733772278
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0048750
	speed: 0.1936s/iter; left time: 8243.4967s
	iters: 200, epoch: 10 | loss: 0.0040348
	speed: 0.0515s/iter; left time: 2189.5216s
	iters: 300, epoch: 10 | loss: 0.0248966
	speed: 0.0518s/iter; left time: 2196.6796s
	iters: 400, epoch: 10 | loss: 0.0247824
	speed: 0.0577s/iter; left time: 2439.6620s
Epoch: 10 cost time: 25.758962869644165
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0015066
	speed: 0.1957s/iter; left time: 8239.4429s
	iters: 200, epoch: 11 | loss: 0.0659339
	speed: 0.0551s/iter; left time: 2313.3544s
	iters: 300, epoch: 11 | loss: 0.0425281
	speed: 0.0549s/iter; left time: 2302.2904s
	iters: 400, epoch: 11 | loss: 0.0077884
	speed: 0.0546s/iter; left time: 2284.1835s
Epoch: 11 cost time: 25.69710063934326
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1605826
	speed: 0.2026s/iter; left time: 8438.2742s
	iters: 200, epoch: 12 | loss: 0.0096342
	speed: 0.0539s/iter; left time: 2239.2679s
	iters: 300, epoch: 12 | loss: 0.0148688
	speed: 0.0590s/iter; left time: 2444.2121s
	iters: 400, epoch: 12 | loss: 0.0007129
	speed: 0.0538s/iter; left time: 2224.8757s
Epoch: 12 cost time: 26.32099986076355
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0327727
	speed: 0.2032s/iter; left time: 8364.7476s
	iters: 200, epoch: 13 | loss: 0.0007904
	speed: 0.0568s/iter; left time: 2331.2641s
	iters: 300, epoch: 13 | loss: 0.0839006
	speed: 0.0543s/iter; left time: 2224.1301s
	iters: 400, epoch: 13 | loss: 0.0038562
	speed: 0.0523s/iter; left time: 2138.0131s
Epoch: 13 cost time: 26.110586404800415
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0183728
	speed: 0.1968s/iter; left time: 8010.1424s
	iters: 200, epoch: 14 | loss: 0.0191350
	speed: 0.0627s/iter; left time: 2546.0309s
	iters: 300, epoch: 14 | loss: 0.0064754
	speed: 0.0585s/iter; left time: 2369.2213s
	iters: 400, epoch: 14 | loss: 0.0481053
	speed: 0.0614s/iter; left time: 2478.9805s
Epoch: 14 cost time: 29.093541145324707
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0058787
	speed: 0.2227s/iter; left time: 8960.8745s
	iters: 200, epoch: 15 | loss: 0.0387273
	speed: 0.0582s/iter; left time: 2333.9944s
	iters: 300, epoch: 15 | loss: 0.0004038
	speed: 0.0615s/iter; left time: 2463.3433s
	iters: 400, epoch: 15 | loss: 0.0345500
	speed: 0.0597s/iter; left time: 2382.2795s
Epoch: 15 cost time: 28.361205577850342
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2397127
	speed: 0.2153s/iter; left time: 8563.0754s
	iters: 200, epoch: 16 | loss: 0.0029314
	speed: 0.0625s/iter; left time: 2478.7811s
	iters: 300, epoch: 16 | loss: 0.0027452
	speed: 0.0578s/iter; left time: 2286.7555s
	iters: 400, epoch: 16 | loss: 0.0018848
	speed: 0.0591s/iter; left time: 2331.6308s
Epoch: 16 cost time: 27.902448177337646
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1773654
	speed: 0.2118s/iter; left time: 8323.6062s
	iters: 200, epoch: 17 | loss: 0.0058337
	speed: 0.0585s/iter; left time: 2291.4984s
	iters: 300, epoch: 17 | loss: 0.0011511
	speed: 0.0617s/iter; left time: 2411.8582s
	iters: 400, epoch: 17 | loss: 0.0087592
	speed: 0.0570s/iter; left time: 2221.3447s
Epoch: 17 cost time: 27.7904314994812
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 71914
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2966459
	speed: 0.0772s/iter; left time: 3611.6849s
	iters: 200, epoch: 1 | loss: 2.2985358
	speed: 0.0596s/iter; left time: 2782.4232s
	iters: 300, epoch: 1 | loss: 2.3093832
	speed: 0.0609s/iter; left time: 2838.4805s
	iters: 400, epoch: 1 | loss: 2.3053911
	speed: 0.0604s/iter; left time: 2808.4625s
Epoch: 1 cost time: 29.73330307006836
Epoch: 1, Steps: 469 | Train Loss: 2.304 Vali Loss: 2.303 Vali Acc: 0.096 Test Loss: 2.303 Test Acc: 0.096
Validation loss decreased (inf --> -0.095746).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3005028
	speed: 0.2238s/iter; left time: 10368.6873s
	iters: 200, epoch: 2 | loss: 2.3048317
	speed: 0.0615s/iter; left time: 2841.6062s
	iters: 300, epoch: 2 | loss: 2.3058655
	speed: 0.0568s/iter; left time: 2622.0928s
	iters: 400, epoch: 2 | loss: 2.3001032
	speed: 0.0547s/iter; left time: 2518.9006s
Epoch: 2 cost time: 27.415942668914795
Epoch: 2, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.095746 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2967076
	speed: 0.2252s/iter; left time: 10327.7889s
	iters: 200, epoch: 3 | loss: 2.3024070
	speed: 0.0592s/iter; left time: 2708.5141s
	iters: 300, epoch: 3 | loss: 2.3053672
	speed: 0.0618s/iter; left time: 2823.4934s
	iters: 400, epoch: 3 | loss: 2.3014243
	speed: 0.0578s/iter; left time: 2634.7151s
Epoch: 3 cost time: 27.790557622909546
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3025875
	speed: 0.2184s/iter; left time: 9914.5262s
	iters: 200, epoch: 4 | loss: 2.2908831
	speed: 0.0631s/iter; left time: 2856.3949s
	iters: 300, epoch: 4 | loss: 2.3077292
	speed: 0.0576s/iter; left time: 2604.7811s
	iters: 400, epoch: 4 | loss: 2.3058636
	speed: 0.0593s/iter; left time: 2671.8910s
Epoch: 4 cost time: 28.218465089797974
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3060465
	speed: 0.2155s/iter; left time: 9682.1199s
	iters: 200, epoch: 5 | loss: 2.2955153
	speed: 0.0569s/iter; left time: 2549.8476s
	iters: 300, epoch: 5 | loss: 2.3118303
	speed: 0.0612s/iter; left time: 2735.8461s
	iters: 400, epoch: 5 | loss: 2.2952976
	speed: 0.0590s/iter; left time: 2631.7249s
Epoch: 5 cost time: 27.736709594726562
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2854855
	speed: 0.2099s/iter; left time: 9330.9629s
	iters: 200, epoch: 6 | loss: 2.3033481
	speed: 0.0544s/iter; left time: 2412.4446s
	iters: 300, epoch: 6 | loss: 2.2994540
	speed: 0.0506s/iter; left time: 2239.2931s
	iters: 400, epoch: 6 | loss: 2.3233783
	speed: 0.0542s/iter; left time: 2391.8470s
Epoch: 6 cost time: 25.851015329360962
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2929683
	speed: 0.2286s/iter; left time: 10055.6550s
	iters: 200, epoch: 7 | loss: 2.3033910
	speed: 0.0549s/iter; left time: 2409.5196s
	iters: 300, epoch: 7 | loss: 2.2949083
	speed: 0.0584s/iter; left time: 2555.2591s
	iters: 400, epoch: 7 | loss: 2.2986712
	speed: 0.0595s/iter; left time: 2600.0445s
Epoch: 7 cost time: 27.607024669647217
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2971082
	speed: 0.2250s/iter; left time: 9792.7744s
	iters: 200, epoch: 8 | loss: 2.2895460
	speed: 0.0576s/iter; left time: 2499.8266s
	iters: 300, epoch: 8 | loss: 2.2973363
	speed: 0.0588s/iter; left time: 2545.3564s
	iters: 400, epoch: 8 | loss: 2.3113358
	speed: 0.0588s/iter; left time: 2540.4961s
Epoch: 8 cost time: 27.961548805236816
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2922976
	speed: 0.2223s/iter; left time: 9570.0810s
	iters: 200, epoch: 9 | loss: 2.2896609
	speed: 0.0596s/iter; left time: 2561.4318s
	iters: 300, epoch: 9 | loss: 2.3181524
	speed: 0.0595s/iter; left time: 2547.4369s
	iters: 400, epoch: 9 | loss: 2.3120017
	speed: 0.0599s/iter; left time: 2561.8211s
Epoch: 9 cost time: 27.643052339553833
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3009496
	speed: 0.2195s/iter; left time: 9345.2135s
	iters: 200, epoch: 10 | loss: 2.3103940
	speed: 0.0549s/iter; left time: 2333.5034s
	iters: 300, epoch: 10 | loss: 2.3169968
	speed: 0.0552s/iter; left time: 2340.9527s
	iters: 400, epoch: 10 | loss: 2.3079512
	speed: 0.0560s/iter; left time: 2367.0268s
Epoch: 10 cost time: 26.544201135635376
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3025212
	speed: 0.1985s/iter; left time: 8360.1099s
	iters: 200, epoch: 11 | loss: 2.2876172
	speed: 0.0621s/iter; left time: 2607.6963s
	iters: 300, epoch: 11 | loss: 2.3075030
	speed: 0.0589s/iter; left time: 2467.8711s
	iters: 400, epoch: 11 | loss: 2.3032339
	speed: 0.0609s/iter; left time: 2546.1621s
Epoch: 11 cost time: 28.107288360595703
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2958341
	speed: 0.2199s/iter; left time: 9158.5269s
	iters: 200, epoch: 12 | loss: 2.3008666
	speed: 0.0589s/iter; left time: 2445.3122s
	iters: 300, epoch: 12 | loss: 2.3182371
	speed: 0.0552s/iter; left time: 2287.2032s
	iters: 400, epoch: 12 | loss: 2.2984083
	speed: 0.0590s/iter; left time: 2441.0361s
Epoch: 12 cost time: 27.76322364807129
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2835786
	speed: 0.2194s/iter; left time: 9031.5161s
	iters: 200, epoch: 13 | loss: 2.3014205
	speed: 0.0590s/iter; left time: 2422.8486s
	iters: 300, epoch: 13 | loss: 2.2991285
	speed: 0.0581s/iter; left time: 2381.0323s
	iters: 400, epoch: 13 | loss: 2.3122988
	speed: 0.0540s/iter; left time: 2209.0834s
Epoch: 13 cost time: 27.041593313217163
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3093944
	speed: 0.2103s/iter; left time: 8560.1118s
	iters: 200, epoch: 14 | loss: 2.2906423
	speed: 0.0552s/iter; left time: 2241.2621s
	iters: 300, epoch: 14 | loss: 2.3117430
	speed: 0.0587s/iter; left time: 2378.9011s
	iters: 400, epoch: 14 | loss: 2.3096881
	speed: 0.0530s/iter; left time: 2141.6412s
Epoch: 14 cost time: 26.90494966506958
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.3123024
	speed: 0.2164s/iter; left time: 8705.8164s
	iters: 200, epoch: 15 | loss: 2.2985539
	speed: 0.0570s/iter; left time: 2288.9528s
	iters: 300, epoch: 15 | loss: 2.3007030
	speed: 0.0537s/iter; left time: 2150.4544s
	iters: 400, epoch: 15 | loss: 2.2984786
	speed: 0.0508s/iter; left time: 2029.5167s
Epoch: 15 cost time: 25.887744665145874
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.3079872
	speed: 0.1794s/iter; left time: 7135.0355s
	iters: 200, epoch: 16 | loss: 2.2943699
	speed: 0.0556s/iter; left time: 2205.2088s
	iters: 300, epoch: 16 | loss: 2.2811127
	speed: 0.0556s/iter; left time: 2198.2157s
	iters: 400, epoch: 16 | loss: 2.2985930
	speed: 0.0582s/iter; left time: 2298.4805s
Epoch: 16 cost time: 26.617793560028076
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.3143861
	speed: 0.2105s/iter; left time: 8273.7947s
	iters: 200, epoch: 17 | loss: 2.2893145
	speed: 0.0530s/iter; left time: 2076.5985s
	iters: 300, epoch: 17 | loss: 2.3169787
	speed: 0.0542s/iter; left time: 2119.5436s
	iters: 400, epoch: 17 | loss: 2.3091249
	speed: 0.0535s/iter; left time: 2085.2949s
Epoch: 17 cost time: 25.888972997665405
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.2899289
	speed: 0.2151s/iter; left time: 8350.2491s
	iters: 200, epoch: 18 | loss: 2.3177671
	speed: 0.0530s/iter; left time: 2051.4906s
	iters: 300, epoch: 18 | loss: 2.2786229
	speed: 0.0595s/iter; left time: 2299.7535s
	iters: 400, epoch: 18 | loss: 2.2836552
	speed: 0.0567s/iter; left time: 2184.6233s
Epoch: 18 cost time: 27.416568279266357
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.3148658
	speed: 0.2223s/iter; left time: 8525.8418s
	iters: 200, epoch: 19 | loss: 2.2984004
	speed: 0.0571s/iter; left time: 2186.3532s
	iters: 300, epoch: 19 | loss: 2.3060391
	speed: 0.0589s/iter; left time: 2246.9294s
	iters: 400, epoch: 19 | loss: 2.2980897
	speed: 0.0551s/iter; left time: 2097.0799s
Epoch: 19 cost time: 27.249390363693237
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 2.2942083
	speed: 0.2194s/iter; left time: 8311.3386s
	iters: 200, epoch: 20 | loss: 2.3152041
	speed: 0.0567s/iter; left time: 2142.3044s
	iters: 300, epoch: 20 | loss: 2.3033831
	speed: 0.0582s/iter; left time: 2191.7778s
	iters: 400, epoch: 20 | loss: 2.2950003
	speed: 0.0571s/iter; left time: 2145.2192s
Epoch: 20 cost time: 27.56587839126587
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.3082588
	speed: 0.2056s/iter; left time: 7695.5931s
	iters: 200, epoch: 21 | loss: 2.2922094
	speed: 0.0564s/iter; left time: 2103.4876s
	iters: 300, epoch: 21 | loss: 2.2890363
	speed: 0.0554s/iter; left time: 2062.7009s
	iters: 400, epoch: 21 | loss: 2.3163581
	speed: 0.0567s/iter; left time: 2103.2590s
Epoch: 21 cost time: 27.01103448867798
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.2928917
	speed: 0.2053s/iter; left time: 7586.7514s
	iters: 200, epoch: 22 | loss: 2.3226504
	speed: 0.0578s/iter; left time: 2128.2688s
	iters: 300, epoch: 22 | loss: 2.3050537
	speed: 0.0554s/iter; left time: 2036.8198s
	iters: 400, epoch: 22 | loss: 2.2870517
	speed: 0.0565s/iter; left time: 2071.1387s
Epoch: 22 cost time: 26.873213529586792
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.2966483
	speed: 0.2067s/iter; left time: 7540.9036s
	iters: 200, epoch: 23 | loss: 2.3158937
	speed: 0.0579s/iter; left time: 2106.6569s
	iters: 300, epoch: 23 | loss: 2.2971144
	speed: 0.0549s/iter; left time: 1993.0907s
	iters: 400, epoch: 23 | loss: 2.2961826
	speed: 0.0559s/iter; left time: 2020.8253s
Epoch: 23 cost time: 26.51925277709961
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.3110900
	speed: 0.2103s/iter; left time: 7573.3648s
	iters: 200, epoch: 24 | loss: 2.2978323
	speed: 0.0562s/iter; left time: 2018.6476s
	iters: 300, epoch: 24 | loss: 2.3127065
	speed: 0.0504s/iter; left time: 1803.4991s
	iters: 400, epoch: 24 | loss: 2.3126652
	speed: 0.0535s/iter; left time: 1911.4289s
Epoch: 24 cost time: 25.4332332611084
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.3138492
	speed: 0.2008s/iter; left time: 7136.1790s
	iters: 200, epoch: 25 | loss: 2.2977548
	speed: 0.0546s/iter; left time: 1936.1308s
	iters: 300, epoch: 25 | loss: 2.2996457
	speed: 0.0546s/iter; left time: 1929.8208s
	iters: 400, epoch: 25 | loss: 2.3108852
	speed: 0.0558s/iter; left time: 1965.2084s
Epoch: 25 cost time: 26.040221214294434
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 2.2916582
	speed: 0.2203s/iter; left time: 7726.9108s
	iters: 200, epoch: 26 | loss: 2.2977533
	speed: 0.0572s/iter; left time: 2002.1481s
	iters: 300, epoch: 26 | loss: 2.3043880
	speed: 0.0561s/iter; left time: 1955.7913s
	iters: 400, epoch: 26 | loss: 2.2975922
	speed: 0.0591s/iter; left time: 2054.0708s
Epoch: 26 cost time: 27.509544849395752
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 27 | loss: 2.2927151
	speed: 0.2167s/iter; left time: 7498.7394s
	iters: 200, epoch: 27 | loss: 2.2916820
	speed: 0.0563s/iter; left time: 1943.7205s
	iters: 300, epoch: 27 | loss: 2.3210964
	speed: 0.0532s/iter; left time: 1829.2450s
	iters: 400, epoch: 27 | loss: 2.3130009
	speed: 0.0532s/iter; left time: 1824.2843s
Epoch: 27 cost time: 26.163455963134766
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.3122094
	speed: 0.2014s/iter; left time: 6876.3975s
	iters: 200, epoch: 28 | loss: 2.3061905
	speed: 0.0559s/iter; left time: 1903.0447s
	iters: 300, epoch: 28 | loss: 2.3144791
	speed: 0.0558s/iter; left time: 1894.5857s
	iters: 400, epoch: 28 | loss: 2.2990909
	speed: 0.0506s/iter; left time: 1712.2491s
Epoch: 28 cost time: 25.790723085403442
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 2.2844563
	speed: 0.1723s/iter; left time: 5799.4878s
	iters: 200, epoch: 29 | loss: 2.3096261
	speed: 0.0547s/iter; left time: 1837.3621s
	iters: 300, epoch: 29 | loss: 2.2945592
	speed: 0.0524s/iter; left time: 1753.9014s
	iters: 400, epoch: 29 | loss: 2.2934840
	speed: 0.0567s/iter; left time: 1892.8947s
Epoch: 29 cost time: 25.700547695159912
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 2.3034616
	speed: 0.1997s/iter; left time: 6631.5084s
	iters: 200, epoch: 30 | loss: 2.2918124
	speed: 0.0561s/iter; left time: 1857.9315s
	iters: 300, epoch: 30 | loss: 2.2919397
	speed: 0.0543s/iter; left time: 1792.0539s
	iters: 400, epoch: 30 | loss: 2.2988224
	speed: 0.0538s/iter; left time: 1770.4314s
Epoch: 30 cost time: 26.042898654937744
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 2.3030541
	speed: 0.2070s/iter; left time: 6775.0678s
	iters: 200, epoch: 31 | loss: 2.3084888
	speed: 0.0556s/iter; left time: 1814.5985s
	iters: 300, epoch: 31 | loss: 2.3037877
	speed: 0.0538s/iter; left time: 1750.5256s
	iters: 400, epoch: 31 | loss: 2.3005798
	speed: 0.0534s/iter; left time: 1730.9542s
Epoch: 31 cost time: 26.072670459747314
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 2.3120008
	speed: 0.2095s/iter; left time: 6758.6460s
	iters: 200, epoch: 32 | loss: 2.3070083
	speed: 0.0554s/iter; left time: 1783.0300s
	iters: 300, epoch: 32 | loss: 2.3131411
	speed: 0.0527s/iter; left time: 1690.6540s
	iters: 400, epoch: 32 | loss: 2.3073719
	speed: 0.0526s/iter; left time: 1681.3426s
Epoch: 32 cost time: 25.720809936523438
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 2.2821226
	speed: 0.1916s/iter; left time: 6091.0496s
	iters: 200, epoch: 33 | loss: 2.2962885
	speed: 0.0532s/iter; left time: 1686.0970s
	iters: 300, epoch: 33 | loss: 2.3037019
	speed: 0.0516s/iter; left time: 1630.4497s
	iters: 400, epoch: 33 | loss: 2.3056805
	speed: 0.0536s/iter; left time: 1687.1855s
Epoch: 33 cost time: 24.652625560760498
Epoch: 33, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 2.3096881
	speed: 0.1968s/iter; left time: 6164.3525s
	iters: 200, epoch: 34 | loss: 2.2972045
	speed: 0.0533s/iter; left time: 1665.7241s
	iters: 300, epoch: 34 | loss: 2.2998171
	speed: 0.0540s/iter; left time: 1681.3830s
	iters: 400, epoch: 34 | loss: 2.2982473
	speed: 0.0554s/iter; left time: 1718.1664s
Epoch: 34 cost time: 25.744908094406128
Epoch: 34, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 2.3011079
	speed: 0.1974s/iter; left time: 6089.3346s
	iters: 200, epoch: 35 | loss: 2.2937620
	speed: 0.0560s/iter; left time: 1722.3807s
	iters: 300, epoch: 35 | loss: 2.3186977
	speed: 0.0518s/iter; left time: 1588.5912s
	iters: 400, epoch: 35 | loss: 2.3054938
	speed: 0.0492s/iter; left time: 1502.1986s
Epoch: 35 cost time: 25.075124740600586
Epoch: 35, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 2.3064287
	speed: 0.1869s/iter; left time: 5679.1707s
	iters: 200, epoch: 36 | loss: 2.3038793
	speed: 0.0515s/iter; left time: 1559.3048s
	iters: 300, epoch: 36 | loss: 2.3097374
	speed: 0.0517s/iter; left time: 1560.8328s
	iters: 400, epoch: 36 | loss: 2.3088510
	speed: 0.0514s/iter; left time: 1546.7908s
Epoch: 36 cost time: 24.72327971458435
Epoch: 36, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 71914
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7539953
	speed: 0.0651s/iter; left time: 3047.4981s
	iters: 200, epoch: 1 | loss: 1.2093327
	speed: 0.0531s/iter; left time: 2478.2589s
	iters: 300, epoch: 1 | loss: 0.8510115
	speed: 0.0493s/iter; left time: 2297.5599s
	iters: 400, epoch: 1 | loss: 0.4020913
	speed: 0.0504s/iter; left time: 2345.6328s
Epoch: 1 cost time: 25.13935899734497
Epoch: 1, Steps: 469 | Train Loss: 1.193 Vali Loss: 0.437 Vali Acc: 0.892 Test Loss: 0.437 Test Acc: 0.892
Validation loss decreased (inf --> -0.891934).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3433255
	speed: 0.1831s/iter; left time: 8483.6658s
	iters: 200, epoch: 2 | loss: 0.1810716
	speed: 0.0528s/iter; left time: 2438.7409s
	iters: 300, epoch: 2 | loss: 0.0772045
	speed: 0.0538s/iter; left time: 2484.1348s
	iters: 400, epoch: 2 | loss: 0.0973945
	speed: 0.0524s/iter; left time: 2414.2499s
Epoch: 2 cost time: 25.14394998550415
Epoch: 2, Steps: 469 | Train Loss: 0.243 Vali Loss: 0.217 Vali Acc: 0.934 Test Loss: 0.217 Test Acc: 0.934
Validation loss decreased (-0.891934 --> -0.933960).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0815042
	speed: 0.1888s/iter; left time: 8659.6548s
	iters: 200, epoch: 3 | loss: 0.2357993
	speed: 0.0544s/iter; left time: 2491.5728s
	iters: 300, epoch: 3 | loss: 0.0986327
	speed: 0.0536s/iter; left time: 2445.6843s
	iters: 400, epoch: 3 | loss: 0.0211015
	speed: 0.0524s/iter; left time: 2385.2248s
Epoch: 3 cost time: 25.469919443130493
Epoch: 3, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.933960 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0079014
	speed: 0.1813s/iter; left time: 8229.5869s
	iters: 200, epoch: 4 | loss: 0.7929739
	speed: 0.0499s/iter; left time: 2259.2085s
	iters: 300, epoch: 4 | loss: 0.0239142
	speed: 0.0539s/iter; left time: 2436.9100s
	iters: 400, epoch: 4 | loss: 0.0156871
	speed: 0.0507s/iter; left time: 2285.3237s
Epoch: 4 cost time: 24.495671272277832
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.961405 --> -0.969982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0123769
	speed: 0.1850s/iter; left time: 8312.2750s
	iters: 200, epoch: 5 | loss: 0.0225839
	speed: 0.0517s/iter; left time: 2316.5603s
	iters: 300, epoch: 5 | loss: 0.0253116
	speed: 0.0510s/iter; left time: 2278.8996s
	iters: 400, epoch: 5 | loss: 0.0427669
	speed: 0.0517s/iter; left time: 2305.2831s
Epoch: 5 cost time: 24.596882581710815
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.969982 --> -0.975128).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1584732
	speed: 0.1763s/iter; left time: 7838.7428s
	iters: 200, epoch: 6 | loss: 0.0106749
	speed: 0.0539s/iter; left time: 2392.1595s
	iters: 300, epoch: 6 | loss: 0.0097128
	speed: 0.0519s/iter; left time: 2296.1382s
	iters: 400, epoch: 6 | loss: 0.0135653
	speed: 0.0512s/iter; left time: 2262.2230s
Epoch: 6 cost time: 24.67217493057251
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0093216
	speed: 0.1909s/iter; left time: 8396.5976s
	iters: 200, epoch: 7 | loss: 0.1381797
	speed: 0.0514s/iter; left time: 2257.1443s
	iters: 300, epoch: 7 | loss: 0.0144860
	speed: 0.0529s/iter; left time: 2317.1371s
	iters: 400, epoch: 7 | loss: 0.0363037
	speed: 0.0539s/iter; left time: 2354.7638s
Epoch: 7 cost time: 25.16741967201233
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0515803
	speed: 0.1860s/iter; left time: 8096.4397s
	iters: 200, epoch: 8 | loss: 0.0042122
	speed: 0.0504s/iter; left time: 2188.8252s
	iters: 300, epoch: 8 | loss: 0.0026887
	speed: 0.0509s/iter; left time: 2205.5898s
	iters: 400, epoch: 8 | loss: 0.3229994
	speed: 0.0500s/iter; left time: 2160.7527s
Epoch: 8 cost time: 24.253620386123657
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1571822
	speed: 0.1857s/iter; left time: 7993.1617s
	iters: 200, epoch: 9 | loss: 0.0168123
	speed: 0.0519s/iter; left time: 2231.0526s
	iters: 300, epoch: 9 | loss: 0.0098088
	speed: 0.0524s/iter; left time: 2246.5685s
	iters: 400, epoch: 9 | loss: 0.0383058
	speed: 0.0545s/iter; left time: 2331.0443s
Epoch: 9 cost time: 25.117091417312622
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0160631
	speed: 0.1821s/iter; left time: 7754.7861s
	iters: 200, epoch: 10 | loss: 0.0010110
	speed: 0.0516s/iter; left time: 2190.8981s
	iters: 300, epoch: 10 | loss: 0.0396093
	speed: 0.0520s/iter; left time: 2205.4344s
	iters: 400, epoch: 10 | loss: 0.1783619
	speed: 0.0530s/iter; left time: 2242.2675s
Epoch: 10 cost time: 24.79000687599182
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0097746
	speed: 0.1817s/iter; left time: 7650.2134s
	iters: 200, epoch: 11 | loss: 0.0270300
	speed: 0.0488s/iter; left time: 2051.8746s
	iters: 300, epoch: 11 | loss: 0.0092565
	speed: 0.0516s/iter; left time: 2162.6254s
	iters: 400, epoch: 11 | loss: 0.2765751
	speed: 0.0556s/iter; left time: 2325.6490s
Epoch: 11 cost time: 24.775716066360474
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004674
	speed: 0.1858s/iter; left time: 7737.0847s
	iters: 200, epoch: 12 | loss: 0.0008765
	speed: 0.0508s/iter; left time: 2109.7297s
	iters: 300, epoch: 12 | loss: 0.0308886
	speed: 0.0498s/iter; left time: 2062.3099s
	iters: 400, epoch: 12 | loss: 0.0010253
	speed: 0.0500s/iter; left time: 2065.4285s
Epoch: 12 cost time: 23.90815782546997
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979988).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0062016
	speed: 0.1628s/iter; left time: 6704.9402s
	iters: 200, epoch: 13 | loss: 0.0344169
	speed: 0.0530s/iter; left time: 2178.0312s
	iters: 300, epoch: 13 | loss: 0.0037717
	speed: 0.0496s/iter; left time: 2031.3201s
	iters: 400, epoch: 13 | loss: 0.0014267
	speed: 0.0526s/iter; left time: 2151.4168s
Epoch: 13 cost time: 24.33701229095459
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0325379
	speed: 0.1801s/iter; left time: 7331.1188s
	iters: 200, epoch: 14 | loss: 0.0027331
	speed: 0.0526s/iter; left time: 2137.3728s
	iters: 300, epoch: 14 | loss: 0.0024477
	speed: 0.0513s/iter; left time: 2078.7815s
	iters: 400, epoch: 14 | loss: 0.0038785
	speed: 0.0519s/iter; left time: 2097.1656s
Epoch: 14 cost time: 24.362422466278076
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0038319
	speed: 0.1851s/iter; left time: 7448.6910s
	iters: 200, epoch: 15 | loss: 0.0071049
	speed: 0.0538s/iter; left time: 2158.6287s
	iters: 300, epoch: 15 | loss: 0.0103323
	speed: 0.0520s/iter; left time: 2079.9019s
	iters: 400, epoch: 15 | loss: 0.0106522
	speed: 0.0508s/iter; left time: 2027.7992s
Epoch: 15 cost time: 24.653364419937134
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0131784
	speed: 0.1758s/iter; left time: 6991.9038s
	iters: 200, epoch: 16 | loss: 0.0507309
	speed: 0.0498s/iter; left time: 1976.4584s
	iters: 300, epoch: 16 | loss: 0.1514179
	speed: 0.0481s/iter; left time: 1904.3788s
	iters: 400, epoch: 16 | loss: 0.0627924
	speed: 0.0516s/iter; left time: 2035.8112s
Epoch: 16 cost time: 23.676640510559082
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0437263
	speed: 0.1763s/iter; left time: 6927.7003s
	iters: 200, epoch: 17 | loss: 0.0239410
	speed: 0.0501s/iter; left time: 1963.4771s
	iters: 300, epoch: 17 | loss: 0.0011337
	speed: 0.0483s/iter; left time: 1887.9731s
	iters: 400, epoch: 17 | loss: 0.0014926
	speed: 0.0540s/iter; left time: 2103.9413s
Epoch: 17 cost time: 24.362289667129517
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0308215
	speed: 0.1838s/iter; left time: 7137.8035s
	iters: 200, epoch: 18 | loss: 0.0019445
	speed: 0.0530s/iter; left time: 2052.9888s
	iters: 300, epoch: 18 | loss: 0.0005414
	speed: 0.0533s/iter; left time: 2058.1668s
	iters: 400, epoch: 18 | loss: 0.0012860
	speed: 0.0560s/iter; left time: 2158.8836s
Epoch: 18 cost time: 25.326335668563843
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.982275).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0028877
	speed: 0.1958s/iter; left time: 7509.3717s
	iters: 200, epoch: 19 | loss: 0.0006094
	speed: 0.0544s/iter; left time: 2080.4103s
	iters: 300, epoch: 19 | loss: 0.0299879
	speed: 0.0529s/iter; left time: 2020.1090s
	iters: 400, epoch: 19 | loss: 0.0010337
	speed: 0.0546s/iter; left time: 2076.8154s
Epoch: 19 cost time: 25.60918664932251
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0047661
	speed: 0.1946s/iter; left time: 7372.9676s
	iters: 200, epoch: 20 | loss: 0.0021077
	speed: 0.0496s/iter; left time: 1874.7751s
	iters: 300, epoch: 20 | loss: 0.0015687
	speed: 0.0514s/iter; left time: 1935.8043s
	iters: 400, epoch: 20 | loss: 0.0757856
	speed: 0.0477s/iter; left time: 1792.2109s
Epoch: 20 cost time: 24.445032835006714
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1096931
	speed: 0.2165s/iter; left time: 8100.4044s
	iters: 200, epoch: 21 | loss: 0.0144514
	speed: 0.0593s/iter; left time: 2211.5900s
	iters: 300, epoch: 21 | loss: 0.0001635
	speed: 0.0572s/iter; left time: 2129.8081s
	iters: 400, epoch: 21 | loss: 0.0791037
	speed: 0.0580s/iter; left time: 2153.7982s
Epoch: 21 cost time: 27.376830101013184
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0544759
	speed: 0.2186s/iter; left time: 8079.2792s
	iters: 200, epoch: 22 | loss: 0.0039681
	speed: 0.0533s/iter; left time: 1963.3301s
	iters: 300, epoch: 22 | loss: 0.0003585
	speed: 0.0620s/iter; left time: 2279.0459s
	iters: 400, epoch: 22 | loss: 0.0024632
	speed: 0.0605s/iter; left time: 2217.7680s
Epoch: 22 cost time: 27.86777424812317
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.983990).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0115881
	speed: 0.2216s/iter; left time: 8085.6116s
	iters: 200, epoch: 23 | loss: 0.0025715
	speed: 0.0582s/iter; left time: 2116.2277s
	iters: 300, epoch: 23 | loss: 0.0109572
	speed: 0.0567s/iter; left time: 2057.4883s
	iters: 400, epoch: 23 | loss: 0.1871464
	speed: 0.0581s/iter; left time: 2102.2532s
Epoch: 23 cost time: 27.326882123947144
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0250768
	speed: 0.2208s/iter; left time: 7953.6260s
	iters: 200, epoch: 24 | loss: 0.0015144
	speed: 0.0583s/iter; left time: 2095.4355s
	iters: 300, epoch: 24 | loss: 0.0221372
	speed: 0.0616s/iter; left time: 2204.6855s
	iters: 400, epoch: 24 | loss: 0.0834568
	speed: 0.0562s/iter; left time: 2008.6795s
Epoch: 24 cost time: 27.9298894405365
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0003929
	speed: 0.2178s/iter; left time: 7742.2729s
	iters: 200, epoch: 25 | loss: 0.0020980
	speed: 0.0536s/iter; left time: 1901.0799s
	iters: 300, epoch: 25 | loss: 0.0113755
	speed: 0.0496s/iter; left time: 1751.5742s
	iters: 400, epoch: 25 | loss: 0.0005442
	speed: 0.0514s/iter; left time: 1813.0323s
Epoch: 25 cost time: 25.021451234817505
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1908653
	speed: 0.2201s/iter; left time: 7721.1831s
	iters: 200, epoch: 26 | loss: 0.0559924
	speed: 0.0600s/iter; left time: 2099.1452s
	iters: 300, epoch: 26 | loss: 0.0035146
	speed: 0.0574s/iter; left time: 2000.6129s
	iters: 400, epoch: 26 | loss: 0.0048929
	speed: 0.0592s/iter; left time: 2057.4689s
Epoch: 26 cost time: 27.77292561531067
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0042168
	speed: 0.2201s/iter; left time: 7617.3524s
	iters: 200, epoch: 27 | loss: 0.0043765
	speed: 0.0587s/iter; left time: 2023.8964s
	iters: 300, epoch: 27 | loss: 0.0086734
	speed: 0.0549s/iter; left time: 1889.9904s
	iters: 400, epoch: 27 | loss: 0.0192807
	speed: 0.0605s/iter; left time: 2075.1971s
Epoch: 27 cost time: 27.22216558456421
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0020321
	speed: 0.2178s/iter; left time: 7435.4353s
	iters: 200, epoch: 28 | loss: 0.0007489
	speed: 0.0584s/iter; left time: 1987.6914s
	iters: 300, epoch: 28 | loss: 0.0038693
	speed: 0.0583s/iter; left time: 1978.6200s
	iters: 400, epoch: 28 | loss: 0.0040508
	speed: 0.0594s/iter; left time: 2010.9866s
Epoch: 28 cost time: 28.051546335220337
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1951014
	speed: 0.2265s/iter; left time: 7626.0610s
	iters: 200, epoch: 29 | loss: 0.0165498
	speed: 0.0570s/iter; left time: 1911.9740s
	iters: 300, epoch: 29 | loss: 0.0019155
	speed: 0.0538s/iter; left time: 1802.0177s
	iters: 400, epoch: 29 | loss: 0.0021860
	speed: 0.0506s/iter; left time: 1688.4036s
Epoch: 29 cost time: 25.737080335617065
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0008206
	speed: 0.1814s/iter; left time: 6021.7486s
	iters: 200, epoch: 30 | loss: 0.0863109
	speed: 0.0564s/iter; left time: 1866.1102s
	iters: 300, epoch: 30 | loss: 0.0012076
	speed: 0.0585s/iter; left time: 1931.8458s
	iters: 400, epoch: 30 | loss: 0.0017776
	speed: 0.0551s/iter; left time: 1812.9081s
Epoch: 30 cost time: 27.0153386592865
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0051035
	speed: 0.2042s/iter; left time: 6684.1701s
	iters: 200, epoch: 31 | loss: 0.0188528
	speed: 0.0522s/iter; left time: 1703.3335s
	iters: 300, epoch: 31 | loss: 0.0001267
	speed: 0.0574s/iter; left time: 1867.1438s
	iters: 400, epoch: 31 | loss: 0.0165802
	speed: 0.0549s/iter; left time: 1780.6169s
Epoch: 31 cost time: 26.099793434143066
Epoch: 31, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0003187
	speed: 0.2182s/iter; left time: 7037.9629s
	iters: 200, epoch: 32 | loss: 0.0029541
	speed: 0.0585s/iter; left time: 1881.7136s
	iters: 300, epoch: 32 | loss: 0.0061374
	speed: 0.0554s/iter; left time: 1775.9312s
	iters: 400, epoch: 32 | loss: 0.0075769
	speed: 0.0534s/iter; left time: 1706.0316s
Epoch: 32 cost time: 26.188608169555664
Epoch: 32, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 47338
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8740337
	speed: 0.0741s/iter; left time: 3466.1427s
	iters: 200, epoch: 1 | loss: 1.2458303
	speed: 0.0556s/iter; left time: 2595.4239s
	iters: 300, epoch: 1 | loss: 0.9613007
	speed: 0.0574s/iter; left time: 2674.1660s
	iters: 400, epoch: 1 | loss: 0.5536883
	speed: 0.0545s/iter; left time: 2534.0420s
Epoch: 1 cost time: 28.099273681640625
Epoch: 1, Steps: 469 | Train Loss: 1.288 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
Validation loss decreased (inf --> -0.834185).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6074598
	speed: 0.2095s/iter; left time: 9704.6674s
	iters: 200, epoch: 2 | loss: 0.2365848
	speed: 0.0516s/iter; left time: 2387.8488s
	iters: 300, epoch: 2 | loss: 0.1904745
	speed: 0.0578s/iter; left time: 2665.2021s
	iters: 400, epoch: 2 | loss: 0.1423268
	speed: 0.0546s/iter; left time: 2513.6891s
Epoch: 2 cost time: 26.265132188796997
Epoch: 2, Steps: 469 | Train Loss: 0.324 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.834185 --> -0.930243).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1276037
	speed: 0.1983s/iter; left time: 9093.2007s
	iters: 200, epoch: 3 | loss: 0.1519725
	speed: 0.0550s/iter; left time: 2515.0963s
	iters: 300, epoch: 3 | loss: 0.1624950
	speed: 0.0574s/iter; left time: 2621.3550s
	iters: 400, epoch: 3 | loss: 0.0373944
	speed: 0.0571s/iter; left time: 2603.8998s
Epoch: 3 cost time: 26.711186408996582
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
Validation loss decreased (-0.930243 --> -0.950827).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0188613
	speed: 0.2090s/iter; left time: 9488.0822s
	iters: 200, epoch: 4 | loss: 0.8027780
	speed: 0.0562s/iter; left time: 2543.5149s
	iters: 300, epoch: 4 | loss: 0.0361518
	speed: 0.0555s/iter; left time: 2507.8646s
	iters: 400, epoch: 4 | loss: 0.0393345
	speed: 0.0508s/iter; left time: 2288.6697s
Epoch: 4 cost time: 25.57591962814331
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.950827 --> -0.958260).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0283153
	speed: 0.1750s/iter; left time: 7860.3157s
	iters: 200, epoch: 5 | loss: 0.0201596
	speed: 0.0539s/iter; left time: 2413.8459s
	iters: 300, epoch: 5 | loss: 0.0678742
	speed: 0.0515s/iter; left time: 2301.1745s
	iters: 400, epoch: 5 | loss: 0.0811015
	speed: 0.0527s/iter; left time: 2350.4864s
Epoch: 5 cost time: 24.951969861984253
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.958260 --> -0.965979).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2873894
	speed: 0.1969s/iter; left time: 8751.9417s
	iters: 200, epoch: 6 | loss: 0.0372378
	speed: 0.0549s/iter; left time: 2436.8182s
	iters: 300, epoch: 6 | loss: 0.0191248
	speed: 0.0555s/iter; left time: 2456.9876s
	iters: 400, epoch: 6 | loss: 0.0186628
	speed: 0.0556s/iter; left time: 2455.3944s
Epoch: 6 cost time: 26.060102701187134
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966551).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0464014
	speed: 0.2034s/iter; left time: 8945.6179s
	iters: 200, epoch: 7 | loss: 0.1159862
	speed: 0.0550s/iter; left time: 2415.9107s
	iters: 300, epoch: 7 | loss: 0.0122831
	speed: 0.0560s/iter; left time: 2451.3872s
	iters: 400, epoch: 7 | loss: 0.0279093
	speed: 0.0563s/iter; left time: 2461.5461s
Epoch: 7 cost time: 26.137577533721924
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.969696).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0493216
	speed: 0.2146s/iter; left time: 9337.4946s
	iters: 200, epoch: 8 | loss: 0.0426540
	speed: 0.0537s/iter; left time: 2333.5741s
	iters: 300, epoch: 8 | loss: 0.0061720
	speed: 0.0554s/iter; left time: 2398.0159s
	iters: 400, epoch: 8 | loss: 0.3055178
	speed: 0.0553s/iter; left time: 2392.0295s
Epoch: 8 cost time: 26.24865484237671
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1451602
	speed: 0.2074s/iter; left time: 8926.8873s
	iters: 200, epoch: 9 | loss: 0.0171550
	speed: 0.0574s/iter; left time: 2463.8957s
	iters: 300, epoch: 9 | loss: 0.1394647
	speed: 0.0524s/iter; left time: 2245.3863s
	iters: 400, epoch: 9 | loss: 0.0542742
	speed: 0.0490s/iter; left time: 2094.7845s
Epoch: 9 cost time: 25.090008974075317
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0219710
	speed: 0.1783s/iter; left time: 7593.1621s
	iters: 200, epoch: 10 | loss: 0.0011775
	speed: 0.0524s/iter; left time: 2224.9827s
	iters: 300, epoch: 10 | loss: 0.0296887
	speed: 0.0580s/iter; left time: 2457.5474s
	iters: 400, epoch: 10 | loss: 0.0141434
	speed: 0.0551s/iter; left time: 2330.1426s
Epoch: 10 cost time: 26.30968713760376
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.971983).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0246625
	speed: 0.1948s/iter; left time: 8203.4961s
	iters: 200, epoch: 11 | loss: 0.2138924
	speed: 0.0516s/iter; left time: 2166.5442s
	iters: 300, epoch: 11 | loss: 0.0256690
	speed: 0.0550s/iter; left time: 2306.4489s
	iters: 400, epoch: 11 | loss: 0.0540140
	speed: 0.0527s/iter; left time: 2205.4826s
Epoch: 11 cost time: 25.542824745178223
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0005137
	speed: 0.1965s/iter; left time: 8184.6614s
	iters: 200, epoch: 12 | loss: 0.0059045
	speed: 0.0551s/iter; left time: 2290.6520s
	iters: 300, epoch: 12 | loss: 0.0162652
	speed: 0.0533s/iter; left time: 2209.5739s
	iters: 400, epoch: 12 | loss: 0.0033085
	speed: 0.0527s/iter; left time: 2180.4405s
Epoch: 12 cost time: 25.5809965133667
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.974842).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0036235
	speed: 0.1887s/iter; left time: 7768.1695s
	iters: 200, epoch: 13 | loss: 0.0512204
	speed: 0.0593s/iter; left time: 2433.7423s
	iters: 300, epoch: 13 | loss: 0.0141807
	speed: 0.0529s/iter; left time: 2168.6116s
	iters: 400, epoch: 13 | loss: 0.0152546
	speed: 0.0530s/iter; left time: 2165.4889s
Epoch: 13 cost time: 25.692880868911743
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0108566
	speed: 0.1916s/iter; left time: 7797.4898s
	iters: 200, epoch: 14 | loss: 0.0029626
	speed: 0.0520s/iter; left time: 2112.9516s
	iters: 300, epoch: 14 | loss: 0.0039279
	speed: 0.0539s/iter; left time: 2183.9200s
	iters: 400, epoch: 14 | loss: 0.0417871
	speed: 0.0533s/iter; left time: 2154.1902s
Epoch: 14 cost time: 25.425379991531372
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0536091
	speed: 0.2017s/iter; left time: 8116.6780s
	iters: 200, epoch: 15 | loss: 0.0247689
	speed: 0.0536s/iter; left time: 2150.5357s
	iters: 300, epoch: 15 | loss: 0.0457106
	speed: 0.0547s/iter; left time: 2190.7337s
	iters: 400, epoch: 15 | loss: 0.0098032
	speed: 0.0538s/iter; left time: 2147.7139s
Epoch: 15 cost time: 25.827261447906494
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0047947
	speed: 0.1930s/iter; left time: 7676.1911s
	iters: 200, epoch: 16 | loss: 0.0223880
	speed: 0.0527s/iter; left time: 2089.0876s
	iters: 300, epoch: 16 | loss: 0.1813424
	speed: 0.0538s/iter; left time: 2129.7051s
	iters: 400, epoch: 16 | loss: 0.0480119
	speed: 0.0518s/iter; left time: 2042.5477s
Epoch: 16 cost time: 25.449238061904907
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0108043
	speed: 0.1886s/iter; left time: 7412.2753s
	iters: 200, epoch: 17 | loss: 0.0011455
	speed: 0.0532s/iter; left time: 2084.0708s
	iters: 300, epoch: 17 | loss: 0.0053054
	speed: 0.0517s/iter; left time: 2022.8784s
	iters: 400, epoch: 17 | loss: 0.0034896
	speed: 0.0487s/iter; left time: 1900.2519s
Epoch: 17 cost time: 24.29758644104004
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0198743
	speed: 0.1728s/iter; left time: 6711.1886s
	iters: 200, epoch: 18 | loss: 0.0014521
	speed: 0.0508s/iter; left time: 1967.2569s
	iters: 300, epoch: 18 | loss: 0.0010452
	speed: 0.0508s/iter; left time: 1960.4343s
	iters: 400, epoch: 18 | loss: 0.0436649
	speed: 0.0524s/iter; left time: 2019.0554s
Epoch: 18 cost time: 24.773661136627197
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0038969
	speed: 0.1889s/iter; left time: 7244.7918s
	iters: 200, epoch: 19 | loss: 0.0012168
	speed: 0.0511s/iter; left time: 1956.6573s
	iters: 300, epoch: 19 | loss: 0.0271296
	speed: 0.0525s/iter; left time: 2003.3933s
	iters: 400, epoch: 19 | loss: 0.0032791
	speed: 0.0498s/iter; left time: 1895.5858s
Epoch: 19 cost time: 24.7246732711792
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0068432
	speed: 0.1791s/iter; left time: 6786.2600s
	iters: 200, epoch: 20 | loss: 0.0059612
	speed: 0.0535s/iter; left time: 2021.6589s
	iters: 300, epoch: 20 | loss: 0.0025964
	speed: 0.0587s/iter; left time: 2210.5459s
	iters: 400, epoch: 20 | loss: 0.0954063
	speed: 0.0528s/iter; left time: 1985.4997s
Epoch: 20 cost time: 25.470069408416748
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0392033
	speed: 0.1736s/iter; left time: 6494.9190s
	iters: 200, epoch: 21 | loss: 0.0083466
	speed: 0.0506s/iter; left time: 1888.8279s
	iters: 300, epoch: 21 | loss: 0.0066386
	speed: 0.0503s/iter; left time: 1870.7917s
	iters: 400, epoch: 21 | loss: 0.0125408
	speed: 0.0528s/iter; left time: 1961.6174s
Epoch: 21 cost time: 24.090692281723022
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0173763
	speed: 0.1844s/iter; left time: 6814.3531s
	iters: 200, epoch: 22 | loss: 0.0147080
	speed: 0.0529s/iter; left time: 1949.6535s
	iters: 300, epoch: 22 | loss: 0.0098941
	speed: 0.0488s/iter; left time: 1792.8883s
	iters: 400, epoch: 22 | loss: 0.0023287
	speed: 0.0543s/iter; left time: 1989.7111s
Epoch: 22 cost time: 24.953893423080444
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0018420
	speed: 0.1871s/iter; left time: 6827.1509s
	iters: 200, epoch: 23 | loss: 0.0032593
	speed: 0.0547s/iter; left time: 1989.5668s
	iters: 300, epoch: 23 | loss: 0.0071668
	speed: 0.0499s/iter; left time: 1808.8816s
	iters: 400, epoch: 23 | loss: 0.0141037
	speed: 0.0525s/iter; left time: 1901.3618s
Epoch: 23 cost time: 25.034562826156616
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0007563
	speed: 0.1869s/iter; left time: 6731.4802s
	iters: 200, epoch: 24 | loss: 0.0200981
	speed: 0.0538s/iter; left time: 1931.1651s
	iters: 300, epoch: 24 | loss: 0.2488224
	speed: 0.0545s/iter; left time: 1952.9989s
	iters: 400, epoch: 24 | loss: 0.3269668
	speed: 0.0499s/iter; left time: 1781.1465s
Epoch: 24 cost time: 25.20993995666504
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0003113
	speed: 0.1897s/iter; left time: 6741.9074s
	iters: 200, epoch: 25 | loss: 0.0492112
	speed: 0.0535s/iter; left time: 1895.7538s
	iters: 300, epoch: 25 | loss: 0.0100447
	speed: 0.0522s/iter; left time: 1846.6906s
	iters: 400, epoch: 25 | loss: 0.0005089
	speed: 0.0528s/iter; left time: 1860.8850s
Epoch: 25 cost time: 25.35258173942566
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1050065
	speed: 0.1688s/iter; left time: 5922.5446s
	iters: 200, epoch: 26 | loss: 0.0383225
	speed: 0.0507s/iter; left time: 1774.0494s
	iters: 300, epoch: 26 | loss: 0.0032862
	speed: 0.0490s/iter; left time: 1710.3856s
	iters: 400, epoch: 26 | loss: 0.0095699
	speed: 0.0474s/iter; left time: 1648.0243s
Epoch: 26 cost time: 23.189536094665527
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0012366
	speed: 0.1801s/iter; left time: 6232.1334s
	iters: 200, epoch: 27 | loss: 0.1114081
	speed: 0.0492s/iter; left time: 1697.6156s
	iters: 300, epoch: 27 | loss: 0.0452027
	speed: 0.0522s/iter; left time: 1796.8177s
	iters: 400, epoch: 27 | loss: 0.0136832
	speed: 0.0499s/iter; left time: 1711.0813s
Epoch: 27 cost time: 23.709381341934204
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0019476
	speed: 0.1704s/iter; left time: 5817.7895s
	iters: 200, epoch: 28 | loss: 0.0096095
	speed: 0.0487s/iter; left time: 1656.1575s
	iters: 300, epoch: 28 | loss: 0.0680165
	speed: 0.0487s/iter; left time: 1654.1430s
	iters: 400, epoch: 28 | loss: 0.0172574
	speed: 0.0501s/iter; left time: 1693.6198s
Epoch: 28 cost time: 23.49425768852234
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0555811
	speed: 0.1740s/iter; left time: 5857.1929s
	iters: 200, epoch: 29 | loss: 0.0242345
	speed: 0.0483s/iter; left time: 1622.4329s
	iters: 300, epoch: 29 | loss: 0.0044600
	speed: 0.0471s/iter; left time: 1574.7406s
	iters: 400, epoch: 29 | loss: 0.0012048
	speed: 0.0500s/iter; left time: 1669.4294s
Epoch: 29 cost time: 22.91369128227234
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0094960
	speed: 0.1674s/iter; left time: 5556.9375s
	iters: 200, epoch: 30 | loss: 0.0913696
	speed: 0.0494s/iter; left time: 1636.2394s
	iters: 300, epoch: 30 | loss: 0.0033854
	speed: 0.0482s/iter; left time: 1590.3685s
	iters: 400, epoch: 30 | loss: 0.0622336
	speed: 0.0506s/iter; left time: 1665.0729s
Epoch: 30 cost time: 23.577205896377563
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0010293
	speed: 0.1848s/iter; left time: 6047.4412s
	iters: 200, epoch: 31 | loss: 0.0089900
	speed: 0.0468s/iter; left time: 1527.3271s
	iters: 300, epoch: 31 | loss: 0.0001777
	speed: 0.0503s/iter; left time: 1635.3714s
	iters: 400, epoch: 31 | loss: 0.0067647
	speed: 0.0491s/iter; left time: 1593.2502s
Epoch: 31 cost time: 23.47593879699707
Epoch: 31, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0032455
	speed: 0.1756s/iter; left time: 5665.2676s
	iters: 200, epoch: 32 | loss: 0.0036006
	speed: 0.0512s/iter; left time: 1646.4762s
	iters: 300, epoch: 32 | loss: 0.0240687
	speed: 0.0472s/iter; left time: 1512.5774s
	iters: 400, epoch: 32 | loss: 0.0018120
	speed: 0.0499s/iter; left time: 1595.9787s
Epoch: 32 cost time: 23.72098398208618
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.975699 --> -0.979702).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0065427
	speed: 0.1765s/iter; left time: 5611.9519s
	iters: 200, epoch: 33 | loss: 0.0061480
	speed: 0.0482s/iter; left time: 1526.9897s
	iters: 300, epoch: 33 | loss: 0.0021801
	speed: 0.0478s/iter; left time: 1511.3955s
	iters: 400, epoch: 33 | loss: 0.0007518
	speed: 0.0492s/iter; left time: 1548.4747s
Epoch: 33 cost time: 23.300793170928955
Epoch: 33, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0003297
	speed: 0.1751s/iter; left time: 5485.9478s
	iters: 200, epoch: 34 | loss: 0.0639607
	speed: 0.0509s/iter; left time: 1589.3646s
	iters: 300, epoch: 34 | loss: 0.0011014
	speed: 0.0474s/iter; left time: 1476.0713s
	iters: 400, epoch: 34 | loss: 0.0116799
	speed: 0.0463s/iter; left time: 1437.9266s
Epoch: 34 cost time: 22.97366428375244
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0005573
	speed: 0.2058s/iter; left time: 6351.4851s
	iters: 200, epoch: 35 | loss: 0.0066900
	speed: 0.0570s/iter; left time: 1753.1687s
	iters: 300, epoch: 35 | loss: 0.0004462
	speed: 0.0543s/iter; left time: 1664.6450s
	iters: 400, epoch: 35 | loss: 0.0316220
	speed: 0.0503s/iter; left time: 1538.3032s
Epoch: 35 cost time: 25.99281907081604
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980845).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0338076
	speed: 0.2153s/iter; left time: 6543.5972s
	iters: 200, epoch: 36 | loss: 0.0181048
	speed: 0.0558s/iter; left time: 1690.3501s
	iters: 300, epoch: 36 | loss: 0.0017400
	speed: 0.0532s/iter; left time: 1604.6599s
	iters: 400, epoch: 36 | loss: 0.0021093
	speed: 0.0554s/iter; left time: 1667.8001s
Epoch: 36 cost time: 26.09139847755432
Epoch: 36, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0002109
	speed: 0.2015s/iter; left time: 6027.8566s
	iters: 200, epoch: 37 | loss: 0.0015455
	speed: 0.0588s/iter; left time: 1752.5563s
	iters: 300, epoch: 37 | loss: 0.0001184
	speed: 0.0533s/iter; left time: 1583.8958s
	iters: 400, epoch: 37 | loss: 0.0173952
	speed: 0.0543s/iter; left time: 1608.8206s
Epoch: 37 cost time: 26.250205993652344
Epoch: 37, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0345062
	speed: 0.2144s/iter; left time: 6314.3363s
	iters: 200, epoch: 38 | loss: 0.0549649
	speed: 0.0538s/iter; left time: 1578.1458s
	iters: 300, epoch: 38 | loss: 0.0201589
	speed: 0.0550s/iter; left time: 1609.2569s
	iters: 400, epoch: 38 | loss: 0.0046504
	speed: 0.0563s/iter; left time: 1641.4219s
Epoch: 38 cost time: 26.400861978530884
Epoch: 38, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0034219
	speed: 0.2113s/iter; left time: 6123.5353s
	iters: 200, epoch: 39 | loss: 0.0004735
	speed: 0.0542s/iter; left time: 1564.4353s
	iters: 300, epoch: 39 | loss: 0.0019989
	speed: 0.0597s/iter; left time: 1716.8936s
	iters: 400, epoch: 39 | loss: 0.0606490
	speed: 0.0528s/iter; left time: 1514.5030s
Epoch: 39 cost time: 26.413772344589233
Epoch: 39, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.1108040
	speed: 0.2195s/iter; left time: 6257.4547s
	iters: 200, epoch: 40 | loss: 0.0065425
	speed: 0.0559s/iter; left time: 1588.0084s
	iters: 300, epoch: 40 | loss: 0.0142077
	speed: 0.0528s/iter; left time: 1496.1558s
	iters: 400, epoch: 40 | loss: 0.0059541
	speed: 0.0580s/iter; left time: 1635.2469s
Epoch: 40 cost time: 26.681689500808716
Epoch: 40, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000488
	speed: 0.2080s/iter; left time: 5831.3093s
	iters: 200, epoch: 41 | loss: 0.0002162
	speed: 0.0534s/iter; left time: 1490.8923s
	iters: 300, epoch: 41 | loss: 0.0043261
	speed: 0.0539s/iter; left time: 1500.3245s
	iters: 400, epoch: 41 | loss: 0.0006039
	speed: 0.0513s/iter; left time: 1422.4791s
Epoch: 41 cost time: 25.57150411605835
Epoch: 41, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0004186
	speed: 0.2066s/iter; left time: 5696.5680s
	iters: 200, epoch: 42 | loss: 0.0011519
	speed: 0.0552s/iter; left time: 1516.5625s
	iters: 300, epoch: 42 | loss: 0.0090419
	speed: 0.0546s/iter; left time: 1494.2614s
	iters: 400, epoch: 42 | loss: 0.0070772
	speed: 0.0576s/iter; left time: 1569.9472s
Epoch: 42 cost time: 26.252262115478516
Epoch: 42, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0005196
	speed: 0.2082s/iter; left time: 5643.9421s
	iters: 200, epoch: 43 | loss: 0.0003512
	speed: 0.0528s/iter; left time: 1424.6897s
	iters: 300, epoch: 43 | loss: 0.0113927
	speed: 0.0455s/iter; left time: 1223.9145s
	iters: 400, epoch: 43 | loss: 0.0002978
	speed: 0.0474s/iter; left time: 1270.3658s
Epoch: 43 cost time: 23.488054990768433
Epoch: 43, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0021639
	speed: 0.1922s/iter; left time: 5117.9724s
	iters: 200, epoch: 44 | loss: 0.0080698
	speed: 0.0537s/iter; left time: 1426.0617s
	iters: 300, epoch: 44 | loss: 0.0013582
	speed: 0.0538s/iter; left time: 1422.2721s
	iters: 400, epoch: 44 | loss: 0.1642496
	speed: 0.0520s/iter; left time: 1369.4749s
Epoch: 44 cost time: 25.166073322296143
Epoch: 44, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0043332
	speed: 0.2052s/iter; left time: 5367.9953s
	iters: 200, epoch: 45 | loss: 0.0002260
	speed: 0.0504s/iter; left time: 1314.4756s
	iters: 300, epoch: 45 | loss: 0.0002984
	speed: 0.0560s/iter; left time: 1454.4654s
	iters: 400, epoch: 45 | loss: 0.0012899
	speed: 0.0521s/iter; left time: 1348.5733s
Epoch: 45 cost time: 25.382454872131348
Epoch: 45, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 47338
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7662348
	speed: 0.0735s/iter; left time: 3440.6469s
	iters: 200, epoch: 1 | loss: 1.2209653
	speed: 0.0566s/iter; left time: 2644.0857s
	iters: 300, epoch: 1 | loss: 0.8922518
	speed: 0.0609s/iter; left time: 2839.0010s
	iters: 400, epoch: 1 | loss: 0.4533526
	speed: 0.0584s/iter; left time: 2716.3458s
Epoch: 1 cost time: 29.330065488815308
Epoch: 1, Steps: 469 | Train Loss: 1.264 Vali Loss: 0.506 Vali Acc: 0.868 Test Loss: 0.506 Test Acc: 0.868
Validation loss decreased (inf --> -0.867634).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4932680
	speed: 0.2296s/iter; left time: 10637.0055s
	iters: 200, epoch: 2 | loss: 0.2698741
	speed: 0.0591s/iter; left time: 2734.1210s
	iters: 300, epoch: 2 | loss: 0.1834446
	speed: 0.0601s/iter; left time: 2773.1836s
	iters: 400, epoch: 2 | loss: 0.1281691
	speed: 0.0566s/iter; left time: 2607.1354s
Epoch: 2 cost time: 28.04989194869995
Epoch: 2, Steps: 469 | Train Loss: 0.292 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.867634 --> -0.930529).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0695372
	speed: 0.2151s/iter; left time: 9864.2372s
	iters: 200, epoch: 3 | loss: 0.2092639
	speed: 0.0569s/iter; left time: 2604.9207s
	iters: 300, epoch: 3 | loss: 0.1067156
	speed: 0.0616s/iter; left time: 2810.6520s
	iters: 400, epoch: 3 | loss: 0.1312934
	speed: 0.0563s/iter; left time: 2565.3246s
Epoch: 3 cost time: 27.96928310394287
Epoch: 3, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.930529 --> -0.959118).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0136459
	speed: 0.2218s/iter; left time: 10069.9429s
	iters: 200, epoch: 4 | loss: 0.7186682
	speed: 0.0574s/iter; left time: 2598.3240s
	iters: 300, epoch: 4 | loss: 0.0551844
	speed: 0.0596s/iter; left time: 2693.2504s
	iters: 400, epoch: 4 | loss: 0.0069041
	speed: 0.0591s/iter; left time: 2664.8060s
Epoch: 4 cost time: 28.018763780593872
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959118 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0119401
	speed: 0.2188s/iter; left time: 9831.3052s
	iters: 200, epoch: 5 | loss: 0.0059588
	speed: 0.0526s/iter; left time: 2356.2843s
	iters: 300, epoch: 5 | loss: 0.0345314
	speed: 0.0561s/iter; left time: 2510.8408s
	iters: 400, epoch: 5 | loss: 0.0330863
	speed: 0.0576s/iter; left time: 2571.3781s
Epoch: 5 cost time: 26.50250792503357
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
Validation loss decreased (-0.961977 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1908813
	speed: 0.2119s/iter; left time: 9418.4663s
	iters: 200, epoch: 6 | loss: 0.1156800
	speed: 0.0566s/iter; left time: 2509.6367s
	iters: 300, epoch: 6 | loss: 0.1013287
	speed: 0.0543s/iter; left time: 2403.8713s
	iters: 400, epoch: 6 | loss: 0.0548615
	speed: 0.0567s/iter; left time: 2505.0991s
Epoch: 6 cost time: 26.393043994903564
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.966265 --> -0.972555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0093207
	speed: 0.2202s/iter; left time: 9685.7198s
	iters: 200, epoch: 7 | loss: 0.0109550
	speed: 0.0554s/iter; left time: 2431.7424s
	iters: 300, epoch: 7 | loss: 0.0387048
	speed: 0.0530s/iter; left time: 2320.2666s
	iters: 400, epoch: 7 | loss: 0.0264650
	speed: 0.0571s/iter; left time: 2492.6388s
Epoch: 7 cost time: 26.61548948287964
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0164355
	speed: 0.1886s/iter; left time: 8208.8087s
	iters: 200, epoch: 8 | loss: 0.0050898
	speed: 0.0503s/iter; left time: 2184.7383s
	iters: 300, epoch: 8 | loss: 0.0092333
	speed: 0.0521s/iter; left time: 2257.5613s
	iters: 400, epoch: 8 | loss: 0.3943978
	speed: 0.0590s/iter; left time: 2550.3807s
Epoch: 8 cost time: 25.330978870391846
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0324214
	speed: 0.2142s/iter; left time: 9220.4001s
	iters: 200, epoch: 9 | loss: 0.0158895
	speed: 0.0558s/iter; left time: 2398.2754s
	iters: 300, epoch: 9 | loss: 0.0476111
	speed: 0.0561s/iter; left time: 2404.4845s
	iters: 400, epoch: 9 | loss: 0.0151212
	speed: 0.0561s/iter; left time: 2396.2461s
Epoch: 9 cost time: 26.54842734336853
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0119928
	speed: 0.2036s/iter; left time: 8669.0553s
	iters: 200, epoch: 10 | loss: 0.0092312
	speed: 0.0503s/iter; left time: 2136.4990s
	iters: 300, epoch: 10 | loss: 0.0020284
	speed: 0.0580s/iter; left time: 2458.2881s
	iters: 400, epoch: 10 | loss: 0.0317639
	speed: 0.0541s/iter; left time: 2287.9830s
Epoch: 10 cost time: 26.112783908843994
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0205560
	speed: 0.2168s/iter; left time: 9129.4809s
	iters: 200, epoch: 11 | loss: 0.0068600
	speed: 0.0563s/iter; left time: 2365.2748s
	iters: 300, epoch: 11 | loss: 0.0033819
	speed: 0.0575s/iter; left time: 2409.3837s
	iters: 400, epoch: 11 | loss: 0.1824544
	speed: 0.0548s/iter; left time: 2290.6942s
Epoch: 11 cost time: 26.910751342773438
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0030494
	speed: 0.2099s/iter; left time: 8740.3506s
	iters: 200, epoch: 12 | loss: 0.0044195
	speed: 0.0557s/iter; left time: 2315.5905s
	iters: 300, epoch: 12 | loss: 0.0841755
	speed: 0.0556s/iter; left time: 2304.8605s
	iters: 400, epoch: 12 | loss: 0.0029265
	speed: 0.0572s/iter; left time: 2363.5877s
Epoch: 12 cost time: 26.60120415687561
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.972841).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0169284
	speed: 0.1894s/iter; left time: 7798.2163s
	iters: 200, epoch: 13 | loss: 0.1215923
	speed: 0.0542s/iter; left time: 2226.0967s
	iters: 300, epoch: 13 | loss: 0.0018032
	speed: 0.0546s/iter; left time: 2238.6455s
	iters: 400, epoch: 13 | loss: 0.0113304
	speed: 0.0546s/iter; left time: 2233.0051s
Epoch: 13 cost time: 26.043320178985596
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0294501
	speed: 0.2142s/iter; left time: 8719.5775s
	iters: 200, epoch: 14 | loss: 0.0026217
	speed: 0.0546s/iter; left time: 2216.7669s
	iters: 300, epoch: 14 | loss: 0.0012894
	speed: 0.0567s/iter; left time: 2295.1814s
	iters: 400, epoch: 14 | loss: 0.0047047
	speed: 0.0527s/iter; left time: 2129.6536s
Epoch: 14 cost time: 26.442387580871582
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.972841 --> -0.974556).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1109736
	speed: 0.2166s/iter; left time: 8714.4266s
	iters: 200, epoch: 15 | loss: 0.0899444
	speed: 0.0576s/iter; left time: 2312.2941s
	iters: 300, epoch: 15 | loss: 0.0157937
	speed: 0.0540s/iter; left time: 2163.2172s
	iters: 400, epoch: 15 | loss: 0.1043898
	speed: 0.0578s/iter; left time: 2307.0748s
Epoch: 15 cost time: 26.74627685546875
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0102555
	speed: 0.2117s/iter; left time: 8420.4072s
	iters: 200, epoch: 16 | loss: 0.0225942
	speed: 0.0554s/iter; left time: 2196.3577s
	iters: 300, epoch: 16 | loss: 0.0052858
	speed: 0.0562s/iter; left time: 2223.4765s
	iters: 400, epoch: 16 | loss: 0.0169304
	speed: 0.0559s/iter; left time: 2205.6588s
Epoch: 16 cost time: 26.491374492645264
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.974556 --> -0.980274).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0023836
	speed: 0.2003s/iter; left time: 7872.8572s
	iters: 200, epoch: 17 | loss: 0.0013228
	speed: 0.0505s/iter; left time: 1980.5633s
	iters: 300, epoch: 17 | loss: 0.0030165
	speed: 0.0558s/iter; left time: 2179.7105s
	iters: 400, epoch: 17 | loss: 0.0080191
	speed: 0.0506s/iter; left time: 1971.9484s
Epoch: 17 cost time: 25.356255292892456
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0037044
	speed: 0.1968s/iter; left time: 7641.1865s
	iters: 200, epoch: 18 | loss: 0.0008723
	speed: 0.0592s/iter; left time: 2293.4433s
	iters: 300, epoch: 18 | loss: 0.0012598
	speed: 0.0542s/iter; left time: 2092.4846s
	iters: 400, epoch: 18 | loss: 0.0067543
	speed: 0.0565s/iter; left time: 2177.0631s
Epoch: 18 cost time: 26.271125316619873
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0050441
	speed: 0.1975s/iter; left time: 7575.1895s
	iters: 200, epoch: 19 | loss: 0.0062506
	speed: 0.0538s/iter; left time: 2057.3141s
	iters: 300, epoch: 19 | loss: 0.0159630
	speed: 0.0555s/iter; left time: 2115.9440s
	iters: 400, epoch: 19 | loss: 0.0299094
	speed: 0.0536s/iter; left time: 2040.4986s
Epoch: 19 cost time: 26.04396891593933
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0703438
	speed: 0.1960s/iter; left time: 7426.4161s
	iters: 200, epoch: 20 | loss: 0.0015986
	speed: 0.0567s/iter; left time: 2142.7032s
	iters: 300, epoch: 20 | loss: 0.0005689
	speed: 0.0549s/iter; left time: 2070.6926s
	iters: 400, epoch: 20 | loss: 0.0030791
	speed: 0.0536s/iter; left time: 2015.5510s
Epoch: 20 cost time: 25.872366428375244
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3153443
	speed: 0.2017s/iter; left time: 7546.6375s
	iters: 200, epoch: 21 | loss: 0.0316154
	speed: 0.0553s/iter; left time: 2063.7040s
	iters: 300, epoch: 21 | loss: 0.0001339
	speed: 0.0525s/iter; left time: 1952.7422s
	iters: 400, epoch: 21 | loss: 0.0013788
	speed: 0.0582s/iter; left time: 2161.0436s
Epoch: 21 cost time: 26.224254846572876
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3018927
	speed: 0.2080s/iter; left time: 7687.0599s
	iters: 200, epoch: 22 | loss: 0.0005156
	speed: 0.0525s/iter; left time: 1936.3885s
	iters: 300, epoch: 22 | loss: 0.0366360
	speed: 0.0514s/iter; left time: 1888.3702s
	iters: 400, epoch: 22 | loss: 0.0070885
	speed: 0.0500s/iter; left time: 1831.8015s
Epoch: 22 cost time: 25.019288301467896
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0349736
	speed: 0.1847s/iter; left time: 6739.4295s
	iters: 200, epoch: 23 | loss: 0.0006162
	speed: 0.0555s/iter; left time: 2017.9654s
	iters: 300, epoch: 23 | loss: 0.0088181
	speed: 0.0534s/iter; left time: 1938.9228s
	iters: 400, epoch: 23 | loss: 0.0053833
	speed: 0.0532s/iter; left time: 1924.3554s
Epoch: 23 cost time: 25.327889919281006
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0024923
	speed: 0.1985s/iter; left time: 7148.0995s
	iters: 200, epoch: 24 | loss: 0.0025610
	speed: 0.0529s/iter; left time: 1901.4151s
	iters: 300, epoch: 24 | loss: 0.0375399
	speed: 0.0534s/iter; left time: 1912.8857s
	iters: 400, epoch: 24 | loss: 0.3205243
	speed: 0.0523s/iter; left time: 1867.3266s
Epoch: 24 cost time: 25.389236211776733
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0015284
	speed: 0.1934s/iter; left time: 6873.3433s
	iters: 200, epoch: 25 | loss: 0.0004459
	speed: 0.0520s/iter; left time: 1844.0684s
	iters: 300, epoch: 25 | loss: 0.0054083
	speed: 0.0526s/iter; left time: 1860.2395s
	iters: 400, epoch: 25 | loss: 0.0015461
	speed: 0.0514s/iter; left time: 1810.4117s
Epoch: 25 cost time: 24.920426607131958
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0707654
	speed: 0.1900s/iter; left time: 6664.7821s
	iters: 200, epoch: 26 | loss: 0.1125422
	speed: 0.0490s/iter; left time: 1714.2909s
	iters: 300, epoch: 26 | loss: 0.0047521
	speed: 0.0530s/iter; left time: 1848.0700s
	iters: 400, epoch: 26 | loss: 0.0033642
	speed: 0.0496s/iter; left time: 1725.5760s
Epoch: 26 cost time: 24.600887060165405
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 47338
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3]
fourier enhanced block used!
modes=32, index=[0, 1]
 fourier enhanced cross attention used!
modes_q=2, index_q=[0, 1]
modes_kv=4, index_kv=[0, 1, 2, 3]
>>>>>>>start training : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2840171
	speed: 0.0668s/iter; left time: 3128.3690s
	iters: 200, epoch: 1 | loss: 2.2886329
	speed: 0.0514s/iter; left time: 2398.8331s
	iters: 300, epoch: 1 | loss: 2.2975936
	speed: 0.0507s/iter; left time: 2363.1986s
	iters: 400, epoch: 1 | loss: 2.3098507
	speed: 0.0521s/iter; left time: 2420.5431s
Epoch: 1 cost time: 25.708447456359863
Epoch: 1, Steps: 469 | Train Loss: 2.303 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (inf --> -0.104036).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3085988
	speed: 0.1894s/iter; left time: 8777.5177s
	iters: 200, epoch: 2 | loss: 2.3068590
	speed: 0.0558s/iter; left time: 2578.1321s
	iters: 300, epoch: 2 | loss: 2.2889678
	speed: 0.0544s/iter; left time: 2510.8298s
	iters: 400, epoch: 2 | loss: 2.2947509
	speed: 0.0526s/iter; left time: 2423.1640s
Epoch: 2 cost time: 25.44507908821106
Epoch: 2, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3008769
	speed: 0.1873s/iter; left time: 8587.9510s
	iters: 200, epoch: 3 | loss: 2.2907698
	speed: 0.0522s/iter; left time: 2389.3123s
	iters: 300, epoch: 3 | loss: 2.2941320
	speed: 0.0501s/iter; left time: 2286.7094s
	iters: 400, epoch: 3 | loss: 2.2916846
	speed: 0.0524s/iter; left time: 2385.7569s
Epoch: 3 cost time: 24.262661933898926
Epoch: 3, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2952931
	speed: 0.1842s/iter; left time: 8359.5170s
	iters: 200, epoch: 4 | loss: 2.2856572
	speed: 0.0528s/iter; left time: 2390.7203s
	iters: 300, epoch: 4 | loss: 2.3048904
	speed: 0.0483s/iter; left time: 2182.7778s
	iters: 400, epoch: 4 | loss: 2.3106034
	speed: 0.0503s/iter; left time: 2268.6736s
Epoch: 4 cost time: 23.84262704849243
Epoch: 4, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3059208
	speed: 0.1740s/iter; left time: 7816.2659s
	iters: 200, epoch: 5 | loss: 2.3188939
	speed: 0.0492s/iter; left time: 2206.6526s
	iters: 300, epoch: 5 | loss: 2.2989254
	speed: 0.0446s/iter; left time: 1995.8431s
	iters: 400, epoch: 5 | loss: 2.2915998
	speed: 0.0468s/iter; left time: 2089.5151s
Epoch: 5 cost time: 22.382500410079956
Epoch: 5, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2961698
	speed: 0.1700s/iter; left time: 7556.1719s
	iters: 200, epoch: 6 | loss: 2.3060787
	speed: 0.0482s/iter; left time: 2139.6277s
	iters: 300, epoch: 6 | loss: 2.3051422
	speed: 0.0484s/iter; left time: 2140.3292s
	iters: 400, epoch: 6 | loss: 2.3114946
	speed: 0.0465s/iter; left time: 2053.5726s
Epoch: 6 cost time: 22.91993260383606
Epoch: 6, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3031108
	speed: 0.1711s/iter; left time: 7525.5425s
	iters: 200, epoch: 7 | loss: 2.2972169
	speed: 0.0474s/iter; left time: 2081.7678s
	iters: 300, epoch: 7 | loss: 2.3107798
	speed: 0.0510s/iter; left time: 2234.4046s
	iters: 400, epoch: 7 | loss: 2.2978239
	speed: 0.0503s/iter; left time: 2199.0403s
Epoch: 7 cost time: 23.576595306396484
Epoch: 7, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2983050
	speed: 0.1726s/iter; left time: 7510.4424s
	iters: 200, epoch: 8 | loss: 2.2937465
	speed: 0.0497s/iter; left time: 2156.0210s
	iters: 300, epoch: 8 | loss: 2.3084409
	speed: 0.0500s/iter; left time: 2166.9769s
	iters: 400, epoch: 8 | loss: 2.2987335
	speed: 0.0487s/iter; left time: 2103.1671s
Epoch: 8 cost time: 23.633041620254517
Epoch: 8, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3293755
	speed: 0.1783s/iter; left time: 7677.3360s
	iters: 200, epoch: 9 | loss: 2.3108566
	speed: 0.0493s/iter; left time: 2115.2795s
	iters: 300, epoch: 9 | loss: 2.3140152
	speed: 0.0509s/iter; left time: 2179.2403s
	iters: 400, epoch: 9 | loss: 2.3088961
	speed: 0.0468s/iter; left time: 2001.7057s
Epoch: 9 cost time: 23.5014386177063
Epoch: 9, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3021469
	speed: 0.1691s/iter; left time: 7201.3928s
	iters: 200, epoch: 10 | loss: 2.3190310
	speed: 0.0464s/iter; left time: 1972.2939s
	iters: 300, epoch: 10 | loss: 2.2989435
	speed: 0.0508s/iter; left time: 2154.2926s
	iters: 400, epoch: 10 | loss: 2.3014994
	speed: 0.0503s/iter; left time: 2127.3639s
Epoch: 10 cost time: 23.26396131515503
Epoch: 10, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3162408
	speed: 0.1788s/iter; left time: 7527.3579s
	iters: 200, epoch: 11 | loss: 2.3163712
	speed: 0.0510s/iter; left time: 2141.5917s
	iters: 300, epoch: 11 | loss: 2.2997980
	speed: 0.0497s/iter; left time: 2084.1916s
	iters: 400, epoch: 11 | loss: 2.3031716
	speed: 0.0492s/iter; left time: 2058.9121s
Epoch: 11 cost time: 23.942224740982056
Epoch: 11, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.2933621
	speed: 0.1829s/iter; left time: 7618.3420s
	iters: 200, epoch: 12 | loss: 2.3064399
	speed: 0.0509s/iter; left time: 2115.5153s
	iters: 300, epoch: 12 | loss: 2.2826488
	speed: 0.0487s/iter; left time: 2016.6304s
	iters: 400, epoch: 12 | loss: 2.3149600
	speed: 0.0491s/iter; left time: 2031.5364s
Epoch: 12 cost time: 23.901590585708618
Epoch: 12, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3145056
	speed: 0.1797s/iter; left time: 7399.9479s
	iters: 200, epoch: 13 | loss: 2.3029282
	speed: 0.0500s/iter; left time: 2052.0363s
	iters: 300, epoch: 13 | loss: 2.2844172
	speed: 0.0499s/iter; left time: 2045.0004s
	iters: 400, epoch: 13 | loss: 2.3117845
	speed: 0.0502s/iter; left time: 2051.9084s
Epoch: 13 cost time: 24.01947259902954
Epoch: 13, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3124061
	speed: 0.1790s/iter; left time: 7286.6638s
	iters: 200, epoch: 14 | loss: 2.3080618
	speed: 0.0495s/iter; left time: 2008.4371s
	iters: 300, epoch: 14 | loss: 2.3044457
	speed: 0.0492s/iter; left time: 1994.6425s
	iters: 400, epoch: 14 | loss: 2.3012242
	speed: 0.0502s/iter; left time: 2026.9369s
Epoch: 14 cost time: 24.033018827438354
Epoch: 14, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2876079
	speed: 0.1767s/iter; left time: 7108.4906s
	iters: 200, epoch: 15 | loss: 2.3128810
	speed: 0.0490s/iter; left time: 1965.9971s
	iters: 300, epoch: 15 | loss: 2.3055799
	speed: 0.0482s/iter; left time: 1930.8691s
	iters: 400, epoch: 15 | loss: 2.3018746
	speed: 0.0483s/iter; left time: 1927.3601s
Epoch: 15 cost time: 23.28389620780945
Epoch: 15, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3036075
	speed: 0.1715s/iter; left time: 6818.1065s
	iters: 200, epoch: 16 | loss: 2.3017375
	speed: 0.0488s/iter; left time: 1937.1406s
	iters: 300, epoch: 16 | loss: 2.2944844
	speed: 0.0482s/iter; left time: 1905.4629s
	iters: 400, epoch: 16 | loss: 2.3062625
	speed: 0.0496s/iter; left time: 1957.5651s
Epoch: 16 cost time: 22.94407558441162
Epoch: 16, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.2930279
	speed: 0.1651s/iter; left time: 6487.8208s
	iters: 200, epoch: 17 | loss: 2.2881939
	speed: 0.0465s/iter; left time: 1824.1442s
	iters: 300, epoch: 17 | loss: 2.3011601
	speed: 0.0490s/iter; left time: 1915.5352s
	iters: 400, epoch: 17 | loss: 2.3096216
	speed: 0.0496s/iter; left time: 1933.4055s
Epoch: 17 cost time: 22.895771503448486
Epoch: 17, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.3136544
	speed: 0.1713s/iter; left time: 6651.5218s
	iters: 200, epoch: 18 | loss: 2.3120439
	speed: 0.0484s/iter; left time: 1875.7335s
	iters: 300, epoch: 18 | loss: 2.2900479
	speed: 0.0488s/iter; left time: 1884.9455s
	iters: 400, epoch: 18 | loss: 2.2933185
	speed: 0.0487s/iter; left time: 1875.9030s
Epoch: 18 cost time: 23.28685188293457
Epoch: 18, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.3156745
	speed: 0.1752s/iter; left time: 6719.3344s
	iters: 200, epoch: 19 | loss: 2.3159611
	speed: 0.0501s/iter; left time: 1918.2203s
	iters: 300, epoch: 19 | loss: 2.2908697
	speed: 0.0488s/iter; left time: 1862.3604s
	iters: 400, epoch: 19 | loss: 2.2917464
	speed: 0.0477s/iter; left time: 1815.0041s
Epoch: 19 cost time: 22.953234910964966
Epoch: 19, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 2.3181341
	speed: 0.1687s/iter; left time: 6392.9111s
	iters: 200, epoch: 20 | loss: 2.2904263
	speed: 0.0495s/iter; left time: 1871.0209s
	iters: 300, epoch: 20 | loss: 2.2928965
	speed: 0.0480s/iter; left time: 1809.5829s
	iters: 400, epoch: 20 | loss: 2.2923250
	speed: 0.0487s/iter; left time: 1829.5208s
Epoch: 20 cost time: 22.721524238586426
Epoch: 20, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 2.3160462
	speed: 0.1723s/iter; left time: 6447.4446s
	iters: 200, epoch: 21 | loss: 2.2973902
	speed: 0.0473s/iter; left time: 1763.4663s
	iters: 300, epoch: 21 | loss: 2.3147755
	speed: 0.0473s/iter; left time: 1760.9195s
	iters: 400, epoch: 21 | loss: 2.2872901
	speed: 0.0474s/iter; left time: 1758.4444s
Epoch: 21 cost time: 22.689380407333374
Epoch: 21, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 2.3018203
	speed: 0.1642s/iter; left time: 6066.3940s
	iters: 200, epoch: 22 | loss: 2.2836287
	speed: 0.0469s/iter; left time: 1728.3671s
	iters: 300, epoch: 22 | loss: 2.2884488
	speed: 0.0488s/iter; left time: 1794.1912s
	iters: 400, epoch: 22 | loss: 2.3042774
	speed: 0.0468s/iter; left time: 1714.4504s
Epoch: 22 cost time: 22.37706160545349
Epoch: 22, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 2.2986388
	speed: 0.1612s/iter; left time: 5882.8359s
	iters: 200, epoch: 23 | loss: 2.3188682
	speed: 0.0463s/iter; left time: 1685.5373s
	iters: 300, epoch: 23 | loss: 2.3021374
	speed: 0.0452s/iter; left time: 1639.1839s
	iters: 400, epoch: 23 | loss: 2.3023083
	speed: 0.0478s/iter; left time: 1728.7101s
Epoch: 23 cost time: 22.20290184020996
Epoch: 23, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 2.2990754
	speed: 0.1679s/iter; left time: 6047.6621s
	iters: 200, epoch: 24 | loss: 2.2917807
	speed: 0.0496s/iter; left time: 1781.4545s
	iters: 300, epoch: 24 | loss: 2.3244426
	speed: 0.0500s/iter; left time: 1789.2140s
	iters: 400, epoch: 24 | loss: 2.3069642
	speed: 0.0470s/iter; left time: 1679.9298s
Epoch: 24 cost time: 23.4320867061615
Epoch: 24, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 2.2870660
	speed: 0.1750s/iter; left time: 6221.3078s
	iters: 200, epoch: 25 | loss: 2.3048120
	speed: 0.0483s/iter; left time: 1711.6899s
	iters: 300, epoch: 25 | loss: 2.3033657
	speed: 0.0458s/iter; left time: 1619.1038s
	iters: 400, epoch: 25 | loss: 2.3112726
	speed: 0.0486s/iter; left time: 1712.3472s
Epoch: 25 cost time: 23.071836709976196
Epoch: 25, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.3061705
	speed: 0.1664s/iter; left time: 5837.6187s
	iters: 200, epoch: 26 | loss: 2.2992675
	speed: 0.0473s/iter; left time: 1653.4357s
	iters: 300, epoch: 26 | loss: 2.3074636
	speed: 0.0471s/iter; left time: 1643.8571s
	iters: 400, epoch: 26 | loss: 2.3082070
	speed: 0.0470s/iter; left time: 1634.2787s
Epoch: 26 cost time: 22.79243755340576
Epoch: 26, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 2.2781415
	speed: 0.1760s/iter; left time: 6089.1593s
	iters: 200, epoch: 27 | loss: 2.2984645
	speed: 0.0510s/iter; left time: 1758.9434s
	iters: 300, epoch: 27 | loss: 2.3121436
	speed: 0.0495s/iter; left time: 1701.9980s
	iters: 400, epoch: 27 | loss: 2.3082321
	speed: 0.0480s/iter; left time: 1646.7851s
Epoch: 27 cost time: 23.634172201156616
Epoch: 27, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.3023708
	speed: 0.1684s/iter; left time: 5748.5606s
	iters: 200, epoch: 28 | loss: 2.3031178
	speed: 0.0533s/iter; left time: 1814.1083s
	iters: 300, epoch: 28 | loss: 2.3027480
	speed: 0.0508s/iter; left time: 1724.6756s
	iters: 400, epoch: 28 | loss: 2.3234313
	speed: 0.0514s/iter; left time: 1738.4213s
Epoch: 28 cost time: 24.648293256759644
Epoch: 28, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.3039966
	speed: 0.1935s/iter; left time: 6514.2226s
	iters: 200, epoch: 29 | loss: 2.3031061
	speed: 0.0553s/iter; left time: 1854.8532s
	iters: 300, epoch: 29 | loss: 2.2980752
	speed: 0.0514s/iter; left time: 1720.4753s
	iters: 400, epoch: 29 | loss: 2.3017325
	speed: 0.0517s/iter; left time: 1724.9628s
Epoch: 29 cost time: 24.79642081260681
Epoch: 29, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.2817392
	speed: 0.1928s/iter; left time: 6399.6611s
	iters: 200, epoch: 30 | loss: 2.2986407
	speed: 0.0518s/iter; left time: 1713.4655s
	iters: 300, epoch: 30 | loss: 2.3129950
	speed: 0.0505s/iter; left time: 1668.1464s
	iters: 400, epoch: 30 | loss: 2.2922957
	speed: 0.0519s/iter; left time: 1708.6330s
Epoch: 30 cost time: 24.501203536987305
Epoch: 30, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 2.3026316
	speed: 0.1907s/iter; left time: 6241.9197s
	iters: 200, epoch: 31 | loss: 2.3035715
	speed: 0.0534s/iter; left time: 1740.8825s
	iters: 300, epoch: 31 | loss: 2.2934756
	speed: 0.0521s/iter; left time: 1695.5267s
	iters: 400, epoch: 31 | loss: 2.3043730
	speed: 0.0520s/iter; left time: 1686.9626s
Epoch: 31 cost time: 25.036882638931274
Epoch: 31, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 2.3090672
	speed: 0.1984s/iter; left time: 6399.3329s
	iters: 200, epoch: 32 | loss: 2.3069735
	speed: 0.0518s/iter; left time: 1665.5683s
	iters: 300, epoch: 32 | loss: 2.3026483
	speed: 0.0514s/iter; left time: 1647.9145s
	iters: 400, epoch: 32 | loss: 2.2870147
	speed: 0.0521s/iter; left time: 1664.0494s
Epoch: 32 cost time: 25.169360637664795
Epoch: 32, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 2.3082113
	speed: 0.1879s/iter; left time: 5972.5510s
	iters: 200, epoch: 33 | loss: 2.3041620
	speed: 0.0503s/iter; left time: 1593.1206s
	iters: 300, epoch: 33 | loss: 2.2845857
	speed: 0.0501s/iter; left time: 1582.7262s
	iters: 400, epoch: 33 | loss: 2.3162994
	speed: 0.0509s/iter; left time: 1603.2858s
Epoch: 33 cost time: 24.195573806762695
Epoch: 33, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 2.3127377
	speed: 0.1927s/iter; left time: 6036.2179s
	iters: 200, epoch: 34 | loss: 2.2889309
	speed: 0.0549s/iter; left time: 1714.7269s
	iters: 300, epoch: 34 | loss: 2.2943037
	speed: 0.0528s/iter; left time: 1643.2929s
	iters: 400, epoch: 34 | loss: 2.2926164
	speed: 0.0518s/iter; left time: 1607.6215s
Epoch: 34 cost time: 25.23927140235901
Epoch: 34, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 2.3161371
	speed: 0.2067s/iter; left time: 6376.2228s
	iters: 200, epoch: 35 | loss: 2.3039365
	speed: 0.0614s/iter; left time: 1887.8827s
	iters: 300, epoch: 35 | loss: 2.3079698
	speed: 0.0555s/iter; left time: 1702.2935s
	iters: 400, epoch: 35 | loss: 2.3037648
	speed: 0.0572s/iter; left time: 1746.3850s
Epoch: 35 cost time: 26.893170833587646
Epoch: 35, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
Validation loss decreased (-0.104036 --> -0.104036).  Saving model ...
	iters: 100, epoch: 36 | loss: 2.3119411
	speed: 0.2023s/iter; left time: 6147.9167s
	iters: 200, epoch: 36 | loss: 2.3206654
	speed: 0.0524s/iter; left time: 1585.8317s
	iters: 300, epoch: 36 | loss: 2.2951837
	speed: 0.0544s/iter; left time: 1642.8694s
	iters: 400, epoch: 36 | loss: 2.2993009
	speed: 0.0511s/iter; left time: 1536.4220s
Epoch: 36 cost time: 25.385101079940796
Epoch: 36, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 2.3067808
	speed: 0.1996s/iter; left time: 5972.4662s
	iters: 200, epoch: 37 | loss: 2.2860737
	speed: 0.0512s/iter; left time: 1525.1808s
	iters: 300, epoch: 37 | loss: 2.3063531
	speed: 0.0530s/iter; left time: 1575.6452s
	iters: 400, epoch: 37 | loss: 2.3065534
	speed: 0.0493s/iter; left time: 1460.5441s
Epoch: 37 cost time: 24.762210369110107
Epoch: 37, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 2.3153710
	speed: 0.1717s/iter; left time: 5056.5473s
	iters: 200, epoch: 38 | loss: 2.2961590
	speed: 0.0462s/iter; left time: 1356.1682s
	iters: 300, epoch: 38 | loss: 2.3049285
	speed: 0.0479s/iter; left time: 1400.3049s
	iters: 400, epoch: 38 | loss: 2.2896926
	speed: 0.0473s/iter; left time: 1379.7448s
Epoch: 38 cost time: 22.46164631843567
Epoch: 38, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 2.3328609
	speed: 0.1870s/iter; left time: 5418.0497s
	iters: 200, epoch: 39 | loss: 2.3144655
	speed: 0.0489s/iter; left time: 1412.1150s
	iters: 300, epoch: 39 | loss: 2.2954307
	speed: 0.0525s/iter; left time: 1511.0521s
	iters: 400, epoch: 39 | loss: 2.3171117
	speed: 0.0498s/iter; left time: 1427.3110s
Epoch: 39 cost time: 24.164952039718628
Epoch: 39, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 2.3156362
	speed: 0.1846s/iter; left time: 5262.3527s
	iters: 200, epoch: 40 | loss: 2.2993636
	speed: 0.0554s/iter; left time: 1574.9681s
	iters: 300, epoch: 40 | loss: 2.2969012
	speed: 0.0522s/iter; left time: 1476.6799s
	iters: 400, epoch: 40 | loss: 2.2994115
	speed: 0.0510s/iter; left time: 1439.7958s
Epoch: 40 cost time: 24.788450956344604
Epoch: 40, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 2.2943361
	speed: 0.1901s/iter; left time: 5331.7009s
	iters: 200, epoch: 41 | loss: 2.3009510
	speed: 0.0508s/iter; left time: 1419.2548s
	iters: 300, epoch: 41 | loss: 2.3043990
	speed: 0.0525s/iter; left time: 1462.2557s
	iters: 400, epoch: 41 | loss: 2.3082068
	speed: 0.0526s/iter; left time: 1460.3460s
Epoch: 41 cost time: 24.46510100364685
Epoch: 41, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 2.3035741
	speed: 0.1957s/iter; left time: 5397.0576s
	iters: 200, epoch: 42 | loss: 2.2959652
	speed: 0.0510s/iter; left time: 1402.3248s
	iters: 300, epoch: 42 | loss: 2.3172750
	speed: 0.0524s/iter; left time: 1434.4567s
	iters: 400, epoch: 42 | loss: 2.3149993
	speed: 0.0491s/iter; left time: 1338.3555s
Epoch: 42 cost time: 24.811200857162476
Epoch: 42, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 2.3224092
	speed: 0.1953s/iter; left time: 5291.9968s
	iters: 200, epoch: 43 | loss: 2.3090980
	speed: 0.0504s/iter; left time: 1362.0355s
	iters: 300, epoch: 43 | loss: 2.3074105
	speed: 0.0504s/iter; left time: 1355.3246s
	iters: 400, epoch: 43 | loss: 2.3020844
	speed: 0.0476s/iter; left time: 1276.4768s
Epoch: 43 cost time: 23.776126861572266
Epoch: 43, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 2.3049941
	speed: 0.1760s/iter; left time: 4687.7804s
	iters: 200, epoch: 44 | loss: 2.2916067
	speed: 0.0499s/iter; left time: 1325.1544s
	iters: 300, epoch: 44 | loss: 2.2833886
	speed: 0.0500s/iter; left time: 1322.7159s
	iters: 400, epoch: 44 | loss: 2.3224628
	speed: 0.0488s/iter; left time: 1285.2109s
Epoch: 44 cost time: 23.686140775680542
Epoch: 44, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 2.3116982
	speed: 0.1851s/iter; left time: 4843.9458s
	iters: 200, epoch: 45 | loss: 2.3020966
	speed: 0.0535s/iter; left time: 1394.0929s
	iters: 300, epoch: 45 | loss: 2.2902310
	speed: 0.0464s/iter; left time: 1203.8749s
	iters: 400, epoch: 45 | loss: 2.3125005
	speed: 0.0493s/iter; left time: 1276.0828s
Epoch: 45 cost time: 23.62442374229431
Epoch: 45, Steps: 469 | Train Loss: 2.302 Vali Loss: 2.302 Vali Acc: 0.104 Test Loss: 2.302 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_FEDformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.10405946255002858
model parameter : 47338
model size : 1.43MB
